{
  "video_id": "FFO6h6M5-3M",
  "channel": "DevOops_conf",
  "title": "",
  "views": 0,
  "duration": 0,
  "published": "",
  "text": "Итак всем привет Рад всех приветствовать на нашем заключительном слоте на девупсе и сегодня будет уступать Мой коллега Даня Дань привет привет вот когда мы с тобой вчера тоже встречались и ты был экспертом на мной гладиа Я сейчас у тебя Эксперт вот мы тоже как-то получилось так что внезапно начали обсуждать сэло видимо Слот такая важная тема вот какая Лично тебе вот когда ты сказал что slo это важно Я сказал что я село это важно наверное в тот момент когда мне про него вообще рассказали про то что у нас перед командой стоит такая задача это слово реализовать я погрузился и понял как много возможностей эта тема даёт для команды для продукта и для развития и говорят про продукт ты вот в свою презентации может быть кто-то уже видел на сайте презентацию много графиков чисел может быть даже какие-нибудь такие чувствительные данные вот скажи вообще настоящие вот эти данные это или всё-таки это такой фейк и нет Да все данные настоящие хоть они немножко д анализированные Вот и больше скажу что там есть на не только когда у нас всё хорошо но и данные периоды факапов сбоев то есть Прямо несколько будет мне кажется когда мы говорим Не каких-то абстрактных вещах прямо о реальных данных вот кажется это более будет Полезно не забывайте о том что можно задавать вопросы у нас есть чатик вот в телеграме те кто онлайн соответственно задавайте сразу там в чате платформы Мы постараемся после доклада ответить на эти вопросы Ну что ж давай даю тебе слово не буду больше задерживать Спасибо Итак всем еще раз привет Меня зовут Данил Я бэкент-разработчик в компании контур и сегодня хочу поговорить с вами про эсолом про то как можно внедрить его в продукт и получить от этого пользу план моего доклада построен следующим образом Сначала мы немножко погрузимся в предметной области салон вспомню какие-то основные понятия термины аббревиатуры затем поговорим про то про наш опыт про то как мы внедряли село свой продукт какими сталкивались сложностями развилками Какие решения на них принимали а в конце посмотрим как раз на графике и на их примерах посмотрим какую пользу может привести продукту вот Ну и как собственно мы используем его в жизни так давайте начинать что такое село Перед тем как мы будем говорить о непосредственно хочу сказать пару слов о своем продукте чтобы накинуть немного контекста Я работаю в команде коннекторов Эдо мы разрабатываем Интегра приложение для других продуктов контура в рамках направления электронного документооборота в частности мы помогаем Федеральным торговым сетям обмениваться документами со своими поставщиками для таких специализированных витайловских документов как заказы заказ на поставку подтверждение этого заказа уведомления об отгрузке уведомления от приемки существует в контуре специализированный сервис контур идеаль для закрывающих документов через которые происходят расчет денежек за поставку которые должны быть ответственны юридически значимыми У нас есть сервис контур диадок обоими сервисами можно воспользоваться через web Но если большие документы у вас много то неудобно соответственно нужна какая-то автоматизация тут есть два варианта либо написать свою собственную интеграцию через записи либо воспользоваться услугами нашей команды и получить Готовое решение под ключ так называемый коннектор В общем главный вывод из всего этого то что наши клиенты это бизнес которому важны гарантии Поэтому собственно тема ССО стала для вас актуальной и тем молодежности тоже очень важный Давайте двигаться дальше перейдем к определениям вспомним такую разберем самую на важную аббревиатуру Sli или сервис levelogriment это соглашение с клиентом об измеримых показателях уровня сервиса а также мерах ответственности То есть это некий формальный договор который Вы заключаете своим клиентам и обещаете то насколько хорошо будет работать ваш сервис А в противном случае прописывать санкции для вас виде например денежного штрафа исходя из определения видно что у нас должна быть какая-то цель обозначающая уровень сервиса который мы должны обеспечивать тот самый салон И также у нас есть некий текущий уровень сервиса который мы фактически обеспечиваем или на графике они выглядят следующим образом село это горизонтальная линия некоторые порог который зада а Sli это величина которая меняется во времени и собственно отображает то как работает наш сервис текущего момента снижается Когда у нас какой-то факап сбой и растет Когда у нас наоборот все хорошо давайте приведем пример некоторого Sli например Sli может быть заключен на время доступности сервиса в течение например месяца 99 процентов тайма вашего сервиса должно быть соответственно вот этот договор это Sli slo это будет 99%, а ссылается собственно то фактическое время от тайма которая вы за месяц показали Так давайте двигаться дальше кроме значения терминное слово в узком смысле когда это некоторая цель на графике у этого это аббревиатура есть еще значение в широком смысле а в широком смысле это практика помогающая найти баланс между скоростью развития сервиса и его надежностью под практикой здесь я понимаю некую совокупность инструментов и процессов Давайте про это чуть подробнее суть практики со в том что мы явно ставим себе цель про то насколько надежный сервис мы делаем при работе с практикой со мы измеряем надежность нашего сервиса ставим себе цель по надежности который у нас должна быть и затем отслеживаем и предпринимаем действия ради выполнения этой самой цели в частности с учетом этой цели выбираем архитектуру и технические решения в нашей разработки тут что важно отметить первые два пункта они относятся к инструментам то есть какой-то технической реализации по сбору и по отчёту метрик по их отображению может быть а вот последняя часть Последний пункт он относится как раз к процессу то есть которые вокруг этих метрики инструментов строятся супер Давайте двигаться дальше зачем все это нужно делать Дело в том что любой продукт можно делать с разным уровнем надежности можно фигачить в провод без ревью И нормального тестирования можно кропотливо дотачивать каждую фичу до совершенства тому порываться перфекционизм и все такое недостатки первого подхода они очевидно лежат на поверхности то что такой насколько написанный сервис скорее всего получится хрупким ненадежным и быстро потеряет Доверие своих пользователей альтернативный подход с тем чтобы делать все хорошо основательно Как говорится нормально делали нормально будет вот кажется Чуть более выигрышным Но не все так просто на самом деле на деле такое стремление к абсолютной стопроцентной надежности тоже может навредить продукту Почему во-первых Потому что стопроцентная надежность недостижима потому что код по-прежнему пишем и люди нам свойственно ошибаться и мы допускаем баги хотим того или нет Но даже если представить что мы стали идеальными роботами написали все единой ошибки то нас остаются зависимости от сторонних провайдеров услуг таких центра не знаю интернет-провайдер и тому подобное Ну и также мы в своем коде используем результаты трудов других программистов То есть это библиотеки фреймворки операционной системы в которых тоже могут быть ошибки далее на самом деле стопроцентная надежность коммерчески не выгодно причем как вам так и вашим пользователям Давайте подробнее разберем почему это так во-первых такой вот стремление к стопроцентной абсолютно надежности приводит к нелинейному росту затрат то есть каждое следующая девятка после запятой будет даваться вам все дороже и дороже то есть будет требовать больших ресурсов как на аппаратную часть так и на разработку при этом после определенного порога ваш пользователь скорее всего уже не заметит улучшение вашим сервисе но при этом будет замечать отсутствие какой-то важной для него функциональности развитие которой стремление к абсолютно надежности будет подавлять как правило пользователи выберет просто хорошо работающий фичу через месяц чем идеально работающие но через год и поэтому нам нужно найти такой баланс и выбрать выбрать И поддерживать некоторые достаточный уровень качества в нашем продукте на этом моменте у вас мог появиться вопрос А для кого же все-таки нужна эта практика село для инженеров или для менеджеров потому что говорим про некоторые оптимальные расходование ресурсов команды разработки может быть про планирование задач в общем про это все менеджер какой-то на мой взгляд вопрос абсолютно Справедлив я бы ответил на него Так это инженерный подход к решению менеджерской задачи менеджерской потому что Slow влияет на расстановку приоритетов для команды разработки то есть то чем собственно менеджеры занимаются а инженерные потому что мы хотим делать это основываясь не на субъективных ощущениях о качестве надежности опираясь на объективные данные метрики формулы графики то Как поступают инженеры так на этом сводной частью поясо Мы закончили теперь можно переходить к части как мы это самое слово у себя в продуктах внедряли вообще внедрение соло можно разбить на 5 этапов и пройдемся по каждому из них поподробнее начинается все с поиска ключевых сценариев с того В общем На этом этапе мы задаемся вопрос что вашим сервисе нужно пользователя в первую очередь Какую самую важную задачу ваш сервис для пользователей решает здесь бывает важно вернее бывает полезно Провести небольшое исследование запустить может быть Анкетирование провести с вашими пользователями интервью либо дойти до родакта аналитика если в вашей команде таковы имеется потому что никто как они знают вашего пользователя лучше всего конкретно в нашем случае под эти цели запускался целый отдельный процесс который мы назвали производственный аудит одним из выводов которого был то что нам нужно со а вторым то что самый важный сценарий о нашем сервисе Это доставка сообщений то есть транспорт документов из одного инк-поинта в другой одним из которых как правило является сервис контура вторым это Учетная система клиента в том или ином виде какого-то пойнта как я уже говорил мы интегрируемся с двумя большими сервисами контура и Контр диадок поэтому у нас есть как бы 4 под сценария куда И откуда мы отправляем документы и в нашей соло мы заложили э-э возможность каждый этот сценарий рассматривать в отдельности это важно потому что у каждого сценариев есть какая-то специфичная бизнес-логика соответственно под него пишется отдельный код и Одержимость этого кода может быть разные поэтому мы хотим уметь рассматривать все сценарии как совокупно вместе так и по отдельности чтобы иметь более тонко как бы смотреть где у нас есть проблемы например сценариями мы разобрались можем двигаться дальше а теперь нам нужно определить Sli для нашего будущего Salon Sli напомню что это Метрика или набор метрик численно отражающих качество сервиса хоть договориться про набор Но на самом деле есть правило что чем меньше Метрика тем лучше в идеале она должна быть одна потому что в таком случае метрики не будут противоречить и будут однозначно говорить о том что у вас продукте происходит хороший салат должен обладать таким свойством что в период нормальной работы сервиса он должен расти идти стремиться к 100 процентам к абсолютно то есть абсолютно величине периоды факапах резко проседать причем пропорционально тому как долго и как много пользователей испытывает проблемы с вашим сервисом универсальная формула для Sli выглядит следующим образом это как X деленное на Y умноженная сто процентов где x будет некоторое число некоторых успешных сценариях вашим сервисе А И как общее число сценариев вот примером хорошего Sli это будет Как раз uptime либо доля успешных запросов также тут скобках написано что за 90 дней потому что Sli всегда считается некоторым скользящим окном за период и физический смысл этого периода в том как долго пользователь помнит Он неполадках в вашем сервисе То есть если взять это окно слишком маленькое когда Метрика будет слишком быстро восстанавливаться после неполадок и не будет отражать реальные представления ощущения пользователя от ваших последних сбоев и в обратную сторону если сделать его слишком большим то он слишком долго будет хранить исторические там может быть негативные данные факапах слишком старых данных будет много и они не будут актуально на данный момент у нас Мы для себя выбрали оптимальным балансом это 90 дней то есть квартальный а также наши силой поскольку мы говорили про доставку сообщений то наш свай считается как доля сообщений доставленных вовремя то есть X у нас это число сообщений документов которые были доставлены вовремя во время это значит что время их доставки от 1 поинта до другого не превысило некоторое значение N причем Сама по себе может на самом деле варьироваться в зависимости от клиента и от сценария так например в сценариях работы сияй эти пороги Чуть более строгие потому что там более строгие требования именно к скорости как раз обмен эти сообщениями потому что на них завязаны бизнес-процессы клиентов собственно это общее число оставили сообщение нас будет теперь тоже определились выбираем пороговое значение самое салон а при этом выборе важно совместить как бы два фактора учитывать как потребности пользователей так и реальные возможности вашего сервиса мы для себя это решили следующим образом что сначала ввели что вели два порога сначала вели внешний порог и его мы взяли из реальных sala и договоров с клиентами он у нас равен 99 процентам но когда мы его на себя примерили поняли что мы за всю историю наблюдений скажем так этот порог никогда не нарушали только лишь где-то приближались к этому нарушению поэтому наша эта цель получилась как бы достижимой но недостаточно амбициозной и чтобы мы мотивировали себя работать лучше улучшать качество и при этом иметь некоторые запас по надежности мы для себя также вели дополнительно внутренний порог который реально 99 с половиной процентам чтобы стараться соблюдать его иметь тот самый буфер в процента на случай каких-то непредвиденных с боев и неполадок таким образом наши слаймы может находиться в одном из трёх состояний в Зеленом если выполняется оба порогов желтом если выполняется только внутрь внешний внутренний нарушается и красный если нарушается оба а После выбора порогов их необходимо проверить на объективность в нашем сервисе данные по обработанным документам хранятся полгода То есть у нас есть данные за последние 6 месяцев И мы смогли провернуть следующую следующий фокус мы реализовали всю логику почета Sli написали утилиту и погнали через нее эти самые данные и получили на выходе результат как будто бы сало у нас уже запущен был в продакшены и смогли посмотреть его результаты вот здесь на графике как раз результаты выведен все данные разбиты по сценариям а период агрегации для удобства анализа выбран один день Это значит что каждый вот пик на графике просадка соответствует какому-то сбою или факапу далее нам нужно было по каждому этому пику пройтись и посмотреть чем было обусловлен то есть сравнить его со списком известных факапов в нашем сервисе и проверить чтобы не было как срабатываний что когда график просеял на самом деле ничего не происходило и наоборот чтобы не было такого что пока был при этом на графике он как бы никак не был отмечен вот после того как вернее как в первой версии скорее всего расхождение эти самые будут вот может быть будут какие-то ошибки подсчета либо какие-то неущные сценарии это нужно будет поправить и потом пересчитать вот такой график еще раз и повторить Это упражнение столько литерации пока вы не получите правильное достоверный график когда это будет сделано можно будет запускать почетный Продакшен и строить уже вот такие красивые настоящие канонические графики особенно ими порогами из выбранным периодом облигаций в этом на самом деле кроется большая Ловушка при внедрение салон что вот на этом этапе можно зачастую посчитать что задача выполнена графики получены Вот и соломы внедрили это самое это еще не так Для того чтобы эти цифры эти графики не остались просто графиками чтобы они на что-то могли влиять нам нужно делать еще последние два этапа Как развязать наши инструменты процессами чтобы мы могли На основании этих цифр принимать какие-то решения по разработке нашего продукта Вот как раз следующим этапом Нам нужно будет опубликовать наш салон это нужно для того чтобы получить Доверие к Sli к сло как в команде так и за ее пределами для этих целей как правило пишется солодок который включает себя следующие разделы описание сервиса то есть верхние уровни описания всех бизнес-процессов скажем так то есть по сути Сюда можно включить результаты того подготовительного исследовательского этапа по сценариям про то что ваш сервис делает И что для пользователей важнее всего также включать описание и обоснование выбранных значений То есть то что те решения которые принимались на втором и третьем этапе внедрения Также вы солодок нужно включить границы применимости то есть перечислить те сценарии которые ваш сво не покрывает А такие скорее всего будут в нашем случае это были сценарии когда сценарий отказов клиентских имплантов когда лежит не наш сервис а там не знаю FTP Например у клиента и мы не можем это никак повлиять Чуть более подробно почему Там можно выносить такие вещи за рамки своего салона рассказывается в докладе моего коллеги Гриши вот главная мысль оттуда что выбранное салон всегда должен быть управляемым мы должны уметь управлять теми факторами которые влияют на значение нашего а те которые управлять не можем мы должны вынести как бы за рамки и также в последнее по списку должен включать в себя политику реакции на нарушение То есть вы должны их команды проработать и опубликовать вовне последовательность действий что вы были сделать если ваш соло из зеленой зоны перелет желтую или в Красную в нашем случае что если он приходит жёлтую то мы начинаем с этим разбираться Вот и делать Может какие-то Фиксы мелкие Вот а если мы там даже доходим до красной зоны то мы можем вплоть до того что заморозить разработку нового бизнес-вич и всей команды бросился на решение проблемы с надежностью важная Ремарка что вот написанное солодок должен быть понятен человеку без контекста в вашем продукте И не только разработчикам то есть быть написаны мне на техническом языке и самый последний этап это как раз про то что slo нужно как-то встроить в процессы На этом этапе бывают полезно заручиться поддержкой Team Lida или менеджер разработки то есть того человека кто у вас в команде отвечает собственно отвечает здесь нужно учиться поддерживать полученное слово в актуальном состоянии как-то учитывать его в работе для поддержания актуальности проводится регулярный пересмотр салон который мы задаем себе следующие вопросы Выполняется ли цель которую мы себя поставили объективно ли которые мы собираем и не появился какой-то новый важный сценарий который нам необходимо включить в салон в зависимости от ответов на эти вопросы Мы можем поменять решение о каких-то доработках Вот Ну а для того чтобы учитывать работе нужно чтобы значение салон как-то влияло на распределение ресурсов команде разработки конкретно В нашей команде этот процесс достаточно хорошо формализован у нас все входящие в команду задачи бьются на 6 потоков это бизнесовая продуктовая задача отказа устойчивости задачи на рефакторинг на тесты на облегчение поддержки и разное то есть тот который мы Никакому из перечисленных пунктов не относится по каждому из потоков мы задаем для себя договариваясь бизнесом и внутри команды некоторые целевую квоту то есть тот процент ресурсов команды которые мы хотим задача этого типа уделять и затем мы собираем с нашей доски сколько фактически ресурсов на задача каждого типа было затрачено и при каждом очередном планировании мы стараемся набирать на новые задачи такие чтобы вот это вот фактическое распределение приближалось к теоретическому вот ну и сами значение кого-то сами тоже гвоздями они не прибиты они тоже пересматриваются И вот как раз при очередном пересмотре квот значение текущее значение слова будет влиять на значение квоты отказоустойчивости если мы увидим что в нашем сервисе будет наблюдаться проблемы с надежностью с качеством то мы сможем увеличить код этих задач аргументировано то есть объяснить бизнесу Почему нам нужно это сделать и в ближайшее время исправить этот тренд как бы И наоборот если мы увидим что у нас есть хороший запас по надежности то можем чуть-чуть добавить обороты как раз по задачам этого типа и нарастить объем по бизнесу задачам Так теперь можно ходить наконец приходить к этапу того что у нас итоге получилось стоит на графике так тут представлен самый важный график тот который в принципе уже видели Но вместе с ним Мы также рисуем график с теми самыми значениями по количеству во время и не вовремя доставленных документов которые считаются вот тем самым скользящим окном то есть те сырые значения по которым строятся график с их помощью можем наблюдать какие-то тренды по тому растет у клиента трафик или не растет и как с размерами трафику растет количество проблем и ошибок поскольку эти величины разных порядков то графики построены логарифмическом масштабе а Хоть я и говорил что самым важным исламе нас является квартальная села с 90 дней Мы также строим нашим дашборде графики за 30 дней с агрегацией за 30 дней и с агрегацией за 7 дней их ценность заключается в том что они являются куда более чувствительными и с их помощью можно чуть раньше заметить наметившийся тренд как например мы видим на графиках что совсем недавно пришел какой-то факап и soli за 90 дней просел сразу на две десятых процента то есть 99 85 до 99 и 7 чуть меньше Но при этом остался зеленой зоне при этом ссылая за 30 дней с агрегации за 30 дней он провалился уже сразу желтую зону А если за неделю за семь дней он и вовсе улетел аж красную меньше 98 сейчас показывает если этот сбой будет единичным и не будет повторяться то со временем через неделю этот данные по этому факапы выйдут за пределы рассмотрения недельного Sli и он отрастет снова станет зеленым будет означать что у нас в сервисе В принципе все хорошо за не исключением того самого факапа с причины которые мы так поработаем Вот Ну а если сбой будет продолжаться будут регулярными то этот самый слова за семь дней будет длительное время оставаться в красной зоне и со временем неуклонно падение за собой и с лайк за 30 дней А тот свою очередь то же самое сделает нашим большим и ссылаем за 90 дней и таким образом получается что смотря на графике с меньшим периодом навигации мы можем как бы заглянуть будущее и посмотреть то к чему Мы идем к чему как бы стремимся и раньше отреагировать на наметившийся тренд Давайте дальше Вот все эти графики по которым сейчас говорили их можно построить как сразу по всем сценариям и по всем клиентам так и можно построить по отдельному клиенту или по отдельному сценарию по их комбинации в общем как бы в Любой любой комбинации это может быть нужно для того когда трафик ваших клиентов не однородный как у нас то есть у каких-то клиентов трафик может исчисляться сотнями тысяч документов в день а у кого-то и за месяц Не наберется 10 тысяч соответственно в таком случае вклад Этих клиентов в общие слова и будет тоже разный и тогда на фоне хорошей работы клиентов с большим трафиком мы можем не заметить проблемы какого-то малыша поэтому мы также дополнительно выводим вот квадратиках значение слова по всем нашим Самым крупным клиентам и как раз с их помощью можем увидеть что самый последний факап больше всех повлиял на какого-то одного клиента под номером 8 Вот и у него провалился в желтую зону Давайте посмотрим что произошло а произошло следующее представлен график за длительный период времени за 270 дней и Тут видно что в какой-то момент у нас наметился какой-то деградация качества То есть у нас что-то произошло сli начал постепенно постепенно падать Вот и дошел такой-то нижней точки в этой Самой нижней точке но скорее всего случился пересмотр салон мы эту штуку заметили и приняли какие-то меры мы смогли переломить тренд потом также за примерно несколько месяцев наш Sli постепенно постепенно восстановился до желтый почти до Зеленой зоны если бы не последний какой-то сбой то его откинул так или иначе мы видим что тренд позитивный и Постепенно У нас эти ситуации справиться в действительности под этим скрывался клиент у которого сценарии есть генерация печатных форм то есть когда-то генеришь из xml формализованный пдфку этот процесс не дешевый у нас реализован синхронно и оказалось что в некоторых редких ситуациях когда мы запускаем генерацию и ждем из-за неправильно выбранной стратегии повтора это все приводит тому что генерация занимает неприлично много времени сколько она занимать не должна и вот как правило это работает хорошо в большинстве случаев но этих кейсах плохо то как раз на клиенте с небольшим трафиком это было прям очень заметно что у него таких документов в общей доли не так довольно много И поэтому это серьезно аффектива его Sli Вот лечилась это на самом деле достаточно просто там нужно просто подкрутить настройки даже не меняя кода но сложность была в том что нужно было это заметить и наши системные методы это никак не показывали Это показывал только slo потому что оно смотрит на продукт как бы глазами клиента то есть со стороны Именно его сценариев а не наша система Так давайте еще посмотрим на графике дальше также мы выводим для себя графики по детализации детализации трафика за конкретный период времени То есть без агрегации Вот здесь например выводятся количество документов доставленных вовремя на Верхнем графике в разрезе по клиентам на Нижнем разрезе по сценариям но вовремя доставлен документ не так интересно Давайте посмотрим на продолжим Вот точно так же видно что последний факап который произошел На какого клиента Он играл больше всего тут Конечно вот а за то есть на общее на остальных клиентов не списка важных и также видно на Какой сценарий В каком сценарии это был факап я докопаркинг то есть это выгрузка из diablock получается вот то есть мы можем довольно быстро оценить масштаб проблемы и локализовать ее то есть каком сценарии она произошла и кого она больше всего задела на этом с графиками у меня все теперь давайте подытожим ту какую пользу внедрения самого может принести как мы используем Slon во-первых мы оперативно замечаем и лечим проблемные места в нашем продукте что интересно Еще до того как мы внедрили слово практиковать слов Production еще только вот выбирали пороги и писали утилиты уже тогда Мы заметили кучу Вот таких мелких не оптимальностей которые в общей массе не играли большой роли Но некоторым клиентом доставляли так заметно неудобства и быстро пофиксили их то есть в них особенность была такая что их сложнее всего было заметить если он помогло это сделать далее мы с помощью соло умеем быстро оценивать И анализировать последствия факапов то есть количество оценку дать довольно быстро сколько документов продолжим какому клиенту это удобно Ну и опять же самое последнее но не по значению вернее как короче Последний пункт то что с помощью соло мы отвечаем на вопрос пить ли новая фича нам в продукте или улучшать его надежность и делаем Это объективно обоснованно и умеем аргументировать Это перед бизнесом и Наш бизнес доверяет нашему село на основании этого можем договориться о приоритетах разработки и о том что там уделяли ресурсы на наши технические внутренние задачи а если процессе моего доклада практика слова заинтересовало то Я подготовил несколько простых шагов которые можно сделать для того чтобы примерить её на свой продукт в первую очередь нужно все точно также выбрать самый важный сценарий в вашем продукте здесь можно пойти по пути упрощения и выбрать самый важный самый часто используемый сценарий Исходя из ваших метрики которые наверняка уже есть как правило самый частый самый важный сценарий они будут совпадать Ну либо недалеке от правды затем нужно как-то попытаться измерить его Sli тут тоже можно не усложнять и воспользоваться тем метриками которые либо уже есть либо их очень легко собрать и завязаться именно на них а затем построить графики через месяц посмотреть то насколько ваш сервис получился надежный проанализировать то Какую информацию из этого слайм можете извлечь и дальше принять решение нужна Вам эта штука или нет Если нужна то начать развивать также важный момент что важно не бояться допустить ошибку на каком-то из этих этапов потому что процесс внедрения на самом деле эти оперативной его можно дорабатывать дорабатывать до бесконечности до тех пор пока это приносит какой-то Профит Если Вы какую-то ошибку сделаете тот сценарий следующая операция там можно будет поменять и ваше слово улучшить ведь главная мысль из всего этого что лучше на самом деле проработать месяц несовершенным сало чем бесконечно откладывать его внедрение в свой продукт на этом У меня все Всем большое спасибо за внимание Буду рад ответить на ваши вопросы Спасибо большое за доклад и у нас уже есть даже один вопросик чат Но если вы готовы задать вопрос Давайте если кто-то задает вопрос чат и хочет его озвучить то вы просто понимаете руки и тоже будете озвучивать Спасибо за доклад Вопрос такой вы А вертите по пробиву slo sla Хороший вопрос мы Начали короче мы поняли что нам это важно вот буквально последние недавно время и сейчас мы пытаемся настроить до оптимально для себя ленты чтобы они были Ну как бы эффективно информативно но при этом там не были шумными каким-то надоедливыми то есть мы нас Идея то что мы затачиваемся на недельные ссылая потому что более чувствительный Вот Но проблема в том что факап наступил получается что-то Метрика может долго лежать Вот в этой Самой нижней точке Вот Но пока короче у нас в планах есть Вот и мы скажем так я использую также могу дополнить по причинам Почему мы это решили сделать как бы у нас была ситуация что у вас произошёл факап и у нас с бизнесом была разная оценка от того пока вообще это или нет мы посчитали что это не факап А бизнес-ка уж потому что это факап и как раз мы решили навести в этом порядок вот в э-э понимании масштабов какого-то сбоя как раз с помощью салон Вот как раз попробуем это сделать по идее должно получиться Спасибо есть еще второй вопрос он Возможно не применим у вас не было таких задач когда сервис может быть часть дня предполагается что он будет доступен а часть предполагается что он не будет доступен и соответственно мерить не постоянно силой например да и о соответственно а только в определенные какие-то периоды времени тоже хороший вопрос У нас есть похожая штука только она там не по дню это по месяцу распределена То есть у нас Через наш сервис Через наш коннекторы некоторые компании отправляют свою фи начетность конце месяца получается не такая такое распределение трафика что там 20 дней 29 30 дней месяца трафика может не быть но сзади не нужно успеть выгрузить все документы за месяц но мы посчитали что у нас таких клиентов недостаточно много И поэтому мы вот вписали пока их вот в общую концепцию это тоже на самом деле не так плохо работает в нашей вот схеме О чём можно сделать что этого клиента можно значение N э по времени доставки сообщений допустим сделать равным одному Дню поскольку нужно заднюю спесь и вот таким образом эти метки собирать вот Но если это сценарий у вас является основным то Да нужно считать чуть-чуть по-другому то есть по-другому вот именно подсчитывать тот самый Sli Спасибо Привет Спасибо за доклад А вот на графике у тебя интервал был в один день ну подпись в легенде было А как часто вы вообще считаете этот индикатор график который по реконструктивному анализу уделите или который в графане уже был Давай давай про все тогда посмотреть Первый график который был типа из-за Гугла из этих Google графиков Это был график такой технический написали тузу это спективно и нам нужно было понять что будет если будем вот так считать наше сало тут было удобно выбрать период только играться в один день что мы смотрим просадков такую-то дату Мы открываем наш список посмотрим о чем произошло там открывает список ошибок какие-то чаты открываем пытаемся восстановить что в тот день произошло такого что повлияло наше салон вот поэтому Там просто было удобно день потому что выберем меньше по часам сложнее анализировать выберем и больше там придется целую неделю просматривать чатов вот а уже непосредственно в графане период сбора метрику нас по моему минута то есть мы скидываем их раз с минуту но делаем это синхронно то есть поэтому у нас весовой есть такая как поговорка что на него не стоит завязываться как инструмент оперативного реагирования потому что он может подсчитываться некоторые задержкой Вот и мы не гарантируем что задержка будет маленькая то есть но когда-то посчитается но не всегда оперативно Вот то есть условно вы там раз в день берёте все метрики и как-то просчитываете отправляете графану а нет не совсем то есть мы их считаем и скидываем э-э точки раз в минуту Спасибо И вот в чатике есть вопрос который с предыдущим вопросом тоже наверное связан если понимание как снижение SL влияет на метрики бизнеса тот говорил о том что у вас бизнесом были разные отношения к тому факап не факап вот может поподробнее про это рассказать типа не 99 стало 98 как это на бизнес кажется если если восемь то скорее всего никак потому что в этом случае выполнять не только Sly клиентские 99 который выполняется как бы наши внутренний порог То есть это такая просадка скорее всего никак не повлияет вот А по поводу факап не факап рассказать общем это просто был сбой который мы всей командой не смогли достаточно быстро устранить то есть сервисы работали поэтому копилось то одна вторая очередь мы короче всей команды вручную режиме крутили гайки в нашем сервисе чтобы нагрузку переварить при этом видимо некоторые клиентов были проблемы с тем что стали отправляться дольше чем раньше и клиент начали это замечать но при этом у нас сервисе не было какой-то катастрофы у нас все работало но просто вот надо было руками за все эти штуки штучки дергать Вот и соответственно мы как команда факапине репортили при этом бизнес нам выходил с инцидентами что что-то не так если повод получалось этот самый разногласия После чего мы починили провели небольшую рефлексию в команде И пришли к тому что мы не умеем данный момент достаточно корректно определять пока То есть когда нужно бить тревогу и всех оповещать что насчёт не так вот и там приняли ряд действий Что будем короче лучше и так далее Ну и вот одно из решений было то что мы Давайте настроим вот эти объекты и будем основание них во время дежурства и факапов опираться короче оперативно оценивать последствия этих самых апокапов То есть если мы э наш там незначительный сбой привел к тому что Sli просел жёлтую или даже красную зону то значит это пока то есть надо принять и всех об этом оповестить вообще Кстати вот эта история напомнил Вот когда у тебя сайт находится под нагрузкой начинают медленно работать Что делают пользователи когда видят что сайт этого не загружаются они нажимают обновить страницу Да и получается что делают ещё большую нагрузку на твой сервис угулять ситуацию Спасибо Если ещё вопросы прием Да хотел задать вопрос по расчету Sli к примеру происходит событие когда задержка происходит по причине самого пользователя и это может отразиться в графиках ссылая как я понимаю как вы исключаете это из расчета а вообще отличный вопрос на самом деле это как раз одна из самых основных проблем на этапе вот выбора формулы для Sli и выбора параграф То есть как раз потока что я говорю согласны что ваши метрики должны быть управляемыми то есть не должно попадать только то что вы можете как-то влиять отказы пользователей вы влиять не можете Поэтому нужно Всеми силами вынести это за slite как мы делали Просто анализировали сценарии писали утилиту смотрели какие проблемы сейчас есть это как можем это исключить так например Мы отрезали отказы клиентских поинтов То есть если мы стучимся на FPS сервер либо локальную папку клиентов на компьютере и получаем какую-то ошибку этот момент мы в этот момент считаем документ успешно доставленным то есть мы сделали всю обработку дошли до этапа сохранения по улице сохранить и получилось мы как бы свою часть работы сделали быстро дальше мы документ будем пытаться в ретаре доставить и скорее всего даже доставим но в качестве доставки Будем учиться именно первое время а также нас Мы пошли на упрощение что при отправке документов нас мы как бы тоже берем время начала доставки то время когда у нас долетел нашего облака и срезаем там на входе те же самые проблемы также у нас есть клиентский модуль что приложение которое ставится на компьютер клиента для работы с подписанием и с выгрузкой локальную папку тут тоже мы не застрахован от того что просто человек работник компании клиенток в пятницу у него стоит на компьютере приложение в пятницу выключает компьютер до понедельника оно не работает в этом случае тоже могут быть документы которые стоят в очереди и не могут доставить самой причине или подписаться по этой сам причине это мы тоже полностью вырезаем также есть сценария когда есть отложенная обработка документов то есть документ нужно работать не сразу А например через день Эти Мы тоже исключаем Ну еще может быть несколько подобных примеров То есть просто заметить их и отсечь на уровне алгоритма подсчёта я понял спасибо действительно не самая простая задача научиться правильно отрезать вот все что не относится к твоим факапом например очень сложно сдачи А вот одна из сложнейших реально было Вот ты говорил что это был очень отличный вопрос Вот А у тебя вижу здесь книга лежит Она не просто так да у нас по контрактской традиции Мы за лучший вопрос дарим книгу но у нас наверное еще есть вопросы Да вот еще может быть пара вопросов нас будет у нас еще останется именно пару вопросов а твой вопрос запомнили классный Привет спасибо скажи вот ты показывал скриншот с салон на 80 9 клиентов А что это за клиенты Это же не физически там люди у которых поставлен Смотри я говорил начале что мы работаем с федеральными торговыми сетями вот эта Подсказка что это могут за клиенты на самом деле это те клиенты по которым у нас самый большой трафик то есть сумме Наверно они дают Ну точно больше половины трафика всего нашего продукта на процентов 70-80 это первое во-вторых это важные клиенты потому что у них много поставщиков тоже наши подключено к ним важно для нашего бизнеса клиенты Ну и также они крупные Поэтому у них часто есть свои учетные информационные системы на своей стране поэтому мы в интеграции с ними пишем какие-то дополнительные кастомные настройки на нашем ходом То есть у нас есть некоторая кастомная для них интеграция То есть у нас есть написано специальный подход И мы всю как бы поддержку этого сценария берём на себя то есть мы контролируем его полностью поэтому мы можем позволить себе следить за этими клиентами и в случае если что-то идёт не так есть достаточно поле для мёда чтобы это что-то поменять то есть и до клиента дойти через менеджера и тому подобное слушал то и откуда в этом случае в измерять там со стороны клиента или там время ответа вашего пк-энда мы измеряем все на нашем бэкенде То есть например вот какой-нибудь сценарий поправки выгрузки сообщений допустим заказов едет вот в еде появился заказ это будет начало доставки Сообщения потом наш бренд через лапе вычитал ленту событий получил Этот документ сделать какой-то преобразование провел маршрутизацию Куда нужно выгрузить и отправил допустим клиенту на ftp-шник вот момент когда документ появился начал доставки в момент когда документ тэпэшник это конец доставки Вот это будет соответственно время которое мы учитываем последнего запрос Давайте еще раз благодарим нашего докладчика"
}