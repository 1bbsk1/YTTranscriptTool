{
  "video_id": "blJcY0Z4e3g",
  "channel": "DevOops_conf",
  "title": "",
  "views": 0,
  "duration": 0,
  "published": "",
  "text": "Привет коллеги А мы команда с Бер девайса дивизион продуктов B2B Salut и сегодня мы вам расскажем про наш опыт то как строился продукт типа видеоконференц-связи достаточно сложный продукт то как он развивался Вот только эти были проблемы как они решались достаточно очень прогрессивно развивался продукт и сталкивались с необходимостью применять практики девапса но должен перед тем как мы начнем должен вам сказать У нас есть небольшой интерактив Мы ждем от вас интерактив задавайте пожалуйста вопросы у нас есть Два подарка которые мы хотим вам подарить это могут быть как участники онлайн мы отправим их почты либо люди которые с нами здесь два подарками ждем от вас интересные вопросы самые интересные вопросы получат вознаграждение вот смотрите пожалуйста здесь будем собирать собственно общаться с вами я буду модерировать этот канал и Ну давайте начнем перед вами Виталий Смирнов руководитель отдела дефопса и собственно Виталий тебе слова Спасибо большое руководитель можно сказать направление девопс именно в части продуктов сбер девайса Ну и подолгу службы раз уж я руководитель больше хотел бы сконцентрироваться на организации на процессах нежели на инструментах но я понимаю что наверное это будет немножко скучно данной аудитории поэтому я обязательно в презентацию включу еще техническую часть собственно пара нашей дендики то что мы делаем мы компания Сбер девайс И в частности подразделение B2B производят у нас продукты джаз и Салют для бизнеса собственно говоря про организацию началось все несколько лет назад с разработки продукта очень небольшого и небольшой команды разработки было буквально несколько разработчиков несколько биопсов один буквально два тестировщика и схема прекрасно работала позволяла выпускать продукт классической абсолютно реализация и единственная мечта наверное которая была у команды вовс это Однажды сделать магическую какую-то кнопку которая позволила Всем участникам процесса получать их желаемое с помощью каких-то автоматов и утилит но не было Четкого понимания как Мы это сделаем или с помощью каких инструментов и случилось то что мы не ждали продукт получил довольно большую популярность его стали устанавливать на к себе заказчики на стенды какие-то внутренние заказчики которые у нас были внешние заказчики и вследствие выросла количество самой разработки требования к разработке то есть увеличилось количество разработчиков увеличилось количество параллельных фичей в работе которые они разрабатывают и увеличилась естественно количество работы для вопсов и это привело в один момент к тому что ребята вместо того чтобы делать те самые прекрасные инструменты которые мы думали Начали просто очень много делать операционные работы я думаю что это всем знакомо было кто занимался этими процессами или когда-то сталкивался с такого рода масштабированием и мы поняли что дальше так быть не может потому что один прекрасный момент разработчику просто для того чтобы получить для себя новое новый стенд грубо говоря с его какой-то фичей приходилось потратить там порядка недели просто дожидаясь пока человек заделать его освободиться и сможет ему с этим помочь мы начали обдумывать Как можно решить эту проблему Кроме того чтобы нанимать еще x1000 инженеров и выделили основные проблемы которые мы обнаружили при анализе масштабирования мы обнаружили в первую очередь то что вся работа связана по сути хранилась в одном гитрепозитории огромный маны репозиторий в котором хранилась конфигурация от D водопровода для каждого приложения для каждой версии этого приложения и по сути за счет сложности и размер этого репозитория значительно усложняло командную работу в нем Ну и вторая проблема Это то что артефакты они в принципе зачастую непонятно не разработчикам не тестировщика мне вообще пользователям продукт понимаю под этими артефактами чуть дальше Ну вот типичный пример даже немножко более углубленное от того чего Мы начинали Но я считаю что будет правильно показать именно такой потому что очень много команд работает в таком сетапе что это за сетап это когда существует вообще моно репозиторий не только грубо говоря два псовой но есть репозиторий в котором одновременно и код наших приложений и одновременно Дворцовая часть это какие-то там деплоидная конфигурация ханчардбуки стороне сторонних сервисов каких-то ингрессов роутов все это находится в одном репозитории соответственно чтобы это все дело а мерзли тратится огромное количество ресурсов ну и соответственно часть связанная со стендами обычно управляется отдельности с админами и там хранится зачастую своя отдельная конфигурация фейсбуков связанных для продакшена Engine x-конфляция для продакшена и какая-то инвентарь конфигурация для продакшна в чем здесь проблема Проблема в том что за счет того что в первом репозитории у первого репозитория по сути владелец владельцем является разработчик разработчика волнует по сути только Котова сервиса то есть ему не интересно вот эта вся деталь детали про доставку про стабильность работы софтов продакшене и поэтому когда идет активная доработка наших нашей операционной грубо говоря информации в первом репозитории разработчики зачастую не хотят заниматься тем что опроверять смершри квесты в Мастер это неинтересно и поэтому любые наши изменения которые мы пытаемся делать они могут затягиваться на неделе и по сути реальная работа реальная работа качественная для продукта связанная с его стабильной работой в пройдена получается делается админами в своем репозиторий тихом уютном Связном с продакшеном и так как получается у нас есть два основных места создания ценности и у одного создания ценности грубо говоря владелец разработчиков другого админ получается что это люди у которых слишком сильно отличаются миры их задачи и они вместе работать зачастую не хотят над этим только если сильно заставить вырастает как это называется каменная стена через которую кидаются проблемами так Прямо скажем основные проблемы которые здесь в таком подходе Я немножко уже рассказал Мир же согласуется очень долго часто нужно и за счет того что они долго согласуются получается как Снежный ком для того чтобы его обратно в мерзнуть нужно сделать rebase снова отправить на согласование просто счет того что он неделю висел и мастера за это время успел от вас уехать и за счет этого возникает конфронтация токсичная культура и так далее так далее Все таки devops я считаю это в большей степени как раз про созданию благоприятной атмосферы благоприятной культуры и уже в следующую очередь это все-таки про инструменты и того как мы это достигаем с точки зрения техники и дальше у нас схема была уже все-таки немножечко более провоцировавшего И в чем она заключалась в том что по сути разработчики все-таки хранили свой код в своих отдельных репозиториях то есть в системе было несколько микросервисов у каждого микросервиса обычно свой разработчик и свой грубо говоря репозиторий и в этом случае у нас вот этот вот моно репозиторий с операционной конфигурацией он у нас был конечно же отдельный монорепый и там уже проблема между собой решали в опции с админом Кто кто грубо говоря За что отвечает Кто как что мержет тоже схема конечно лучше более работающим но все равно когда начинаешь масштабироваться все равно возникает проблема все равно начинают разбивать его на два и начинается опять же бросание проблемами поэтому мы пришли к какой схеме то что нужно максимально разделить зоны ответственности именно по репозиториям то есть для того чтобы не создавать кашу из конфигурации приложений в этом общем он репозитории мы вынесли конфигурацию приложений таких как Hell мы какие-то Фейсбуке непосредственно в репозитории к самим приложениям а репозитории информацию о стендах о инвенторе разделили Соответственно репозиториям по владельцам этих стендов И вынесли отдельно библиотечную часть которая позволяла все это вместе объединять работать воедино но вы этого подхода тоже есть проблема которая сейчас дальше продолжу она связана со второй частью А проблема заключается в том что как только мы вынесли такие вещи как репозитории к разработчику выяснилось как бы что это та часть никакой либо делать не хотят либо хотят делать только какие-то разработчики которым это интересно Прямо скажем Либо они следуют стандартной схеме То есть у них есть проблема не идут в отдел devost просят задачу ребята сделайте Помогите и Ну опять возникает ситуация когда в релизном процессе инженер обязательно где-то участвует он должен если мы хотим выпустить Новый сервис хотим что-то поменять нужно подключить другого человека чтобы задачу решил но какая тут проблема обычно у этих команд разные вообще приоритеты команды вовсе разработки и разные спринты и получается так что разработчик вроде бы задачу свою закрыл но чтобы закрыть до конца чтобы поставить вот этот финальный тег что его софт закончена Вот это так протегированная версия можно использовать получается заблокировано другого человека из другого подразделения которому как бы свой спринт может запланировать его завершение на получается вот этот рассинхрон зона ответственности размывается и как бы люди начинают Ну а вполне обоснованы токсичать потому что продукты надо сдавать продукт надо делать поэтому эту часть мы видели понимали и что мы решили разобрать Мы решили разобрать какого рода задача вообще делает у нас devops инженер по запросам от разработки То есть это те самые какие-то хамчарты может быть твои Буки конфигурация для сторонних сервисов таких как Engine X либо какие-то роутинг сервисы внутри коробки и конфигурации президентных сервисов таких так например там кавка позли сребит для них какая-то предварительная конфигурация для того чтобы на стенде был и работал соответственно требованием как мы решили эту проблему мы выделили из всех этих артефактов ту часть которая относилась именно к модели самого приложения и выделили части которые не относят относятся только к приложению То есть это сейчас я покажу на через вот так вот сделаем вот вот так относится только к этому приложению И вынесли их в модель на ямы самую простую человека читаемую простой человек читаемый формат для описания такого рода вещей То есть это грубо говоря если быстро пробежаться мы попросили разработчика указывать где приложение исходящий интерфейсы сетевые И не только то есть допустим Кафка топик для консольных приложений тоже входящий интерфейс указать его параметры То есть это какой-то там порт или там имя топика и исходящий интерфейс если приложение куда-то идет в какой-то сторонний сервис какой-то стороннюю систему зачем-то соответственно просили разработчиков указать это то что вот вам это нужно и по сути вот эта модель конфигурация приложения разработчиков стало выглядеть очень просто в этом случае то есть они просто говорят вот у меня вход называется такта А вот у меня выход называется такта вот здесь у меня метрики вот сюда Дай мне пользователя вот сюда мне отправишь пожалуйста другие какие-то приложения по ip-а или через gitway И что это что это позволило нам сделать это позволило во-первых очень сильно упростить работу инженера потому что больше не пришлось писать вот эти два сложные артефакты ему достаточно было написать очень короткую Модель которая по объему текста который необходимо сделать и потом отладить проверить там внутри взаимосвязи где-то Раз в пять точно меньше в зависимости от сложности там ну прыгает от 3 до 10 раз количество текста которые нужно просто написать и в отличие от других каких-то форматов Ямал надо проверить только что синтаксис нигде не потерялся это позволило Нам очень просто показать и научить разработчиков Как менять эти описания переиспользовать их для других сервисов если сервисы Похожие и эффективно выключить из себя из этого процесса то есть грубо говоря разработчику стоило какое-то время пообщаться с нашими инструментами пройти пару наших обучений после этого больше к нам не приходил это невозможно было сделать если мы просили разработчиков самостоятельно заводить Фейсбуке или подобного рода сложные либо всякие штуки То есть это можно потратить кучу времени и ты там два разработчика из десяти у тебя будут это делать с этой моделью делают все вообще то есть как бы по первости могут даже прийти но когда они понимают что они могут делать это всё сами тестировать сами то есть грубо говоря по правила модели Сразу увидел как это поменялось на стенде сразу Можно я добавлю прямо пару слов это такая типичная проблема когда вас приходит к вам как сам куча разрабов И просит что-то сделать быстро и это нужно делать действительно быстро потому что становитесь блогером и по мере роста продукта вот этих запросов становится еще больше больше и нужно с ними что-то сделать но логично их просто автоматизировать и поставить на поток исключив себя из этой цепочки то есть люди обращаются уже не к вам как человека который выполняет задачу а к системе которая принимает на вход параметры и делает это вместо вас Спасибо Дима это было здорово Это было очень круто из мы стали смотреть какие еще задания в принципе приходят инженеры это группа заданий от Как называется провождение То есть это задание но на создание стендов на раскатку на установку наших софтов и если у нас грубо говоря много ручных действий в этих всех операций операциях то опять же без какой-то помощи без человеческого участия здесь не обойдешься и вот в качестве примера то есть какого рода может быть артефакт необходимо создать если тебе пришло задание То есть это Например какая-нибудь конфигурация та форма это может быть инвентаре и опять же за счет сложности сегодняшних инструментов если мы попросим того же разработчика здесь что-то добавить поменять или инженер сопровождения или qa можно этому их научить но сложно научить всех и так чтобы это всем понравилось потому что зачастую сложность вот этих инструментов не позволяет выделить это именно как функцию поэтому мы сделали то что уже у нас хорошо получалось это мы просто сделали еще одну модель стенда которая позволила нам по сути в простом формате человеку Описать как он видит стенд И что там Хочет переопределить Что также эффективно позволило передать эту функцию всем людям которым это было интересно в частности это функции пользуется даже в первую очередь больше разработчики Потому что им в первую очередь нужно поднимать для себя специализированное окружение в них комбинировать различные сервисы с продуктами То есть если говорить про схему репозиторов получилось Примерно вот из этой схемы которая показывала ранее получилось сделать что-то вот типа такой схемы То есть у нас в гидропозиториях с приложениями начал находиться код и модель приложения за который разработчик уже мог ntvent отвечать сам и соответственно в своем спринте задачу закрыть сам если у него что-то не получалось он мог привлечь грубо говоря инженеры просто быстрой консультации то есть не то что там нужно погрузиться понять как работает приложение сделать задачу нужно просто набрать там Виталя привет скажи вот как так так сделать чтобы он там пример в другом приложении так сделано вот копируй просто Вставляю тебя будет все так же классно Здорово работать он копировать составляет все задача закрыта спринт закрыли разработчик счастлив счастлив бизнес счастлив это очень здорово то есть получилось так что у нас появился еще репозиторий преобразователи моделей Ну поэта чуть позже Может быть расскажу само по себе введение этих двух Практик привело к тому что количество сервисов помноженное на стенды то есть грубо говоря сервис Это что это вот у нас есть продукт который мы хотим на стенд раскатить в нем есть какое-то количество сервисов там поначалу там три 10 потом 30 и чем у нас грубо говоря сложнее процесс разработки тем дольше у нас будет нарастать количество установленных работающих стендов и количество сервисов на них но введение этих двух Практик позволило нам настолько ускорить этот процесс что и разблокировать его что вот Как видно на графике мы росли грубо говоря Ну вот мы там до 200 сервисов шли получается год или даже что-то типа того и потом резко Ну просто пропорционально несколько раз стали быстрее гораздо раскатывать наши сервисы и разрабатывать их Но после того как мы это сделали возникло следующая проблема Как которая немножко уже может быть про тизел до этого это то что кроме приложения отдельно и кроме непосредственно стендов У нас есть еще такая версия лишь Как наш продукт Что такое продукт это набор сервисов которые мы используем сконфигурированной определенным образом под задачу то есть грубо говоря что имею ввиду то есть допустим если мы делаем какой-то коммуникационное решение в этом коммуникационном решении может быть например дополнительный Flow проверки чего-то там на антивирус и если этот слой Мы хотим включить а он может быть выключен потому что решение мы делаем коммерческий какие-то функции могут быть платные какие-то нет Нам необходимо встроить какой-то сервис Flow движения данных по кафке то есть грубо говоря у нас немножко в подробности войду допустим у нас есть специальный механизм который пока в катопиям раскладывает сообщение которое мы должны В итоге дойти до пользователя и чтобы добавить какой-то дополнительную проверку какую-то функцию системы мы должны перенастроить сервис и так чтобы у нас добавилось дополнительные Кафка топик и добавилось правила обработки что соответственно нужно переложить в этот топик сообщение на обработку и какой-то сервис антивирус допустим проверка должен зайти и обработать все эти данные в нем то есть задача кажется вроде простая Но на самом деле для того чтобы это сделать нужно поменять конфигурацию в двух трех сервисов перенастроить что-то накавки То есть это если не было никакой автоматизации это была бы задача инженеру сопровождения там на часа четыре а то и восемь во всём этом разобраться завести так чтобы это всё дело работало но за счёт модельной вот этой структуры и создание такого понятия как продукт оно позволило нам это всё описывать просто как шаблоны то есть шаблоны конфигурации галочки в интерфейсе то есть мы грубо говоря говорим есть проверка антивирус есть Включи эти сервисы и перезагрузить об этом Может быть чуть дальше Еще подскажу как про механику это работает когда дойдем до инструментов которые мы Это реализовывали непосредственно соответственно раньше как Мы собирали продукты то есть это была ручная ручной вообще метод то есть мы шли какой-то стенд допустим ФТС него снимали слепок какие там стоят сервисы Какие смотрим там выбирает разработчики тестировщики допилили чтобы в итоге продукт финальный работал как надо и делали из этого руками по сути продукт уже финальную сборку продукта нам это так это происходило довольно редко на том этапе нас сначала не сильно загружала но потом это стало происходить часто потом стали продукты с разными фича ветками создаваться под продукты и Ну как выяснилось что это опять такая задача которая просто блокирует его отдела вместо инструментов он опять делает да Опять делает какую-то текучку нас это очень сильно напрягало поэтому хотел добавить что это происходит момент когда продукт становится уже ну приносящим какую-то выгоду Да и восстанут выходит на рынок его начинают потреблять и потреблять он начинает больше чем вы можете производить но тут нужно расти и в этот момент возникает как раз нагрузка на инженеров на людей которые можно немножко сгладить За счет средств автоматизации Да все так спасибо Дим соответственно мы сделали то что уже до этого делали просто еще одну модель еще одна модель которая писала продукта по сути это была комбинация модели стенда с дополнительными наработками И докрутками сверху которые позволяли это описывать именно гибко и опять же это позволилопс инженеру не заморачиваясь сделать этой операции быстро и передать по сути эту функцию инженеру кей и потому что я обычно отвечал за финальный состав релиза Какие софты пойдут какие они пойдут что грубо говоря прошло тестирование что нет и получилось так что органично даже мы как бы не передавали наша команда тестирования сама взяла этот процесс свои руки и начала по сути работать с продуктом привлекая конечно там нас или разработчиков когда возникают какие-то тонкости но основная часть вот этой текучки движухи по созданию продуктов веток раскаток куда-то все ушло на их сторону опять же мы почувствовали что мы опять высыпали руки и по сути из вот этой схемы где вроде бы у нас уже все было круто и мы были свободны получилось вот такая схема из моделей получился у нас еще дополнительно еще один репозиторий под модель продукта Ну а теперь это часть большая постарался рассказать вам организационно Давайте немножко расскажу по поводу технической стороны как мы это реализовывали и как это все дела эволюционировало вообще исторически какого рода вещи мы использовали то чтобы реализовать вообще это модельный подход самое первое было вот не поверить Это был Баш потому что самая первая модель были довольно простые у нас были довольно простые грубо говоря стенды довольно простые ещё продукты и мы довольно легко смогли реализовать подход когда с помощью довольно большого тяжеловесного больше скрипта у нас происходило преобразование простых плоских моделей в то что нам нужно то есть грубо говоря Как так называемая проекция стенда но Баша были конечно серьезные минусы и немножечко сейчас назад отмотаю будет логичный вопрос почему не питон питон такая вещь которая нужна подготовка окружения все-таки когда мы делаем средства раскатки вот конкретно там моя команда Мы очень любим делать некоторые средства эти работали везде у них была хорошая текучесть то чтобы можно было его перенести там на компьютер на macos перенести на Linux и он везде работал примерно одинаково Естественно для этого существует докер но докер это уже когда мы что-то более сложное запускаем когда вот у нас первичный идет Старт то есть мы хотим просто сказать какому-то инструменту и Привет Я хочу это соответственно надо где-то докер скачать или может собрать В общем этот так вот ходу не делается поэтому изначально мы взяли сразу Баш и на нем это все дело сделали но за счет того что в машине было возможности работы со структурами данных серьезными структурами данных приходилось много в нем делать доработок На том же самом питоне и дополнительных каких-то инструментах но мы сразу стали подыскивать замену и для того чтобы реализовать более мощное крутой продукт понятно что надо было делать либо уже программные сложный продукт там тот же там взять питон либо гошку сделать на нем что-то красивое но хотелось сэкономить по максимуму времени мы стали искать какие вообще есть альтернативные варианты один из основных который бил в лоб и который все говорили это конечно а почему потому что у него огромная база пользователей плагинов огромное количество людей на рынке можно купить как бы который знает нси был собаку на нем съели там есть работа со структурами данных там есть джинджа два шаблона То есть это классный современный инструмент управлять инфраструктурой Ну и был вариант он появился несколько Позже это тараформ почему он появился несколько позже потому что именно продвинутая работа со структурами данных в трафформе появилась по-моему версии 0.12 это который вышел в мае 2019 года а начинали мы всю эту Движуху где-то кодов 18 поэтому про формы с нескольким запозданием начали делать но прыжок нашего апгрейда был сразу с башенной Сначала был Баш долго пытались завести был и потом сразу прыгнули трансформ теперь немножко поговорю Надеюсь будет холиварная попробую объясниться Почему мы не пошли в балл И почему мы не перевели наши инструменты на нем потому что мы собираем Наш модельный движок Мы у нас он уже был на Большой он уже работал уже работал в продакшне везде он уже хотел наши средства и как бы команда разработки летела как на ракете вперед и основной был в том что буквально там за 5 секунд если мы собираем продукт из трех сервисов из нес буквально за 5 секунд он этот продукт мог преобразовать в проекцию и отправить на выполнение инструкции на там сервера cubernet еще куда-то на то чтобы все там запустилось раскатилось нужно конфигурации инсигловый же движок делает работу гораздо медленнее и почему он делал медленнее на примере здесь он там 30 секунд трансформ там в районе 8 я сразу на следующий сайт и продолжу То есть когда мы завели продукт уже Более сложный из 70 сервисов был у нас там момент Пика в районе 70 сервисов на одном из продуктов Том вообще ужаснулись потому что ну грубо говоря если Баш еще понятно там как-то в 5 минут укладывался терраформ тоже в районе где-то плясал то энси был стал работать вообще больше 50 минут надо понимать что не самый так работал или на себя плохой или хороший инструмент мы решали задачу нетипичную то есть мы не грубо говоря не брали готовые инструкции на земле на трансформе или на Боше мы грубо говоря просили этот инструмент язык фреймворк для нас подготовить из модели данных эти инструкций и потом применить их и вот эта вся операция почему она тебе например долго выполнялась потому что там очень сложно эти операции распараллелить то есть там всё что связано с динамическими циклами особенно какими-то логическими очень плохо параллелится и на каждую операцию происходит процесс на питоне Что приводит к тому что когда у тебя большая модель много сервисов у каждого сервиса есть куча объектов конфигмент конфиги шаблоны все это между собой взаимосвязано там получается модель общая модель Если вы говорить про вот эту с Ямал модель целевой проекции она может занимать там 5 мегабайт 10 мегабайт для стенда и соответственно Когда это все строит много раз через себя прокачивает это работает очень долго и для нас был очень хороший пример тогда ориентир мы смотрели на то как работают средства раскатки кубера Ну в частности openshift Если знаете Enterprise версия cubernet для openshift третьей версии использовался как раз таки чтобы его раскатывать и если мы поднимали какой-то более-менее там нормальный кластер три ноты Там пять воркеров занимал это по-моему 30 минут и более то есть настолько долго это выполнялось если мы пытались раскатить какой-нибудь openstek вообще можно часами было ждать пока что-то там выполнится и перед глазами был другой пример через некоторое время установщик и от компании раньше установщик губернации это грубое решение которое позволяет установить cubernets Ну вот если раньше говорить в не с помощью программы их продукта То есть это именно программа которая устанавливает так вот она то же самое Аналогично cuber Может поставить не за 30 минут он может поставить это за в пределах секунды в пределах минут то есть группа это 1-2 минуты всё готово всё у тебя уже раскатано нам сразу стало понятно что если мы делаем что-то сложное какой-то большую систему раскатки то Ну вероятно не получится хотя мы попробовали мы написали два вида движка один был там грубо говоря там показывают 50 минут Да у нас там получилось сократить время до 35 но это было всё равно неприлично То есть если вернуться там к анализу по нашим инструментам Баша Конечно была высокая скорость на нем невозможно было дальше усложнять наши инструменты А без осложнения Ну как бы опять в офис начинали делать очень много работы руками и в частности как большинство команд на используя вопрос решали Ну и решают это они просто разбивают свои сложные фейсбуке на под теги то есть грубо Выбирайте там хотите не 70 сервисов хотите 3 Выбирайте специальные теги которые позволяют это делать но вот это само событие в этот момент когда мы решаем так сделать оно убивает вообще простоту в ноль потому что для того чтобы это сделать человек который этим пользуется должен знать какой тег поставить прочитать где-то эту инструкцию должен кто-то актуализировать То есть это уже нельзя сделать грубо говоря веб-интерфейс есть кнопочка сделай круто то есть вот там магическая кнопка которая все мечтают С таким подходом и просто не реализовать Нужно ещё параллельно программный инструмент который все эти теги знают в нужном порядке правильно умеет запускать поэтому Почему мы выбрали трафон Да потому что в нем этого всего не было traphorm очень хорошо круто работает с моделями написано ногой Он очень быстрый то есть там аналогичные грубо говоря просчет вот этой модели стенда он выполнялся ну вот я на слайдах показывал но уже приемлемое количество времени выполнялся очень модель большая все равно долго считается Но это приемлемый промежуток времени и самое главное То что траформ по сути он в своей базе своей как базовых функциях Он поддерживает различные сценарии наших решений такие как установка обновление удаление все в рамках одной кнопки там трансформа Play все у тебя по сути поставить обновить изменить конфигурацию все все в одной функции и трафор для того чтобы все это все эти функции удалить и не функция стенд наш продукт с него что по сути позволило нам в 2019 году создать концепт как раз таки на 0.12 движки вам было в сентябре у нас был концепт сделанный уже по моему через месяц в октябре мы плавно перевели вообще все наши стенды на этот Новый движок модельный за счет того как просто и круто староформе это было сделать мы добавили ввели новую как раз таки модель продукта то есть до этого нам было очень сложно и дорого это внедрять потому что движок на большой уже работал просто на таких костылях страшных что сон было страшно как это живет и работает сейчас модель продукта сюда ставить будет ужас Все это позволило нам продолжить расти при этом не зашиваться и продолжать работать над нашими инструментами Ну а в принципе этот модельный подход что позволил сделать позволил нам как бы настолько создать вот язык описания наших софтов и наших продуктов Что позволило по сути создать универсальный установщик любого продукта То есть как он формируется это приложение конечно же Но у него есть меню которое работает с пользователем просит что-то вести а само меню формируется с помощью другой gs1 под модельки продукта То есть у нас продукте есть под Модель этого меню который может описать Любой человек не связанный там с пониманием как что внутри работает он должен просто напихать эти настройки и какие-то понятные слова написать для пользователя и набор вот этих инструментов позволил нам поддержать множество продуктов внутри компании то есть мы грубо говоря поддерживаем Там не только там ВКС решение мы поддерживаем много еще других продуктов И россияне пользуются централизованными нашими библиотеками И по сути делают одни и те же грубо говоря наши Функции там установка раскатка с помощью одних и тех же тулов ну естественно как бы проблема у нас все равно есть проблема например в том что за счет того что мы очень сильно усложнили просчет этой модели на трансформе доработка больших конфигураций стало довольно затруднительной То есть если человек давно работал знает как там вот эта вся мозги вот эти огромные устроены он конечно довольно легко это все поправит но как привлекаешь нового человека обучаешь его ему дается сложно довольно это обучение потому что форма нету четкой последовательности действий выполнения просто описываете конфигурацию и потом уже тараформ сам считает В каком порядке что правильно выполнить надо быть немножко самому Чтобы понимать как там это что работает это классно когда у тебя не сложная какая-то там структура не очень большая и легко человеку объяснить но мы вырастили настолько что конкретно сейчас планируем вот эту именно логическое ядро выносить и переписывать на какой-то другой именно программно я думаю что инструмент возьмем что-нибудь типа голланга или питона и на нем напишем эту часть ядра но при этом трансформе все равно оставим для того чтобы использовать его как раз таки вот эти классные функции по слежению за состоянием целевых наших стендов чтобы можно было устанавливать обновлять удалять и так далее То есть именно модельный наш движок Мы оттуда вынесем и по сути еще я думаю что это позволит сильно ускорить работу всех инструментов ну и плюс утро формы есть некоторые сложности с тем что вот он не очень гибок в плане динамической конфигурации бэкендов не хочу поддаваться подробности что это ну вот тараформить там зависимости вот их Мы хотим зависимости от наших продуктов куда мы ставимся чтобы они были по-разному настроены и это салон Трансформеры настраивается не гибко плюс связь между модулями То есть если очень большой продукт на Таро форме делаешь связанность между модулями начинает сама по себе не гибкая плохо выстраивается там Граф как раз таки вот этот построение плана изменений для того чтобы это всё обойти мы ребята стали использовать мои ребята его использовать для того чтобы этот вопрос решить Но более подробно Я думаю что мы кто-нибудь из моих ребят выступит на будущих конференциях расскажет об этом если это будет интересно то поделимся обязательно потому что тема классная но важна для команд которые вот активно очень юзают Трансформеры хочется уже от него прям выжить по максимуму по моему там дальше твой сайт Давайте попробуем немножко подытожить то чего мы начали то о чем мы рассказали Я думаю понятно какие проблемы писали с наиболее ценность для меня представляла именно понять А как была организована работа между командами да то есть это все-таки взаимодействие в первую очередь людей с людьми они машины с машиной да И тут взаимодействие сначала прошло Потому что таким бутылочным горошком был департамент который должен был понять выполнять задачи которые лавинообразно накапливались с учетом того что продукт сильно развивался и в него больше функционал включалась а в итоге мы увидели с вами когда Ну вот решил эту задачу потом решил задачу пользователей который привычный интерфейс где раньше кликнули с Вами Мы также могли под капотом видеть там что-то подобное трансформа здесь кстати очень удобная штука а в плане того что тараформ это сущность которая утилиты которые при нас каком-то состоянии Да И вот из не документированных возможностей Я в своей практике встречал вещи когда тараформ Ну принципе это инструмент Да почему бы не управлять например умным домом То есть у нас с вами есть система скажем Вишенка на торте проформ и мы хотим привести эту систему в какое-то состояние у нас есть система когда мы ушли в отпуск у нас есть лето Когда нам нужно включить кондиционер У нас есть вечер день Почему бы не использовать его это вообще классная вещь Ну и все выходящие отсюда подобные системы которые мы приводим в какой-то состояние Ну например микроволновка Мне очень нравится где мы включаем режим с таким-то объемом с таким-то уровнем заморозки и мы хотим получить на выходе Ну либо курицу гриль либо какую-то другой продукт вот ну наверное на этом можем закончить плавно Да вопросы которые задали в чате посмотрел предлагаю на них либо Ну если у кого-то есть живую мы можем вживую ответить Либо пойти в следующую комнату нет здесь можно ответить пока наверное вопрос который в чате Правильно же ну Давайте попробуем просто Их достаточно много я не знаю выберем самое интересное знаете сколько мне понравился вопрос Ну то есть мы открыты ко всем обсуждениям но Давайте вот такое скажу Александр зильбер какие были проблемы с travoм ой ощущение что вы езды оп с командой эволюционировали в платформе на команды сделали для разработки idp Internal deviloper platform конечно Конечно есть мы всегда хотели быть командой который идет платформы инструменты Да и мы по сути стали этой команды очень счастливы то есть если микрофон передадут то будет Ну не сказал бы что это обязательно произойдет и я не сказал бы что мы сидим отдельно от разработки То есть у нас есть как бы команда с которыми близко взаимодействуем которые хотят надо вопрос надо было повторить чтобы было понятно вопрос получается был если ты вопс будет сидеть отдельно не получится Так что он сам вырастет платформенную команду не вырастет он как бы будет сидеть Что значит отдельно наверное будет работать как-то по заявкам и будет бесить тем что это работа у нас происходит по как медленно бюрократично заявка не в том формате от этого тут не написал тут непонятно что имелось ввиду и работа не будет эти будет эти переписка в жире Это ужасно я такой не люблю и очень часто бывает вообще если девопса делаю так существует отдельно Он может вообще сказать мы занимаемся только пайплайнами системный Инжиниринг Это не наша история мы не занимаемся там проведением состояния как бы мы вам сделаем чтобы вас ставилось вот отсюда сюда дальше Идите сами разбирайтесь Это не наш подход мы никогда ему не следовали мы всегда были рядом с разработками всегда решали задачу npn то есть вот есть софт фича надо чтобы она была у заказчика А перед этим была на деве на тесте и вот мы как бы были участвуем во всём этом процессе сейчас до сих пор Ну это как бы наша ДНК что сильно отличает от многих других Ну если мы ответили на вопрос давайте у нас время остается буквально 5 минут Давайте Маленький коротенький вопрос потому что ну мы не сможем развернуть даже сам вопрос некоторые требуют интерпретации как в итоге ямаль H7 преобразовывали Я же правильно понимаю что ямаль модель остается под капотом несмотря на веб-интерфейс это Алексей кандинский простой вопрос Не ну он классный Он очень правильный конечно на самом деле в траформе есть такая штука Как forage ресурсах То есть когда можно стать динамический ресурсы можно сделать так чтобы ресурсы создавался не создавался и создавалось какое-то количество соответственно мы брали вот эту модели То есть как у нас там под капотом отработан У нас есть модели приложений мы их склеиваем грубо говоря то есть у нас там если Ну как бы вдаваться в технику что там сложно э-э мы их склеиваем несколько раз то есть Сначала мы как бы создаём область видимости где мы видим вообще что есть на стенде Какие приложения есть грубо говоря хвосты потом мы грубо говоря Соединяем и повторно перезагружаем модель уже с данными из внешнего мира и после того у нас получается финальная грубо говоря Ямал модель стенда то есть мы как бы стенд собрали из всех этих кусочков И после этого уже в тр-форме просто идет грубо говоря обращение к этим объектам из модели то есть там грубо говоря есть сервисы какой сервис типа то есть тогда нужен дипломинт У сервис соответственно из диплом это не исходящий интерфейс с портами там какими-то соответственно надо создать сервис там надо хедлить сервис отдельно может создать и пропихать вот эти настройки везде все это дальше уже под капотом движок делает еще маленький простой вопрос Если у нас практика дежурств плюс дежурств девопс плюс разработчик и если нет планируем ли мы это делать дежурство наверное для решения проблем в продакшене но я так понимаю да то есть это где продукт уже одна какой-то уровень обеспечения где есть соглашение от заказчиками дежурство в основном есть командах внедрения в командах сопровождения Ну а с нашей стороны как бы у нас ситуация такая что не так много к нам идет именно обращение проблема с нашими инструментами нас не было необходимости вводить так практику дежурств нас если что-то случается даже нерабочее время звонят мне я там как-то разрулю этот вопрос то же самое с разработчиками Но если такой возникнет Конечно мы введём практику дежурств если мы заметим что идёт много такого рода ситуация это все будет но тут Наверное это дело внедрения добавлю что практика есть просто Ну каждый в какой-то степени девапс То есть у нас есть должность У нас есть ролик каждый может на это несмотря на свою должность взять эту роль devops А если что-то нужно срочно починить и так понимаю Да все так ну чем глубже просто в отдел тем глубже компетенция и иногда бывает достаточно просто человека кто на линии находится там Позвонить кому-то от нас спросить что-то и он уже знает как это исправить так еще маленький вопрос Александр зельберт у вас одна девушка команда на все продукты и Инфо Ну тут Наверное Вот Мы представляем именно Сбер девайс во-первых Да это некоторые департаменты внутри него на разные продукты есть наверное Ну разные Нет Есть разные то есть мы конкретно изначально там были с одним продуктом Потом мы стали добавлять себе другие в поддержку и так как ну как бы мы немножко Как можно сказать более премиальный сервис devops у нас соответственно мы Ну у нас много бы личного общения может быть с разработчиками поэтому у нас все равно ограниченный набор команд Мы конечно постепенно растём пытаемся сделать ещё интерфейсы проще документацию понятней чтобы можно было ещё больше команд подключать ну в первую очередь у нас всегда в приоритете Конечно стоит наши продукты поэтому тут вопрос приоритетов но в Сбере очень много избирать девайсов в частности других продуктов других команд и у них есть свои подразделения плюс то что мы делаем Это очень ценно для сложных продуктов крайне сложно которые активно разрабатываются и которые должны устанавливаться где-то он прям где-то в каких-то местах таких не э-э ну которых нет доступа а много других есть продуктов которым это просто не надо у них есть там 1 2 3 стенда в Облаке ещё что-то для них не нужны такие сложные процессы и нет смысла заморачиваться не с этими моделями ничем-то ещё Нафига им это надо они могут сделать всё гораздо проще по стандартному пути пойти и будут правы к ним никто вот я не приду скажу что этого не пользуетесь Нет мы делаем именно сложно системный инженеринг - это вот наша фишка здесь ещё и характер клиентов говорит о том что этот скажем уникальный случай Куда внедряет эти продукты то есть там это ну нет такого что одна конфигурация Да как мы поставили Windows на ноутбук и он теперь там работает одинаковой конфигурация на всех подобных ноутбуках ещё один маленький вопрос хотя у нас 20 секунд остаётся ну Давайте попробуем давай же правильно понял что ваше решение подразумевает некоторую коробку которая полностью устанавливает конфигурирует инфру плюс ставить приложение да и в том числе То есть у нас есть универсальный инструмент который как я показал он может вам либо на виртуальных машинах либо Metal поднять кубернетис туда поставить наш Solution либо можно выбрать настройках появится в другой какой-то например кстати Open Shift за счет того что у нас настолько вот Большая вот эта абстракция мы позволяем продукты одновременно разные установить как Open Shift так и в кабернета основные отличия там будут в том что в Open Shift используется объекты типа Роуд для описания входящего трафика Ой мы вышли за время и вот мы этот конверсию делаем под капотом прозрачно для разработчик Спасибо Спасибо"
}