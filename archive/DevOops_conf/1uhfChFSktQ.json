{
  "video_id": "1uhfChFSktQ",
  "channel": "DevOops_conf",
  "title": "",
  "views": 0,
  "duration": 0,
  "published": "",
  "text": "Всем привет да Всем привет Меня зовут Андрей У нас сегодня Олег ванисетский Газпромбанка и мы категорически Приветствуем всех на ди вобсе Олег там все не расскажешь я расскажу нам про фичи окружения звучит Интересно Много кого-то такая проблема возникает и сразу предупрежу наших зрителей ребят если вас процессе доклада какие-то возникают вопросы Вы хотите чтобы спикер на них ответил потом в конце или же просто некоторые недопонимание обязательно пишите в чат я буду следить и потом самые интересные как мне кажется вопросы Я сдам нашим спикером в конце либо в процессе доклада и или же мы обсудим в конце уже искушенной комнате звучит Классно да и Олег прежде чем мы начнем Я вот хотел тебя спросить ты в описании всем профиле написала что последние 7 лет ты себя скажем так идентифицируешь как мне стало интересно вообще Как и почему так к этому пришел Ну сподвигло в devops я пришел из системных администраторов Я очень долгое время был системного администратором на банке в местном машиностроительном предприятии внедрялся и в какое-то время у меня была ачивка стать программистом и я устроился в банковский информационной системы разработчикам ABS бисквит - это ну как бы топ-4 по рынку ABS в России вот и это было Ну на самом деле достаточно скучно Это было Это было enterprice скучная с кучей Legacy а очень как бы такая специфичная платформа а-а знания по которой вряд ли можно было продать в России и какое-то время я понял через какое-то время я понял что меня это не нравится а вот начал думать куда уйти и вот как раз тогда был подъем диоск культуры только-только начинался и А вот Судя по описаниям культуры в Судя по описанию методологии это выглядело очень перспективно и таким образом я удовлетворил с одной стороны свое желание стать система администратора вернуться в какой-то степени системы администрирование плюс писать код почувствовал что будет хайп и сразу но перспективы безусловно перспективы подходы были видны И как тебе нравится да Я балдею Вот это очень интересно тут когнитивная сложность примерно как программировании и задачи но Ты близко к инфраструктуре ты решаешь реальные проблемы Ты видишь как ты решаешь проблемы как они идут от тебя к народу решения звучит очень круто что я думаю ты всех заинтриговал зрителей мы можем уже приступить непосредственно к самому докладу а да Давайте приступим Итак я Олег из Газпромбанка и сегодня буду я буду рассказывать про фичи окружения сперва Пару слов про Газпромбанк Газпромбанк это действительно большая корпорация с мощнейшим it там много разных интересных интерпраздных дорогих игрушек Где в центре инноваций человек сотрудник В общем Приходите к нам у нас есть печеньки все такое прочее поговорим про фича окружения Что такое фича окружения вообще я слышал много название для фича окружения кто-то называет фича кто-то ревью кто-то превью но суть этого паттерна в следующем У нас есть программист который пишет Код Этот код он комит в какую-то определенную веточку из этой веточки собирается артефакт который доставляется в инфраструктуру предприятия на общем инфраструктуру предприятия специально созданное под это артефакт окружения Да и это окружение сразу же доступно во-первых разработчику во-вторых его коллегам Ну возможно специалистам или постановщиком задачи Вот для чего это вообще нужно традиционно сложилось так что Наш программисты разрабатывают локально на машинах и вот эта проблема в орган моей машин она в какой-то степени породила докер программисты очень любят разрабатывать локально и они любят что-то менять в этом процессе разработки Но это ведет за собой кучу проблем то есть одного Докера для исправления проблем онлайн машин недостаточно У нас есть Фактор в которых целый один 10 фактор посвящен тому посвящен рекомендации держать ваши окружение там разработки стейджинга Production Как можно более близкими это аргументируется тем что при переносе с одной технологической базы на другую у нас все-таки могут возникать проблемы какой проблемы допустим программисты у нас разработчиками работают локально при помощи Production у нас губернации соответственно мы переносимся разработки во-первых программисты постоянно забывают про то что мы масштабируем приложение при помощи процессов то есть наше приложение обычно работает в нескольких экземплярах и частенько возникают ситуации когда там прибегают программисты говорят Ребята у нас плавающие проблемы смотрите мы сделали новую ручку в нашем IP для изменения уровня логирования и вот на продакшене когда мы дергаем включается Ну дай Бог для одной пятой входящих запросов а на деле работает все нормально не знаю возможно сталкивается что-то подобное далее разница в организации инфраструктуры прохождения трафика это может выливаться проблемы с сетевыми соединениями проблемы с исчезновениями прочее прочее например вебсокеты доктор кампус работает нормально без проблем но если у нас губернатор в Облаке с ингрессом с облачным Вот балансером вы гарантированно без дополнительных настроек поймаете проблемы нестабильную работу да без настройки совершенстве нас далее Если вы используете две системы диплоя две инфраструктурные системы то вам нужно поддерживать диплой в них параллельно то есть изменение инфраструктуры случаются достаточно часто и вам в данном конкретном случае не получится Просто взять и перенести с одной системы другую Вам нужно будет перевести из терминов одной системы диплоя в термины другой это часто достаточно сложная задача потом у нас есть сложности зависимыми сервисами наше приложение работает не одно вакууме Да ему как правило нужны базы данных очередь какие-то связанные не про сервисы возможно и Ну я встречался с компаниями в которых программисты полутора до двух недель новое занимаются настройкой рабочего окружения чтобы начать разработку да и это сложность с поддержкой ПК разработчиков кто-то у нас разрабатывает на винде у кого-то макбуки которые бывают несколько генераций кто-то работает на ubunty кто-то вообще поднял кластер на арабс губернаторс и пытается что-то там делать И это превращается в эксплуатационный ад И вот это вот фича один кластер для разработки на всю компанию и фича окружения они помогают значительной степени решить вот эту проблему Окей разобрались допустим я убедил вас в необходимости использования фича окружений и для того чтобы раскрыть Каким образом мы можем лучше с ними работать я сделал небольшой план Итак начнем с писания стека поговорим про методик ветвления обсудим как создавать кастомизировать окружение Каким образом грузить тестовые данные затронем тему мультирепозиториев потом поговорим Что делать когда мы за дипломе наше окружение как с ним работать вообще и каким образом чистить погнали описание стека описание стека я вынес в название доклада Почему наши фичи окружения это как бы динамические короткоживущие очень гибкие штуки Да и наша базовая платформа она должна поддерживать вот гибкость и за счет поддержанного этой гибкости должна минимизировать во-первых затраты по инфраструктуре на создание фича окружения во-вторых трудно затраты То есть в принципе в принципе фича окружения можно делать на другом стеке но в моем докладе используется специфично для вот этих вот инструментов фичи и возможно на другом стеке вам Что придется делать самостоятельно Возможно даже с нуля вот Окей Поговорим про методику ветвления вообще вот в этом пункте я хотел обсудить какие бывают методики ветвления Каким образом натянуть их на свой бизнес-процесс или Каким образом даже самостоятельно сделать не только крепления которые покрывала свой бизнес-процесс что там нужно предусмотреть но время у нас ограничено это все-таки выбивается за рамки нашего обсуждения поэтому я хотел бы здесь оставить вывод который я всего этого хотел сделать Да если вы хотите фича окружение то вам нужны фичи гранчи то есть Включите вашу методику ответвления разработку через врачей Идем дальше поговорим про создание окружения Допустим мы договорились про методику явления мы знаем С какого бранча собирать нашу фичи окружения и прежде всего с чего мы должны начать это с описания билда сейчас будет много гид лапсия Ну вообще gitlab gitlab это pipeline как кот то есть описывается в яму файлах которые содержатся в том же репозитории что код вашего приложения и фактически является частью кода вашего приложения это очень дисциплинирует делает процессы прозрачными Вот это большое достижение гидлаб На мой взгляд большой плюс Итак что мы здесь описаны билда нашего артефакта что мы здесь можем видеть мы можем видеть что при помощи конструкции Only этот степ запускается для определенного только для определенных веток которая начинается на фича и здесь есть один нюанс квест то есть когда вы пушите в Гид репозитории веточку и создаете сразу же на нем наши квест возможно чтобы показать div вашим коллегам то гитланд начинает запускать сразу на фичи ветку и намерший Квест при помощи конструкции Accept мы можем это исправить Да убрать дублирование далее bifa Script befascript это ну фактически shellscript на вашем Райдера который запускается до основного скрипта и здесь как мы видим делается подготовка инфраструктуры логин в докере и этот логин в этот логин передаётся два ключа две каких-то переменные окружения с логином паспортом и они сохранены на самом деле то есть имеет хоронилище секретных данных Вы можете хранить Ну какие-то перемены сенсивные данные которые не можете положить и Ну на самом деле это достаточно хороший достаточно полезный механизм Далее идет в нагретострее которые описана переменной в глобальных переменных гитлаба Кроме того у нас в глобальных переменах описан имидж нейм который передается в докер Билд докер Push и этот имидж name составляется на базе docker registry определенно у нас чуть выше и некоторого количества стандартных переменных которые предоставляет нам gitlabs информации о нашем репозитории до Project name нашей ветки комитрия флаг и Хеш нашего комита именно вот этот механизм динамических переменных которые характеризуют наши начальные условия позволяет нам делать Вот эту динамику при сборке артефакта которые мы можем использовать для создания фича окружений надо сказать чтоб лидирует по набору на переменных характеризующих pipeline далее Stage диплоя нашего фича окружения что мы здесь видим Мы видим здесь Что стоишь сделан на базе Hell parket Manager у нас все тепло с хиллмом что эта цель запускается ровно для тех же веток что и прошлый стейдж далее тут указана секция инвалид и nvident это механизм gitlab который встроен все и в интерфейс который очень полезный То есть я буду к нему возвращаться буду его описывать это механизм для трекингантов но пока просто пройдемся по его по настройкам Итак здесь у нас имя окружения которое составляется из имени ветки нашей и на базе имени окружения во-первых она передается в диплой во-вторых на базе этого окружения у нас создается имя на котором мы хотим видеть это окружение То есть у нас есть домен тест компании ru на нем заведен Wild Card учет запись wildcard DNS А запись вот и вот эти вот динамические сгенерированные имена инвайрментов мы мы можем поставлять и вот на этой ученной записи на этой записи которая ведет на наш НГС мы можем иметь любое количество наших динамической фича окружении Идем дальше в дипломе передается название наймспейса которое формируется в переменных на Stage из имени проекта имени ветки универсальный подход да хорошая гибкость далее URL который мы сформировали в именитое мы Передаем в наш диплой Да Далее мы Передаем сюда имидж name который мы формируем в глобальных переменных пайплайна который собрали на прошлых На прошлом степям На прошлом стопе плюс мы Передаем urline это на самом деле моя хорошая практика То есть я люблю когда диплоидная в губернатор объекты имеют в своих аннотациях pipeline обличает дебаг а сюда я добавил просто чтобы показать универсальность Да показать богатство стандартных переменных gitlab Вот кроме того Здесь включен трекинг выката то есть вот с этими двумя ключами helm дождется Когда наш релиз задеплоется то есть программист будет знать во-первых что его код нормально выкатывается во-вторых он не сможет снежить свой код в рабочие ветки если он будет что-то ломать и когда мы вызовем вот это вот Stage диплоя у нас в интерфейсе get love в списке январямитов появится наша фича окружения Да и мы можем увидеть сможем с ним работать Окей поговорим о кастомизации окружении на самом деле окружение фича они должны быть похожи на родовое окружение но они не должны быть идентичны что я имею ввиду во-первых персистентная сервисы президентных данных база данных очереди продакшн они могут быть сделаны на выделенных серверах допустим на облачных сервисах например Это боится за сервис в фича инвалидах мы можем создавать их прямо в губернатос это будет ну как бы менее стабильно менее нагрузоустойчиво но в рамках тестирования Это лучший вариант это будет занимать меньше ресурсов инфраструктуры нашей а далее окружение наши могут отличаться по ресурсам если в продакшн мы можем выделять полноценное лимиты request ресурсов то нафиг окружения только для того чтобы они просто запустились до наш вечер уже не будет нагруженными Вот и вот такая вот подобная разница как раз делается на этапе кастомизации окружения и кастомизация окружения я делаю на базе менеджер я сейчас расскажу про необходимые достаточное количество фичей менеджер который нужно использовать и начнем мы с использованием переменных то есть вот наш диплоя мы передали туда URL Каким образом нам за диплоить наш фича окружения на этот URL мы можем использовать переменную которую мы переопределили в при вызове диплоя в тексте ингресса нашего фича окружения то есть вылез Global вся URL вот сюда потянется URL которым мы передали и соответственно нашли окружение встанет на этот URL далее ровно то же самое делаем Передаем имиджмем в Global Image name и используем эту переменную наших диплометах или где вообще нужно использовать имидж наймы Идем дальше использование условий для чего это может быть нужно мы передали имя окружение в наш диплоида в переменную Global Edge а далее мы анализируем ее и в данном конкретном примере Если наша окружение начинается на слово фича то тогда мы включаем в релиз код от конструкции до конструкции в котором у нас находится описание Таким образом мы как раз добиваемся создания инфраструктурных сервисов для фича окружений через анализ имени окружения далее чуточку Более сложный пример с проставлением лимитов ресурсов с проставлением ресурсов на реквестов и лимитов здесь в зависимости от имени приложения если это продакшн мы делаем полное реквесты лимиты если это Stage мы делаем половинчатые если это фича окружения мы Ну делаем по минимуму Таким образом мы в том числе экономим ресурсы наши и использование собчактов использование Собчак это наверное продвинутый вопрос использования Хилла Да я это привел к тому что мне очень нравится через Собчак и подключать как раз делать вот эти вот инфраструктурные сервисы то есть Таким образом мы можем подключать и если у вас много микросервисов Вы можете сделать ре то есть какими-то типовыми инфраструктурными сервисами подключать их Собчак таким образом минимизировать Количество кода вообще использование пэтч-менеджером это достаточно большой вопрос достаточно большая тема некоторое время назад я делал по ней доклад желающие могут загуглить название моего доклада либо воспользоваться ссылками которые здесь привел ссылка на эту презентацию будет на последнем слайде Окей Идем дальше тестовые данные вот мы за диплоили наше тестовое окружение но без тестовых данных без пользователей паролей каких-то данных на которые мы можем прогнать Наши тесты она практически бесполезно Каким образом мы можем обеспечить тестовые данные в наших фича окружения прежде всего мы можем сделать это при помощи иммиграции и текстур Ну миграции я бы не сказал что это относится именно к накату тестовых данных скорее стандартная средства для поддержки актуальности базы данных для приведения ее структуры в соответствии с потребностями нашего кода но текстуры Это точно такой же программный скрипт который наполняет нашу базу созданную структурой данными Поэтому я считаю что достаточно близкие вещи достаточно близкая вещь в принципе не многие задачиваются потому что это дополнительная нагрузка на программистов дополнительная работа но Каким образом мы можем их применять Если они у нас есть так называемые во время процесса Выгода нашего релиза Хилл Может на каких-то этапах релиза создавать или удалять примитивы в губернатос для чего это как мы можем это использовать вот это вот губернатор Job которая накатывает наши миграции это средство для создания кода губернатос и средства удостовериться что под отработал нормально путем добавления Вот таких вот аннотаций мы можем сказать чему что вот этого мы хотим создавать после инсталляции релиза или перед его апгрейдом Почему после инсталляции потому что инсталляция У нас еще нет базы данных в губернатос Да как раз после инсталляции релиза появляется соответственно накатывать миграции вот при Апгрейд потому что Новый год как правило хочет новую структуру база данных Он часто падает если чего-то не находит в базе поэтому хотелось бы чтобы запускался на базе новой структуры Поэтому при Апгрейд следующая восьмая строчка это вес хука Таким образом мы можем ранжировать запуск хуков допустим пятым хуком мы можем накатить миграции десятым хуком мы можем прогнать текстуры Да и делит полисе это способ почистить за собой то есть в обычной жизни нам это Джаба не нужна Поэтому после того как хук завершился капот прошел Hell почистить все это дело удалит далее специальность 3G вся системе Вот пример такого стоит же на что здесь мы можем обратить внимание прежде всего этот Stage запускается вручную то есть это не обязательностейдж который висит в описании нашего pipeline и он не работает пока программист не зайдет в интерфейс Get Up и не кликнет на кнопочку которая соответствует Запуск этого стоит же Да дальше этот в этом стриже запускается какой-то отдельный и вот в этом чарте всего один Job один Job который аналогичен накат иммиграции только там работает допустим ваш скрипт 10 строк который скачивает база данных и накатывает его на текущую базу данных Да я думаю и этот релиз этот Джаба запускается в 1спейсе имя которого формирует взрывается по правилам аналогичным нашему фича окружению То есть это запускается в нем свои свечи окружения и обращаясь к сервису постгрейскуэлла наша джабанная под наши джаббы попадает именно на ту базу данных которая нам нужна Вот кроме того почему собственно говоря здесь используется хемом Почему не применяется через куб стиль это трекинг релиза то есть благодаря вот этим вот ключам Хилл отследить накат путь наката нашего дампа и даст программисту понятие накатился дам или не находился чтобы Возможно если вдруг какой-то сбой на был программист не думал это у него кот плохой или структура база плохая вот таким вот образом и в автор скрипте автоскрипте После выполнения основного скрипта здесь очистка нашего Ну то есть мы подчиняем с собой ничего звонить мусор вот и следующий момент Каким образом мы можем давать тестовые данные нашим фиче окружениям это специальная например мы можем создать докер имидж в котором уже будет база данных для Ну допустим пост с нужными данными я делал подобную схему для одного большого интернет-магазина торгующего инструментами там был после на тот момент 120 гигов мой докер файл скачивал имидж с последнего имидж раскатывал его в базу данных на файловой системе Джа и опустил данные и пушал его как лейтест в docker regis 3 таким образом когда приходил первый программист и хотел запустить свою фичи окружения он Возможно сдал чуточку дольше чем нужно Да но остальные программисты за счет механизма копием Брайт докеры за счет слоев они получали инстанции базы данных быстрее Да там был селектор который все баз данных сгонял на один сервер для окружения то есть такой способ достаточно хорош достаточно функционален вопрос Каким образом мы можем делать такие докер имиджи по расписанию у нас в gitlab есть возможность запускать так называемые shadled piplines запланированная пайплайны здесь мы можем указывать в формате crontube расписание по которому мы можем запускать лайны в репозитории в проекте мы можем указывать веточку с которого их запускать и мы можем указывать Некоторое количество переменных для того чтобы кастомизировать наш Но для того чтобы наш я работал для запланированных файплайнов мы должны сделать специальный Stage да и этот Stage будет запускаться если мы в секции only мы выберем Shadows Да только зашадуленная пайплайны вот ну здесь как бы все тривиально идет сборка имиджа Push latest докер имиджа Я думаю это не стоит пояснять дополнительно Окей Идем дальше мульти репозитории очень часто бывает что наши приложения работает не одно Да ну классический пример не работает и нам хотелось бы хотеть вместе Кроме того у нас набирает мульти микро сервисная архитектура популярность Да и часто Нам нужно катить наши микросервис который мы разрабатываем плюс парочку связанных через которые благодаря которым мы Тестируем функционал нашего или без которых он не запускается допустим Каким образом мы можем это делать стандартный подход да Каким образом это решает конкретно программисты это так называемое мог сервисы то есть какие-то заглушки которые дают очень базовые ответы просто чтобы наш сервис проверить какую-то базовый функционал создание мог сервисов часто бывает достаточно трудоемкой вещью поэтому этот вариант Ну наверное не самый лучший Каким образом мы можем делать это еще при помощи gitlab API то есть вот наш Stage deploya допустим это диплом микро сервиса и нам нужно связанными микросервис мы добавляем сюда автор скрипт так тут получается Очень мелко давайте я увеличу и посмотрим что в этом скрипте в этом скрипте вызов а url-а который соответствует API проекта нашего микросервиса Да Далее тут с какой-то тут авторизация через Sei Talking который получен для технической учетной записи который имеет доступ к этому репозиторию далее тут передается Некоторое количество переменных для pipeline благодаря которым запустившийся в новом репозитории pipeline сможет встать в наш окружение Да чтобы кастомизировать новый pipeline для нашего фича окружения Вот и здесь выбор веточки на которые мы связаны репозитории связанного микросервиса запустим pytline но часто бывает необходимо часто бывает необходимо запускать пайплайны на какую-то определенной версии микросервиса и каким образом мы можем это сделать первый способ это разместить имя ветки версии микросервиса в каком-то файлике в нашем гитрепозитории и просто Катить его при вызове курла Да но это ну наверное такой не очень гибкий способ Да с постоянным изменением файла следующий вариант мы можем использовать какую-то переменную gitlab который мы можем выставлять непосредственно gitlab и который мы можем задавать при ручном запуске пайплайна в репозитории то есть в gitlab основным триггером для создания для запуска является Push commiter репозиторий мы можем сделать запуск вручную при этом мы можем переопределить Некоторое количество нужных переменных вручную Но это наверное точно так же не самый удобный способ и он хорош Когда у нас диплой связанных микросервисов сделан также Как диплом баз данных допустим отдельным Manual step-ом И следующий механизм для диплоя проектов это gitlab Multi Project piplines он появился достаточно недавно точнее появился Он давно недавно он стал платным в чем суть этого метода мы создаем отдельный встреч диплоя И в нем указываем секцию Триггер в секции Триггер мы указываем имя связанного проекта связанного гид репозитория и ветку на которой дело запускать на который запускать наши пайплайн и после запуска этого стрижа мы можем смотреть за прохождение в нашем Связном репозитории Вот это на самом деле очень мощный метод запуска pipeline в связанных репозиториях я прошелся только по верхам там ну вообще гигантская гибкость вплоть до того что ямки в котором описаны вот эти вот стоит же Да их можно генерировать Яндекс в которых описаны триггеры их можно генерировать там на ходу в степи скрипте нашего файтлайна основного В общем желающие могут ознакомиться с ним подробнее оставил Окей за диплоили наше приложение загрузили туда тестовые данные за диплоили связанные микро сервисы Каким образом работать с этим окружением прежде всего мы должны найти это окружение то есть дать программисту ссылку на ссылку URL этого окружения в описании мы указали URL и вот после того как мы его определим в секции NVIDIA мы получаем в интерфейсе Get Lab вот это вот кнопочку при нажатии на который нас директит на собственно говоря эту л который мы показали это первая возможность вторая возможность в хелме есть механизм ноут xtxt это Файлик который лежит в вашем чертики и который печатает после завершения диплоя причем в тексте этого файлика вы можете указывать переменные которые передавали на вход gitlab Тьфу на вход хиллма или который может как-то создавал в процессе работы в данном конкретном случае здесь указан URL нашего окружения которое мы с диплоили и namespace нашего окружения Вот это выдастся в лог прохождение это можно будет посмотреть Зачем разработчику name Space Дело в том что для продуктивной работы разработчиков окружения мы должны запустить разработчиков фича окружения да то есть мы должны сделать работу свечи окружением мало чем отличающиеся отличающиеся чем скажем работа с доктор компост на локальном на локальной машине и неплохо бы дать программисту средства для работы например web-интерфейс да как в данном примере куберы dashboard или поставить какое-то средство вот как Lens за губернации для того чтобы программист мог зайти в контейнер выполнить какую-то команду посмотреть влоги в общем сделать это дело удобно тогда программисты становятся более лояльны к вообще самой идее использование фича окружения в работе какое-то Время назад я делал статью со сравнением интерфейсов для менеджера губернации на самом деле статьи достаточно старая но я оставлю на неё ссылку возможно кому-то она послужит отправной точкой для того чтобы выбрать решение для себя Окей Поговорим про очистку окружения вполне Понятно вполне понятно что наши ресурсы ограничены и бесконечное количество окружений иметь мы не можем чисто физически Поэтому нам нужно это прочистить Каким образом мы можем удалять старые фичи окружения здесь для задачи удаления фича окружении У нас существует такие вот настроечки в секции он Стоп это указание на отдельный Stage который чистит наш наша окружение которое удаляет автостоп опция это опция которая позволяет запускать этот Stage автоматически после какого-то временного периода Когда не было диплоитов наших окружения Итак мы указываем название очистки окружения и мы должны его описать что должно быть в этом стоит же Вот пример и здесь мы видим что это точно также ручное действие То есть это не обязательно стоишь который можно запустить в том числе вручную да он не должен выполнять автоматически далее Что очистка делается при помощи на самом деле он трек это все а-а примитивы которые диплоид в губернаторс и в том числе он может их удалять он может удалять примитивы которые он в нем Space в какие-то связанные namespace в какие-то кластер White сущности типа кластер ролей прочее прочее то есть мы можем быть почти уверены что все почистится нормально но и вторым степом мы удаляем Space нашего релиза вот Чистота залог здоровья и когда мы описываем вот этот стейджик и указываем его в секции получаем кнопочку нажав на которую мы можем остановить наше окружение и соответственно перевести его в стопит Вот это наверное все что я хотел сказать про фича окружения за кадром остались осталось Некоторое количество за пределами моего рассказа осталось Некоторое количество достаточно важных вопросов например шаблонизация то есть мы можем указать какой-то блок кода который бы в данном случае это блок кода диплоя далее унаследоваться от него и для каких-то Джей при помощи переопределения отдельных элементов мы можем кастомизировать его то есть переиспользовать код это очень хорошая очень мощная средство и вот в данном примере Да у нас в скрипта вынесен диплоити окружения а для продакшена переопределяется то есть вот таким вот образом мы можем кастомизировать скрипт диплоя под наших продакшн И именно поэтому имя фейса во всех примерах у меня вынесено в переменная именно стоит же То есть у меня все дисплей на все стриженные если используем описаны при помощи вот этих переиспользуемых блоков входа и я просто их адаптировал для текущего как бы для текущего доклада переписал следующая разработка губерната некоторые делают разработку в губернации разработку печат окружения при помощи программное обеспечение которое доставляет код в контейнеры с локальной машины разработчика минуя Stage сборки артефакты сборка и диплоя Но это может быть оказаться это может оказаться полезно Ну например для интерпретируемых языков программирования Но это тянет на отдельный доклад и хочу сказать про ускорение сборки докер или же есть много способов ускорения сборки ренджа для чего это нужно программисты начинают лояльные относиться к фиче окружениями Когда время года ветку до диплоя и артефакты до доставки этого года в губернатор с достаточно мало И чем быстрее дело происходит тем с большим удовольствием программист пользуется вот этой возможностью Окей на этом мой доклад завершается А вот ссылочка на qr-код на презентацию готов отвечать на вопросы Да спасибо Олег было очень интересно Она действительно есть несколько вопросов в чате Я думаю мы ответим на два из них а уже на оставшиеся мы тогда уже ответим последова экскурсионной зоне когда приглашены все наши зрители так и первый вопрос он касался тех шаблонов которые ты показывал самом начале своей презентации те жабы которые используются которые пользовались в качестве чертов они были типа этим или как-то наклейдились куда-то другие средства на самом деле моя хорошая практика в создании одного большого чарта до пустого в который подключен локальными хинчартами описание инфраструктурных элементов то есть ну грубо говоря есть отдельный Собчак на Back and отдельный Собчак на джабы иммиграции отдельной Собчак на диплои инфраструктурных сервисов то есть в моем примере я сделал ссылку так как будто это отдельный чартик который лежит рядом с основным чертом Но на самом деле у меня один большой химчат который я при вызове в конкретном стриже при помощи переменных передаваемых на вход хиллма подгоняя под нужные под свои нужды в том числе в том числе У меня есть отдельный вызов под накат миграции который все остальные Собчак и кроме черта Собчак иммиграции а низкозатратными по использованию ресурсов вашей инфраструктуры Да если у вас количество фича окружении ограничено маленькой инфраструктурой до небольшой инфраструктурой Вы можете в свой pipeline в свой Stage deploya фича окружения скажем befo скриптом добавить какую-то проверку что-то вроде Coop cityl Get на inspaces посчитать сколько у вас на спейсов начинается на фича окружение и если оно больше определенного количества до сказать разработчикам Извините мы не можем это с диплоить все слишком заполнена да почистите сперва потом заделывать Ну либо мы можем посчитать количество хел релизов установленных губернация название которых соответствует название нашей окружений Это ответ на первый вопрос второй вопрос можно оказался больше мониторинга в целом того то есть в контексте ограниченных ресурсов то есть какие-то ограниченные ресурсы нашим окружении и нам нужно следить за те моменты когда колесо в окружении начинают переходить какое-то Разумное количество Но это наверное вопрос мониторинга то есть а вот сейчас вот я сходу назову одну метрику которая может помешать нам диплоить большое количество фича окружения Это количество пудов да то есть количество кодов губернатос на ноду Она лимитированной когда количество кодов скажем нашим тест кластере на каждой ноте оно приближается к какому-то неразумному пределу тогда мы можем понять что нам все-таки нужно почистить фича окружения то есть обычно сейчас уже не нагружены болтаются вот особо каши не просят но вот количество кодов у нас может переполниться это наверное основной и главный фактор чтобы иметь много окружений а Спасибо также Надеюсь слушатели получил ответ на свой вопрос что я думаю мы можем постепенно завершаться На все оставшиеся вопросы уже ответим дискуссионной комнате если тут прилетел буквально только что вопрос оставшись Ты ссылку на личный гид или Кид свои каналы где можно следить за каким-то материалами тобой публикуемыми на самом деле у меня немного кода в личных дитрепозиториях Да я не использую код чтобы шарить мой опыт на весь мир я это делаю в докладах то есть ну грубо говоря нечего жарить пока но я подумаю над этим вопросом ребята ищите доклады есть классный Ютубе про который Олег рассказывал можно найти что-то еще на этом Будем завершаться всем спасибо что пришли послушали Олег спасибо что рассказал было очень интересно спасибо Надеюсь мы"
}