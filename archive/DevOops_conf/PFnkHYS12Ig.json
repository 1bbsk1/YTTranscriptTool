{
  "video_id": "PFnkHYS12Ig",
  "channel": "DevOops_conf",
  "title": "",
  "views": 0,
  "duration": 0,
  "published": "",
  "text": "Всем привет Всем привет Хорошего утра вам хорошего дня воскресного солнечного Московского Давайте начинать для начала перед тем как ночного личные вопросы задавать наверное лучше представиться Меня зовут Ногин Данил Я работаю в лаборатории Касперского Как вы наверное видели на заставочке со мной сегодня Мой коллега и собственно главный докладчик этого доклада Михаил Пахомов Михаил что добавим немного безопасности в эту конфу и о чем мы хотим сегодня поговорить основная тема которую Миша будет раскрывать следующие 40 минут это хашикорд волк комьюнити Edition тот что бесплатный что мы с ним сделали чтобы его можно было использовать у нас в компании чтобы можно было использовать на большом количестве людей и для начала наверное у меня вопрос который я продублировал в чатике заходить обязательно по ссылочке по qr-коду который справа и слева от меня расположен а там небольшая голосовалка кратенький опрос по этой голосовалке А кто из присутствующих уже использует вроде у себя в компании раз два десять двадцать наверное наберется отлично У кого-то это уже другой вопрос как оплатить но Окей значит принципе мы с целевой аудитории угадали секреты хранит уже просто день под ногами в текстом пройдет в конце руки быстро пустили Не подержите кому не нужны Господи ладно на самом деле у нас времени много Давайте ходить к основной теме передают поддержите Спасибо большое спасибо Так ну когда не уже сказал сегодня я вам расскажу о том как мы в нашей команде в компании автоматизировали и улучшили вот Community Edition до такого полноценного продукта которым может использовать каждый разработчик Каждый тестировщик каждый менеджер внутри компании и начать конечно же надо с того какой у меня опыт на самом деле я очень молодой девочек я всего четыре года войти это такие четыре года где я год был стажёром и так далее по специальности по образованию и Б специалист что очень интересно совпало Том Потому что интересно это интегрировалось моей жизни люблю как и Многие эти опции вероятно программировать нападении и на данный момент работаю дивов сам касперском Давайте начинать и свой доклад Я хочу построить по виду истории То есть как мы внутри компании развивали этот самый хешкор-волт и как он становился полноценным таким продуктом и как во многих компаниях наверное было был какой-то один диопс который узнал о таком решении как болт иначе его внедрять Привет Гоша Пчелкин Это первый диопс Это был не я к сожалению это он сделал и что такое для тех кто не знаком Возможно есть такие вот это по сути по факту сейчас такое самое основное решение для хранения секретов в компаниях и оно весьма удобное потому что представляет богатый апи и предоставляет множество интеграций с различными решениями как этот выглядел в своей начальной инициализации когда он только зарождался в рамках нашей компании ну как у многих было Это был просто какой-то большой секрет Engine один единственный Что такое Secret Engine Но это там где хранятся ваши секреты и в рамках этого секретанжина Этот один дивопс хранил свои секретики в том числе какой-то под этим токеном мог зайти Вот делать все что хочет удобно в принципе этот диван был доволен Все работает потом к этому дефопсы начали приходить другие диопсы они начали задаваться вопросом Что же это за сервис такой и как мы тоже можем им попытаться попользоваться А еще какие-то разработчики начали медленно прибегать и тут структура болта вот тот самый базовый секретарь он начал адаптироваться он уже начал принимать какую-то понятную структуру начали сертификаты отделяться начали токи наделяться Root token начал пропадать то есть уже появилась какая-то аутентификация в сервисе и потом навалилось куча людей пришло еще больше разработчиков пришли какие-то менеджеры А еще пришли ибо специалисты надо безопасно все хранить надо наложить на это требование и тут у нас возникли проблемы первая проблема Как реализовать аутентификацию в сервисе То есть у нас очень много пользователей как это сделать так чтобы это удобно было для каждого для каждого разработчика для каждого менеджера для каждого тестировщика как второй вопрос как организовать спейса то есть чтобы права пользователи были разграничены и они пользователи не зависели друг от друга каждый мог положить свои секреты и он знал что другой человек без соответствующих прав не смог бы его прочитать третий вопрос Это автоматизация Мы же дивопсы мы не хотим все делать ручками Это должно как-то автоматически работать и последний вопрос Это безопасность Мы все-таки работаем с секретами и вся эта инфраструктура должна быть защищена и безопасно и поэтому всего этого выдвинулись некоторые требования Мы хотим сделать единый защищенный сервис Мы хотим научиться делегировать доступа по спейсом чтобы приходила команда команда в которой есть менеджер разработчики тестировщики Они могли создать свой собственный Space и в рамках этого спейса был какой-то администратор который имеет все права доступа были тестировщики которые имеют какой-то лимитированный набрав прав и так далее И все это должно быть через какой-то удобный единый интерфейсом чтобы это все было объединено чтобы мы это могли логировать и защищаться и начнем с последнего вопроса как раз как же мы организовали доступ как мы организовали доступ в наш World который стал таким большим средством хранения секретов для всей компании по сути и тут надо толкнуться от базовой схемы болта которые доступны на сайте я просто оттуда забрал на официальном сайте и выделим основные пункты основные три блоки это http то есть то через что вы можете общаться с валтом вот это вот по сути самая центральная ячейка большая и сторожкент это то куда волк сохраняет свои данные какие-то метаданные прочее прочее ничего не знает о секретах он лишь их хранит шифрованном виде и В центральной части центральной части болта выделим те пункты о которых мы сейчас будем говорить это ядро То есть то что обрабатывает и занимается основной обработкой всего при общении в вашем с валтом и некоторые вот System Back and Secret Engine И аусметр что это такое Это трясущности которые позволяют вам которые модифицируют и что-то изменяет волне System Back and это системная какая-то какие-то сущности которые как-то модифицируют волк изнутри как-то позволяют его доработать секрет Engine это что-то что хранит секреты и метод аутентификации это то что позволяет вам модифицироваться в этот самый сервис и немножко пересуем чтобы мне было немножко удобнее то есть вот такая вот схемка от неё мы сегодня будем отталкиваться и говорить и что мы сделали в рамках нашего сервиса World мы первым делом добавили много методикации чтобы это было удобно для каждого рассмотрим их по отдельности и самый главный вопрос зачем их так много сделали уменьшим приблизим У нас есть 5 метров модификации и про каждый из них конкретнее все из них они связаны с Active directory Почему Потому что это удобная связь Где мы можем заблокировать на стороне Active directory каждый вагон все что необходимо по отношению к логину волте и это Единый центр идентите Единый центр откуда все пользователи ходят и мы можем определить кто какие права имеет я об этом дальше поговорю Зачем нам нужен да б удобен для начала работы для начала работы команды для начала работы первых специалистов они могут просто воспользоваться своим жирным паролем понятная история Зачем нам нужен герберс керберс уже это что-то более интересно оно позволяет нам доделывать автоматического прозрачную аутентификацию особенно Windows средах это очень актуально для этих средств и это уже чуть по безопасности чем беда когда мы придаем в прямом виде зернами пароль 3 сертификаты мы реализуем сервис которым можно будет пользоваться в рамках болта и мы хотим сделать так чтобы пользователи могли ходить не только юзернейм паролем пакербер стикетом но мы хотим чтобы у нас была возможность двухфакторная модификация это удобно реализовать через метод аутификации Серт который по сути является некоторым костылем внутри Валта он не подразумевается и сейчас немножко подробнее о нем расскажу который работает через некоторого робота что это делает этот робот он ходит в актив директоре и запрашивают все сертификаты каждого из пользователей Валта Что такое сертификаты у нас в компании используются карты для всех людей возможно в других компаниях тоже я думаю хороший подход Когда вы можете использовать двухфакторную модификацию вот мы запрашиваем публичные части сертификатов директоре этот робот делает он делает это постоянно и постоянно загружает обратно забрав эти сертификаты внутри Болта тем самым мы получаем такую картинку что у нас есть список сертификатов внутри болта то есть вот первая строчка где у каждого вот этого Иванова есть его публичный сертификат и когда этот человек будет аутентифицироваться своим со своей смарт-карты он сможет получить доступ который мы подразумевается удобно практично и главное безопасно И последние два методикации на которых Мы остановимся это два метода си зачем и почему Ну зачем потому что это удобно это вагон через браузер пользователи рады и счастливо а почему их аж две штуки опять Мы захотели сделать через redentials через юзернейм пароль и через двухфакторную аутентификации как это выглядит если пользователь логинсы через простой IDC метод аутентификации он попадает на dfs какой-то Simple Вы можете использовать любое другое средство для себя аутентификации и там у него запрашивается и можете использовать альтернативные методикации которые уже запросит вас ваш сертификат и пароль от вашей смарт-карты Возможно у вас возникло смутение что как бы мы реализовали 5 метров аутентификации и ну зачем если двухфактор к если человек сможет через льдаб зайти то вроде как безопасность не увеличивается Нет мы сделали функционал которым я в дальнейшем расскажу который позволяет каждому из пользователю отключить для себя и для своей команды определенные методы модификации и то есть в рамках конкретных команды в рамках конкретного спейса мы сделали Так что команда может отключить там льда керберас и обычную DC И тогда вся команда будет ходить Через двухфакторную аутентификацию что опять же более безопасно И тут я хочу перейти наверное к самому интересному пункту То есть я рассказал вам о том как пользователь может модифицироваться в сервисе но как же пользователи как мы реализовали эти самые спейсы они унифицируются и они получают какой-то доступ и они должны быть поделены по спейсам и тут опять Мы возвращаемся к нашей схеме и что мы видим если мы заглянем в наш самый любимый интерпрайз World которого как мы уже узнали почти ни у кого нет видимо ни у кого нет то у него есть такой System backet назовем его System Back and System Spaces что это такое Что это за странный объект по сути именно Он позволяет вам конфигурировать и общаться с различными спейсами то есть при обращении это стрелочка слева как раз конкретному на Space вы попадаете вы в рамках него работаете И вы можете легко поделиться по командам и при обращении Вот спейсом ты вы взаимодействует со множеством сущности внутри болта Вы можете настраивать медную модификации в конкретном спейсе Вы можете класть секреты в конкретные спейсе Вы можете настраивать методы модификации и так далее и так далее одна проблема это которого у нас всех нет И мы должны реализовать замену Как мы начали думать Давайте реализовать реализуем самую простую схему спейса где Space это название команды нижнее подчеркивание и дальше все что угодно написано это все будет принадлежать одному спейсу и для Примера в рамках моей презентации Я буду работать с командой ast Advanced Security Team Вот и вот Space это вот например нижнее подчеркивание коуман А с нижней подчеркивает все секретаны принадлежат одной команде команда заходит аутентифицируется мы этой команде людей даем политику политика очень простая Нижняя подчеркивание звездочка и все права то есть мы одной команде людей дали права на все-все изменения в рамках и вроде бы все работает и это очень легко воспроизвести то есть как это у нас в начале работу на самом деле пользователям писал e-mail и мы как divops запускали скрипт А что дело скрипт он смотрел на структуру болта создавал одну группу в Active directory создавал политику то самое которое дает доступ к рамкам этого спейса и создавал mapping Group этой группы запись в директоре на группу внутри болта И тем самым вот он создал все маппинги и пользователь и в конце Мы создали какой-то секретарь то есть то где пользователь может положить свои секреты вроде бы все понятно Вот базовая структура вот есть команда и пользователь может напихивать директоры группу пользователь и все эти пользователи будут получать доступ одна проблема Если вдруг пользователь захотела создать себе дополнительный секретально он что будет писать нам и мы будем как-то это создавать ручками либо если он захочет создать политику что мы тоже будем мы делать мы всё это будем делать по запросу от них А если метод аутентификации и так далее так далее так далее То есть способов где пользователи что-то может понадобиться вариантов очень много и тут появились дополнительные требования как же нам в рамках этого спейса предоставить людям возможность создания дополнительных хранилищ секретов Тех самых секретантенов дополнительных методов аутентификации и внутри этих методов аутентификации чтобы пользователи сами могли настраивать объекты аутентификации еще маппить к ним политики свои же еще было бы замечательно чтобы в рамках всего этого было какое-то разграничение доступа то есть пришла команда и она помните делит по тестировщиком девелоперам и так далее И сейчас мы останавливались на первых трех пунктах как же нам вот это сделать если мы посмотрим еще раз То есть у нас были в интернете мы ими пользоваться не можем они в интерфазе тогда посмотрим на системные пути которыми по сути генерируются вот эти все сущности о которых я только что сказал Дело в том что к нему тоже доступ не можем дать для пользователей если мы дадим например доступ к настройке политик то пользователю сможет себе Root доступ получить если мы дадим пользователю настроек возможность создания секретаренджинов или метафантификации они смогут там портить интерфейс и так далее нельзя такое допускать и также настраивать отдельные объекты модификации тоже не стоит давать этот доступ потому что там тоже будут свои проблемы то есть любыми встроенными функциями мы не можем это никак сделать и тогда мы пошли дальше что нам волк предоставляет он предоставляет нам функционал по реализации каких-то дополнительных плагинов То есть у болта есть секрет Engine который встроены есть те которые вы можете сами достроить внутрь болта это можно делать Мы это делать не можем Что печально но живем чем можем и мы решили реализовать плагин System Custom положили его в секрете Почему в секрете мы попытались реализовать плагин который по сути реализует тот самый функционал который реализовывал тот самый System Back and System Spaces То есть он будет отвечать за настройку спейсов внутри болта за возможность пользователю конфигурировать свои спейсы за возможность создания политик и так далее Почему мы Его положили в секретеджины потому что мы хотели дополнительно ко всему что я сказал хранить еще какие-то метаданные Ведь это удобно Если пользоваться создал какой-то секретанжин например сохранить кто его создал В какой момент времени его создал И так далее так далее так далее поэтому давайте отталкиваться что вот у нас секретах есть этот плагин и Давайте раскрывать то как он работает как мы его настраивали как я уже сказал он реализует вот как стрелочка слева тот же самый функционал что Sys name Spaces но он работает немножко иначе у него он будет работать вот если там был слэш то есть мы при обращении каком-то на спейсу обращались Через что тут мы как я уже сказал все через нижнее подчеркивание мы так захотели можно было выбрать другой символ и тогда этот плагин при обращении я все Сейчас буду более подробно раскрывать при обращении к спейсу будет взаимодействовать по сути со множеством сущностей внутри болта можно сказать что он сделать некоторые цикл То есть вы будете обращаться как пользователь не напрямую к метода мотификации созданию дополнительных секрета Engine of и так далее политик А вы будете все это делать через плагин а он свою очередь будет уже делать это все внутри болта обычного комьюнити Edition И что тогда мы делаем мы выдаем команде вот дополнение к такую политику то есть они теперь вот у нас есть эссе Secret Engine и мы их по префиксу АСТ выдаем весь доступ А что внутри что внутри этого плагинчик что получит пользователь от этого дополнительный доступ Ну во-первых он сможет реализовывать такую операцию То есть он сможет обращаться поэтому как вы видите Sisters и вот он может обращаться таким образом то есть он хочет допустим создать секрет тогда он обращается и все это внутри плагина То есть это уже сам плагин делать транслируется немножко в другой запрос то есть из Сиссе получилось из mounce перенеслось и Но вот это Ас и pki они перенеслись через нижнее подчеркивание Если вы заметите в начале было четыре США слева справа их три и один слоев поменялся на то самое нижнее подчеркивание А как этот плагин делает еще более глубже как он делает это внутри на самом деле это может показаться сложно то есть вот у нас есть клиент и он делает запрос Я хочу создать первый запрос он делает это плагин Что делает плагин он валидирует данные А точно ли вам можно создать от Секретарь а может быть вы уже создали их слишком много может быть вас стоит ограничить Может быть вы запросили какие-то параметры которые вам не стоит запрашивать в этот момент он скажет может сказать отмашку Вам нельзя ничего делать дальше 20 не пустим дальше если все-таки вы прошли эту базовую проверку то плагин пересылает этот вопрос уже в системный бэкэнд То есть он создает тот самый секретом Понятно об этом мы уже поговорили Дальше он дополнительно реализует квоту Зачем нам секрет Engine на который не будет квоты нас использовать сможет легко задудочить мы этого не хотим поэтому мы сразу какую-то дефолтную квоту повесим Если что мы ее адаптируем потом но минимальная должна быть после этого мы читаем Что же это за пользователь кто это только что создал И кто это делал запрос для того чтобы потом вот эту учетку и данные Сохранить то есть мы запишем кто же это создавал В какой момент времени создавал и все это сохраним чтобы потом другие пользователи этого спейса смогли зайти и посмотреть вот кто-то секретант создал кто это создал я ему Напишу спрошу может от секретан же он уже не нужно его можно удалить то есть такие базовые вещи можно решать с помощью такой дополнительный запросов Как это работает с медной модификации Но на самом деле абсолютно точно также то есть пользователь делать запрос и этот запрос Просто ректится если Вы посмотрите тут почти ничего не поменялось по сравнению секрета пользы сделать запрос на создание gvt нет модификации и после он получает 9 методикации через системный бэкент и еще еще раз помним что пользователи есть все права там вот на его название подчеркивание звездочка а что насчет политик с политиками чуть-чуть интереснее Дело в том что если пользователь захотел создать политику вроде бы все выглядит примерно идентично во-первых понятно что мы тут квот уже не создаем потому что зачем нам кого-то создавать к политикам это просто объект но тут появляется дополнительный пунктик обогащение данных какое-то что же это такое дело в том что пользователь может запросить создать политику он же создает политику в рамках своего спейса и он может запросить какую-то это первое вот Верхняя строчка если пользоваться запрашивает какую-то базовую политику например доступ создать политику который имеет вот а с нижнее подчеркивание команд и там все на права на апдей то по сути что наш должен делать плагин он должен переписать эту политику примерно такой же интерфейс и ничего не должен делать но куда интереснее если пользователь запросил доступ То есть он хочет создать политик которая может как-то модифицировать методом модификации и тогда мы должны Добавить дополнительный параметр который на самом деле очень важную функцию несет если мы что-то такое вот Динамит параметр не добавим то пользователь сможет создавая Через наш плагин политику создать эту самую политику вот без этих параметров и потом эту павильтику повесить на какой-то объект А этот объект уже сможет создать новый объект с любыми политиками в том числе Наруто то есть вот такой вот минус внутри болта мы не можем никак ограничить поэтому мы просто буквально хардиним внутри плагина что всегда если там пользователь создает политику с доступом к этому модификации она должна быть защищена дополнительным запрещенными параметрами И если мы запретили использовать вот только что мы запретили ему использовать и настраивать политики для метаста мы ему должны как-то дать взамен И для этого еще дополнительный путь как он работает ну это супер просто То есть он по сути переопределяет то же самое он может позволяет вам навесить политику на конкретный объект в рамках спейса еще раз вся суть этого плагина в том что вы остаётесь в рамках своего спейса при создании любых объектов системных вы будете и сможете создать их только внутри своего спейса вы не выйдете за рамки его вы не нарушите безопасность сервиса вы не сможете залезть в чужие секреты И тем самым Мы реализуем первые три потребности благодаря плагину который встроен внутриволока мы позволяем пользователю в рамках своего спейса команде создавать дополнительные хранилище секретов создавать дополнительные методы аутентификации не только создавать удалять если нужно если Нужно конфигурировать настраивать время жизни токенов и так далее и внутри этих методов создавать объекты модификации и политики к ним чтобы это могли создаваться токены эти токены можно было использовать каких-то сервисах и так далее так далее остается последний вопрос разграничение доступа как же мы реализовали его и тут хочется отдельно поговорить потому что разграничение доступа это уже немножко сложнее Дело в том что если до этого мы использовали актив директора Active director и где Откуда все пользователи аутентифицировали Да мы позволили пользователю создавать любые объекты внутри болта но вы актив директоре это уже отдельный объект и вот не хочется делать эту связку что плагин может обратиться в директоре это должна быть какая-то внешняя история ради безопасности и что пользователь нас запрашивает пользователь нас запрашивает что он хочет например дополнительную роль доступа то есть до сих пор Мы говорили о какой-то той самой redride ролик который имеет то есть команда люди которые добавлены в эту директоры имели весь доступ А теперь команда запросила что она хочет отдельную группу людей в рамках своего спейса которые смогут только читать в нём и тогда нам надо создать очень много сущностей и хочется чтобы все это создание сущности было для пользователей примерно в 1-2 клика что мы видим тогда что у нас есть Space ast И в нем есть админская роль redride который имеет весь доступ Space не к этой роли приматлена политика астридрайд и админская группа в Active directory World ast redrive и мы тогда делаем вот по сути как наша ролевая модель работает что мы настроили что вот эта Нижняя подчеркивание даже тут является разделителем То есть если пользователь хочет новую роль которая имеет ограниченный доступ то у этой роли Обязательно должна быть то есть она может Матрица только ровно на одну политику а нижнее подчеркиваю мы не дадим пользователю добавлять какие-то другие политики он сможет использовать только одну политику и только одну группу воды точно таким же названием То есть все Матрица один к одному один к одному и тогда что пользователь делает владелец спейсом что ну это достаточно такое привилегированное право создания каких-то ролей внутри спейса через какой-то сервис desk это у нас реализовано можно реализовать любой дополнительный скрипт или прочее создает делать запрос этот запрос генерирует в автоматическом режиме эту группу в Active directory в этом запросе важно отметить он указывает всего лишь одно название роли То есть например redony И после этого названия он создает Ту самую группу в Active directory автоматизировано и создает все вот эти там штук 6-7 маппингов групп этой группы директоры внутрь Валта Все это происходит и После всего этого То есть он сделал буквально там один два клика чтобы создать эту роль он должен настроить политику для этой роли он должен сказать Вот таридонли политика что она имеет Какие права И тем самым что мы получаем мы получаем что внутри Space владелец сам может сказать Я хочу дополнительные роли и назначить и сгенерировать их а потом для этих групп в директоре назначить своих управляющих своих менеджеров И тем самым настроить для этих людей какое-то ограниченный доступ который будет лимитирован не уже не всем Space а только уже частью внутри Space То есть например чтением только какой-то части секретов наиболее часто случаи у нас все это также дает возможность гранулирован доступа которых я сказал еще раз все приносит Почему Для нас это важно Ну потому что на нас дают некоторые требования ОТ и б и так далее как это выглядит то есть опять же вот есть Нижняя подчеркивание о том говорили та же самая команда и внутри есть четыре папки команды и мы хотим чтобы разработчики имели доступ бредон ли абсцесс comman секретом полный доступ к секретам и так далее когда мы просто буквально два клика как я уже показал на предыдущей схеме администратор спейса создает эти самые роли и получает тот самый доступ и тут уже хочется подходить к концу то есть на самом деле еще раз повторюсь то есть вот секретан Джин зачем я об этом вам рассказала какую хочу чтобы вы сути ловили это было реализовано командой из двух дивопсов Когда у них была дополнительная работа Когда у них были дополнительные задачи То есть это был реализовано и достаточно быстро в рамках трех месяцев И тут Важно не бояться как-то это дополнять Особенно учитывая то что волк предоставляет весь этот интерфейс и удобную модификацию самого себя и вот весь этот плагин он может показаться сложным хотя на самом деле это весьма очень простая вещь которая работает очень просто Возможно это можно внедрить внутрь Болта мы этим не занимались мы реализовали пока вот на таком базовом уровне когда мы просто дополнили и создали дополнительный плагин как секрете который переопределяет все это и позволяет пользователю работать спейсом и закончить Я хочу тем что сейчас мы работаем над тем чтобы позволить пользователю уже в рамках своего спейса настраивать провайдер то есть уже волк был инструментом предоставления идентите чтобы люди могли конфигурировать свои приложения и тем самым логиниться через волк это тоже требует некоторых затрат и улучшение плагина Но вот в этом направлении мы сейчас двигаемся на этом я хочу сказать всем спасибо мои имена почта и телеграм указан на слайде Спасибо большое домиш большой тебе спасибо прям заслушался Хотя который раз уже слушаю Каждый раз как первый раз вопросы вопрос Давайте из чата задам потом вернусь наверное в зал Вопрос такой есть ли функционал Write хостов с которых может быть доступ до Space но я так понимаю реализованный у нас такой функционал еще раз прайд-лист То есть Можем ли мы задать лист Ростов Откуда можно обращаться к спейсу ну и соответственно с других хостов Спасибо на данный момент у нас такого нет мы реализовали это немножко иным образом то есть о чем я не упомянул презентации потому что время ограничено но по сути Мы реализовали немножко иным образом с помощью аудита То есть у нас реализовано это через некоторую внешнюю систему которая постоянно аудирует и проверяет кто Какое количество раз залогинился внутри болта и если он там слишком много раз это сделал то мы его блокируем тем же самым инструментом мы можем блокировать по какие-то Хосты и прочее Но вот такого явного Black листа где мы блокируем какие-то входные мы или адреса нет у нас нет Хорошо спасибо в зале У кого-то есть вопросы Здравствуйте спасибо большое за доклад извиняюсь вопрос будет глупый А у вас получается плагин изменяет классические путины Валта и соответственно у меня теперь вопрос Как вы наполняете вот то есть это чисто ручной наполнение Или допустим вы как-то смогли пропихнуть это через форму Спасибо за вопрос Спасибо гляди плагин он имеет свою целевую задачу позволить разным командам дистанцировать от других команд в рамках одного спейса он не имеет задачи наполнять конкретные секретаренджеры то есть еще раз вот у нас в рамках Алта там сейчас уже 500 команд и они все должны быть отделены друг от друга как конкретная команда наполняет свои секреты мы не обговариваем это дело команды она Сама решает как это все она наполнит создастся засметовый Мы предоставляем функционал То есть у нас есть плагин который позволяет это настроить и плагин в том числе то есть вот в рамках админского спейса Он позволяет это настроить в том числе через traphone То есть это все работает мы как там администраторы и мы сами пользуемся своим болтом у нас все это работает в том числе через тараформ Да это работает Но вот команда решит хранить и заполнять это мы не решаем мы не имеем доступ к секретам они все сами решили Спасибо большое Спасибо А еще один вопросик из чата быстро наверное ответ будет был разработан только плагин или сам Cold код Валта тоже подвергался модификации нет у нас задача стояла именно как бы не менять Волк и не менять релизные его цикл никак не внедряться в него никак не изменять И поэтому был реализован чисто внешне плагин который внедряется внутрь сервиса и больше мы как бы это не трогаем версия от мира отдельное отверстионирование И тут сразу связаны такой вопрос зависимости от версии болта проверяли плагин на совместимость с обновлениями волк не превратится ли плагин и данные тыкву при обновлении болта если тестовое окружение вал Так где тестируется совместимость и корректность работы Да конечно у нас несколько окружений в том числе тестовое окружение на которые мы всегда заранее выкатываем новую версию болта обкатываем изменения для этого всего тест автоматизированы которые все это обкатывают и проверяют в этом случае да мы конечно проверяем в том числе проверяем какой-то тинько Не дай Бог что-то сильно изменилось и надо что-то адаптировать Да это некоторое дополнительная работа на дивопса и под команду поддержки постоянно проверять что плагин работает и у них есть единая интеграция Да это излишек минус этого решения но он зато это все автоматизировано межпасибо А еще вопросы Спасибо за доклад классно все было у меня на самом деле есть один короткий вопрос доступен ли плагин в Open Source а более существенный вопрос Вы сказали что у вас 500 команд при этом волк комьюнити эдишен не позволяет делать хайпе formance соответственно насколько плагин во-первых замедляет работу Валта и второе не боитесь вы его при отсутствии масштабирования в хайпе formance использовать спасибо повторили вопрос который в чате Я думаю что двух хорошо спасибо за вопрос да давайте последовательно доступен ли World Open Source нет недоступен быстро ответ чуть-чуть раскрою на самом деле Ну то есть еще раз команда у нас поддержки Алтай небольшая то есть суммарно 5 человек там из них два диопса дано то есть два человека которые действительно занимается поддержкой и эти два человека как раз занимается разработкой и только разработка наш конкретный волк уже занимает весьма много времени и у нас просто нет тех ресурсов чтобы скрыть то что не нужно и выложить это в опенсорс чтобы это все сделать доступным каждому нет На данный момент это не планируем это наше решение конкретного нашей ситуации но вот в докладе пытался донести что в принципе это реализуемо и легко реализуемо в любой команде так два других вопроса про hyperformance и про то что при расширении болта мы уже сталкиваемся с некоторыми проблемами это факт действительно и тут мы наверное будем искать какие-то альтернативные решения то есть Мы попытаемся как-то уже изменять базу данных и работать с этим есть проблемы это факт и пока мы не нашли ее то есть Возможно мы будем реализовывать какую-то дополнительную реплику что-то такое то есть возможно дополнительный instance valta в котором что-то будет такое Пока нет решения проблема появляется появляется не спеша пока Все работает отлично но да такой вопрос есть на повестке Спасибо Миш а у кого микрофон Здравствуйте такой вопрос как-то выкапы делаете как-то организовано Скажи пожалуйста Да спасибо за вопрос бэкап конечно реализован Он реализован в автоматизированном виде опять же то есть в нашем случае это действительно простая вещь то есть это некоторая задача можно сказать в кроне в самом базовом виде который там раз два часа выполняется и сохраняется на отдельный сервис бэкапирование несколько сервисов на всякий случай потому что вот опять же должен быть защищенным мы используем Консул как storage Back and и поэтому концу мы покатим внутренним средствам То есть это просто некоторое регулярные задачи я мишут себя наверное расширит уже выкапывал мы делаем А что в этот быка входит это сам волк это это секреты которые мы храним там это какая-то информация о том что происходило те кто создавал как обращался Давай быстренько отвечу от времени немного остается внутрь болта внутрь консула то что куда вот сохраняет данные по сути входит все то есть вот шифрует свои данные и кладет их в сторону поэтому когда мы делаем Backup Stories Backup консулу то формально сохраняется абсолютно все метаданные секреты роли для доступа тогда и так далее так далее политики все Спасибо А еще вопросы Из зала Да спасибо за классный доклад У меня есть два таких вопроса Первый вопрос вот ты говоришь вы делаете бэкапы А у вас это настоящие бэкап или бэкап еще один Гера То есть вы периодически восстанавливаетесь из бэкапов и интересно как вы это делаете случае вальта это первый вопрос а второй вопрос очень даже не вопрос А наброс вот не так давно был доклад от Вани на тоже на дивупсе как раз про вольт и как раз про масштабирование вот так где он собственно объяснял как это делать хорошо и делать правильно вы собственно смотрели его Спасибо Спасибо Да так вот Ваня я знаю он не его скидывал я его смотрел Спасибо за Вопросик Как раз возможно в этом направлении мы будем двигаться как у него в докладе просмотрено сколько я помню он использует отдельную я не помню какую базу данных но кассандру да и в рамках неё он может уже разграничить тоже в некоторых на эспейцах там и работать с ними По отдельности то есть возможно переход на другую базу данных позволит это улучшить подумаем можно как мы его делаем напротив на данный момент мы уже работаем три года то есть вот стоит работает мы не восстанавливались но быка бы прода мы регулярно восстанавливаем в рамках работ на тестовом кластере то есть мы не восстанавливает напротив чтобы не прерывать работы но с помощью антибаг то есть у нас есть некоторые скриптик некоторые плейбук который мы запускаем он автоматизированном виде идет берет Backup кладет его на тестовый кластер и перезапускает кластер Спасибо чуть меньше осталось успеем еще Так давайте быстренько кратенько Михаил Спасибо за доклад Хотел вот вопрос спросить вот в наше время до мультиклауд когда команды 500 команд и разбиты на страны это централизованный какой-то волк от 1 точка входа для безопасности управления там инженерами да Отвечая быстро это суть этого болта была в том что я одно из Новых требований в самом начале указал что это единый сервис единая точка входа то есть Это единый Wold до сих пор который легко со стороны там и Б контролировать проверять И вести там учет учет так и прочего и все это там в директоре тоже один организатору нет то есть удобно и едино Спасибо коллеги у нас время закончилось у кого-то вопрос Если остались дискуссионные зону прошу будем Полчаса наверное отвечать Всем спасибо что пришли"
}