{
  "video_id": "2bD3vs7iif4",
  "channel": "DevOops_conf",
  "title": "",
  "views": 0,
  "duration": 0,
  "published": "",
  "text": "хочу представить наших следующих спикеров это игорь николаев из мир платформ и мой коллега женя трифонов и за джо круг групп вас впереди ждет интервью на который называется как хранить артефакты игорь тимлид команды инженеров по автоматизации процессов разработки и нас пока и мир платформ он занимается стандартизацией и автоматизации процессов связанных с со всеми этапами построения вся и сиди также помогает внедрять devops и тиражировать проверенные и эффективные решения в этом интервью коллеги обсудят существующей системы хранения артефактов некоторые из особенностей их сопровождения а также поговорят о том какая система используется в мир платформ и и нас пока спикеры расскажут о тех моментах на который важно обратить внимание и поделится небольшими лайфхаками давайте поприветствуем игоря и евгения приветствую участников конференции в этом включение я про спрашиваю игоря николаева из компании нас пока охранение артефактов у них и если кому-то при имени игорь николаев сразу вспомнилась песня выпьем за любовь то хочу сказать что это другой игры здесь мы будем пить за devops и говорить о нем вступительный вопрос игорь расскажи чем вообще занимаешься вы нас пока добрый день коллеги привет евгений в компании нас пока занимая позицию лида инженеров по автоматизации процессов разработки собственно моя команда занимается тем что старается найти интересное полезные практики в разных наших проектах которые мы разрабатываем сделать так чтобы они были перри используемыми тиражируем других проектов помимо этого мы разрабатываем систему автоматизации которая интегрировать себя все наши сервисы связанные с континента решим continuous delivery и вот в догонку вопрос про компанию поскольку в контексте охранения артефактов там имеет значение там масштаб и как их много то вот скажи что-нибудь про компанию хоть и в виде количество команд хоть виде того сколько вот все ваши артефакты весят суммарно на текущий момент могу достаточно точно сказать что у нас разрабатывается около 77 проектов все они на разной стадии жизненного цикла находятся эти проекты разрабатываются в достаточно большим количеством команды разработки которая состоят от нескольких участников до нескольких пицца тимов сейчас этих команд около 28 количество сервисов у нас достаточно большой объем дискового пространства который занимается артефактами генерируемыми как раз виде этих сервисов занимает около 4 терабайт дискового пространства теперь переходя к теме хранения артефактов я думаю что большинство участников devops не нужно пояснять что это в принципе такое но все равно на всякий случай давай его то зайдем с самого начала чем являются системой хранения какими они бывают и так далее все системы которые современные есть система все операционная система все языки разработки в себя включают обязательно пакетные менеджера в рамках наверное java если брать за пример то это будет мэйвен формат в рамках платформенных какие-то для linux это наиболее популярная рпн и debian соответственно каждое из этих технологий она подразумевает что артефакты будут храниться в каком-то репозитория и будут давать возможности либо переиспользовать какие-то вещи либо еще что то соответственно сложно представить какую либо технологию себе которая не включала бы задачи по хранению этих артефактов текущий момент времени наверное два основных игрока рынка и 2 основных системы и the same type nexus и g pro card factory так же само собой массы нишевых продуктов которые включают поддержку тех или иных частей кусочков как бы но нет таких больших комбайнов которые бы позволяли почти всеми видами артефактов управлять тут напрашивается вот вопрос а что из этого используете вы мне тут хочется сделать маленький дисклеймер что это может выглядеть как такое продвижение что вот используете то же самое и все ваши проблемы решатся но конечно серебряных пуль не существуют разные технологии лучше подходят в разных обстоятельствах поэтому вот и хочется узнать что используете вы ну как раз и узнать о какие там у вас обстоятельства поддержу дисклеймер да мы тоже не пытаемся кому-то что-то продать и рассказываем просто про то как у нас это сложилась на самом деле в действительности мы сейчас используем nexus nexus используется у нас достаточно давно на момент когда было принято решение о том что там необходима система хранения артефактов был nuts с версии 2 на тот момент он поддерживал мы информации в принципе нам он нужен был еще для того чтобы поддерживать форматы рпн соответственно для операционных систем в принципе не так много задач можно было бы решить и чем то еще но нам понравилось то что он был полностью спонсорстве нам соответственно на тот момент когда мы его внедрили особо это как а вот большого количества проектов и задач на него не возлагалась нас был один общий репозиторием even мы в нем соответственно хранили все наши артефакты по определенному крупный ему как это принято в maven формате ну и собственно никаких проблем с этим не было потом мы стали очень активно расти у нас появилась необходимость в докере и мы стали задумываться что же делать микс из сторон не поддерживает надо будет счет наверное нам придумать с этим но сама тайпа во время решили что надо бы внедрить поддержку докера и появился nexus 3 который включает поддержку докера для нас на этом моменте стало понятно что нужно обновиться обновление с новыми большими возможностями это всегда звучит хорошо но одновременно это это . где временами происходит какой-то devops и вот любопытно для вас этот переход был в какой-то степени болезненным или нет на самом деле операция сама по обновлению по миграции она достаточно простая и смотреть давал механизм который позволял это сделать но стоит заметить что одним из важных изменений в nexus tribal и изменения подхода к правам и политикам доступа до определенных объектов соответственно при миграции при этой эти политики они слита для нас а тот момент в принципе если бы мы переезжать задумали как есть то для одного репозитория снова вернуть все привилегии как бы не было большой сложностью но к моменту появления третьего нексуса и решение что мы на него мигрируем мы поняли что количество проектов у нас уже около 40 и начали появляться область а вот став на я вот собственно и какие-то вещи плюс между собой как бы возникать на у некоторых проблем и некоторые сложности о которых я расскажу потом собственно мы решили что мы не будем переезжать как есть мы поставили рядом два из нас а второй и третий nexus и начали по-тихоничку перевозить артефакты случае когда у нас появлялся новый какой-то проект мы сразу заводили его на нексусе третьем случае если у нас соответственно что то нужно было изменить во втором нексусе мы это все дело тоже переносили в 3 nexus и какое-то время они существовали бок о бок собственно наверное важно здесь еще сказать то что в какой-то промежуток времени он нексуса вышла возможность использовать rest api и это стало большим плюсом его сторону на тот момент потому что у нас большое количество автоматизации появилась расскажи тогда про это подробнее что именно делали до появления растопи руками а потом автоматизировали до на самом деле пока rest api не было открытого ноксуса 3 приходилось руками заводить сущности было уже общая какая-то политика нейминга этого всего дела но все равно иногда бывали какие-то странные моменты однако когда появилась возможность использовать с 300 ppi мы автоматизировали этот процесс мы автоматизировали создания сущности в нексусе сущностями по сущностями я подразумеваю репозитории было бы соответственно привилегии какие-то политики очистки ну и все остальное это привело к тому что все стало более строго именоваться все стало еще более 1 тип там и собственно сильно упростило жизнь дальнейшем раньше уже упомянул что возникли какие-то сложности и давай вот теперь последним но таким довольно открытым вопросом от меня будет про это вот у нас конференция с названием diffuse где мы говорим там с одной стороны а хорошим там best practice a секса stories но говорим о я всякой боли и проблемах и так далее вот в чем у вас возникали какие-то сложности с нексусом о сложности более небольшие в принципе в основном особенности мы столкнулись с тем что в какой то момент времени мониторинг начал нам сигнализировать о периодическом переполнение оперативной памяти собственно как обнаружилось это были проблемы которая связана с тем что для каждого докер репозитория когда он у вас публикуется через порт поднимается определенный коннектор этот коннектор съедает достаточно большое количество рис софт ну и в общем то если вы пользуетесь штатном штатами коннекторами в нексусе может это привести вот к такой проблеме мы соответственно по диагностировали по диагностировали это все дело обратились коллегам и сцена type a они дали подсказку о том что правильно будет поставить engine спирит нексусом и чтобы порты понимали станем и дальше уже все соответственно работало нужно на nexus собственно совместно с коллегами same type а на самом деле мы проделали большую достаточно работу чтобы еще инструкцию это все перелопатить сделать как-то более понятным для всех и после нашего обращения после совместного переделывания этого всего дела у нас количество опубликовали изменения в инструкции так как они рекомендуют и сейчас делать в общем то благодаря нам наверное ввиду того что проект у нас обладают это 2 2 на верный момент важный ввиду того что мы проекта обладают различными софт водами прошу прощения проект проекта обладают различными различным жизненным циклом мы зачастую сталкивались с тем что в определенных репозиториях у нас начинала переполняться место это происходило потому что некоторые проекты у которых сейчас реализм генерирует достаточно большое количество артефактов когда все артефакт хранятся в глубь stores которые находятся на одном диском разделе это приводит к тому что он может в какой-то момент времени просто иссякнуть и место закончится соответственно может за affected соседние проекта как решением этого всего дела служит использование простого стандартного средством и нарезаем дисковое пространство на отдельные разделы эти разделы мы делаем именными под проекта каждый проект имеет то есть своего свой объем дискового пространства на нексусе мы всегда за счет этого можем настроить мониторинг таким образом что он будет уведомлять какого проект заканчиваться начинает это самое место также можем в динамике смотреть за потребляем ими ресурсами и прогнозировать что нам понадобится дополнительное дисковое пространство для того или иного проекта соответственно это достаточно удобный механизм и третья важная часть которой хотелось бы наверное тоже рассказать вам это то что есть практика такая есть подход что для решения задачи с автоматизации очистки на нексуса рекомендуется наверное использовать для каждого проекта по минимум два репозитория с точки зрения один репозитории белизны и 1с на плотной могут быть еще какие-то дополнения особенность в том что политики стандартной очистки они достаточно слабы и не всегда решают наши потребности собственно этих политик вполне достаточно для сна почетных репозиториев но их нельзя навешивать на релизе потому что во многих случаях это может удалить какие-то действительно важные артефакты так вот мы всегда рекомендуем использовать снапшоты в них складывать все что генерируется в большом объеме то настроены политики очистки релизной репозитории его мы рекомендуем как бы пока вот очищать руками и ввиду того что он заполняется значительно более медленно чем-то плотной репозитории достаточно удобное решение пожалуй это наиболее три важных момента которые хотелось бы поделиться но это наверное все спасибо за ответы вот с моей стороны по вопросам все но мне хочется напомнить зрителям что после каждого выступления у нас у участников есть возможность задавать вопросы поэтому если у вас они возникли то вот смело там переходить в дискуссионную зону их задавайте вот там ждое вот уточнить что-то по и нас пока раз уж тут такая тема сравнение разных систем там можно думали пахали варить немного вот обсудить выпить за devops обсудить 5 причин использовать nexus и 5 причин использовать артефакт арии что в каких случаях лучше и так далее в общем всем кому тема интересна предлагаю вот еще по этому поводу пообщаться в целом всем участникам хочется пожелать интересного продолжения конференции большое спасибо все ждут дискуссионные звоня"
}