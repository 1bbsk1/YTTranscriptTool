{
  "video_id": "e_yDjYLjano",
  "channel": "DevOops_conf",
  "title": "",
  "views": 0,
  "duration": 0,
  "published": "",
  "text": "Всем доброе утро Мы открываем эту конференцию devops 2023 года и начинаем ее замечательным докладом нашего замечательного Антона Черноусова с вами кстати ваш Эксперт Абашев Алексей сейчас будет доклад демистификация сервис трансформация процессов и культуры разработки Где Антон нам расскажет Как правильно готовить сервер лес уровень наверное базовый смузи вот технологию поэтому не будет каких-то таких жестких погружений в Клауд и чего-то такого вот расскажем как что где и Поработаем над культурой после после этого выступления будет coinda если у нас останется время вопросы будете задавать кстати есть qr-код сканируете его в телеграме я буду читать ответы расскажу Антону после выпуска пойдем спикер как она дискуссионная Зона дискуссионная зона в которой ответим вообще на все вопросы телеграме лично личные вопросы не личные Как жизнь Как что вот начинаем ребят Всем привет пару вопросов так сказать для разогрева прежде чем мы начнем А Поднимите руки Кто живет в облаках Ну то есть у кого провод в облаках все отлично так а личные проекты У кого в облаках вот личные Кто кто свои под Project и делает так процентов 5 наверное да не побольше хорошо отлично Дело в том что я делаю адвокат Яндекс Клауд и для меня важно чтобы когда работаете с облаком вы всегда понимали с любым облаком абсолютно чтобы понимали что это в некотором смысле конструктор это такая важная тенденция это все кирпичики из которых вы собираете свой в некотором смысле корабль у кого-то он там космолет у кого-то нет у кого-то маленький у кого-то большой но в целом это всегда некоторая конструирование помимо того что вы напишите какой-то код он все равно опирается на некоторые базовые механизмы которые есть внутри системы и вы должны немножечко понимать как оно работает понятно что любой технологии есть некоторые представления о любых компонентах которыми вы пользуетесь эти представления и сегодня вот это общее представление людей о технологии serverless и о том как она работает я буду собирать с помощью нейронной сети Яндекс который мне поможет соответственно какие-то базовые структуры показать А я буду про них рассказывать говорить это миф не Миф это работает не работает как оно работает и какие-то моменты будут здесь в самом начале Я спросил Яндекс gt2 Что такое сервер лес и она вроде более-менее Вполне себе ответила Вполне себе адекватно потому что главная проблема с нейронными частями особенно вот последнего поколения это что они иногда галлюцинируют Да понятно они собирают какой-то общей массив информации выдают что-то Но на самом деле мы тоже как разработчики иногда галлюцируем мы такие типа О это работает так вот мы с вами поговорим Про Сервис и Про некоторые механизмы которые работают внутри про то как на самом деле Какая практика накопилась как наши первоначальные представления о том что такое серверы Как делать такую разработку как Они поменялись сам я пришел заниматься сервис больше трех лет назад Вот именно так плотно до этого я в общем практически не знал как это вся история меня так заразило что в начале был таким неофитом О я всё хочу в этом делать всё хочу использовать А потом чем больше ты разбираешься ты понимаешь ограничение краеугольные камни и понимаешь что вот нужно как-то по-другому применять некоторые компоненты и относиться к ним по-другому вообще в целом разработку строить может быть с некоторыми изменения этим постараюсь сегодня поделиться с вами и мой доклад будет скорее такой обзорный именно в этой части Он действительно не будет хардкорном как Алексей сказал Поэтому если вам Хочется больше хардкора то пожалуйста есть рядом соседние доклады они более инженерные это доклад например про Hill Chart registry от Алексея Романова и доклад про политики безопасности от Алексея Смирнова во втором и третьем зале соответственно есть возможность пойти более такой инженерной доклад послушать Если же вы остаетесь здесь то ещё раз напомню меня зовут Антон черновцев и у меня есть совершенно замечательный Подкасты собственно говоря с него по большому счёту началась моя история с и также мне сегодня экспертом Алексея башев вместе с ним мы ведём совершенно замечательный подкаст разбор полётов Так что тоже приходите и Подписывайтесь для того чтобы у нас был некоторый comman Sens о том что такое сервер с как он работает какие там есть движущиеся части Я немножечко напомню С чего он стартовал вообще в целом самого начала и надо понимать что стартовал он с базового сервиса фашина за сервис и он до сих пор лежит является краеугольным камнем В целом все технологии по большому счету первая промышленное применение началось в 2014 году Там практически за один год одновременно стартовали и амазон лямды также там потянулись побольше чуть-чуть Google Cloud functions Ну они там очень рядышком близко друг другу были дальше крупные игроки тоже как бы поняли что нужно в это вкладываться Ну по крайней мере в каком-то объёме чуть позже появилась Яндекс и соответственно наши Яндекс сказал functions Надо понимать что за это время было написано достаточно большое количество различных книг материалов и первой книги которые на мой взгляд были очень неплохими с которыми познакомился они сейчас немножко подустарели их ссылочки есть сейчас на экране но важный момент во всех базовых стартовых условиях продавалось аудитории три базовых таких концепции Что фашина за сервис предполагает некоторые абстракцию над серверами в целом вы не касаетесь серверов сервера где-то там есть но вы ими не управляете не запускаете не настраиваете предполагалось что автоматический скеллинг То есть вы написали приложение а платформа собственно облачная она сама заботится о том как масштабировать ваше предложение и масштабировать в обратную сторону соответственно и продавалось всё это ещё под соусом экономичности что это всё ваше приложение Если проставит вы не платите денег и мы разберём это всё всю историю в целом сама технология и сам подходят факшена за сервис как будто бы он разработан специально для хаотической компоненты Когда у вас есть с одной стороны некоторое некоторые бизнес-процесс который не постоянно лежит под полку А он то есть то его нет то есть то его нет и он у вас в течение там суток времени какого-то периода он иногда может быть нагружен а иногда полностью отсутствует И вот именно под эту хаотическую компоненту вроде как Service должен был подходить абсолютно идеально если мы сейчас текущий момент посмотрим что у нас есть в Яндекс Cloud с точки зрения то у нас есть все базовые компоненты которые необходимы для того чтобы разработать полноценное приложение и в принципе подобные же сервисы аналогичные есть во всех крупных облаках Поэтому в принципе что я буду сегодня говорить оно подходит ко всем облакам которые полноценно делают сервер led-платформу понятно что э облака Ну в облаках невозможно как я говорил Если вы строите свое приложение из разных компонентов и понятно что есть продукты с очень схожими принципами работы что-то там прямо совсем идеально работает максимально похоже на сервис что-то немножечко по-другому Ну и понятно что этот список постоянно Пополняется если Посмотреть например на последние там инвент который производили товарищи из АВС в декабре прошлого года мы ждем следующий рент чтобы так сказать узнать что они новенького выкатили там примерно в каждой второй или Каждый третий презентации было слово сервер LS и какая какой-то кусочек как они свои один из своих сервисов очередной двигают в этом направлении вот в целом когда мы смотрим на любое сервис приложение мы предполагаем что оно живёт не в некотором не в вакууме а оно рядом с вашей существующей инфраструктурой Где у вас есть уже какие-то компоненты они уже развёрнуты и вы просто рядом строите ещё что-то новое э по крайней мере так это часто выглядит и э например один из самых простых элементов с которым вы можете очень быстро ознакомиться ввести в свое собственное разработку и использовать у себя это Например инструменты chitops например вот ребята очень часто используют Telegram у нас комьюнити огромное количество ребят которые используют Telegram ботов для того чтобы улучшить свои процессы разработки и Например у меня был пару лет назад доклад про интеграцию в инструменты чатов кстати Ребят а кто вот сейчас использует сервер less просто Поднимите руки пожалуйста прямо у кого есть серость приложения то есть вот два три четыре немного Да отлично Тогда смотрите когда вы начнете используете Если вдруг сервер то вам потребуется Ну не наступить на самые базовый ошибки которые могут возникать можно посмотреть один из моих докладов ссылочки Потом тоже будут Понятно презентацию можно будет скачать против личной ошибки разработки на это все и просто сделал такой сборник из нашего комьюнити и среди клиентов самые типовые самые частотные ошибки которые встречаются при разработке можно будет на это опираться и в этом году я сделал доклад про фенопс практики в облаках и там есть тоже раздел посвященный сервер с очень важный Поэтому если вы не используете сервер с то возможно вы используете и понимаете что такое фенопс кстати Скажите пожалуйста а кто использует в своей работе различные Кто знает сколько стоит их ваш сервис потребляет вот уже примерно 30 процентов отлично супер смотрите если вам тема сервер с или в целом облаков достаточно интересное что происходит у нас то и у нас есть совершенно замечательная конференция Яндекс скилл который будет 25-26 числа здесь она будет в Москве но можно будет в онлайне посмотреть Приходите регистрируйтесь на не а если заинтересуетесь Темой сервелас то Приходите в наше сообщество У нас очень много всего но вроде бы несколько лет я этим всем занимаюсь разобрался посмотрел использую и многие вокруг меня это делают в этом же сообществе вроде бы все хорошо и какой-то момент ты такой думаешь Ну вроде бы все хорошо такое ощущение что никто не ожидает испанскую инквизицию а на самом деле действительно никто потому что если копнуть поглубже разные сервисы то ты увидишь что что-то из того что тебе изначально продавали то что О чем тебе изначально говорили оно не работает или работает не так и либо работает так но как бы есть нюансик это мы сейчас аккуратненько каждый из этих нюансиков попробуем разобрать и посмотреть начнем с того что мы поговорим про какой-то базовый вот этот набор мифов первое Ну значит я спросил значит нашего Яндекс gpt значит что же такое Service функция И вот она совершенно замечательная позволяет разработчикам не заботиться о ручном управлении серверами другими ресурсами И в целом В общем прям красота Должна быть и в целом это плюс-минус действительно соответствует этому понятно что очевидно где-то там что-то исполняется Но что исполняется и Как исполняется Дело в том что в принципе все платформы облачные делают примерно следующее они создают некоторые виртуальные машины которые в которых внутри собственно говоря исполняется код той самой функции вот эти маленькие микроб они по сути дела изолируют функцию то есть тот код который Вы написали от всего платформы и вторая задача которая решает микровиртуальной машины это быстрый запуск мы быстро запуска еще потом дальше коснемся Потому что это вообще больная тема для сервера вас но в целом запуск операционной системы происходит следующим образом во-первых Ну это всегда свойств и всегда запуск ну без виртуального биоса очень маленькое ядро пересобранные Ну вот с минимумом всего не нужно Не нужно всё удалено естественно и там задача уменьшать запуск ядра вот в нашем случае в Яндекс от 60 до 160 секунд там есть нюансы когда я говорю о том что мы все боремся за вот этот быстрый старт то Любой человек который начинает только изучать он сразу натыкается на такое словосочетание Ну холодный старт Давайте с вами сразу разберемся что это такое если спросить о у Яндекс Что такое холодный старт период времени в течение которого сервера в нашем случае приложения запускается и начинает тщательно запросы то есть запрос пришел в систему до момента когда ответ ну начнет начнется обработку Это холодный старт вот а и в контексте сервер с это время она на запуск нового инстанса то есть экземпляра вот этого сервера в котором уже расположен ваш код то есть микровиртуальная машина плюс ваш код и это реально нужно понимать что от этого ни в одной платформе невозможно избежать это факт для того чтобы с этим бороться придуманы разные методы и чтобы понимали как это внутри устроено есть например те вот виртуальные машины про которые говорил самом начале они собираются в такие пулые виртуальных машин они заранее готовятся запускаются очень маленькие там загружается операционная система она суспендица это виртуальная машина и помещается в пул лежит ждет как бы в момент когда наступает ее момент использования приходит какая-то нагрузка из Пула Эту палочку маленькую достают кусочек вот ее резюме дальше Ну понятно ваш код он же понятно это какой-то текст Ну текст здесь кавычки Да его нужно подгрузить Он монтируется в виде файловой системы добавляется нужное количество памяти из ваших настроек и устанавливается переменные окружения дальше это все запускается runtime собственно говоря тут runtime который выбран для вашей функции в этот момент виртуальная машина виртуальная машина Она уже готова ваша функция уже готова и соответственно из очереди задач вынимается Запрос который собственно говоря пришел то есть Понятно У нас виртуальная машина уже готова По большому счету вот этот запуск 3 чуть-чуть времени это одна из первых оптимизация которая случается у всех кто вот планирует построить платформу они делают такую историю и по большому счету благодаря этому так у нас есть возможность заранее подготовить виртуальные машины Мы заранее знаем что она сможет случиться и у нас есть некая очередь запросов мы можем сделать автоматическое масштабирование если мы говорим про автоматическое масштабирование то давайте спросим про что думает Яндекс GP про автоматическое масштабирование и там важно там есть два момента про который мы отдельно поговорим первый момент что нет необходимости вручную управлять серверами или масштабированием Ну вот про сервера мы немножечко поговорили о про ручное масштабирование Вот это Интересная история смотрите Какая история вот это вот это вот этот вот это утверждение оно плюс-минус правильное оно вроде бы с одной стороны правильно с другой стороны нет Давайте поговорим про то как работает та самая очередь то есть если вот мы дальше продолжаем Вот это движение очередь задач а запрос любой пользовательский Запрос который приходит он попадает в эту самую учитель он как бы в стакан условно говоря падает сверху Но дальше соответственно из Пула на каждый экземпляр вроде как вытаскивает задачу из очереди он приходит берёт задачку загружается и полетел дальше но это все прекрасно до того момента когда вообще на самом деле очень сама пустая у нас много экземпляров они в пули стоят у нас есть возможность соответственно просто их вытаскивать оттуда брать следующую следующий запрос и уходить но это все так до того момента когда запросов придёт много больше либо больше чем у тебя есть возможности запустить эти самые виртуальных машин либо ты упираешься в некоторых физические ограничения значит для того чтобы этого не случилось у нас понятно придуманы квоты и вот здесь важный момент одновременно запущенные экземпляры Функции там есть возможность ограничить их количество грубо говоря чтобы вы не сожрали все деньги мы сразу там есть ограничения по памяти по одновременным выполнению запросам и так далее важный момент как только превысили шедоллер говорит ой вам ошибочка и тут важный момент в этот момент возникает как раз ручное управление Почему я говорю плюс-минус До этого все работало автоматически типа ну как бы у тебя же есть следующий фото и пока следующий не освободится вот виртуалочка от выполнения запроса пользователя ты все время будешь получать 429 понятно как бы это неприятно но как мы понимаем за деньги да То есть можно прийти в поддержку Можно мне кого-то чуть повысить понятно что повышение код само по себе оно бесплатное но нужно понимать что одновременное количество запросов пользователей за каждый вызов вы все равно платите маленькую супер копеечку но тем не менее надо это понимать Итак давайте вернемся к еще одному мифу который базовый что сервис является экономически эффективным если спросить какую-то общую фразу которая comman Sense она вот выглядит следующим образом тут есть несколько элементов каждый из которых мы Давайте разберем первая часть это снижение затрат на инфраструктуры управления Ну действительно Казалось бы у тебя ну нет парка машин ты не настраиваешь не обновляешь операционную систему за тебя это сделала платформу более того Он держит в актуальном состоянии там бак Фиксы там Security апдейты все внутри происходит Ты этого не касаешься этот Пласт работ С тебя С твоей инфраструктуры просто убрали Блин я этим не занимаюсь уже офигенно масштабирование Ну как я только что объяснил она с одной стороны в рамках твоих вот действительно является ну класс тебе не надо думать придумать какой-то механизм обновляться выкатываться Там и так далее То есть в целом Вот это это часть про экономику она плюс-минус соответствует но нужно всегда помнить что квоты придется вам крутить руками и мониторить систему Вот это важная штука которая должна у вас быть вы не можете просто выкатить приложение и забыть про него Ну понятно обычно в принципе так никто не делает но тем не менее здесь разработчик обязан принять на себя обязательства мониторить систему упираемся Мы в код и не упираемся в поту как минимум это первое дальше в утверждении есть тоже замечательная история оплачиваем только за фактически используемые ресурсы вторая часть про экономику и здесь тоже вот здесь вот абсолютно реальная история тут Важно У нас есть в когда мы используем сервис 2 условно два типа ресурсов первый тип ресурсов это вычисляемые какие-то которые связаны именно с вычислениями это функции это сервисный контейнеры это какие-то там есть очереди Там и так далее внутри североносных баз данных есть именно вычислительная компонента и вот это один тип потребления и второй тип потребления это хранение То есть это некоторые сторон Где вы данные храните потому что сервела с предполагает что у вас стейтс реализация каждый вычислительный компонент он не хранит данные по большому счету не должен для того чтобы масштабироваться хорошему состоянию должно храниться где-то снаружи и вот это вот компонента хранения где она может быть она может быть внутри Ну то есть Понятно вы туда сложили файлики за место надо будет заплатить Да какую-то микро копеечку но тем не менее Да вы Если вы используете СУБД базу данных Да понятно что есть там вычислительная компонента но есть компоненты именно захоронения за те гигабайты которые лежат у вас выключено приложение Ну выключено в том смысле что нет пользовательского трафика и вы никакой активности внутри не производит но вы все равно хоть копеечку небольшой платите потому что данные лежат они занимают место то есть про это нужно тоже помнить соответственно два типа ресурсов и в целом это правда оплачиваем только то что используем компьютер Ну вычисление Ну сам широком смысле и хранения плюс там еще Да понятно там есть сетевой трафик Но это как бы там отдельная история и дальше сервер с является экономически эффективным вот Я очень сильно воевал со своими коллегами потому что они считают что это да А я считаю что нет это миф на мой взгляд по факту если в целом В общем все общие случаи рассмотреть то сервер с В общем не Очень эффективен не нельзя все любое типа приложения положить переложить на сервер с чтобы оно стало экономически эффективным вот Хоть Ну невозможно Мы пытались придумать какие-то способы но нет а объективно надо я попросила Сейчас представить такую поверхность в которой на которой есть три точки такие вот три три вершины такого треугольника условно говоря первая вершина это та самая хаотическая компонента то есть есть приложение которые близки вот на этой поверхности по деньгам хаотической компоненте где постоянно что-то происходит есть нагрузка нет нагрузки пропала нагрузка надолго появилась она хаотически появилась выключилась и так далее там это ну и важный еще момент что там есть некоторые достаточно высокая степень транзакции какая-то такой Случайный скажем так в качестве примера приведу например много всего можно привести но в частности приведу У меня есть коллега который за рубежом сделал сервис для Налоговой деклараций вот весь год приложение мертвым грузом стоит Ну смысле там только данные хранятся Ну и иногда там кто-то заходит что-то подносить пообновлять там ну там супер такие оперативные чуваки Они каждый месяц приходят там все чеки вносят и так далее а потом есть два месяца причем один месяц когда там просто все под полку стоит когда все пришли срочно надо сделать там вылетает огромный объем данных значит как я говорил квоты надо крутить руками Да он приходит в поддержку покупает платную поддержку приходит ребята вот и надо выиграть вот настолько что у тебя там вообще вот ничего он сейчас все придут и они приходят и действительно там взрывной рост потребления и через месяц опять никого практически Ну там есть ещё вот там повторная задача потому что неправильно подали Там и так далее но это всё так и до следующего года вот хаотичная нагрузка любые отчёты там любые переформатирования данных любое там случайные видоизменение там в структуре ещё что-то идеально просто идеально подходит вторая вершина это а Супер неподходящее это потребление ресурсов которые действительно выложены на полку всегда Ну там не знаю обработку фильмов видео еще чего-то такого формата вы представьте себе да Когда вы постоянно молотите какие-то данные какие-то вычисления делать и они у вас идут просто бесконечно вот плюс у вас еще есть какой-то внешней пользовательский фродовый трафик который тоже генерирует некоторую вот эту дополнительную нагрузку это супер неподходящая история для серверов и вот третью вершину это какой-то закрытый например бизнес-процесс который направлен на достижение поставленным приложение ценности например Это у вас есть пользователи по подписке который приходит ваше приложение и они регулярно что-то потребляют но каждая их пользовательское действие оплачено и стоимость оплаты она действительно достаточно высокая для того чтобы компенсировать любые простои и любое неправильное поведение пользователей Вот вы разрабатываете приложение Если вы его делаете думаете можно ли его использовать представьте вот этот треугольник и Попробуйте поместить свое приложение куда-то в этом треугольнике Какой из вершин оно ближе там вы поймете Где вы можете что-то использовать Например если хотите ближе к хаотической нагрузке очевидно сверлилась вам будет очень очень подходить А если будет что-то закрытое за с поставленным бизнес-процессами там что-то можно сделать именно стиле что-то можно классическими сервисами и если у вас постоянное потребление ресурсов на полку то скорее всего нет ничего хорошего не получится будет всё очень плохо Давайте немножечко ускоримся и разберем принципы разбери поговорим про про то что приносит собой сервис с одной стороны одна из самых первых вещей которые за собой приносят сервер с это минимизация зависимости сирот приложением должны иметь как можно меньше зависимости друг от друга то есть каждая функция Каждый элемент системы должен максимально для того чтобы масштабироваться автоматически должен иметь минимум всего это реально это та штука с которой вам придется Она действительно работает по большому счету Все вы с этим немножечко знакомы через такой термин как ди каплинг да это в данном случае с предложением доведено до максимум потому что вам по сути дела Нужно что взять нужно взять приложение и распотронить его на какие-то отдельные кусочки на отдельный бизнес-процессы которые максимально коротенькие и дальше из них построить полноценную развесистую систему при но при этом Вы всегда должны контролировать точки передачи вот этого трафика или вот этого направления из мини видоизменения вашего приложения польского поведения Мне нравится кстати цитата вот этого человечка ваш уровень связанности зависит от уровня контроля который вы имеете над конечными точками на теми точками через которыми происходит взаимодействие с вашим приложением или внутри вашего приложения между сервисами мы об этом сейчас поговорим у него есть совершенно замечательная книга она правда устарела немножечко но там есть очень хорошие мысли если будет интересно скачивайте когда я говорю про ди каплинг одна из самых первых вещей которые Придётся делать для того чтобы Хмм начать работать и создавать приложения вам придётся разделяя ваше базовое предложение или представление о том как оно должно быть сделано а использовать асинхронные методы типа например э Point Point модель да Когда у вас есть одна функция которая выполняет некоторые действия вторая функция и между ними остается некоторое состояние Ну например через очередь то есть вы сделали какую-то работу сложили результат который стоит в очередь ну чтобы она не потерялась и завершили там данный какой-то один процесс дальше очередь разбирается кем-то кем-то следующим это может быть функция контейнер неважно важно что вот этот промежуточный вариант у вас возникает вы вроде как получили запрос быстренько что-то сделали вернули ответ наружу перед этим успели что-то сложить очень и умерли и вот это вот умерли это важная штука которую вам который Вам нужно привыкнуть Когда вы делаете с приложения нужно привыкнуть тому что все функции должны умирать они должны заканчивать свою работу чем быстрее они это делают тем лучше При всем при этом у вас автоматически как только вы начинаете вот таком как бы мыслить в таком стиле у вас следующие изменения случаются вы начинаете думать о блин мне же можно делать какие-то входные группы То есть у меня есть какой-то кусок моей бизнес логики и на входе у неё вот моего условного микросервиса может стоять некоторая входная группа которая быстро-быстро будет принимать всё в очередь в какую-то маленькую а внутри благодаря квотам которые у меня есть будет разбираться вот вот это входящий поток и соответственно Я очень быстро Буду умирать Ну в смысле как бы входящий запрос мы не будем ждать от этой асинхронность очень быстро повышается и Но это Адские ломающие изменения в разработке Так блин нужно какие-то что-то там ещё маленькие очереди где они за каждый из очереди Нужно следить Вы помните нельзя просто так поставить очередь и забудь про неё э ну помимо того что ну как бы там та же самая схема У тебя есть стейк который ты там внутри хранишь он может протухнуть Блин если у тебя там квот не хватило На это дело Ну блин более того пока ты обрабатываешь может быть куча ошибок как только ты воткнул хотя бы одну очередь У тебя же она на самом деле нет на по большому счету у тебя две потому что у тебя есть еще там неправильно отработанные запросы Ты должен куда-то сложить чтобы потом отдельно отработать и у тебя в твоей разработки появляются твои архитектуре появляется еще отдельный процесс по разгребанию умерших запросов в очередях которые в принципе до этого Когда у тебя было монолитный микросервис Ну как он маленький Да у тебя этого всего не было Зачем тебе ты начал работал работал работу сделал ответ отдал туда отгрузил вот Но как только ты начинаешь мыслить в таком стиле э-э приложение Понятно начинает быстро расти различные вот этими передачами стоит трансферами условно говоря причем они там разного стиля бывает а сама разработка становится проще то есть именно сам процесс именно болезненный потому что тебе нужно к этому привыкнуть но потом ты как-то очень быстро к этому привыкаешь и у тебя есть стандартные элементы которыми ты постоянно оперируешь в рамках разработки ну здесь можно апеллировать например вот к такой замечательной книжке она правда тоже местами подустарела но мне Hugo Мне очень нравится там есть масса моментов которые можно подсмотреть для своей архитектуры принципов передачи данных и в целом для того как Ну о том как правильно строить предложения Она не Про Сервис нос очень хорошо подходит Давайте пойдем дальше тестирование мониторинг без этого совершенно никак Дело в том что если мы делаем сервер из приложений мы постоянно должны тестировать его Дело в том что как я вначале сказал облако это конструктор огромное количество компонентов каждый компонент в Облаке тоже разрабатывается Он не стоит значит в Облаке постоянно чем больше облака кстати чем больше у него компонентов тем больше одновременно каких-то компонентов выкатывается обновляется меняется у них способ работы и может случиться Так что ваше предложение будет сломано для этого нужно мониторить и тестировать это вот к сожалению это реальность более того э-э для того чтобы это всё происходило вам нужно это всё ну как-то мониторить а к мониторинга очень круто следить за тем как потребляете свои соответственно ресурсы очевидно все жилось это приводит к тому что нужно следить за бюджетом это реальность и здесь практики посвященные фенопс работают в полную меру Если вы живете в Яндекс Клауд то можно использовать такие вещи как бюджеты триггеры внутри сервера в принципе в любом облаке это так работает у вас есть некоторые биллинг который поставляет Данные есть возможность этого биллинга выгрузить данные для того чтобы управлять своим облаком практически автоматическом режиме но для этого ну у разных облаков есть разные инструменты У нас есть соответственно триггеры Ну бюджеты триггеры и вперёд для этого можно посмотреть небольшую статичку и небольшой пример прямо взять себя использовать причём там всё тривиально пример с виртуальными машинами но Он адаптируется под любые сервисы То есть у вас есть маленькая функция маленький бюджет его переполнении вы соответственно начинаете отключать виртуальные машины Понятно вместо виртуальных машин может быть все что угодно и вы можете принимать какие-то решения там после архитектуре по масштабированию по квотам там нужно поднять дежурного пожалуйста чтобы чуть больше погрузиться в тему феном Я рекомендую посмотреть вот эту книжку совершенно замечательно потому что она в целом рассказывает организации вам построить этот процесс работы То есть вы не можете сами быть успешными в управлении финансами внутри клауда потому что у вас много коллег много изменений соседние департаменты и для того чтобы это полноценно заработало Я рекомендую ознакомиться с книжкой какие-то практики к себе принести Ну в частности Вот например мониторинг и слежения за бюджетами это одна из штук которая вот принципе отсюда по большому счету там масса совершенно замечательных примеров и Советов и рекомендую важный момент про локальное тестирование это миф сразу вот я так от всех обломаю все говорят Да можно свое сердце приложение у себя локально запустить там оберточку какую-то подставить и там придумывают кучу библиотек которые пытаются это делать Это все хреново работает прям откровенно Почему Потому что на самом деле для того чтобы делать тестирование тоже очень важная штука вам нужно вам нужно сделать полноценную копию внутри платформы То есть у вас есть ваша приложения вам нужно ровно Точно такую же копию развернуть благо разворачивание этой копии вам обойдется практически в 0 рублей потому что что они не потребляют ресурсов момент разворачивания но эта практика она вот именно за из Ди каплинга она требует именно полноценного разворачивания приложения не какую-то ограниченную часть вашего сервиса полноценное разворачивание и вот этот дубликат должен быть Ну полностью соответствовать тому что вы делаете важный момент он должен быть наполнен То есть вы не просто сделали систему А вы должны наполнить ее некоторыми данными тогда вы сможете провести полноценное тестирование Это вхолостую проверка ну вас запустилась А что запустилась вам нужно все сервисы которые взаимодействуют с вашими функциями протащить Значит нужно наполнить ее каким-то объемом данных то есть входящими запросами чтобы процессы начали работать чтобы вы поняли Где вы можете упереться в квоты Где у вас в новой версии runtime Где у вас какие-то библиотеки подустарели и так далее И вот это все вы можете сделать только если полноценно полностью соответственно создадите копию в Облаке блага сервер с это действительно легко вытекающие Еще тоже момент управление версиями Он очень простой Дело в том что вся сервис платформа в принципе построена на том что всегда пытается запускаться определенная версия функции или сервера с контейнера и это все тегировано по-разному всех сделано но по большому счету это важный важная штука Дело в том что как только вы делаете какой-то артефакт Вы можете его подписать и соответственно выкатить тестирование именно с этим вот конкретным тегам но важно важно что тестирование должно быть консистенным вы не можете называть компоненты как-то по-другому при тестировании DF окружении не Дефо окружение Это должно быть прям идеально названо точно так же название должны соответствовать версии там все для того чтобы это естественно работала вот такой консистентное тестирование нужно Понятно использовать какие-то себя сиди и понятно что лучшие практики то есть соответственно разработчик обязан этим пользоваться Это должен быть повседневный инструмент сделал выкатил проверил выкатил проверил в целом получается такая история что важные Важны и процессы которыми ты занимаешься и доступы которыми ты владеешь это все накопилось благодаря сначала дикапринг потом общее какое-то тестирование которое ты должен делать важно не забывать при этом что ты должен внедрить какие-то инструменты контроля то есть не забывать ты делаешь изменение системе сделать изменение феном своей модели То есть ты будешь проверять появились новые очереди новая загрузка новых функций новые поинты тоже подумать Ну и понятно что ты должен иметь доступ к инфраструктуре Потому что если ты не имеешь возможности выкатить и потестироваться ну как бы блин до свидания и доступ всей сети pipeline потому что тебе нужно там новые версии свои придумывать если вас несколько одновременная работа над проектом соответственно нужно иметь эту историю Да контейнеры кстати почему-то мы как-то вот я все рассказываю рассказываю это все про функции Дело в том что функции по большому счету это базовый сервис от него все строится но понятно что ни одними функциями живы Я так понимаю что все используют контейнеры поднимите кто использует докер вот сейчас вроде так остальные Что используют примерно половина подняла остальные Что используют что хорошо смотрите Ну понятно Да понятно нужно нужно какие-то артефакты собирать и в целом когда продают сервис очень часто продают такую идею зима чуваки Если вы уже делаете микросервисные приложения вы легко Можете заехать ибо Блин все вот прям чики-пики она типа вот работает прямо идеально мигрировать легко И на самом деле когда Ты изначально знакомишься с этой концепцией у тебя вроде бы Ну действительно но к сожалению там есть два момента первый момент миф невозможно микросервисное приложение в чистом виде в первый раз не переносится там большая с этим проблема Однако структура действительно предлагает то самое вот абстракцию и абстракция очень хорошо работает поэтому рядом с вашими микро сервисными приложениями Вы можете строить полноценные приложения и постепенно мигрировать те части из того вот этого треугольника который под динамическую нагрузку вам подходят но понятно что там все тоже не просто с контейнерами и я к сожалению оставшееся время не смогу полноценно рассказать о том как это все устроено Поэтому я предлагаю вам посмотреть совершенно замечательные вебинар моего коллеги про запуск существующих контейнеров которые кто-то соврал в сервис окружении и что с ними сделать чтобы они заработали именно стиле или все приложений Ну то есть такая вот именно та самая переделка которую вроде бы нам продают достаточно легко там есть вещи которые делать действительно легко быстро а есть вещи которые потребуют действительно серьезных вложений Но я считаю что все-таки это миф и поэтому здесь оставлю вас разбираться Этой темой самостоятельно и вот если мы вернемся Обратно мы вернёмся к нашему кораблю который мы с вами строим если внезапно этот корабль предполагается что вы его построить сделайте то я хотел бы чтобы прежде чем вы начнете это делать вы сделали три вещи во-первых вы пошли бы в облака которым вы не пользуетесь любой абсолютно и нашли элемент с помощью которого можете управлять финансами какую-то фенопс практику в нашем случае если вы используете Яндекс Клауд Приходите Используйте бюджеты триггеры и плавные функции для того чтобы управлять финансами и управлять ресурсами внутри облака для того чтобы понимать как туда Что движется понимать сколько ресурсов и потратили и сколько вы Заплатите немножко погрузитесь в эту тему Мне кажется это супер важно И в ближайшее время будет очень актуально и Если Вы все-таки планируете остановить свой выбор на использование сервиса Приходите в наше общество оно очень дружное там очень много практикующих ребят которые помогают нашей комьюнити Hero прям супер Молодцы на этом У меня всё я хотел бы закончить Спасибо вам большое говорят у меня осталось минут 20 Давайте скажем Спасибо Антону а у нас осталось одна минута поэтому мы наверно ответим спикерской зоне на все вопросы когда пришли в телеграме единственное Я бы хотел бы заранее сказать что Несмотря на то что всяких сервер лес докладов в интернете и всякой документации Полно но не один провайдер не рассказывает как все устроено конкретно внутри поэтому пытать Антона на тему например Как устроена оркестрация вот этих микро джимов я не думаю что он это может рассказать это мы как слепые будем щупать этого слона будем рассказывать какой у него хобот что это хобот или не хобот но такие вот тонкие моменты мы не будем это простой вопрос там в телеграме микро-две это контейнер или нет виртуальная машина Ну специализированные То есть это машина полноценная То есть это уровень гораздо ниже То есть даже вот докер демонеры Они сделаны поверх этих виртуальных машин со всеми теми же ограничениями которые есть на вкладах функции по большому счёту все ждем Спектр зоне ответим на все вопросы Спасибо большое"
}