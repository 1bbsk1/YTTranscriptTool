{
  "video_id": "Ra0egse6Fk4",
  "channel": "DevOops_conf",
  "title": "",
  "views": 0,
  "duration": 0,
  "published": "",
  "text": "Всем привет Так для начала Давайте немножко ближе под садимся не стесняйтесь подсаживайтесь Давайте сюда Вот и давайте наверное поднимем рука есть в зале 10 секунд поднимите руку где тут они Ладно где там никого не вижу с этого доклада они появятся с нами Андрей Привет Андрей Казалось бы докером уже пользуется все что это уже докер стал мейнстримом и даже когда например до контейнеров были докеры в порту Вот они когда гуглят Как найти они гуглят про докер Да им сразу хотите стать дефолсом вот настолько докер стал уже мейнстримом вот но важно понимать что не главное не только его запустить Да но еще иметь понимать безопасность Вот как раз сегодня Андрей нам об этом расскажет Маленький вопрос Андрей докер или подман что тебе больше нравится какой курятник лучше курятник доктор мой выбор докер Он был первым Да я как-то привык Отлично вот у Андрея будет полно слайдов там на слайдах будет нарисован человек который который не понимает в безопасности которые не думает про безопасность Вот и давай Андрей жги рассказывай нам как сделать контейнер надежными Спасибо большое друзья Здравствуйте Очень рад вас всех приветствовать и сегодня мы поговорим с вами про то как безопасно управлять контейнеризованным окружением точнее даже наоборот Как убежать из него но соответственно свои выводы Вы все сами сделаете Давайте пару слов расскажу о себе на данный момент я руковожу командой сырье в экотех это подразделение VK для бизнеса Мы работаем с B2B продуктами когда-то был разработчиком когда-то Был админом сейчас я ушел в менеджмент в целом войти больше 20 лет Ну и собственно Кто хочет ознакомиться с плодами труда это бизнес-менеджеры выкатимс типа с лака очень классная штука Итак и сегодня мы с вами поговорим про контейнеры контейнеры такая вещь которая ворвалась наша жизнь не знаю там лет 10 назад всех смотрели на них как на чудо чудесное Наверное какое-то сейчас уже без него без них нет собственно говоря жизни никто не видит настолько привычно стало все это и сфера применения контейнеров очень широка они стали менять собой пакеты то есть очень удобно расписали в контейнерах софт потому что не нужно беспокоиться о зависимости от не нужно беспокоиться о том чтобы захвате ход систему в контейнер можно всё упаковать и там нормально жить очень хорошо и в свете этих событий все стали забывать что контейнеры это не виртуальная машина контейнер - это не виртуальная машина контейнер наследует все проблемы со сна контейнер наследует файловую систему Хоста его ядро и собственно не дает того уровня изоляции который дает виртуальные машины для того чтобы изолировать контейнер среди операционной системы мы используем механизм изоляции операционной системы в отличие от контейнера который имеет свои виртуальные машины которые имеются гипервизор который может изолировать в том числе эмулировать другие ядра другие операционные системы в случае контейнер у нас всегда будет если сюда будет то же самое ядро важно контейнеров Мы только что обсудили Да сейчас нельзя недооценивать губернацию она становится новой операционной системой а контейнер становится пакетом это операционной системе Давайте небольшой экскурс в историю проведем вспомним откуда у нас все дело началось начало были FreeBSD при бсд джейлс были давно еще в конце 90-х они появились не память не изменяется Они были очень похожи на черты собственно Вы тоже делали только Switch в какой-то каталог которым запускался ваш софт они были менее гибкими и имели собственно набор инструментов которые не распространялся Сквозь все BS системы только через ветку Free в отличие от того же потом была солярка у солярки был собственный механизм изоляции они даже поддерживали какие-то к вам лайк что-то на уровне ядра у них был офигенный просто на самом деле механизм инструментов для них Но как Мы все знаем сам благополучно сдохла и утащил за собой все то что она хорошая для нас делала на самом деле печально сам прекраснейший операционная система и в качестве ресерч какого-то исследования Всем рекомендую посмотреть на настоящие красивые и Linux наш любимый Linux начиналось все тоже с черта стандартного обычного черта потом все это выросло появились нас на эмспейсы появились механизмы изоляции ограничения и все это выросло в линз контейнеры которые все знают как LX в то же самое время до сих пор живы до сих пор используются все у них хорошо прекрасный инструмент потом появился докер все помню Да это был кандида начало 2010-х годов и докер принес нам упаковал контейнеры в некий сервис некий продукт Я бы даже сказал и начал движение сейчас мы имеем облака началось когда-то тогда с доктором соответственно крупный вендоры тоже не могли остаться в стране от реализации всей этой истории и команда от coros выпустила свою реализацию контейнеров ркт-контейнер по-моему это расшифровывается сейчас по-моему уже не работает и потом это разработка контракт то же самое фактически удобнее и у него собственно инструменты например не требует сервера наличие то есть инструмент собирает контейнер исключительно клиентским Давайте теперь собственно говоря углубимся и поговорим уже про то зачем мы сегодня здесь все собрались для понимания того как работает контейнер Как можно проводить У него атаку Давайте немножко поговорим как он собственно говоря рождается операционной системе и увидим то что контейнер действительно не является виртуальной машиной изначально У нас есть ход система наш гипервизор условный наш родитель который отпочковывает от себя контейнеры это важно Они отпачкуются от хвостовой системы они не появляются в ней Как какое-то законченный артефакт сначала создаётся на Space а сетевой самые первые сегодня ВПС который прокитывается интерфейсы и собственно говоря начинают подниматься сетевое окружение затем монтируется файлы остается файловая система внутри нашего будущего контейнера его еще нет это только кусочки какие-то ос становится фановая система и в нее монтируется тот самый имидж который мы качаем с докер хаба он там разворачивается и уже представлен в виде файлов но тем не менее это все еще изолированная система чтобы она появилась стала рабочей нам необходима который также подключается к нашей смонтированной внутренней созданный файловой системе и соответственно обеспечивает механизмы монтирования то есть обмена данными через файловую систему с хвостовой системы потом создаем пиды эписи нас это Управление процессами они собственно говоря обеспечивают нам доступ изолированный доступ к очередям сообщений например к семафорам то есть процесс коммуникейшен и соответственно позволяют опять Нам начать отчёт процессов с единицы именно Space позволяют нам например иметь рта в контейнере Несмотря на то что у нас уже есть Root на системе и последний процесс который собственно говоря позволяет взаимодействовать пользователям иметь пользователя отдельных внутри контейнера и затем у нас уже создан контейнер мы уже построили все рамки изоляции самый последний шаг накладываются ограничения Cruze То есть это ограничение которое позволяет управлять ресурсами соответственно некое количество памяти и CPU которое гарантированно получит наш контейнер и за рамки которого он не выйдет то есть при достижении потолка CPU или рамп в контейнере к нам не придет Он Киллер с хвостовой системы придет губернатоса Или же то есть приложение будет ограничено рамками контейнера это полезно Если вы не хотите Ну все знают есть собственно Все После этого запускается инит процесс и наш контейнер создан вот вся вот эта магия проходит в стране и каждый из этих точек это потенциальный Вектор атаки мы об этом с вами поговорим Виктор атаки очень много мы поговорим с вами о тех собственно говоря векторах атаки о тех местах в нашем контейнерной системе которые мы можем управлять как администраторы то есть Мы вряд ли можем управлять уязвимости там в контейнерам-тайм Или уязвимости например мы можем фигурировать наш контейнеры так чтобы они были максимально защищены вот 4 собственно мы вектора атаки рассмотрим их на самом деле гораздо больше но нас интересует надо На данный момент только вот эти давайте начнем самое первая атака это атака нами Space и это всегда ошибки конфигурации изоляции Когда Вы начинаете пересекать контейнеров А еще хуже когда начинаете пересекать контейнера с хвостовым глобальным так называемым спейсом его по факту не существует как Space да Ну вот если мы рассматриваем контейнеры окружения то в нем он уже появляется как на Space в данном примере мы запускаем контейнер с всеми разделяями соответственно если у вас будет труд в этом контейнере он также сможет влиять на процессы которые запущены на Хосте и это антипатр Это плохой пример фактически Это тот же самый Linux который у вас есть Вы дали максимальный привилегии контейнеру и он будет работать далее контейнерами здесь в данном примере мы просто запускаем X а потом запускаем второй контейнер и делим с ним DNS соответственно два контейнера если у вас особенно там запущены какие-то различные процессы позволяют влиять друг на друга пересекая педали соответственно управление друг другом вообще пространство процессов очень интересный кейс это неверно использовали мало нэмспейса В данном случае мы запускаем контейнер который монтируем какую-то хвостовую директорию и запускаем второй контейнер и Обратите внимание она запускается не с общим пространством А маунт с общим пространством Пит история в том что при разделении пространства процессов видос маунта наследуется это не очевидное поведение и на самом деле вы можете словить здесь каких-то ошибок Давайте дальше дальше у нас Атака через недостатки конфигурации соответственно чрезмерные монтирование Вы можете запустить контейнер и ремонтировать например в него систему полностью расскажу историю у нас Я работал в одной компании когда давно и у нас было запрещено судах для всех утилит кроме Докера смогли сделать но не могли больше ничего выполнить оттуда и мы сделали ровно вот так запускали контейнер монтировали его корень вручную редактировали и получали себе 100 соответственно хвостовой системе без каких проблем монтирование корневого каталога в контейнер означает что контейнер получит доступ ко всем файлам лишние привилегии это проблема и беда во-первых докер в привилегированном режиме сам по себе является опасность то есть привилегированный режим означает то что у него гораздо больше ресурсов и ограничение самого Докера которые как сервис как умный сервис сразу накидывает там при своем старте много всего они будут просто не работать то есть это контейнер такая бомба замедленного действия и в данном примере мы еще делаем такую вещь как прокидываем сокет Докера внутрь контейнера на самом деле это очень часто кейс на данный момент в облачных окружениях зачастую у нас нет возможности получить к сервису выполнить сборку и мы вынуждены контейнер Билд по планы запускать именно виртуальных машинах каких-то контейнерах тоже в облачном окружении и например есть такой проект докер который собирает Как разблокировать и он пользуется как раз соком имеет доступ к стоке внутри контейнер Вы можете управлять всеми контейнерами на Хосте вообще всеми Любой любой с любым уровнем собственно говоря управление все команды сервисы сервера включает через дальше Давайте поговорим про неверные тернелко побилитис Кирилл кабабилитис это механизм ядра для управления привилегиями он делает на самом деле довольно простую вещь он ограничивает пространство использующий сколов то есть мы можем некому процессу сказать что вот эти все сколы использовать нельзя вот этим можно их очень много на самом деле этих кабельтесь к 50 штук мы я вот выписал тот самый собственно говоря опасные с точки зрения администратора с точки зрения хакеров которые могут достигнуть на ваше окружение Есть еще одна побилитис так называемая пишется как All и даёт все абсолютно привилегии сразу и всегда тут надо понимать что мы хотя управляем конфигурациями управляем керринг побилитис мы можем там довольно сильно довольно глубоко разгребать всю эту историю надо понимать что если в самом ядре есть бак в самом везде есть какая-то уязвимость то ничто из этого вас не спасёт пронизывает ваши контейнеры от начала и до конца и собственно вы не сможете ничего сделать поэтому особенно важно из-за безопасности не только ваших приложений но и вашего окружения в котором все это запускается вплоть до линукса Можно даже углубиться еще больше Спектра которые были вызваны проблемы процессоров об этом на самом деле тоже Давайте посмотрим что у нас тут получается в первом примере мы просто запускаем контейнер Да с полным привилегием вот так вот есть флаг Эд он как раз добавляет привилегии контейнеру по умолчанию они там достаточно сильно порезаны как правило рекомендуют есть флаг Cup Drop Докера который обрубают все побеги и потом вы довешиваете ровно те которые нужны это хорошая практика запусков делать не рекомендуется на самом деле если такой очень хорошо знаете что вы делаете второй контейнер Да он запущен доступ к сетевой системе поста не в том плане что контейнер может интерактивность не взаимодействовать а в том плане что он не может управлять это очень-очень опасные вещи очень мощный инструмент и его нужно использовать с умом поэтому рекомендую выбрать которые нужны действительно вашим контейнерам и контейнеры запускать флагом как дроп и с перечнем последний наш самый атака Она довольно простая Здесь через механизмы ограничения ресурсов вот если у вас ваш контейнер имеет привилегию соответственно вы можете создать контейнере новую игру и активировать ее соответственно ваш контейнер получит максимальное количество ресурсов но то количество которое вы ему выставили и может вызвать обслуживании на одной конкретной нозе То есть все остальные контейнеры ситом либо CPU троттлинг была даже на самом деле уязвимость отдельная которая позволяла все это делать даже не имея привилегий сисадмин но Я уже давно починили Давайте поговорим про самое интересное я вам покажу в действии как в реальном времени Как выполняется Побег из контейнера и мы поговорим с вами проявимость семьи 2019 57 36 она была одной из самых громких уязвимостей в 2019 году это было настолько большой факап что крупные игроки рынка попросили не публиковать потому что поражены были все АВС Google все собственно говоря страдали от этой баги их опубликовано только через 8 дней это была уязвимость Франции которая позволяла путем манипуляции ссылкой внутри process ссылка на исполняемый процесс заставить ранцы выполнить код на целевой системе версии docker 181 Я надеюсь что у вас уже никого и давно нет продакшне с этим никогда не столкнетесь понятно политическим причинам и по ограничением наши Уголовного кодекса не могу вам показать но поверьте они есть всегда и они всегда эксплуатируются кому нужен qr-код это собственно описание этой уязвимости в базе международной базе видимости Давайте посмотрим в реальном времени как все это дело выполняется собственно вы компилируем наших ссылка будет дальше презентации это виртуальная машина запускаем контейнер просто активном режиме и монтируем туда нашу директорию чтобы получить контейнер предполагаем что нет этих биржу инструментов и все такого мы внутри контейнера вот наш эксплойт спускаем его и в качестве параметра Shell Передаем ему код который будет выполнен на целевой машине на костовой машине в данном случае для примера я просто беру файл который доступен на хостовой машине для чтения только Руту это файл с паролями я скопирую его в общую директорию темпа и соответственно данному права 077 чтобы каждый мог его прочитать пускаем эксплойт он ждет процесс я объясню Дальше он работает выполняем атаку переходим наш уязвимое окружение берем рута смотрим в ТМП у нас лежат только стандартные наши папочки от процессов вот наш запущенный уязвимый контейнер мы делаем exec его и выполняем уязвимый код который мы переписали все система атакована используешь работу и вот верхней панельки Вы можете видеть что файл был скопирован входим из рта для чистоты эксперимента переходим в cmp вот наш Файлик мы его поймали Давайте посмотрим тема атакована тема взломанного реального времени фактически сейчас и это проблема которая который может столкнуться каждый из вас каждый из вас все это дело записывал на своем ноутбуке То есть это не какое-то повторил сам как все это дело работает внутри контейнера Мы берем бизнес там нет не важно мы просто создаем новый переписываем там несколько байт в собственно в эксплусе они есть и запускаем внутри контейнер цикл который ожидает что ожидает строку ран си какую-нибудь в канделайн одного из запущенных процессов если он найдет Это означает что эта команда была вызвана через контейнером Time и соответственно этот процесс был запущен через контейнер runtime как только мы нашли этот процесс мы сразу получаем файло дискриптор этого процесса и отсылаем в него нашу команду она выполнена на Косте с правами пользователя контейнеры контейнеры мы были ртом мы получили рута на Хосте довольно-таки просто сказать ссылка на эксплоид Вы можете посмотреть по qr-коду перейти Давайте по шагам расскажу немножечко на этом скриншоте как всё это дело собственно говоря и проходило в первую очередь Да мы придем команду которую мы выполним на Хосте тут может быть любой скрипции достаточно простой его можно написать Что можно передавать что угодно В данном случае мне достаточно было показать вам просто что вот мы можем получить доступ к тому чему доступ к нормальном режиме мы не имеем переписываем бинарник и повисаем на цикле который крутит смотрит наши процессы как только мы находим получать бисквиттер в следующем моменте всё система взломана и мы уже имеем канал хвостовой системе на которой мы можем выполнить любые команды соответственно любые команды Я хочу заметить то есть вот этот пример Довольно простой он показывает что вы можете получить доступ супер привилегиями к любому сущности системы имея уязвимый контейнер в целом наверное все давайте немножечко подведем итоги надо сказать конечно что можно было бы сделать для того чтобы избежать в данном случае нашего взлома можно во-первых не давать рта контейнеру можно было заниматься например в таком случае атакующий не получил бы доступ по крайней мере доступ к системе совпадали бы вообще никакого доступа не получил система которого нет вообще никаких Давайте немножко резюмируем и поговорим о том что нужно делать чтобы всего этого не происходило Используйте принцип не меньше привилегии всегда всегда Думайте о том что Вашему софту не нужно ничего и вы даете ему только то что ему действительно нужно то есть вы идете по списку ошибок которые он получает не знаю недостатки какого доступа и строго эти привилеги то есть бахнуть 077 плохая идея дать рута в контейнере плохая идея дать пол плохая идея всегда используется наименьший привилегии тщательно настраивайтесь и группцы проверяйте актуальность утилит которые ими управляются соответственно с одной стороны это Лиговский с другой стороны это весь этот Кит который управляет группами настраивайте все группы правильно и так чтобы они с одной стороны не мешали друг другу да с другой стороны Они пытались сожрать все ресурсы а вашей машине Да держите актуальную версию контейнерам-тайм Я хочу заметить что актуальная версия не значит последняя версия актуальная версия Это та которая прошла там бактраки которая рекомендуется вендрами которые хороша для использования скажем так да которое уже закрыты все уязвимости они старые Но не супер новые в которой ещё там возможно лежит куча всяческих ну и соответственно правильно использовать основной механизм изоляции на уровне операционной системы и и соответственно не надо их шарить они не нужны для того чтобы разделять они объединять если вашему софту нужно какое-то взаимодействие что вам приходит в голову идея А давайте-ка я пошаренным Space то возможно вам лучше переписать софт Я понимаю что не все проблемы решаются на уровне разработчиков также не все проблемы решаются на уровне администраторов Ну и конечно же не надо запускать докер привлеклованном режиме Используйте вместо докрин докер один инструмент краника если вам нужно собирать канику это полностью User Space утилита она просто собирает образы накладывая слои действительно файлы друг на друга а не используют там докер сервер Как это сделано именно в доке ну и соответственно Используйте профиль безопасности Я знаю что очень многие администраторы свежий центов первым делом делают так делать не надо лучше разберитесь потратьте это сложная история на самом деле я понимаю что часто это мешает работать мешает работать да но тем не менее так все действительно обезопасите и насколько я знаю докер сам делает какую-то магию с профилем безопасности потому что администратор этого не делают я вам рекомендую все-таки один раз грузиться в эту историю Ну и мой доклад на самом деле он не для тех ребят у которых большие продакшены у которых есть свои собственные эти службы it-сек службы которые следят за всем этим я скорее говорю о тех людях которые отменит небольшие какие-то установки и где админ такой на дороге шивы который делает всё так вот Безопасность это та вещь на которую вам надо обратить внимание и сейчас вот несколько советов Именно таких админов обязательно выделяйтесь Security и Patch менеджмент в отдельные процессы нельзя делать От случая какие-то внутренние пентесты свои какие-то не знаю там анализаторы статика анализаторы прогоняйте это в процессах и почему менеджмент то есть обновление операционных систем обновление найденных уязвимостей тоже должен быть обязательно именно процессным регулярным ручным у него должно быть выделено время мы должны быть фиксированные результаты и всё такое как менеджер рассказываю второй момент пишите свои ландшафт и следите за проблемами в нем которые публикуются То есть все утилиты все весов которые воспользуются Нарисуйте его на картинке как-то технологический радар это называется еще там много названий данных о том что у вас должен быть актуальный список софта который вы используете желательно с версиями и вы получаете по ним какие-то автоматические апдейты вот если вы используете не знаю там докер ubunt вам нафиг не нужны а рассылки по РЕТ хату и подмену Ну вот потому что эксплуатируется у вас в ландшафте Вы должны следить за актуальными обновлениями безопасности Ну и конечно же ломают всех друзья ломают всех идеальная защита не существует так же как не существует идеальная атаки и поэтому задача каждого хакера - это соответственно пробиться вашу систему А задача каждого администратора максимально усложнить этот процесс если вас захотят сломать вас сломает От этого нельзя защититься масса взломов изнутри масса взломов совсем через компьютеры но ваша задача максимально усложнить этот процесс и я надеюсь что то что я вам рассказал поможет вам все это делать систематизировать и организовать Давайте небольшое я подведу итог всего этого во-первых курятник для разрушения то что демонстрировано при помощи утилитами позволяет создавать уязвимое окружение полностью То есть она сама выкачивает все уязвимые версии софта докер и кубернетоса тому подобных вещей и плюс содержит ссылки на уязвимости в базе был на Rainbow и ссылку на эксплойт который позволяет эксплуатировать эту систему друзья мои Спасибо вам большое за внимание Я готов ответить на ваш вопрос Спасибо Андрей классный доклад был помимо того что можно ответить можно еще выиграть ответ вот мы дадим за самый классный Андрей выберет Вопрос самый классный Я Напоминаю что для тех кто или стесняется или онлайн есть еще вопросики в чатике в чатиках тоже можно задать Итак давайте лес рук вот как видишь Сказал рассказал и все Сейчас есть вопрос сейчас Да вот туда микро понятно что никому ничего не интересно на самом деле Можно даже хорошо привет привет Спасибо я правда не вижу Да Сергей не буду говорить компанию вопрос достаточно может быть холиварный нет В итоге докер Или подмен что Что безопаснее Что лучше что красивее что ближе к радхату В общем целом Да вот вопрос Если есть такие уязвимости которые критично важны для инфраструктуры в целом влияет на все это дело в итоге на чем строится я все-таки делаю доставку на докер потому что он более широкий продукт все-таки он такой прям структуры у них все свое они просто делают на этом деньги Поэтому с точки зрения безопасности был бы лучше подман просто потому что с точки зрения лучше докер потому что субъективно мне кажется поинтереснее людей которые там прям поели нормально стандартизированы и докер более более паблик в своих целях может что-то скрывать что-то не делать поэтому я больше публичная история Давайте еще вопросики если стесняйтесь можете в чате писать любые можно любое спросить там вот рука вот просто Давайте можно не по теме микрофончик вот туда а мне тоже вопрос есть Андрей привет Меня зовут Геннадий Благодарю за доклад очень интересно и познавательно Скажите актуальная угрозы которые нынче существуют окружают нас как вы их отслеживаете какие у вас есть превентивные может быть другие инструменты инструменты для чего просить не слышал мы увидели продемонстрированную атаку побега из контейнера такие же вещи вскрываются каждый день это не новость чем вы препятствуете в актуальным времени Наверняка есть контейнеры это все здесь и сейчас немножко поближе потому что вообще не стесняйтесь подсаживаться без полно Все очень просто мы увидели одну из Атак Как препятствование происходит в реальном времени то есть мы увидели открытую уязвимость ее по эксплуатировали все хорошо но у нас есть сейчас Бегущий runtime в которых мы хотим защищаться как есть масса инструментов на самом деле для этого есть всяческие системы обнаружения подозрительной активности которые используют для этого я даже не скажу название есть ряд продуктов например не знаю там для обнаружения вторжения есть инструмент для мониторинга прямо в реальном времени то что у вас происходит на хостах как правило такие инструменты затаскивают уже большие продакшены у которых нужно всё это дело чтобы было актуально активно постоянно работала очень много ограничений разработчиков на самом деле поэтому этот вечный конфликт будет команда разработки и Б В данном контексте вот на самом деле это как бы как я уже упоминал если у вас маленький продакшн Если вы не настолько большие за что там позволить отдельную службу то это постоянно сканирование своей системы то есть масса автоматически сканеров которые позволят актуальные списки то есть должны точно знать что ваша версия запущена всё хорошо в реальном времени это поймать довольно сложно Если вы не обеспечили заранее какое-то механизм индикации присутствия чужих если хакер уже попал в данном случае вы его уже не достанете уже сломается хотелось услышать как раз инструменты СИП может быть которые вертят сок еще что-то я могу накинуть Давай есть например инструмент фалька Вот как раз для обнаружения в runtime если они даже книжечку написали которую никак не прочитаю Вот но такие инструменты есть Окей спасибо спасибо вот там вот рука парень с прической как у меня вот сидит прическа дивов с инженеры да Это все от нервов Спасибо большое за доклад у меня наверное будет не столько Вопрос сколько комментарий некоторые Вот вы рассказали о тех уязвимостях на на уровне sigroops до на уровне разрешений свистколов но в большинстве случаев эти дырки создаются самими админами до просто для того чтобы себе облегчить жизнь И если мы говорим о том как себя обезопасить от каких-то еще не публичных уязвимости Да полностью как вы сказали нельзя защититься но просто не запускайте докер под рутом и не запускаете контейнер внутри контейнера как круто вот 90 процентов всех проблем вы будете избегать только этой мерой вот еще у нас потом после всего будет еще дискуссия Я предлагаю там еще это оставить на дискуссию на попозже Давайте еще вопросики Тогда спасибо Вот во-первых вот ещё вопрос есть как ты Нос еще да здравствуйте Меня зовут Николай Спасибо за доклад было очень интересно Вы сказали об эсхи Linux тут наверное я скажу наверное за нас всех а вы правда не ленитесь и настраиваете прям Правда правда прошел курс честно скажу О это прям Отлично тогда такой вопрос а если у вас слы внутри вашей организации ВК реакции на такие события они есть да но у нас событие B все обеспечивают службы То есть у нас все продакшн окружения бешенных инструментами и реагирования им даже интересно возникает красная лампочка на мониторе бежит охрана Да примерно так происходит были случаи я не хотел не хотел об этом рассказывать Да все отлично Спасибо большое Так у нас вот еще вопросов в зале но у нас ещё есть вопросы в онлайне сейчас мы разбавим немножечко онлайн вот Денис Мамаев спрашивает говорит что вот при проверке образов Да которые надо кирха Бережет так бывает что вот есть Ну типа много уязвимости именно в базовом образе на котором на основе которого контейнер создан вот что с этим делать пересобирать полностью образ что вот да они используют во-первых образы хабаба это вообще ну то есть как бы я не знаю что это вы дошли что-то на улице о прикольные отнесли домой эти официальные какие-то Разница какая разница Я рекомендую иметь свои реджистрее и перебирать все образы самостоятельно и держать их готовыми бросками и только для вашего использования тяжело полностью поддерживать тяжело тяжелой практика Ну а так если базовый образ Ну конечно теперь собирать Вы действительно потащите Ну ладно там уязвимость Ну ладно найдет вот это не может быть не может быть вот этого контекста что я по надеюсь на авось вы найдете на ось а хакер ждет что вы на него понадеетесь и соответственно первым делом пойдет искать вот эти Авось хакеры в первую очередь это хороший социальный инженер Я не понимаю как думают люди как думают админы вот в этом воин здесь мне кажется Спасибо так вот где-то здесь Да вот здесь вопрос Если выбираться из контейнера Тяжело да и нецелесообразно может быть иногда хакеры скорее всего будут проводить атаку внутри контейнера они имеют Root Внутри будут там что-то делать данные отремонтированы внутри как вот это отслеживать на хостел у нас стоит там например какой-нибудь Агент ухо или еще что-нибудь отслеживает атаки подозрительные действия а если внутри контейнера контейнеров может быть тысячи как вот это все собирать Как сами контейнеры мониторить лишь фактически завтра который собственно говоря проверки перед сборкой контейнеров только так а именно такая же операционная система проскочила самый простой способ Если вы например сделали грунтом не получат рут на хости просто даже если рут в контейнере будет ну то есть это да использование как правило всяких как мы как админы можем использовать только вот эту кучу кстати конфигурации которые нам доступна поэтому можно предположить что вот у меня хакер в системе но я сделаю так чтобы он там ничего не смог сделать Пусть он там будет но не будет никакого доступа А как мы узнаем что он там вот предыдущий вопрос собственно был на это есть система активный мониторинга система обнаружения вторжений его ставить на каждый контейнер если какие-нибудь стандарты Где можно посмотреть эти Best Pro они есть конечно поэтому я наверное не расскажу про них сейчас я хочу сказать что эта тема для мы говорим про администратор если Сергей разговаривали Андрей что там чешешь Господи рассказать что было понимание Есть еще вопросы уязвимость базового образа Понятно насколько обосновано использование distra с базовых дистрос образов и дистролес конечно то есть чем меньше это тоже принцип не меньше привилегии тем меньше тем лучше я поэтому люблю нежного например да Что можно собрать эти бинарные положить контейнер ты его отправил И он все у хакера не будет вообще не будет ландшафта атаки никакого за исключением уязвимости уровня системы Так что да чем меньше вас в контейнере всего тем лучше если вы собираетесь Света я не вижу там сзади человек Да привет Андрей Привет Мой коллега есть Я правильно понял о том что из контейнера можно попасть на хостовую машину А вот если проговорить о том что можно безопасность обеспечить на уровне контуров там фронтенд одни контуры бэкен другие там база данных особенно базы данных например другие другое и у них между собой тоже какая-то разграничение есть на этот счет какие-то практики рекомендации те кто на галерке слышно крайне плохо У нас есть какие-то контуры фронтен база данных есть практики про разграничение организации правильной безопасности между центрами А он дальше не попал это архитектурный вопрос Наверное уже больше конечно это короче здравый смысл принимать что не знаю по ресурсам надо как-то разделить с точки зрения б я бы конечно все вообще растаскивал там максимальный задержанным окружением и там чтобы в интернет не ходила было бы идеально конечно странно понимать что любой продакшн это некий трейдов Да между потребностями разработчиков потребности безопасников потребности админов Каждый хочет чтобы у него был идеальный ландшафт который он будет жить Поэтому вот для каждого продакшена Наверное это будет какой-то свой своя какая-то история но тут конечно Не крутите базу поверните носить их там в сторону куда-нибудь всё всё вот это всё всё стандартно не Наверное я прямо каких-то чётких рекомендаций не скажу спасибо спасибо ты считаешь из методов обнаружения самый эффективный потому что вот эти вот сканеры Какой тебе больше нравится я не могу назвать прям какой-то конкретной утилитой Я бы за процессы То есть как бы инструмент вторичный если у вас нормальный процесс Секьюрити в нём будут утилита инструменты будут работать то есть процесс первичен в данном случае потом обсудить тоже так я например три но это не реклама три весит так есть там руки нету рука больше нет тогда наверное это все и мы потому что на самом деле вопрос Давайте похлопаем Спасибо большое Спасибо друзья Спасибо большое что пришли очень был рад"
}