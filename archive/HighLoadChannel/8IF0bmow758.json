{
  "video_id": "8IF0bmow758",
  "channel": "HighLoadChannel",
  "title": "",
  "views": 0,
  "duration": 0,
  "published": "",
  "text": "друзья Всем привет Окей у нас 30 минут на прого было 45 я обещал програмному комитету что я ложусь Поэтому попробуем а кто я такой для начала и почему меня стоит послушать я долгое время работал в сетевым инженером в провайдерах в энтерпрайза в дата центрах и в принципе сейчас продолжаю работать с сетями в настоящее время я отвечаю за инфраструктуру физическую в компании и иногда беседую с умными людьми в подкасте L Кто мы такие кто кто такая компания Cent что здесь Наверное важно что у нас порядка 3.000 серверов по всему миру примерно в 40 локациях и каждый день через нашу сеть проходит порядка 10 терабит в секунду трафика У нас есть свой большой cdn один из крупнейших в России есть свой ДНС провайдер облако стриминг и так далее поэтому задержка Для нас это один из из моментов с которыми мы постоянно работаем постоянно сталкиваемся а про задержку мы будем говорить на примере приложени современное приложение сейчас это какие-то картинки видео стримы Ну например katag да вот представим что это так А у нас мобильное приложение или сайт нас не очень интересует потому что в любом случае это какая-то а какая есть какой-то фронтенд который показывается пользователю и есть БК с которым соответственно Он общается по опиш и наши пользователи могут вять по проводу по публичному вай-фаю с кафе 3G 4G там что-нибудь ещё если решать э задачу влог то она наверное выглядит примерно так давайте поставим много-много серверов везде можно но это дорого и к сожалению дата-центр есть не везде и хороших ещё меньше Давайте возьмём много-много широких каналов опять же к сожалению ширина канала не компенсирует задержку и хороших тоже не так много и в некоторых местах добраться до пользователя будет крайне сложно В целом эти два пункта нивелируются использованием cdn про это я рассказывал на этой сцене в прошлом году если интересно потом Найдите доклад пересмотрите А сегодня мы поговорим про собственно задержку Для чего нам нужно работать задержкой Для чего нам нужно её уменьшать во-первых это пользовательский опыт мы все любим чтобы приложение работало быстро картинки грузились быстро там не было вот этого вот кружочка догруз постоянно когда мы смотрим видео а в случае стриминга особенно ритам стриминга Да у нас коче автоматически качество видео поправляет в зависимости от задержки Чем выше задержка тем ниже качество соответственно эффект будет примерно как на картинке Да если у вас высокая задержка то у вас сразу падает качество и становится как-то не очень и второй момент - это конкурентное преимущество нам нужно сделать Не только быстрое приложение нам нужно ещё чтобы оно было быстрее и лучше чем у нашего конкурента здесь мой любимый пример это допустим Когда у вас есть какой-нибудь например Банк где-нибудь в Екатеринбурге местный банк для местных клиентов да то он прям такой домашний и один из этих банков у Вас например подключает модную дедос защиту но с дата центрами в Москве и клиент из Екатеринбурга сначала должен сходить в Москву там он должен провериться что это Клиент не бот и вернуться назад соответственно уже на Origin это вызывает фрустрацию у клиентов и у бизнеса тоже потому что типа вот сайт раньше работал быстро сейчас работает медленно случилось с чего задержка складывается во-первых Это последняя миля то есть то как мы подключаемся к интернет-провайдеру это опять же там wi-fi какой-нибудь LTE и что-нибудь такое собственно сама сеть провайдера дикий интернет и наконец наша внутренняя инфраструктура По последней Миле что мы ожидаем что У пользователя есть какой-нибудь супербыстрый wi-fi проводное подключение к провайдеру сам провайдер тоже оче быстрый потом это идёт в интернет потом доходит до нашего приложения и всё вроде бы хорошо в реальности получается не очень хорошо потому что wi-fi у пользователя может быть фиговый сам wi-fi роутер вообще может быть подключён через куда-то там к вышке оператора за несколько километров сама сотовая Вышка подключена радиоканалом потому что как бы там какая-нибудь деревне и оптики туда ещё не приложили дальше есть провайдер с каким-то своим набором и дальше уже наше приложение заж на уровне физики К сожалению физика спорить сложно поэтому мы имеем скорость распространения света в оптоволокне порядка 200000 км в секунду плюс задержки на оборудовани это означает то что у нас есть некие минимальные задержки ниже которых мы не сможем сделать например вот средняя задержка Москва санкт-петербург то есть не между двумя портами там транзитного оператора А вот от дата-центра до дата-центра и до Клин порядка 9 миску Москва Новосибирск уже порядка 45 ик уже порядка 100 миллисекунд будет задержка то есть соответственно если у вас дата-центр располагается в Москве А ваши клиенты где-нибудь в Хабаровске то хорошая задержки там не получится просто физически нужно будет что-то с этим сделать а вторая следующий компонент который вносит задержки это собственно интернет и протокол bgp на котором этот Интернет работает протокол bgp вообще ничего не знает про физику он оперирует автономными системами автономная система - это совокупность сетей это может быть провайдер это может быть компания конн генератор неважно любого объёма поэтому одна автономная система транзитного оператора может быть глобальной на весь мир и неважно какое расстояние там между роутерами это автономной системы маршрут где их меньше будет считаться лучшим Даже если он географически длиннее поэтому и говорят что в интернете нет географии там есть топология внутри провайдера тоже есть собственный BP и он тоже роут так как выгодно провайдеру взаимодействие между операторами в России называется термином и в принципе он очень хорошо характеризует это самое взаимодействие у провайдера есть несколько типов линков у каждого провайдера есть пилинги они бесплатны Но это точечная история то есть каким-то конкретным контент провайдером либо дружественным оператором есть подключение к точкам обмена трафиком где сидят тоже контент генераторы и тоже какие-то провайдеры это уже слегка за деньги и есть Алинки это транзитный Интернет то что провайдер соответственно берёт полную связанность у какого-то вышестоящего провайдера как правило это уже ещё более дороже При этом если у провайдера уже построена своя какая-то магистраль она уже построена там уже закуплено оборудование проложена оптика всё подключено поэтому трафик по ней мы считаем что он проходит бесплатно даже если о 5000 киме и нам выгоднее трафик выкинуть в другом городе в более дешёвый аплин чем допустим выкидывать этот трафик локально в более дорогие анки и соответственно пользователь из этого тоже может получить задержку на ровном месте Кроме этого у провайдеров случаются так называемые пиринговые войны Возможно вы слышали недавно про конфликт кожен та И Тата Ну вот более приземлённый допустим в наших реалиях тоже мой любимый пример это не так давно компании Транстелеком и Ростелеком в России не очень дружили между собой Поэтому если у вас есть сервер подключённый к одному провайдеру допустим к ростелекому и клиент к тран телекому то путь между ними пойдёт в лучшем случае через Москву а это самое в более лучшие года через Франкфурт поэтому там внутри одного города Хабаровска 150 там 200 миллисекунд задержки было как зре самый популярный способ балансировки трафика между Да центрами - это да То есть вы анализирует АШК пользователя и на этом основании отправляете его в тот или другой К сожалению с этим тоже есть проб потому что вопервых атрибут edns0 А в который собственно и зашивается Source IP или Source сеть пользователя его не все шлют а особенно его любят отрезать всякие публичные резол Веры типа Google и Cloud фра А поэтому DNS провайдеру нужен очень хороший incast Чтобы соответственно локализовать откуда к нему пришёл запрос и топологические какая это может быть страна а при этом в коммерческих базах тоже есть ошибки иногда они связаны с недостаточным обновлением информации не очень оперативным а либо с тем что по политическим причинам разные провайдеры немножко по-разному смотрят на страною принадлежность тех или иных сетей или территорий а источники гео самые популярные - это maxmind ipinfo база данных региональных интернет регистратур в целом тут всё тривиально А на VPN - это такие замечательные технологии которые с с одной стороны сталями поддерживают работу этого нашего с вами интернета а с другой тоже очень много всего ломают например на особенно это у мобильных операторов развито и очень и очень больших транзитов он может быть одним на несколько регионов в стране Что означает личной задержки То есть Вам допустим пользовательский трафик из условного того же Хабаровска Да нужно пригнать где-нибудь на над ферму например в Новосибирске и только там выкинуть соответственно вы получаете проблемы и с гео и собственно с лишней задержкой вот ну VPN Я думаю вы сами там прекрасно знаете как как как он работает вы там пользовались пином для того чтобы попасть на какой-то там зарубежный ресурс забыли его выключить и соответственно трафик к российским ресурсам У вас теперь идёт через через агор Я недавно смотрел что трафик по оценкам там некоторых изданий трафик с двадцать второго года вырос зарубежный в России на 30% и часть это как раз таки Там постоянно включенные либо там не выключенные ны и трафик в итоге ходит петлёй сначала из России рубеж потом из рубежа обратно в Россию для того чтобы попасть на российские ресурсы Ну и Казалось бы наша инфра да то есть там какие там задержки там же всё вот всё рядом но у нас есть там эн У нас есть какие-то балансировщик у нас есть какой-то wav S3 cdn и всё это от разных провайдеров может быть располагается в разных дата-центра у каждого своя связанность м О'кей проблему обозначили теперь как считать а самый простой способ - это Ping А мы вот Ping там Яру что-нибудь ещё rm.ru и Вроде бы да вроде бы хорошо и просто но есть так называемый CL то есть на вам отвечает может отвечать не сам сайт А может отвечать какой-то Проси особенно этим балуется CL у него есть много-много Проси которые принимает на себя часть соединений А дальше уже отправляет это на orig Где бы он не располагался и есть определённое влияние провайдеров они могут быть как приоритизировать так и де приоритизировать соответственно задержку Вы конечно можете померить но она не всегда будет корова пин С одного компа Наверное вам не интересен вам хочется посмотреть это там либо с нашей стороны либо с разных регионов там мира да И для этого есть программа R ATL которую я очень люблю и пиарю кажется на каждом своём докладе она умеет нру и проверку сертификатов На сегодняшний момент по-моему всё он условно бесплатный то есть для того чтобы проводить свои исследования вам нужны кредиты для этого нужно либо поставить свою пробу и давать доступ к ней соответственно другим участникам либо если вы лир то там тоже есть свои способы добывания Тех самых кредитов а пробы располагаются по всему миру их там уже несколько десятков тысяч там если вам интересно потом по ссылочки пройдёте Посмотрите а МТ тоже штука известная Я надеюсь А и ей тоже можно пользоваться такая смесь хорошая пинга и трес Рута а умеет tcp acmp udp выбор порта чего-нибудь такого вывод может делать хоть в J хоть в CSV хоть там ещё как угодно В общем вот небольшой Help тоже можете потом посмотреть презентация будет доступна А если Вам мало традиционного пинга мтра есть ещё вот такие вот хорошие проекти которые нацелены во-первых на то чтобы отлавливать всякие CP над истории и правильно их интерпретировать что у классического мтра допустим с этим не очень либо допустим вот последний последняя проект он умеет в том числе анализировать данные с рай атласа но там в общем Инструмент там развесистый тоже зайдёте Посмотрите de Tools Она же консоль браузера Я думаю вы её прекрасно знаете можно смотреть что и откуда грузится За сколько скачалось можно делать искусственный тролинг изображать соответственно там 4G 3G подключение и что ещё ценно с помощью дополнительных инструментов можно снимать логи через браузер Да вы ставите какой-нибудь Head chome на виртуале уже можно там с с них удалённо снимать логи л надеюсь тоже Вы его знаете он консольный лёгкий у него Ман размером свой Ну и мир Но для нас ценно то что он можно через него можно оценивать время ответов например набрасывается вот такой вот простейший Баш скрипк и смотрите таймстамп который он выдаёт да то есть у нас есть та на lookup на tcp handshake ssl handshake и собственно на получение данных Кроме этого есть инструменты специализированные по анализу задержки анализу различных сайтов самые мощ наверное cit cchp стоит как самолёт умеет прямо много-много Всего в России естественно не продаётся Вот но прям диагностику может вести максимально глубокую без всяких там установленных агентов чисто вот из разных регионов проверять что и как у вас грузится на сайте есть в том числе P и другие мониторинги которые в целом в первую очередь мониторинги дано тоже могут всякие метрики по Тен снимать Ну и конечно же можно взять и написать свой велосипед взять много-много виртуалок там по всему миру и соответственно с этим тоже работать там опять же н Кул там ру там т и так далее Всё что вашей душе угодно Окей поняли посчитали Давайте теперь подумаем что с этим делать на последней Миле можно сделать примерно ничего к сожалению потому что ну максимум порекомендовать пользователю сменить прова или там роутер поменять Может быть но как правило здесь только смириться либо Можно попробовать нивелировать задержки последней мире через cdn но тут нужно опять же проверять есть ли у cdn провайдера нода там у конкретного оператора либо в конкретном регионе это нужно тестировать тестировать ещё раз тестировать что касается GE балансировки во-первых выбрать провайдера с наиболее гибкими настройками Например у нас есть опция что мы можем указывать навешивать правила на конкретные айпишник которые мы получили по edns0 А и переписывать там либо страною принадлежность либо ещё какие-то дополнительные метки А навешивать и по этим меткам соответственно делать свой свой роутинг запросов А ну и накапливать свою гео базу в связке либо с ДНС провайдером либо с Все балансировкой я о ней чуть позже скажу это удел больших и сильных А bgp всё как всегда с одной стороны просто с другой нет У нас есть Много ручек но ни одна из них на 100% не помогает Вы должны быть достаточно большим чтобы иметь свою автономную систему И хотя бы две своих сетки с24 и штат сетевиков которые могут с этим работать Что можно сделать через сервер посмотреть как вашу сеть видно из разных провайдеров Просто вбивайте в Гугле там название провайдера попадаете на страничку Там вбива айпишник там с сайта который Вы хотите проверить регион проверяете и соответственно получаете там bgp маршруты и так далее То есть здесь можно посмотреть что через каких провайдеров к вам ходит а можно воспользоваться комьюнити это специальные атрибуты bgp которые вы можете отправить своему аплин чтобы он что-то сделал с вашим трафиком например отправил его в определённый свой Алин или только своим клиентам или только своим рингом и так далее на сайте опять же RB либо на сайте провайдера есть специальный раздел там вы можете посмотреть эти атрибуты и что кони не нзив соответственно они работают только на ше только у вашего дальше при выходе изн все комьюнити будут срезаны и вышестоящие операторы о них уже как правило ничего знать не будут штука популярная но есть проблема частности С трафиком что при перестроении Если вы не синка сессии то сессия будет сброшена сделать но вот в чистом виде обычно работает не совсем корректно потому что опять же топология а не география но жизнь облегчает Ну и помните что ipv4 iv6 связанность она разная То есть это отдельные bgp сессии отдельные пути для каждого трафика и если вы используете ipv6 то его нужно соответственно тюнить отдельно а что касается L7 то прям выглядит как пушка бомба Да что можно по любым условиям там sce гент что угодно делать свою балансировку делать чеки об стримов дрейнить дата-центры балансировать нагрузку и далее Далее и далее но это всё ещё единая точка отказа если у ваш есть какой-то глобальный балансировщик он вяжет то соответственно вы потеряете доступ ко всем вашим дата центрам до slb ещё нужно добраться используя опять же там либо гео балансировку либо ещё как-то вряд ли у вас slb будет один на на весь мир Ну и блин это сложно качественный балансировщик могут сделать далеко не все обычно тоже это большие умные ребята поэтому тут нужно грамотно измерять свои свои силы Вы можете кто-то из вас может возразить но у меня же облако и облако за меня обо всём подумала но к сожалению нет потому что облако - это всё ещё просто чье-то серверы которые стоят во вполне конкретных дата-центра с вполне конкретной связанность и сюрприз сетевая связанность не является главной фий облако как правило облако некий компьют а сетевую связанность уже каждый Облачный провайдер делает сам как ему нужно выгодно и так далее поэтому здесь Единственный мой совет да изучаем Алинки вашего облака с помощью там того же допустим рай атласа если вам там у вас есть какие-то проблемы с доступность в конкретных регионах то нужно уже общаться с техподдержкой облака возможно вам вас попросят там задеплоить да В каком-то конкретном регионе либо что-то ещ предложит Надеюсь что касается собственной инфраструктуры да то что о ЧМ я говорил что у нас есть ваф ДНС CD и так далее нужно знать во-первых где они находятся и как между ними течёт трафик задержки внутри облака для западных облаков есть инструмент называется конкурентов всех циска когда этот продукт купил они их по-моему попереду для российских облаков они ещё достаточно маленькие и тут Пока таких инструментов Я не видел Если знаете то потом в курах Расскажите Если у вас есть Ну развесистая инфраструктура то есть анализаторы трафика типа кенка рада No NF и так далее они смотрят собирают netf с сетевых устройств и смотрят там в какие автономные системы в какие сетки из каких сетей к Вам пришёл трафик загружаются всё в кха соответственно Дальше можно проводить разного рода аналитику Ну и что касается DC тут варианты простые можно сделать так называемый вынос это минимальны какой-то presence который принимает на себя трафик пользовательский да то есть там просто Fe плюс минимальная какая-то логика и дальше его отправляет либо через быстрый отправляет его через быстрый операторский VPN либо можно воспользоваться так называемым L7 акселератором типа Диона или rout отма когда у вас есть просто hps на entry Point и он вам выкидывает на ваш Origin пользовательский пакет с навешанных То есть он Каким образом не залезает в tls он просто берёт пакет S и его вам отдаёт э это удобно потому что не нужно там раскрывать свои сертификаты при этом оно работает быстрее чем традиционный bgp Потому что эти ребята специализируются именно на построении оверлей их туннелей через интернет а с минимальной задержкой А те самые быстрые VPN каналы - это способ хакнуть физику э и построить более короткую оптику более другими путями очень популярно в финтехе всяких биржах и так далее когда задержка реально стоит денег и поэтому в целом провайдеры там особенно небольшие его охотно предоставляют Ну и использование к коннекта oud коннекта и прочих VPN для связи соответственно опм и вашего облако если у вас распределённая инфраструктура ну и наконец локальная обработка запросов здесь я думаю что вы здесь все прекрасно знаете что пользовательский трафик лучше обрабатывать в одном Дант Не тратьте по крайней мере время в на всяческий обмен данными с другими ДЦ если вам нужно ответить пользователю быстро да то есть все там все реплики и так далее можно уже асинхронно асинхронно догнать А ну и мультиверс а использование разных провайдеров для разных регионов и разных задач а более чем оправдано например в случае CD Вы можете либо комбинировать там три-четыре CD используя их там для разных провайдеров разных стран разного типа трафика и так далее или в разное время чтобы допустим А минимальная Загрузка у одного cdn провайдера Да там компенсировал загрузкой у а компенсировал загрузку другого вот здесь в принципе простор для всяческих або тестирований и прочих штук он очень большой а мульти DNS можно использовать опять же можно использовать больше одного ДНС провайдера таким образом пользователь будет отвечать ближайший к нему DNS сервер Авториа рекурсус А что соответственно тоже может уменьшить время на DNS А ну и mul Cloud если у вас позволяет ваша инфраструктура то можно использовать вот с той же логикой с которой вы использовали cdn можно использовать UL Cloud а там в разных регионах допустим что где-то лучше Вот такое облако где-то такое облако где-то возможно комбинировать облако и опм а здесь как вашей душе будет угодно и как ваши инженеры почитают нужным Так ну и наконец а вывода первое что нужно сделать это понять почему и где задержка У вашего приложения возникает а то есть на каком этапе вы считаете Да что там гипотезу выдвигает на каком этапе больше всего возникает задержка сетевого соединения с вашим приложением а далее вы эту гипотезу проверяете щим инструментом здесь я очень рекомендую использовать правила принципа рта что 80% результата достигается 20% усилия поэтому Выбирайте инструмент по себе то есть не нужно там пытаться затащить самолёт типа ч поинта если вам нужно проверить всего лишь там один какой-то простенький сатик и с другой стороны что если у вас какой-то очень большой ресурс там с несколькими дата центрами там синами и прочем и прочем и прочем то просто пинговать тоже его кажется как-то странным ну и соответственно Когда вы измерили задержку и поняли Какой из компонент у вас больше всего тормозит то нужно уже под подбирать решение это может быть как работа с bgp это может быть оптимизация самого сайта выделение каких-то дополнительных регионов то есть организация выносов и далее далее Далее о ЧМ собственно сегодня и говорил супер на этом У меня всё здесь два QR кода по одному фидбек по второму мой Telegram канал туда можно читать и писать там есть мои контакты Спасибо большое спасибо а ну что ж гостю задав лучший вопрос ждт наша супрематическая матрёшка возможно внести свой вклад в крутейший it конференцию и уйти домой с уникальным расписанный артефактом Кстати у каждой конференции будет свой дизайн Так что можно будет собрать выводах этих матрёшек который возможно что-то даст У тебя здесь есть листок можно делать записи по поводу вопросов и Давайте поговорим почему же у нас спидтест показывает настолько низкую скорость и высокий н кто начнёт Потому что если не начнёт никто в зале то начну Я прошу по вашему мнению Что лучше Ну что в первую очередь нужно чинить н или пропускную способно Ну смотрите с в пропускную способность как правило вы не упр только если у вас там не очень много трафика опять же там Год назад я рассказывал да Когда нужно начать задумываться о своём сидении А я думаю что там в 90% случаев Вам нужно будет чинить ленси потому что полоса расширяется достаточно быстро и прозрачно при необходимости это Ну то есть именно расширить полосу это не так не так дорого чем чинить lenc на стороне приложения можно пробовали оптимизировать так чтобы у вас скажем так запросов было меньше и было больше потоковой передачи данных чтобы нивелировать вопросы н ну смотрите мы вообще cdn да я это приложение взял больше как иллюстрацию здесь соответственно можно простор для оптимизации со стороны приложения он на самом деле очень большой Вы можете использовать допустим http2 вместо http1 Да и включать Стрим Вы можете использовать к если у вас там есть много много всякой тяжёлой опять же тяжёлого трафика если у вас команда может с этим работать Вы можете использовать к и там написать какую-то свою реализацию вы можете подключить допустим там партнёра cdn и использовать его ресурсы здесь простор для творчества он колосса потому что только автор знает там где можно его улучшить Ну да ещё внутри приложения тоже не сильно разобрали как было бы неплохо как внутри приложение работает между своими компонентами и что эти вещи тоже надо очень сильно оптимизировать потому что бывают такие вещи что у тебя там приходит уходит трафик допустим с твоего балансировщика Там 100 Мбит А внутри у тебя там 600 Мбит между ПП и базой данных например или там каким-нибудь редисом ну смотрите Да я в общем-то много чего не рассказал и можно и tcp поть как бы внутри дата-центра и там Между нодами но тут опять же тут вопрос в том что в 30 минут можно уложить достаточно ограниченный скоуп вопросов Смотри вот протокол tcp и всё что с ними с ним связано соответственно раун там над и так далее вот он довольно-таки старенький вот как человек который делает cdn скажи А насколько сейчас вообще ведутся исследования насколько сейчас а есть идея потребность подвижки в том чтобы в принципе поменять низкоуровневое топологию или tcp + фернет с нами Вот там на ближайшие десятилетия Ну смотри tcp протоколу насколько я помню лет типа 40 или там даже больше а есть один такой молодой протокол называется Он ipv6 емы всего лишь лет 30 А к сожалению проникновение пив 6 до сих пор низкое пост по миру обусловлено это тем что вот мы все любим обсуждать мы все его не любим так вот наш с вами Интернет - это одно большое Legacy это система которую вот в своё время сделали и к сожалению любое изменение в низкоуровневых протоколах типа Эне там ttp к ttp и так далее обозначает необходимость а переделки примерно всего интернета А поэтому у нас появляется Квик когда Браво ребята из Гугла говорят что мы всё вынесли в userspace и вот Оставьте нам пожалуйста udp Потому что с ним ещё можно хоть как-то работать ВС сделаем сами вот собственно ответ на вопрос что с нами навсегда всё что далее получится это будет что-то в ой Следующий вопрос С левой части зала не забывай записывать Спасибо за доклад Меня зовут Александр я из компании со вы сказали что никак нельзя ушить приложении например изменить параметры коз Возможно это поможет не пробовали не изучали вот эту тему Ну смотрите с косом есть много холиварофорум как правило у нас нет доступа к цпш То есть к клиентскому роутеру соответственно чтобы мы не накрутили у себя в приложении это не будет воспринято клиентским роутером потому что там поддержка нужна с двух сторон То есть вы со стороны приложения Красите трафик и если допустим Ну это вот в как это в энтерпрайз работает вы там со стороны приложения добавляете в траффик определённые метки и роутер на котором настроен вот эти взаимодействия с этими метками он соответственно будет там либо приорити очереди либо хотя бы просто пропускать Потому что некоторые роуте они если там ничего Про кос не знают они просто всё это срезают и дальше трафик Идёт уже не окрашенный снова поэтому Нет данно в случае последней мили кос практически никогда не работает и ну по причине того Да что практически никакая цпш по умолчанию не настроено на восприятие трафика Если только вы там у себя на кинетике допустим не накрутите что там приоритизировать такой-то фи ликой Но это всё так себе больше для само успокоения Следующий вопрос из левой части зала прошу Здравствуйте меня зовут Сергей спасибо за доклад Вопрос такой у нас есть последняя миля допустим клиентское оборудование и собственно сторона провайдера Да вот Не ну регулярно даже часто наверное возникает ситуация когда у нас есть какие-то потери задержки там в общем-то плохое качество связи и провайдер очень часто говорит ребята Как бы вы сами козлы Да ну то есть ну так если кратко да то есть проблемы на вашей стороне мы ничего делать не будем у нас всё отлично У нас там хорошее оборудование энтерпрайз все дела А вот у вас там ваше клиентское оборудование дешёвое там Замените проверяйте смотрите сами не наши проблемы как собственно доказать что собственно мы не верблюд да и стимулировать его к Ну скажем так ледова доказать что проблемы у него а не у нас да спасибо ну смотрите в случае если мы говорим про домашнего провайдера то как правило там Если у вас есть жалоба на качество интернета к вам приезжает монтажник включает свой ноутбук в роутер или там напрямую без роутера Да и там запускает какой-нибудь спидтест проблема со спите в том что нода этого спите стоит у этого же самого оператора как правило и рование получается невс а чинить здесь можно только смены оператора то есть условно в домашнем сегменте конкуренция как правило высокая если там это не какой-то монополист в доме то у вас есть выбор там 2 3 4 10 провайдеров и вы можете там между ними достаточно легко переключаться А если мы говорим про B2B то там отношение несколько более так сказать со стороны оператора дружественные если это провайдер как бы нормальный и адекватный вот поэтому там уже можно смотреть Вы можете сказать своему провайдеру что вот у меня тормозит вот конкретный какой-то ресурс там вот приложение ка не знаю Оно мне очень нужно для бизнеса ноно у меня тормозит провайдер дорогой сделай что-нибудь далее опять же к вам приезжает Чуть более квалифицированный монтажник у этого монтажника на телефоне будет скорее всего какой-то админ из этого провайдера они соберут диагностическую информацию посмотрят и например скажут что там грамму нужно поставить cdn ноду вот ко мне да Да и тогда всё станет хорошо или немножко потт опять же там какие-то коммьюнити и отправят трафик в менее загруженный Линк поднимут пиринг допустим вот опять же с этим самым котограм и что-то сделают То есть тут вопрос дальше уже в соотношении того сколько вы платите конкретному оператору это будет определять то количество усилий которое оператор затратит на то чтобы сделать Вам хорошо тут К сожалению И к счастью Чудес не бывает Следующий вопрос Дальняя часть зала слева раз-раз да Алексей спасибо за доклад возвращаясь к ipv6 хочется спросить какие основные наверное отличия будут по сравнению с V4 в Тулин в диагностике какие там какая там ситуация сейчас и что ты видишь в перспективе там на ближайшие пару лет Ну да спасибо за вопрос собственно отличий методах диагностики Нет это всё тот же IP адрес который в который резолвится имя там вашего ресурса или там набор ресурсов и так далее по там каким-то ещё отличиям связанность Да связанность другая и там другие тир о провайдеры там ну другие немножко взаимоотношения в остальном всё плюс-минус то же самое там Единственное что нет на как класса и это в общем-то несколько облегчает жизнь а с другой стороны там там все остальные вещи типа equ cost мультипас и прочие плс там все плюс-минус одинаковые а по перспективам роста и так далее ну ipv6 сейчас медленно оно растёт а связано Это с тем что новым провайдерам просто не откуда брать адресное пространство поэтому они вынуждены просто делать се эти ipv6 Only а особенно это ну Особенно это и видно в юго-восточной Азии и там Штатах и так далее когда там некоторые операторы новые они стартуют только на ap6 Но это всё будет опять же как я уже сказал интернет - это одно большое Legacy И к сожалению вот iv6 растёт не так быстро как как кому-то хотелось бы скажи есть мнение что практически на всём уровне ф ИМП приоритизировать для оценки а просто потому что все приоритизировать что всё хорошо а любой другой трафик потом идёт по-настоящему Вот что ты на это скажешь насколько это городская легенда или насколько это соответствует истине А я скажу так что скорее всего это больше из разряда слухов Потому что cnp трафик он там если допустим мы делаем тру МТР по acmp А то мы там можем видеть на промежуточных нотах как раз-таки дроп acmp Это связано с тем что Control Plan роутера просто Ну ему не очень хочется отвечать на клиентское CP запросы ему нужно молотить трафик поэтому тут с скажем так возможно кто-то так делает но я не встречал чтобы это было какой-то распространённой практикой потому что как бы cmp он в любом случае бегает и это в первую очередь средство диагностики самого провайдера внутри себя Если у тебя есть дроп Значит у тебя есть дроп всего остального и давай завершающий вопрос этой сессии сейчас Мега популярны Zoom и другие средства видеоконференций под капотом использует всякие кусочки телефонии вроде CP itp и так далее И вот эти кусочки телефонии очень любят такую штуку как удп H punching то есть обманывая вот эти вот Legacy а протоколы над передавать у DP трафик р to вместо того чтобы передавать его на свои какие-то сервера и вот всякие разные облачные провайдеры вроде тви и так далее они говорят вот Пользуйтесь нашими сервисами потому что 70-80 про удп трафика при Вашем видеозвонке пойдёт Пир to Пир и только там 20-30 через наши дорогие relay сервера вот по твоему опыту человека который делает сдн и хорошо разбирается в в механике работы насколько сейчас Это соответствует истине что в 70% случаев мы можем обмануть рауте и сделать Пир to Пир удп не имея реальных IP адресов Ну технически это естественно реализуемо а дальше Всё зависит уже от скорее всего этот механизм не прибит гвоздями и он адаптивный вот то есть у тебя приложение может чекать качество видео То есть тут нам ВК звонки очень любят рассказывать про качество видео то что они анализируют а приложение может анализировать трафик между пользователями тут просто есть какой нюанс что когда у вас трафик вертикальный от пользователя Вверх через его провайдера к какому-то Медиа контенту то там как правило провайдеры у провайдера всё хорошо они вовремя расширяют линки у них соответственно всё там есть какие-то пилинги какие-то выходы на иксы балансировка и так далее и так далее и так далее когда мы говорим про доступ между двумя допустим домашними операторами то там уже всё не так хорошо потому что соответственно такой трафик провайдеры не очень любят это как правило это либо платный Транзит либо это какие-то приватные стыки нужно поднимать которые в общем-то денег стоят потому что кроссировка модули порты на оборудование и далее и далее при этом денег они особо не приносят Ну потому что опять же пользователь платит Почему собственно ip6 не взлетает потому что ipv6 не приносит дополнительно бизнес ценности у тебя пользователь не платит за i4 интернет он платит за Интернет вообще вот поэтому тут скажем так то что Пи Да он с одной стороны Хорош Вот с другой стороны у тебя там если есть какие-то проблема у оператора у тебя они очень быстро ну возникают на качестве звонке и Тебе проще реально настроить всё-таки через какой-то ле через медиасервер потому что там магистрали у провайдера более отст там либо есть какие-то более широкие конт конн генератору Аплодисменты спикеру не забываем оценить доклад для нас это очень важно а сейчас спикер оценит ваши вопросы скажи пожалуйста кто же получит нашу супрематический спасибо Ну и Огромное спасибо тебе и наш традиционный маленький памятный сувенир тебе как спикеру L"
}