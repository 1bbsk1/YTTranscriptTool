{
  "video_id": "vgUOVMnVZoY",
  "channel": "HighLoadChannel",
  "title": "",
  "views": 0,
  "duration": 0,
  "published": "",
  "text": "Всем привет Меня зовут Павел шерепа Я руководитель команды инфраструктурной разработки ВКонтакте и действительно Я хочу рассказать вам сегодня одну очень интересную историю и как большинство интересных историй она произошла под Новый год Итак давайте представим Новый год у продуктовых менеджеров горят сроки разработчики пытаются перформия годовой премии все закрывают qpi ребята пишут код по задачам покрывают тестами прогоняют на тестовых доменах собирает авы от сокомандник можно помочь с кликером собирают опробовать командних мёрт свой код в Мастер ветку готовится к пло отправляется в прод и кажется вот он момент настал так подумали порядка 500 разработчиков одноименно не сговариваясь собрав самый большой в истории релизный поезд спойлер такому поезду как и его друзьям не суждено доехать до прода потому что по закону фи минимум один из 100 содержит ошибку и соответственно такой код такой релиз срет вернуть но мы с вами все инженеры Мы сталкивались со сложными проблемами и Нели дава вместе но пока немножко о терминах я упомянул термин поезд ведь у нас внутри ВКонтакте мы называем релизы поездами если хорошенько подумать у поездов есть маршрут следования но и у елизов он есть у нас задержка с кликером Поэтому я буду у поездов есть станции но и у елизов они есть Пассажиры Да вы начали догадываться пассажиры в наших поездах будут разработчики и их квесты соответственно каждый поезд содержит квесты и они являются пассажирами Итак давайте представлю вам мегаладон из области релизов мобидик который откусил десятки ног девопсом тот самый релизный поезд который бы вы никогда не хотели бы видеть у себя в продакшене наш новогодний поезд наш новогодний релиз и вы понимаете если он доехал до прода или доехал до какой-то станции что-то сломал то он будет только усложнять ситуацию потому что дальше будут накапливаться новые поезда но Давайте подумаем или немножко последи как мы здесь очутились у нас есть монолит центральное приложение ВКонтакте содержащее 15 ГБ исходного кода порядка тысячи разработчиков и эти разработчики создают очень много продуктовых фич когда я говорю много Это очень много и что делать с объёмом вливает выше 300 Ведь мы не можем лизи на каждый на каждое влить в Мастер наш деплой занимает больше часа соответственно в рабочее часы мы сможем прокатить не больше 10 поездов ну скажем даже будем кататься круглосу мы пром 20 поездов 20 фич Маловато если мы будем Лои по тегам то мы будем выкатывать а сверху будут накатывать новые хотфиксы новые фичи и сломанный поезд будет всё больше и больше усугубляться собственно в момент когда мы понимаем что минимум один 100т ошибку мы когда чтото сломано на путях и невозможно дальше кататься мы просто постоянно находимся в поиске этого импостера проблемного кода и до тех пор пока мы его не найдём туда будут продолжаться вливаться фичи это будет ещё усугубляться а следовательно в это время нужно ещё написать хотфикс влить его возможно РТ проверить что он отработал что с ним всё в порядке и в это время ВНО вливаются фичи и они ещё порождают большее количество багов И как мы попробовали выйти из этого какой наш был путь вначале Мы решили вести полицию елизов это админы это старшие разработчики дежурные разработчики люди с опытом с пониманием того как работает Монолит Как работает их приложение Они понимают быстро восстанавливаться какие-то принципы и имеют какой-то опыт но очевидно что они не способны выдерживать такую нагрузку они не способны долго сдерживать количество багов ве они постоянно наплыва и мы не можем справить эту ситуацию Следовательно как минимум их конечный ресурс будет усугубляться бесконечным количеством мавет Ну Представьте что мы просто взяли и забрали всех разработчиков кнопку замечательное решение но я думаю вы поняли что продуктовым менеджерам это не понравится потому что нет никакой предсказуемости пло нет никакой предсказуемости сроков мы не понимаем куда мы пойдём а разработчикам в результате приходится обновлять страничку лаба в ожидании что появится вожде донная синяя кнопка и они так делали Следовательно мы понимаем что и это решение не подходит Но я даже больше вам подскажу когда мы в это решение внедрили опытные разработчики люди с предвидения начали писать скрипты автоматизации которые чекали статус мастервет ива самими очевидно первые слоты И следовательно допустим по влить первых пся Magic квестов ветка закрывалась и все остальные оставались ждать со своими перезагрузка страницы очень неприятно и как будто бы отсюда нет выхода Мы в тупике или нет И всё-таки на помощь приходит древнейший архитектурный паттерн древнейшее изобретение человечества очередь Давайте мысленно поставим эксперимент мы выстраиваем всех разработчиков с их квестами в ряд в колонку и начинаем делить их на чанки скажем первые 30 вторые 30 и так далее пока вся очередь не исчерпаемым очередь из Magic квестов в которых разработчики понимают в В какой они находятся нумерации перед деплоя и они знают Какими чанка будут разреза эти релизы будущие как мы это реализуем для начала мы посмотрели на gitlab trains очень интересный механизм который доступен из коробки Следовательно У нас есть две кнопки смр сразу или добавиться некоторую очередь отложенную ин сам это сделает сам ВМР Но конечно же там очень мало настраиваемое и Кастома зации мы не можем мы имеем очень много сдерживающих факторов и о них я думаю сам рассказ подсветить Какие эти сдерживающие факторы следующим этапом Мы подумали может быть мы напишем скрипт который будет по каким-то кастомным правилам имитировать поведение getl trains Ну тут собственно собирать определённое количество Mag квестов и каким-то критериям которые мы сами определили скажем дату создания наличие лов и так далее неплохое решение но оно решает только одну из задач и более того оно не наглядно Его невозможно обозревать то есть ВС равно разработчикам как целевой группе нужно понимать когда они выкат И в этот момент мы описываю полный жизненный цикл Квеста ведь Если задуматься Magic не заканчивает своё момент существования свой свою жизнь в момент влия в Мастер ветку целевую мей ветку у него происходит какой-то дальнейший жизненный цикл он проходит тестовые деплой на какие-то свои тестовые сервера прогоны тестами автоматизации йн прок То есть это какой-то большой жине интересно Следовательно Мы решили создать сущность Квеста у нас в системе и накапливать информацию из лаба из других систем которые соединяют допустим прогон тестов по этому квесту АВ трев Следовательно даже здесь он проходит какой-то жизненный цикл перед тем как смр и понят цикл нужно набрать все зелёные галочки неплохо в какой-то момент времени разработчик понимает что он готов выкати в прод всё замечательно У него есть большая классная кнопка добавиться в очередь он добавляется в очередь И в этот момент он точно знает какой он в очереди понимая какими чанка делится очередь он понимает В каком он поезде будет и как будто бы мы уже решили проблему из фич замечательно но получив такую сущность как очередь накопив в ней merg квесты и разделив их на чанки мы получаем новую интересную сущность релизный поезд именно из этих виртуальных чанков он порождается Следовательно мы можем сформировать их просто вливая в масть вет А можем содержать какой-то виртуальной временной ветки и проводить все манипуляции там прогнать тестовые прогоны собрать Бинар собрать статику проверить на непротиворечивость задеплоить йн задеплоить в любые другие станции задеплоить в прод ещё не ВМР в Мастер проводить Какое количество проверок которое нам почитается необходим любое количество станций которое находится в жизненном пути этого Квеста то есть собрав виртуальный релиз из этих чанков мы получаем возможность делать любые манипуляции с этим релизом и даже возвращать его назад ведь если мы ничего не вмерзли в Мастер У нас есть только артефакт временная ветка и какие-то бинари связанные с ними какие-то записи о том что он деплоя и прошёл тестовые прогоны или не прол и если он нам не понравился Следовательно мы можем его развернуть и вместо него отправить следующий релиз Но даже более обладая очередью которая разбивается на чанке по каким-то правилам мы можем выводить специфические поезда мы можем приостановить разборку очереди и отправить персональный поезд вручну скажем у вас горит какой-то продуктовый запуск пожалуйста собрали фичи которые требуется выкатить прямо сейчас добавили в этот поезд и он поехал приоритетным и нас не беспокоит что было до этого на путях или кто стоял предыдущей очереди мы договорились о том что это имеет ценность У вас есть фикс безопасности пожалуйста можно настраивать различные фильтрации сортировки поверх очереди вот наме придумали Том хотелось повышать культуру покрытия фича тог ми кода Ну и мы решили внести режим сборки или с кандидатов будущих поездов которые состоят только из квестов обладающих фича тогмитов Мы можем написать какую-то эвристика которая будет выбирать порционные релизы Вы можете меня спросить Будем ли кататься ночью не выедет ли очередь которую набрали Мы за весь день ночью и не сломает ли прот пока все спят Нет мы дали возможность подтверждать разработчикам которые хотели бы выкатывать в ночное время то есть не в рабочее Мы специально отделили это на старыми константами и перформер которые любят работать Вечером могут кататься люди из других часовых поясов пожалуйста таким образом мы получили ещё и различные специализированные поезда но и это не всё Мы взглянули на конечную идею и поняли что это действительно жизненный цикл это целая высокая абстракция Это Новый взгляд посмотреть на плой и поняли что осознавание пя как чёрной коробки Это очень сложный процесс ведь для большинства рядовых разработчиков Было бы неплохо чтобы я просто Нажал кнопку и уехал в проды и получил чеки что всё великолепно а если не выехал то сообщите мне где я нахожусь в какой промежуточной станции что со мной Может быть я виноват Может быть кто-то другой виноват И как это было ранее как это возможно есть у всех из вас есть логи пя мониторинга есть дашборды кубер дашборды ваши кастомные Возможно какие-то палай самописный с этой системой работать Понимает ли он быстро в моменте где он находится Способен ли админ в критичной ситуации быстро Осознать что происходит на путях только взглянув ничего лишнего Мы даже в какойто момен написали пишут нам состояние деплоя в один-единственный чатик Представьте у нас порядка 300 квестов в день вливается пяти поездов это просто немыслимый водопад из информации который очень сложно осознавать в котором ещё происходят технические дискуссии пытаются проводить какие-то разборы инцидентов поломок или наоборот какие-то позитивные рассуждения Следовательно Это очень сложный процесс и действительно деплой превращается в чёрную коробку которую сложно осознать сложно держать в голове в результате мы решили поработать отдельный UX продукт новое решение и кажется мы это сделали достаточно интересно нетривиально получилось что колонки отвечают за станции карточки отвечают за merg квесты и релизы И следовательно когда я хочу узнать где находится мой любимый Я просто смотрю на overw моего приложения и вижу мне нужно задавать вопрос в чатах мне не нужно консультироваться получать какие-то особые навыки Я просто смотрю на overw и вижу Где я нахожусь Но оказалось что за этим кроется безд дополнительных интересных фич которые е более Раши ещё лучше его раскрывают Ведь мы можем добавить историю изменений историю прохождений событий релиза и таким образом можем понять что он допустим был сформирован из таких пассажиров что он деплоя в такое время прошёл тесты или не прошёл и мы понимаем как действовать мы понимаем Как реагировать не нужно перечитывать логии выдёргивать из них полезную информацию Мы просто взглянули и поняли что происходит сам раз заборчик открывает историю своего Квеста и понимает что с ним происходило за всю историю возможно он даже доехал до какой-то станции но потом его развернули и он обо всём этом сможет прочесть в любой момент времени она не проте чева она по возрастанию времени мы чётко понимаем что происходило у нас даже более есть записи обо всех резах и произошедшем с ними это собственно по возрастающая история релиза история Квеста и история ветки или станции Таким образом мы не только можем понимать что происходило в моменте Ну происходит в моменте Как нам следовать как к чему нам сейчас следовать Возможно у нас поломка инцидент и нам нужно вернуться на какую-то предыдущую стадию какая она была Где был безопасный Лиз какие там были ведь тогда было быть не было такой системы прыгать между состояниями до и после пойти почитать лаб попытаться разобраться нет здесь всё соединено воедино и это в том числе и инструмент ответа ретроспективного А что происходило раньше в каком состоянии мы были когда возник инцидент 10 мая скажем Или 15 февраля мы можем ретроспективно использовать этот инструмент для того чтобы погружаться в деплой исследовать его движение и в результате получается что мы понижаем когнитивную сложность осознавания этого процесса мы убираем этот чёрный ящик который состоит из множества переменных пересекающихся и делаем его понятным Делаем его наблюдаемым осознаваемый то есть Да действительно мы сделали снова плой понятным может быть великим сам этот инструмент намекнул на то что мы получили полный жизненный цикл а следовательно Он дал нам возможность исследовать метрики как цельную метрику от момента создания межи Квеста и до последнего состояния деплоя в прод так и любые его прохождени любых станций мы можем понять почему или по крайней мере заметить что мы медленно двигаемся с момента добавления в очи и попадание в йн или наоборот Мы медленно проходим станции йн и прод мы можем найти всплески мы можем аккумулировать эту информацию Мы можем выделить из неё какие-то девиации и нестандартные моменты потому что всё это визуализировать тогда посмотрим на альтернативы возможно ваши задачи чуть менее сложны возможно вас не так много разработчиков или возможно вам интересны подобные паттерны Вы хотели бы его воспроизвести чем бы вы могли воспользоваться но на минуту Я хочу остановиться здесь Да действительно здесь мог быть холивар по Монолит и вы бы могли бы мне предложить отказаться от Монолита пло легко и счастливо и катайтесь Но если подумать проблема сложности деплоя - Это не проблема Монолита это проблема деплоя плой - это сложная штука её сложно осознавать с ней сложно работать её сложно восстанавливать И следовательно само решение описывает плой независи от того с каким оно продуктом работает множество микросервисов Оно просто описывает плой подсказывает интуитивно выводит нас на понятное состояние деплоя Ну окей Давайте Мы приняли эту точку зрения начнём делить Монолит вспомните 15 гиб исходников тысячи разработчиков на деплой такого Монолита уйдут годы технологии испытания кото это ВМ нужно существовать деплоить и желательно успешно достигать наших целей и иметь возможность контролировать процесс собственно вот мы получили этот инструмент Ну и в конце Я хотел бы добавить именно по этой теме что можно предложить нам всем посмотреть на эту пробле на на этот момент как на проблему Нана логическую загадку логическую загадку деплоя которую нужно решить у деплоя Есть действительно много сложных моментов и мы справились с ним Мы решили эти компоненты не зависим от того кто является нашим консьюмер Откуда мы берём исходники Следовательно Мы решили проблему деплоя вообще мы применили интересные архитектурные паттерны чтобы уметь решать различные проблемы деплоя с различными консьюмер Следовательно монолит это или микросервис мы можем использовать мульти Нант в нашем приложении и обслуживать микросервисы ведь проблема деплоя - это проблема деплоя она существует отдельно от приложения Да приложение порождает Некоторые из них ну и таким образом решив проблему мы позволили не винить микро Монолит ещё одном грехе против человечества собственно Счастье для всех и вернёмся тогда к альтернатива я упоминал потому что это действительно хоро ние на маленьких обх оно решает Но конечно мы не можем кастомизировать очередь там её просто нет мы не можем её остановить временно мы не можем изменить объём чанков и конечно же из этих объёмов чанков не порождаются никакие виртуальные релизы мы ничего не можем сделать со следующими станциями у нас ничего не порождается то бишь Да действительно он решает проблему вва фино Дальнее инструменты на связывает дал посмотреть на п и зл потому что они интересно решают задачу подготовки будущего релиза с не противоречивыми фичами ведь целое - Это больше чем сумма частных элементов из которых он состоит Следовательно если у вас по двадцати фича всё в порядке совместно в отдельности совместно они могут породить баг или ошибку компиляции или возможно ещ какие-то девиации Следовательно эти инструменты могут вам помочь и конечно же используя jenkins мы могли бы тоже каким-то образом кастомизировать наш деплой Ну и у него ограничены ресурсы и самое интересное что он не отвечает на на проблему сложности деплоя он просто скрывает какие-то элементы на всё равно ещё нужно узнавать Где я нахожусь как в каком состоянии как возвращаться истори и всё вот в этом роде и вы наверное можете задать мне вопрос что в итоге с чем мы вернёмся после этой этого выступления какую идею мы унесём домой в чём ключ Дай нам я скажу что у меня есть кое-что лучше У меня есть идея механика список архитектурных паттернов которые решают воз подсказка мне в прошлом Как решить их ведь столкнувшись с этими проблемами мы не понимали как их решить то есть мы тоже бились узнавали как это возможно решить пытались найти опыт но не нашли его Итак давайте посмотрим возьмём виртуальный изм накапливать информацию используя gitlab AP и будем накапливать мы можем накапливать ещё другую информацию из источников прогона пайплайн цикл Magic и будем накапливать накапливать таким образом будем понимать в каком состоянии Quest и готов ли он скажем что он готов построим вокруг него очередь то есть построим виртуальную очередь в которую сами разработчики могут добавляться Окей достаточно неплохо будем разделять их на чанки снова и снова и таким образом получив виртуальные чанки из квестов мы породи сущность релиза нашего деплой поезда причём сейчас как раз таки будет подсказка в том что не обязательно собрав эти чанки 50 30 вы выбрали которая подходит вашим задачам 10 Вы можете их влить сразу в Мастер ветку и отправиться в деплой собственно система работает Мы решили задачи но можно в этот момент собрать временную ветку щую от мастера и влить туда все эти Magic квесты Следовательно эту временную ветку в зависимость от того проходит она пайплайн проходят ли там билды всё ли с ней в порядке Мы можем либо разобрать уничтожить сохранить не только сти другие поезда вместо них более перспективные те которые не падают либо в конечном счёте довести до станции продакшн и тогда скажем отстоявший часик чтобы удостовериться что всё в порядки смержить мастер ветку в целевую ветку Давайте создадим станции эти эта которые визуально Раут есть и тогда разработчикам будет понятно Где я нахожусь тогда админам будет понятно как взаимодействовать с релизами которые здесь накопились Ведь если мы плом постоянно без этой визуализации без понимания мы можем налить и 10 релизов в каждом по 100 и не будем просто замечать что там столько кода много накопилось только когда мы будем готовить этого огромного поезда мы помм что там десятки же стоит предусмотреть откаты во ВКонтакте Уже давным-давно разработано очень хорошее решение откатов на предыдущий Бинар То есть у нас есть какое-то количество предыдущих поездов успешных они у нас отмечены успешными и мы можем в любой момент откатиться на предыдущий бинай замечательно Но ведь код в целевой ветке и в стейджинг уже достиг то есть мы если мы хотим восстановить движение поездов нам нужно этот код Следовательно вынудить разработчиков и бези их ветки снова вливаться если мы используем вот эту подсказку с временной веткой мы можем ничего не ревер просто ничего не доехало мы вернули бинай мы вернули код мы просто разобрали эти межи квесты на потенциально опасные и безопасные безопасные положили обратно вверх очереди и они поехали самыми ближайшими релизами красиво и сама история Казалось бы очень простая маленькая фича но она отвечает на множество вопросов которые будут задавать вам целевые пользователи она будет проливать вам информацию о том что происходило с релизом Ведь вы будете исследовать свой деплой я представитель команды r& depl мы исследуем проблему и описываем решаем её то есть Нам нужны какие-то артефакты И следовательно Эта история порождает ещё или по крайней мере бэкграунд который она использу порождает инструментарий для Ри для исследования Time delet мы можем исследовать его как цельный элемент так и отдельные частички жизненного цикла этих поездов мы можем это делать впервые в истории никогда не получалось соединить эту информацию из озорных участков она просто была существовала в различных местах в логах в дашборда и так далее в самом лабе и всё-таки возможно один из самых приятных возможно самых приятных и самых удивляющий элементов это конечно же сам интерфейс который инкапсулировать сложность который оставляет только понятное мы видим мой M Quest который двигается по колонкам которые представлены станциями и отправляется в прод я больше не задумываюсь о том где нужно это искать Я просто это вижу и вы бы могли бы задать вопрос да возможно это не является нашим первым приоритетом Но действительно мы не рассматриваем такой вариант Конечно мы сечас как команда Чен деплоя мы ищем мы знаем о других проблемах мы исследуем их делим на участки проводим гипотезы запускаем новые gitflow и на всём этом процессе получаем результаты с многими из них я вас познакомил И в этот момент хочу сказать Спасибо что вы пришли послушать посмотреть на наш опыт и надеюсь что вы извлек ещё таким образом когда я в прошлом буду задавать вопросы своим знакомым друзьям возможно появится ответ для меня в прошлом Итак спасибо вопросы погнали помним что за лучшие вопросы есть сувениры Здравствуйте Роман Васин компания Арена дата я вот хотел уточнить такой момент получается что вот каждый МР сначала проходит по нему пайплайн да и только если пайплайн зелёный по мру он ставится в поезд и тут как бы запускается пайплайн по всему поезду и получается что пайплайн упал То есть например в поезде 20 пассажиров все они зелёные и начале и как понять кто виноват как бы Хорошо вы делаете ревер как бы каждый разработчик понимает что у него всё отлично но вот возникли конфликты я могу ответить на этот вопрос чётко как мы действуем сейчас и это действительно интересный вопрос потому что это одна из логических задачек деплоя которую мы в том числе породили в этот момент приходит падение в чатик с разработчиками и дежурный разработчик может отреагировать и посмотреть и подсказать что похоже на ошибку статики Скажем мы находим потенциально очень похожий по рейсу merg Quest и убираем его из этого поезда в момент снятия его с поезда пересобрать пайплайн И следовательно мы снова видим прошёл или не прошёл если мы провели несколько попыток и не знаем мы можем разобрать этот поезд и пустить другой и потом разобраться Ну наверное тогда я немножко проспали есть другие ещё архитектурные паттерны для того чтобы решить эту проблему мы можем заблокировать Нау станцию релиз кандидата и временно разбирать исследовать кто виноват А можем собрать несколько релизный поездов одновременно с разными пассажирами или возможно по возрастающей первые 10 следующие 10 П 20 и так далее и таким образом мы сможем понять на каком из релизов произошла ошибка все верхние выбросить и токо те кое показали способно собственно Вот такая возможность внедрить мультирез я только Однажды видел как людей снимают с поезда это всегда всегда трагедия пожалуйста Спасибо за доклад хотелось спросить а что вообще по результатам То есть вы видели проблему видели долгие непредсказуемые Деливери внедрили насколько сильно улучшили что вы собрали В итоге как бы насколько было полезно хорошо начнём с самой проблемы Проблема не только в том чтобы кататься быстрее но и контролируемые иметь инструменты для того чтобы восстанавливать пути понимать когда лучше остановить плой и разобраться с теми поездами которые сейчас то есть мы получили инструмент которого вы не обладали ранее получили понимание Как работать с пло которого не получали ранее ранее у нас было я рассказывал мы вливаем огромный поезд он валится мы начинаем исследовать А в это время наливаются Новые квесты и только усугубляют проблему То есть получается мы могли работать только ртами и это ещё вынуждало разработчиков восстанавливать свой код здесь как минимум мы построили инструменты контроля и предсказуемости но в действительности в норме мы начали кататься быстрее у нас не пропали Некоторые из проблем в том числе Монолита которые ему свойственны Например если действительно что-то сломало в стейджинг нужно разобраться и восстановить его мы придумали другие механизмы вот эти восстановления стейджинг ветки разбора временной ветки Следовательно это итеративный процесс каждый раз который позволяет отсекать новую проблему и на многих те мы получили и Прист и во времени А самое интересное мы получили метрики которых никогда не писали раньше то есть если вы зададите вопрос как было раньше и как стало сейчас я просто не могу на него ответить потому что этот процесс никогда не исследовался его просто невозможно было исследовать или это было сложно мы покупаем звездочёта который берёт и перечитываю логи одного приложения со вторым с третьим и суммирует это ВС Ну вот как-то так надеюсь Добрый день спасибо за доклад Вопрос такой понятно как упорядочить всех желающих релизинг точки как мне кажется Первое - это при сборке релиз кандидата то есть вдруг два мерч реквест дорабатывает один функционал и это там интересно послушать как решаете но наверное понятно а вторая предположим собрали поезд Один он уехал а в поезде 2 доработка функционала который есть в поезде один и как бы поезд 2 собственно не знает да что это попадёт в Мастер вот как вы это решаете Ну вот хорошо начнём с того что если я пю свой код или свою фичу Наверное я знаю с чем она связана Наверное я знаю С какими она квестами предыдущими и последующими связано наверное у меня есть какой-то путь план и я его всю дорогу придерживался как я буду лизи в прот и очень маловероятно что я в этом случае допущу что главное кусок фич будет находиться вверху оди а какие-то элементы будут значительно ниже либо я попрошу кого-то из дежурных поднять их поставить вместе либо я специально поставлю их вместе одновременно Вот наверное из этого вытекают другие следующие логические задачки для деплоя Как соединить различные поезда которые действительно чанкам находятся в разных местах но они логически связаны Действительно это интересная Задачка и как будто бы она достаточно решаема нам просто нужно знать цепочку Граф связанности их и тогда мы можем в зависимости от того Где находится голова этого графа Где находится инициирующий релиз понимать Ну как нам действовать со следующими поездами и если мы откатывается откатить и последующие или если эти не доехали то нужно как-то подсветить что главный уже уехал в принципе это решаемые задачи и конечно же мы их предусмотрели у нас есть как более простые методы решения так и стратегия Как работать в дальнейшем друзья я напомню на всякий случай что для дискуссии после того как мы здесь закончим эту часть на выходе из зала можно спикера поймать и поговорить не в микрофон пожалуйста ещё три вопроса Я думаю успеем А Добрый день Спасибо большое за доклад а буквально три тезиса первое Как вы динамически настраиваете размер чанка Как вы их приоритизировать уникальный путь для каждого поезда уникальный путь Ну то есть уникальный набор станций Да хорошо как мы контролируем динамические размер чанков у нас есть очевидно какие-то конфигурационные настройки в в нашем приложении приложение кстати называется и вы можете все его оценить на стенде компании в сильном шатре можем конгу отдельно для разных чанков а в целом для очереди потому что пока такой задачи не состояло мы проверили несколько гипотез как собираются и лится поезда состоящий из п мров оказалось что многовато потому что в принципе много кода много смысловой нагрузки уже сложнее работать с ним мы попробовали Magic Quest релизы в 25 в 30 мров и просто интуитивно физически они получились наилучшими поэтому мы оставили в 30 Mag квестов иногда когда происходит какие-то неординарные события мы просто изменяем и Это скорее опыт плюс механизм взаимодействия и последний вопрос был А приватизация приватизация есть механическая Ну то есть строго кнопками мы можем перемещать их эры внутри очереди Так как хотим можем выбрасывать можно возвращать можем поднимать в топ и третий Да действительно большинство поездов Было бы неплохо прокатывать весь путь но если у нас есть необычная ситуация Например у нас реальная поломка и мы хотим сохранить этот релиз прям хотим сохранить мы можем прокатить хотфикс который ВМР можется строго в эту ветку У нас есть инструмент влить конкретно в эту ветку йн ветку скажем да И в этот момент мы получаем тот релиз который мы спасаем Да мы накиды на него какие-то хотфиксы или что-то Рем номы действительно можем пропустить несколько этапов под нашу ответственность в любом случае даже в лифту Да мы получаем дополнительные паланы которые пере проверяют поезд на этой станции и всё равно не учёт ничего проблемного Вот спасибо Прошу Да спасибо за интересный доклад тоже вопрос несколько перекликается с предыдущим про кастомизацию Work Да ты вот рассказал что есть такой классный инструмент он действительно выглядит круто удобно насколько вот этот workflow кастомизированные вот технологическая составляющая что вот вы что-то форкнуть с нуля О а workflow я уже подсказал что мы в принципе размышляем про Open Source но такой задачи не поставили даже в род мапе То есть она скажем какая-нибудь будущая q25 или там плюс И следовательно про идею кастомизации этого Фло то есть возможности её порождать Для различных проектов разной мы не не вносили Но к нам приходили уже внутри компании люди которые говорят что пускай нам не интересна очередь но нам интересен продукт но в принципе он достаточно интересен и он покрывает множество других задач которых рассказал Давайте встроили нескольким проектам работать с этим строим логическую мульти Нант поверх одного Монолита позволим выкатывать какому-то единственной директорий которая может себе это позволить выкатывать отдельно и получится у неё отдельный визуальный интерфейс который я показывал другое количество станций и другие критерии добавления в очередь или её полное отсутствие но тоже генерация допустим релизов Следовательно дамы этот процесс прорабатываем Нон нев по что мы решаем именно проблемы на данный момент очевидно он находится где-то там в далёком ропе а прок - это самописная решение мы долго исследовали альтернативы какие-то интересные решения рядом и поняли что в действительности этот workflow как ну как какой-то конструктор как стоит машина которая переходит через какие-то состояния мы можем воспользоваться в лучшем случае какими-то инструментами базовыми языка или какими-то библиотеками но не форкнуть его целиком потому что са нов в том году каже о велосипедах мы вынуждены писать велосипеды потому что никто кроме нас его не написал ещё то есть вот сожалению и Да мы воспользовались пайном потому что какая-то лёгкий удобный язык для быстрых прототипов мы набросали решение работает и действительно ему не нужен огромный перформанс он хорошо себя показывает вот поэтому сэто давай спасибо большое за доклад было очень интересно Михаила кажется вы уже начали даже отвечать Частично на мой вопрос смотрите у нас как говорится не монолиты в основном всё на микросервисах но у нас есть большая проблема кросс системных Выка ток да то есть интересует своеобразный поз поездов у вас уже как-то Вопрос решается или нет Мне кажется я отвечал в нескольких трендах нахо вопрос да рассматривается вариант работы с микросервисами и да рассматривается вариант связанных релизов то есть действительно связанные Лизы возможны они даже возможны в рамках одного конкретного Монолита и они возможны между различными танами то есть различными слоями здесь коне жен какой-то путь который пройм как И как решение продукта но они тоже находятся где-то в род мапе очевидно мы молодой продукт мы то есть буквально развиваемся полтора года и каждую новую веху мы сами исследуем то есть мы исследуем проблему деплоя и находим для неё решения архитектурные какие-то организационные сами подсказываю новые идеи решения этих проблем Ворох проблем вот этих вот сложностей с которыми стоит столкнуться с пло или рано или позно все столкнётся он огромен и мы стараемся его приоритизировать насколько это разумно Согласно нашим требованиям и моменту Вот это вообще достаточно Интересно что о пло как о сложной системе редко говорят и редко взаимодействуют поэтому мой доклад и это возможность скорее даже вызвать дискуссию поговорить как это с другой стороны какие проблемы у вас пройдём мы ли этот путь или нет Или возможно мы его уже запланировали собственно рад общаться Надеюсь ответи Спасибо большое за доклад махни пожалуйста все кто вопросы задавал Вот скажи чей вопрос был максимально полезен для сообщества вместе с ответом мне понравилась идея и связанных елизов то есть связанных фич и разбора поломки в лином кандидате собственно молодых ловека Сид для сообщества А кто из них Просто красавчик Вот давай сечас Просто нам надо определить кому матрёшку А кому игрушку давайте наверное связанность релизов для сообщества важнее а махни рукой кто это связанность вот молодому человеку матрёшку так второму молодому человеку игрушку А теперь кому пакет ещё махни пожалуйста Я понимаю что X5 но ВС рано пакет оставшихся пакет вот раздватри понравился вопрос про приватизацию и выстроены чанков то есть всё разобрались постгрес раздали Спасибо тебе за доклад ещё раз ребята Спасибо что послушали и задали вопросы спикеру тоже памятные призы от конференции в 12:20 здесь короткий тех ток"
}