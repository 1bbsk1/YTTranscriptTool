{
  "video_id": "xnhqffKkP1Y",
  "channel": "HighLoadChannel",
  "title": "",
  "views": 0,
  "duration": 0,
  "published": "",
  "text": "суд тдб про которую нам расскажет Максим кубар ский Всем привет Меня зовут Максим я сотрудник компании ядро занимаюсь гов разработкой в команде которая разрабатывает атмосферу немножко о себе Мой основной стек - Это был asp.net больше 10 лет занимался разработкой Бека на shp в какой-то момент sharepoint мне надоел Я сменил компанию сменил стек и занимался некоторое время frontend разработкой jav SCP typescript но без бка жизнь мила и я подключился там же к разработке серверной части которая была написана гон соответственно менее года назад это произошло и погружаясь в язык го начал смотреть что в принципе на нём написано и в рабочий чат Однажды Даниил Подольский скинул ссылочку на db а посмотрите какая штука штука оказалась очень интересной настолько интересной что летом когда в один из гох форумов был кинут Клич А кто хочет сделать доклад про Ну я вызвался соответственно Я здесь и ЧМ Я вам сегодня расскажу немножко поговорим о документы ориентированные сбд А монго в частности Посмотрим В принципе Что такое Что за зверь такой посмотрим Каким образом связана с монгой поговорим о совместимости сфе она умеет немеет соответственно вопро Почему Ну соответственно глядим вовнутрь будут какие-то выводы и вопросы Итак документ ориентированы сбд в отличие от ционных баз данных данные хранятся не в строчках в табличках А в виде документов которые могут быть в формате xml и какие другие каждый документ содержит информацию в виде полей значений это пара ключ значени итно данные хра в коллекциях ко структурой ВС это нам Дат такие штуки как очень понятную структуру объекта нам не нужно разбираться в строчках и табличках у нас есть объект целиком при этом структура может быть очень сложной не требуется преобразование объектов приложения в объект базы данных вот у нас есть объект мы его записали мы его прочитали сразу используем этом Дат воз быст стам пить поехали и Мо db наверное одна из самых популярных документо ретивых баз данных наверное можно сказать что монго и документ ориентированы база данных стали синонимами Да вбиваем монго видим документ на ориентированную базу данных и наоборот соответственно монго нам Дат возможность рабо с огромными об данных это у нас репликации шардирование очень высокое доступность динамические запросы к документам документа форма очень просто с всем этим работать индекс для любого атрибута что очень важно И это одна из фич монго и всё это нам очерчивает примерную область применения Да это какие-то каталоги управление пользовательскими данными широва логирования каталоги выбрал цветом выделил не просто так примерка который по-моему Хорошо иллюстрирует вообще зачем такая штука нужна один вариант допустим есть у нас интернет-магазин и карточка продукта со временем мутирует она просто меняется вопрос как это хранить то есть нам не нужно просто всё время записывать последнюю версию Да Нам всегда надо посмотреть А что было раньше и прочитать эту карточку и реляционная база данных тут подходит не очень хорошо а такая штука как монго подходит замечательно мы фиксируем версию обязательное поле а всё остальное как хочется так и ведём соответственно со временем У нас мутирует карточка версия тоже меняется Мы всегда пишем что-то последнее но благодаря версии Мы точно знаем а Как прочитать старые данные второй вариант с ним я столкнулся Однажды сам это у нас есть реляционная база данных в данном случае это был постгрес и у нас там ведётся в стандартной структуре заказчики поставщики оборудования соответственно там аутентификация личный кабинет всё такое прочее Но самое есть каталог товаров соответственно заказчики ходят в этот каталог смотреть Что они хотят заказать поставщики загружают туда свои какие-то каталоги с товарами чтобы заказчики искали и всё бы хорошо но у нас есть какой-то фиксированный набор полей а всё остальное это была строительная компания может быть как угодно то есть у товара может быть не знаю самые разнообразные параметры разме одно дю другого в Самет Ультрафиолет или нет В данном случае опять же реляционная база данных не подходит а документ самое то и в тот момент мы Мон решили не брать а использовать который есть и всё замечательно работало Вот как раз когда я прочитал про мне подумалось что 5 лет назад мне бы как раз такую ди наверное было Дан нема часть успеха Мон принесла е клиент драйвер который оказался очень мощным язык запросов монг наверное сопоставим по мощности с см он настолько крут что пользует его много кто не только монго ан Microsoft Oracle у них у всех есть какие-то свои ба дан подключаться Используйте Мон Да монгой клиент монгой драйвер вот всё супер но они все проприетарные это важно соответственно F db также использует а драйвер мон db и авторы fdb делают акцент следующем монго драйвер настолько мощный что вообще было бы неплохо вроде бы это основной целью не является но было неплохо сделать протокол монге стандартом для запросов к документо ориентированным базам как в своё время да SQL стал стандартом для реляционных баз данных соответственно F db что это И кто это F db - это прокси сервер монго запросов в SQL запросы Где в качестве хранилища выступает либо pog либо ES на данный момент Ну в зависимости от настроек F db и данные хранятся в виде G это Open Source проект свободно распространяемый и написан на языке го позиционируется ди как замена монго как альтернатива монго и соответственно это вот далеко не вся команда слева внизу Алексей поланко я на него ещё буду ссылаться потому что с ним я несколько раз консультировался по поводу спрашивал разные вопросы если посмотреть всю команду там ещё будет много наверно знакомых лиц Итак кам образом связа снго появись Да все драйвера Мон доступны под лицензии все этим пользуются Однако сама по себе Мон была то есть db доступна до восемнадцатого года доступна под лицензии V3 но с восемнадцатого года она сменила лицензию на ССП Да это вот выдержка из Вики если коротко то любой то есть третье лицо которое распространяет как услу обяза выпу код открыть свой код не просто свой код но код всех а всего дополнительного по AP который может потребоваться пользователю коком Да чтобы запустить всё это самостоятельно Ну или купить лицензию и для многих коммерческих продуктов с открытым исходом кодом для многих стартапов это стало проблемой потому что с одной стороны монго нам нужна это удобная инструмент с другой стороны нам не нужна очень часто вообще вся монго Да там 80% с можно 20% функциональности при этом необходимо простое решение с открытым исходным кодом чтобы не было таких вопросов с лицензией и db было как раз Создано для того чтобы заполнить этот пробел в общем-то Именно из-за этого во многом появилось общий принцип работы следующий Да у нас есть приложение итно кото принимат запрос рут запрос SQL и сохраняет либо в либо в SQ Ну в зависимости как Мы настроим начать работу совсем просто можно запустить докер контейнер можно запустить как rpm или пакет или использовать его как пакет Go в самом приложении во всех случаях у нас на выходе будет Mon которым можно вставить в любое приложение Shell и 3 и кабура языке соответственно чего умеет монго ой db А чего она не умеет на данный момент ра db умеет круд Да умеет операторы запросов операторы обновления соответственно умеет агрегирующие функции индексы она умеет возрастающие убывающие составные уникальные индексы совмести со всеми драйверами мого это очень важно здесь тоже будет пример К соответственно работает с пово через протокол монго и на форуме fdb постоянно выходят статьи где рассказываю как fdb можно использовать там с тем или иным по из экосистемы монго статей сейчас достаточно много пишут они их частые очень подробные то есть интересно почитать теперь соответственно чего мо fdb не умеет не умеет тли индексы но всё очень быстро меняется да буквально там пару дней назад я залет посмотреть roadmap и сообщество сказало Мы хотим индексы соответственно индексы будут они запланированы в ропе скорее всего на двадцать чей год но посмотрим сейчас нет поддержки из коробки репликации шардирование но тоже запланирована реализация на чет год команда рассматривает три варианта один вариант - это использовать какое-то стороннее приложение второй вариант - это воспользоваться мощностями и возможностями э постгрес и третий вариант написать тоже своё исключительно на уровне фера db ну интересно что посмотреть То есть в конце двадцать четвёртого года в общем можно держать руку на пульсе я точно буду смотреть нет схем валидации нет Чейн стримов тоже запланирован на двадцать четвёртый год про них не забыли и в принципе опять же год заканчивается Новый год вот-вот начнётся у них обновился roadmap из того чего у меня нет в докладе потому что просто раньше не было в описаниях db у них запланирована поддержка геоза просо запланирована поддержка пользовательских представлений и как я понял начались работы по поддержке нового бэнда это My посмотрим что из этого получится и как получится соответственно когда мы смотрим ну такие приложения хочется посмотреть как это работает самое простое наверное написать тесты и самое быстрое вот тестики написал совсем простенькие и примитивные в коллекцию запихал 10.000 документов ну и соответственно по разным типам давал запросы по Q коду можно посмотреть Если интересно тесты прям прям простые но эти простые тесты дали дали которые приватну оптимизация её наличия или отсутствия Что такое скажу позже пока это просто оптимизация запросов и не оптимизация запросов Ну соответственно тип атрибута по которому мы ищем оператора дальше У меня идёт время запроса которое тратится на связку edb п постгрес соответственно отдельно сколько постгрес отдельно тратит на запрос Сколько времени уходит на обработку внутри db для сравнение что у нас умеет монго кстати сказать Да чтобы прогнать тесты на монге Мне было достаточно поднять за у в тестах и просто запустить и вс сработало то есть ВС вставило все тесты прогнали соответственно если у нас есть оптимизация Циферки совсем даже неплохие если оптимизации нету то на деся документах в коллекции запрос Ну прям в полсекунды при этом команда так и пишет ль у производительно максимум покрыть необходимой важно функциональность мо чтобы поддерживал поддерживал нужном уровне чтобы пря детерминированная поддержка была мы делаем запрос на одни и те же данные мо должны вернуть одинаковые результаты соответственно Почему Наго и причём здесь задав этот вопрос Ну во-первых фантест и дженерики в первую очередь фантест говорит Без них было бы достаточно сложно написать всю обработку протокола с одной стороны фантест есть в других языках но фантест в Go прямо встроено в язык это удобно и была очень забавная ситуация он говорит самой первой версии db не собирались под теку версии потому что сразу под верси 11 тот момент была в режиме тестирования соответственно Алексей отметил реализацию работы с сетью говорит быстро удобно Очень ускорил работу отметил также что го позволяет писать простой код который потом удобно оптимизировать не с минимальными затратами соответственно команды этим очень и очень активно сейчас пользуется важная штука - это кроссплатформенность некоторое время наза процессоры и го не то чтобы выбирался специально для того чтобы сделать но го оказался нужным языком в нужное время да то есть го оказался именно тем языком на котором оказалось удобно выполнить такую задачу как создание м замечательной особенностью и фишкой да является то что наверное весь софт который распространяется написано на го он весь в исходных текстах соответственно всегда Полезно и интересно посмотреть А что в других что другие написали что внутри у других приложений чтоб потом полировать на собственным кодом не знаю там можешь поплакать и порадоваться в любом случае посмотрим что внутри ну самое первое что полез смотреть Каким образом транслируется в G потому что это разные всё-таки форматы Да это также хранит ключ значения но не хранит информацию о порядке полей Он поддерживает дополнительные типы который нет в типа Time или чех разрядный integer db команда сделала своё собственное эквивалентное хранение это схема S и ключи с префиксом доллар это означает что такой ключик Да содержит зач которое описывает какое-то уникальное знание тип в бесо Ну например да доллар - это у нас доллар S - Это документ доллар О - это object ID доллар L и в строке у нас число это шести четырехразрядный индр ну и соответственно ещё чуть-чуть внутри Да у нас а есть одна таблица которая описывает вообще все коллекции и для каждой коллекции есть своя собственная таблица с одним единственным полем а подчёркиваем J B с типом J примерно ВС тоже самое не примерно тоже самое просто там просто и соответственно в это поле записывается информация соответственно Вот такая вот операция это вставка документа в коллекцию это будет транслировал к - это массив за счёт этого Как раз сохра в каком порят базу данных будет сохран Вот такой документ то есть доллар S - это у нас описывает документ в НМ есть поля массив указывает В каком они порядке ну и соответственно значение полей само собой из-за того что в монге и в постгрес в JB поля данные хранятся немного по-разному запросы работают по-разному на первых порах чтобы выполнить вообще любой запрос db забирала все данные из коллекции внутри себя как-то переварила это вот как раз Почему без оптимизации получались такие большие Циферки но начиная по-моему с лета вышла версия в которую добавили оптимизацию Она позволяет из базы данных тащить только те данные которые нужно сейчас поддерживается такой набор типов и пока только три оператора начинало ВС со STR object ID соответственно помимо изменений в обработке внутри кода поменялись запросы если у нас есть P оптимизация добавился хвостик и условия Ну соответственно мы выбрали только те данные которые нужно потом ВХ мы как-то дополнительно обработали отдали Если же запрос у нас без оптимизации Ну мы берём Всё теперь как это вообще устроено в коде это описание пример есть уест read From Right to и Меня заинтересовал Ну не импортированный метод Bon Type С пометкой S Type и абсолютно все типы которые описаны в Бене описаны в структурах и они имплементировать этот интерфейс и вот как раз у них у всех а вот у этого типа B Type пустая реализация стал смотреть по коду выяснил В общем следующее Ну с одной стороны это защита того что данный интерфейс не будет реализован вне этого пакета тем самым команда большая да все люди и Это наверно страховка от ошибки что реализация ушла куда-то и вне только внутри пакета второй момент это контроль использует такую утилиту как gope которая на уровне C вместе с литерами делает следующее она проверяет всес с типами в данном случает интересовать который лезут вот этот интерфейс Type И если в каком-то свиче пропустили один из типов Ну допустим добавили новый swich всё не перечислили или добавили новый тип опять где-то его позабыли то это утилите гнётся Ну соответственно сборку не пройдёт отдельно небольшой пример фанг теста это как раз один из фанг тестов который наве на там очень много тестов можно всегда посмотреть вообще поть Пиу тесты я взял один Это пример проверки чтения типа ну если мы сломали мы должны получить ошибку Ну соответственно в тестах у нас В случайном порядке режется хвостик Ну рандомной величины и мы проверяем что мы всегда получим ошибку мы Не отдадим дальше мусорные данные да которые толком не прочитали е Один при теста это стресс-тест в ционных тестов там их тоже очень много тоже можно посмотреть как они пишутся Это пример тестирования ситуации когда у нас параллельно пытаются записать создать одну и ту же коллекцию с одним и тем же именем сделано по-моему Здорово Да соответственно мы берём текущее количество ядер умножаем на 10 есть у нас имя коллекции и атомик счётчик соответственно мы создам Ну сколько у нас там рутин получится все они пытаются создать коллекцию с одним и тем же именем если получилось создать Ну мы делаем счётчик плюс оди если не получилось мы как-то фиксируем ошибку а потом мы в коллекцию пытаемся записать документ на выходе соответственно у нас получается следующее мы должны из этой коллекции прочитать документ сравнить с тем что мы туда записали то что нужно И последнее что мне положен Рав что не нолик не двоечка а именно единичка дженерики Куда в Гоби из дженериков дженерики db используются по большому счёту чтобы на плечи компилятора переложить проверки связанны с типами это вот один из примеров метод который функция которая проверяет что наша переменная не содержит значение типа по умолчанию код очень примитивный простой Ну по-моему он таким и должен быть он очень активно используется в различных тестах если бы здесь использовались интерфейсы пустые да то код бы был куда больше вероятность ошибки в нём была бы куда больше а вот здесь по-моему хороший пример как можно использовать дженерики в го ещё один пример использования дженериков Опять тоже самое Да мы на плечи компилятора сваливаем часть проверок относительно типов в данном случае это интерфейс который описывает итераторы соответственно любой итератор там по документу по массиву не ю по слайс индексов они все реализуют это Интерфейс Да и пример метода Когда у нас Ну функция которая получает значение список значений Ну опять же Да Если бы мы здесь использовали пустые интерфейсы код был намного больше более сложно читае вероятно ВМ было тоже намного выше отдельно было очень интересно каким образом у нас там внутри формируются и запросы не используются там никакие дополнительные утилиты всё клеится руками Это пример создания индекса шаблон Да как создать индекс соответственно у нас есть цикл бегаем по списку ключей по которым мы хотим создать индекс Превращаем стрелочкой Ну соответственно клеем строчку и делаем ей с индексами ВС понятно я пошёл смотреть А что же у нас с там всё посложнее но оказалось всё тоже самое всё руками попробую пояснить Почему Это пример как раз создание фильтра вот этот хвостик в запросах который сда оптимизации Ну соответственно вот он сам сейчас и не поддерживается для оптимизации если не поддерживается Мы отсюда выходим и фильтр остаётся пустым Ну соответственно мы никакого в не прибавили Если же тип поддерживается В данном случае это шести четырёх разрядный фут мы здесь делаем проверку что значение которое нам пришло в запросе не превышает безопасного значения В данном случае постгрес если превышает Мы немножко меняем шаблон соответственно создаём строку фильтра переменные Ну значения Да и отдаём уже непосредственно в создании и вот такие кейсы они для каждого типа притом не Просто для каждого типа Но для каждой операции здесь очень как это ну подход всегда очень частный разбор очень подробный и поэтому наверное всё это делается непосредственно склейка руками для контроля между прочим везде в этих местах в комментариях есть ссылочка на почить а почему было сделано то или иное решение соответственно транзакции сферы db подошли Ну по крайней мере сейчас подход такой либо всё либо Ничего соответственно если мы что-то делаем и что-то случилось Ну соответственно мы всё откатились драйвера F она делает следующее если функцию которую мы передали вовнутрь выполняется без ошибок то мы делаем для базы данных comit если функция выполняется с ошибкой то мы делаем лбк ну и соответственно пример функции прямо он совсем Конный но в любом случае в данном случае это функция которая делает обновление коллекции документов ошибки как обычно в нам не хватает ошибок полез я смотреть как сделан ошибки Это пример ошибки которые которые используется в работе с энми это как раз или какой-то новый там наверное будет здесь всё просто соответственно есть структур есть внутри Гош ошибка и код там огромный список кодов который может сри данных неизвестен это паника то есть ошибки очень детерминированы Это пример ошибки как которые отдаётся клиенту клиент у нас монго да монгольский клиент соответственно внутри есть документ который внутри которого будет ДСО написания этой ошибки вроде бы всё И все ошибки закончились но я нашёл ещё один пакет Lazy eror было очень любопытно что такие за линее вые ошибки выяснил следующее в этом пакете У нас есть метод к это PR Counter соответственно когда мы его вызываем он возвращает нам Ну proun с текущего фрейма Там же есть мед й который принимает про Counter и возвращает й Ну соответственно ошибка Да структур сама ошибка и PR Counter когда сом такую ошибку ВТО и внутри сгенерировал PR Counter и на при вызове eror Когда нам нужно строковое представление в логах например да мы берём если програм Counter есть мы поднимаем по нему фрейм из фрейма мы забираем файл строчку и функцию Ну и в итоге у нас в логах получается не просто там код ошибки и какой-то текст Да у нас прямо написано в какой строчке в каком файле наверно поэтому они Левы не нужно разбирать А где же произошла ошибка сразу видно где структура проекта Ну она прямо стандартная настолько стандартная что наверное если хочется посмотреть как вообще структурирован достаточно большой проект то это хороший пример залезть туда посмотреть Да cmd fdb fdb - это сама db integration - это ционные тесты их там много Internal - это то что внутри Back это как раз база данных handler и так далее немножко статистики там 62000 строк кода 13000 строк комментариев я не знаю сколько из них Ну какой из них процент копирайта в каждом факе но ну то есть Гош код написан очень понятно читается достаточно легко при этом все места которые требуют каких-то пояснений описаны комментариями плюс как я уже Говори везде ссылка на можно посмотреть вощеного ре ноги выводы Да зачем нужна ра наверное как мне кажется там где нам нужны документы ориентированная база данных но не нужны все фичи монго нам нужно облегчить работу сном в по Да очень часто если нам нужно документ ориентирован база данных ну мы берём монто изб нужна у нас уже есть пос и ВК там ничего другого тащить не хочется при этом db - это уже не приложение на коленке где можно показать вот смотрите мы такую штуку пилим например компания fastnet Moon она делает софт для обнаружения а они в недавнем времени перешли с мога на связку SQ по причине что некоторое время назад повы просо и для это было очень критичным они буквально запускаются на различных роутерах в связка у них хорошо получается то есть они пишут что они используют как Pet у них получается очень компактный бинарник который очень легко и быстро разворачивается провайдеры облачных вычислений официально став льно поддерживает фе в связке с постгрес сом в принципе да Куда движется db сейчас видно что с одной стороны они пытаются реализовать самые актуальные фичи монго в том числе с помощью сообщества сообщество на это влияет там происходит всё время голосование что вам нужно что не нужно с другой стороны пытается поддержать самые актуаль ба данных бым потому в посте на была поддержка дна потом был SQL вот недавно времени вроде как начались подвижки чтобы сделать к на масле соответственно сейчас релизы выходят каждые 2 недели на двадцать четвёртый год запланированы очень большие работы по оптимизации это вот помимо тех вещей которые сейчас запланированы в ро мапе наверное Вполне себе db это приложение когда Ну или решение Да которое можно использовать на проде В некоторых случаях если есть сомнения то как мне кажется можно держать руку на пульсе подождать когда закончится 2 четвёртый год посмотреть куда это всё вырастет Ну как минимум как минимум Да как мне кажется это а годная технология про которую стоит помнить она может нам добавить варианты решения тех или иных задач которые могут вдруг перед нами встать ну и соответственно Спасибо за то что послушали меня и голосуйте за доклад задавайте вопросы если есть Да коллеги Будьте добры вопросы Максиму Неужели нет ни одного О отлично Добрый день У меня вопрос по поводу производительности вот я не очень понял как осуществляется поиск по индексу если допустим индекс по одному из полей Джейсона А в подс он хранится целиком вот Ну и как бы продолжение проверяли ли вы тесты на более больших объёмах не 10.000 а допустим там 10 млн элементов поис по таким Ну скажу так да на больших объёмах таких я не проверял для меня в общем-то приложение было новое это первые такие тыка не палочка вообще что это да то есть мне нужно сейчас такой сбор информации в принципе что она умеет Да чтобы потом придумать Какие тесты мне загнать То есть это первый тесты которые мне пришли в голову ну как ну мы 10.000 документов загнали чтобы такие большие тесты нужно делать мне нужна наверное помощнее машина чем домашняя Вот таких проверок пока нету по поводу производительности поиск индексов да здесь я наверное сейчас толком путного ничего не скажу да то есть здесь нужно посмотреть здесь был просто какая штука ещё совсем недавно поменялось немного Ну как немного пару месяцев нали месяц назад Наверное они выкатили новую версию вообще архитектуры Да И вот здесь Ну надо вот пря опять сесть смотреть Так будьте добры Да спасибо за доклад Я не совсем понял почему не поддерживается тоже там шардирование то есть мы же по факту подключаемся к Борису и который отлично выполняет эту функцию в чём пробле как я понял исходя из того что прочитал они нали с самого маленького мы сделаем круд мы сделаем бы за я гово хоть тестики простые но мне понравилось Я поменял урол У меня ВС заработало Да Больше я ничего не делал как пишут в форумах люди которые пытаются это пользоваться там некоторые компании тоже говорят Ну поменяли урол в той или иной степени это работает вот почему не было сделано шардирование сразу ну наверное так команда движется Так давайте мы посмотрим а что самое важное кому это важно да шардирование как я понял может быть стоит не на первом месте но плюс у постгрес есть какие-то свои варианты Да они там пишут Можно попробовать какие-то варианты с постгрес сом Вот но по ходу дела Опять же сообщество говорит нам нужно шардирование шардирование запланировано как они будут делать не знаю Мы же по сути можем просто поменять endp на балансировщик на тот же и постгрес сам разрулит то есть у меня наоборот вопрос такое ощущение что он должен уже поддерживать а вот тут как раз хотел сказать а по-моему где-то из команд Ну ребят из Яндекса будут рассказывать про шардирование постгрес когда они это следующий доклад во вово я как раз когда увидел его думаю если я правильно понимаю чего они хотят сделать то Вот как раз это можно будет попробовать использовать что я попробую сделать То есть db Потом наверное вот тот балансировщик а сзади у нас ИНН с постгрес Ну можно посмотреть я посмотрю что из этого выйдет и как это можно будет использовать так есть ли ещ вопросы да есть Спасибо за доклад Скажите пожалуйста как вы считаете насколько удастся приблизиться к показателям Мон Вот вы показывали результаты там Насколько я понял мне не очень хорошо было видно Там разница в два порядка Ну если смотреть там где сейчас есть оптимизация Да есть домен секунды db даёт там 11 Секунд вот здесь опять Мне сложно сказать когда разго с Алексеем он говорит ну там есть очень много где оптимизировать мы пока специально это не трогали нам нужно было вывести функционал Вот это прям их вот прям они даже очень долго то есть только летом появилась вот это вот вариант с пуда оптимизации до этого я просто видел в форумах ещё начиная с первом версии Вот вы начинаете делать вы будете оптимизацию делать у вся коллекция берётся было написано Ну мы сейчас сделаем какой-то стек поддержки функции Мон самых важных а потом займёмся оптимизацией Ну вот двадцать чет год посмотрим что они сделают прям говорит будем оптимизировать прям пла спасибо Как думаете я думаю что такой вариант использования может быть когда дни есть которые любят пост Да и рабы хотят монго как вариант Ну вот один из примеров Да вот мой собственный опыт вот работали с дном B соответственно запросы Ну не самый приятный на ощупь Да запрос в погос если бы вот можно было работать сразу так объектами Это было просто замечательно Ну да А по производительности Ну тут Наверное вряд ли когда когда-то оним смогут догнать они может быть и не преследуют прямо цель с производительность опять у нас много задач мы никогда не знаем какой у нас будет результат нам никто не говорит вот Мон использ нюансы Я вставлю тут слово как ведущий на самом деле на разных типах данных монго и постгрес будут давать разные результаты потому что у них разные индексы и запросто может оказаться что Фери db уже сейчас быстрее монге именно на вашем датасете но скорее всё-таки медленнее но Подо что ребята будут оптимизировать это всё мы пока не знаем А когда они оптимизируют тогда и посмотрим могут что-то в кэше держать самого Вот и посмотрим вот здесь Да здесь надо ручку на пульсе и проверять что они делают Спасибо ещё Да Есть ещё вопросы а Спасибо за доклад я хотел уточнить просто а получается основная проблема которую решает db - это просто синтетический сахар над погр то есть удобная работа с GSB полями Ну наверное так первую первое что они решили сделать и Наверно это было толчком Да это монго сменила лицензию она Ну по-прежнему Open Source но она не свободна и оказались в такой ситуации когда у нас есть с одной стороны замечательный инструмент огромное сообщество которое пользуется монгой с другой стороны теперь такая штука что с лицензией Всё хорошо да и у нас оказалось что нету оного проекта свободного проекта который бы позволял работать с монгой и это было как я понимаю толчком Вот они решили за пользовать э драйвер монго Чтобы заполнить нишу второй момент ну наверное да то есть у нас получается возможно некий синтаксический сахар нам не нужна во многих случаях допустим ум для работы с тем же jsonb в посе у нас есть вот клиент монго он по-моему удобнее и помощнее спасибо ещё вопрос в последнем ряду Да спасибо за доклад я мне очень понравился пример с роутерами и хочется узнать если закрыть глаза на лицензии и такие вопросы где ещё есть такой кейс где будет лучше Мон вот не из-за лицензий а потому что лучше подходит Ну смотрите вот на данный момент я когда изучал собственном опыте Да и смотря что вокруг я бы сказал так F db может оказаться лучше если не в производительность просто в удобстве в экономии не знаю там сил в экономии у нас нет дополнительной базы данных это какое-нибудь логирование вот если нам нужно неспешные логи а ф Например постгрес у нас уже есть то фра deb 10 может оказаться выигрыше мы не тащим целую базу данных мы вот маленькую штучку запустили вообще как пакет и всё замечательно То есть у нас с одной стороны мы не притащили новую базу данных с другой стороны у нас Мы не заморачивайся Ну очень удобно работа с объектами А с третьей стороны у нас есть куча инструментов Да которые есть для работы в монге не знаю графа ещё что-нибудь да Для того чтобы с этими данными работать то есть вот в этот момент То есть сейчас Мне кажется это не сколько там производитель не производительный сколько вот в каких-то узких моментах удобство удобство программистам наверно в большей степени я не очень понимаю в том как устроены роутеры но я правильно понимаю что всё на ЧМ может запуститься го запустится и db то есть её можно затащить теоретически в умные устройства Ну теоретически наверное Да официально пока поддерживается м Я кстати не нашёл в Информации Какая Нижняя граница Но вот например FN Moon Да они говорят Ну Нам нужно запускать это на роутерах роутер наверное ну помощнее чем умное устройст Но это вс-таки такая очень-очень специфичная штука и в принципе наверное в какой-то степени да Опять можно собрать и попробовать Спасибо так спасибо Есть ли ещё вопросы не вижу ваших рук А если я не вижу ваших рук значит настало время выбрать лучший вопрос и подарить за него подарок Ну мне больше всего понравился вопрос про шардирование То есть я сразу как посмотрел так Уйдите пожалуйста к нам сюда мы вручим вам пакет Спасибо за доклат вам спасибо за вопрос так и подарок от конференции для Максима всё коллеги Спасибо Спасибо"
}