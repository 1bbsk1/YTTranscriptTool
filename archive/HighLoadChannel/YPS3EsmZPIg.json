{
  "video_id": "YPS3EsmZPIg",
  "channel": "HighLoadChannel",
  "title": "",
  "views": 0,
  "duration": 0,
  "published": "",
  "text": "Всем привет Меня зовут Алексей около около 5 лет я занимаюсь Open Source разработкой в основном проекты связанные с тематикой умного дома и в основном это разные расширения и дополнения к платформе умного дома Home Assistant среди русскоязычных пользователей наиболее популярен проект Яндекс станция на наиболее популярен проект go to rtc это стриминговый проект для стриминга камер в реальном режиме времени но сегодня я хотел бы рассказать про проект который называется Xiaomi gway 3 А это проект для подключения нескольких шлюзов из шлюзов умного дома из экосистемы Xiaomi mih платформы умного дома Home Assistant на данный момент Он поддерживает три модели шлюзов Вот они на экране М А Начать Я хотел бы с того что вообще такое шлюз умного дома Зачем он нужен в умном доме Существует несколько радио протоколов это Bluetooth wi-fi zb lora zwave 433 и некоторые другие И когда вы э подключаете устройство по технологии wi-fi с кликером какие-то проблемы Угу Когда вы подключаете к умному дому устройство по технологии wi-fi вы с помощью специального мобильного приложения передаёте на устройство имя и пароль от вашей wi-fi сети устройство подключается к облаку производителя ваш телефон подключается к облаку производителя и вы можете управлять своим умным устройством практически из любой точки мира когда вы подключаете Когда вы подключаете к умному дому устройство по технологии Bluetooth вы подключаетесь к этому устройству напрямую облако в этом случае не участвует но здесь есть проблема как только вы покидаете свой дом ваше устройство становится глупым вы больше не можете им управлять и именно на этот случай и существуют шлюзы умного дома то есть устройства подключаются к шлюза умного дома и ваш мобильный телефон уже подключается посредственно к какому-нибудь шлюзу умного дома забавный факт на слайде отображён датчик умного дома температурный датчик вот такой вот маленький с завода производителя этот датчик идёт по технологии Bluetooth энтузиасты уже научились писать на него альтернативные прошивки также на технологии Bluetooth Но другие энтузиасты научились писать на него альтернативные прошивки и датчик начинает работать по технологии то есть на одном и том же железе просто пум альтернативной прошивки датчик начинает работать на другом радио протоколе благодаря своему чипу ещё одним плюсом шлюзов умного дома является локальной автоматизации То есть вы можете настроить Так что датчик движения управлял светом датчик протечки перекрывал краны датчик температуры управлял микроклиматом в вашем доме и эти автоматизации будут работать даже если облако производителя отвалится у вас дом Умный дом продолжит работать но есть некоторый минус подобные экосистемы от производителей как правило Закрыты они могут работать только с определёнными типами устройств от одного производителя и Чтобы избежать этой проблемы в орсе появилось много разных платформ в частности Home которые позволяют едить устройство разных производителей в одной экосистеме делать автоматизации между этими платформами и как раз под Home Assistant Я в основном и пишу разные интеграции первым шлюзом для которого я добавил поддержку Это был Xiaomi multimode Get вот такой вот шлюз такая маленькая шайбочка слово мультимод в названии означает что шлюз одновременно поддерживает несколько радио протоколов это Bluetooth wi-fi zb причём для б Он поддерживает такие технологии как ble и ш по факту это прям сильно разные две технологии хотя и скрыты под одним и тем же именем Bluetooth Это первый мультимод шлюз в экосистеме Xiaomi и один из первых шлюзов которые поддерживают технологию Ш это был 2020 год когда этот шлюз появился на рынке Но самое интересное в этом шлюзе то что шлюза в первых версиях прошивки заложили в шлюз такой дор для разработчиков в команду для открытия telnet команда выполняется по протоколу Mi это своеобразный J rpc поверх udp с шифрованием то есть данную команду может выполнить только владелец шлюза тут не надо бояться Что кто угодно там в локальной сети сможет её выполнить её может выполнить только владелец шлюза потому что только он знает ключ шифрования данного протокола Ну вот такая команда существовала я не знаю кто её открыл первый раз но один из пользователь выложил её на форуме Как только я увидел что в на рынке появился такой интересный шлюз с такими возможностями я тут же его заказал и начал исследовать что же там у него внутри а внутри оказалось очень много всего интересного архитектура шлюза напоминает микросервис архитектуру так знакомую современ разработчикам то есть на шлюзе записано запущено очень много маленьких программ каждая из этих программ выполняет свою отдельную роль у многих из этих программ существует буквально собственная база данных там в виде файлов в виде SQL базы данных и в виде других локальных баз данных и эти программы взаимодействуют как-то между собой ради достижения одной общей цели собственно функционирования шлюза то есть есть програ для взаимодействия с человеком эта программа отвечает за кнопку на шлюзе за светодиод на шлюзи и за динамик на шлюз то есть больше ничего она не делает её обязанности работать с вот такой вот периферией для взаимодействия человеком отдельно программа для взаимодействия с Bluetooth модулем отдельно программа для взаимодействия с zb модулем она по совместительству является мастер приложением А кроме zb она выполняет некоторые административные функции в частности именно она открывает telnet доступ на шлюз именно она вот выполняет команду по открытию telnet доступа также есть приложение отвечающее за homekit протокол это протокол от фирмы Apple приложение которое отвечает за локальные автоматизации и приложение которое отвечает за локальный кластер тоже интересная разработка от команды Xiaomi когда у пользователя в локальной сети есть несколько подобных шлюзов они находят друг друга собираются в кластер один из этих шлюзов становится мастером остальные становятся слева мастер шлюз общается с облаком а слей собирают данные с устройств и передают эти данные мастеру только мастер решает Какие данные отправлять в облака какие нет кроме этого всего Кроме этого всего существует программа которую я назвал message бке именно она отвечает за коммуникации всех приложений на шлюзе и программа для общения с облаком но и это ещё не всё для zb команда разработчиков этого шлюза выбрала чипс от фирмы Silicon laps семейство efr32 и это очень довольно популярный чип его очень активно используют разные компании например такие как akar sov tu также российские производители вроде Je UB и также этот чип очень активно использует команда Home Анта если кто не в курсе Home Assistant не только пишут Soft но и разрабатывают собственное железо и в этом железе для технологии zb Они как раз используют чипы семейства efr32 ой э Silicon laps вместе со своим чипом поставляет sdk и приложение которое называется Z3 Get Host это приложение общается zb чипом по сериал интерфейсу обрабатывает эти команды и выдаёт результат по протоколу mqtt Это довольно популярный протокол в умном доме тоже своеобразный message брокер очень легковесный поэтому его легко запускать на очень таких слабенький Итого мы имеем на нашем шлюзе дополнительно приложение Z3 gway Host мото бке - это Open Source сервер как раз mqtt и некоторое приложение от производите отвечает за конвертеры то есть оно читает zb команды от устройств сыры и преобразует это в какие-то понятные данные Вроде как мы получаем там температуру или влажность датчиков или мы там получаем сигнал о включении лампочки и тому подобное Итого В итоге архитектура выглядит следующим образом все эти программы общаются между собой Z общается по протоколу разные приложения все остальные приложения общаются между собой через внутренний медж брокер Итак как же вот это вот всё подключить к сторонней системе Да в принципе очень просто мы подключаемся к шлюзу по тил нету и перезапуска mqt сервер чтобы он начал слушать на публичном интерфейсе по умолчанию он стартует на локальном интерфейсе то есть мы никак не можем к нему подключиться всего лишь что нам нужно - это подключиться к СЖ ptl net и перезапустить mqtt брокер на публичный интерфейс чтобы мы могли подключиться к шлюзу Извне а Итого где-то через месяц после того как я получил этот шлюз уже была написана интеграция в которой А мне удалось распарсить вот эти вот zb команды от основных устройств наиболее популярных которые существовали на рынке а общаясь шлюзом по протоколу mqtt Но кроме zb устройств на шлюзе также есть Bluetooth устройство Как видно на схеме они совершенно не касаются mqtt Они общаются через свой встроенный message брокер и для работы с ними был выбран следующий подход мы а снова подключаемся к шлюзу по лту и перезапуска утилиту блютуза ну просто её перезапуска в итоге после того как мы её перезапустили по лту нам в telnet начинает сыпаться её std Out А вуте этой утилиты разработчики бережно А парся все данные от Bluetooth устройств и выдают её просто в качестве логов в итоге мы а данные zb устройств получаем по mqtt данные от Bluetooth устройств получаем по лту просто читае C утилиты Bluetooth у этого подхода есть большой минус проблема в том что шлюз обрабатывает данные Bluetooth устройств Только когда есть подключение к собственному облаку Ну то есть логика очень простая Зачем нам нужны данные с Устрой если коннекшн к облаку нету А вот и когда он теряет подключение к собственному облаку оно может теряться даже когда у вас есть дома интернет просто там облако отваливается там не выдерживает нагрузок этому подобное и шлюз просто перестаёт обрабатывать данные с Bluetooth устройств даже если они есть в округе но на тот момент не было других вариантов и порядка там 2-3 лет пользователи пользователям приходилось мириться с данным подходом и работать с Bluetooth с данными только когда интернет есть Хотя по факту подключение к шлюзу локальное и интеграция не использует облако в своей работе далее через какое-то время стали появляться новые шлюзы у старого первого шлюза начало начали выходить новые прошивки и приложения на шлюзе там стали менять название у них начали появляться другие параметры запуска std тоже начал меняться И поддерживать прошлую схему стало довольно сложно нужно было придумать какой-то новый способ который учитывал и новые шлюзы и новые прошивки старого шлюза В итоге для себя я нарисовал собственно Вот эту вот схему и стал думать какой же у нас есть выход Как же можно получать Bluetooth данные не просто читая утилиты посмотрев на эту схему в принципе ответ становится очевидным есть приложение message brer через которое эти данные в любом случае проходят А в результате чего я просто решил переписать этот message бке на какое-то своё приложение для этого я выбрал язык Go и далее расскажу Почему приложение а я назвал Open Mio оно доступно в опенсорс Вы можете Открыть посмотреть как бы исходники данного приложения начнём с железа данных шлюзов старый шлюз использует архитектуру mips - это одноядерные CPU довольно свободной памяти после того как запускается операционная система и все ему необходимые утилиты остаётся порядка 5 Мб то есть нам надо написать такое приложение которое вместится в эти 5 Мб если у шлюза начинает кончаться память он начинает очень сильно глючить и совершенно не работать как мы знаем Go поддерживает рос компиляцию и написать приложение будет работать под всей эти архитектуры не составляло никакого труда Здесь даже не надо использовать никакие cg можно писать на чистом Go даже под виндовсом и все эти архитектуры очень легко компилируется с помощью стандартных средств языка Go запуск приложения выглядит таким образом все а весь функционал приложения разбит на разные модули и эти модули можно включать По отдельности То есть если вам не нужны какие из этих модулей Они просто не указываются в команде запуска и они не стартуют не нагружают шлюз не тратят CPU и шлюз может работать быстрее чем при использовании всех этих модулей дальше я расскажу по порядку что каждый из этих модулей делает так вот выглядит приложение Main а оно инициализирует разные из этих модулей модули написаны максимально насколько это возможно Независимо друг от друга То есть можно просто закомментировать часть из этих модулей скомпилировать приложение и теоретически оно будет продолжать работать здесь используется собственные функции не с маленькой буквы для того чтобы соблюсти порядок инициализации этих модулей То есть если бы мы использовали стандартный гошт мы не можем отвечать за порядок инициализации первый модуль модуль Mi он как раз отвечает за то есть основное что нам надо было заменить у стандартного приложения на шлюзе Здесь всё довольно просто происходит стандартная приложение открывает некоторый unix Socket к этому к сокету подключаются остальные приложения на шлюзе и общаются Джейсон ками здесь нечего особо рассказывать кажется что язык Go как раз для вот такого функционала и создавался реализовать подобный функционал а слушать Unic Socket и обеспечить общение некоторых тилит женами никакой сложности не представляла второй модуль - это mqtt он весь внутренний трафик шлюза всё это внутреннее общение пересылает в mqt брокер чтобы мы могли этот трафик читать Извне Ну то есть из нашей интеграции Home Assistant или любого другого приложения умного дома здесь жно что мы использовали нестандартную библиотеку стандартная популярная библиотека mqtt по-моему написана команда Eclipse она очень тяжёлая просто мы бы из 5 Мб 100% выбились если бы использовали стандартную библиотеку я нашёл вот альтернативу довольно легковес ную Она работает очень быстро она покрывает совсем небольшую часть mqt протокола но а всё что нужно было на этом шлюзе она покрывает третий модуль - это кэш А помните я рассказывал что у Bluetooth протокола есть проблема когда шлюз теряет связь с облаком он перестаёт собирать данные из Bluetooth устройств и собственно этот модуль пока есть связь с облаком кэширует все необходимые запросы в Это облако и когда связь с облаком пропадает он просто выдаёт приложением шлюза Закан ответы от облака Ну какие это Например могут быть запросы это могут быть ключи шифрования устройств потому что данные от в том числе температурных датчиков шифруются это может быть спецификации устроить чтобы шлюз понимал А как нужно обрабатывать то или иное устройство с каким-нибудь мадре сом Вот и когда этот модуль работает шлюз э всё время думает все приложения запущенные на шлюзу всё время думают а что облако у них есть и продолжает работать как ни в ЧМ не бывало да что же такое четвёртый модуль - это Central я также рассказывал что шлюзы когда Видят друг друга в единой сети собираются в некоторый кластер кто-то из шлюзов становится мастером кто-то с левом и тут есть проблема если наш конкретный шлюз стал слейм Он снова перестаёт слать данные в облако он шлёт свои данные от устройств вот мастер шлюзу шлёт он это по совершенно другому протоколу и мы начинаем терять данные То есть если наш шлюз конкретный стал слейм Мы не видим данные с устройств Поэтому вот этот вот модуль как раз необходим за то чтобы перехватывать протокол Аа общения шлюзов друг с другом в локальной сети он также происходит через Unic Socket тоже особой сложности реализации данного модуля не было модуль Z3 у него не вообще не не сложный функционал он просто перезапускает утилиту Z3 gway от команды Silicon labs чтобы читать её stdout и этот stdout перенаправлять в mqtt в этом те иногда бывает полезная информация о работе zb сети и её Интересно иногда читать из интеграции также у этого модуля есть более интересная задача это перенаправление zb модуля по протоколу tcp Если вы слышали о таких утилита как sakat и ctet а также о таком термине USB over IP а данная вот данный модуль и исполняет эту функцию он просто берёт seral интерфейс zb Чипа и перенаправляет его на tcp пор к этому seral интерфейсу можно подключиться из разных Open Source приложений например такие известные как zb mqtt The и также Отечественная вот разработка с а и у вас получится такой удалённый zb координатор Когда вы можете держать свой сервер умного дома где-нибудь там в кладовке в подвале а центр умного дома у вас будет где-нибудь в центре помещения в виде Вот как раз такого шлюза а по сути я повторил вот функционал базово повторил функционал у Cat или ctet работа с сериал интерфейсом на архитектура mips и ARM оказалась такой довольно непростой задачей потому что а библиотеки существующие которые я гуглил кое-как справлялись с архитектурой ARM Но вот с псом а она из коробки не работала вышью были подсказки что в этом случае надо делать аэ Сперва я так и пользовался этими подсказками но потом просто переписал весь этот код инициализации сериал интерфейса он получился довольно небольшой на одну страничку если вот в ваших проектах а будет задача работать с сериалом интерфейсом на таких архитектура можете посмотреть как это сделано в Open Mio код открытый в качестве логов Я использовал библиотеку zer Log Это было очень давно ещё до того как логи продвинутые логи появились в Go я проводил сравнительный анализ разных библиотек Да в Go существуют более популярные библиотеки логов но опять же помним что мы запускаем на очень дохлой Биб весила максимально очень мало насколько это возможно и данная библиотека полностью это покрывает это наверное самая быстрая библиотека среди существующих на Go для логов и тесты официальные там это также подтверждают и она очень маленькая Она позволяет выдавать логи в виде Джей соно Она позволяет выдавать логи в виде раскрашенных раскрашенного текста в stdout и на данном примере как раз показано как одновременно можно отсылать логи э в виде Джейсоном по протоколу mqt чтобы мы допустим могли Извне читать что что же там происходит с нашей утилитой и в виде обычного раскрашенного текста std Out также ястро в это приложение скриптовый язык проводил Анализ Какой лучши скриптовый язык выбрать Если была бы возможность я бы лучше выбрал JavaScript На мой взгляд он такой более удобный наглядный для неподготовленных пользователей помним что данным шлюзом пользуются не программисты а обычные люди может быть немного там знакомые сайти немного умеющие запустить сервер умного дома но вс-таки они незнакомы с и язык для вот людей более сложнее На мой взгляд чем тот же самый синтаксис языка там JavaScript А проблема в том что все существующие интерпретаторы жава скрипта намного тяжелее чем вот найденная мной библиотека нало она действительно очень маленькая и очень быстрая помним что на шлюзе очень слабенький процессор и нам этим языком ло нужно встраиваться в медж брокер шлюза То есть через него потенциально могут проходить очень много сообщений и задержки в этих сообщениях совершенно неприемлемые Ну то есть кто захочется пользоваться шлюзом умного дома если у вас реакция на какие-нибудь датчики движения и датчики света будет сильной задержкой вот поэтому нужно было выбрать супербыстрый язык и интерпретатор вот и Эта библиотека полностью соответствовала здесь допустим есть пример как перенаправлять ктт сообщение в этот язык ло Ну допустим мы получаем эти mqtt сообщения из брокера на Go а потом пересылаем её некоторое функции чтобы она могла эти как-то сообщения обработать и сделать какие-нибудь дополнительные действия например Зачем может потребоваться язык лоа на шлюзе есть вот такие вот датчики движения очень популярные и по умолчанию эти датчики движения шлют информацию о движении раз в минуту то есть они послали что мимо них прошёл человек на минуту заснули и следующая информацию о движении они пошлют только через минуту это можно обойти закоротить два Контакта на плате если это сделать то данный датчик переходит в некоторый сервисный режим и начинает слать движение каждые 5 секунд но есть проблема когда датчик находится в сервисном режиме он посылает периодически все специальную команду и шлюз реагирует на эту команду писком То есть я знаю пользователей которые при использовании данных датчиков Просто выпаивать динамик и шлюза потому что жить с ним просто невозможно он там пищит постоянно целыми днями и по ночам в том числе но с помощью скриптов на можно конкретно Вот эту вот команду от zb Ути до утилиты которая управляет динамиком видеть что идёт такая команда запрещать её пересылку дальше в итоге динамик не пищит но продолжает работать в своём штатном режиме пользователи довольны шлюз скрывать не надо ничего паять там не надо приложени выглядит таким вот образом из итогового бинарка вырезаются всякие разная системная информация и в итоге бинарник сжимается утилитой upx пришлось использовать старую утилиту То есть у неё есть более новая версия на пришлось использовать старую потому что почему-то в новой версии получается битый бинарник на архитектуре mips размеры биков получились вот такими есть стада утилита которая занимается автоматизацией весит 2 с по почти мегабайта zb утилита 2 МБ Bluetooth чуть больше мегабайта утилите для общения с облаком 900 КБ и Z3 gway Host от компании Silicon laps 850 КБ наши же Две версии под ARM и под mips получились чуть меньше мегабайта каждая и напоследок я те рассказать вот о таком устройстве это колонка Яндекс Mid они выпустили её совершенно недавно А и примечательно В этой колонке то что на ней есть локальное голосовое распознавание А и написано оно на Go А то есть внутри этой колонки также есть процессор ARM помимо этого там есть нейроуридин нейросетей есть Татьяна хаб вот здесь вот есть ссылка где команда Яндекса подробнее рассказывает про свой опыт работы то есть у них Облачное распознавание тоже написано на Go и у них была цель взять вот их наработки на Go и просто поместить вот в маленькое устройство чтобы в нём работало всё точно так же как в Облаке Конечно они ВС сильно очень пором потому что никак ч приложение не помещалось в эту колонку но в итоге у них получилось и есть ещё один такой пример что на Go очень активно В принципе пишут для вот встраиваемых умных устройств в том числе голосовой управление локальное голосовое распознавание и управление устройствами У меня всё если понравился мой доклад можете за него проголосовать Спасибо большое за доклад Есть ли вопросы в зале Если у вас есть вопрос поднимите пожалуйста высоко руку для того чтобы мы к вам подошли вы могли задать этот вопрос В микрофон чтобы вас все слышали А я вижу вопрос в первом ряду Сейчас одну секунду Так секундочку Вас не слышно Андрей помоги пожалуйста перемещение по залу технические накладки бывают к сожалению всегда ничего не нажимайте просто говорите так слышно Теперь Спасибо за доклад большой ээ Вопрос такой Почему гоу а не раст например или какой-то другой язык Ну во-первых банально я ра не знаю а во-вторых Лично мне может это кого-нибудь обидит очень пугает синтаксис языка раст когда я вижу как кто-то пишет код на раз мне кажется там автор дьявола вызывает и как только он нажмёт на компиляцию там демоны ада начнут выползать из преисподней вот более мой язык хорошо а второй вопрос Если можно вот вы каширу ете запросы к облаку это значит они статичные в основном да ну ответы много повторяющихся запросов допустим если шлюз видит устройство с некоторым маком он просто спрашивает облако а принадлежит ли это устройство данному пользователю то есть там он же может фактически соседское какое-нибудь устройство обнаружить облако ему отвечает допустим да принадлежит потом выдаёт специи Я к тому что в принципе А можно вообще отвязаться от облака сделать какой-то там МОК Или как это назвать заглушку чтобы когда решат что Россия напала там нами и запретят пользоваться облаком чтобы это вс не пропало можно вш пое будет работать проблема в том что вот допустим Bluetooth датчики вот такие вот классические они при первом подключении к экосистеме хом просто на него зашивается ключ шифрования То есть вы в любом случае должны подключить его через мобильное приложение к облаку чтобы А на датчик попался ключ на датчик записался ключ шифрования для общения Когда вы знаете ключ шифрования Вы можете им пользоваться Вот вот здесь есть такой вот минус для Bluetooth наверное не получится для zb кстати получится для zb я вот упоминал что используется чип efr32 там есть вот приложение от силикон лапса и с помощью данной интеграции можно подключать вообще любые устройства от любых производителей в стандартно стандартном режиме работы шлюза то есть шлюз на это никак отрицательно не реагирует Спасибо большое за вопросы ещё один вопрос из зала Здравствуйте Меня Роман зовут А у меня наверно такой больше личный вопрос Вот вы разрабатываете решения какие-то для умного дома какая архитектура умного дома ва устройства вы используете и каких стараетесь Ну пре там zb Bluetooth wi-fi Угу Хороший вопрос Аа в принципе я как раз в основном и использую все мои интеграции То есть те интеграции которые я пишу в основном я и использую даже может быть когда в будущем Я бы мог хотеть передумать там перестать их использовать а использовать что-то другое мне всё равно приходится их э продолжать использовать Потому что если я от них откажусь уже поддержка поддержка их просто затупок использую их устройства zb тузы вот ну и в других интеграция которые я пишу Да тоже тоже те те устройства использую А можно вот вы от Горите что используете шлюзы с Xiaomi А почему бы не использовать там Son Zig вместо внешнего шлюза простого воткнул в расбери там или в ПК Где у вас Умный дом вы имеете в виду кно Угу Хороший вопрос смотрите здесь идея это в чём на самом деле то как работает шлюз зби то как работает Стик зби по факту сильно не отличается если человек в принципе понимает как работает эта технология ево камни он сможет спокойно работать с Любой с любым железом или стиком или шлюзом и тому подобное если человек не понимает все подводные камни зигби у него допустим может работать Стик хуже чем вот данный шлюз Ну банально потому что знаете у usb3 есть сильные наводки Наби не все это понимают не все это знают если они просто воткнут свой сервер в котором подключен какой-нибудь там жёсткий диск по usb3 у них сеть будет сильно лажать А шлюз в данном случае не будет ложать потому что скорее всего пользователь поставит его в какое-нибудь место где нет рядом Вот таких вот проблем Так что в опытных руках совершенно неважно какой технологией пользоваться любое будет работать Отлично спасибо А часто возникало желание отказаться от используемых ты вот сказал что ты не можешь потому что тебе нужно поддерживать А желание было Ну да да бывает бывает периодически некоторые вещи приходится пользоваться вот данный устаревший шлюз в нём есть некоторые железные проблемы у первого шлюза есть прям архитектурные проблемы нерешаемые потому что они там есть на уровне железа и мне всё равно приходится его использовать я использую его с такими устройствами где от этого меньше всего боли но всё равно продолжаю использовать потому что очень много пользователей этого шлюза Я бы с удовольствием перешёл вот на второй о нём забыл Но приходится приходится страдать ради ради ради людей страдания возвышают Есть ли ещё вопросы в зале поднимайте пожалуйста руку повыше Помните о том что у каждого участника конференции есть возможность выиграть матрёшку уникальную за лучший вопрос и собрать целую коллекцию матрёшек сейчас вопрос зала Спасибо за доклад интересн было Вопрос такой что Правильно я понимаю что можно взять с гитхаба вот ваши наработки и накатить практически на любое железо где есть там Bluetooth нет на совершенно любой не получится это работает только вот с данными шлюзами Xiaomi которые вот три я упоминал Но на самом деле шлюзов там прилично больше просто они менее поляр у на в ране поэтому я их и не покупал для тестов Но это ВС будет работать только с К сожалению только с этими шлюзами Спасибо ещё вопросы Спасибо за доклад я хотел поинтересоваться вы упоминали проблему вендер Насти в том числе ваша разработка призвана е частично решить НС в том насколько я понимаю требует разворота у себя персонального сервера умного дома да Что опять же требует некой технической подход у человека есть ли перспективы какого-то развития в направлени того чтобы это стало доступно для условно моей бабушки чтобы она могла там в пару кликов запустить у себя на какой-то железке что-то универсальное какой-то шлюз эмулятор который заставит условную яндексовский с ними что-то полезное Хороший вопрос да и у меня есть на него ответ А конкретно эта штука наверное не подойдёт бабушке я сам а перед такой проблемой сталкиваюсь и вот э я бы условно бабушке не стал бы ставить это решение Я бы условно поставил Алису от Яндекса с меньшей головной болью с меньшей необходимостью поддержки этого всего там было бы конечно намного меньше функционала Но оно бы кое-как работало там из коробки то есть поддержка этого всего это сильная головная боль К сожалению немножко не до конца я наверное правильно сформулировал суть вопроса А есть ли перспектива тому что рано или поздно появится некое опенсорс нае решение которое можно будет относительно безболезненно интегрировать с популярными нми я этой перспективы не вижу есть очень много оных решений которые нацелены на пользователя но вы всегда платите за универсальность и большие возможности То есть это вот прям такая Прямая С одной стороны у нас есть универсальность простота и мало функций Агой стороны у нас есть безграничные возможности вот у Home ассистента безграничные возможности и вы можете там чуть-чуть сил потратить на его изучение и получить немного возможностей можете ещё больше сил потратить получить больше возможностей можете там несколько месяцев изучать что-то и решить абсолютно любую задачу с ну с помощью него но чтобы такое появилось именно в опенсорс я я не вижу предпосылок к этому Вот большие вендоры вроде там сбера Яндекса и тому подобное они к этому движутся Ну это понятное дело это не Open Source у них есть такой хороший баланс а а функционала и простоты в опенсорс такого не вижу Спасибо А ты бы Хотел взяться за эту задачу что А ты бы Хотел взяться за эту задачу М нет нет Мне очень нравится вот пользователи хо асин потому что это в home Assistant приходят люди которые уже переступили вот этот вот порог входа сложности установки умного дома это те люди которые готовы читать документации готовы получить Умный дом помощнее чем это предоставляют вот облачные платформы вот и уже понятно с какими людьми ты начинаешь работать но это не всегда программисты там очень много Конечно айтишников действительно именно айтишники туда идут и люди там под подкованный время очень часто начинают появляться и люди совершенно далёкие от it то есть самое сложное для них - это вот установить сервер умного дома а дальше какие-то вещи можно решать и без без особых технических знаний главное главное желание человека не какие-то конкретные знания а просто желание банально прочитать что-то вот очень многие люди в последнее время просто разучились читать Спасибо большое Есть ли ещё вопросы в зале я вижу вопрос Давайте дадим микрофон Встаньте пожалуйста чтобы мы вас видели Спасибо за доклад такой вопрос почему нигде нет запроса на отказоустойчивость то есть вот есть такая проблема допустим начина уровня у есть шти но это всегда один роутер или там допустим у нас есть mqtt но это всегда один конкретный брокер То есть как было так сделать чтобы было множество устройств в доме которые могли бы организовывать кластер как раз таки как вот у вас было упомянуто в одном месте и Отказ устойчиво работать то есть у меня вот конкретно личная Боль то что это периодически падает и это всегда одно устройство вообще такой запрос есть но решение довольно трудоёмкого тох решений которые работали из коробки наверное на данный момент нету у фирмы akar были анонсы вот буквально недавно что их новый вот хаб третьей версии сможет подхватывает вот других другие хабы если там случайно они упадут он сможет на себя перетянуть вот эти вот зби устройства которые там висели и тому подобное а к примеру технология Bluetooth Чем хороша Я не понимаю почему все так активно пропагандируют зигби а но не пропагандирует Bluetooth Наверное потому что просто не умеют для него программировать вот а датчики на Bluetooth Они же не привязаны к конкретному шлюзу и поэтому вот Xiaomi А где-то 2 года назад полностью отказала от продвижения технологии зби и сделала большую ставку на ш у них Пока это так с точки зрения стабильности плохо получается но движение в этом есть у блютуза нету связи точка точка то есть куча шлюзов может получать данные со всех устройств которые они видят и в том числе я рассказывал вот это вот утилита н Контрол когда шлюзы собираются в кластер там выбирается мастер на мой взгляд сделано именно для этой цели чтобы просто огромное количество шлюзов у пользователей не бомбардировать один и тот же сигнал от датчика они просто бомбардируются облако этой информации А когда они собираются в такой кластер отсылает именно главный шлюз а остальные уже пересылает данные главному и главный принимает решение Вот это работает на у технологии Bluetooth вполне вполне Хорошо Спасибо большое у нас к сожалению закончилось время на вопросы Но помните что дальнейшее обсуждение разговора о будущем прошлом и как куда это всё будет двигаться можно провести в дискуссионной зоне куда отправится докладчик сразу после доклада давайте выберем вопрос который вам понравился больше всего и подарим подарок от конференции ну Давайте вот выберем последнего докладчика на личную боль и отказоустойчивость как бы да он не один с этой личной болью прекрасно поднимите пожалуйста руку чтобы мы вас нашли вручили вам подарок вас Мы тоже Хотим поблагодарить Большое спасибо я второй слу второй раз слушаю ваш доклад и Это второй раз очень интересно на более жизненные темы и не только про корпоративную разработку Можно я пож руку Спасибо"
}