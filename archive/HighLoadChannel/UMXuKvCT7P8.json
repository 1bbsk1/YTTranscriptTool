{
  "video_id": "UMXuKvCT7P8",
  "channel": "HighLoadChannel",
  "title": "",
  "views": 0,
  "duration": 0,
  "published": "",
  "text": "Всем привет С вами Андрей Смирнов и п+ 2024 и сегодня с нами Алексей журков руководитель направления энд команды витрины антеа н лш Привет Привет Расскажи пожалуйста чем ты вообще занимаешся Что входит твои обязанности Ну вообще вки я уже прол ть от до руководите направления мы с командой занимаемся тремя стримами это и Энд витрины это и это и удалённый конфиг и а разбивал и дело в том что для построения персональных витрин необходимо работать с данными с большими данными от пользователей Вот и одно из направлений вле внутри это поставка данных свой приёмник событий парсинг валидация А что за приёмник событий что что он делает такого А это свой приёмник событий он необходим для того чтобы принимать все продуктовые события которые мы получаем от клиентского по вот когда пользователь заходит или запускает заходит на сайт да Или запускает приложение а летит какой-то продуктовые события более подробно например разбит на продуктовый вертикали каждая продуктовая Вертикаль у там есть продакт менеджеры продакт-менеджер свои разработчики и свои продуктовой аналитики вот продакт-менеджер следит за продуктом с помощью продуктовых событий то есть оцифровывать какие-то события и получает получают графики и показания А можно пример какой-нибудь продуктового события Ну например когда пользователь там зашёл в карточку фильма и нажал на кнопку Play Да вот или как Да перешёл а нажал на стоп и вернулся на страницу назад или авторизация а или просто показ витрины вот мы знаем А какому пользователю какую витрину показали А куда он зашёл или какую полку смотрите также внутри карточки показали Вот это всё летит Э мы собираем данные летит свой приёмник событий для того чтобы мы могли лучше работать с пользователями и делать строить обучать модели Да а показывать персональные витрины принимает ли ваш приёмник только продуктовые события или там ещё какие-то бывают Да там не только продуктовые события мы принимаем потребность аппетита растут и мы сейчас ещё и технические события принимаем например разработчикам клиентского по очень интересно знать что происходит у пользователей Сколько памяти занимает то или иное плюс ещё там по таймингом время работы Вот и есть продуктовые логи логи приложений Вот иногда они могут включить и чтобы собрать какую-то статистику и наметить пути улучшения продукта Сложно ли это всё при этом по архитектуре потому что ну кажется что приёмник событий всё что делает это вот ну должен просто обрабатывать какой-то большой набор данных в себя принимать и где-то собирать и как бы всё звучит довольно просто если там какие-то подводные камне изначально кажется так причём ещё интересно то что изначально мы использовали другие решения от больших it гигантов Вот но решили написать своё а и а почему И в какой момент решили что решение от it гигантов не подходит оно очень хорошее но есть ряд недостатков во-первых это лимитирование вот с с этим можно жить но если возникают какие-нибудь потребности например выгрузить за какой-то исторический день Вот то тогда может страдать текущая информация то есть нужно будет ждать пока очередь очистится и пока именно у сторонних решения Да ну вот нужно ждать пока лимиты пройдут вот поэтому мы вот написали своё решение Вот это одно из то есть лимиты а второе например для некоторых платформ просто нам нужно в реалтай получать данные но Готовое решение дают дают например раз в сутки выгружать данные и нам приходится ждать Окей А вернёмся Да к архитектуре насколько он вообще сложный в устройстве да для чтобы его написать мы так и сделали то есть взяли самое простое решение то что что он должен делать принимать принимать информацию и записывать это в каку можно было взять нибудь веб-сервер который можно тоже модуль написать и который тоже бы писал вот но Нам нужна дополнительная логика то есть мы знали что нам она нужна будет потому что например Мы хотим пускать там прикрутить config то есть удалённая конфигурация чтобы мы могли в реальном времени что-то изменять во-вторых Мы например хотим пускать по разным путям разные данные Ну например логи там в один Тобик писать продуктовое событие в другой Где в одном топике там больше а в другом меньше Вот то есть другие требования Вот и этот топик уже другие потребители считают Вот то есть прикручивают дополнительную логику в этом вот проблема изначально мы взяли и написали два mvp на питоне и на Go вот самые простые самые простые то есть они принимали события И записывали в каку выб То есть все питани все пенистые на Go и если будет какой-нибудь повод они с удовольствием что-нибудь на Go напишет Вот А ну собственно Мы тоже вот взяли для mvp и проверить хотели проверить насколько будет выигрыш если мы по производительности по производительности Да вот взяли питон который 311 это версия релиза которая получила уже большою большой прирост производительности Вот и взяли Go использовали в питоне это асинхронный фво и в сервер нагрузили сравнили и получили что на одно ядро микросервис на питоне где-то 800в записывает выдерживает с нормальными таймингами А на Go чуть больше 4000 вообще ожидали что разни будет примерно в 10 раз че вот и так как мы знали что там нужно будет ещ логику прикручивать и на питоне это всё гораздо быстрее делать Вот мы у каждого Рания конечно свои плюсы плюс ещё у питона свой Сваг на фпи он отличный В отличие там от шно вот на нём на питоне намного быстрее и проще приятнее свои мысли переводить в компютерный язык програми Мы решили В общем остави на на питоне и реализовали реализовали микросервис именно на питоне Может ли случиться такое что вот этих 800 пив вам в итоге будет мало и придётся всё-таки Наго это переписывать Ну на самом деле масштабирование там очень простое одно пода одно пода питона занимает там 200 МБ вот и она держит 800 пив нам Мы посмотрели нашу максимальную нагрузку там когда какое-то пуш уведомление там перед Новым годом какой-нибудь Вот и достаточно плюс ещё добавили какую-то Дельту вот достаточно держать было 6.000 псов вот и получается нам нужно меньше дети подов то есть это всё А масштабируется горизонтально Это недорого это абсолютно недорого в сейчас в смартфонах больше оперативной памяти Окей А вообще вот с учётом такой вот истории интересной получается на питоне можно реализовывать вполне нагруженные сервисы сейчас с учётом последних обновлений или всё ещё нет А дело в том что в Python регулярно завозят интерпрайз Насть Да там производитель в питоне повышаться будет с каждым релизом А и ещё интерпрайз там завозят и подсветка синтаксиса входные выходные значения дата классы очень быстрые плюс есть там такие там модули как пайда которые второй версии тоже в пять раз ускорился но не всё можно реализовать на питоне например раздачу видео работа там с бинарными данными Я бы на нём всё-таки не делал вот а смотрел бы на другое решение там мне кажется отлично подходит к этому О'кей А и напоследок какой вообще дальше возможно план у вас на этот приёмник событий то есть собираетесь ли вы как-то добавлять туда ещё какую-то функциональность и ещё его шби что-то ещё интересное с ним придумывать Да мы постоянно добавляем разную функциональность и благодаря чему наш продукт уже начал улучшаться то есть там ребята смотрят метрики которые Они снимают и некоторые моменты сильно улучшают по производительности будем добавлять в зависимости от потребностей продукта И развивать его свой приёмник своё решение даёт огромную гибкость А мы это делаем на питоне у нас Time to Market очень маленький за счёт этого гораздо меньше чем например Time to Market у Фронтовых разработчиков Да которые там нужно чтобы спринт закончился чтобы тесты все внутренние прошли потом тесты в стора вот а у нас Time to Маркет например в фиче одной был 2 по часа когда мы очень нужную фичу до катили до прода со всеми тестами и другими процедурами За 2 с по часа это вот всё благодаря питону будем развивать в зависимость от потребности продукта супер Лёша Спасибо большое за подробный интересный рассказ про ваш собственный приёмник событий С вами был Алексей журков Я ведущий Андрей Смирнов пока-пока"
}