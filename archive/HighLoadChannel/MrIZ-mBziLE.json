{
  "video_id": "MrIZ-mBziLE",
  "channel": "HighLoadChannel",
  "title": "",
  "views": 0,
  "duration": 0,
  "published": "",
  "text": "Всем привет Добро пожаловать на кр девайсов здесь мы рассказываем Как оптимизировать модели как и оптимизированные модели И сегодня я вам расскажу о том как эти модели можно создать как их можно использовать и как можно использовать не только модели А ещё кое-что очень интересное Ну давайте сразу же расставим все точки над и устройствами с помощью жестов систему сделать очень просто Вот пример Мы хотим сделать управление с помощью несколькими динамическими жестами например свайпы вправо влево вверх вниз и как это сделать мы собираем большой датасет далее мы этот датасет на этом датасете обучаем большой 3D трансформер для того чтобы обучить 3D трансформер мы арендуем целый DX из 161 видеокарт и на выходе 3 200 миллисекунд скорость Ирен на ГПУ или примерно пол секунды Ирен на CPU Профит всё решение готова Ура круто бежим к тем ляду показываем результаты Но если ничего этого нет что если у вас нет датасета нет денег на аренду видеокарт и нет просто времени чтобы учить такие большие модели и не начем их инфи И помимо этого вам нужно запустить решение с ограничением 15 мсн скорости работы ня зовут Александр Я техлит в команде нди компьютерного зрения и сегодня я вам расскажу как сделать такую систему достаточно лёгкой простой для того чтобы её можно было интегрировать в любое устройство с любым процессором А план доклада у нас выглядит нестандартным образом Сначала мы поговорим немного про мотивацию про теорию про данные и самое сложное это модели мы немного углубит моделей разберём их и что они из себя представляют Ну Далее продемонстрируем вам итоговое решение разберём результаты и кое-что интересное напоследок Итак начнём с мотивации А я думаю вы видели управление жестами например в например в сериале в очень-очень популярном Где главный герой просто смахивал карточки взмахом руки справа налево и тем самым управлял Ну как-то интерактивно управлял тем что происходит на экране помимо этого управление жестами пригодится на кухне Когда вы что-то готовите у вас грязные руки и например ваше устройство не оборудовано микрофоном для того чтобы можно было ему сказать вызвать голосового ассистента Либо вы готовите ночью как это обычно делаю я и вы не хотите шуметь также управление устройствами уже реализ некоторыми автопроизводителя в головных устройствах своего их автомобилей это удобно и позволяет управлять какими-то функциями магнитолы и автомобиля не прикасаясь к сенсорному экрану Здесь был такой кейс так как главные устройства автомобилей развиваются всё меньше и меньше Вы можете замечать на главной панели именно кнопок физических всё переходит в интерфейс сенсорного экрана и и разобрать где там эта кнопка достаточно сложно особенно на ходу и управление жестами поможет решить эту проблему следующее - это медицина например Интеграция управления с помощью жестов устройствами которые используются в хирургии в не знаю в сборе анализов и в разных разных разных сферах медицине позволит как минимум уменьшить риск инфекций так как у нас всё очень строго доктора в перчатках и касаться каких-либо поверхностей Ну хочется как можно реже Ну и последнее в принципе управление жестами можно реализовать где угодно и использовать где угодно например в умном доме в A гарнитуре да про Apple Vision Pro Мы знаем об этом расскажу чуть-чуть попозже а ну и например интеграция в свою камеру которая у вас Просто может находиться дома и привязать экшены какому-либо действию Ну теперь давайте немного теорию жестов какие они вообще могут быть жесты можно разделить на две категории статичные жесты и динамические жесты статичные жесты - это Например Когда вы слушаете музыку и хотите сохранить свою подборку можете показать просто лайк на устройство и он сохранит это в подборку либо не знаю с помощью жеста поставить паузу и так далее То это просто константные какие-то жесты жест это Например свайпы перелистывание справа налево каких-либо карточек либо экранов Vol - это когда вы можете например с помощью просто указательным пальцем увеличивать громкость либо уменьшать громкость зумы это Например можете увеличивать картинку уменьшать картинку и Drop это когда вы можете что-то схватить виртуально на вашем экране перетащить е в другое место и положить вот Окей с этим понятно наших работ уже реализована часть статичных жестов это датасет в котором 18 классов и некоторые из этих классов можно прямо сразу же использовать для интеграции в устройство например для лайков то есть для статичных жестов Но для динамических жестов таких просто нет дасе Давайте разм вообще что из себя представляет динамический жест Ну в первую очередь нам нужно понимать Как расположена рука далее нужно определить жест руки то есть статичный жест далее нам нужно определить движение руки а то есть в какую сторону движется рука и откуда она движется и у динамических жестов в основном есть начало и конец то есть например у свайпов есть рука справа рука слева Там сверху вниз сверху вниз вот у драгандропа есть схватить в одном месте отпустить в другом месте для некоторых динамических жестов начало и конец - Это один и тот же статичный жест Вот пример Мы хотим реализовать свайп вправо Это значит что мы должны распознать руку которая показывает вправо точнее влево и потом распознать руку которая показывает вправо строго в такой последовательности как это сделать Ну в первую очередь нам нужно найти наши руки присвоить им определённые классы распознать жест и после этого распознать сам переход от одного класса до второго Теперь давайте поговорим поподробнее про данные где брать данные и как их использовать для создания системы распознавания динамических жестов есть некоторые характеристики и требования к датасета для того чтобы реализовать такую систему в первую очередь нужен датасет для решения задачи детекции рук Что для того чтобы распознавать классы рук нужно их сначала найти Далее в должны присутствовать статичные жесты для того чтобы мы могли сразу же присвоить определённой руке класс статичного жеста и потом привязать к нему второй класс для распознания динамики и DC должен быть максимально разнородные это нужно для того чтобы ваше решение работало очень-очень хорошо на разных устройствах с разными типами камер разрешений освещённости и так далее То есть датасет нужно нужно чтобы он был максимально максимально разнородны такой датасет у нас есть кстати небольшая большая Ремарка наш датасет в своих разработках использует компания Intel для запуска Ирен моделей с помощью Open фреймворка и Google mediapipe Я думаю вы все знаете Med Pipe у них есть хорошее решение для распознавания ки поинтов и они доучился жестов и имеет максимальную разнородность вы можете посмотреть на примерах что у нас разнородная яркость разнородность субъектов размер боксов на самом изображении и разметка что включает в себя разметка в первую очередь она что самое важное включает в себя сам бадин бокс координаты и л жеста на некоторых разметка могут присутствовать два баун бокса где один бадин бокс присвоен определённому жесту а второй э для fse позитива так называемого это просто не жест Теперь давайте поговорим про модели Ну как я сказал с самого начала Мы можем взять архитектуру 3D любой модели подать ей на вход тензор из например Мише кадров и она нам выдаст какой-то класс сразу же но у данной архитектуры есть небольшие так сказать минусы эти минусы - это во-первых нужен специфичный датасет То есть Вам нужен датасет видео с размещенным началом и концом самого динамического жеста после этого этот досе нужно предобработка ваш тензор увеличивается на ещё одну размерность и обучать на какой-нибудь лёгкой карточке с маленьким количеством видеопамяти уже не получится и они очень очень долго работают на CPU э в силу своей вычислительной сложности то есть 3D свёртки работают Достаточно долго Ну плюсы то что они очень хорошо учат контекст потому что они захватывают несколько кадров целиком сразу же их обрабатывают и показывают очень хорошее качество в распознавании далее ключевые точки мм я думаю не секрет что в arvr гарнитура используется распознавание вот каких-либо жестов с помощью точек Почему распознавание точек не подходит для нашего решения во-первых для того чтобы предсказать какой-то класс нужно провести Примерно вот такую череду манипуляций с проведением условий над точками чтобы понять что действительно тот жест который вы хотите показать он сейчас показывается и такого хардко будет очень-очень много и масштабирование практически нереально далее точки как бы включают в себя очень большую информацию про руку про положение каждого пальца работают достаточно быстро но есть очень большие минусы высокая вычислительная стоимость то есть само решение с распознаванием точек оно двухста дейно оно ну предсказывает точки эти точки нужно дополнительно обрабатывать есть проблема в том что если вы находитесь далеко от камеры ваши точки начинают склеиваться они дрожат и нужен размеченный датасет а размечается очень дорого На самом деле поэтому от данного решения мы отказались и Мы приняли решение использовать детекторы Давайте поговорим про детекторы У нас есть критерий Мы хотим чтобы наше решение было очень-очень быстрым оно весило минимальное количество веса весили минимальное количество и они умели находить маленькие объекты Да У некоторых детекторов есть проблема в том что они хорошо находят большие объекты какие-то находят маленькие объекты вот у нас был критерий что мы хотим чтобы набо расстоянии человека от камеры адекватном расстоянии конечно же ваша рука вводилась B BX какие есть типы детекторов Ну вообще их всего два типа есть двустенные детекторы Давайте разберём их по порядку двухста дейный детекторы например rcnn fnn Faster The Faster CNN очень обожаю их нейминг net и детекторы на основе Трансформеров де плюсы у них - это очень хорошая вычислительная точность ой высокая точность большая гибкость и адаптивность то есть они могут адаптироваться под например практически любое разрешение особенно трансформер архитектуры и хорошая локализация объектов минусы же медленная работа так как двухста дены детекторы состоят из кна и детек регрессионной головы высокая вычислительная стоимость относительно того какой кбо использовать зависит ваше качество и вычислительная стоимость и сложность обучения потому что хоть вы и Учите детектор как единую сеть у вас всё равно по отдельности учится н для распознавания фичей на изображений а далее учится детектор одно стадийный детекторы это SSD ла и я сюда дописал с интернет Но он конечно немножечко отличается плюсы вычислительная скорость они достаточно быстрые так как там детекция голова интегрирована по сути в кн меньшая вычислительная стоимость нужно проводить меньше операций и достаточно хорошая локализация Потому что одно соеди детектор используют так называемые якоря это когда вы на фичей картинке ищете изображение например вытянутое по вертикали по горизонтали Квадратное и так далее но к сожалению у них меньшая точность так как они привязаны к якорям и есть небольшая сложность МАМИ сложность с маленькими объектами заключается просто в том что Одди детекторы обрабатывают несколько карт признаков которые идут по порядку и например на больших карт признаках они могут найти маленькие объекты на маленьких карт признаках могут найти большие объекты какой же детектор мы выбрали Как вы думаете ну я предполагаю что вы подумали про лу так как это очень хорошее решение есть та кото Мега но нет Есть ещё один детектор о котором мало кто слышал и честно я не видел чтобы его где-то использовали это rfb net что он из себя представляет расшифровывается название как receptive Field Block на самом деле он очень-очень похож на архитектуру SSD Вот пример сверху можете видеть архитектуру стандартного SSD а снизу rbn отличаются они только тем что SSD вает напрямую фичи и предсказывает в этих фича например с больших фич карт он предсказывает маленькие объекты с маленьких фика предсказывает большие объекты rbn после фичей встраивается дополнительный блок что этот блок делает и какой Импакт он приносит авторы подумали что Ну вот мы можем находить на больших карт признаках маленькие объекты на маленьких большие а почему бы не попробовать находить всё вместе и причём в разных картах авторы провели небольшое исследование с точки зрения биологии Как Ваши глаза смотрят на объекты и пришли к такому выводу что есть три типа взгляда на вещи Например если ваш коллега пришёл в новом стиле вы можете увидеть какие у него классные запонки на рубашке Либо вы можете увидеть его всю рубашку оценить Её какая она классная Либо вы можете оценить весь его стиль начиная от рубашки брюк - ремня и ну как бы смотреть целиком и авторы интегрировать вот эти вот три понятия в архитектуру в свой rfb блок он представляет из себя три параллельных свёртки от меньшего к большему Следовательно мы можем на Большой фич мапе искать маленькие объекты средние объекты и большие объекты После этого мы просто все эти три фич мапы все кантим друг на друга и получаем вот то что вы можете увидеть справа это некоторая хит мапа объекта вот здесь вы можете увидеть что на Большой фич мапе найден маленький объект Вот у него в центре очень-очень много информации если бы это был бы какой-нибудь Большой объект то у нас было бы наоборот самая большая чпа была бы самая яркая а самая маленькая она была более тусклой интеграция такого блока позволи во-первых увеличить количество самих якорей то есть бадин боксов которые можем предсказать количество параметров у данной модели около 4 млн и вычислительная сложность 696 мепс скорость работы 24 миллисекунды Вау это прям Это очень хорошо и Окс модель весит 11 МБ И вот пример Как работает блок например на Первом кон слое мы изх призна Превращаем их в 64 карты признаков Ну кажется что это прям много и мы подумали что можно немного ужа эту сеть и сделали уменьшенную версию вместо че карт признаков мы сделали 16 Следовательно фичей стало меньше значит кре мы можем предсказывать меньше количество кре уменьшилось в три раза до 442 количество параметров умело более чем в 22000 параметров и вычислительная сложность 53 мегало скорость работы 4 миллисекунды на Intel CPU на Маке тести и веса модели весит 1,1 МБ кажется Вау это прям очень-очень хороший результат как мы учили нашу модель так как состоит из статичных жестов и в основном все жесты направлены вертикально нужно чтобы модель выучила разные вариации мы крутили изображение ИЖа вырезали вставляли использовали мозаику аугментации и некоторые аугментации для изображений обучали нашу модель три эпохи училась модель 2 дня на одной видеокарте 380i и получили метрику 65% что достаточно хорошо по сравнению с этой моделью yola Tin показывает результат 72 Min precision но она больше примерно в три-четыре раза демо работы детектора видео к сожалению не запускается вот здесь вы можете увидеть как детектор отрабатывает и находит руки и работает это Ну достаточно быстро и хорошо далее классификатор какие у нас были критерии классификатора Ну так как мы находим руки нам нужно теперь предсказывать Какие жесты эти руки показывают Почему Я думаю вы задались вопросом почему нельзя сразу же детектором предсказывать классы Ну ответ достаточно прост Когда вы учите детектор на предсказывали каких-либо Вот например жестов то он будет предсказывать только жесты то он будет предсказывать те признаки те руки которые показывают именно эти жесты а нам нужно было чтобы мы находили руки и если например даже классификатор не отработает Нам же хорошо Главное не терять наши руки критерии классификатор должен быть легче детектора классификатор должен работать быстрее чем детектор и должна быть очень-очень простая архитектура Потому что есть очень много разных вариаций классификаторов resnet это достаточно тяжёлая архитектура для конвертации интеграции в любое устройство нам нужна была лёгкая Я немного посечи и выписал здесь все кбо которые я только мог вспомнить и найти их очень-очень огромное просто количество но Мы помним про критерии и Давайте в первую очередь уберём все трансформер нае архитектуры потому что они очень-очень тяжёлые по вычислительной сложности далее Давайте уберём большие вариации архитектур моделей Ну так как они много весят вычислительное после этого уберём глубокие версии сериз Ну и к сожалению после этого пришлось отказаться и от resnet и от wg и у нас остались самые-самые лёгкие это Две версии mobilenet третья вторая и Две версии Mobile One но Мы помним про наши критерии мы знаем что у нас веса оник модели детектора 1,1 МБ И к сожалению ни одна из этих моделей просто не подходит под наши критерии и здесь у меня просто опустились руки я отложил эту задачу на попозже и пошёл в чат к своему Тим Лиду показывать Результаты работы детектора вот оказалось что детектор работает достаточно хорошо на расстоянии примерно 2-3 М Вот можете увидеть результат после чего я получил такое предложение а Попробуй сделать классификатор на 200 КБ Ну если здесь есть такие очень-очень углублённые техники вы понимаете что это очень маленькое количество параметров дол Ну да я так подумал что действительно наши кропы они достаточно маленького размера Они в любом случае будут меньше примерно раз в пять чем само исходное изображение но я был в шоке когда он мне предложил обучить линет которая была придумана Яном куном ещё В девяносто восьм году Нуне - это такая архитектура которая позволяла Ната предсказывать рукопис Циферки Я думаю кто связывался с компьютерным зрением самая первая ваша модель - это была linet и задача распознавание именно вот цифр но у лита есть проблема потому что цифры grecale один канал А у нас RGB и что с этим делать пока что непонятно Но я задумался и попробовал Дать шанс этой модели Давайте посмотрим на исходную версию я имплементировать есть в статье как её описал Ян кун Она состоит из двух свёрточные трёх линейных слоёв функция активации пулинг кажется что она выглядит очень-очень старой модель такой сейчас просто не пишут Давайте немного её освежим и функцию тангенса которая достаточно вычислительное заменим на привычный пулин которые размазывать градиенты по всему тензо также заменим на Макс пулинг для того чтобы можно было давать больше информации про те фичи которые выучит модель и давать им больший вес время обучения Теперь кропы у нас есть кропы наших рук мы знаем что исходное разрешение linet 32 на 32 Ну разрешение достаточно маленькое поэтому Ну мы Нам нужно будет в любом случае немного увеличить архитектуру и мы знаем что в нашем кропе больше 70% это это наша рука Давайте перепишем linet первый слой первый кон в слой мы заменим на такой мы вместо одного канала принимаем три и делаем йд для того чтобы немного ужа сеть После этого мы добавили два новых кон слоя которые принимают шесть и 16 каналов со страй дом два в первом случае во втором случае с ядром свёртки три для того чтобы побольше забирать информации и добавим три линейных слоя Первый из которых просто принимает э flaton фичи из кон слоя и последующие два линейных они исходные так же как было в ли нете и вот полная архитектура модели linet Hand как она работает мы взяли 18 статичных жестов из до Сета hret добавили три новых жеста это рука вправо влево вниз и обрабатываем кропы чом так как детектор может находить несколько рук мы их просто стакая друг с другом Превращаем в бач и отдаём на вход линет что она из себя представляет а как как мы учили наш линет Да мы брали кропы и просто поворачивали их Аугментин так как предсказание детектора - это вытянутые бандинг боксы и когда мы их сжимаем в квадрат они могут бы ваша рука немного искажается модель училась 3 часа на видеокарте 380 училась она четверть эпохи просто Потому что очень-очень много примеров было в данных и модель просто переобулась и получили метрику на ial 97 по F1 это достаточно хороший результат и Вот наши модели rfb детектор который у которого скорость работает 4 миллисекунды и весит 1,1 МБ И linet у которого скорость работы исчисляется менее чем миллисекунда и вес Окс модели меньше чем даже запрашивал мой лит 140 КБ я отправил своё решение я потратил на 5 часов на написание сети её обучение показал результаты оказалось что это была шутка Это была просто шутка не делайте так никогда своими подчинёнными Пожалуйста но это шутка которая выстрелила и в нашем решении используется именно эта архитектура Вот пример работы классификатора На таком расстоянии вполне неплохо распознаются два жеста Стоп они обрабатываются в баче далее проблемы наш детектор Ну потому что руки могут показываться в такой форме которую не видел никогда детектор и их можно просто потерять мы не знаем какая рука показывает жест и у нас есть много рук в кадре Ну как понять какая из них вообще что-то показывает эту проблему решает трекинг трекинг - это такая задача которая стоит параллельно с задачей детекции например объектов на видео все трен за осно в основе всех трекингом лежит Кама фильтр это такой алгоритм который позволяет вам сгладить ваше пространство каких-либо точек и предсказывать будущие точки относительно поведения предыдущих есть три вариации трекинга Ну вот я взял архитектуру сорт трекинга давайте я про них коротко расскажу первый сорт он быстрый простой но к сожалению он теряет объекты когда один объект попадает за второй Он просто исчезает А когда появляется заново ему присваивается новой ID deepsort - это небольшая модификация когда мы используем вместе с простым трекингом ещё и фичи того что у нас внутри он тяжелее чем простой сорт так как там используется кбо и последнее - это OC сор он такой же как сорт но решается проблема потери рук решается она так что когда объект попадает за второй он не исчезает он не удаляется из очереди А ему присваивается небольшая вероятность того что он действительно за каким-то объектом и после того как он появится то мы ему псо тот же самый класс какой у него и был Итак вот все плюсы минусы наших трекеров и мы взяли за основу именно OC sort так как он самый лучший и у нас некоторые объекты могут пересекаться и например выходить за рамку нашего изображения демо работы трекера Да к сожалению видео здесь снова не запустится Но вот когда я показываю свою левую руку у меня трекер находит её Как выглядит итоговое решение допустим у нас есть очередь предсказаний на каждую руку мы нашли наши ладошки поставили им определённые классы вот NAN - это там где например классификатор не отработал но мы не потеряли руку и мы Валиди Был ли с самого начала Ну то есть мы нашли Left нам нужно понять Был ли до Нет не было далее не было не было здесь вообще непонятно С чем сравнивает Ладно идём дальше И мы нашли й И теперь мы задаём вопросом а был ли до этого Да он был и мы ставим счётчик повторений один на следующем предсказании мы ставим счётчик повторения 2 и можем сказать что это был жест свай вправо так как у нас до этого был рука слева показывает GS нельзя Это плохо И слишком быстро тоже нельзя а скорость - это константное значение N кадров от начального и конечного класса далее границы то есть вот такой свайп - Это плохой свайп а нам нужно чтобы он был горизонтальный мы просто находим бандик боксы рук э ставим им ограничение сверху снизу вот и вот в этой ограничивающей рамки у нас должен быть начальный и конечный жест и итоговое решение я такую небольшую блок схему вынес У нас есть кадр мы его передаём на вход детектору получаем бадин боксы предсказываем по этим бауди боксом классы далее передаём в трекер трекер нам предсказывает дишни для каждой руки и после этого Мы спрашиваем А была бы ли очередь для этой руки если очереди не было мы её создаём если очередь уже есть то мы добавляем в неё наш класс с нашим жестом далее проверяем сам жест то есть Был ли до этого до этого й например А если нет мы просто выходим и начинаем искать следующие жесты Если был то проверяем скорость показа если скорость показа не валидна мы просто очищаем очередь потому что следующие проверки будут также невалидные далее границы жестов мы проверяем их если они не валидные мы опять же очищаем очередь И если всё прошло мы предсказываем что это динамический жест круто экшн и мы очищаем очередь всё для данной руки у нас больше классов нет идём дальше теперь результат Да здесь снова видео которое к сожалению не воспроизводится но не отчаивайтесь сейчас расскажу почему Давайте разберём минусы нашего решения к сожалению так как решение построено на эвристика все параметры константные И вам нужно подбирать индивидуальную настройку под ваше устройство камеру и положение человека на изображени плю долж быть тстк привыкнуть использовать ваше решение и небольшое количество жестов так как динамика состоит из начального конечного жеста на самом деле можно пофантазировать но в любом случае это есть какое-то конечное количество динамических жестов плюсы Ну скорость работы Общее решение обрабатывается за 4 миллисекунды на один кадр очень мало весит общей вес всех моделе и кода это Ну то есть можно интегрировать это решение хоть на си написать и интегрировать куда угодно плюс отсутствуют позитивы которые присущим моделям так как у нас невозможно не выполнить невозможно получить потому что у нас константные условия и предсказуемая работа Что можно улучшить ну добавить больше жестов добавить больше еврик предсказывать повороты руки например градус поворота наклона руки и сделать гибрид Нано и про который я вам говорил мы лизм весь код и все модели нашего решения в Open Source Вы можете подписаться на чатик нашей команды и следить за новостями Совсем скоро Мы выложим ссылочку на репозиторий Где вы можете скачать решение попробовать всё Оставьте пожалуйста свой фидбек про доклад и Всем большое спасибо Вау линет Давненько Их не было у нас на конференции ребята все все в зале уже опытные уже знают как задавать вопросы для тех кто в трансляции напомню что в плеере есть кнопочка Если вы си вишни и у вас есть вопрос к Саше переходите в чат ставите ште вопрос и я его зачитаю пока что давайте вопросы Из зала поднимайте руки молодой человек на первом ряду Привет Меня Артур зовут у меня много вопросов но они больше дизайнерские но у меня есть два наверное главных А как это ВС будет работать с людьми у которых ограничены возможности если там пальца не хватает а ели на какие-нибудь на коже То есть это всё надо будет как дорабатывать отдельно и модель увеличится и будет медленнее работать Да здесь я наверное услышал два вопроса первы отвечу на первый вопрос Если есть небольшие ограничение у людей но в таком случае просто добивать датасет для классификации но здесь уже будет сложно понять что на самом деле предполагал показать пользователь если у него например отсутствует какое-то количество пальцев вот по поводу второго вопроса увеличится ли архитектура модели Я предполагаю что нет так как мы тестировали линет на распознавании более сока классов и всё отрабатывал хорошо с тем же самым качеством Круто Спасибо Есть ли ещё вопросы в зале во втором ряду Добрый день чуриков Михаил тоже сбердевайсы У меня вопрос на самом деле про трекинг руки на собственно на кадре и фильтр калмана получается что просто нужно чтобы посчитать количество рук нужно все прот по всем кадрам А почему используется фильтр калмана как бы можно там допустим экстраполяции просто какую-то использовать то есть фильтр калмана Какие преимущества даёт Да спасибо здесь наверно будет ответ очень очень техничный низкоуровневый Ну давайте Попробую ответить верхнеуровнево фильтр камана используется во всех трекера просто потому что его предсказание основано на матрице и в эту матрицу матрицу записываются такие параметры это скорость объекта относительно предыдущего кадра это его положение в принципе в пространстве то есть Где он находится по координатам и его Вектор направления Вот вот эти вот может предсказать просто относительно предыдущего кадра и поставить если мы будем использовать как вы предложили Напомните ещё раз Вы предложили да экстраполировать да вы предложили смотрите у фильтра кальмана есть такое очень-очень интересное свойство Например если ваш объект движется по дуге то во время того как ваш объект летит вверх фильтр кана будет строить Вектор вверх как только ваш объект начинает менять Вектор направления то он сразу же начинает сглаживаться то есть фильтр кальмана не строит прямой Вектор он может его сглаживать а если мы будем экстраполировать то у нас будет Вот так вот рывками вектора направления идти и Ну на самом деле там можно можно додумать решение чтобы оно было гладкое но зачем Когда уже есть фильтр кальмана Вот и плюс ещё фильтр кальмана в том что трекеры Как раз-таки используют скорость тот же самый осор использует скорость для того чтобы понять объект действительно ушёл за кадр Или он просто перекрыт чем-то другим У нас есть вопрос от Дмитрия на последнем ряду Да Привет Я Дима собственно докладывал прошлый доклад смотри такой вопрос вот тоже в сторону трекинга тести ли на таких кейсах когда вот не очень хорошая камера в не очень хорошем освещении и у тебя при свайпе большая часть середине это просто такие блобы а не руки Вот получается ли это хорошо детек Да спасибо есть такая проблема Я расскажу Да мы действительно это тести расскажу как тести у самого фильтра кальмана и у трекинга есть определённое константное значение то есть настройка Это насколько сильно сглаживать трек и сколько за этим треком следить То есть если например я сделаю вот такое движение я могу попросить его предсказывать несколько треков подряд но он будет очень-очень плавно идти где-то может быть он будет дрожать такое можно сделать Но в нашем решении нам была важна точность поэтому мы уменьшили количество предсказаний ровно на один То есть у нас идёт Так у нас обработка бадин бокса предсказание трекера баун бок трекер баун бокс трекер вот не сглаживая его дальше но Да действительно трекер в таком случае и в тех условиях которые ты описал он руку потеряет к сожалению Я даже скорее мне интересно вот не столько даже рекер который Понятно может потерять А вот сам детектор вообще как что с ним происходит этих промежуточных кадрах получается ли Вот склеить что рука здесь была в середине что-то странно и вот она появилась с другой стороны Например я понял здесь здесь К сожалению нет мы всю эту работу свалили на трекер наш детектор предсказывает именно руки и Прим даже вотка когда у меня вот так торец руки просто не предсказал классификатором даже ну детектор нашл но с маленьким Конфи вопрос от научного руководителя это лит который заставил Учите Да всем привет вопрос от тимлида А давай попробуем без нейросетей так Ну можно каскады взять Ну можно я не буду больше этим заниматься пожалуйста спасибо А у нас есть вопрос из чата Дмитрий Антипов спрашивает Можно ли и как вашим решением предсказывать жесты для глухонемых Привет Дима Спасибо большое Я думаю что нет так как жесты глухих они основаны строго на динамике То есть если в нашем решении можем просто евристика сказать что вот было начало вот конец и в нашем случае динамика то в жестах глухих вы не можете По началу и концу определить какой был жест вам нужно понять что это был определённый жест его движение руки и что эта рука показывала Если хотите посмотреть как нейросети распознают А язык глухих У нас есть отдельные доклады на эту тему Подписывайтесь в на Telegram канальчик и там можете найти по поиску Спасибо Есть ещё вопросы в зале Да вопрос А что если наоборот с помощью Нейро сети вот собственно трек превращать в символ немного не понял Ну у тебя есть трек то есть последую координат И знак Ну как бы какой-то конфигурация руки которая была распознана в этот момент да и либо распределение вероятности на вот этих знаках и собирать всё это в там свайпа уже на основе вот этой вот с последовательности вот этого текста по сути Да я понял здесь в таком случае решение будет отчасти непредсказуемым так как у нас Мы будем работать с конфиденс Да можно поставить высокий тшл но на в наших условиях решение должно вообще не должно предсказывать фс позитивы именно на динамические жесты поэтому мы поставили строгие условия Да можно с помощью конфиденс Да действительно есть ли ещё вопросы в зале Давай тогда я задам А чем обусловлено требование что классификатор должен быть легче и быстрее детектора Казалось бы детектор работает на всех кадрах а классификатор работает только на тех кадрах где детектор что-то нашёл То есть их Априори должно быть гораздо меньше суть заключается в том что у детектора сложнее задача и в детектор уже встроен как таковой классификатор То есть к которому детекция голова привязана и если мы сделаем детектор который будет весить меньше и Работать быстрее чем классификатор то появятся вопросы а что вы тогда использовали в качестве бубона детектора это просто нелогично было бы что рук много а Ну кстати да ещё Суть в том Да что рук может быть много да СБО поте есть е вопросы вопросов из чата тоже нет тогда переходим к приятному У нас есть два приза один от другой от лода Мега матрёшка Кому мы дадим приз от сбе Я думаю что молодому человеку про вопрос трекера И предсказания направлений матрёшка от нашей конференции которая будет только на этой конференции А на следующей будут уже другие и у вас есть возможность собрать коллекцию Если вы регулярный Посетитель наших мероприятий кому она достанется Я думаю уникальную матрёшку мы дадим молодому человеку на первом ряду а а тут здесь был вопрос очень-очень хороший ушёл тогда моему Тим леду за то что дал мне возможность реализовать очень-очень легковес ную архитектуру а спаси"
}