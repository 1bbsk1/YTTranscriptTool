{
  "video_id": "lLnzbtxdSag",
  "channel": "HighLoadChannel",
  "title": "",
  "views": 0,
  "duration": 0,
  "published": "",
  "text": "коллеги Всем привет А как меня уже представили меня зовут Алексей я сегодня расскажу Ну наверное третий вот из цикла про видеозвонки и измерения качества аудио видео Третий доклад который будет касаться измерения качества аудио видео на реальных девайсах а Итак давайте начнём коллеги Помогите пожалуйста с пульти ком вот лишнее немножко переключилась да два слова про меня я начинал как c+ Plus разработчик Я работал в проектах связанных с IP телефонией со стримингового тимлидом а стал продолжать развиваться по менеджерский линии и на данный момент я работаю во ВКонтакте На позиции руководителя кнд разработки единой видео платформы в эту видео платформу входит и ВК видео ВК звонки и э стриминг тоже самое ВК А значит мы сегодня будем говорить именно про работу с реальными девайсами то как мы подаём звук и видео в реальные девайсы как мы снимаем для тестирования звук и видео с девайсов мы будем говорить Конечно на примере ВК звонков но я думаю что в целом те методы и подходы которые мы будем рассматривать они могут быть применимы и в других типах сервисов поэтому рассчитываю что мой доклад будет достаточно интересен разработчикам deest и qa инженерам которые вынуждены работать с тем или иным оборудованием А ну и Кроме того мы сейчас все с вами наверное пользуемся теми или иными звонками для того чтобы ну для ежедневной работы для проведения совещаний поэтому наверное многим было бы интересно ну вот немножко заглянуть на эту кухню кухню разработчиков сервисов видеоконференцсвязи и посмотреть что же там происходит вот немножечко мы сегодня с вами это увидим Итак конкретнее по разделам значит Сначала мы рассмотрим схему стенда нашего для проведения измерений А подробнее посмотрим как именно Мы работаем с видео и звуком А посмотрим на то как мы автоматизировали работу с этим стендом Естественно что мы не хотим много ручных операций сделали автоматизацию и наверное самый такой сделал с перчинкой там будет Ну пара небольших Сюрпризов это примеры измерений Итак начнём с первого раздела с стенда А перед этим правда хочу немножко рассказать про наш сервис собственно говоря сервис видеоконференцсвязи ВК звонки А у нас поддерживается достаточно большое количество участников звонке практически неограниченная наши звонки можно использовать как для звонков просто родственникам друзьям так и для проведения совещаний рабочих и учебных у нас много учебных звонков например где дети занимаются и Кроме того сейчас ВК звонки ещё плотно интегрируются с мессенджером То есть через ВК мессенджер можно совершать звонки помимо standon приложений и тоже важный такой факт что вот как показано на картинке у нас достаточно много клиентских приложений типов клиентских приложений То есть это приложение и для мобильных iOS Android это и десктопный клиент для всех популярных операционных систем Windows macos Linux Вот и даже есть клиент для специального оборудования переговорных комнат Ну то есть конференс комнаты тоже вот поддерживают ВК звонки и вот многообразие клиентов и подталкивает нас к тому что мы должны научиться работать именно с реальными девайсами и делать свои проверки на реальных девайсах а небольшая отсылка предыдущим докладом про который уже говорилось Значит на лоде двадцать второго года я рассказывал про то как мы измеряем качество звука А тут э важный момент что вот в этих докладах предыдущих Я останавливался подробно Ну можно сказать на теории да то есть какие метрики мы используем Почему именно такие какой результат они дают Э В общем вот всё как бы вокруг измерений вот сейчас э значит теории вот в этом докладе уже не будет потому что вот я для этого ссылающихся А теорию повторюсь мы оставим тем докладом значит почему я считаю что работа с реальными девайсами э важна ну прежде всего потому что наши пользователи они собственно работают с настоящими девайсами они не пользуются виртуальными машинами или эмулятора там Андройда на компьютере естественно нет у них девайсы настоящие и там бывают всякие разные приколы например вот буквально на днях прилетела какая-то прилетело обращение что встроенный аппаратный декодер какого-то Xiaomi по-моему Если не ошибаюсь не поддерживает там тот кодек который мы используем например и у него там нет видео Да не получается кодировать видео например и вот такого рода вещи можно отловить Ну соответственно только на реальных девайсах опять же на эмуляторах может всё работать значит это первый момент а второе э бывают разные наверное сервисы в каких-то сервисах э девайс выполняет роль Ну точнее клиентское программное приложение на девайсе выполняет роль тонкого клиента просто отображает что-то полученное с бэнда но специфика вот мультимедиа всяких разных апликейшн и и в том числе звонковое клиента специфика в том что оно вносит очень большой вклад в качество работы сервиса вот поэтому не проверять клиентское по и особенно не проверять его на реальном девайсе В общем было бы неправильно значит следующий момент мы поддерживаем разные платформы и соответственно хотелось бы проверить работу нашего приложения на всех этих платформах И последнее разные девайсы имеют разную производительность и хотелось бы именно при вот попадании какой-то жалобы Да хотелось бы всунуть в стенд нужный аппарат или хотя бы похожий на него э чтобы соответственно э верифицировать и починить ту или иную проблему Ну и верифицировать фикс потом вот значит а большую часть наших пользователей составляют пользователи с которые работают на операционной системе Windows и мобиль iOS Android поэтому А мы взяли вот на флаг так сказать вынесли вот эти три операционные системы и прежде всего мы работаем именно с девайсами вот на этих операционных системах значит что мы получаем в результате измерений мы получаем качество звука в виде оценки mos Min opinion Score мы получаем качество картинки vmaf и опять же говоря про видео мы получаем количество кадров в секунду FPS Ну и Кроме того мы используем метрики на основе референса детально про вот эти вот термины мо и так далее я говорил соответственно в предыдущих докладах на которые уже ссылался здесь мы только будем наблюдать результат значит когда мы стали строить наш стенд мы задались следующими требованиями первое тесты должны быть end второе мы не хотим модифицировать клиентское по то есть не хотим использовать инструменти билды понятно что если мы Билд инструменти это может как-то повлиять на результаты измерений соответственно Мы хотим быть максимально пролак и не хотим вносить изменения для тестов А И вот если мы выполним первые два требования на самом деле у нас и третье требование Уже становится вполне реалистичным выполнимы Мы хотим А чтобы в наш стенд можно было наш стенд можно было запустить На чужом клиентском приложении то есть мы хотим сравниться с ги сервисами и соответственно вот такое требование мы себе поставили Значит четвёртое Мы хотим иметь возможность портить сеть ну Точнее говоря просто ну настраивать нужные нам параметры сетевого подключения чтобы эмулировать 3G сеть допустим какую-нибудь мобильную там ещё что-то вот и последнее мы естественно не хотим делать много ручных операций Мы хотим чтобы у нас всё было автоматизировано И вот таким образом выглядит наша схема нашего тестового стенда с сетевой точки зрения это это важный момент и мы сейчас пройдёмся по этому стенду постепенно значит рассмотрим Вот первую часть слева значит что мы сделали мы э собрали Ну значит сдела с помощью роутера специального сделали э сеть Э мы назвали её тестовой сетью Вот то есть это та сеть в которой живут клиентские устройства Ну то есть это wi-fi или можно и проводом на самом деле Ноутбук подключить вот ну для мобильных это wi-fi э и вот этот роутер он умеет портить сеть для соответственно каждого из клиентов по отдельности а следующая часть это офисная сеть это собственно обычная наша офисная сеть в которой Мы просто работаем соответственно есть вот справа нарисованы это рабочие станции инженеров слева - это некий сервер или UB который управляет запуском теста мы с ним ещё дальше встретимся Вот это работает всё просто в офисе стоит и третья часть - это собственно интернет в интернете живут ВК звонки это именно Production instance который живёт в Облаке поэтому он нарисован вот как бы как будто бы он в интернете значит к чему эта схема в общем-то О чём она она о том что мы опять же здесь попытались сделать максимальный прок like сетап когда клиенты живут в какой-то своей сети Ну вот в жизни Они живут просто в своей мобильной сети или в своём домашнем вай-фае допустим Ну вот а здесь они живут в нашей тестовой сети нуно вот по аналогии с жизнью и они честно через интернет вот они выходят из своей локальной сети они честно через интернет идут в ВК звонки то есть нет такой ситуации Что например у нас всё просто в офисе всё друг другу ходит по локальной сети там всё прекрасно работает вот нет то есть у нас вот такой прок like соблюдается Итак Подводя промежуточный итог по вот первому разделу значит что можно сказать мы узнали что реально устройство это важно мы посмотрели Какие параметры мы измеряем мы посмотрели Какие требования к стенду мы предъявляли когда строили его и соответственно посмотрели на схему стенда Ну с сетевой точки зрения Пойдёмте дальше рассмотрим работу со звуком и видео Значит мы говорили что мы будем использовать метрики на основе референса что это знат это знат они созваниваться в звонке и первый клиент он у него есть некое референсное видео и референсный звук и он их проигрывает в звонок Второй клиент соответственно получает из звонка нечто то есть какое-то видео и какой-то звук они скорее всего будут отличаться от референса Ну потому что вот они прошли через какие-то сложные сетевые условия там в нашем сервисе они претерпели какой-то там кодирование декодирования в общем полученный видео и звук они попадают в алгоритм оцен туда же попадает и происходит сравнение то есть алгоритм пытается Понять насколько соответственно результат отличается от референса и выдаёт оценку это общий принцип вот с которым мы работаем значит сказав Так выясняется что у нас есть три Таких вот челленджа челленж номер один нам нужно как-то научиться подавать референсные звук и видео в ли а второе нам надо научиться получать результирующее аудио и видео из клиентского приложения и третье мы договорились что мы не хотим использовать инструменти билды то есть на самом деле лёгкое решение было бы просто заин билды чтобы клиентские приложения просто из файла там читали там звук и видео и всё но мы договорились что мы так делать не будем поэтому это тоже такой Челлендж и Сейчас мы посмотрим как же мы вот эти вот вопросы решаем значит сначала рассмотрим ноутбуки а-а это мы будем рассматривать только на основе виндоу э ноутбуки значит но общий принцип На самом деле применим к любой операционной системе значит э для работы со звуком э по на ноутбуках мы используем так называемые виртуальные кабели А значит что это такое Это Third Party программное обеспечение которое после установки выглядит как системное устройство ввода-вывода где э значит на одном конце кабеля микрофон и и на другом конце кабеля апу то есть динамик И как же значит это работает вот схема такая на клиентском устройстве соответственно поднято приложение звонков и некоторый тестовый фреймворк Ну или тестовый Агент можно по-разному сказать Вот и что нам надо сделать нам надо Значит первое Нам надо в микрофон клиентского приложения звонков подать некий референс значит это делается так почти в любом приложении звонков можно выбрать С какого инпут устройства соответственно производить чтение соответственно Мы выбираем в приложении звонков некий кабель а как устройство inp и в это же время в тестовом Агенте Мы выбираем это устройство как устройство воспроизведения вот и получается что фреймворк проигрывает звук и он попадает в микрофон приложения а с динамиком ровно наоборот то есть в приложении звонков Мы выбираем динамик Кабе значит в тестовом Агенте мы захватываем этот кабель B и получается что всё что идёт из звонка весь звук он попадает к нам в тестовый Агент и записывается вот такой принцип А значит что с видео на ноутбуках мы пользуемся программой obs Studio это известная программа для стриминга значит что мы делаем мы настраиваем виртуальную камеру с помощью obs значит obs формирует изображение и посылает его на виртуальную камеру а в приложении звонков мы соответственно выбираем эту камеру в качестве камеры по умолчанию и э вот это сформированной обс видео уже попадает в звонок значит э Наше референсное видео выглядит примерно Вот так это вот некоторые четыре кадра взяты из этого видео Э что вот за такая полоска сверху какие-то квадратики Это я всё подробно рассказываю вот в докладе прошлогодним а просто так вот ради интереса показал вам референс значит э поговорим про то как мы получаем видео из десктопного клиента то есть ноутбука Значит мы на самом деле просто пем захватываем весь экран Вот пример команды которую мы используем тут Наверное особенность по сути дела одна что мы не пережимает если мы собираемся оценивать качество этого видео то мы не должны его сжимать Ну по крайней мере сильно сжимать встаёт наверное вопрос что вот мы захватили экран и он будет выглядеть примерно вот так значит а нам нужно только видео и вот у нас используется такой вот лайфхак о нём я тоже год назад рассказывал мы внутри вот этого референсного видео в начале несколько первых кадров видео вот показываем вот такую шахматную доску и эта шахматная доска фактически нам ограничивает габариты нашего видео именно полезной части видео Вот и и из экрана мы просто перед сравнени эту досм только е для сравнения элементы интерфейса нам естественно в алгоритме сравнения не нужны поговорим про мобильные устройства значит ну со звуком тут всё так сказать Ну проще в какой-то степени то есть мы используем просто кабели вот для того чтобы как бы эмулировать гарнитуру вот или blet подключение а вот с видео в мобильных ВС гораздо интереснее прям супер технологичного способа передать засунуть видео в мобильное устройство вот и что мы сделали Мы просто поставили компьютер с монитором значит и некий наш хаб или сервер он это референсное видео в этот компьютер загружает и компьютер показывает прямо физически на мониторе показывает видео а мобильный телефон берёт и просто снимает своей камерой вот этот вот монитор который показывает референсное видео ну и соответственно А дальше уже всё штатно соответственно передаётся видео в звонок уже как обычно Вот и так сказать чтобы вас немного развлечь я вот привёл фотографии нашего стенда вот этой части стенда с мобильными Вот вот стоит монитор вот стоит на штативе таком импровизированной мобильный телефон снимает его и передаёт звонок и ещё второй вариант это вот это фронтальные камеры то было тыловой камерой соответственно вот такие элементы diy вот у нас присутствуют струбцины какие-то штативы такие самодельные В общем развлекаемся тут как можем вот значит а что касается съёма видео с мобильных устройств Значит мы пользуемся Android девайс бриджем и iOS девайс бриджем вот то есть схема выглядит примерно так э девайс в звонке значит и он подключён к компьютеру и весь экран этого устройства соответственно снимается компьютером Ну регистрируется соответственно также попадает в некий видеофайл Итак про работу с видео и со звуком Значит мы вспомнили что такое измерение на основе референса мы поговорили про приём и передачу звука про приём и передачу видео и соответственно рассмотрели вот некую особенность мобильных устройств вот в части по крайней мере видео А поговорим про автоматизацию Значит первое про что хочется сказать это про установку параметров значит как мы уже говорили у нас роутер может портить сеть для каждого из вот этих вот каналов для каждого пользователя Вот и традиционные сетевые параметры это ширина полосы пропускания задержка G процент потерь пакетов значит Кроме этого Мы научились параметры не то задавать констант перед тестом но и менять параметры в процессе тестирования тоже такое мы умеем значит И как мы это делаем Значит у нас есть два способа один исторически первый но такой не самый технологичный Вот мы собственно говоря изменяем параметры с помощью системы систе с помощью утилита Traffic Control TC и модуля нем И для этого у нас навернуть webui который вот представлен на скриншоте где соответственно мы можем задавать нам параметры но есть второй способ более такой продвинутый мы используем роутер с прошивкой с Open вот что даёт нам возможность портить сеть через соответственно это автоматизирует это прикольно вот значит различных сетевых профилей может быть огромное количество вот я здесь упомяну неско которые использовали ВНО замеров и потом в конце я буду показывать примеры замеров Вот они в частности некоторые замеров будут базироваться вот на вот таких профилях вот грубо говоря это некий профиль хорошей сети почти без ограничений по крайней мере критичных для звонков по трейду дальше это относительно хорошая сеть понно с потерями и потом эмуляция мобильной сети вот знат посмотрим продолжая про автоматизацию управление клиентскими приложениями Т ноутбуки мы автоматизируем с помощью фреймворка и мы сделали что-то что-то вроде такого селениум на минималках Вот то есть мы умеем находить по маленькой иконочный процессы нам на самом деле надо не очень много но это важно Значит мы автоматизировали создание звонка через приложение мы автоматизировали получение ссылки на звонок Ну это в нашем случае надо просто нажать на кнопку ссылка и она попадёт в буфер вот мы автоматизировали вход в звонок по ссылке мы автоматизировали включение выключение камеры и микрофона И это кстати очень важный пункт Потому что если мы вошли в звонок там по умолчанию замьютить мы не сделаем нам нужно их включить поэтому обязательный степ каждого теста Это проверка сейчас включено или выключено и чит соответственно если выключено то включить Ну и последнее управление шумоподавлением также автоматизировано Вот поговорим про то как собственно происходит запуск замеров значит предположим вот инженер хочет сделать замер он приходит в м настраивает параметры своего теста и нажимает Старт чит идт на наш сервер или UB как мы его называем это мозг теста как бы бизнес логика теста всё всё на нём значит и этот сервер он соответственно поднимает первого клиента и заставляет его Сделать звонок соответственно первый клиент делает звонок через сервис Второй клиент звонок принимает между ними соответственно устанавливается связь и первый клиент проигрывает референсные аудио и видео в звонок вй клиент то что из звонка получается принимает и передаёт соответственно на сервер у сервера есть референс естественно потому что оно подавал его в первый клиент и соответственно он производит сравнение того что он получил от второго клиента с референсов передаётся в тимсити и уже наш счастливый инженер наблюдает уже в виде артефактов там Team наблюдает результат замеров что же видит инженер да то есть что что на выходе замеров Значит первое мы имеем статистику по трафику это важно контролировать какой клиент соответственно какой трафик отправлял какой трафик принимал и мы сможем потом сматчить соответствует ли это ожиданию значит у нас сейчас мы пойдём сейчас следующие три слайда мы пойдём от наиболее мелко детализированной информации к более крупной так вот мы имеем статистику по каждому кадру достаточно подробную в частности это оценка vmaf это оценка psnr Это можно сказать Побочный В каком-то смысле эффект от запуска утилиты А vmaf а и так по каждому кадру значит дальше Наше видео для оценки разбивается на несколько сегментов относительно коротких А и мы имеем оценку в кадра в секунду по вот этому маленькому фрагменту мы имеем также усреднённый psnr и vmaf по каждому фрагменту И последнее А это соответственно уже по всему видео соответственно средний FPS средний psnr и средний vmaf вот говоря про автоматизацию надо сказать что конечно у нас ещё не всё доделано Мы только в пути вот и есть ещё много планов Что сделать значит из самых таких горячих вопросов У нас пока плохо автоматизированы мобильные устройства То есть я вот Если вы обратили внимание много говорил про автоматизацию ноутбуков А про мобильные не сказал Ну вот потому что здесь ещё есть нам чем заняться и второе есть Прямо Мега идея Было бы очень круто а сделать подачу референса и съём референса с помощью отдельных USB девайсов для этого подходит например Raspberry Pie или что-то аналогичное что подключается в USB и либо проигрывает видео Как как камера фактически шная Либо наоборот что-то захватывает А вот такие вот пока планы Итак Подводя итог промежуточный по автоматизации Значит мы посмотрели с вами как мы управляем параметрами сети посмотрели как мы управляем клиентскими приложениями посмотрели Как проводится замер и посмотрели на примеры выходных данных замеров и теперь последний раздел наверное самый вкусный Я обещал там ещё интересности значит давайте посмотрим а первое что я хочу показать это значит ээ наше а приложение измеряем качество видео а и ээ количество кадров в секунду на разных сетях значит видно что э на хороших сетях всё прямо отлично значит на качестве э на жирной сети но с пакет лосо У нас есть некоторая просадка по качеству видео а на мобильной сети просадка очень значительная вот посмотрим что с FPS а вот с FPS на самом деле всё не так плохо Вот ну в хорошей ситуации 25 FPS это всё отлично как бы максимум Вот Но в плохой сети мы умудряется вытягивать тоже достаточно высокий FPS То есть получается что мы как бы разменять качество видео на плавность картинки потенциально можно было так не делать можно было например сделать чтобы было слайд-шоу но это слайд-шоу было бы более качественно вот это вот такой больше может быть продуктовый вопрос как лучше но на мой взгляд именно видеозвонке э сохранить плавность кадров это в общем достаточно важно поэтому мы здесь как бы выступаем неплохо А значит дальше сравним Две версии нашего приложения вот значит в чём была постановка задач вот этого замера Значит у нас были жалобы на то что на очень плохих сетях например 20 и 30 пакет Лоса у нас соответственно качество картинки очень низкое Вот соответственно мы сделали какие-то доработки что-то придумали Вот и выпустили новую версию приложения которая обещала нам улучшение и соответственно вот пытаемся верифицировать что и видим что Да вот на приёме видео действительно у нас достаточно серьёзные улучшение это синие столбики это более новая версия вот действительно есть улучшение на отправке видео результаты немножко более скромные но тем не менее тоже выигрыш У нас есть следующее вот это вот значит как бы добавляем перчин сравнение с другим сервисом вот к сожалению я не могу назвать сервис впрямую вот просто могу сказать что это некоторый популярный сервис для видеоконференцсвязи второй Ну и наши звонки соответственно вот значит что сравниваем значит мы сравниваем работу условиях Когда в звуке присутствует кроме человеческой речи присутствует ещ шум Вот то есть качество шумоподавления фактически оцениваем значит первый кейс Шума нет то есть это просто такой можно сказать чек на то что мы хотя бы хороший сигнал не коптим Вот соответственно значит всё нормально Вот мы в общем держимся на уровне немножечко нас этот сервис обгоняет но в целом всё нормально кейс номер д значит в звуке присутствует лай собаки а соответственно разборчивость речи за счёт этого теряется и мы пытаемся как-то его вырезать соответственно если мы А у нас шумоподавления выключено в обоих сервисах то соответственно у нас в общем-то Ничего как бы не получается и качество низкое но не получается одинаково как у нас так и у другого сервиса значит Но наше шумоподавление оказывается несколько лучше чем подавление вот в другом сервисе В этом кейсе по крайней мере смотрим дальше кейс шум улиц значит Ну просто человек идёт по улице там речи соответственно машины едут и ещё что-то Вот соответственно тоже Мы сравниваем в различных конфигурациях шумоподавления вот также без шумоподавления у нас просто у всех Плохо что в общем-то ожидаемо Вот и тут уже разница у нас с другим сервисом не такая большая но немножечко вот в кейсе слабого шумоподавления есть а и последний кейс - это шум поезда соответственно человек едет в метро или в электричке Вот и здесь вид что тоже мы немножечко вот при когда включено шумоподавление что мы тоже немножечко выигрываем и последний значит последний фрагмент это сравнение сразу с несколькими сервисами вот я к сожалению тоже не могу здесь впрямую назвать эти сервисы вот значит Единственное что это все сервисы на Android девайсе соответственно популярные приложения для Android девайса больше сказать здесь не могу значит но Значит мы сравниваем вот в тех сетевых профилях про которые я уже говорил значит видно что на хорошей сети у нас качество картинки очень достойное Значит на плохой сети уже значит при отправке видео немножко у нас похуже ситуация но всё равно мы так сказать на уровне держимся вот а на отправке видео тоже на хорошей сети плюс-минус всё более-менее нормально значит но если очень зажат то есть симуляция мобильной сети то что у нас вот здесь проседает FPS и Для нас это на самом деле очень ценная информация для этого собственно мы и проводили Вот это тестирование мы нашли для себя точку роста Да где мы можем что-то предпринять и ещё что-то соответственно улучшить в работе своего сервиса Итак с примерами всё Значит мы с вами посмотрели на различные сетевые профили и поведени нашего клиента в различных условиях сравнение двух разных версий нашего продукта мы посмотрели сравнение с другим сервисом по шумо подавлению и посмотрели сравнение по качеству видео с несколькими разными сервисами что хочется сказать в заключении значит Мы научились соответственно измерять качество аудио и видео на физических устройствах и считаем что это крайне важно Это для нас очень полезно и ценно второе мы эти замеры естественно мы не хотим много тратить делать ручных каких-то действий третье мы пользуемся только штатными версиями клиентов не используем инструменти билды и тоже считаем что во-первых это правильно во-вторых это ну наш такой прорыв что мы это смогли сделать И последнее Мы научились сравниваться с другими сервисами что для нас очень ценно это показывает нам какие у нас есть точки роста И куда мы можем дальше развивать наш сервис на этом У меня всё большое спасибо голосуйте за мой доклад это крайне важно для меня лично и для программного комитета конференции пожалуйста ваши вопросы Лёш Спасибо большое Я Напоминаю что ещё один У нас замечательный докладчик с двумя призами Поэтому будет спецприцеп от нас Выбирай времени у нас Примерно 15 минут можно спокойно Привет Лёш Меня зовут Дима Я тоже из ВК Спасибо за доклад очень было интересно Вопрос такой вы не думали Ну когда анализировали например сценарий использования видеозвонков что картинка может зависеть от того ну то есть типа выглядит видеоизображение есть это Говорящая голова какую-то ситуацию на улице Не ну вот я просто читал что есть кодеки которые например умеют семантически понимать что о на изображение и в первую очередь портят те данные которые считаются не важными И вот я так понял что у вас Ну в звонках такое не используется используются наверное какие-то более общие Вот если бы Например хотели протестировать сравнить вот этот семантический какой-то кодек и ваше общее как бы вы это делали Как ты думаешь угу Значит у нас используется сейчас три кодека это 264 h264 Но это стандарт Вот vp9 vp8 вот Но vp9 p8 в основном используется в плохих в режиме так называемой плохой сети Вот они имеют некоторую адаптацию к плохим сетям так называемые временные слои вот поэтому именно эти кодеки значит по поводу Я честно говоря про семантические коды для видео не ресл не могу сказать Ну то есть наверное есть надо посмотреть Интересно а как будем сравнивать это как раз очень просто то есть мы делаем добавляем такой кодек добавляем в своё приложение Ну находим реализацию Вот и в наш стенд вставляем Ну вот версию клиента с вот с новым кодеком и можем сравнить вот он даёт такую такую чисел а там даже 264 кодок дают вот такую чисел вот будет сравнение мне просто интересно то есть в данном случае ну можно ожидать что семантический кодок он сохранит более важной части картинки а обычные которые не подвязываться на то что происходит на картинке он будет ну как бы в среднем всё пытаться сохранить и справедливы ли в данном случае будут вот эти метрики Да потому что Метрика vmaf она перцептрон просто люди людям показывали картинки условно говоря они говорили там они там хорошего качества или плохого я очень упрощают максимально Вот сам принцип Да люди говорили там хорошая картинка плохая картинка и нейросеть обучали на то как человек воспринимает картинку это единственный момент netflix он про телевизоры про вот поэтому там расстояние до экрана немножко другое там вот в звонках конечно есть некоторая такая вот погрешность использования этого ви мафа но мы её принимаем что как бы О'кей Но Метрика это такая вот так что то есть Это скорее всего то есть если человек оценит улучшение то vmaf скорее всего оценит Спасибо Угу Лёш Спасибо большое за доклад А хотел задать такой вопрос Правильно я понимаю что вы качество сотовой сети на мобильных устройствах эмулировать просто за счёт того что зажимали трафик А насколько это действительно соответствует качеству мобильной сети потому что всё-таки приложение там на Андроиде могут люди писать и там они могут напрямую знать что сейчас 3G и включать какие-то режимы Хороший вопрос значит умеем регулировать задержки соответственно теров конечно сообщить мобильному телефону что он сейчас на 3G именно вот какую-то логику прокинуть приложение Конечно мы не можем То есть это wi-fi то есть для приложения это всё wi-fi просто Вот такой плохенький вот только так пока да спасибо большое и маленькое дополнение нету ли такого предположения что там где плохое качество сети ваши конкуренты Они использовали какие-нибудь модели акела А вы может быть этого не заметили Ну и считали что Качество хорошее upsale картинки то есть передавать плохую картинку В смысле маленькую картинку но потом её растягивать Да теоретически может быть а но скорее как раз там там много раз различных методов борьбы вот с плохой сетью те самые временные слои ещё есть R фек например вот вот с фе ком интересно что он не требует РТТ например а допустим там на например То есть negative он допустим требует РТТ и вот если мы заложим там на N например то мы потеряем latency например если мы заложим на фек у нас вырастет НВИ но зато мы как бы без РТТ То есть у нас не будет увеличения Н вот Скорее все баланс Вот таких вот вещей как R фек ещё кстати есть интересная штука мы пока не пользуемся Но надо бы воспользоваться вот есть звук если выпадает частично есть алгоритмы которые восстанавливают один кусок и другой кусок Вот середину можно восстановить это называется plc Packet L concealment и вот я знаю вот мы пока не пользуемся Но вот надо туда посмотреть в Клауд гейминге где очень lcy важно там умеют если декодирует видео и каких-то пакетов не хватает умеют дырки грубо говоря зарисовать на картинке Вот и таким образом не наверняка конкуренты могут использовать upscale ну вряд ли на только если на клиенте и нейросетевой какой-нибудь типа Нейро HD глубоко теоретически Да но там у них батарейка улетит скорее всего вот да давайте дальше Алексей спасибо большое за доклад а два вопроса Первый ты говорил что у вас для тестирование видео используется э съёмка экрана а мобильным устройством да а не возникает ли проблема ухудшения качества и влияния на тесты из-за разной частоты монитора и частоты съёмки то есть Возможно там какие-то появления полос которые человеческому взгляду там не видны Вот таких артефактов а нет пока не сталкивались бороться не приходилось с таким пока по крайней мере там есть там есть нюанс световой схемой Но это с тем же пем связано это немножко не то полосы пока вроде не Сталки зна как рает и второй вопрос немножечко подробно хотелось узнать про алгоритм шумоподавления то есть Какая технология заложена это ваше проприетарное решение или это что-то орное значит у нас слабо и сильное шумоподавление это разные варианты обучения так называемый боюсь чуть-чуть ошибиться в терминологии это фильтр вот мы называем шуда это ну обученная нейронка вот обучали сами вот просто есть более легковес нейронка которую мы называем слабый шумодав она хуже соответственно вырезает шум но меньше коптит как бы полезного сигнал и есть вот полная модель вот этого дип фильтра которая вырезает очень люто но при этом может закора полезный сигнал немножко Вот то есть своя нейронка короче короткий ответ Это ваша разработка Нерон Да Дада У нас есть команда тех вот которая вот делает нейронные сети вот конкретно шумоподавления Вот и эти самые другие всякие для звука нам вот транскрипцию isr вот это вот транскрипция речи Я имею в виду вот целая Командо есть небольшая они готовят нам нейронки Спасибо Угу спасибо за доклад У меня честно говоря много вопросов к вам Ну первое Я хотел бы комментарий Дать человеку который про метрику в мав спрашивал она действительно взламывает хорошо метрику повышает Так что ваши конкуренты могли вас обмануть а не так мы же сами себя обманули зна Да ну понятно Да я хотел спросить про метрику Мос Мос про оценку качества звука А вы всё-таки голос передаёте есть другие метрики для оценки качества голоса Почему вы их не выбрали или не планировали Какие вы имеете в виду ну есть разные метрики я сечас сходу не назову но я точно знаю что есть их много нет Смотрите тут такая ситуация Мос - Это ми Score это как бы результат А как мы получаем результат это разные есть утилит например мы используем visc бесплатный например вот это Вил - это именно алгоритм а Мос - это результат работы алгоритма но Мос можно получить различными способами Там есть этот самый У меня есть полку А например это платная Метрика которая соответственно тоже Мос даёт то есть Мос - это просто чисел там от единички по-моему до 4 с поно или до пяти там есть нюансы Вот Но как получена эта чисел вы права есть разные методики Мы например используем Спасибо И ещё вопрос Вы сказали У вас своя разработка шумава есть в сетях GSM тоже используют кодеки примерно для этих же целей сравнивали или нет результаты вашего шумодава с известными кодеками и что получается Если сравнивали смотрите Мыт немножко ограничены вопервых есть и нам крайне тяжело какой-то другой кодок внедрить Ну так по крайней мере сходу возможно в десктопное приложение например но мы в этом смысле ограничены немножко осом но честно говоря я не помню из GSM кодеков Ну там какие Amr Amr vb evs по-моему ещё есть Но это ведь только алгоритмы кодирования а там нет шумоподавления Если я не ошибаюсь я вот например сам Amr встраивая работе там были только функции Ну и Понятно NC dec и plc грубо говоря там не было встроенного шумоподавления Вот Угу Да да спасибо за доклад и у меня был такой вопрос Вы когда проводили все ваши оценки работы вашего сервиса делали это я так понимаю прототипи звонок One toone А как перформер Вис Когда у вас групповые звонки когда много видео и соответственно Нужно как-то же распределять трафик всё вот это в общем сильно не падают ваши метрики если мы переходим на групповой звонок вот а Да хороший вопрос вот действительно те примеры которые я а приводил А кстати если не ошибаюсь Я наверное это не отразил на слайде Но вот где мы сравнивались с несколькими сразу сервисами Это был групповой звонок на 30 человек вот я об этом как-то не упомянул А вот э Да могут упасть потому что большой трафик и когда сети зажатые много стримов надо передавать да естественно Вот но и у других сервисов тоже соответственно метрики поедут короче последние Вот последние два слайда это были 30 человек шумоподавление было питупи да и предыдущий тоже дабл Пир Давайте ещё один вопрос да Привет Спасибо большое за доклад меня появился такой вопрос на слайдах были приведе различные метрики для зка видео но они все как я понимаю детерминированы в том плане что они вот берут референсную картинку или звук и с ней сравнивают то что мы получили а всё-таки люди разные у всех глаза разные устройства разные освещение у них разное и поэтому сравнивали ли вы именно на пользователях ваши доработки какими-нибудь а тестами потому что вдруг есть метрики которые уже нет смысла растить Потому что люди лучше и не увидят Да хороший вопрос а мы проводим а давайте так именно по качеству видео Наверное мы AB не запускали у нас AB в основном запускаются на продуктовые вещи там как ну какая-то новая фича например там вышло ещё что-то такое вот на качество у нас был что мы делали это опросы но они тоже касались не не не фокус на качество видео или аудио вот а а просто Ну вот как зво как вам звонки как бы и это называется ПС кажется да то есть счастье пользователя условно говоря и там говорят что вот то неудобно это неудобно или наоборот вот это хорошо это там хорошо вот но там качество видео и аудио там тоже фигурирует обычно что иногда бывает что что-то не слышно там или наоборот хорошо говорят вот Но это скорее опрос э такого-то какой-то фокус группы Вот именно а тестирование на само качество видео не проводилось всё заканчиваем у Можно вопрос ещё просят ещё один вопрос очень очень коротко прямо в тайминг мы Минутка есть буквально О'кей спасибо большое за доклад У меня вопрос вот касаемо вашей метрики моз она такая достаточно общее насколько я понимаю вы не хотите э завести там какие-то метрики которые будут оценивать э то как работают кодеки там как работают ваши улучшайзер потому что я знаю что такие метрики есть и ваш коллега рассказывал об этом на дата фесте да мы внедрили на самом деле уже такую метрику она называется низ она без референсная она сейчас у нас по каждому пользователю вот весь звук от всех пользователей проходят через вот эту низку она даёт эта низ целых п параметров по-моему из них я сейчас на память скажу это Ну тот же Мос то же самое потом loudness допустим то есть та вообще есть там звук-то в этом внутри громкость Значит есть nois параметр вот есть coloration насколько окрашен сигнал и что-то ещё Вот и вот этот нонес на самом деле это очень хорошая штука мы на её основе скорее всего сделаем snr то есть соотношение сигнал шум и будем принимать решение автоматом включать шумодав или нет Это вот это в мпе Вот Но уже есть да низко безредка она только меряет вот что пришло без референса Да такое есть уже внедрили Я не хочу прерывать и быть злобным но вынужден Лёш самое сложное Два лучших вопроса и причём Скажи пожалуйста кому что угу Так давайте подумаем значит мне понравился на самом деле вопрос Вот наверное пред предпоследний вот молодой человек в жёлтом Да в жёлтой футболке чем понравился что действительно это заставляет задуматься важный момент мы растим какие-то метрики А ну вот это стоит того борьба Вот вот за эту чисел она вообще стоит того или нет может быть пользователь всё равно уже ничего разницы не увидит вот мысль интерес действительно Стоит задуматься Вот давайте вот пингвинчика вный подарок Он прикольный и второй от нас матрёшка кастомная так вспомнить бы все вопросы а ближе к началу был вопрос по-моему от молодого человека в чёрном тоже спикер Да по-моему см вот хотел бы отдать матку хорош пообщались СБО коте Спасибо тебе большое У нас для тебя тоже есть подарочек небольшой О спасибо С Спасибо большое Хорошего вечера тебе Лёш"
}