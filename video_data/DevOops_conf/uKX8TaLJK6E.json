{
  "video_id": "uKX8TaLJK6E",
  "channel": "DevOops_conf",
  "title": "Георг Гаал — Защищаем Kubernetes при помощи StackRox — дешево, сердито, эффективно?",
  "views": 557,
  "duration": 3084,
  "published": "2024-09-13T03:05:56-07:00",
  "text": "Всем привет Меня зовут бобыльков Виктор и сегодняшний доклад на тему как мы будем защищать губернатор при помощи stekrocks буду модерировать я давайте договоримся как мы проведем наш доклад для начала я расскажу о том что у нас есть замечательный чат в телеграме Где вы можете задавать свои вопросы и мы на них будем отвечать на часть вопросов я буду отвечать письменно А часть вопросов мы зададим георгу и он сможет ответить на них в прямом эфире дальше на те вопросы на которые если мы к сожалению не успеем ответить то дальше мы их Обсудим в формате дискуссии после нашего доклада так а прошел кого-нибудь написать в чате чтобы было видно что чатик рабочий пишу Наверное я первый о Борис Чернов привет И так предлагаю начать и я тогда передаю слово нашему эксперту георгу галу Добрый день коллеги я сегодня Добрый день коллеги я сегодня Вам принес доклад под названием защищаем губернатор при помощи и попробуем ответить на вопрос дешево ли это сердито ли эффективно Меня зовут георга Я на текущему времени ведущий инженер компании зодиа Маркет занимаюсь поддержкой инфраструктуры разработкой и активно поддерживаю наш разработку также по совместительству я администратор множество русскоязычных Telegram каналов айтишной тематике Вы можете меня увидеть где я Стараюсь помогать новичкам и вливаться в наше дружно найти комьюнити являюсь также участником программных комитетов различных конференций поэтому Вполне возможно что я вам также помогают иногда пишу статьи Давайте перейдем к делу и предположим что у нас есть некоторые гипотетическая ситуация которые мы компания Естественно для очевидным выбором становится то что мы едем в облако и берем там конечно же потому что это модно сильно молодежно и случае чего мы всегда можем переехать в другое облако или на железке мы разработали наше приложение пустили трафик нашим продуктом уже пользуются клиенты внешне вроде бы какое-то время все хорошо и в какой-то момент времени начинается какая-то просто непонятная вещь у нас узлы загружены по сто процентов пользователей жалуются то что система тормозит что-то идет не так может быть даже Мы попадаем в новости рассказывают что же случилось Вполне вероятно то что нас взломали как это могло произойти потому что то что мы развернули для нас является черным ящиком Мы вроде как понимаем что мы сделали но фактически внутри мы ничего не понимаем что там происходит зачем почему как работает это проблема потому что нам с ней дальше нужно работать и развивать и нам нужно понимать что конкретно в ней происходит какие в ней взаимодействия возникают Вот ну как например такой простой сценарий как мы могли где-то накосячить наши разработчики ходили в губернатор деплоу или приложение не были админские конфигурационные файлы они их например залили поэтому Давайте поговорим о том что нам действительно нужно заниматься безопасностью не было таких проблем посмотрим что у нас есть на рынке натуральным таким естественным шагом является поход на сайт под названием это каталог приложений по большей части которые готовы к установке в облако можно увидеть то что этот каталог огромный в нем есть куча разделов представлена представлено приложение Может быть у нас будет конкретно интересовать раздел посвященный безопасности тем не менее в этом разделе все равно достаточно много программ И как же в этом многообразии сориентироваться здесь я попробую вам помочь потому что я подготовил небольшой обзор именно тех решений которые могли бы решить ту проблему которая возникла у наших виртуальных коллег и Давайте пройдемся по этим программным решениям начнем мы Наверное разговор с решения под названием фалька это решение создано компании Сидит она является абсолютно разворачивается при помощи и когда мансет фальков запускается на каждом из узлов нашего кластера Валька умеет собирать события самого узла То есть например какие-то системные вызовы обращения к файлам события создания процесса также он умеет собирать события аудита самого губернатор если какой-то пользователь обращается губернатор и создает какие-то объекты пальто Может это перехватить и генерировать определенные события но здесь есть некоторые тонкость она связана с тем что эта система основана на базе правил поэтому те события которые нет попадают какие-то правила они будут только проигнорированы и также это является причиной того что пайка очень легко обмануть если например вы написали правила которые реагирует на процесс с названием какого-то определенного майнера если мы этот майнер переименуем только его к сожалению видеть не смог это проблема К сожалению система легко обходится также в этой системе нет реакции на события То есть фалька может выступать только как некий инструмент мониторинга и дальше нам необходимо построить некоторую цепочку на базе внешних решений которые будут эти события обрабатывать и на базе них принимать какие-то решения то есть например если у нас запущена Мы хотим контейнер погасить и Вот пример такой цепочки предоставлен на слайде то есть мы можем подключить очередь события нас ее замкнуть на фреймвок таких облачных функций и при помощи них организовывать какое-то действие на события также есть такая проблема что когда он захватывает определенные события в нем Нет контекста мы не можем посмотреть что предшествовало этому событию или что было после этого события это тоже проблема потому что некоторые события могут быть легитимными они нас не очень интересуют они могут нас интересовать Например если был создан определенный файл внутри приложения а это создание файла не было предворено входом в систему оператора этого приложения это достаточно Странная история и мы бы хотели бы отловить к сожалению фальконам здесь помочь не может если же мы все-таки хотим каким-то образом вот этот контекст по сути те системные вызовы которые происходят на узле ловить нам придется обратиться к другим проектам это проект который называется сидит по сути это система монитора которая позволяет логировать все события которые происходят в нашей системе и записывать их в определенный файл Лога снимок нужно каким-то образом исследовать Таким образом получается у нас есть определенные компоненты супового набора которые могли бы нам помочь вы создании системы для обеспечения безопасности кластера но они слабо связаны и нужно будет приложить усилия разработчиков чтобы все свести воедино но это уже сделано на самом деле в рамках платформы под названием Secure это платная платформа которая как раз состоит из этих компонентов и Сколько инспектор также в ней есть движок политика который позволяет отлавливать запуск нагрузок который не соответствует вашей внутренней политике например с привилегированными контейнерами и блокировать по сути это действительно полноценное решение к сожалению она платная И к сожалению она не лишено всех тех недостатков которые есть пойдем дальше что еще у нас есть есть такая тоже интересная штука под названием tetragon также как и фалька является по сути агентом который позволяет отловить системные события но отличие от фалько он еще умеет реагировать на эти события то есть случае если у нас есть какая-то нагрузка которая ведет себя неадекватно мы можем сказать чтобы он с этой нагрузкой что-то сделал полностью кибернетик также но у него есть два больших недостатка которые его возможно использование перечеркнуть для вас первый недостаток заключается в том что он имеет свой формат интеграционных файлов которые ничем другим несовместим кроме него самого и требуется определенный навык чтобы научиться их писать и также он очень зависит он является компонентом сетевого плагина и основан на его компонентах и поэтому получается то что невозможно использовать страх которые оборудованы другим сетевым плагином вы стороны сетевой плагин silium с каждым днем становится все популярнее поэтому Возможно это и не проблема но если вы вдруг остановили свой выбор насилиями то в нем есть дополнительные хорошие возможности такие как например хаббла Это инструментарий который позволяет визуализировать трафик который дает дополнительные сетевые метрики трафика и таким образом вы можете не только ловить события которые происходят вашим пластырем но и сделать систему с точки зрения сетевых потоков более понятны более наблюдаем А если еще и купить например коммерческую версию там еще более широкие возможности по аудиту по мониторингу и более того есть даже встроенный редактор политик таким образом можно собирать дампы трафика при помощи хаббла и потом конвертировать их сетевые политики для кубернета таким образом реализуя принцип наименьших привилегий на уровне сети приложение взаимодействия только с теми приложениями которые ему действительно необходимо для работы и если приложение прошло куда-то другое место то мы можем опять же это отловить увидеть то что у нас что-то происходит не так дальше уже разбираться почему это так произошло или это какой-то программный сбой или ошибка коде или возможно нас уже кто-то взломал об этом не знаем но мы только что видели какие-то признаки если мы говорим о коммерческих решениях то обзор был абсолютно неполным если бы не упомянули такое топовое решение Поверь себя Одно из самых мощных на рынке Аква Security Это действительно очень неплохое решение которое покрывает не только губернатос кластера но также и можно защитить облачные функции лямда и можно защитить виртуальные машины и она тоже обеспечивает высокий уровень наблюдаемости того что происходит очевидно что есть куча интеграции есть система которая позволяет и контролировать нагрузки накладывать на них определенной политики запрещать определенные также как сканировать функциональное решение но опять же к сожалению коммерческой истории также поддерживает и опенсус два решения которые стоят упоминания это кубинчик юбхантер и убейший это бесплатный Open source-проект который позволяет тестировать любой губернатор класса на ciscomplines то есть оно проверяет соответствие губернатор кластера лучшим практикам описанным стандарте безопасности если этот стандарт безопасности не выполняется меньше даст вам рекомендации Что нужно сделать Как ставить конфигурацию чтобы она была совместима на другую уже сторону Он позволяет агрессивно сканировать определенный класс Я честно скажу я бы не стал бы не рискнул бы это делать но если у вас есть возможность сделать копию кластера с теми же самыми настройками это может быть хорошим подходом потому что любое сканирование которое позволит выявить больше количество уязвимости чем просто какие-то комплаенс проверки которые обычно смотрят на конфигурационный файл Каким образом мы подошли к завершению обзора мы рассмотрели утилиты которые обеспечивают видимость в процессе работы контейнеров Но cubernets кластер ведь работает на базе образов контейнеров из которых эти контейнеры потом запускаются у нас появляется необходимость смотреть что внутри образован Есть множество различных сканеров образов наверное наиболее основные которые стоит упоминания это три сканера это clar который давно известен на рынке от компании Aqua они оба могут быть запущены как приложения или интегрирована вся сидит Это не отменяет того факта что сканирование образов нужно делать регулярными потому что образ при сборки был хороший не было уязвимости но у нас появились новые знания Какие есть уязвимости в пакетах и тот образ который был вчера хорошим сегодня уже может быть плохим поэтому конечно же сканирование нужно проводить регулярной основе раньше еще было более полнофункциональный продукт под названием О он помимо сканирования образов предлагал установку внутри пластырь специального контроллера который позволял запретить запуск образов которые не были просканированы или были взяты сторонних репозиторов то есть Таким образом мы могли ограничить запуск только теме хранилище образов которые нам понятны и безопасно сожалению бесплатная версия ancer Range стала пользу коммерческой версии Таким образом мы видим что потихонечку бесплатное решение с рынка уходят и компании разработчики предлагают версии из того что мы посмотрели мы видели то что безопасность складывается из различных моментов это не какой-то один продукт который мог бы могли бы установить нас кластеры сказать что он Безопасен на самом деле набор неких модулей набор неких процессов которые мы с вами должны реализовать здесь я привел пример того как безопасность можно разложить на какие-то отдельные вещи на отдельные дисциплина отдельные процессы каждый которых мы сможем посмотреть отдельно Я предлагаю такую разбивку давайте начнем с управления секретами очевидно что любое приложение имеет какие-то секретные данные это могут быть ролик базам данных это могут быть сертификаты и все такое очевидно что нам нужно их безопасно хранить нужно обеспечивать контроль доступа к ним аудит этого доступа чтобы Мы понимали что кто-то посторонний не получил знание о том что у нас за секреты нужно их регулярно менять таким образом заставит управление секретами это понимание того что у нас происходит запуска и работы контейнера какие у нас процессы какие они операции выполняют видно что для этого нам нужны отдельные агенты которые будут эту информацию собирать compline это тоже очень большой важный момент в частности в компаниях которые работают с персональными данными на самом деле это почти все компании так или иначе компании которые работают медицинскими данными чувствительными данными Потому что всегда будет нависать невидимая рука регуляторов которые будут постоянно просить отчеты и требовать соответствия ваших информационных систем неким промышленным стандартам например с или всем прочим таким образом Нам нужно будет постоянно непрерывно убеждаться в том что наша инфраструктура этим стандартам соответствует и подводить ее под эти стандарты губернатор предоставляет доступ к своему API у описать все взаимодействие губернатосом происходит через его E5 соответственно возникает задача связанная с тем что нам необходимо каким-то образом доступ к этому контролировать доставлять его только тем агентам которые которым этот доступ нужен это могут быть пользователи таки какие-то системные приложения делать так чтобы у них был минимальный набор привилегий это Рыбак аудирование это про именно управление пользователями То есть кому мы даем кому не даем Откуда мы эти пользователи берем и все такое И дальше нас три таких модуля появляется это соответственно безопасность самого кластера безопасность оркестратора и техногрузок которые в нем загружены и Безопасность образов контейнеров из которых эти наши нагрузки запускаются безопасность кластера можно разбить на пике это у и теми сертификатами которые используются для взаимодействия компонента Control plain Security мы знаем что эти сиди эта база данных которые хранится вся конфигурационная информация это по сути можно сказать мозг кластера И поэтому очень важно защищать это содержимое как от возможности кражи можно использовать какие-то шифры шифрования шифрование и также контролировать в него доступ чтобы какие-то посторонние агенты не могли обратиться для взаимодействия системных компонентов кластера и обязательно Мы должны упомянуть о том что кластеры всегда набор каких-то узлов и невозможно построить безопасный кластер без того чтобы сделать безопасную конфигурацию для удобства называется и соответственно регулярно заниматься поддержкой в актуальном состоянии лением пакетов чтобы у нас узлы были хорошем состоянии их не могли Просто так если мы говорим здесь можно выделить управление с прессами которые логически разделяют нагрузки также стоит поговорить о том что пластырем мы можем запускать одновременно нагрузки разных типов например те которые публичные те которые не публичные те которые работают чувствительными данными не работают чувствительными данными и таким образом нам нужны все те доплаты все те нагрузки которые у нас есть пластырь каким-то образом классифицировать и по возможности изолировать назначать их найти узлы которые подходят для обработки данных конкретного типа обязательно также нужно для каждого типа нагрузок указывать свои наборы ресурсов максимальные значения потребляемых процессора памяти и прочего чтобы не случалась ситуация когда какая-то одна нагрузка может выйти за пределы этих параметров и привести к отказу работы другой например один кушал слишком много памяти Другой путь по недостатку памяти за механизм Киллер и это приводит например недоступности системы мы этого не хотим обязательно следует все нагрузки конфигурировать таким образом чтобы они обладали минимальным набором привилегий Для этого нам необходимо разработать стандарт их ограничения то есть по сути это получается Security restriction да то есть допускаемся с минимальным пользователем не рутом с минимальными полномочиями не даем те возможности ядра которые нашим контейнерам и обязательно как мы уже посмотрели например писать сетевые политики которые будут нагрузки изолировать друг друга по сети если мы говорим об образах то в первую очередь нам нужно их сканировать процессе сборки и потом уже регулярной основе когда они уже хранятся вырезисты Возможно стоит рассмотреть возможность которая будет доверять образ не поменялся с момента его публикаций И что он опубликован именно тем разработчикам темпа и планам который мы ожидаем они принесем откуда-то сканирование свою очередь генерирует списки компонентов сбом и списки уязвимостей этих компонентов которые есть в области таким образом если у нас вы системе появляется какой-то образ в котором есть уязвимые компонент например ssh сервер или Java пакет или еще что-то такого плана мы можем об этом узнать дальше принять решение Будем ли мы его обновлять или нам нужно переписать приложение или нам этот компонент вообще нужно заменить И что с ним дальше делать конечно же не стоит такие вещи делать на работающей системе изменения должны проходить полный цикл тестирование чтобы не допускать сбоев в непрерывности работе наших информационных систем так образа хранятся греческие специальном хранилище то возникает вопрос обеспечения безопасности самого это и работа с ним по безопасным протоколом например и управление пользователями потому что очевидно Не все пользователи должны иметь возможность записывать греческие кушать любые образование возможно нужно какая-то какое-то ограничение например команда 2 и они не пересекаются это помимо того что некоторые рейджесты например в Харбор имеют встроенную функциональность по сканированию образов как на момент когда образ поступает и также и на регулярной основе Теперь давайте посмотрим что конкретно из этого списка позволяет реализовать самку бернетов как артистатор И к сожалению мы видим то что далеко не все мы видим то что мы можем реализовать ролевую модель чуточку немножко мы можем реализовать аудит потому что мы можем настроить аудита из губернатор но к сожалению нам все равно придется разбирать его какой-то внешней системе и это внешняя система должна будет реализовывать такую реакцию управление секретами губернатосе Как такового нет Да есть объект но к сожалению его функционала недостаточно безопасности сиди может быть реализована встроенными возможностями губернатоса это просто конфигурация и соответственно вот блоки оркестре Security можно 4 пункта отметить которые тоже видно что по сути автоматически в стоимость нами возможностями реализуются получается для всего остального Нам необходимо притаскивать какие-то внешние решения например для управления секретами классический подход использования под названием он обеспечивает хранение доступа их ротацию и все прочие прозрачные интегрируется слишком губернатоса для например для аудита Икс менеджмента доступа мы используем такое программное решение которое позволяет безопасно предоставлять доступ к губернации кластерам пользователям администратором системы и все их действия записываются и таким образом мы всегда можем Посмотреть например какой пользова каждую неделю назад изменил конфигурацию кластера или создал какие-то дополнительные для runtime Security мы можем использовать например те решения которые мы уже обсудили фалька и тетрагон для сканирования тривий и Клер для подписи образов опять же мы можем на диаграмме от landscape до cnc дотаев найти два решения которые решают эту задачу это нотари и соответственно которые имеют контроллеры которые ставятся самого класса но опять же это не покрывает весь Спектр всех задач которые перед нами есть и поэтому потихонечку мы приходим к решению под названием стекла на мой взгляд она закрывает максимальное количество проблем которые на этой диаграмме предоставлены потому что решение устанавливает агенты на конкретные узлы позволяют сделать мониторинг того что происходит на конкрет комплаенс так как в решении есть модуль И решение постоянно проверяет соответствие нашего кластера этим лучшим промышленным стандартам и стройный сканер образов которые далее позволяют реализовывать процесс управления уязвимостями образов также так как решение устанавливает агенты на каждый из узел кластера то очевидно что оно может снимать определенную телеметрию самих узлов и подсказывает нам насколько безопасно конфигурация рабочего узла кластера Какие на нем есть Очень интересно то что позволяет и построить отчасти аудит Потому что если вы еще не какие-то отдельные операции которые небезопасно например подключение напрямую к воду или запуск терминалов когда мы берем и публикуем локальные машины Мы можем обращаться к сервису на локальной машине он умеет все эти события перехватывать Таким образом мы можем понять когда что-то пойдет У нас не так же эта система для себя предлагает движок политик который позволяет определить Правильно ли написано наши деплойты Стоят ли на них ресурсы квоты лимиты соответствуют ли во клоуны лучшим практикам безопасности запущены ли они по другому или нет И на любое отклонение от политик будет генерироваться события которые мы можем приходить чуточку позже я покажу как с этими событиями можно работать что с ними делать также есть движок сетевых политик точнее их написание Да и Он позволяет проверить написано ли они вообще Таким образом мы можем сетевыми политиками работать достаточно удобной посмотрим теперь на архитектуру этого решения архитектура достаточно простая У нас есть компонент под названием которое является по сути Control plain управляющий частью это это ва программного продукта в нем есть база данных конфигурация база данных уязвимостей есть панель администрирования и E5 через которые можно взаимодействовать системой это часть устанавливается на губернатор который вы выберете нужно он будет центральным к этому центральному кластеру подключаются уже узловые кластера которые мы будем наблюдать В этой системе каждый из кластером устанавливается три компонента так называемый коллектор это по сути Агент сбора данных каждого узла злые языки шутят то что на самом деле тот же самый драйвер который используется Может быть я настолько глубоко не копал но вот такой забавный Факт есть устанавливается сенсор на один кластер и один контроллер они все обеспечивают работу этой системы контроллер очевидного нужен для того чтобы запрещать запуск компонентов которые не соответ политиков и также он имеет определенную мониторинг функцию сенсор большей части нужен для сбора данных и отправки их центральную часть таким образом посмотрев на архитектуру мы можем понять то что принципиально есть два способа установки этого решения один способ когда мы выделяем один класс так Центральный и все остальные классные подключаем к нему как узловые это возможно хорошо когда у вас инфраструктура локальные вы не хотите переплачивать за дополнительные центральные компоненты И хотите все видеть виде единого наглядного но мне показалось что гораздо более удобнее устанавливать на каждый кластер полный набор компонентов то есть на каждый класс Так ему устанавливать набор мониторинговых компонентов в этом случае получается больше гибкости в настройки можно обновлять Независимо друг не боятся что-то сломать и в целом не нужна агрегациями более того регламент у меня все среды должны быть изолированы метод подхода более удобен для моих задач когда соответственно появляется какой-то ивент какое-то событие в системе есть внешняя интеграции куда можно отправлять информацию об этих событиях это тоже на диаграмме Теперь давайте посмотрим Каким образом можно установить это чудо-юдое решение по сути процесс достаточно тривиальный Сначала мы устанавливаем компонент под названием Central дальше мы устанавливаем На текущий классный узловые кластера агенты которые понимания называются сенсорами настраиваем интеграции и настраиваем уведомления установка на самом деле достаточно три вида я так я использую флаг средства установки программ и управление кластерами то я привел пример манифеста для объекта на самом деле абсолютно легко установить Единственное что нужно передать это правильно параметры по сути только пароли окио хода можно увидеть чуточку более наглядное наглядную инструкцию чтобы не ломать глаза переходите смотрите Я надеюсь что это поможет быстренько установить данный программный продукт и начать с ним работать Как только мы его установили у нас появляется возможность зайти в интерфейс административный под тем паролем который мы указали конечно же списке подключены кластеров будет пусто Это пример с рабочего с рабочей установки и для того чтобы добавить кластер в систему Нам нужно будет сделать дополнительные действия а именно установить поэтому мы можем нажать на кнопку установки кластеров появится диалоговое окно добавки кластера к системе здесь обязательно нужно обратить внимание что нужно ввести правильное название кластер это может быть любое уникальное любая уникальная строка Дальше она нам понадобится можете выбрать дополнительный параметры как сбор способ сбора данных и vpf или модуль ядра это будет зависеть от того что у вас за класс где он таких узлах Какая версия операционной системы Какая версия ядра здесь четких рекомендации дать нельзя но в целом как будто бы модуль ядра более распространенный более стабилен дает чуточку больше быстродействия и более новомодные технология Но нужно быть более аккуратно Также можно настроить всякие политики которые будут срабатывать на создание объектов их обновления логирование Или например отключение так называемый глаз аннотации которую если мы установим на какие-то объекты бластера то к ним не будут применяться политики внутри движка политик соответственно дальше переходим на следующий шаг Центральная часть генерирует для нас социальный Банк в котором у нас будут файлы конфигурации для листового узлового кластера и сертификат давайте мы скачаем а пока что мы видим то что наши панели тестовый кластер недоступен очевидно потому что мы пока его еще не подключили скачиваем распаковываем его и видим целую пачку файлов неискушенный администратор или айтишник может здесь впасть в панику Что же мне делать с таким количеством файлов на самом деле ничего страшного здесь нет большому счету из всего этого нам нужны только файлы расширение внутренний взаимодействия и здесь мы тоже можем быть уверены в том что эта система не будет компрометирована так как она внутри себя использует дальше мы находим хелим чарт для компонентов под названием стекоксирует классных сервисов так называется сенсор по официальному формируем файллюса вставляем нужные места этого файла наши сертификаты как это сделать Я показал на слайде или можно опять же посмотреть как его коду как только мы установили этот фильм соответственно мы получаем рабочий подключены к системе кластер котором уже происходит мониторинг образов мониторинг событий и всего прочего нам остается только по сути настроить уведомление для уведомлений Я выбрал потому что мы используем компании Здесь наслади представлен пример того что Какую наблюдаемость обеспечивает система сейчас видно что какой-то разработчик зашел запустил внутри под терминал если на разработческой среде это допустимо и это нормальная работа разработчика то если бы такое событие произошло я был бы наверное очень расстроен во-первых во-вторых Я был бы очень озадачен потому что это будет означать то что система функционирует не так надо и в ней происходит событие которое нежелательные нужно идти разбираться что же такое достаточно много различных встроенных политик опять же разобрали пример запуска терминала например одним из событий является создание допломентов которым есть пакетный менеджер опять же никакого резона запускать кластеры в котором есть менеджер нет это достаточно странная операция потому что сети образа которые мы приносим кластер они уже изначально должны иметь весь набор который необходим для работы поддерживает кучу разных интеграций он может не только отправлять флаг уведомления о нарушении политик но и создавать животике отправлять их во внешней системы Вроде вы можете делать агрегацию событий pager Duty писать вам письма выбираете тот способ который вам наиболее удобен из того что мне еще понравилось и показалось удобно так как мы живем в Облаке в амазоне то в амазоне есть встроенные средства мониторинга безопасности под названием реагирует события безопасности с самого облака и более того она может быть расширена внешними программными продуктами одним из которых является если вас интересует эта тема далее будет контакта Telegram чата можете туда написать я расскажу как более подробно это сделать для нас Выгода заключалась только лишь в том что наши Security офицеры им удобнее видеть единой Ной панели в амазоне чем смотреть несколько разных панели как это бывает когда у вас есть куча разрозненных программных средств которых свой Давайте теперь посмотрим на то что мы получим после установки Starex это набор куча набор дашбордов очень удобных очень наглядных которых мы можем увидеть и количество подключенных кластеров и количество рабочих узлов которые в них установлена количество нарушений политик безопасности и это очень хорошо потому что когда вы начинаете работать над безопасностью какой-то следы И ставите какое-то средство безопасности в первую очередь вы получаете просто безумное количество нарушений это нормально этому не нужно пугаться просто нужно начинать с этим потихонечку работать и когда вы определили текущую ситуацию текущее время не имеем 748 нарушений из которых 108 высоко приоритетные 108 357 низкого мы понимаем что это точка которая мы оттолкнемся и планомерной работе Мы будем потихонечку уменьшать количество всех и таким образом увеличивать каждый изделие с каждым днем безопасность нашей среды система также позволяет показать список тех образов которые подвергнуты максимальному риску это дашборд который слева таким образом она помогает приоритизировать те задачи которые могут стоять перед инженерами и я вижу что например в первую очередь не нужно поправить образ эмиссарии это такой новомодный по сути как ингли с контроллер работает и я вижу что в его области есть две критические уязвимости которые могут быть исправлены и 13 уязвимости которая важна и соответственно Я этим ближайшее время таким образом система помогает мне сформировать план работы также система позволяет распределить опять же рассказывает мне как оператору на что стоит обратить внимание в первую очередь очень интересная практика является то что система позволяет посмотреть какие старые образование запущены в кластере и действительно в этом есть Великий смысл Потому что те образа которые имеют срок сборки больше 90 дней назад скорее всего они уже обладают какими-то уязвимостями или это какие-то старые дополнительные которые мы забыли обновить А если у нас в классе что-то что не обновлялась год наверное какая-то уже проблема потому что губернатос развивается семимильными шагами Вполне возможно что этот компонент либо уже не используется либо с более новыми компонентами и поэтому стоит обратить свое внимание свое пристальное внимание и подумать что с этим делать в идеале конечно же классных должен состоять только из образов которые будут на графике отображены как 3090 опять же система помогает это увидеть и реализовать также есть разбивка по категориям событий категории обнарушения то есть события связанные с самим губернатосом и повышенной привилегии и возможно что у нас где-то нарушена правила написания допламентов это график который слева внизу также опять же система позволяет Понять насколько соответствует наш кластер лучшим индустриальным политиком перечень этих стандартов приведен на наш городе справа внизу и степень соответствия этим стандартам указано некоторым процентном выражении опять же мы можем взять идеальный сценарий довести каждый из полоска до 100 процентов к сожалению это невозможно сделать это требует кропотливой постоянной работы Но это хорошая точка для старта И как только мы увеличим процентное значение по каждому стандарту мы можем быть уверены то что система пройдет аудит у аудиторов и в ней не будет каких-то явных проблем К сожалению разработчики систем того же кабернетоса не применяют все эти стандарты по умолчанию и поэтому эта задача остается на внедренцах и на администраторах систем но Такова селяве это не только с губернатосом это со всеми другими программами продуктами потому что как правило безопасность и уже пользуются совместимости с теми программами которые были написаны те времена когда об этом не так активно думали по каждому можно провалиться более подробное представление Здесь наверное ничего особого добавить не смогу одна из действительно интересных вещей которые могут быть это карта сети мы можем визуализировать У нас есть кластеры посмотреть как проходит трафик между различными деплоитами Кто является потребителем кто источником Какие внешние ресурсы задействованы при помощи этих этого графика сетевых взаимодействий мы можем генерировать сетевые политики и более того мы можем не только их сгенерировать еще и промоделировать как они повлияют у нас есть движок симуляции Это очень крутая возможность но к сожалению в нем есть один такой серьезный недостаток он связан с тем что как работает только с сетевыми политиками базовыми губернатости почему это так Потому что есть сетевые плагины как я уже упоминал есть второй известный сетевой плагин под названием Калика их разработчики решили стандартных сетевых политик губернатоса не хватает то что их возможность недостаточно они реализовали свои венгерские они неплохие эти вендорские решения но к сожалению они требуют дополнительного навыка со стороны администраторов кластеров для написания этих политик остаток с не предоставляет возможности их автоматически генерации здесь нужно будет что-то придумывать либо оставаться в рамках базовых сетевых политик губернатоса которые покрывают честно говоря одну процентов 90 задач есть отдельная панель которая позволяет посмотреть список нарушений политик есть очень гибкая система фильтр мы можем например фильтровать по конкретным что у нас происходит данном случае я выставил фильтр на систему Мы видим что у нас есть два Клода которые нарушают политики первое такое DNS и при сборке область у нас использовалась команда место копия это плохая вещь Потому что так делать не надо обычно используют команду копий так она не имеет сайт эффектов Это можно почитать в любом гайде по дотеру и как писать до Кер файлы вторая политика это соответственно нарушение стандарта промышленного Dota по которому не должно быть разрешено должно быть разрешена монтирования К сожалению в амазоне Нельзя просто взять это поправить поэтому это нарушение правил будет у меня висеть с уровнем что мне реально нравится та степень видимости которая обеспечивает Эта система потому что можно зайти например dashboard управление уязвимости получить список всех своих образов понять что когда где было за деплоена если активное образование из которой сейчас запущены какие-то воплоды или у нас есть образа которые когда-то были использованы уже не активны и разбивку по количеству и качеству у меня получается такой интересный график Но на самом деле мне нужно стремиться к тому чтобы его правой части не было и вниз тогда система будет максимально безопасной и также система Дает подсказки что собственно говоря нужно делать с этими образами как исправлять если мы провалимся например в образами которыми я раньше говорил то есть я могу увидеть список всех уязвимых его компонентов увидеть где он используется список уязвимости Понятно для инженера видео и соответственно получить инструкции о том что мне с ними дальше делать К сожалению система на текущий момент времени разворачивается полочном режиме как я уже показал есть фильм для установки этого по большому счету достаточно для старта но хочется настраивать и те настройки которые есть добавлять политики убавлять политики настраивать интеграции все прочее и здесь есть проблемы с автоматизацией На текущий момент времени пути есть разработаны компании два года уже не развивается никаких антибаралей для управления инсталляции К сожалению нету оператора который мог бы тоже подготовить полностью готовую работе установку со всеми необходимыми настройками политиками тоже нету но есть хорошая новость есть утилита командной строки которая коннектится соединяется с компо и позволяет реализовывать большую часть действий Я предложил ссылочку на ее документацию не нужно пугаться что это ведет на сайт Потому что так как когда-то давно был отдельной компании Потом эта компания была куплена брендирован в ряд Секьюрити и стал частью пакета openshift то есть таким образом есть две веточки развития такса бесплатная и коммерческая которая внедрена вы оркестратор от компании мы сейчас говорим про бесплатный утилита строки естественно плюс минус одинаково есть также httpi К сожалению нормально документации по нему нету Поэтому приходится замарать свои ручки сходить сходники но принципе интерфейс достаточно стабильный и если найти те вызовы которые могут решить ваши задачи то Нет проблемы их использовать потихонечку мой доклад подходит концу давайте наверное подведем какие-то выводы Я в заголовке докладов задал такие вопросы дешево ли эффективно ли сердито ли я считаю что Да на самом деле Да потому что система по сути Неудивительно что купила и перебрендировала мы получается можем на базе консультной версии получить практически все те же самые возможности которые есть платной версии цена ноль у нас остается только стоимость внедрения Как видите по большому счету развернуть никакой проблемы нету это достаточно дешево решает задачи безопасности решает да Он позволяет мне лучше понимать что происходит моей системе и реагировать на те события которые не происходят и не допускать развития каких-то проблем Вот на этом наверное все спасибо большое за внимание на последнем слайде Я предлагаю свои контакты Если у вас есть какие-то вопросы по данному программному продукту Можете писать мне а также есть специальный канал русскоязычный канал поставь котором вы можете получить помощь на этом все Большое спасибо за внимание Большое спасибо теперь Давай ответим на вопросы вот один интересный вопрос задали в чате его Да его задал Дмитрий голошубов сталкивались ли вы с проблемы поддержки runtime strex politic на старых версиях ядра например политики типа Запуск программы в контейнере с определенным именем не везде работают Дело в том что вот конкретно я могу себе позволить работать в Облаке и в Облаке по соображениям безопасности мы стараемся использовать последние версии операционных систем а последняя версия операционной системы автоматически означает последнюю версию ядра я понимаю где может такая проблема возникнуть например на отечественных предприятиях которые используют Metal сервера в целом Я бы смотрел бы в сторону обновления парка операционной системы по возможности потому что дает не только с точки зрения безопасности и так как оно в целом это хорошая практика Так там есть очень много вещей которые улучшают производительность работы ваших систем но Дмитрий еще комментирует что Рокс сетели для проверки образа ожидает что образ уже запущен в registry и не всегда такое подходит Видимо они как-то там собирают через образа который находится Спасибо большое а теперь предлагаю тогда уже перейти в дискуссию если коллеги у кого остались какие-то вопросы то в принципе можем уже в рамках дискуссии поэтому Докладываю их обсудить Всем большое спасибо"
}