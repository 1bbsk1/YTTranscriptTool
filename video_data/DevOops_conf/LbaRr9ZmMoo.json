{
  "video_id": "LbaRr9ZmMoo",
  "channel": "DevOops_conf",
  "title": "Алексей Казин — Токсичные репозитории. Что сейчас происходит с open source?",
  "views": 864,
  "duration": 1710,
  "published": "2024-09-13T02:25:45-07:00",
  "text": "Итак друзья Всем привет Меня зовут Алексей федулаев я руководитель направления автоматизации безопасной разработки Wildberries и хочу вам представить Алексей казино поаплодируем его Давайте поднимет немного необычную но интересную тему наверное хотел бы немножко рассказать как мы познакомились это было достаточно интересно Я выступал с докладом про анализ библиотек как раз напомнил упомянул в докладе про токсичные репозитории смотрю кто-то на первом ряду это я это я это я вот так собственно познакомились а его пригласил выступить с докладом передаю слово Алексею Спасибо Привет Сегодня я хочу вам рассказать про токсичные репозитории но для начала хотелось бы представить себя уже было сказано завод меня Казин Алексей Я работаю в obs инженером также являюсь мейнтейнером репозитория токсичной крепость и является автором канала Как перейти из сисадмина в devops как я уже сказал Работая в компаниифт это разработчик крупнейших государственных информационных систем у нас много миллионов пользователей у нас десятки проектов и в нашей компании более полутора тысяч сотрудников о чем мы сегодня будем говорить Ну во-первых мы поговорим о том вообще что такое противор в частности именно в Open Source затронем кратко историю создания репозитории токсе крепость и также расскажу про Самый наверное яркий пример против за последнее время Эта история с разработчиком вообще с проектом ppc затем мы немножечко окунемся в историю и после этого сделаем некоторые выводы и возможно обсудим что вообще с этим делать значит обязательно хочу предупредить что все что я буду сейчас рассказывать это является моим личным опытом у вас он может отличаться по жизни тема возможно покажется кому-то провокационной и неудобный и возможно вызовет жаркие дискуссии Поэтому прошу сдерживать себя значит и данной доклад соответственно само собой не несет задачи с собой вот кого-либо оскорбить Так что же такое вообще против вообще это универсальный термин который используется для описания как пакетов так и вообще исходного кода которые были специальным образом изменены Вот именно в плане выражения какого-либо протеста на определенные события и в отличие именно от вредоносных пакетов вредоносного по Эти пакеты изменяются не хакерами Да какими-то а именно их владельцами и вообще на самом деле уважаемыми людьми например в сообществе когда мы начали создавать наш репозиторий мы для себя выявили пять основных типов типов протестного по то есть И вот они расположены от простых до опасных назовем вот так самый простой это баннеры в репозиториях Да в частности в Риме Когда разработчики располагают там любые лозунги призывы оскорбления как вариант это самый безобидный вариант второй уровень это слоганы политические лозунги именно когда они появляются влогах либо все лай То есть это когда у вас влогах что-то появляется или вывоз командную строку например третий тип протестного по это исполнение нет деструктивного кода в данном случае Наверное это создание каких-нибудь файлов файловой системе пользователя возможно какими безобидные всплывающие окна открывающиеся ссылки в браузере и четвертый тип протест это деструктивные протесты сегодня как раз таки ярких примеров расскажу но бывает инструмента для Адидаса но я думаю что сегодня мы это и Тема касаться не будем это все-таки отдельный пункт должен быть значит Ну перед тем как начать я кратко буквально расскажу историю вообще создания нашего проекта наш проект был создан в марте 2022 года Вот и был он направлен на создание реестра именно вот свободного повода Open Source с признаками даст наличием против изначально мы появились Вообще наш проект основывался на Google таблички от техдирского клуба есть такое скажем так известный канал с техническими директорами мы их табличку взяли за основу обработали убрали дубли сделали классификацию и все это перевели в два формата и цсв и сделали это как репозитории После этого мы запустили сайт запустили Бота чатик телеграме и у нас стали поступать скажем так заявки на включение в этот список пользова то есть кто-то обнаруживал там блокировку по IP адресу из определенной страны кто-то обнаружил там какие-нибудь лозунги Да там призывы и мы потихонечку росли вот сейчас на середину сентября у нас 667 записи в нашем реестре и вот на сегодняшний день за последние полмесяца было подано порядка еще наверное 15 обращений Вот это так кратко про наш проект Теперь давайте же я вам расскажу про историю с разработчиком все началось 7 марта когда разработчик выпустил версию 10.1.1 и в коде был добавлен таймер который рандомное время вызывал собственно добавленный Код Этот код Что же он делал он свою очередь получал доступ файловой системе и начинал от корня и дальше замечать в файлах содержимое смайликом виде сердечко вот причем что самое интересное это происходило только если пользователь имела айпишник из Беларуси либо из России и через 10 часов после этого выходит обновленная версия это на самом деле было сделано только для запуска автоматического запуска обновления зависимости значит на следующий день 8 марта выходит очередная обновленная версия в которой все эти изменения были откатаны вот таким образом скажем так зараженная версия про было меньше суток в открытом доступе но из-за того что это проект с многими наверное миллионами Да можно сказать зависимых от неё от этого проекта проектов это за эффект тела очень большое количество собственно проектов Но в этот же день появляется версия 1100 и в ней уже автор пошел по другому пути он уже прописал зависимость от модуля из not War который он же самый разработал и там были как раз таки второй тип протестного по это когда лозунги и слоганы выводятся а спустя неделю разработчику По всей видимости показалось то мало вот и он обновляет версию девятую ветку Да в частности версию 922 так как это была последняя именно стабильная версия Вот и на неё именно вот по dependency ссылалась просто нереальное количество проектов огромное Вот и какие изменения были внесены был собственно также внесен внесена такая также зависимость от модуля pismot War также был добавлено было добавлена зависимость от модуля Colors который уже на тот момент себе содержала вредоносный код вот ну и самое наверное странное по-детски неприятные Да это изменение лицензии Смита на лицензию кому интересно Я рекомендую с ней ознакомиться но осторожнее 18 плюс там не очень много скажем так неприятные лексики и в этот же день версия 11 11 ветка обновляется и там также добавляет зависимость но при этом именно вывод вроде бы на это можно было успокоиться но спустя три дня разработчика нода PC который известен под ником Мария евангелист его полностью дианонят взламывают его Twitter и на dogsby не выкладывают всю абсолютно личную информацию его и его жены вроде бы это опять же в наше время случается но самым наверное неприятно в этом сливе было что они выложили хакер Да выложили информацию о аккаунтах анкетах самого бренда Миллера на сайтах знакомств из которых стало понятно что он изменяет своей жене то есть это для него это было не очень приятно вот потом началась такая баловство наверное начали заказывать на его домашний адрес много пиццы видимо с ананасами и собственно к чему вообще все это привело после этого по его адресу проживания была полиции по причине якобы удержание заложников произошло задержание с применением физической силы то есть при этом достаточно серьезно пострадал это разговор о том что все что мы делаем в Интернете Может отразиться на нашей реальной жизни и теперь если подытожить вообще вот этот весь инцидент с нотой PC Это не просто да там какой-то непонятный инцидент это зацепило несколько крупных проектов в частности от vgs потому что он имел зависимость от 9 ветки дано до писе Вот Но их зацепила не сильно да то есть у них там буквально вот доступ файловой системе был созданием на рабочем столе файла везла в Chrome Америка вот так же и второй крупный проект который пострадал от действий разработчика это игровой движок Unity потому что у него тоже содержалось зависимость от пола Ну как бы можно задаться вопросом да типа и это все на самом деле вообще против плеер он существовал еще и до этого вот сейчас я предлагаю буквально вот рассказать вам один случай который произошел задолго до истории 100 dpc Я его назвал Да как сломать крупные сайты за 11 строк кода в 20 марта 2016 года разработчик нпн пакета который как раз таки содержал себе буквально 11 строк кода он знак протеста удалил все свои вообще пакеты все свои наработки их было по-моему 242 штуки собственно почему он это сделал потому что у него был пакет с именем Кик и к нему пришла компания которая владела правами на торговую марку Kick и сказал ему парень переименовывай свой пакет и собственно хранилище таких пакетов пошло навстречу правообладателям и из-за этого разработчик психанул и снес вообще все свои проекты вроде бы мелочь но это зацепило один из пакетов реакт который в частности собственно вылился в то что как бы поломались крупные сайты которые зависели там от 11 строк кода буквально Какие вообще вот можно сделать выводы из собственно вообще всех этих вот действий Да которые имеют общее название против выводов лично для меня два да то есть то что Вера в Open Source проекты она подорвана и вот последний год она подорвана мне кажется была вдвойне так как люди до утра разработчики вроде бы Уважаемые да то есть известные личности Они ведут себя Ну некорректно как я считаю лично вот и опять же это добавило проблем разработчикам Нам же надо вовсом именно в плане риск использования последних пакетов риск обновлений сейчас мы вынуждены фиксить версии накатывать обновления вручную Что же делать сегодня сейчас Да я не буду говорить про техническую сторону Об этом можно будет задать вопрос Алексею федула его как раз таки вот я наверное расскажу больше человеческой точки зрения так как текущая ситуация и вообще в мире из Open sources является нестабильный Да мы ожидаем что в будущем Мы увидим не только новые векторы угроз но и увеличение вообще количество Атак и угроз на Open Source именно связанный с протестным выражением своего мнения что же с этим делать Я бы на самом деле третий пункт все-таки Поставил на первое место да то есть это в целом мы как вовсе как может быть разработчики Да ваша команда должны повышать именно культуру опенсорса мы должны своим примером показывает что не нужно такого делать также нам нужно обязательно продолжать общаться именно с Open Source поддерживает разработчиков соответственно не только финансово но и квестами И вообще добрым словом и также нам нужно вести именно диалог сообществом и пытаться выработать какие-либо Шаги по нахождению консенсуса да то есть Все мы люди все мы эмоциональные но нужно как-то вот выработать консенсу что Open Source Он вне политики вне протестов он независим ни от кого и ни от чего Как бороться Ну опять же да фиксить версии изолированные среды сборки ревью кода Ну опять же это все технические моменты но также наше сообщество разработало два небольших репозиторий два небольших пакетика один называется токсикоз фильтр другое называется фильтр они для пип и npm они себя представляют некий аналог маленького прокси который не будет затягивать зависимости например который выпущены до версии пакетов которые выпущен после определенной даты в конце будет где можно будет ознакомиться перейти по ссылочкам знакомиться с этими наработками и возможно что кто-нибудь что-нибудь туда Спасибо вам всем за внимание готов ответить на вопросы Спасибо так наверное самый первый вопрос будет от меня вопрос опробовали ли Вы обращаться к самой площадке github пробовали ли вывести диалог показывать какие-то деструктивные моменты потому что наверное это не совсем правильно что какие-то вирусы распространяются Да мы пробовали у нас были обращения причем Даже были обращения в рамках именно то есть не просто да там один человек писал репорт на гитхабе А мы именно собирались группы до нашем чатам и репортили реакция хаба ровно 0 пакеты как существовали так и существует до сих пор И вообще никакого ответа В итоге реакции вообще никакой она нулевая Так хорошо тут есть несколько вопросов чат Давайте с них начнем последнее обновление у вас на github 4 месяца назад за это время не нашлось больше ничего или проект больше не поддерживается проект поддерживается сейчас количество обращений у нас сильно упала не буду до этого скрывать поэтому мы делаем кумулятивное обновление и следующее обновление как раз таки на запланированы на среду на этой неделе несколько раз слышал вопросы Что сейчас практически такой не встречается все ранее зараженный пакет они вычищены Прокомментируй пожалуйста Совершенно верно Да но этот реестр все равно я считаю будет существовать Потому что если человек выразил какой-то протест любой именно Хотя бы даже в ритме то этот разработчик уже частично себя скомпрометировал и от него можно ожидать каких-либо других действий поэтому такой именно Хотя бы даже фильтр именно по разрабам Мне кажется он должен быть Передайте пожалуйста микрофон Привет Спасибо за доклад Я бы хотел спросить такой ну странный вопрос а вдруг у нас ну кто-то из разработчиков npm Toxic фильтрации или пип Токсик фильтрс решит протестное какое-то штуку туда залить и как с этим типа как мы проверим то же самое вот мы устанавливаем пакет mpm Токсик фильтра вдруг там есть протестное по Ну туда тут это так она цепочку поставок Насколько я понял из вопроса на самом не обязательно вдруг если кто-то из ваших ребят такой скажет разработчиков сделать протестное фильтрс я его тоже устанавливаю как пакет Вопрос хороший но так как это все-таки Open Source то вы можете сами проверить Исходный код и убедиться что там например нет никаких закладок или какого-либо молваре спасибо Я даже немножко дополню на самом деле Ну понятно что мы используем множество пакетов и не всегда мы можем проверить Исходный код у всех пакетов собственно использование latest Я никогда не рекомендую то есть любое обновление зависимости она должна быть осознанным вы должны понимать Почему вы переходите на эту версию если какие-то проблемы с этой версии также еще прозвучало что как раз нужно использовать внутренние реджистрее различные То есть у вас должна лежать локальная копия используя библиотеки пакета чего-то еще то есть неважно что с ним случилось откатили Там версию залили какой-то код удалили любые действия у вас лежит локальные вы всегда можете это использовать вот если кратко и фиксировать версии это прям как мантра Привет Спасибо за доклад такой вопрос что если вот как например с этим пакетом Вот он с определенного времени начал протестовать а он же в какое-то время может перестать протестовать и дальше разрабатывать по То есть может исправиться то есть нужно продолжать проверять эти последующие версии наверное и если в дальнейших версиях уже ничего этого не будет то наверное можно и убрать новые версии из-за черного листа данный вопрос на самом деле поступает постоянно Да что не хотите ли вы убирать разработчиков которые искупили свою вину Да там признали что они были неправы Ответ здесь один он кардинальный Нет эти разработчики не будут убираться из репозиторий потому что как я уже сказал ранее они себя дискредитировали к сожалению поэтому стоит ожидать что если произойдут какие-либо события в будущем все может повториться а я чуть тоже дополнит момент смотрите все эти действия это уже пост какая-то реакция то есть сначала Произошло Это кто-то должен обнаружить и кто-то должен найти то есть в любом случае кого-то это зафиксит прежде чем он также сможет например привести в репозитории либо случайно идет но наверное маловероятно все-таки чаще всего это обнаруживается когда на какую-то целевую систему устанавливается пакет и мы видим что что-то пошло не так мы Никто из нас не может предсказать В какой момент и станет ли какой-то пакет деструктивным Вы должны всегда этого ожидать от любого пакета Я понимаю что вы можете выставить какой-то цепочку доверия там Microsoft что вряд ли они будут там каким-то таким вещами заниматься Эти пакеты мы можем доверять но в целом наверное может что-то пойти не так и любой пакет в какой-то день там неважно что случилось что-то может случиться Поэтому всегда этого ожидаете более того очень много именно так на разработчиков пакетов то есть взламывают npm репозиторий выкладывают маловарный код взламывают гитхабы там например и через него через gith A paction заливают в тот же самый npm код который затягивает потом себе разработчики это очень опасно должна всегда быть там фиксация пакетов и конкретной версии опять же как вариант Вы можете сделать не проксирующие репозиторий а Хоста куда вы вручную добавили нужные пакеты туда Никак без вашего желания не попадет там какая-то новая зараженная версия пакетов так прежде чем мы Следующий вопрос из зала тут есть еще вопросы в чат про фильтр токсичные Мы вроде ответили а проверку проверку какую-то проводите только по github или или репозиториям тоже Проводится ли проверка например для моего артефактов же размещается в формате jar вы где компилируете но такие проекты там не поступают По всей видимости как раз таки из-за сложности Да их анализа у нас к сожалению в основном это либо вот репозитории какой-нибудь и большое количество нас именно еще интернет-сайтов которые там закрыли например доступ да Опять же с определенных IP адресов Ну в данном случае все зависит в основном от комьюнити Вот потому что например там нашей маленькой команде Да там буквально два-три человека скажем так перелопатить все это вручную достаточно сложно поэтому Мы надеемся именно на помощь комьюнити самого так еще вопросы Из зала Спасибо за доклад вопрос в терминологии такой не то чтобы докопаться и так далее да удаленный 7 лет назад пакет это наверное не совсем протест Это скорее просто компрометирующее действие то есть И что Называть протестварью да то есть когда у нас ситуация что история про удаленный пакет она и в эти последние там года тоже была не связана не с политикой ни с чем то есть из разных причин люди удаляли свои пакеты а люди которые не использовали прокси репа очень горько плакали искали Эти пакеты на локальных машинах и так далее То есть это раз момент второй момент у вас присутствует история связанная с вот этими баннерами на сайтах там закрыли доступ Какой это имеет отношение к протестваре это ну как бы это выражение протеста понятно да но она не относится Там копан сорсу и так далее ну то есть может косвенно Да там на сайте написано что же все-таки такое протест твари То есть это все-таки макет вообще против твари Да это достаточно обширная тема Но в данном случае мы вкладывали в это именно любое выражение протеста то есть будь то лозунг призыв будь то удаление пакета вот изначально же там был просто лозунг в даунте не более того А потом понеслось затирание файлов То есть это уже было по нарастающей Ну понятно Да сегодня лозунг завтра НТВ Спасибо еще раз вопрос Скажите получается что к примеру сейчас на сайте Нет ну почему вы жить без женских наверное не будем Вот Но по крайней мере как минимум стоит ожидать что в будущем возможно например они закроют доступ например из России Почему нет то есть они уже выразили некую свою позицию Да некий свой протест и соответственно стоит по крайней мере отслеживать хорошо спасибо Да спасибо большое вопрошающим Давайте по ХП запретим пожалуйста я вот ну мне так пришлось потрогать его спустя хреном лет и оказалось что camposer в принципе при сборке там вывозят всякое прямо в консоль вносим список или он у вас уже есть списки все отлично Я теперь спокоен ждем следующего шага Спасибо тут наверное все таки самым самым важным что хотелось бы отметить это Open Source не место для таких действий и в принципе наверное не та площадка Где стоит заниматься это может эффектить на Большой на огромное количество людей есть очень много печальных примеров по типу надо PC где и там по своим люди получается по той стороне которой они поддерживают своими действиями били просто били вообще по независимым проектам или как-то ещё и в принципе наверное ни к чему хорошему это не приводило и основной целью как раз наверное хотелось показать что давайте просто делать заниматься именно творением кодингом А не каким-то вот политическими ситуациями всем прочим наверное Вопросы больше нет Спасибо за внимание"
}