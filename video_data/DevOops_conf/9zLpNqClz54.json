{
  "video_id": "9zLpNqClz54",
  "channel": "DevOops_conf",
  "title": "Виктор Гамов — Прокси, шлюзы и сита. ЧТО-О?",
  "views": 779,
  "duration": 3745,
  "published": "2021-12-08T04:02:31-08:00",
  "text": "всем привет ето devops 2021 и мы с очередным докладом мы поговорим по прокси шлюзы и сито и поговорим ни с кем иным как другую сторону с виктором виктором гамовым прошу дать всем привет я уже немножко помахал кстати андрей вот спасибо что ты доклад в переводе сказал да и на самом деле я очень сильно страдал пытаюсь перевести вот эти все название но потом мне сказали что англичане zmey или как мы их называем в принципе их можно это ничего такого страшного в этом нет но на самом деле вот это такой хороший вопрос который может быть пообсуждать потом с аудиторией как они собственно называют вот эти все вещи я знаю что в предыдущих докладах на диву psy в прошлые года вот например антон вайс ну да термин ситар уважал уже был введен сервисная сито у нас уже как бы есть поэтому будем его тоже как бы придерживаться когда будем говорить про сервис меж а ты вернул соответственно термин шлюза относительно и пеги твоих то есть может тоже как-то привыкли в общем а теперь о какие такие шлюзы но это это те самые дни твои которых о которой все говорить о самой и самой трубы через которая в интернет общается если вы достаточно как бы давно в индустрии скажем так как мы с андреем вы помните эти знаменитой технологии которые должны были сломать интернет вот про них сегодня будем разговаривать но коли уж зашло зашел разговор о давно дата наверное представляя виктора который возможно и не нуждается в представлении вообще хочется вспомнить историю крайних 4 лет когда виктор в общем то про вроде немножко технологии говорил виктор что случилось все нормально как бы мы растем и развиваемся новые технологии появляются поэтому нужно продолжать развивать но не не это сама не уходить из нашего доклада потому что там все таки будет небольшая такая вот сделаю небольшую интригу чтобы люди оставались на не знаете как ютьюберы они герб смотрите этот досмотреть это доклада конца отлично отлично доклад будем смотреть до конца но давай еще пару моментов виктор соответственно он помогал нам делать программу на деву psion в этом году вернулся программный комитет виктор продолжает участвовать в записи прекрасного подкаста разбор полетов который он уже называл тоже тоже вернулся в этом году до называется наобещал обещал не возвращаться и как водится сдержал свое слово вот но конечно никто этому не верил что что виктор покинул подкаст соответственно видно что в прекрасной форме не забывает про качалочку и про к зож это круто вот но и по выступлениям виктора да можно отслеживать как развиваются вообще говоря айтем и мы работаем вместе давно виктор работал с фронтовыми технологиями и по этому поводу выступал из джавой работал по этому поводу выступал там с кафкой работал по этому поводу выступал сейчас работает в компании иконки и соответственно principal developer advocate и выступает как раз по этому поводу тоже конференции навсегда поэтому джалла все равно продолжается она все в наших сердечках это java java поэтому мы какие-то вещи которые я рассказываю затем на стримах иногда у нас бывают или там видосики там java чего все поля хотя достаточно тяжело кстати вот для тех сторожил которые в на девушке не первый год а есть интересная история вы кто вспомнит историю про ло и как она вернулась к нам два года спустя да да вам и я программирую на лова да звучит на звучит нормально вот такая она жестко вернулась нам их история теперь алова у нас во все поля потому что конг написано ло и много чё там бежит поэтому про это тоже может спросить потом в комментариях да мы призываем вас задавать вопросы в чатике мы обязательно их донесем до виктору я с успеем во время эфира если нет приходите в диск ученую зону мы обязательно все это обсудим ну а сейчас собственно говоря давайте контенту году техника missksu так сказать да уже подати дичь спасибо спасибо андрей спасибо за это приветствие очень радостно вновь вернуться на devops каким-то образом она моя уже любимая конференция получается что на defuse я выступаю больше чем на другие конференции dogru и люблю люблю люблю devops а сегодня я хочу поговорить про вот эти все технологии которые ты назвал прокси шлюзы или по английски и gateways и 5 gateways сервисные сито они же сервис меж поэтому если я когда-то буду вставлять английские слова вы не обращать внимание не ругайте меня сильно мото начнем с простого начнем с простого когда мы начинаем эти это все такое маленькое красивая замечательные мы это холим и лелеем это мы разрабатываем какую-то новую часть системы разрабатываем какой-то модуль og мы разрабатываем какой-то сервис он клевый но как только мы должны двигать его с нашего лаптопа или с компьютера совесть где вы разрабатываете ситуация может меняться в зависимости от а потому что вот этот вот этот мир сервис который делает одну какую-то хорошую вещь он должен либо становиться жирнее чтобы функциональность которую этот микросферы сделает была востребована во многих частях системы либо он должен научиться взаимодействовать с другими сервисами должны проявлять сервис дополнительных которые позволяют накидывать различную функциональность связанную не только с бизнес задачи по сервису но из побочки всякой а который отвечает за важные аспекты как за этим сервисом следить а вот эти аспекты объема melody аспекты понимания того что происходит внутри я кстати не знаю как вы переводите обзор mobility но подобного беллы теме виду все аспекты связаны с метриками с лагами и стрессами вот это все аспекты связаны security очень важный аспект который мы обычно забываем в конце но этот важный аспект нужно добавлять различные аспекты связанные с отказоустойчивостью из возможностей сервиса чтобы он ну как бы жил и не падал до то есть то что мы называем на английском reliability in florence а вот эти вещи мы сдохли и потихоньку вся наша система начинает обрастать начинает обрастать различными штуками она же внять начинает и в итоге мы приходим в какой-то темный лес все начинается для нас выглядеть достаточно страшно появляется куча мертвого кода в какой-то момент и наш микро сервис уже не такой красивый как как все начиналось все почему потому что построение городе маленькие-маленькие в маленькой функционального большие проблемы потому что кроме этой функциональности начинается дублирование кода начинается появление в заманить с другими системы либо мы это периметр имитируем в нашей системе либо мы это использую другую систему в итоге ситуация как классические наш слайд я подсылает практически использовать любой презентации потому что всегда нужно создать какой-то со спицы вот как раз с проблемами взаимодействия систем то что мы называем в компании kong клауд connectivity вообще вот вся вот эта вот область вот тоже не знаю как сказать по парус по русскому connectivity да и то есть вся область который отвечает за взаимодействие систем на уровне сети и как это взаимодействие строится как этим управлять на уровне программным мы живем в мире в котором software так сказать ест весь мир и soft and networks и вообще весь роутинг тоже построен на программном обеспечении мы не будем варить какое-то железо сегодня вот поэтому будем говорить про различный подход и паттерны который я сегодня буду разбирать они будут применимы и другим системам но если будет что-то связанное с вас конгом и листа на кума меж я буду об этом говорить потому что в компании kong собственно собственно почему я здесь да я работаю в компании kong дикий там я девелопер адвокатом в общем я общаюсь с разработчиками я общаюсь с программистами архитекторами и пытаюсь помочь им решать это их проблемы а те кто знает обычно мой twitter всегда он там вот внизу всегда можно пойти и подписаться спрашиваем вопросы в твиттере подписать на мой канал обязательно и заходите telegram у нас есть канал про конт есть канал прокачку кстати кафки андрей только куда делась кафка кафка это наша все было последние четыре года и чтобы подытожить так сказать этот опыт я был призван помочь написать моим коллегам а вот эту книгу которая выходит уже буквально вот-вот возможно если вы смотрите нас в записи когда-то в будущем книгу уже вышла и доступно на полках если в эту книгу купите где-то меня встретите в реальной жизни я обязательно вам ее подпишу сфоткаемся запросами в интернет а кафка in action dot org а пожалуйста смотрите но все короче все выступление закончилось теперь погнали говорить о нашем собственно места о материальной части начнем вы говорите с концепцией шлюза до или и 5 gateway и чем это отличается от простого русского слова прокси-сервер когда мы старый добрый заставили squid когда мы ставили apache и у нас вот теперь это все каким-то волшебным образом называется и 5 тобой и почему же это так что же такое 5 твой давайте начнем поговорим об этом для начала концептуально и пегий твой это это потому все таки да которые имплементировать уже определенным программным обеспечением но на самом деле этот потом который приехал к нам из без похожих патронов в других как в языке например он может быть каком-то присутствует потому по сути дела это такой промежуточный слой промежуточный объект который позволяет перехватывать или даже не перехватит просто все request и от клиента идут на это не этого и уже и 5 где твои разруливает эти request и это самый простой способ который позволяет мне объяснить но тут верный слушателей слушатель у которого немножечко внимательность присутствует как видите даже просто прокси но как говорил наш в барри аллен тесака такое очень но это по-простому язык по рабоче-крестьянской да но есть еще не что больше один из паттернов когда применяется и 5 gateway и для чего он применяется и какими возможностями он имеет называется вот тот самый сервис коллективе который обеспечивает взаимодействие сервисов на сетевом уровне давайте вот эту картинку которую мы видели на предыдущем слайде немножечко расширим и теперь у нас поверх вот этих двух слоев взаимодействия двух систем по поводу взаимодействий между клиентом и gaga твоим и это гейт в.м. и то что мы называем вот этот up stream сервис до сервис на который мы будем дальше ходить c5 твоим мы можем проложить определенный слой в которой мы можем добавлять различные клевые фишки по по-научному по-взрослому это называется lcn policy да четко lc man в терминологии современным мы используем модель в стива взаимодействия которое было придумано более близко к модели оси и ел симон у нас показывается уровень уровень а предложений на уровне приложения у нас работу такие протоколы как и что печь дпс а и все что бежит по верх и степи the soup герпесе который бежит по верхней части пе-2 например там граф quelle который бежит просто поверх это же и т.п. вот это все называется elsen протоколы почему мы можем на них делать и какой-то акцент потому что этот протокол достаточно легко разбирать он request bass да то есть там не нужно никакого спринга но например кроме вот герпесе подписи есть string и египет 2 дает нам такой persistent на соединение или например если мы бежим в абсурд это тоже собственно цен на эти протоколы можно по вне она уровню такой промежуточный слой и вместе с этим мы можем городить всякие интересные вещи например если сервис который мы вызываем этот up stream сервис который вот на уровне на уровне 5 вот я про вот эти сейчас ребят говорю например кто-то его разработал кто-то его написал но забыли про security как обычно до или он был давно написан а он был legacy каким-то таким сервисом и там ход от него потеряли равно или может быть это кусок который принесли от вендор от какого-нибудь и холода у нас нему нет поэтому тебя gate ведь здесь выступает как раз вот этим промежуточным слоем к который может добавлять различные интересные вещи здесь например вот между вот этим слоем мы можем по между вот этим слоем мы можем положить слой который будет отвечать за то чтобы не перегружать вот эти и пьяни то есть это называется ли митинг то есть мы когда позволяем замедлить какие-то операции и сказать что клиенту типа подожди мы не справляемся и и нипелю на сервис а между клиентом и например и тяги и твой мы можем проложить например же защищенный канал такой как и gps так как как я уже сказал это и pr сервис не был предусмотрен там сеть урна мы можем поверх этого положить различные различные штуки дальнейшее и люстрировать дальнейшее дальнейшей иллюстрировать дальнейшие мои рассказы поможет мой друг и так сказать персонаж на которого я люблю смотреть как на отличного лидера как и на представителя человечества и вообще замечательного человека плюс отличного актера жан-люк пикард и корабль enterprise я надеюсь что уже в 2021 году у нас достаточно много россии фанатов стар трека есть поэтому мои метафоры будут понятны я люблю star trek люблю вот это вот все и определенные аспекты жизни жан люка пикар ее связи с другими инопланетными цивилизациями помогут мне сегодня объяснить вот эти концепции жан-люк пикард меня будет представлять наш сегодняшний ну какой то и какой-то сервис да есть какой то какой то часть нашей системы например он там будет представлять и пи ай который например на вход получает картинку она выхода выдает имя человека который изображён на картинке вот такой вот простой будет узкий сегодня и это естественно эта система была написана и используете кита хитрый алгоритмы что мы не можем ее просто так вот отдавать людям чтобы они у себя где-то инсталлировали мы и решили сделать как сервис соответственно для того чтобы предоставлять ее как сервис мало того что мы должны взять mvp мало того что мы должны иметь какой-то код который собственно делать то что делает у нас как только мы его готовы уже показывает людям приходят очень грамотные и высокопрофессиональные люди которые позволяют нам все это дело тепло и на продакшене и поддерживать это на продакшене то что мы называем devops уже не шутка шутка а то что мы называем и сары до сайты лоббировать инженер который позволяет все эти вещи с diplo и чтобы эти вещи успешными бежали в продакшене возникает очень много вопросов что же делать я но что как там накрутить различные метрики чтобы нам мы понимали что там происходит в этом сервисы как накрутить авторизацию как накрутить а унификацию добавить различные логин хитрый может быть и request окиньте можно кэшировать все такое вот это вот все и возникает различные когда уместный вопрос кто это все будет делал писать вот как это все сделать естественно если мы мы это все садимся и начинаем писать мы собираемся ки фреймворке если мы напишем на джаве у нас есть спринт but i поверх него есть всякие обвязки которые позволяют нам интегрироваться с различными системами есть атом какой netflix ссср который тоже включайся компоненты которые позволяют решать вот эти все проблемы но что будет дальше если мы будем внедрять еще один сервис мы должны это все дело опять же повторять мы все это должны делать по новой и так далее там под а если мы решим писать и на джаве а если мы решим писать все это дело на год то есть нам нужно будет искать свой к-куда spring framework там искать библиотек и там все это реализует в жизни же андрюха пикара случались случай когда определенный набор таких расширений ему был предоставлен бесплатно в тот момент когда его решили ассимилировать в коллектив бога соответственно он в принципе его функция как вы живого организма осталась такой же но появились различные плюшки обвязки например вот нашего сервиса автоматически появляются такие обвязки если мы его отдаем наружу через вот этот как раз и пегий твои или этот шлюз потому что на уровне шлюза мы можем все эти вещи имплементировать все эти вещи связанные с функционированием этого сервиса мы можем добавить туда как плагины если мы говорим конкретно про канг конг расширяется за счет набора различных плагинов 10 вот как раз это шутка которую мы говорили как нам как нам lua вернулась как мне lua вернулась опять же в новом в новой ипостаси собственно kong является собой имплементации вот этого пгт который через частично базируется на engine.exe а если быть более точнее она базируется на технологию заяц опен-рейз те которые представляют for engine икса и алуа джастин компания соответственно нутро конга написано частично на плюсах и частично написан на лоб и расширение вот эти все модули вот это вся все плагины можно писать нала но в последнее время появились и возможность встать на джо скрипте на питоне нога то есть есть есть просвет в этом тоннеле не обязательно идти учит его но если хочется чтобы все бежала быстро вот оказывается ло тоже достаточно серьезный и язык для написания таких больших серьезных систем то есть с помощью расширения с помощью вот этих плагинов мы позволяем делать этот обвес и независимо того если вы помните star trek до вне зависимости от того в россию можно звездный путь но мы будем называть star trek на все-все значит завтрак а вне зависимости от того какие были изначальные ваши качества как человека или другой какой-то раз и если вы знаете борги и симулировали все это неважно люди вулканцы или там кто угодно могли ромуланцы ромулане наверно все-таки правильно романс а может быть даже и какие-нибудь клингоны они все когда ассимилируясь они получали вот эти функции солдат весь обвес бесплатно соответственно ваш сервис который готов идти наружу получит вот эти штучки автоматически почему это важно потому что следующий паттерн который мы будем сейчас дальше рассматривать он называется и пейзо produce да то есть когда мы уже тронули наш сервис который сервис опять же получает картинки а на выходе выдает нам кто на этой картинке нарисован это продукт это продукта чтобы протестовать соответственно когда мы предоставляем что-то нашим взором это не просто такой вот типа вот все не дернули а завтра на все переписали тебе все по-другому мы должны уже обеспечить определенный уровень поддержки да то есть например мы должны следить за развитием этой и позволять в нашим клиентам которые это 35 использует вот эти все вещи каким-то образом управлять ими выпускать разлили другие версии 5 поддерживать legacy клиентов ввести расширение нашего сервиса и смотреть как он растет изнутри там есть способы оптимизации и это не должно каким-то образом задействовать или как по русской к секс это не должно повлиять не на наших наших клиентов наши клиенты должны получать уровень комфорта и уровень получения определенный уровень в результатах то есть они даже знать за какой результат за какой срок вернется все такое соответственно это приносит нас вот к следующей диаграмме опять же и 5g твой позволяет решать очень множественной проблем давайте поедем сюда это я немножечко расширяю предыдущую диаграмму да когда у нас есть клиент который взаимодействует через и 5 с чем-то да по сути дела он может за молиться с одним сервисом а также он может взаимодействовать с другим сервисам посредством того сервиса вызову тот сервис вызывает другой сервис здесь вот стрелочка я немножко наверное погарячился потому что сервис может еще так на другой сервис пойти по звук может пойти и вот сюда например здесь может быть и кроме the bass у нас может быть и в конце концов кафка может быть то мы можем какой-то вызов который придет нам от клиента мы можем его луковку например то есть и 5 твой позволит решать сразу множество вещи которые изначально возможно наш сервис не закладывать или возможно даже и не не требуется в нашем сервисе делать непосредственно нашем коде агрегация каких-то там результатов агрегация вызова низких сервисов и делать трансформацию запросов и трансформацию ответов например как поддерживает различные версии мы например внутри себя добавили какие-нибудь поля в нашей 5 который позволяет отслеживать клайн пойди и но клайн т.д. мы не принимаем от клиента клиенту не надо прописывать нигде но клиенту например дается ключ для нашего пи и на основе ключа мы можем всегда там выдернуть ключ может быть перри выпущен и чтобы нам в дальнейшем знать что это был ключ и мид вызов пришел определенного клиента мы должны сделать определён трансформацию все и все это можно будет сделать здесь садятся и пироги это и позволяет вам делать вот эти вещи внутри системы расширяя возможности без изменения например кода непосредственно самой системы дальше мы все это дело растим и все это превращается в 1 в одну большую ну естественно мы любим все приводить до максимального выхлопа да то есть соответственно мы должны прийти какой-то платформе и во многом во многом наличие и пикет в как такового она не является конечным результатом и 5 твой является одним из инструментов так называемый систем управления жизненным циклом опять сюда может входить вот много всяких вещей и в жизни цикле 5 у нас начинается собственно процесс разработки мы начинаем зачастую если мы зарабатываем ай пи ай мы используем какие-то стандартные спецификации которые позволяют нам определить или описать контракт по которому нашей бегают работы до обычно это какой-нибудь open и 5 спецификация и должны быть тулы которые позволяют не только создавать эту спецификацию но и вот я вам дам простой пример вот мы написали спецификацию мы договорились и отдали ее нашим нашим юзерам которые будут писать например одна команда пишет мобильный frontend команда и команда пишет веб frontend так как у нас есть теперь они уже могут приблизительно понимать какой рис какие запросы они могут делать какие ответы они могут получать но хочется вот потрогать непосредственно саму систему давай хочется понять как это все будет работать и один из аспектов который в котором и 5 твой может помочь это аспект создании так называемого вот мог сервиса можно будет опять gateway скормить вот эту спецификацию программист на букинге был ленивый или там не ленивый но там дофига чего получилось и они не могут выходить реальную версию эту систему но и пегий твой может отдать наружу мог сервис смог испанцами в котором уже разработчики мобильного и перкуссии и веб фронтэнда могут уже начать писать сервис и когда и когда реальная версия система будет готова нужно будет просто переключить дернуть рубильник отключить мог сервис и выдать уже правильный результат то есть и 5 твой позволит не только решать проблемы внешней да то есть когда мы отдаем наше имя как продукт но также внутренний вы можете разрабатывать эти системы взаимодействия между командами будет происходить на уровне организации и например использование мокин плагина позволяет решать проблемы когда реальный бэкенд не готов дальше мы естественно бежим запускаем все это на по на продакшене соответственно мы запускаем наши сервисы в жизнь соответственно вот эта фаза запуска в котором и 5 и вот эта платформа управления жизненным циклом позволяет а делать вещи связанные с вот то что журналист программиста которые хотят использовать наш сервис мы можем им конечно же сказать вот пожалуйста наша open опять спецификация пожалуйста берите делать с ней что хотите и дальше они там в зависимости от уловка этого не использует там парс это ее и там делают какие то может быть stars оба и все такое а может например наша платформа им предоставить сразу портал на портале будет включена документация который автоматически будет сгенерировано на основе опыта 55 внутри вот этой документации будут также сниппеты которые позволяют запускать и вызывать и теперь и и и позволит ему же поиграться с соседями понять чем что их ждет без собственно непосредственно написание кода я когда в свое время мы ушли с flexo на более такие современные технологии тип angular а мы делали класс мы обучали технологии мангу лера когда когда разрабатываю книжку про он попросил диван и это было на самом деле очень удобно для людей которые которым не нужно знать baking частот фонтанчики они хотели изучать им им предоставляют собственно часть платформы в котором давал давала нам making сервис и позволяло нам иметь портал с документацией который позволил бы людям получится 3 часть вот этого всего цикла а заключается в том что мало того что мы должны это все деплоить а мы все должны сопровождать нам еще важно понимать как наши 5 собственно используется в в мире где принято платить за за услуги это тоже важный аспект мы должны понимать как нашей к используется кто наши пользователи как человека как сильно одни пользователи используют против других если мы например продаем это 35 например у нас есть пользователь который слишком много потребляет этого может быть ему нужно какой-то отдельный тир посвятите да ему там сделать апселл сказать вот есть еще решение которое позволит еще быстрее получать результаты или еще в этом роде с помощью платформы которая позволяет управлять этими пьяным мы можем получать в эту информацию и связь связано с мониторингом насколько у нас рейд ошибок большой насколько у нас наши пять хорошо используют часть все это входит в один большой продукт который называется менеджмент life сайкл систему вот то есть и 5 твой становится таким большим централизованным местом где происходит работа вокруг и пиво ваш компании victor можно ли тебе задать вопрос на эту тему потому что давай я послушал кажется про сам перед твоей как как продукт как как система который нам помогает им много рассказал я не до конца понял и и правильно ли я понял то что в общем то не не накладываются какие-то особенные требования на наш сервис то есть там делать можем на любом языке технологии не должны там что-то там специальное такое предусматривает чтобы он был пригоден для битвы чтобы можно было с ним использовать и даже например не нужно там на сервисе прям заботиться о том чтобы публиковать swagger ну так то что мы сейчас там частенько там встраиваемые ли какие то там я не знаю half чеки или они там нужны там в любом случае ну то есть вот вот как вообще нужно готовить сервис для работы с этой битвы да . же вопрос и это достаточно простой с одной стороны достаточно сложно все это все зависит как любой грамотный консультант тебе от ведь это все зависит и depends как мы говорим по большому счету в принципе и пеги твой позволяет все что ты отдаешь наружу обнаруженный имеется ввиду не всегда наружу как бы из вашего дата-центра потому что есть такое мнение что вот и 5 твой папа или там апраксин это поле при применимы только когда тебе нужно что-то отдать наружу да то есть уже из из твоего из твой системы хотят не совсем так он внутри тоже может использоваться например когда происходит само действие между различными департаментами в в общем случае ты прав с точки зрения и пей должен быть доступен о и пегий твой тоже кто-то должен конфигурируем поэтому не надо делать так чтобы сервис был очень тяжело там stripe мы есть определенные ну мы знаем как мы работаем в индустрии достаточно давно и мы понимаем что в любом инструменте есть определенные недостатки и какие-то недоделки и все такое под в общем случае все очень хорошо но в частном случае нужно посмотреть если ты запускаешь сервис какой-то определенный и всякие вот эти half щеки имплементации есть еще одно решение которое позволяет немножечко расслабиться при разработке даты в принципе можешь внедрить это всё свой фреймворк но не всегда это является во-первых возможным а во-вторых не всегда это является возможным сделать это в стандартной форме как нам сделать стандартной форме то есть я сейчас небольшую маленькую картинку нарисую для тебя и дальше я чуть-чуть немножко углублюсь в эту картинку вот если взять вот этот вот и 5 gateway до взять вот этот именно прокси часть сделать его очень маленькие сделать его очень им выбросить всё менеджментом вот эти все большие слова сделать его очень маленьким быстрым но тоже настраиваемость чтобы можно было добавлять различные плагины да и делаете какую-то часть функциональность этого сервиса расширяем за счет какого-то декларативной конфигурации и положить это рядом с вами будут сервисом и например научить вот этот маленький прокси как раз делайте вот этих all чеки да то есть он он например будет постоянно проверять что сервер живой и куда-то будет докладываться надо то есть мы возьмем картину с этим спросе и сделаем ее меньше и засунем ее как часть нашими красивый я кажется понял к чему ты клонишь это будет уже немножко другая история да и теперь как раз в тот момент когда люди начинают сомневаться и начинаю задать вопрос типа где связи как как нам понять это тот момент когда мы с вами теперь уже переходим в вот в условиях сервисного сервисного сито и почему это важно для нашего сервиса вот сейчас я попробую это собственно рассказать опять же используя пример из жизни пример из жизни капитана enterprise жан-люк пикард и мы продолжаем нас мы можем теперь говорить на слайде спасибо значит андрей сказал очень важную тему наш сервис зачастую не живет никогда в изоляции всегда если мы пишем какую-то маленькую на коленную project тогда он возможно и живет но зачастую каждый сервис представляет собой часть одной большой системы у нас есть какая-то часть которой работает на fontaine de часть который отвечает за например это и камер система да и она позволяет пластик ты в внутрь корзины у нас есть система которая позволяет обслуживать входящие заказы есть система которая позволяет запускать процесс отправки а иную систему которая будет непосредственно отвечать за проводки и его всякие финансовую часть что их объединяет и как раз вот объединяет все эти вещи который андрей сказал нужно ли нам написать вот эти все обвязки которые связанные с жизненным циклом вот и как с чеки всякий проверка сервисы будут реагируют на то когда другой сервис будет лежать то что то что у нас принято называть только tracker до или по-русски это называется по-русски этот предохранитель но у предохранитель не описывает собственно не полностью описывает смысл того как все таки брокера используется теперь у нас в программном обеспечении соответственно наличие вот этого плавкие предохранители я не ем ничего в голову не приходит наличие компонента который позволяет сервису оставаться живым даже при сбое частичном различных подсистем этот механизм называется механизм сроки брокеров да опять же мы джавис ты у нас уже куча все написано у нас есть his tricks у нас есть reasons for g и вот это все но что же делать тем программистом которых этого нет соответственно мы можем взять вот ту же самую концепцию когда ваш сервис ассимилирован в наш борг коллектив и ему прописываются определенные кусочки функционалисты которые получают который не были предусмотрен при разработке связан с конфетами связанные с сбором итогов связаны с централизованным сборов распыленных trace of когда мы должны проследить как происходит вызову тех или иных функций из одного места другое это приводит нас в мир вот эту сервисного сито но вот это подразумевает что что-то дырявая а термин мышь на самом деле позволяет определить что то что то связанное поэтому что вот эта вещь объяснить мне больше нравится концепция у куба боргов которые могут соединять и вот эти все все компоненте ки вот эти все боты как мы их называли в мире боргов в наши сервисы которые получили обвязку от от боргов они формулируются формируются в кубе и причем куб здесь не имеется в виду обязательно кубер нити мы об этом тоже поговорим хотя почему-то считается что сервис меж и это только для купер найти со самом деле то не так значит с точки зрения с точки зрения функционирования точки зрения функционирования сервисов они все продолжают выполнять свою задачу они например отбор гаи мне нужно получать информацию о том как дышать как ходить все такое они и должны получить эту команду которая связана с интента резиновым централь централизованным контролем или управление и должен быть присутствовать кто-то кто этот централизованный контроль обеспечит в мире боргов это была королева соответственно она делает ссылку конфигураций для нашей для для нашего места для нашего оборок его и все они начинают выполнять как это выглядит в жизни сервис маша сервис маша у нас получается похожая система у нас есть королева есть и множество различных сервисов который бежит и через это бред она опять же перейти на рабочий крестьянский это будет следующим образом есть так называемый компонент это называется control play да то есть это управляющий компонент и собственно контроль plain содержит информацию о мыши в содержит эту информацию в какой-то своей базе данных и информацию о как трафик будет идти между сервисом информации о том как сконфигурировать централизованный сбор налогов информации о том как сконфигурировать централизованной hell чеки это все будет реализовано поверх и рассылки этих информации к так называемому дайте play или собственно непосредственному вот этой маленький прокси который бежит не по средства рядом с вашим рядом с вашим сервисом и как в истории с богом если связь с control play на прорывается у нас сервисное взаимодействие не останавливаться то есть наша дельта plain продолжает бежать и продолжает обслуживать трафик за ответьте стоят конфигурацию которую они получили в последний образ достаточно достаточно неплохо хотя бы у нас получился к децентрализованная система с управлением но у нас нет никаких проблем чтобы эта система не разваливалась следующий момент который то здесь важно говорить что как и губы могут каким-то образом взаимодействуют между собой мышь вот этот вот сервисные сетка вот сетка наверное более будет правильной здесь как в моем именно ключе позволяет строить не только централизованную систему которая будет бежать в одном дата-центре но позволяет и строить и децентрализованных тему который поэтому вот когда люди говорят что вот типа гейплей это только для того чтобы вести трафик из дата центра а вот сервис меньше только чтобы ваши вот сервиса бежали в одном на центре это тоже не совсем правда например вот кума то что является since we've проектом и куда kong country будет активно вот этот сервис мер может быть запущено во первых не только в кубе не только в кубер найтись и она можно запущена это просто на веках она может быть запущена просто на на даже на железках она может быть запущена и она может образовывать malti мальте за новую нам сетку в котором управление может быть централизованной бы есть определенный механизм который позволяет иметь там вот эти контрольные точки в разных частях и рассылать эту информацию тоже централизованным централизованным образом и и обеспечивать этот переход между между системами соответственно у маши тоже должен быть свой гей твой который позволяет им выходить из одного дата-центра подключаться к другому дата-центра чтобы вот этот трафик не обрывался и чтобы ну немножечко проиллюстрировать вот эту всю систему принятия решения когда что использовать давайте посмотрим такую диаграмму это диаграмм к соответственно позволит нам определить и где что и когда использовать например если мы используем давайте пойдем по левой стороне полевые полет по лево или право по левой мы пойдем сейчас вот сюда средства если нам нужно использовать если мы делаем какой то какой то продукт мы предоставляем какой-то и pr доступ к этому продукту мы должны понимать где он используется если используется внутренней системе например кто-то пытается из системы получить соответственно мы устанавливаем gateway впереди него внутри организации нам не нужно никакой внешней доступ но доступ к ваша вашему и пою доступ к функциям вашей системы предоставляет соответственно через этот internal и 5 твой если нам нужно предоставить доступ снаружи то тогда у нас как раз происходит интеграция с внешним и 5 твоим там раньше это называлось лот bouncer да но гейб и опять твой позволяет также иметь функцию от braun сара поэтому вот это вот все дела позволит вам решить эту проблему если мы говорим о разработке опять же компонент на разработке компонентов системы мы пишем наши продукты нам нужно иметь множество микро сервисов садятся мы уже идем по правой стороне до то есть мы идем папа по по пути когда разрабатываются множество внутренних сервисов здесь такой вот этот важный аспект который я не тронул когда рассказывал но я не сказал что тот маленький прокси который сидит рядом с вашим сервисом то что мы называем дейта play зачастую она deep ловится как так называемый сайт как что-то кусай корр в мире кубер нить из это такой дополнительный контейнер который бежит внутри вашего кода который имеет доступ к той же файл системе доступ к к сетевому стеку то можешь свой основной контейнер поэтому с помощью сайт кара происходит ну стартует и нет контейнер который изменяет провела там айпи тейлз например и позволяет весь трафик который приходит в этот контейнер сначала идти на этот сайт 1 маленькую прокси и это прокси очень быстро выпускает к внутри внутри к вашему сервису и этот сервис уже тогда начинает функционировать в том ключе в котором дальше дальше уже все начинается вот этот по по определенным цепочек приходят request на ваш сервис причем роутинг к вашему сервису происходит а управляется тоже централизовано через этот control plain и мы можем например пописать определенной политики как этот сервис определенный сервис может зайти в ваш сервис или не может зайти в сервис это все мы можем настроить и так как мы эту централизованному политику будем сбрасывать сверху вниз все это дело все да и the plain и все вот эти прокси поиметь себе поэтому наличие вот это сайт carderplanet является таким необходимым и достаточным если нет возможности так его тепло и мы все равно должны запускать его это процесс руками и настраивать его руками нет возможности автоматизации то есть по сути дела это ничем не будет отличаться от наличия какого-то внутреннего гей твое мы поставим на на перед вашим сервисом также битвой ситуация начинает похоже на вот этот вот здесь вот тоже очень очень похоже дальше если есть возможность deployment а вот этих сайтов да есть автоматизация которая например как обернитесь и или например как вот вы недавно сделали написали там статью в нашем блоге про то как делать мал тимиш среди машин который оплатив купер и часть ну там направил пин shift был и среди машин которые я deep ловятся ну например накидом и тогда автоматизация и добавляете сайт каров происходит там через on seba ну а дальше мы решаем то есть на сколько у нас географически распределенная система должна быть если у нас наш сервис должен бежать в контексте какой-то большой машины да то есть он должен бежать контексте какой-то большого другого программного продукта снимешь его давно стройка добавляется в контру plain если нет у него создается свой контроль клейн лев в дальнейшем ее можно добавить внутрь этого миша как есть вот соответственно вот так у нас обстоят дела если вам нужно получить предоставлять доступ снаружи к этому сервису и обязательными мы берем опять же твой да если вам нужно предоставлять доступ к этому сервис внутри и есть определенные не once i связанный с тем как этот сервис дипломе здесь начинается как раз интересный момент ее ответвления мы можем использовать internal битвой или мы можем его сделать как часть кассиру smash виктор у меня к тебе вопрос на самом деле раньше ты ты очень подробно и прикольно все рассказал вот и многое стало понятно и аналогии клёвые мне захотелось посмотреть и пересмотреть кино ну и соответственно конечно погрузиться в тему но кажется что тут что-то ты нам лишь вот ты обещал кафку а парковку не говоришь ты нам рассказывал люди те поверили что все микро сервиса ниже через кафку должны общаться какие сервис мыши очень хороший вопрос андрей я я я ждал я ждал этого вопроса и собственно моё legacy она продолжает за мной тянутся пока поэтому я немножечко подготовился и я решил немножко пронести такой опять же те кто смотрел star trek и кто в теме принести такое вот этот любимый пан как это по-русски это прикол подкол да когда мы говорим про дейта ауэр сразу на вспоминается лейтенанта дейта который ландер немножечко попытались ассимилировать его нашу систему что насчет кафки да давайте поговорим насчет кафки что что вообще собственно происходит с кафкой зачастую многие адепты микро сервисного взаимодействия у нас говорят что системы взаимодействия систем нужно строить на основе вендре вон и на основе вот команда request кулисы гришин паттернов и вот как уйти от этого картинка взята из доклада говорят шопена кстати если вы в камере не знаете как говорят шапира стыдно как нам уйти вот от такого по сути делает вот что нам дает мяч и оно нам позволяет построить эту коммуникацию немножечко немножечко выполнен потому что можно делать централизованной политики но как нам перейти в мир логов да то что то что нам кафка давала соответственно с помощью вот этого механизма логов который описывает поведение системы и поведения компонентов по времени мы переходим в вот такому взаимодействует то есть когда у нас сервисы по получаются от весны это то что нам давало кафка и здесь важно понять что концепция сервис маша и концепция ника взаимодействия сервисов через сервис машины само действие как через через кафку она немножечко даже не ортогонально она немножечко как бы одно другого не исключает давайте как раз я сейчас чуть-чуть верну идею назад и как например тоже кафка к нам войдет взаимодействие крок как нам кафка суда может опять живой если мы говорим все на сетевом уровне то в принципе все равно каким образом у нас будет попадать трафик в нашу систему оон к нам попадает через через чего-то как только трафик нам попал в нашу систему дальше у нас начинаются все сервисы на сетевом взаимодействии друг другу ходит через мех и вот например тут бэкенд сервис до которого здесь вот нарисован давайте его покажу вот бакен сервис также может быть являться наши кафка да то есть наши сервисы могут продолжать использовать подход и вендре винный поход events торов где все события у нас хранят внутри кафки и бэкенд наш здесь какая-нибудь базу данки бежит да они все могут являться компонентами нашего маша маша обеспечивает низкоуровневые механизм как и централизованный механизм как эти системы будут взаимодействуют на сетевом уровне как они будут обозревать от слова обзор как они будут видны на одной вот этой большой диаграмме то есть сервис меж нам здесь никак не противоречит тому что наши сервисы будут взаимодействовать через кафку кафка нам дает то что то что то что я называет взаимодействие через систему которая имеет представление о наших данных кафка позволяет через венты регистрировать тотальную часть функциональность нашу систему например вещи которые связаны с ну опять же когда говорю про про pro circuit breaker и когда у нас один сервис может быть недоступен из-за того что он лежит ситуация с кафкой может это решить например информацию который нам нужно получить сервис она уже опубликовано в кафки и через кафку мы на при локальный кэш внутри нашей системы и этот конец будет использована не для того чтобы вызвать эту другую систему непосредственно а все равно как бы работать с локальными с локальными данным это немножко усложняет все но с другой точки зрения у нас есть централизованное хранение хранилище данных это такой вот сервис современный enterprise service бас версии 2021 года да то есть у нас все равно кафка находится к в центре для для того чтобы строить модель данных а по бокам у нас находится вот эти сервисы рутинных которых происходит собственно через кафку есть и другой пальцы вот этот паттерн называется у нас как он не положил на слайд этот паттерн называет собственно event коллаборация соответственно здесь нет какого-то сервиса который координирует и рассылает эти сообщения они система и макро сервисы взаимодействуют с другом на основе контекста данных то есть если мне пришло сообщение в котором я ни бельмеса не понимают я его игнорируют их для меня она не интересно то есть я не буду слушать а здесь это требует небольших усилий с точки зрения разработки этой системы и и договоренности насчет типа схемы данных и все такое а и насчет того чтобы система научились понимать это совершенно тема совершенно другой дискуссии но этот паттерн имеет место быть и в мире в котором есть сервис меж и венге то вы немножечко ближе к дому немножко ближе к теме которые мы сегодня вот обсуждали есть такой паттерн который называется вен gateway и он позволяет например интегрировать вот и 5 деталей с винта пример принципу нем заключается следующем у вас есть какое-то приложение которое бой и пиарю уходит куда-то да и она думает что она ходит в какой-то опять на самом деле она приходит внутри 5 твои а уже 52 разруливает это не ни в какой то это я просто публикует в этот вагон слов наш в нашу кафку также и дальше начинается там уже история которая предоставлена на предыдущем слайде например тоже такой паттерн возможен и это даже час частый случай здесь здесь стоит сказать например о каких-то там имплементация альтернативных да то есть на про kong умеет писать там в кафку из коробки то есть ни чего не нужно но есть например эмблеме тации к этому со своей confluence раз прокси до которая позволяет публиковать через проставку есть имплементации например pixel и pixel позволяет делать честь герпесе есть ли клаус который тоже позволяет делать не только в кафку то есть это паттерн достаточно известный поттер достаточно широко используемый и здесь как раз вот эта гейплей в определенной в определенной имплементации не обязательно там kong nikon присутствует как часть чтобы запустить этот ивент систем то есть не знаю насколько это покажется понятны многим но кавказский протокол он находится выше уровни стива потому что он сервис меж может работать до уровня l4 да то есть на уровне типе а кафка портак убежит на уровне тоже l4 соответствие кафка тоже может быть бежать внутрь сервис смешан но концепция ивентов выносит взаимодействовать марка сервисов до выше даже уровне протокола аппликационную потому что через ивенты вы создаете свой формат зама действие этих сервисов тоже имеет место быть и чтобы подытожить вот мне кто-то сказал что любой мы знаем эту историю там когда и 1 sim grey выиграл соревнование когда нужно было написать самый короткий рассказ и вот люди говорят что нужно написать похожую как можете объяснить свой доклад в с помощью двух слов 0 там 6 слов по-русски собственно gateway пропускает или встречает собственно gateway он и вот-вот тяжело такие вещи переводить как бы он вас встречает этот ваш вот вы приходите на тусовку вас встречает гость хост и он вас как бы впускает или там и даже не не не has the balance of data есть этот фейс-контроль соответственно он вас встречает а собственно внутри миша у вас уже происходит роутинг там вас вы можете прийти потусоваться как мы сейчас например пришли на конференцию до вас вы залогинились это вот вас вас битве а теперь дальше вы по интересам расходитесь и мы сейчас туда пойдем в в в экспертную зоны будем говорить про эти штуки и тут как раз начинается вот эту мишна меж и можно определить определенную политика трафика в когда-то будет перемещаться но здесь еще бы слайд отсутствует что кафка естественно стримит да ну кавказ 3 мс ну такая игра слов с английским чтобы вы понимали то есть опять же gateway admits меж connect and кавказ прям собственно вот собственно все что я хотел сегодня вам рассказать я старался максимально сделать этот доклад популярным с точки зрения поднесения каких-то метафор спасибо огромное леониду угольнику за то что закинул мне сама и интересных вот этих метафор мы с ним как-то брейнстормили сидели и в итоге у нас родилось вот этой день сборками если мы заинтересовали андрей может быть кого то это тоже заинтересует немножко взглянуть в мир стар трека если вам интересно то что я тебя продолжаю делать я сейчас стараюсь возводить стрим который называется kong builders где но хотя бы раз две недели нужно выходить и рассказывали про физические такие интересные около около кангов ские штуки я вот сделал недавно стрим который был про как там это все дело будет бежать внутри кубер не tissot все это находится на канале конга подписывайтесь туда подписывайтесь на мой канал youtube и приходите к нам в телеграм-канал у нас есть канал про kong тоже канал про кафку все еще существует приходите туда и это все что я знаю клетках и как я люблю заканчивать свою презентацию разве кругом of enzymes я не знаю я собственно не заканчиваю потому что мы сейчас провалимся с вами в в экспертную зону и собственно поговорим о вопросик ах да да да ну вот в этой твоей терминологии ты получается тот самый сервис который нам проводил много много интересного контента классных данных я андрей кабанья сайт корр я здесь соответственно отвлекал виктора и поэтому у нас не осталось к сожалению времени для того чтобы задать вопрос из чата но я всех приглашаю дискуссионную зону там мы все обсудим и вас соответственно приглашаю мы тоже идём спасибо большой литр да спасибо андрей и все идем быть первую зону всем пока"
}