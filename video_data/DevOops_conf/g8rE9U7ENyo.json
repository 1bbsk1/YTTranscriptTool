{
  "video_id": "g8rE9U7ENyo",
  "channel": "DevOops_conf",
  "title": "Кирилл Борисов — Антипаттерны Observability",
  "views": 472,
  "duration": 2834,
  "published": "2024-10-25T02:38:05-07:00",
  "text": "Всем привет третий зал еще один доклад я приветствую на этой сцене Кирилла Борисова Он работает в ВК Чем он занимается и чем знаменит он расскажет сам я расскажу о качестве Кирилла которых я знаю да Меня зовут Виктор Попов Я работаю в компании самокат течь вот чем-то занимаешься и сиди двигаю но вы не меня пришли слушать Кирилл я знаю довольно давно мы где-то в каком-то чатике встретились языками зацепились и вот мы тут на самом деле и Кирилл позвал меня побыть экспертом на его докладе Я согласился огромная честь Спасибо большое вот смотрите у меня есть некоторые спойлеры к докладу Кирилла я знаю что он поговорит про антипатерного билете их будет 9 штук Вот и собственно Кирилл от твои любимые Какие давай номерами чтобы я на самом деле наверное назову один это номер шесть Мы о нем чуть-чуть дальше поговорим Вы знаете что это паттерны почему меня так откликается неплохо запомните Да что номер шесть любимый антипатан Кирилла мой любимый 7 Вы наверное поймете почему Скажи пожалуйста а вот из 9 которые будут и вот все грабли собрал сам Да ну то есть максимально Просто вот проехался по ним разными частями тела но просто гример закрасила тебя и поэтому не видно на лице следов потрясающая вот я на самом деле время больше не буду тратить тут не ради этого собрались передаю тебе слово Давай расскажи про все девять А вы выберете Какой ваш любимый Итак всем привет Меня зовут Борисов Кирилл Виктор Большое спасибо за представление рад что ты присоединился к нам немножко расскажу про себя я войти более 12 лет строил devops процесс инфраструктуру в больших проектах работал льдом группы сопровождение и сейчас работаю в компании VK работаю с релье в департаменте рекламных технологий свободное работы время и немножко занимаюсь образовательным контентом являюсь спикером целом люблю такую Движуху полезно для структурирования своих знаний но не будем терять времени Давайте придем до кладу и сегодня мы с вами поговорим про антипатернабилити Но перед тем как вообще говорить про антипатерна нужно понять что такое вздермобилити это некая концепция которая позволяет разработчикам команде эксплуатации системы получать полное представление о том что происходит внутри системы в реальном времени собственно цель это обеспечить полное представление о том как работает система внутри чтобы команда эксплуатации опять же команда разработки могли быстро обнаруживать и анализировать какие-то проблемы в производительности приложения оптимизировать эту производительность Ну и повышать надежность системы отзермобилити держатся на трех таких огромных музрозных столпах это метрики логики и трейсы это вот то на Чем в целом как бы вся обзоровабилити строится но подойдем к антипатарным на самом деле Да у нас чаще всего с вами есть огромное количество инструкций о том как делать правильно какие-то без практики сюда и люди рассказывают обычно делятся историями успеха но мы все с вами люди Мы хорошо Очень учимся на каких-то ошибках хорошо когда плохо когда это ошибки свои Наверное если есть поучиться на чистых чужих ошибках то это всегда большой плюс И вот Сегодня я расскажу вам про 9 паттернов Как не делать обермобилити в докладе мой опыт и здесь не только технические моменты но большей степени какие-то процессные проблемы при построении обзвабилити и эти как мне кажется такие проблемы они достаточно тяжело решаются и достаточно сложно решаются как я уже говорил меня будет всего 9 антипатаров я попрошу вас загибать пальцы записывать в блокнотики какие антипатаны так или иначе вас откликаются и в конце доклада просто проведем маленький опрос посмотрим где мы с вами смачились А где нет На самом деле перед тем как начать дисклеймер все персонажи описываемые события являются вымышленными и любое совпадение с реальными людьми Это чистое Случайность история номер один собственно Пятница вечер пока не вчитываетесь письмо Просто послушайте историю пятницы вечер вы сидите готово закрыть ноутбук никаких пятничных релизов все отлично и тут вам прилетает письмо от вашего либо вашего непосредственно руководителя либо от менеджера который стоит над вами в моем случае это был мой руководитель о том что руководство решило что нужно начать внедрение новая система если Пускай это будет x y z Мне важно какой у него название и вот Со следующего понедельника Вы должны эту систему начать внедрять вот есть какая-то документация по ней пожалуйста Возьмите в работу и мы переходим к первому антипатам это навязанный инструмент собственно это инструмент который Вам навязали сверху фактически навязали сверху и вы изначально как бы не были готовы к его внедрению и скорее всего вас просто нет опыта в эксплуатации этого инструмента какие последствия у этого антипатана да это ситуация когда вот вам принесли что-то и вам нужно что-то вам нужно как-то инструмент внедрять Какие последствия этого инструмента Понятное дело что это недостаток гибкости и расширяемости собственно единый инструмент он чаще всего ограничен и не способен эффективно решать все те задачи которые перед вами стоят и это может привести каким-то компромиссом или неполноценности решения и это решение не будет удовлетворять вас как заказчика и ваш проект и вашу организацию в том числе Ну и второй наверное крупный и такой Достаточно серьезный аргумент точнее последствия это зависимость от поставщика скорее всего это решение какое-то платное которое ваша компания купила и хочет внедрять и вы постепенно Садитесь практически вот на такую иглу этого поставщика и дальше уже тяжело куда-то с этого с этой иглы фактически слезть Да и любая доработка которая вам нужна будет тот функционал который Эта система не поддерживает она будет стоить там какую-то копеечку сто процентов вам как мы эту проблему решаем А ну понятно дело отсутствие автономности у команд потому что этот инструмент он будет достаточно тяжелым опять же в моем кейсе Это был тяжелый инструмент в котором чтоб разобраться нужно было производить большое количество усилий и это дело только команда эксплуатации потому что команда разработчиков не было попасть и команды эксплуатации не могли вносить какую-то какой-то велью в сам процесс как решаем на самом деле здесь буду капитаном наверное да как в большинстве нужно быть проактивным и это это замечание относится к ситуации когда еще решение не было принято но вы где-то краем уха о нём услышали возможно где-то в кулуарах возможно где-то в курилке Вы слышали о том что такое иначе такое решение будет применяться здесь нужно со своей стороны если вы как руководитель или вы как инженер Вы можете к своему руководителю либо к руководителю своего руководителя и попробовать как-то влезть в этот строится в этот процесс обоснование и выбор инструмента для мобилити анализируйте требования Ну опять же да Перед тем как что-то внедрять мы должны тщательно проанализировать И вообще понять Какие проблемы мы хотим решать Да какие инструменты существуют на рынке то есть привести такой более тщательно детальный анализ К сожалению опять же на моей практике вот такие навязанные инструменты они чаще всего приходят свыше и большую часть требований не покрывают потому что кому как не разработчикам эксплуатации знать о тех проблемах да о тех слепых зонах вот в самой системе какой-то вашей текущий обзор мобилити который нужно закрыть принимаете решение совместно Ну опять же если опять Капитан решение о внедрении того или иного продукта должен должно должно применяться не только каким-то менеджментом и кавац как команда эксплуатации в том числе совместно с разработчиками потому что наблюдаемость она в целом не просто какой-то инструмент это целый продукт это внутренний продукт который так или иначе помогает вам видеть вашу систему полностью стремились к разнообразию и гибкости Я думаю вы все знаете что на рынке Нет сейчас какой-то Серебряной пули которая так или иначе там одной установкой закроют все ваши проблемы с метриками логами и там с рейсами обычно это какой-то комплекс разных решений которые поможет вам закрыть ту или иную проблему и обучайте и поддерживаете опять же наблюдаемость это культуры Я сегодня много буду раз об этом повторять пока вы что-то делаете внутри своей компании внутри своей команды команда эксплуатации команды Сергей Неважно как вы назовете и пока вы об этом не говорите команды будут выдумывать что-то свое либо вообще не будут этим заниматься Ну то есть они будут делать Просто продукт А что там дальше как он в проде живёт именно это будет не интересно какие вопросы тебе можно задать чтобы помочь проанализировать требования к инструменту вообще какие проблемы предполагается решить этим инструментом Какие возможности этот инструмент дает это тоже важно понимать потому что обычно агрессивная реклама какого-то вендора говорит вам о том что вы закроете все ваши проблемы но скорее всего это не так на нашем опыте мы внедряли опять же Это мой опыт внедрения такого продукта этот продукт не закрывал нам даже 60 процентов наших потребностей то есть всё остальное уходило в доработку и чаще даже доработка нам не помогала то есть вокруг вот такого навязанного инструмента у нас вырос рядом зоопарк огромный небольшой зоопарк в описанных тузов которые так или иначе нам помогали достраивать этот процесс и собственно нужно понимать что инструмент Это не все и мы должны скорректировать наши методы работы чтобы получить максимальную выгоду просто от использования этого инструмента история номер два если ваш трек мониторинга обзорубилити выглядит примерно как на этом слайде то Поздравляю вас выводите паттерне номер два и отстаньте паттер называется закидывание инструментами когда на любую проблему вы начинаете выдумывать применять какие-то другие новые инструменты внедрять что-то и так далее как он почему он появляется Ну вообще да Первое это опять же анализ требований мы изначально не проанализировали требования к нашему инструменту который вначале внедрили и потом начинаем уже придумывать Какие как же закрывать те или иные проблемы с помощью других инструментов следующий На самом деле мой любимый моя любимая причина это подражание моделей трендом Я думаю мы все Ходим на конференции вы сейчас на конференции Вот вы послушали инструмент вы пришли домой у вас не знаю там патч-кордики в животе летают ты готовы что-то сделать вы пришли домой на коленке слепили какой-нибудь не знаю ластик чпм вроде бы натянули вроде бы работает поработали два месяца поняли что в целом вам нужен но инструмент остается какие-то команды им пользуются и вот этот долг Он накапливается накапливается и этих инструментов становится очень-очень много Ну и третий третья причина это недостаток коммуникации и координации все от того что Откуда вообще появляется огромное количество инструментов появляется вам того что команда эксплуатации что-то сделал внутри себя она этим пользуется но никому не говорит А когда команде разработки нужно закрыть какую-то брешь бурелогов сборе метрик какой-то трассировки они начинают придумывать что-то свое они начинают придумать что свое они его доделывают как-то это выкатывают в дф потом приходят к вам выкатываете наоборот и вот как Снежный ком это накапливается и вы получаете просто огромный Ворох вот как на том слайде было огромный Воров этих решений которые так или иначе у вас есть вроде Какие вопросы можете себе задать Ну опять же не буду здесь долго рассказывать Мы должны всегда понимать Зачем И что внедряем И какие проблемы мы хотим закрыть и всегда важно помнить что проблемы решают не инструменты а люди дальше это оценивайте преимущества недостатки каждого инструмента возможно внедрение нового инструмента не решит проблему все не так возможно существующие инструменты могут решить проблему которую вы пытаетесь сейчас решить но с какими-то минимальными доработками но при этом Вы не докинете вот ваш снежный ком инструментов дополнительный какой-то дополнительный дополнительный система мониторинга систему сбора метрик или еще что-то вот и старайтесь стандартизировать упрощать но не скатывайтесь в первый антипатам про навязанный мониторинг когда это огромная одна система здесь важно найти баланс между системами которыми вы используете чтобы не свалиться не быть ни в одном ни в другом антипатарне и обучайте все то же самое что в первом пункте все происходит от каких-то недоговорок недопониманий или еще чего-то когда команды не понимают что вы делаете то есть у вас может быть отличная система сбора метрик сбора логов вы ее вылизали она у вас хорошо работает но как бы это не добавляет ценности разработки потому что она просто о ней не знает таких ситуаций на самом деле очень много собственно Какие вопросы Вы можете здесь себя попробовать задать кто будет вникать в этот инструмент внедрить инструмент мало важно его дальше Еще поддерживать и развивать То есть если мы можем там не знаю поставить какой-то сборщик логов Там просто команды там за хэлмен стал закатить то дальше её нужно будет явно как-то апгрейдить за ней следить и так далее да изучайте её кто-то её должен настраивать и так далее То есть это всё тоже какие-то ресурсы в том числе как бы людские собственно их результатов вы хотите добиться с помощью этого инструмента тоже важно понимать потому что ну если Просто сесть подумать то возможно это проблема уже решена в том инструменте который вы используете сейчас история номер три дивопс номер 9000 на самом деле тоже мой любимый антипатор но когда я говорил что мой любимый антибадр номер шесть это тоже мой любимый и вообще они все мои любимые идея в том что есть какая-то команда чаще всего эта команда эксплуатации которая владеет инструментом обермобилити она его делает она в неё кормит она приносит в неё ценность и здесь вот как раз появляется некий такой девопс который супер скиллованный который всё знает все может но никто больше про эту систему не знает и доставить мне ценность тоже не может и это антипатам избранный собственно когда Избранная группа людей имеет доступ платформе такой наблюдаемости вносит в нее вклад Да и важно понимать что наблюдаемость она цена только тогда когда ей все пользуются и все получают пользу на самом деле вот команда эксплуатации это Примерно вот моя команда была Мы также владеле инструментом никому не рассказывали поэтому смотря на это ретроспективно понимаешь Какие последствия могут у этого быть во-первых последствия этот доступ к настройке такой системы есть только определенного круга лиц это личный инструмент чей-то и нет заинтересованности у других команд вкладывать в этот инструмент силы и в конечном счете мы получаем просто огромное количество непонятных даже бордов Альтов и в целом команда не понимает вообще зачем они нужны то есть мы же понимаем что это система должна нести ценность не только для вас как команда эксплуатации но и для команд разработки бизнеса и так далее какое решение здесь решение достаточно простое но но сложное необходимо наблюдаемость превратить в культуру да рассказывать о ней зачем как она помогает сделать так чтобы каждый мог вносить вклад в эту систему не только та команда которая ей владеет и старайтесь устраивать дома сессии по тем продуктам которые вы внедряете здесь на самом деле не только вопрос про системы вообще в целом в принципе про нашу с вами работу чаще всего Люди просто не до конца понимают и видят что мы с вами делаем мы сделаем внутри все себя красиво будь то там система мониторинга либо себя сликая система она работает только потому что мы её поддерживаем мы не понимаем а люди могут они просто не знать команда разработки Могут просто не понимать что мы такое делаем с вами история номер четыре и в этом в этом меме как в этом мире доктор кажется меня все игнорируют следующий Эта история о том как мы умеем игнорировать пользователей которые пользуются нашей системой собственно на самом деле надо попробовать просто тебе ответить на вопрос А может ли пользователь воспользоваться вашим сервисом после релиза Попробуйте ответить на вопрос а стало ли У пользователя лучше стал его пользователя хуже вообще что с производительностью вашей системы Это антипата называется Кто такие пользователи Часто мы к сожалению забываем Попробуйте ответить на вопрос может ли пользователи пользоваться вашей услугой которую вы предоставляете собственно проблема много метрик технических А сервисах и системах мы собираем все что угодно CPU память диски какие-то летинси пауэрлам коды ответы еще что-нибудь но эти метрики нам не дают понимание о том как чувствовать себя конечный пользователи которые пользуются нашей системой в конечном счете нет информации о том как пользоваться чувствуется как конечный пользователь себя чувствует здесь у меня есть один классный пример Это пример входа в личный кабинет у нас была настроена настроен мониторинг настроена Метрика Мы проверяли URL callback который нам в случае возврата двухсотки Мы считали что система работает и доступно но случилось ситуация когда нам ответ колбеков возвращал 200 его редирект тело обратно Он снова возвращал 200 его директора обратно и вроде бы на метриках все зеленое вроде бы все работает но пользователь фактически не может воспользоваться нашим сервисом он не может зайти в личный кабинет и как-то взаимодействовать с нашим продуктом как мы решаем решение на самом деле опять же простое но сложное бесплатно за деньги выделение критического пользовательского пути что это такое Это такой поток или частичный поток через который Клиент будет проходить через который клиент проходит в нашем продукте собственно этот поток который дает наибольшую ценность для бизнеса Давайте попробую привести пример такого критика лузержоне например на примере какого-нибудь просто интернет-магазина выделим три критичных пути первый это возможность оформить заказ в магазине второй это возможность добавлять товаров в корзину и третий это возможность просматривать продукты в корзине возможность просматривать просто продукты на ну где-то на лендинге на вашем и здесь важно понимать что все три они важные но они также у них также есть последовательность того какой наиболее критичный вот Представьте что если клиент зашел на ваш сайт не может просматривать каталог Скорее всего он не доволен Ну больше доля вероятности он придет на следующий день или через час попробует еще раз посмотреть те товары которые вы предполагаете люди с товарами В корзине в случае отказа каталога они смогут товар заказать и дискомфорт в целом как бы у них не будет потому что все что они хотят они сделают но вот если люди пришли и попробовали заказать товар оформление товара недоступно вот тогда у них уже будет явная претензия к вашему магазину и Возможно они уже не будут пользоваться вашим сервисом ваш бизнес заработает деньги и вот такие вот такие пользовательские примеры такие пользовательские пути как раз стоит мониторить делается это достаточно просто выделить критический путь достаточно сложно здесь нужно уметь опять же коммуницировать с бизнесом С командами разработки продукт менеджерами и после того как Вы уже поняли Какой конкретно путь подходит вам вы накладывать это все на технические метрики и дальше уже от этого строить систему мониторинга следующий антипатрум история номер пять пустой слайд на самом деле он реально пустой здесь нет никакой картинки никакой анимации и идея его в том что вот примерно то же самое у меня было в голове пустота о том как вообще система работает у меня были плоды в кубе у меня были куча разных сервисов они все как-то работали мы их диплоили но что конкретно делает система мы не знали и это как раз эти паттер непонимание вообще в целом как работает система и проблема в непогруженность такой широкий контекст того что делает внутри системы проблема на самом деле не только в нежелании команды эксплуатации Да иногда разбираться что там происходит внутри ну и нежелание команды разработки передавать эти знания дальше все это вот как в классическом Неде в опсе когда есть овцы есть да и туда вот так все это мигрируют друг другу релизы перекидываются как ты это работает собственно какая проблема нет понимания как работают нижестоящие сервисы нет компания вообще кто потребитель услуг ваших сервисов То есть вы просто крутите плодики просто за ними следите Но кто к ним обращается и кто что с ними делает у вас этого понимания нет Какая часть системы наиболее критичная есть разные там части вашей системы одна из них может быть очень критичной если она там не будет работать вы потеряете там энное количество миллионов денег а другая часть системы если отвалится Ну дай Бог заметят как бы это тоже важно понимать и разделять и чаще всего мы отслеживаемся метрики только на стороне сервера но при этом забываем что нашим бэк-эндом например пользуются мобильные устройства какие-то браузеры еще что-нибудь эти метрики мы не снимаем как решаем собственно изучаем систему стараемся понять как она работает пытаемся понять не только техническую часть работы нашей системы но и бизнесовую это очень важно для понимания того как выстраивает Ту же самую систему мониторинга на самом деле вы не выставить красиво без понимания того как работает ваш бизнес вообще как он как он зарабатывает деньги на чем Он зарабатывает деньги кто потребитель и что ему важно и обязательно говорим конечно с бизнесом пытаемся выяснить вот критичный сценарии разобраться как это все работает и не пытаемся просто диплоить просто следить за памятью диском и так далее развиваем свой Кругозор и пытаемся разобраться в системе в целом история номер шесть если ваша даже борды мониторинга выглядят Примерно вот так же то вы вместе со мной в одной лодке ничего не понятно много красивых тумблеров таймеров и вообще полетим или нет Я не знаю если честно это антипатр непонятный даже борды вот кстати номер шесть он мой любимый потому что плюс-минус я сейчас занимаюсь больше степени тем что выравниваю всю эту историю даже бордами и он относится к ситуации когда у нас есть огромное количество сложных перегруженных даже бордов там которые затрудняют вообще в целом понимание того что происходит в системе вместо того что предоставить какую-то краткую информацию о том как ведет себя систему мы делаем миллион графиков Они вроде бы что-то показывают красивенькие все Ну смотря на них Мы даже не понимаем А вообще мы работаем или может быть уже и нет собственно проблема да Опять же все это идет от того что мы недостаточно понимаем потребность конечных пользователей мы стараемся мониторить мы думаем только каких-то технических метриках сервера и так далее ну не думаем о на ших пользователях мы достаточно фокусируемся на этих ключевых метриках и фокусируемся опять что-то напу памяти и всё в этом духе иногда мы еще неправильно Неправильно делаем представление данных Да они могут быть как-то отображены даже бороде Так что вроде бы Метрика правильная а не видно из неё действительно хорошо это или плохо как решаем опять же выделяем наш customer Critical User journey ищем те точки в которых наш продукт действительно важен и пути в нашем бизнес-продукте который действительно Важны и их покрываем в первую очередь мониторингом и от этого будет строиться вашего мониторинга фокусируемся на ключевых метриках то что вы выделили в первом пункте дальше Вы на них делаете фокус и мониторите как раз только их но при этом конечно же не забываем мониторить технические метрики потому что без них тоже как бы не всегда мы можем видеть полную картину и Используйте паттер синглпейнов в глаз в общем идея в том что вы делаете один мульти дашборд на котором есть просто иконочки с каких-то ваших основных пользовательских путей А дальше Вы уже можете если вам необходимо как дополнительная информация вы уже Можете просто провалиться внутрь какого-то следующего джишборда как сон внутри сна вы проваливайтесь дальше получаете более подробную информацию о сервисе Вы можете провалиться еще дальше на уровень инфраструктуры и посмотреть инфраструктурные какие-то метрики но всегда начинаете исследование с пользовательского пути ты начинаешь антипатам реальная история которая вымышленная количество алертов в папочке Def prod и там еще есть разные папочки и так далее это антипатр на Лер фатик это то о чем упоминал Виктор Это его любимая тема он на ней Он с ней выступал о ней рассказывал проблема перегруженности олертов Она всегда у нас ну она у всех практически присутствует пока я еще не видел компании в которых это про этой проблемы нет так или иначе у всех есть огромное количество жертв которое будет по ночам приходят каждый день и так далее какая проблема здесь Ну понятно дело усталость инженеров и тысяча оливтов в день которые никто никогда не разгребает чатики добавлены в мьют моих мьютим как бы ну ладно ничего не сломалось бизнес не пришел значит наверное не критично и пропуск реальных проблем вот где-то там среди этих тысячи альертов есть один или два Альберта который действительно критичные вот бизнес начинает терять денежки уже начинает нервничать как решаем на самом деле Конечно я вам рекомендую посмотреть доклад Виктора про это про эту историю он там об этом все очень хорошо и много рассказывает Я попробую выделить парочку основных таких сценариев которые нужно делать Первое это разделение каналов разделение каналов модификации есть каналы которые нарушают ваш Work Live Balance А есть каналы которые Не нарушают вашего баланс одним из примеров канала который нарушает Work Live Balance это Например телефон звонок на телефон сто процентов вас как-то включит в работу вы его увидите попытаетесь на него ответить и так далее но например не нарушающие каналы Work Live Balance Это какой-то рабочий чатик например скорее всего мы не смотрим на него в выходные Итак сойдет Потом посмотрим плюс мы уже начали плюс-минус привыкать к телеграмму что он такой не нарушающий канал Work Live Balance потому что мы используем И на работе и в каких-то личных коммуникациях собственно вы их разделяете берете каналы назойливые и не назойливые и в зависимости от уровня все верите начинаете делать альты Например если у вас какой-то критикл инцидент то только звоним на телефон То есть первый уровень эскалации это звонок на телефон и тогда ни в каком другом случае другого какого-то сверить И вы не звоните на телефон только в этом случае Тогда инженер будет знать что если у него поступил звонок в какой-то момент от вашего какого-то определенного номера то значит он должен это отреагировать это инцидент который стоит посмотреть прямо сейчас например уровень Хай Вы можете отправлять на какие-то рабочие чатики в рабочую почту Это те каналы которые это телерты которые прямо сейчас не горят но посмотреть на следующий рабочий день их точно стоит это как раз Рабочая почта рабочий чат Возможно это Telegram если он плюс-минус вы его использует Как рабочий чат Ну а вот все что касается там каких-то медиумов возможно их вообще не нужно а них нужно говорить их нужно на них нужно смотреть но в режиме такого отчета за неделю Какие медиумы произошли на них забивать точно не стоит потому что какой-то медиум Завтра он придет в Хай и послезавтра он придёт в Critical их нужно осматривать но в каком-то онлайн таком режиме в качестве алерты конечно их отправлять не стоит история номер восемь это Вот пример моего реального даже Барда это кусочек даже Барда скажем тогда хорошо но красиво вроде бы все красиво укладываемся 99,9 показываем бизнесу он доволен мы соблюдаем все наши контракты но по факту это классическая классический пример неправильной метрики здесь по всем нашим суммарно по всем нашим поинтам по факту мы здесь немножко лайфхачем и говорим о том что наше приложение доступно но при этом какие то не могут отвечать да соответственно Мы как-то сгруппировали подумали и решили что вот такая цифра будет красивая и это антипата большая и тупая Метрика Она реально большая и она ни на какой вопрос не отвечает собственно Мы в системе собираем огромное количество метрик ты группируем эти системы эти метрики не представляют нам вообще никакую полезную информацию не соответствует реальным нашим потребностям вместо того чтобы помочь Да и помочь в анализе и баги какой-то той или иной ситуации какая проблема во-первых сбор метрик без четких целей мы собираем просто всё что у нас есть перегружаем наши системы хранения метрик пытаемся это как-то еще самое худшее что мы пытаемся как-то еще это навернуть даже борды получаем кучу непонятных даже бордов сверху строим алефтинг получаем и вот вообще тут ломаемся полностью недостаточное понимание потребностей опять же вследствие того что мы собираем все что есть это недостаток того что мы не знаем что мы действительно должны мониторить На какие метрики мы действительно должны обращать внимание и недостаточной фильтрации агрегации вот в моем примере я слишком достаточно все агрегировал и получил красивую циферку могу показать ее только менеджером бизнесу как у нас все прекрасно под капотом там действительности не будет так все хорошо и прекрасно как решаем определяем цели мониторинга думаем над тем что мы должны мониторить Какие критичные пользовательские пути мы мониторим Какие метрики собираем с точки зрения инфраструктуры и так далее стараемся фильтровать агрегировать метрики но не так как я все сразу Подходим к этому процессу более Умно строим разрез пент пойнтов строим разрез по каким-то годам ответа определенного сервиса и так далее не забываем что мониторинг он как большая часть всего что мы делаем Это Континент процесс нельзя сказать что мы собрали метрики за мониторили сервисы это вот все как бы сервисы развиваются мониторинг должен тоже за ними развиваться мы должны постоянно оценивать обновлять метрики потому что возможно метрики устарели возможно добавились новые или еще что-то в этом духе история номер девять прекрасный чувак который пытается найти бумажку но ничего не видит собственно идея в том что у нас есть Метрика на нее смотрим мы смотрим на график у нас все хорошо но проблема Мы не видим не видим Мы ее Почему Потому что у нас плохие интервалы выборок собственно он относится такой антипатам который относится к ситуации когда интервалы выборки для сбора метрик либо не оптимальные выбранные либо совсем не выбраны и при этом приводит к ситуации когда у нас есть некое искажение информации о системе Да собственно неправильные такие выбранные интервалы метрик могут замедлять систему ваш замедлять мониторинг замедлять реакцию на системой более того мы можем какие-то проблемы пропускать потому что мы неправильно определили интервал сбора нашей не знаю промежутке в 5 минут у вас все хорошо но есть интервалы где-то раз в минуту где сервис ваш там 500 очень сильно И вот эту ситуацию Вы скорее всего пропустите на пятиминутном интервале у вас будет все хорошо Какие проблемы от этого во-первых это слишком длинные интервалы тут Прям вообще все очень просто да интервалы слишком длинные метрики данные могут быть сильно усреднены и мы можем не видеть какие-то краткосрочные проблемы в самой системе мы можем просто Попозже обнаружить какую-то проблему которая сильно деградирует нашу систему слишком короткие интервалы выборки приходят к тому что ваша система сбора метрик так или иначе начинает просто подтупливать только количество информации которое вы пишете и вы увеличиваете количество ресурсов в конечном счете ваша система замедляется медленно дает вам метрики которые вам полезны и вы от этого тоже никакого нет ну и неправильное соотношение интервалов выборки В некоторых случаях разные метрики данные могут требовать разных интервалов выборки здесь нужно как бы подходить Так это с легким перед тем как выбрать конкретный интервал для метрики Нужно обязательно подумать посмотреть на эту метрику в динамике попробовать поставить длинный интервал потом короткий посмотреть где примерно как примерно мы можем оптимально собрать эту штуку как мы это решаем опять же Капитан сегодня с нами анализируем требования смотрим на каждую метрику проверяем Какие интервалы для той или иной метрики можно выбрать Это сложный процесс это долгий процесс но в конечном счете он приводит к тому что ваша система Становится лучше с каждым разом стараемся учитывать характеристики данных такие как скорость изменения детализации при выборе Вот таких интервалов метрик например для быстро изменяющих симметрик потребуется там более короткие интервалы Как наоборот для для метрик который не быстро изменяются тестируемые оптимизируем Это вопрос к тому что мы пробуем расставить разные интервалы смотреть как ведет себя Метрика пытаемся понять где мы можем потерять проблему Где мы можем как бы ну поменьше побольше интервал поставить чтобы не перегружать нашу систему мониторинга и используем адаптивные интервалы метрик здесь история наверное больше про какое-то эмэль про обучение совет хороший но сами мы так пока еще конечно не делаем но идти в эту сторону точно стоит мы об этом думаем Но пока конкретного решения нет чтобы за нас искусственный интеллект рассчитывал для них все что мы делаем все наши все наше количество метрик это вот это вот данные Да они могут с ними сделать бумаги которые хотят попробовать пообщаться с ними на самом деле у меня почти все заключение немножко хотел суммировать это все собственно первое что ну то есть чтобы не попасться на какие-то из этих граблей нужно соблюдать на самом деле всего фактически четыре основных правила это анализировать требования к вашей системе наблюдаемости стараться быть проактивным и работать стараться понимать Те проблемы которые у вас есть и как вы их можете решать обязательно сосредоточиться на пользователе это то на чем важно держать фокус потому что все что мы собираем с точки зрения техники опять же возвращаясь там технически там память и так далее Это в 90 процентах случаев не отражает пользовательский опыт нашего продукта Превратите наблюдаемость в продукт Откройте эту платформу для других чтобы они могли использовать и Убедитесь что она хорошо работает таком широком контексте организации представители результаты вы хотите достичь с помощью этого продукта и надо осознавать что вот билити это такой внутренний инструмент который так или иначе помогает вам двигаться в сторону улучшения пользовательского опыта вашего приложения вашего приложения вашего бизнеса и так далее и коммуницируйте важный навык который мы все пытаемся развивать Но иногда это плохо получается общение С командами С командами разработки это то вообще про что devops и в целом как бы сре это про коммуникацию это про культуру не пытайтесь делать что-то одни Один в поле не воин по моему тоже стата Виктора Если не ошибаюсь один и мониторинг один не сделаете Как бы вы не хотели поэтому важно в наблюдаемость вносить опыт других команд команд разработки команд менеджмента маркетологов любых безопасников любых любых команд которые есть в вашей компании это у меня все спасибо за внимание надеюсь вам было полезно мне такую рекламу делали вообще кошмар Мне кажется раньше меня придумал вряд ли это я догадался Я хочу сказать как то нас просто в перчатку собираешь антипатерный такой я буду править я приду сделаю вам плохо Кто ищет сотрудников Обратите внимание у нас есть вопрос скажи что-нибудь а Благодарю за доклад Александр Крылов и Мистер вопросик у меня такой А когда вы планируете послойную строить мониторинг по концепту условного боксу чаще всего вы идете исходя от бизнеса или исходя из перформанса И сверху идет потому что несколько изречений были противоречивы друг другу Поэтому собственно возник вопрос стараемся уйти от бизнеса от тех кейсов которые бизнес нам предоставляет пользовательский или же как раз таки пользовательский Путин То есть это важно потому что понятно дело почему это важно потому что это то что приносит нашей компании деньги да тем людям которые зарплату нам платят в том числе Да спасибо Я надеюсь что многие кто нас слушает прислушались к этому друзья Вот еще один вопрос Спасибо за доклад получился там был момент и рисование вот этих вот хождение к бизнесу узнавание детального пользовательского сценария и рисования даже бордов исходя из пользовательского сценария и кажется что это прям большой оверхед по количеству проделанной работы каждого сервиса у него есть какие-то ручки по каждой ручке есть какой-то Sli каждая ручка обрабатывает какое-то количество трафика с каким-то количеством ошибок с каким-то количество и не проще ли было бы просто по каждой ручке вывести вот те самые 4 золотых сигнала как будто бы подход проще и позволяет увидеть Что у нас где-то по каким-то поинтам начинаются проблемы на сервисе этот паттерн вот то о чем-то кричит 4 Золотые сигналы они идут на уровень ниже Перед тем как мы смотрим пользовательский путь потому что Объясню почему ты как человек вовлеченный в приложение мониторинг ты можешь понимать что тебе дает dashboards четырьмя золотыми сигналами Но люди которые могут пользоваться твоими сервисом эти метрики скорее всего ничего они не скажут ни о чем и вот идея иметь какой-то дашборд в котором есть просто кнопочки об и да например на какие-то определенные ручки или бизнес сценарии командам которые с тобой так или иначе взаимодействует они помогут дальше ты уже проваливаешься внутрь этой ручки смотришь 4 фо Голден сигнул там или Red неважно дальше ты проваливаешься в инфраструктуру идея как раз этого подхода такая в этом Да конечно есть overhead на сбор информации но опять же решая эту проблему ты решаешь проблемы непонимания системы когда ты все глубже погружаешься в то как работает система в целом мне кажется это очень ценный навык потому что на опыте на памяти мало кто сильно вовлекается в такую то есть мы типа за тепло или сервис как Ну и хорошо Коди крутится деньги мутятся про то не про то что на каком-то конкретном сервисе мы там прокрашиваем Up Down Там и так далее а про то что пользователи сценарий он может из себя представлять прохождение через большую цепочку сервисов и вот эти вот цепочки собирать это достаточно трудоемкая история то есть не стоит ли смотреть на каждый конкретный сервис отталкиваться именно от целый сервиса а не от всего пути пользователей Ну в целом думаю что да ну то есть такой подход тоже можно использовать все зависит опять же от глубины вот этих вот цепочек и от того сколько вот этих вот путей шагов делает ваш сервис но в целом Я думаю что для каждого плюс-минус продукта можно выделить Ну такие вот основные небольшие какие-то такие бизнес сценарии поняла что их может гораздо больше но опять же вот к вопросу того примера который был ты можешь ты можешь мониторить все но в целом тебе важно чтобы пользователь который что-то имел В корзине мог оформить заказ а все остальное ты можешь вынести Вот например сигналы или там ну как бы чуть-чуть как бы поменьше детализировать понял спасибо добавлю 3 копейки в целом приложение которое работает вполне может не приносить бабок потому что инженеры не могут мониторить обычно бизнесовые штуки нужно типа очень глубокое понимание нужно взять какой-нибудь менеджера и понять А что вообще происходит у нас есть вопросы как у вас мониторится сама система мониторинга но я перефразировал более широко как мониторить мониторинг перед мониторингами еще маленькая система мониторинга которая мониторит мониторинг Но это вот как это не все держится Да автор вопроса Кристофер Нолан я понял ну вот видите Да есть система Какой ответ еще вы ожидали друзья еще какие-то вопросы у нас в предпоследнем ряду Дождитесь микрофон а уже уже Да привет Скажи а вот как понять что обзватели это продукт как его превратить продукт какие там может быть метрики у него есть но насчет метрик не знаю вопрос точнее идея его в том что что-то превращается в продукт это начинаешь пользоваться не только ты продуктом то есть ты например сделал какую-то давай возьмем например прометеос да и прикрутил графа собираешься метрики пока ты только ей пользуешься пока ты только ей владеешь это твой личный продукт пока ты начинаешь говорить о нем рассказывать командам когда ты начинаешь команды вовлекать в использовании этого инструмента А еще лучше когда ты его вовлекаешь в доработку этого инструмента добавление новых метрик вот тогда начинает превращаться все в продукт и ты несешь Это в массы вся идея как бы опции это вот как бы культура там вынесение в масса того что мы делаем рассказывание об этом и вовлечение других команд вот большой процесс правильно я понял что в этом случае продукт тонерами будут все команды которые им пользуются Ну не совсем Наверное потому что когда они будут приходить с вопросами А тут идея в том чтобы они тоже могли вносить не просто говорить хочу вот это действительно помогать вам это сложный это сложно но как бы коммуникации этого можно добиться Я здесь тоже добавлю на самом деле в целом история про любой Ну такой сервис внутренний и его продуктизация это прям верный путь но нужен человек который ну его будет продуктовый на самом деле это тяжкий сложный путь и не все инженеры в это имеют Александр возвращается к нам с каверзными вопросами снова здравствуйте а не думали не только над концептом сервопилите эстрады сколько операбилити-с пока оно К сожалению так и получается ну то есть вот пока оно как сервис как продакт его вывести очень сложно потому что это большая работа текущей команде по текущем продукте Пока так сожалению не получается потому что продукт очень большой команда очень много мне кажется мы там собрали почти почти все инди паттерны которые здесь есть и чтобы Исправить нужно огромное количество времени огромное количество не только каких-то технических штук но и в том числе Вот коммуникативных и пока мы просто ходим пытаемся рассказать как-то погрузить людей показать Ну типа да вот ну типа как секта Ну потому что так и есть тогда отсюда второй вопрос Если мы говорим про концепцию Service у вас это действительно так есть насколько сильно по кнопочке при подъеме в пайпе какой-то новый элемент инфраструктуры там по всем слоям начиная от перформанса и заканчивая Application с бизнесом насколько сильно все автоматом прилетает сразу в дашборды и стимплей тиков там и прочее или все-таки мануального еще много Ну если говорить про текущий проект то мануально еще много но потому что как мы не так давно начал над этим продуктом я трудиться скажем тогда каких-то других моих конторах там было плюс-минус более-менее уже автоматизировано сейчас это такой начальный считай этап Потому что слишком все разрозненно очень много систем их надо все приводить в порядок Нужно как-то стандартизировать и упрощать то о чем я говорил Да и здесь пока пока этот процесс вот он таком зачаточном варианте Возможно когда мы все это делаем это будет еще одна тема для доклада рассказать о том как мы сделали как продукт они как платформа и наверное крайние вопросы что-то не буду тебя мучить слишком долго пока что с учетом всего вышесказанного у вас есть какие-то регламенты на уровне там не знаю конвенция логирования общепринятый подход к обсервабилити чтобы Ну не то чтобы сколько закон Но люди обращали на это внимание когда что-то новое появляется и не то чтобы сразу к вам идти вас Мучить А на уровне там не знаю странички в конфликсе почитали Ага там у нас все так так так И тем самым снимает точку входа и путь многих проблем чтобы не увеличивать бэк-лог и мне пришлось все это потом переделать или вам контракты подскажу вам есть Да конечно есть какая-то первоначальная информация уже доступна всем они могут её посмотреть и от этого дальше отталкиваться уже ну то есть мы не точно первая точка входа сначала нужно посчитать Великий конфликт а потом уже можно и пойти к нам Если ты точечные вопросы есть огонь Спасибо у нас был еще один вопрос или вы передумали А нет не передумали кто Кирилл Благодарю за доклад очень интересно познавательно хотела обратиться к первому антипатрну В итоге вы сейчас используете навязанное решение Спасибо хороший вопрос это было не на текущем моем проекте мы сейчас по запись просто не очень понимаю видимо под запись если на самом деле мы ушли от этого инструмента Нам его навязали Мы его использовали как как мы ушли на самом деле все очень просто есть такая фразеологизм Не мы чем-то катанием В общем мы начали собирать просто Corner кейсы которые этот инструмент не покрывает мы оформили огромную страницу конфликте все это описали мы сходили квендеру запросили у него доработки запросили информацию по тем или иным по темным кейсам могут они это покрыть или нет выяснилось Так что 80 процентов наших телок они в целом не покрывают и здесь уже более предметный разговор с бизнесом с руководством о том что ребята смотрите вот есть инструменты которые это делают наши навязанный инструмент этого не покрывает и вот таким вот как бы подходом можно потихонечку избавиться инструмента и получается современный вариант это решение построенное на компонентах из-за пансорс это собственная разработка или третий вариант это Open Source большей степени с небольшими доработками под какие-то такие вот прям угловые кейсы которые так или иначе не покрываются в системах Спасибо друзья Да у нас подходят время нам тут намекнули А смотрите Кирилла можно поймать в кулуарах он будет в зоне дискуссии доступен и там можно задавать вопросы которые вы постеснялись задать здесь под запись вот я тоже рядом постою Если вдруг зачем-то нужен вот Кирилл Спасибо огромное отличие"
}