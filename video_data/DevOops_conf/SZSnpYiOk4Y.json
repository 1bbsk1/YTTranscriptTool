{
  "video_id": "SZSnpYiOk4Y",
  "channel": "DevOops_conf",
  "title": "Сергей Курсон — CDK and infrastructure as a code",
  "views": 463,
  "duration": 3534,
  "published": "2020-02-07T07:52:29-08:00",
  "text": "у а всем добрый день слегка преувеличена все-таки мы позиционируем любой инструмент как вам удобно вы используете есть нравится тиров органов но те лица которые подняли руки сатира формы их и даже уже узнает сексу снова здравствуйте же принципам увидели да ну насчет простого зовут меня сергей я работу ввс и дпс как угодно может быть services работы уже порядка года и сегодня как раз расскажу про вот этот самый инструмент анонсированный цдк упал development kit собственно зачем это что это какие проблемы решали наши разработчики когда к этому подходили и почему у них общее это все в голове появилось немного себе я занимаюсь разработкой уже порядка восьмидесяти лет уже не помню ни 80а 8-10 да я неплохо сохранился и занимался разработкой для различного рода компании вес в том числе в дании у нас было несколько бренчи работали в разных странах в разных аккаунтах и в общем достаточно плотненько работали я занимался в устах разработкой включая себя сиди и включая весь devops так и ну собственно писал все с нуля вот поэтому попробую поделиться как я это вижу как наша команда это видит и постараюсь не повторится потому что уже где-то рассказал начнет стала по пунктам что вы себе почему синие поговорим в первую очередь очень кратко устная история работать с управлением фра структуры грубо говоря как эволюционировала инфраструктура облаке управление fans to тура в облаке потихонечку шаг за шагом в том числе как я это видел потом расскажу что сок на такое цдк расскажу о базовых его вещах как он работает что он собственно производит и как милость одним разработка ну так в общих чертах покажу дымку нам как бы другая но она тоже достаточно простенькая и просто показывает как среди работает плюсы-минусы но я думаю вы сами их увидите и по ходу дела и наполнителя информация но плюс я попробую рассказать то как я встречаю как наш клиент это использует сейчас уже уже идет достаточно плотно разработаны цдк и достаточно много компаний его используют всем цикле есть проблемы есть не проблемы кому-то очень нравится но попробую показать так начался вступления стая вещь у нас есть на самом деле несколько способов создать инфраструктуру в облаке данном случае нашего нашим а вес первый самый простой самый низким порогом вхождения это собственно вы заходите в консольку что-то там на такие выйти прямо ручками создавать виртуальные машины лямды вот этого все добро запускаете оно все работает вы прям это виде как она работает и у вас есть как от инфраструктура зато собственно мы начинали нашей компании это все было достаточно просто и легко пока было у нас достаточно маленькая структура буквально несколько серверов и там балансер по-моему это все замечательно поддерживалась но в какой-то момент мы начали расти и поняли что такой тип инфраструктуры его практически невозможно поддерживать просто потому что максим что это можно описать это мануал по которым который придешь другим разработчикам и говорят что вот ну вот что у вас было что-то похожее но делайте вот так вот и кивайте то же самое ошибок куча то есть у вас сразу начинается начинает появляться разница в структуре между разными разработчиками и времени это занимает так порядочно мягко говоря что ручка метода тыка а потом что-то повторить что-то добавить это начинаешь это добавлять начинаешь редактировать инфраструктуры получается у тебя шляпа следующий достаточно логичный способ это использовать силой нашу силой программный способ раскатывать ресурсы то есть просто запускается команда у нас выходит эта команда навес на запускать какой-то ресурс мы какое-то время ждем пока он запустится все у нас есть в принципе неплохо это можно автоматизировать к этому можно приписать это может приписать в код допустим кого-то другом приложении чтобы она this script и вызова по очереди все вроде замечательно но опять же у нас тут появляются дополнительные проблемы в том числе как нам допустим накатить обновления на все это дело как нам обработать ошибки то есть это надо нужно нам все самостоятельно писать нам нужно все вот эти ошибки ловить нам нужно брать exception он уже что-то откатывать все это самим нужно писать и это достаточно не просто поэтому сейчас один из распространенных способов использовать из они инфраструктура это том числе декларативные то есть это механизмы вроде того же конформация вроде может тира форма где вы описываете конечное состояние в структуру так так каким его хотите видеть то есть вы уже описываете не как это будет облака делать а что вы хотите увидеть есть конечное состояние это достаточно мощная штука потому что уже есть продвижение движки в том числе call for macintosh питера форм и еще другие есть они как раз сами в себе используют механизмы ролл bk не использую себе механизмы апдейта там дрифт детекшена в том числе которые показывают разницу между тем что у вас написано между тем что у вас развернутая и между тем что кто-то там ручками поменял но у этой штуки есть 11 достаточно существенный недостаток даже несколько но он вытекает одно из другого это в том что язык вот этого движка он все-таки это либо джейсон либо ямал это общем конфигурационный движок это не это дело позиционируется как интро строчках закону it infrastructure and configuration по сути это не кого то есть там есть какие-то имитации тех же программных элементов вроде там циклов вроде еще чего-то но в любом случае это у нас конфигурация и она достаточно многословной а то есть ты когда смотришь допустим тоже конформация он такой здорова-здорова такая портянка в котором нужно писать большое количество взаимного взаимозависимостей грубо говоря то описать виртуальной подсети описать как них лежат виртуальной машины как это все взаимосвязано группа доступа это все все все получается такая большая большая штука которую очень сложно на которых которого число читать который очень сложно поддерживать обновлять делиться вот эти штука тоже достаточно не просто оставлять получается большие куски кода который нужно копипастить перекидывать нашим другим разработчикам и самое главное проблема что да мне осмотришься и такое ощущение что она это дело руками писать не положено то есть это что то что должно быть сгенерированы автоматически очень похоже на то что случилось xml в один момент то есть он тоже точно также конфигурационный язык и сейчас используется просто инструменты которые часто и генерирует поэтому наша команда алла озоновцы и собрали наиболее распространенные ошибки на наиболее авто станины и проблемы которые были интересны которые они хотели собственно решить в первую очередь и мне нравилось то что было достаточно сложно выразить бизнес-логику в этих шаблонов потому что ну допустим ладно у нас маленький шаблоны ковать небольшой моего описываем там golf отлично все хорошо все несложно но есть у нас большая сложность про структура уже мы в банке работаем и еще где у нас появляется большое количество взаимозависимости и у нас появляется большое количество какой то конечно логике нам нужно подключить цикла допустим нам нужно подключить сторонние ресурсы и это все нужно упаковать какой-то в какой-то программный какой-то программную логику которой нужно потом уже дистрибутив копипастом ночь очень много в том числе работать со всем этим делом приходится в инструментах которые не достаточно удобно оба говорят о нас тот же тот же тот же call фармишь допустим у него нет нормального инструменты который позволял бы там использовать толковый intellisense тестировать тоже есть определенный набор инструментов но они чаще всего нацелены на сайт игры и шиттесты то есть тестировать до того как он будет развернуть это не просто как делиться снова лучшими практиками тут достаточно простая вещь нам нужно было нам нам нужно допустим вот написали лепить виртуальную под сеть с доступом и все хорошо красиво и нам это нужно команде передай то есть получается что нам нужно передать такой большой кусок кусок текста между командой и команда их просто этом копипасте как-то referenced но получается что очень некрасиво неудобно и порог вхождения ну да то есть сейчас сколько больше всего много людей идет в облако и эти люди они приходят из разных областей часто это программисты том числе и приходится смотрите новый конфигурационный какой-то механизм там тот же там вот этот ямал большой и приходится заново учить его достаточно сложно и его нужно понять нужно понять как эти зависимости прописать и но получается что им нужно получить что-то новое порог вхождения он достаточно сильно увеличивается поэтому команда решила сделать что-то свое как и все наше время и на самом деле у них получилась достаточно интересная штука которая но лично мне нравится сейчас я вам покажу надеюсь вы тоже интересуетесь потому что у нас и и сейчас активно стать достаточно используют команде потому что мы используем для прототипирование мы используем для конечных продуктов и называется то что у котла удивил их инкит в чем суть основное понять ехал development kit это механизм который позволяет создавать инфраструктуру в облаке при помощи языков вроде java все шарпа питона typescript а и планируется поддержка дополнительных языков под капотом это все сделано таким образом что новые языки добавлять достаточно просто как это выглядит у нас есть такая такой слоёный пирог слоёный программный пирог он состоит из собственно приложения в приложение которое вы пишете о том же typescript те на том же год на эти приложение у нас создаются стеки стыке собственно а не мотаться один к одному на логически не мотаться один к одному на стыке в облаке стэк это какая-то группа ресурсах который описывает workload стек уже свою очередь состоит из так называемого дерево дерево конструктов конструкт это уже какая-то логическая единица либо это у нас один конечный сервис допустим виртуальное подсеть лямда обидит вы еще что то в этом духе либо это группа сервисах объединенных друг с другом по какой-то там логической системе насчет чуть позже опишу как это выглядит нос в том что это позволяет что конструкты они позволяют построить это то самое дерево это та самая та самая суть цдк дело которое описывает вашу инфраструктуру а при разработке этого инструмента у нашей команды появилась ну они же не просто так взяли из потолка начали что то писать на то есть они сели дружно покумекали поняли что им нужно определиться в первую очередь концептом зачем это вообще все наши нужно и какие у них будут и дизайн голос называемый то есть они определили для себя порядка шести дизайн голос таких целей целей разработки которые они хотели бы достичь в первую очередь они хотели добиться улучшения опыта разработчика чтобы не нужно было писать какие-то большие большие портянки чтобы можно было писать достаточно удобные вещи которые ну допустим человек пришел там издать этом хочет писать идут найти ему на намного удобнее писать на своём в привычном языке они хотели чтобы конструкты были созданы равными и равенство это конечно хорошо но сама суть от этого постулата заключается в том что они хотят чтобы конструкты которые созданных команды наши а в с и конструктор который создаются какими-то другими 35 и командами они были едины по интерфейсу то есть чувствовались использовались одинаково в коде то есть не было какой-то разницы одна из очень важных вещей в том числе им хотелось сократить количество написанного кода чтобы просто это в том числе и последний постулат они взаимосвязаны то есть и просто хотелось чтобы разработчики меньше времени тратили на написание всего что они пишут для того чтобы не было больше времени на собственно придумывать придумал ничего нет нового вместо того чтобы повторяться там копипастить еще что то в этом духе в принципе тратить время на создание сложных сложных шаблонов они также хотели использовать создать постулат так называемые разработки в стиле если детей вы называемый чтобы можно было использовать больше нативных из возможностей языка вместо вот этих имитаций логике на стороне провяжем движками в том числе того самого клад фармишь на то есть написать там лук в через год формейшн вот этот его импровизацию использовать нормальный толковый язык в котором можно писать for each еще что то в этом духе использовать уже вот эти вещи и одна из очень важных вещей это уже я упоминал им хотелось понизить порог вхождения в этот инструмент для того чтобы человеку здрасте приехали для того чтобы это было проще войти в инструмент было проще в эти облака и понять что он собственно делает то есть ему нужно было бы знать просто там какой-то базовый набор базовый набор инструментов уже начать работать вот этих собственно пустовал это наши ребята хотели решить поставили перед садятся перед собой целью собственно для этого они создали несколько уровней называемый конструктов это те элементы которых я в говорят это самая суть цдк при том цдк его конструкция не такой тоже слоёный пирог x их несколько уровней на самом деле логических 3 но на самом деле их 4 0 уровень так называемый фреймворк это собственно приложение цдк это у нас основании этот-то самый та самая логика в которой хранится баэс классы в которой хранится основные библиотеки и собственно вся обвязка цдк дальше начинаются три уровня базовый конструктор то есть первый уровень это у нас низкоуровневые конструкты по сути это у нас в библиотеке которые один к одному нам зама плен и наконечная войск ресурсы если это верхний виртуальный по цвету это виртуальное потеть если это и хиту виртуальная машина то эта виртуальная машина эти классы они автоматически генерируются движком и они генерируются на основании нашего дела кольцово нова файла который описывает все наши удачные просто все наши все ночные облачные ресурсы этот файл в открытом доступе его можем любой момент взять посмотреть что у нас там есть если том что команда использовать этот файл и того чтобы автоматически генерировать вот эти вот корневые классы первого уровня они называются f n bass потому что они все используют серфинг префикс в имени своего своего класса это такой нижний уровень через который всегда можно зайти то есть если нам нужно сделать очень очень сложно что-то очень кастомная можно опуститься до вот этого уровня и создателя инфраструктура прямо по самым маленьким кирпичикам практически как платформы шли второй уровень это уже библиотека который предоставляет собственно наша команда это у нас тут сидит сидит наша дружная команда она пишет связочку над конструктами нулевого уровня они пишут вот этих красных на первом уровне то есть библиотека конструктов она заключает себе классы которые описывает эту структуру с использованием без практик то есть они используют принципы минимальной привилегии они используют принципы сетевой связанности то есть допустим если мы используем в писе и call от записи конструкторе на 2 уровня то у нас описывается инфраструктура уже уже какая-то база место тут с публичными сетями с приватными подсетями то есть уже какая-то готовая вещь которой можно просто написать и использовать то есть это то как наша команда видит вот эти вот конструктор то есть их в любой может в любой момент можно кастомизировать можно там если коснуться сдают по умолчанию nnnn ресурсов то валют можно в любой момент эти ресурсы как-то поменять опустившись опустившись ниже или поменять свойствам и собственно третий уровень это уже нас такие на так называемый api они опьянены кит конструкты то есть их суть что это константа который создают уже не наша команда и это создает уже все те кто хочет тут уже можно написать все что угодно это вещи которые опубликованы в букете внп ими их подтягивает этих можно подтянуть в любой проект если том что это такие открытые решение которые люди уже сами пишут openid openid это сама суть этого термина заключается в том что у вас есть эти константы они представляют чье-то мнение на на инфраструктуру говоря и вот кто-то там сидит у себя так а питер вот я вот вижу что можно написать допустим контейнер на обвязку вот таким образом он пишет конструкт пушат его там в не get и таким образом можно этот пакет потянуть вот это у нас собственно верхнего уровня а вязка там 3 и 3 плюс уровень и это уже какие-то танк остальные вещи в них есть своими на то есть если у нас второго уровня все объявляйте эти прописаны с префектом цдк дефис и потом уже идет наш сервис и в данном случае уже может именование быть любое технический лучше конечно соблюдать какие-то правила так вот так покажу остудим q как то все выглядит она достаточно простая тут я создам несколько базовых вещей чего все яйцо я допустим visual studio код просто потому что мне нравится сейчас у меня установлен цдк пакет то есть цдк силой и с ее помощью этих буду инициализировать проект то есть первая команда который нужно сделать это собственно такой openid загадай и нет она создает локальную обвязку создаёт необходимые файлы для проекта будет a dot net будет это там что угодно это будет минимальная базовый пакет запускаемого приложения в данном случае я буду использовать typescript сразу хочу предупредить благодаря магии видео здесь достаточно сильно порезана ну это плита по установке допустим пакетов деплоя на облака она просто потому что же ваше время не тратит вот этим вот сидеть и смотреть каком-то диплом цена просто заранее вот следующая команда достаточно полезно bootstrap есть у нас используются какие-то ресурсы с локального с локальной машина нам нужно будет запустить sdk то есть грубо говоря у нас сейчас создав усе в облаке baked в котором будет хранить какие-то свои временные ресурсы для диплом равно достаточно простая команда она просто компилировать typescript на лету поскольку у нас цдк это не один такой большой кусок кода который нужно подключить это у нас набор пакетов которые нужно которые можно по очередь подключать для различных ресурсов в данном случае я сейчас делаю за простую вещь и подключаю пакеты необходимо меня для генки это у нас будет и счету это у меня пакет будет и съезда ножка так сервис 1 2 это это у нас конструкта второго уровня библиотека конструкта второго уровня следующий пакет этот по библиотека конструкта третьего уровня это уже паттерны и который описывает более высокоуровневые вещи ну и собственно удобно собственно необходимый тип этот клип то может он создал цдк и нет у нас создал несколько папочек впервые у нас лежит наш код конструкта во второй лежит у нас код только пардон skoda казачки также снимочка подождем то есть самое самый обычный тип скрип проект на пляже там свой пакет свой файл джейсон который описывает необходимой подтянуты пакеты там гид прочие вещи сейчас быстренько нагоним пардон этот сбросим вот и сейчас пока знак коду я покажу день когда я просто я просто буду использовать контейнер и разверну их в озвучке нафармить и то есть кому не известно for great это сервис который позволяет это сервер лес сервис для для деплоя контейнеров то есть не нужно праведник не нужно выжить подлежащей виртуальная машина может просто сказать я хочу этот контейнер кто-то запихнуть чтобы он где-то как-то работал вот и есть код в котором нас описан вызов стека и собственно файл стыков котором нас описывается вся логика это на самый обычный кот сама вы ищете от крепи что мы тут делаем и просто сейчас подключают библиотеки те самые которые мы ставили через npn то есть 1 в первую очередь а найти и ситу то есть тут никакой магии просто просто обычный кот который уже если вы пишите skype скреплена вам это достаточно знакомо то есть если вы печатаете ну точно так же там подтягиваете через не get пакеты cs библиотеку то есть вот это один из тех при это созданные равными то есть если мы подтягиваем библиотеки которые были созданы кем-то еще какой-то там по терну то есть это вы это выглядит точно так же как и если мы подтягиваем библиотеки которые созданы нашей команды разницы совершенно какой и ощущение должно быть такое же мы пас это необходимая вещь стой вещь я тут немножко приостановлю что мы делаем мы мы сейчас создаем конструкт ли писин то есть виртуальная потеть каждый конструкт он по сути принимает в себя три параметра поскольку у нас конструктор конструктор это собственно дерево нас указано конструкта должен быть парень ты парень ты это вот в данном случае это слова адрес и ну просто проще запомнить что его нужно использовать просто потому что это позволяет конструкцию как-то себя позиционировать дерево второй параметр это ай ди ай ди по сути участвует в двух вещах первое он участвует в именовании конструкта уже собственно в самом офисе ужасов в собств консоли можно найти вот этот ресурс используя айди жку как префикс и второе это имя позволяет найти конструктор собственно в дереве конструктор то есть какой-то момент нам нужно будет попасть это дерево найти конструкт то вот это имя но нам позволит его найти это имя оно должно быть уникальна своей ветке и ниже constructie но она может быть глобальным между разными конструктами иисуса это у нас properties свойства класса данном случае нам мы используем только одно свойство это максимальное количество авила белки зон то есть я хочу чтобы меня виртуальное по силе растянулась на 2 availability зоны что это что что эта штука создаст она создаст полную обвязку и писи с приватными публичными подсетями она создаст таблица маршрутизации она создаст необходимые правила для доступа и базовый там насколько я помню security group и который позволяет вход то есть это все сделать сейчас это все выглядит в одну строчку которая что-то там волшебно магическим образом делает но если нужно закопаться ниже там сделать для публичной посетили оставить только приватной подсети или только на 1 л ability зону развернуть ну это просто нужно сконфигурировать и все это просто обычные свойства языка после чего 2 костру который я хочу создать это у нас кластер исчез нашего контейнер сервиса собственно тут кластер который будет принимать в себя контейнеры в котором они будут разворачиваться все точно так же то есть каждый конструкт он выглядит одинаково передаем торрента передаем айди и передаем свойства нам случае нам нужно передать только это свойство это собстна репите в которой этот это контейнер на вязка будет развернуто третья вещь которую создаю это собственно construct 3 уровня это у нас уже for great service по сути это обвязка которую кто-то написал и которая к себе содержит уже целый набор инструкции для того чтобы развернуть сервис на forbidden грубо говоря указания на контейнер указание сколько именно память и цикл будет выделено и все вплоть плотный довела до мелочей то есть это вот у читал читал их без практика по созданию насколько помню наши на самом деле это без практика по созданию собственно контейнеров нафармить выглядели достаточно просто мы точно также передаем два необходимых наши параметры и свойства класса которые нам скажут собственно какой кластером это видео разворачиваем и на из очень полезных вещей абстракции языка заключается в том что у нас этот конструкт это но по сути это унаследованный класс от чего-то более высокого то есть здесь в логику зашита здесь в где скотт зашита дополнительный логика которая позволяет подтянуть докер-контейнер потянуть в докер файл прямо из проекта собрать из него докер-контейнер запушить его в репозитории и сразу развернуть на for great ребята вот так нем достаточно удобным образом это сделали то что это сделал я просто указываю что у меня образ докера он будет лежать from basic весит это собственно с локального ресурса сейчас я просто скопирую там несколько файлов том числе докер файл еще что-то не у меня стопочки стопочки рядом лежит я скопировал это будет часть проекта вот его скопировал здесь никакой магии все просто это самый обычный питон скрипт который возвращает у нас какой то базовые вещи какую-то простенькую логику докер файл в котором собственно описывается образ и собственно что происходит для того чтобы ставить питон ну и рекламе нс обычно питон новая вещь которая подтягивает вкладка после чего мы говорим уже нашим конструкции что вот это все добро оно лежит у нас здесь от папочки в проекте используя подтягивай не собственно единственно одна маленькая вещь тоже одна из очень полезных одной из очень полезных свойств языка это дописывать бизнес-логику через класса расширения ес грубо говоря мы можем взять конструкт и дописать ему сейчас у нас for great он сам себе то есть просто запустить настолько нужно будет где-то работать и как это будет выглядеть и понятно нам нужно к нему снаружи добиться там по 80 порту допустим для этого мы делаем достаточно простую вещь через класс расширения через метод расширения мы просто говорим что мы хотим вот этому вот контейнер открыть 80 порт отовсюду таким за мы не закапываем ся в security group и мы не закапывается в какую то там сложную там xs логику еще что то просто говорим что минимальный набор доступ который нам нужен это собственно 80 порт вот отсюда очень прост маленький кот есть парад пара дополнительных команд которые цдк очень помогают на самом деле в разработке том числе сейчас и по что было с ней что происходит на экране потому что на кону уже смотреть не смысла там так написано вот первая команда это у нас садика sind sie то на что делает поскольку у нас к фирмы цдк он все-таки какой-то момент транслируется клад формейшн то есть он он по сути у себя под капотом использует колфер машин движок то есть он использует можно написать какую-то бизнес-логику обвязку результатом все равно доклад формейшн вот этот большая штука которая уйдет на движок который уже сам за хиндли все необходимые роль бекки все апдейты прочие вещи то есть сент он все делает он показывает вам что именно будет сгенерировано в результате написанного вами кода как результат all of our мыши это полезно по нескольким причинам в том числе до тестирования допустим есть так называемое snapshot тестирования позже об этом песню ну и можно можно использовать генерировано шаблоны для каких-то своих других целей то есть int выглядит достаточно просто показывает что вот все что мы написали там сколько там 1523 книг она все результирующего такую большую большую портянку которая в себе содержит всю необходимую обвязку то есть у нас по дефолту прописаны out пустое тиреллы на который мы можем постучаться нас прописаны metadata на ресурсы что может быть проще найти когда день идентифицировать вот у нас прописано security группа который мы сверху одним методом открыли на 80 порт и дальше большое большое количество ресурсов которые были нам пришлось руками создавать и не знаю в каком то движке чтобы получить наш необходимую наш необходимо вот эта обвязку на флейте с контейнерами том числе нам самим пришлось бы думать как нам вот этот контейнер запушить в репозитории как где и как его собрать как его потянуть div очень полезная команда почему она показывает собственно что у нас есть наш код он как-то описывать на структуру у нас есть развертка структур сейчас у нас ничего ничего в облаке нет но по сути если бы была вот эта команда она показала бы разницу между тем что у нас написано и между тем что будет развернуто поскольку у нас сейчас ничего не развернуто у нас там одни плюсики все будет создана эта штука очень на самом деле полезно потому что допустим вот вы используете какой-то конструктор тот же в писе он по умолчанию создаст допустим в себе какие-то ресурсы и какие-то из них вам могут быть не нужны так вот перед тем как развернуть ваш инфраструктурного облака вы делаете div и смотрите что от меня действительно будут какие-то ресурсы а вот вот этот вот где твой мне не нужен это внесу изменения в свой код и у меня его не будет с конструктами третьего уровня но я чуть позже остановлюсь на этом объясню почему то есть вот у нас большая шайа большая вязкая ресурсов они чуть более удобоваримой виде показываются то есть и табличка вот у нас security группа которая будет создана все достаточно достаточно симпатичненько после чего следующая команда который нужно сделать одно единственное для того чтобы выкатить вот это все добро на облака цдк диплом но она собственно делает достаточно простую вещь она выкатывает нашу инфраструктуру на клад формейшн и она стримит отпуск fat формация канав консольку то есть мы можем прям на лету видишь что происходит здесь у меня на ходу собирается докер-контейнер он же здесь же на ходу запутаться в нашей базе торе и которая по умолчанию создан 10 если не нужно вы сами это все делаете на просто пока столько такая-то выше описал он это сделать и стремится собственно all put тут я достаточно сильно порезал время но просто потому что не хочу постоять 10 минут попытаться рассказать о чем-то не знаю веселом по итогу у нас получилось а получилось а я . у нас получился балансер который балансер который смотрит сеть и по 80 порту у нас есть вывод вот этот контейнер у нас сейчас крутится на сервер лев и он у нас описан полностью инфраструктурой который мы написали который мы собственно писали ручкой и теперь этот код мы можем закомитить в репозитории сохранить его где-то поделиться чтобы у нас ребята начали один писать какие-то свои изменений вносить достаточно простая вещь я надеюсь это немножечко police него что такое цдк на самом деле что произошло под капотом пока это все происходило дело вы собственно написали код то есть вот этот элемент источник source код у нас использовал села до села и для того чтобы скомпилировать собственно платформой для этого он использует достаточно интересный механизм называется дизайн сайта библиотечка которая позволяет маппить нативной typescript классы на собственно классы из других языков то есть это та самая вот тот самый корень всего который у нас использовать для того чтобы прописать для того чтобы использовать языке вроде того что то вроде того вроде тоже джавы это библиотечка она собственно была использована у нас сгенерировался этот формальный геймплей он где-то там памяти сохранился и ушел накал поймаешь и процессор процессор уже собственно все развернул показал нам all тут и что-то там свои какие-то вещи сделать есть если были бы ошибки у нас в консольку платформ седока это всё ушло и получилось бы что ничего не получилось большая большой конечно с то что это нормальный кот у меня допустим коллега вот он сейчас пишет на питоне и он нарадоваться не может я вот натовской пришел только потому что цдк такой удобный вот и цдк он вот плюсы кода они достаточно интересный то есть первую очередь если мы пишем на нормальном языке у нас есть строгой типизации то есть мы можем указать конкретный тип класса и благодаря этому получать уже то даже если предупреждение выдержки в нашей рефакторинг крышка тоже отличная вещь то есть рефакторинг этот кот уже одно удовольствие то есть у нас уже есть какие-то div механизмы но том же ките уже есть div механизм нормальной которые позволяют код дефать intellisense как все видели то есть когда я набираю кот у меня там подсвечиваются все необходимо все необходимые подсказки 7 это достаточно хорошо документированы и описанные что собственно внутри происходит из команды как команда пытается про документировать sdk ну как можно лучше них сейчас такая плотненькая работа над этим идет один из больших плюсов того что мы используем нормали код это тоже можно подключать стороннюю бизнес-логику то есть мы можем подключать вещи грубо говоря нужно хранить какие-то секреты напиток на этапе сборки можем подключать это секреты можем использовать даже сторон сторон не иструментов вроде volta можем спорить вообще любую логика у нас один из клиентов рад вот этой работы том фокусу с нормальным языком просто потому что они могут перед тем как развернуть свою инфраструктуру они могут логический поверить что где-то там лежит контейнер в репозитории не просто из кода пишут что делать-то проверочку если коты новая версия котельная райсуда 1 diplo его и новую новую версию опять-же мы тут все знаем что такое сесть идея нормальный нормальный div нормальной pipeline и и у нас уже get это все настроено и сама суть заключается в том что у нас ну мы используем мультирегион или какой-то уйти аккаунт подход то есть лучше всего конечно когда у нас инфраструктура она между различными стадиями тот же тот же самый df тот же самый stating про то на наиболее унифицирована но поскольку но в реальной жизни так не всегда бывает на самом деле просто потому что у нас допустим в деве нужно там открыть какой-то бы каком какому-то ресурсу публичный доступ для того чтобы могли вопреки божий' или скажем нужно в том же дэви нас должен быть гораздо меньший масштаб ресурсов чем то что у нас будет на проводе опять же там либо с 3 баки должен быть зашифрован то есть такие вещи они все-таки такие мелочи они разнятся между разными стадиями и это нужно учитывать и как раз благодаря нормальным свойствам языка то есть там уже наследованию тоже инкапсуляции тем же той же нормально бизнес-логики мы можем как раз вот эти вещи смоделировать между разными стадиями то есть использовать не только входящие параметры для того чтобы что то изменить мы можем это изменить уже на уровне написать над самой написаны логике поиск то есть просто наследуем классах как их видоизменяем ниже по дереву и накатываем на разной стадии за тестирование расскажу я вам немножко достаточно интересная вещь сама команда ним недавно этим делом поделилась ну я сейчас поделюсь с вами то есть тестирование на самом деле она ведется но позиционируется как тестируете ваш код как нормальный собственно код то есть используете они юнит-тесты используйте еще какие-то тесты которые используют при обычном три обычных разработки на своих языках команда она собственно вышла с четырьмя различными типами тестов это собственно то что они сейчас используют но может просто к ним зайти в репозитории посмотреть они там делают и в итоге сами простые как stc но основной постулат что их всего 4 1 это snapshot тесты это как раз та штука которая говорил что у нас можно сгенерировать club for me shen шаблон получить его вот как как вот этот отдельный файл и снапшоты стэфани девы достаточно простую вещь не просто говорят что вот у нас вот эта сгенерированная шаблон он отличается от того что было сгенерировано позже где-то буду изменения она в принципе есть и нам сейчас нужно дальше тестировать этот этот тест он просто показывает изменение были но он недостаточно показателем он просто нас команда его используют только для того чтобы опуститься глубже то есть на свиней есть хорошо тогда копаем глубже дальше ты говоришь на тесты но достаточно простая вещь то есть мы раскатываем инфраструктуры и мы начинаем ее тесте снаружи начинают там прозванивать in point и мы начинаем смотреть что она что-то там развернулась 3 3 test это у нас уже собственно fine dreaming предположение они собстна водили руют во лидирует уже какие-то малые части малой части конструктов например что у нас тот же самый детальки он создает там необходимые ресурсы в облаке и последнее это собственного людей шин тесты тут все тут тоже достаточно просто грубо говоря мы когда пишем конструкт у нас должно быть какое-то валидация входящих данных что у нас человек там ну вот в данном случае у нас просят аватарки у нее там 14 14 дней максимальная длительность очень максимальное время проживания сообщений в очереди то есть у нас если человек на уровне кода ведет больше значения то мы можем это сказать на этапе компиляции что есть у нас ошибка что у нас ну вот вывели неправильно данной то есть вместо того чтобы взять вот этот весь код эту портянку раскидывать ее в конформация ждать там какое-то время вот так вот сидеть и она в итоге упадет там через 10 15 минут вместо этого можем на уровне кода праве право лидировать вот эти вот вещи и сразу сказать что у нас вход неправильно и вот тебе ошибка и дальше мы идем и сразу вот так то есть такие вот 4 достаточно простых видов теста можете свои своей какие-то тесты использовать тут никто никто не ограничивает этот ваш код вот делаете что хотите есть парад камином и практик в том числе то есть я вот тесто мы используем этого собственно код обычного приложения но на самом деле эти практики недостаточно сильно пересекаются с обычными практиками тестирования то есть если мы тестировали приложением и нам не нужно платить какое-то большое количество схожих a heart of между разными частями просто нужно как-то их абстрагировать и писать как можно больше как можно меньше кода и нужно проверять малые части теста то есть не прогонять тест и смотреть что у нас все упало просто упала и все чего вполне понятно нам нужно оптимизировать наши тесты чтобы они тестирования наиболее малые части нашего предложения наших наших конструктов то есть допустим что у нас и просто там у нас там с квестом очереди наши не создаются ночью что они создаются именно потому что человеку не указал что у него там достаточное количество дней там в очереди и вещи которых пожалуй стоит знать это достаточно простые простые и логичные вещи но их стоит держать когда в голове потому что ну потому что нужно все-таки construct 3 уровня это у нас такая вещь как черный ящик или грубо говоря если у нас конструкт пришел откуда-то снаружи нам нужно понимать что тот человек который его написал он собственно зашел какую-то свою логику мы можем этой логике доверять мама живи недели лета суть том что этот конструкт пришел откуда-то то он может открыть доступ вашим облаке ну на что угодно то есть вы должны это понимать и это одна из вещей которые можно проверять через тот же дифтерит через те же сент ну просто посмотреть что у вас будет развернута в итоге обязательно тестировать это на каких-то средах радиста и дженга вроде там еще где-то дева в этом и заключается сама суть еще одна вещь что наша команда конечно она очень активно работает ей за это большое спасибо молодцы мы им пишем они нам не отвечают на течет и поэтому они все-таки могут не поспевать сразу за всеми ресурсами которые нужно писать и поэтому если нам нужно писать что-то более глубокая боль более сложно иногда приходится спускаться до конструктов нижнего уровня самых тиффин классов но это просто это это пока вот такая штука то есть если вы начнете активно contribute тьмы это все нагоним и будете замечательно пока иногда приходится спускаться грубо говоря если там описать какие-то сложные вещи в виртуальных по сетях впереди насколько я помню нужно было тоже описывать их их придется использовать эти вещи стефан класса и тесты тесты тесты это обязательно ну тут это просто повторение мать учения то есть тестировать код нужно обязательно нужно смотреть что он не упал может смотреть что у нас все необходимые развернулась что у нас не развернулась ничего не необходимого и обязательно нужно все тестера перед тем как выкатывать про есть несколько вещей как я встречаю наш клиент и сейчас используют самые цдк их на самом деле намного больше но я постарался их сгруппировать первый подход это собственно чистые cd к это когда у людей есть какая-то ним как небольшой проектик в уме и они хотят вот вот они увидели цдк не хотят попробовать или они уже пробуют и они используются цдк уже самого нуля самого начала на каких-то небольших проектов чаще всего это контейнер и чаще всего это лямда сапеги твоим то есть что то что то такое достаточно простое сложные проекты но не просто немножко больше времени и народ не может сейчас старается использовать более удобный гибридный подход удобный в том зрения той точки зрения что у них большое количество большого количества компания них уже чаще всего описанный их и ресурсы класс фармишь не уже в котором в каком-то готовом виде оно уже есть и поэтому гибридный подход он им больше подходит просто потому что не нужно все сразу переписывать и все сразу ломать и портить то есть первое первый тип использование гибли на подходе это собственно люди у нас это дерутся всю сочетаюсь существующей сети pipeline грубо говоря уже есть какая-то обвязка они уже когда-то там что-то deployed у них уже есть свои шаблоны и они за бочкой мы не хотим у нас есть какой-то активист он говорит я вот хочу только по проводим я начал ломать не надо никого отсека и поэтому использует тот самый цдк только для того чтобы сгенерировать те же самые платформе шаблоны они уже дальше по pipeline уйдут он собственно ничего не ломает это позволяет ему потихонечку переписывать логику уже на что-то более удобоваримой очень частый пример использования собственно цдк это какие-то внутренние вещи в первую очередь соседи pipeline и правым это вот ну такое каждая полу третье сообщение на гитаре она говорит о том что у нас там мы хотим создать свои сиськи и pipeline и при помощи цдк но ли какие-то внутренние ресурсы какие-то внутренние обвязки также у нас есть один интересный момент грубо говоря я встречал человека который говорит я хочу попробовать садик она у меня вот этот город это уже всего написано я хочу это как-то не хочу все сразу переписывать я хочу потихонечку это все конвертировать есть механизм , который позволяет подтягивать колод фармишь на ресурсы прямо в код использовать из них необходимые вещи какие-то и уже на лету вот эти вот эти шаблоны переписывают грубо говоря у нас есть какой-то большой стек есть связочка на цдк и мы все эти ресурсы подключаем подключаем в проект используем все в них необходимо раскатываем и потихонечку переписываем конформация шаблоны на уже наш любимый язык также один из наших клиентов он использует интересно использовать сервис каталог а там необходим клад формат шаблон для того чтобы рассказать ресурсы ну тут сам бог велел что приходится генерировать платформе шины с цдк и он просто используйте накатывает сервис каталог ну и самый пожалуй популярные сейчас один из самых популярных методов использования собственных цдк это в учении дыма просто потому что очень легко прийти показать как вот у вас инфраструктура разворачивается просто написав там несколько строк кода и это все очень замечательно работает кита тестовый проект и те же прототипы мы пишем сейчас у меня коллега в том числе пишет на питоне я уже упоминал я в том числе пишу у меня ауте проект я вот уже час пишу на переписываем на цдк то что она очень удобно пожалуй тут нет нет смысла на них останавливаться просто потому что я не хуже почти все рассказал тот же бу страпон у нас раскатывать необходимую оба точку для цдк и нет создает проект div показывает разницу между тем что есть и тем что тем что вы написали сен синтезируется по шаблон для каких-то ваших целей диплом диплом дестрой destroid все просто из следующих шагов единственное что стоит упомянуть это даже не единственное 6 нуждин и что есть несколько вещей которые стоит посмотреть в первую очередь это цдк workshop очень полезная штука она позволяет как раз потрогать вот эту cd газовыми и понять о чем речь то есть написать какую-то базу инфраструктуру понять как у нас работает абстракцией как это все можно упаковать в том числе доке на амазоне они сейчас постоянно дополняются команда должен дать ему активно работает на гитхабе есть репозитории в котором есть вот эта третья сила чко это репозитории котором народ публикуют свои какие-то необходимые свои готовые конструкции в которые можно попробовать раскатать увидеть ну и сообщества этого самое важное собственно гитхабе есть сообщество очень активное сообщество сейчас на гитаре там сейчас постоянно постоянно несколько ребят с цдк крутятся они очень быстро отвечают белой по моему отвечает я недавно вопрос задавал и кипит там жизнь достаточно активно ну и собственно собственно сам репозитории цдк захотите смотрите как он написан можете просто посмотреть как это все изнутри работает под капотом одна маленькая вещь я добавлю собственно ссылочка который можете использовать для того чтобы подписаться на различного рода мероприятия на приглашением римляне который нас проходит в нашем регионе фильме регионе россия украина стран снг то есть по этой штучки просто подписывайтесь пока быть и получить уведомление когда мы будем приезжать когда мы будем что-то организовывать какие-то ивенты еще что то велкам любой момент ну на этом вы у меня все я вроде даже почти уложился да я даже выложился замечание так что всем спасибо до 1 раз о сергей большое спасибо за доклад и прекрасно уложился у нас осталось ещё 8 минут так что мы сможем немножко даже вопросов из зала присаживайся поудобнее тут у нас выше так гостинная такая даже значит перед тем как мы начнем небольшое объявление в 12 часов hostal у нас закончится уже совсем все время сергей будет с вами дискуссионной зоне вопросы которые мы не задать не успеем задачи час вы сможете задать ему там также 12 часов зоне кофе-брейка тимати рестор который бродил вчера кино ut тоже будет доступен для общения автографов вопросов и так далее я наверно начну с двух самых таких главных больших вопросов которые наверно интересны всем и первый это клауд лак и является ли штукой которые заточены исключительно по амазона для амазона или есть какие-то планы по расширению в другие клауда и так далее вот эти прямо сейчас эта штука для амазона это так планы есть да я к сожалению могу их озвучить просто потому что я не являюсь частью команды и недостаточно самый там хорошо варюсь носу и том что это она одна из идей все-таки расширили сам постулат использование нормального кода на какие-то другие движки ну да то есть в общем то сделать это чтобы могли им пользоваться все естественно но это самый логический шаг по да да еще кстати говоря 1 так сказать объявление если вы не справились со способом задание вопросов боте поскольку в слове devops она про юзабилити то значит в боте надо пойти в программу все доклады промотать до слота с 11 до 12 30 числа и там у вас будет опция задать вопрос да ну вопрос на самом деле много это значит у многие справились мы в общем то народ закаленный софтом из юзабилити вот лучше просто подходите ко мне мы с господа в dice красивыми зоне но у нас еще есть время поэтому и вопросов много фоток стреляющих во всех до второй такой тоже большой вопрос этапа какие языки поддерживаются ты показывал typescript и упоминал dotnet что еще до на самом деле четыре базовых сейчас это питон typescript на чем цдк там написан dot net java ну такие да все самые большого самые основные да хорошо давайте да посмотрим уже более такие вопросы более подробные водным пример является ли си дикий части у силой или это отдельный инструмент этот отдельный инструмент он работает сам по себе то есть силой ну он у сидите у него своя собственная силой за счет чего он и работает он вызывает своей собственной команды но это не является частью основной обрез схемой да про языки мы спросили можно ли обновлять инфраструктуру не в целом а частично как вот делать дыра формы таргет например и как можно перевести существующую инфраструктуру под управление си детей импорт но на самом деле я так полагаю вопрос был задан до того как я немножко об этом матча говори про гибридный подход да да да ну да то есть если есть существующая инфраструктура на клад фармишь не то есть два варианта либо и переписывать это все руками имеем в себе там знание об этом конформации 0 перед глазами его держа либо можно импортировать эти платформы шаблонов сам сиддики использовать эти них ресурсы и уже потихонечку как переписывать ну да да вот еще вопрос где сиддики хранит состоянии что создано что предстоит создать можно ли это со стенда этого состояния как-то там достучаться посмотреть состояние что что у него создана что у него предстоит состоянии создать интересно так сходу не отвечу скорее всего в памяти что будет если я изменю параметры уже созданного объекта и снова запущу диплом будет использован обычный механизм платформа ешь на которая собственно обновляет у нас ресурс и наверное как-то вот тоже к этому относятся на базе какой информации строится div датив он строится на основании ну это скорее это скорее всего у нас есть класс фар машин который уже развернут и у нас есть клад формейшн который будет генерировать при помощи цдк опрашивается уже развернутый клад формейшн и эти две вещи просто сравниваются то есть это это не дрифт детекшена то есть не сравнивается собственно шаблон с тем что кто-то руками поменял это собственно сравниваться два шаблона один развернутые другой которая будет получена в результате генерации через sdk ну дальше за вопрос который я честно говоря не очень понимаешь ты поймешь даже когда мы используем python для синяка проекта в runtime и все равно нужен java script и в реальности все контролируется в java script представление то а почему это важно какая разница потому что это так она подкреплена нет но это понятно ну в общем то если у меня есть если я могу писать код на на бетоне то меня только питона интересует тогда там в runtime и как-то мне неважно да то есть нужно просто runtime и все ну дай мне нужно знать typescript в принципе пишешь на питоне там устанавливаешь необходимо runtime там через npm или еще что-то там неважно вот и тебе не нужно там понимать не чертовски вами но тут же самый коллекторы упоминал он стать скрипте не знает ничего ну да да что вот я хотел спросить что на самом деле важно да еще один вопрос поддерживаемые языки кстати говоря вот я упустил эту часть предыдущего насколько сложно добавить новый можем ли мы это сделать или нам нужно сидеть и ждать пока вы это сделаете contribute велкам насколько ну доходило это понятно это хороший призыв насколько действительно сложно то есть это какая-то должна быть то есть это какой-то нужно приводить это вот java script приводил но достаточно простой как я это вижу то есть нужно поднять ищу на цдк сказать что вот нам нужен новый язык я готов и это все пройдет через процесс плыли квеста с командой собственно все только за вопрос больше не процессуальные а именно технически насколько тяжело написать поддержку молоденька ну это надо разобраться джейса я и на самом деле то есть как как маппить собственно вот этот тип скрип на уже на методы вашего языка там голову руби неважно что ну да у нас время закончилось спасибо большой сергей сейчас вас проводит вас и вас в дискуссионную зону где вы сможете продолжить общение и напоминаем листов кофе-брейки спасибо всем спасибо"
}