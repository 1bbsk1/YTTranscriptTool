{
  "video_id": "61MfTjNFrV8",
  "channel": "DevOops_conf",
  "title": "Дмитрий Стародубцев, Ольга Кузьмичева — Практическое применение dev-контейнеров",
  "views": 348,
  "duration": 1762,
  "published": "2024-10-11T03:51:49-07:00",
  "text": "Всем привет Сегодня мы про поговорим про дев-контейнеры про их концепцию и практическое применение мы расскажем о том о нашем проекте о методах разработки которые мы использовали на нашем проекте С какими проблемами мы столкнулись и в общем-то о решении которое помогло нам решить эти проблемы доклад займет примерно минут 40 и в конце будет ссылка на Исходный код который мы использовали в данном докладе для начала Давайте представимся Меня зовут Дима это Оля и мы разработчики носи плюс и Казалось бы вроде конца что мы здесь забыли но так получилось что нашей работе Мы использовали инструменты которые относятся и мы как разработчики хотели с вами поделиться и и теперь Оля расскажи пожалуйста про наш проект Да мы с Димой осенью прошлого года занимались проектом тесно связаны с mbated разработкой конкретно мы разрабатывали библиотеку на платформе x86 под платформу arm7 и делали мы это на плюсах кстати интересная среди аудитории много разработчиков на плюсах Давайте похлопаем Ну ничего так плохо тем не менее мы сегодня расскажем про технологию которая не связана со стеком соответственно пригодится при разработке на любых языках и эта технология сильно упростила нам процесс разработки и собственно чем мы занимались у нас был проект написав мы использовали для сборки использовались и разрабатывали на платформе x86 под платформу arm7 и это было основной всё нашего проекта потому что нам приходилось думать как же это оптимально сделать И что вообще делать когда ты разрабатываешь разрабатываешь на одной платформе под другую чтобы в этом разобраться мы сейчас поговорим о том с чего мы начали Какие какие подводные камни мы встретили и к чему В итоге пришли в общем-то начинали Мы все с установки на локальную машину и это порождало много проблем во-первых Это человеческий фактор можно было ошибиться с версией нужных лучей на библиотека тому подобное также могли возникать конфликты между ними и собственно сложно было воспроизводить это на других компах участников команды и было очень В общем сложно с этим работать и к тому же поскольку мы разрабатывали под армию у нас были свои особенности свои проблемы или Расскажи про них пожалуйста Да большинство В нашей команде использовали для разработки Windows и чтобы разрабатывать на Windows под аром нужно установить большое количество всяких инструментов таких как сегвейн эмсис все это должно быть определенных версий состыковаться между собой Нужно настраивать кросс компиляцию В общем это очень сложно и мы решили что делать это на компьютере каждого из наших разработчиков это не вариант мы так совсем с ума сойдём и подумали Как же это можно автоматизировать и мы вспомнили про виртуальную машину и виртуалки как всегда разработки в целом позволили нам изолироваться и к тому же Появилась возможность делиться средой разработки то есть мы устанавливаем на виртуалку экспортируем этот Файлик и можем делиться им но этот Файлик довольно таки громоздкий и передавать его не совсем удобно и в общем-то мы отошли от того чтобы использовать виртуалки как среду разработки но мы ее использовали немного по-другому Мы решили использовать чисто как инструмент чтобы проверять что наши бинарник правильно работает что мы делали мы брали виртуальную машину и все это через матрешку мы протаскивали как бы наш бинарник смотрели что все правильно работает Но это все равно как бы не самая оптимальный способ потому что это все делается долго этим неудобно делиться и в принципе есть более современные методы автоматизации и срёт разработки и мы начали думать как же можно использовать нашим проекте докер и докер в качестве среды разработки помогает также как и виртуалки изолироваться тому же им проще делиться чем виртуалками то есть мы можем использовать лишь докер файл или docker registry его на мой взгляд легче настраивать и ресурсы потребления поменьше чем у виртуала и вот мы начали думать А как мы можем использовать докер как среду разработки и мы вспомнили о такой штуки как билдсервер может быть некоторые знают об этом Оля Расскажи пожалуйста по сути обычная физическая Машина на которой есть все необходимые зависимости для билда проекта разработчики подключаются к этой машине через ssh ну и работают и для того чтобы все это работало нужно иметь две вещи во-первых Билл сервер должен иметь хорошую мощность чтобы Билл проходил быстро и возможно была возможность нескольким разработчикам подключаться и также необходимо иметь хороший интернет-соединение например чтобы артефакты передавались без каких-либо ошибок и Для нас это было критично потому что нашим проекте мы много обменивались артефактами нам нужно было чтобы все работало без каких-либо перебоев и в принципе не очень-то хотелось потерять под это отдельную машину поэтому мы придумали такую штуку как локальный белый сервер и сделали мы это все лайн то есть что это такое Это обычный доктор контейнер в котором устроены все зависимости для проекта и общается он с локальной системой через и по идее это должна была бы работать и как бы решить наши проблемы Но не тут-то было потому что в села не есть такая штука Как арсинок это инструмент синхронизации данных и на нашем опыте это работало Не очень хорошими потому что он часто портил наш артефакты мог какой-то байтик вырезать и мы не сразу понимали в чем проблема Мы начинали искать ошибку в коде думать что мы не так сделали но зачастую виноват был именно Синг и в какой-то момент нас это так достало что мы решили искать что же можно кроме этого использовать для разработки Казалось бы мы могли просто примаунтить папку к нашему контейнеру и не знает но мы тогда об этом не подумали Ну и в общем-то хорошо да хорошо что мы об этом не подумали Потому что так мы открыли для себя такую технологию как контейнер вижу студия кот это расширение которое позволяет использовать контейнеры и полноценной среды разработки тут Важно Уточнить что дев-контейнера это обычный доктор контейнеры настроены под разработку и плюс некоторые фичи от среды разработки Дима расскажи пожалуйста Подробнее Как устроена в контейнера в общем-то архитектура контейнеров проста У нас есть сам контейнер и локальная часть контейнеры у нас крутится весь код сервер который может в работу с файловой системой запускать терминальные операции запускать наши приложения даже дебаг и к тому же у него есть доступ к исходному коду через расширенную папку вес код на локальной машине отправляет команды в контейнер он это выполняет по расширенному порту вот также у нас на нашей локальной машине есть расширение для юаня темы различные тому подобное и в контейнере У нас есть расширение для работы с внутри контейнера То есть это могут быть расширения для языка для семей к этому и самое что примечательное мы этими расширениями можем делиться вместе с нашим контейнером Вот и в общем-то это вся архитектура Да в контейнера и вы наверное сейчас могли подумать Неужели Нам сейчас просто рассказывают про решение про расширение Visual Studio Code и вы правы но не совсем потому что контейнеры Это скорее концепция которая сейчас поддерживается многими средами разработки такими как Стилла Я не вижу студии Visual Studio Code и так далее и в разных средах разработки это называется немножечко по-разному например Visual Studio Code это называется есть Похоже штука есть это по сути облачная имплантация Да в контейнеров и жил Студио код также есть силами в котором это называется докер тучин и сейчас активно идет Разработка и на слайде мы раздели все эти контейнеры на 2 столбика в левом столбике у нас контейнеры которые основаны на единой спецификации по сути они работают одинаково и Именно поэтому мы решили сегодня вам более подробно рассказать про контейнеры Visual Studio Code потому что как минимум их поддерживать тоже две среды разработки и которая сказала Они основаны на спецификации она открыта Сейчас активно развивается и она описывает такой Файлик как здесь мы указываем базовый образ докер файл на котором основан в контейнер также устанавливаем необходимое расширение которое потом подтянутся в контейнер но также мы можем опрокидывать порты настраивать дополнительные фичи Я думаю сейчас можно посмотреть как же настраивать себя в контейнеры в общем не выстраивается достаточно просто и мы это показываем ради того чтобы показать насколько это удобно просто настраивается в общем нам нужно установить расширение В контейнер из магазина расширений и расхода называется в контейнер с выпущена Microsoft после того как мы устанавливаем это расширение у нас появляется возможность запускать проект контейнере И для этого есть и конфигурации можно запускать из docker файлы существующего в проекте можно запускать из открытых образов или же можно подтягиваться с гитхаба после того как мы выбираем необходимую нам конфигурацию нас начинает билдеться наш контейнер и после того как он сбился у нас левом нижнем углу появляется то что мы запустили в контейнере еще мы можем работать мы можем его использовать сейчас мы настроили Как мы можем его использовать для того чтобы это протестировать давайте сделаем приложение которое по сути эмули той ситуации с которой мы с Димой столкнулись то есть мы будем разрабатывать на одной платформе под другую в данном случае на x86 под Arch 64 и для начала настроим доктор файлы здесь мы просто указываем базовый образ устанавливаем необходимые зависимости и скачиваем кросс компилятор далее настраиваемых ты такой инструмент для сборки проекта здесь мы просто указываем необходимые настройки для кросс компиляции Ну или коем наше приложение и на этом шаге у нас все готово чтобы запустить приложение осталось только скачать расширение в нашем случае этой суммы и это все указываем файлики в контейнеры сон о котором я раньше говорила И при запуске контейнера студию кот должен потянуть все эти настройки и запустить нужные нам расширение в случае если мы не хотим их указывать как бы ничего страшного и жил студия код может просканировать проект и сам предложить нам расширение которое нужно установить и эти расширения как раз таки потянутся в этот Файлик И точно также всем этим будет удобно использовать удобно Ну и можем сейчас показать на демонстрации как же все это работает мы сделали небольшое приложение буквально Hello world запустим В контейнер нажмем на Зеленую кнопочку откроем все это в контейнере и сейчас правой части экрана можно будет заметить что у нас должен подняться вот он контейнер автоматически то есть мы руками здесь ничего не трогали и это лучше очень удобно в плане того что нам вообще не нужно за ним следить можно просто Открыть приложение доктор десктоп как бы на фоне И забыть что оно существует потому что он сам же автоматически закроется когда мы закроем тебя в контейнер Давайте на этом шаге просто перейдем к приложению на сухие код Просит выбрать компилятор выберем для кросс компиляции и строится сборка приложения и вот оно началось И также быстро закончилось проверим что у нас стоят нужные расширения Да это собственно те расширения которые мы хотели устанавливать в том что сейчас мы его промотаем я не на ту кнопочку нажала В общем ладно суть в том что мы можем теперь сбилдит наше приложение под ARM и запустить его на x86 это просто происходит потому что докер подтягивает эмулятор и нам не нужно ничего настраивать как мы это делали до этого при локальной разработке у нас это все само поднимается и мы можем разрабатывать и тестировать на отличный от хостовой платформы тот факт что у нас автоматически притягивается моя очень круто в плане того что нам можно забыть про виртуальные машины теперь наше приложение может запускаться по сути просто строчкой в терминале это мега удобно и нам это настолько понравилось что мы решили в контейнеры на всю нашу команду и изначально нас было не очень много всего три человека нам все равно было сложно нужно было настраивать многие зависимости мы с этим мучились и когда появились в контейнеры нашей жизни гораздо упростилась и наверное еще более она упростила для людей которые пришли в нашу команду потом потому что для них все по сути было как на золотом блюдечке То есть вам ничего не надо настраивать просто запускать В контейнер разрабатываете команда соседняя команды они разрабатывали на питоне они тоже потянули д- в контейнеры к себе и спокойно пользовались радовались Да это хорошо они у нас подсмотрели Мы не против давайте теперь Чуть более подробно поговорим о том как изменилась наша жизнь и первое в чем нам помогли в контейнеры это стандартах то есть мы теперь можем писать стандартизированный код читаемый код потому что у нас Появилась возможность настраивать linking вообще тулинг для всех разработчиков и к тому же мы можем настроить например какие-то статические анализаторы что может повысить безопасность кода и это очень круто также Dev контейнеры помогли нам при парном программировании потому что у нас появилась общее окружение для всей команды и Например если мы не сидим где-то рядом не программируем парную А например из дома то мы можем это спокойно делать потому что у нас общая среда разработки и мы разрабатываем через коммиты но парно при этом не будем париться что у нас что-то может пойти не так что-то сломается тому подобное соответственно у нас происходит более эффективная разработка это очень пригодилось потому что мы много разрабатывали в паре изначально я присоединилась проект чуть позже и мне нужно было проводить он бординг и Какой самый простой способ провести он бортинг конечно парное программирование вот мы сидели за одним компьютером передавали друг другу клавиатуру это работало когда появились в контейнеры Появилась возможность каждому пользоваться своим компьютером а также работать удаленно нам просто так более удобно сделать и в контейнеры нам в этом помогли Да ну и дай в контейнеры нам еще помогли в том что мы можем теперь запускать локальные интеграционные тестирование и юниты тестирование Да это мы могли делать и до этого но теперь у нас появилась уверенность что у нас Pay плайнах и на у нас локально будет запускаться одинаково соответственно мы можем это предварительно проверять локально соответственно быстрее отлавливать баги быстрее тарифачить и это очень удобно Ну и помимо этого в контейнеры помогли нам при запуске скриптов потому что мы можем настроить теперь общую среду для запуска скриптов для всех разработчиков например поставить GQ поставить и использовать это скриптах это очень удобно Вообще мне кажется весовых проектах часто такое происходит что все делается через крипты То есть у нас скриптал была сборка проекта тестирование запуск многих толчей нас и очень удобно было то что в контейнеры собрали в себе все необходимые зависимости для запуска скриптов и Просто упростила прости нам разработку Да ну и в чем еще польза dv контейнеров помимо того что мы сейчас перечислили это удобная мультиплатформенная разработка это то о чем мы говорили что мы можем теперь разрабатывать на одной платформе под другую платформу и нам не нужно париться с установкой различных эмуляторов и тому подобное помимо этого у нас есть возможность использовать контейнеры вся сиди Давайте посмотрим Ну и разберемся вообще для чего это нужно то есть мы устанавливаем Все инструменты внутрь контейнера и соответственно Какие минусы из этого может возникнуть То есть у нас растет размер нашего образа К тому же этот образ будет больше И как уже сегодня говорили на докладах не хороший подход загружать много зависимости в контейнер Потому что это не совсем безопасно и то есть это тоже минус Но несмотря на это у нас появляется такие достоинства как полное воспроизводимость то есть мы теперь имеем общую среду для локальной и вся сиди и тому же мне удобнее поддерживать один контейнер нежели два Ну и как же мы можем использовать это да просто пушим наш докер образды в контейнера в наши registry и потом в пайплайнах это подтягиваем и чем нам это помогло то есть мы теперь можем phyung собирать наше приложение под различные платформы там же запускать тесты для различных платформ и самое что главное мы можем делать это локально и у нас будет все одинаково происходить и мы не будем париться что у нас что-то может сломаться в Pay планах или локальной это очень круто Ну и Давайте вспомним Про некоторые фичи гитхаба или Расскажи пожалуйста в контейнерах есть довольно глубокая интеграция с гитхабом Например можно зайти на репозиторию в котором настроены в контейнеры просто скопировать ссылку и вставить Visual Studio Code что произойдет наш репозиторий склонируется В контейнер и это очень удобно в плане того что оно не копируется локально То есть у нас на компьютере ничего не забивается и это удобно при работе когда человеку не Нужно настраивать локально все окружение можно просто быстренько потянуть контейнеры поработать и закрыть контейнер похоже штука есть И на самом это по сути это облачная имплантация в контейнеров Мы точно также заходим на проект котором настроен в контейнеры нажимаем на кнопочку открыть контейнеры начинают биться и у нас открывается облачная версия нашего проекта та и это удобно в плане того что здесь нам нужно вообще ничего иметь на компьютере для запуска этого по сути просто браузер и доступ в Интернет и Наверное это это более лайтовая версия чем предыдущий вариант И это будет более удобно людям например который просто хотят потыкаться в проекте который не знает как что настраивать Вот мне кажется это прикольная фича хоть может быть и разработка в Облаке это может быть не всегда удобно потому что это может медленнее работать особенно на бесплатных версиях которые предоставляет Ну все равно прикольная фича про который стоит знать и до этого мы сейчас говорили в контейнерах чисто в скобки вижу Studio Code Но это поддерживается другими средами разработки да Давайте вспомним про Visual Studio для того чтобы разрабатывать контейнеров Visual Studio конкретно для нашего проекта нужно вот это расширение после этого нам нужно проверить настройках что у нас хостовая машина для запуска для наших контейнеров стоит локальные машины и в общем-то После этого у нас среда настроена и если у нас проекте содержится наш контейнер про который мы говорили выше студия сама поймет что она может открыть этот проект в контейнере и предложит нам такую возможность После этого у нас начнет долгийца контейнер и после того как он сбил лица мы можем проверить выпадающем списке что мы можем запускаться в контейнеры это все и все лайне это делается немного сложнее потому что опять же это не Dev контейнер из общей спецификации про которую мы сегодня в основном говорим это отдельная тема для того чтобы нам работать контейнер все лайне Нам необходимо изначально сбилдить наш образ После этого мы настраиваем блокчейн там есть такой докерчей вот мы выбираем наш бил жены образ после этого нам нужно просто проверить что smake будет подтягивать и все мы можем работать в силами с помощью Def контейнеров важно отметить что все лайне эта штука поддерживается с версии 20223 и только в платных версиях Ну и Давайте немножко сравним наш Касты локальный бил сервер и D в контейнер и наверное перед этим стоит отметить Почему мы хотим сейчас сравнивать Это в нашем понимании локальный Билд Сервер это некая базовая имплементация в контейнеры то есть по сути это базовые фишки в контейнеры Да и кстати почему мы вообще решили использовать вот этот наш Костыль если мы там чуть раньше показали что есть официальные точи этот лучин от села и на который также нам позволяет работать в контейнерами Ну в общем-то потому что на то время мы обнаружили что этот очень доступен только в платной версии она мне очень хотелось все это оплачивать и мы решили сделать свой посты которые по сути работает также а если бы мы не забыли про под научную папку было бы все хорошо Ну и вот как Оля говорила локальный бил сервер сложнее настраивать они того что нам нужно прокидывать там США и прочие настройки напротив контейнеры делают это все автоматически нам не нужно париться Вообще ни о чем ими проще делиться те же фишки хабом и прочее и синхронизация расширение что тоже довольно таки круто и тому же стоит отметить что ты в контейнеры как концепция сейчас сильно развиваются и возможно в будущем будет больше крутых фич и больше с ряд разработки будет это поддерживать Ну и куда же без циферок мы провели небольшое сравнение мы билделе не совсем наш стандартный проект который представлен в репозитории но там в одной из веток есть мы туда накидали библиотек для большей сложности проверяли Билд этого приложения и в общем-то можем заметить что в целом время билда на локальном билдсервере и D в контейнере плюс-минус одинаковая Но вот на Windows это работает намного дольше мы так и не разобрались почему это происходит Возможно у вас есть какие-то соображения по этому поводу будем рады услышать это в дискуссии Ну и что же подведем небольшие итоги чем нам помогли дев-контейнеры так это тем что мы теперь можем производить изолированную разработку причем мы эту мы можем делиться настроенной средой разработки с нашими коллегами и не возникнет никаких проблем конфликтов и тому подобное у нас будет общие сектора разработки с которыми можем спокойно разрабатывать к тому же у нас есть такие фичи как синхронизации хабом синхронизация расширение вес код и к тому же что для нас стало Киллер фичей это то что докер подтягивает эмулятор нативно И теперь мы можем разрабатывать на одной платформе под другую платформу это очень удобно Для нас Ну сейчас наверное хочется сказать что дев-контейнеры активно развиваются и их Будущее зависит от Вас например Недавно я заходила на какой-то форум и увидела как какой-то разработчик спрашивает создатели среды разработки Планируется ли имплементация в контейнеров разработчики разработчики отвечают что да интересная идея подумаем над этим уже начало Я считаю что это очень круто что многие среды разработки начинают это подтягивать и я думаю что это технология стоит пользоваться она удобная позволяет намного намного сильнее выстроить разработку и это просто крутая фича которая очень нам помогла в общем-то на этом наш доклад окончен если у вас остались какие-то вопросы Можете писать на почту Или же проходить дискуссионную зону также здесь ссылочка репозиторий в котором есть например то приложение с помощью которого мы меряли сколько быстро и медленно работает в контейнера на разных платформах можете попробовать себя если это интересно Вот Всем спасибо за внимание Если есть какие-то вопросы Мы можем ответить У нас еще есть время Ну вроде Вопросов нет наверное тогда можем заканчивать Всем спасибо Проходите пожалуйста в дискуссионную зону"
}