{
  "video_id": "4YP7n_RU404",
  "channel": "DevOops_conf",
  "title": "Александр Лукьянченко — Скрывая Kubernetes: подходы к конфигурированию",
  "views": 397,
  "duration": 2766,
  "published": "2024-09-06T01:35:23-07:00",
  "text": "Всем привет Спасибо что пришли к нам значит меня зовут Илья Я работаю в Avito и в моей команде лежит наш инструмент про опенсорсный аналог которого сегодня будет рассказывать Саша наш докладчик Саша лукьянченко Всем привет Да Саша руководитель паса варито Вот и расскажет нам сегодня про то как абстрагировать инфраструктуру губернатос От продуктовых разработчиков Саша мы же начали внедрять все эти подходы Когда у нас было в общем-то не так много сервисов не так много команд там несколько десятков команд и сервисов И сейчас мы масштабировались до 2000 плюс сервисов и несколько сотен команд Вот и вообще вот правильно ли это был путь посмотрим весь этот путь какие бенефиты мы получи от него но в целом да то есть есть как раз особенность и в этой Вот зоне конфигурирования который пришлось который пришлось столкнуться и решить именно с точки зрения масштабирования разработки команды вообще взрывного роста Avito это поговорим все спасибо тогда передаю тебе слово талия Спасибо Давайте начинать Меня зовут Александр сказал я руковожу разработкой пасы Лолита И на самом деле одно из таких ключевых парадигм нашей платформы является то что мы стараемся предоставлять наши сервисы нашу платформу такое решение которым не нужно погружаться глубоко инфраструктуру какие-то низкоуровневые вещи а можно решать все скажем так через высокоуровневый интерфейсы готовы оболочки кубики и так далее Вот и сегодня мы как раз поговорим про один из важнейших этапов жизненного цикла разработки это конфигурирование При этом когда конфигурирование будет не бизнесовая а скажем так вот стыка бизнес сервисов инфраструктурой естественно во многом преломлении из губернатисом как Одна из таких ключевых технологий которые мы используем Production для регистрации всеми нашими сервисами и в том числе также стоит пол частями Давайте пробежимся по плану как мы сегодня будем идти Сначала мы посмотрим как раз уровень сервиса чтобы затем приложить это на наш путь эволюции в конфигурирование затем пройдемся по трем ключевым шагам которые мы прошли в рамках развития платформы под конфигурирования и остановимся Как раз на том подходе который последние годы использую при этом Будем рассматривать Open Source решения того подхода который мы используем в Avito То есть то что можно взять переиспользовать у себя посмотреть какие там есть особенности механики и в конце подведем Там небольшие итоги начну с платформы уровня сервиса здесь если рассматривать такой стандартный подход методологию то она говорит о том что продуктовые команды они становятся полностью самой то есть они им не нужно какая-то там инфраструктурная команда платформенная полностью владеет всем жизненным циклом разработки начиная там от создания сервиса до релизного цикла эксплуатации и так далее Вот и при этом с точки зрения взаимодействия с инфраструктурой обычно в компаниях это строится Так что мы выделяем некоторую централизованную команду которая полностью владеет какими-то вот инструментами туллингом и так далее например кубернатисом еще огромный там экосистемы и поставляет ее продуктовые команды как такое менеджмент решение то есть не нужно его администрировать оно стабильно работает масштабируется и так далее вот при этом с точки зрения интерфейса продуктовые команды получают все равно довольно низкоуровневый интерфейс то есть они должны разбираться там в том какие сущности каким-то образом описывать манифест и так далее То есть такое взаимодействие все равно на уровне инфраструктурных компонентов вот при этом здесь есть естественно большой плюс в том что команда Независимо она никого не блокируется с точки зрения инфры но в то же время есть минус что нужно обладать довольно сильными навыками Да и в каждой команда должна ими обладать это либо какой-то инженер конкретный выделенный который обладает всеми навыками либо это оснащение там каждого члена команды каждого инженера вот естественно это положительно не влияет на тем ту Маркет на этом инциденты и так далее Вот и тут на самом деле есть не конфликтующий подход это по сути тот же devops который нам полностью автоматизирует и делает независимым всю разработку в рамках продуктовой команды но поднимает нас на уровень чуть выше говорит нам о том что да давайте мы платформу будем делать не как набор каких-то сервисов типа губернатиз и подобным подобных Как такую платформу которая предоставляет высокоуровневый интерфейсы там сила и голографический интерфейс только тех возможностей которые понятны в конечном заказчиком продуктовом и которые могут просто взять этим пользоваться без необходимости каких-то там иметь какие-то глубокие познания Вот и тут мы как раз переходим к эволюции конфигурирования которая будет нам показывать А как мы переходили из стейта вот этого первого до таких голых инфраструктурных инструментов в сторону автоматизации платформы Вот и первый этап он естественно был такой же то есть мы в 2016 году начали эксплуатировать продакшник губернации части уже заехали туда и полноценно обслуживали нагрузку при этом разработчики погружались тогда это было супер интересно все изучали какие-то сущности Как настраивать этот инструмент и поставляли сервисы в куб с помощью по сути описываю вот такие вот сырые кубернатис манифест естественно это все было можно сказать таком подходит то есть складывалась там по определенным директориям по сервисам автоматически там являлась в cuberatis кластер поддерживалась консистентность Но все равно это была работа непосредственно сырыми манифестами вот здесь есть набор на самом деле проблем которые мы сейчас быстро пробежим они довольно очевидные что первое это высокий порог входа то есть разработчикам нужно было знать полностью как работают там все примитивы Куба что они за собой влекут с точки зрения работы затем это правки которые там делались они естественно порождали ошибки инцидентов продакшены были практически постоянно потому что что-то там не учли даже staging среде это проверили Вроде это немного другая конфигурация оно разлетается вот сложность конфигурирования Здесь целый набор вещей связанных с тем что это были просто plain манифесты это сложно управлять потому что нет какой-то коробочки которые объединяет там сервисы диплоид инверсы и так далее нужно было учитывать окружение естественно когда у нас нет какой-то шаблонизации там нет возможности легко У меня есть количество реплик какие-то переменные окружения и так далее Вот и вещи типа мультикластер Рико это там гибридной инфраструктура естественно тоже прождали проблемы потому что нужно было копировать крестики раскладывать какие именно кластера нужно выкатывать и так далее Вот и обновление cuber Nights на самом деле было тоже болью потому что API версии обновляются они остаются старыми в этом манифестах репозиториях нужно это все еще мигрировать там новые кластера и так далее Это все было больна очевидный инструмент который нам тогда очень помог где-то в семнадцатом году Это был который я думаю многие из присутствующих используют и сегодня инструмент который включает себя и все возможности для релиза для диплои объединение манифестов некоторые чарт коробочку которой можно удобно управлять это все вот при этом здесь часть Теперь остается с этим можно наверное поспорить но тем не менее то что мы видели в реальной жизни это все еще высокий порог входа даже когда у нас был готовый там чарт который можно было просто скопировать потянуть к себе настроить какие-то выйдут там параметры все равно нужно было понимать как это работает под капотом потому что как только что ты шло не так что-то там уже на стыке с релизном цикле ломалась нужно было лезть разбираться это либо Саппорт который сваливался на платформенную команду Вот либо это разработчик самостоятельно потратить там день на то чтобы разобраться что же пошло не так вот второй момент правки порождает ошибки инциденты тоже оставалось у нас была даже история такая что вот любого нового микросервиса который нужно подключить постгры поздно основная Революционная база данных компании нужно было там зависимости от навыков разработчика двух до пяти дней чтобы это все настроить и обычно это там как минимум один какой-то инциден потому что что-нибудь неправильно там прокинут какие-то секреты World и по тем параметрам там погибаум серкан фиг настроен что-то там скопировано неверно Хотя это простые шаги Да воспроизводимые ну и так далее общем какие-то проблемы оставались Несмотря на то что были там чарты возможность подключения каких-то там контейнеров и прочего просто какими-то дополнительными директивами вот при этом сложно сконфигурирования здесь подавляющее большинство вещей решилось проблемы ушли осталось только история с обновлением Куба Вот Но об этом чуть позже как мы тоже порешали расскажу На следующем этапе Вот и на самом деле здесь мы остановились и поняли что дальше масштабироваться сложно потому что продуктовые команды нужно во-первых насыщать экспертизой во-вторых с точки зрения саппорта которая скидывается платформенную команду было огромное количество с этим было сложно жить вот и подумали что же мы хотим изменить что мы хотим видеть в новом подходе первый момент это поняли что мы хотим упростить максимально работа с cubernights сделать так чтобы разработчик по-хорошему не должен был вообще владеть какой-либо информацией навыками Как работать с этой системой второй момент это все еще да это как бы идет в некотором конфликте с первым пунктом но все еще дать все возможности необходимые разработчики чтобы она как бы не сжимала в какие-то рамки жесткие И третье это что это должно быть солсервис механика то есть не должно быть такого что все еще требуется какое-то большой объем саппорта какой-то там масштабирование платформенной команды пропорциональные продуктовый она должна расти значимо медленнее Вот и здесь мы пришли к третьему этапу нас это называется томл возможно кто-то уже слышал про наш подход рассказывали о нем Это по сути такое примитивный файл который содержит только такие движимые части сервиса то есть мы закрываем здесь все что находится под капотом с точки зрения инфраструктуры и по сути начинаем говорить на языке с разработчиком То есть если у тебя сервис например написан на гошке надо просто говоришь о том что у меня сервис на гошке версия такая там и мне нужно в продакшне 70 реплик все больше принципе мне знать что ты еще дополнительно не нужно Да потому что из-за этого всего рождается уже вот эти тысячи строк яблок который применяются в интернете Вот естественно Здесь тоже есть довольно развесить ты в конечном счёте язык но он значительно меньше тех возможностей которые есть непосредственно в кубе и в рядом лежащих сервисов экосистеме Да и по сути он фокусирует человека чисто на написании каких-то вещей которые специфичны его бизнес сервис вот под капотом это работает примерно так то есть у нас есть там если упрощать схему некоторые Там вся система которая подтягивает это тому файл момент релиза и что важно появляется компонент под названием манифест генератор который прямо в Реал тайме умеет обрабатывать нагрузку с этими оптовыми то есть ему закидывается этот файл и он его процессе и выкидывает готовые там Ямал манифест который уже диплоир со стороны себя применяет в губернатис кластер набор из кластеров и так далее вот при этом непосредственно с манифестами сущностями все что необходимо там для сервиса разработчик не работает вот и по сути этот подход он имеет плюсы и минусы естественно как причем довольно весомые истории с другой стороны плюсы здесь очевидно это порог входа минимальный потому что здесь разработчику не нужно погружаться в какую какие-то детали но он просто описывает какие-то понятные для себя такие базовые параметры которые важны для его сервиса второй момент это инциденты это реальная статистика мы ведем довольно серьезно все статистику постмортам У нас есть процесс статистика где у нас по группам разбито какие у нас руткозы возникновение причин деградации после внедрения этого подхода инцидентов именно связанных с конфигурацией ну их практически не стало да то есть просто потому что ну скажем так они перешли на другой уровень то есть теперь вот эти вот конфигурации она возможно только в этом центральном компоненте манифест генератора который разрабатывает платформа Вот и есть еще как бы такой бенефит он на самом деле довольно крутой что вы за единой точки можете любые изменения которые вам нужны на всю систему То есть вы сделали какое-то там например добавление переменное окружение или добавили какой-то там новый манифест там от истила до который появился вам нужно его там до конфигурировать сразу на всех все вы это сделали мне сейчас генераторы он соответственно со временем раскатится либо можете про форсить и обновить сразу же все сервисы вот есть очевидно минусы они довольно жирные Да но не перевешивают плюсы первый момент довольно критично компонент манифест генераторов Я уже сказал если там есть ошибка да то есть какая-то например поломка которая приведет не просто там не к прохождению ради нас пробы в момент релиза А например к тому что вообще в целом трафик не будет поступать на сервис то это будет масштабная деградация но не на один сервис Да она вот большое число тех которые выкатываются нас рейд релизов там где-то под тысячу релизов в день и соответственно при какой-то если значимые проблемы которые там которые там можно заложить случайно это будет иметь довольно большой iPad Вот и второе большой минус это тестирование тестировать эту штуку не так просто потому что вариативность и количество там на вход параметров которые подаются но по сути конфигурационный файл optomal Она довольно большое И в итоге мы здесь пришли к тому что мы Тестируем эту снапшот тестами которые по сути запекают готовые решения по входящим а потом Плюс некоторые там сценарии которые просто точечно проверяют конкретные там башке с которой вам нужно можете полностью про тепло и посмотреть как это будет в реальности в cuber на эти конечном счете При этом при этом это как бы речь про наш кастом до который мы разрабатывали самом деле это уже там больше пяти лет этот подход нам он очень нравится и долгое время на самом деле если посмотреть там Россия в Китае этих решения подобные альтернативы не было Вот но так давно довольно популярным начинает становиться такой подход под названием Open Application Model Я как раз сейчас про него буду более подробно рассказывать это по сути спецификация поддерживает ее во многом компании там сейчас вливает ресурсы Да в этот проект это Alibaba и Microsoft что он из себя представляет по сути это вот тот же подход который я сейчас рассказывал про тонул только скажем так генерализированном виде который можно брать и использовать в своей системе что на себя представляет у вас для разработчиков появляется более высокоуровневый такой манифеста Application который по сути представляет из себя альтернативу того самого Где вы как платформенный инженеры определяете какие именно параметры Что именно нужно отдать пользователю для того чтобы он мог сконфигурировать кейшн да И при этом вы явным образом определяете что именно Нужно настраивать пользователя что не нужно и как это должно выглядеть как мы видим это из себя представляет по сути такое кастомный ресурс кубовый который разработчик описывает и дальше там также через вся это может применяться в кластер где уже система которая работает с этим манифестом будет его каким-то образом обрабатывать и релизить вот Давайте сначала про вам полностью поймем что это такое по сути как я уже сказал это спецификация То есть это не конкретная реализация она в себя включает по сути формирование вот этого высокоуровневого интерфейса Application который как раз в итоге в конечном счете пользователи предоставляется если говорить про жизнь цикл разработки по сути он покрывает момент начиная от конфигурирования инфраструктурного бизнес сервиса то мотоцикла то есть до выгодки этот весь кусочек времени она полностью специфицирует как его именно отстроить и при этом так это спецификация она не предполагает какое-то конкретной реализации то есть нет такого что вам нужно взять обязательно там не знаю какой-нибудь Арго ролаут какой-нибудь шаблонизатор конкретный и так далее Все это заменяемо по сути она просто рассказывает какие там этапы жизненного цикла Какие манифест и каком виде готовить вот есть реализация популярная по сути я делаю те же самые ребята которые пишут испеку называется накидвела что и в ней есть Ну скажем так интересного и хорошего На мой взгляд то что я выделяю с учетом того опыта который мы прошли То есть то что мы например сделали изначально не очень хорошо В нашей системе здесь первый важный момент что кимвела она явно разделяет роли и говорит что у нас есть роли платформенных инженеров есть индюзеры это те кто собственно вот разработчик который уже используют эту систему платформу Конечно вот это на самом деле хорошо позволяет сегрегировать где именно зона ответственности проходит и кто Чем занимается сейчас позже подробнее Это посмотрим следующий момент гибкость в целом платформа построить довольно сложно в таком подходе потому что вы используете конкретные скорее всего инструменты какой-нибудь там какие-то конкретные Там диплоид и так далее сделать так чтобы Вы могли например взять изменить легко это компонент обычно сложно вот здесь по умолчанию это поддерживает и позволяет нам любой инструмент использовать плюс с точки зрения пользователей опять же предоставляет готовые простые инструменты там даже борт села для того чтобы с этим можно было удобно работать теперь про концепт здесь вот слева такой расположен манифест не нужно в него всматриваться Да там довольно мелко нам важны сейчас ключевые блоки и моменты что в этом Application У нас есть Первое это компоненты по сути компоненты это то из чего состоит сервис пользователя То есть это там например и 5 часть воркеры базы данных например это может быть позже средиз что-то еще то есть то из чего коробочка то из чего состоит сервис вот здесь то описывается соответственно компоненты они предопределяются платформы вы говорите что у нас платформе есть вот такие компоненты все и пользователь Их используют вместе с этим есть Трейд Трейд это грубо говоря настройки такие настройки которые могут подходить под разные компоненты То есть например количество реплик Это количество реплика но может быть там и у и 5 часть уоркеров либо еще вот они выносятся как Трейд они мутируют по сути конфигурационные файлы та которая состоит создаются компонентами далее есть полисы те же самые трейты только глобальные например вы хотите дать возможность разработчикам явным образом конфигурировать там какие убрать кластера выкатываться какая-то пологие естественно это топология она применима сразу же ко всем компонентам которые описаны в applicational манифесте поэтому это выносится в полюсе с они в Трейд Вот и есть workflow возможность дать такую разработчикам кастомизировать какие-то шаги как именно нужно например диплоид сервис какие-то еще вещи мы вот эту вещь например скрываем мы не даем возможность workflow каким-либо образом модифицировать потому что иначе порождает зоопарк какие-то сайты генерализированный инструмент здесь такая возможность есть теперь про разделение ответственности то что чуть раньше уже затрагивали здесь нас что Ключевое что у нас есть платформенные инженеры которые образом регистрируют вот эти самые кусочки Да там компоненты Трейд и политики и так далее и по сути и как бы applite в систему и говорят Как именно Какими возможностями можно пользоваться время как nusire разработчики они по сути это используют они просто задают Application and в которых они хотят работать и далее применяют свое Application тоже вэллу по сути это обычный манифест Куба который уже с помощью механики вела преобразуется в конкретной конечной сущности там диплом это сервисы и так далее вот при этом подход он явно как бы декларирует что можно из какой из ролей что могут разработчики что могут платформенный инженер вот при этом Давайте посмотрим что это в итоге с собой Влечет под капотом как это устроено чтобы понять что из себя представляет Эта система самом деле первый момент компоненты и Трейд и их естественно нужно задать Как именно делать преобразование есть примитивный пример одного из компонентов Называется он веб-сервер а вы говорите что у нас можно сделать компонент веб-сервер любого сервиса Application Да и он на вход Принимает два параметра например на имя имидж и дальше как мы видим с помощью вот языка Q Это такой язык который позволяет нам делать какие-то мутации шаблонизацию конфигурационных файлов валидацию настраивать на это все вот Ну и по сути формируем здесь одну сущность диплоинд это очень простой пример который показывает нам Каким образом преобразуется параметры уже в конечном манифест естественно вы здесь вот снизу в output можете вставить любое количество манифестов там тысячи строк которые там в том числе имеют какую-то логику с программированием какими-то не знаю условиями циклами и так далее и в конечном счете получить этот весь набор который необходим с вашей спецификой в вашей компании вот При этом если смотреть уже на конкретные сущности то есть что именно чем оперирует здесь важно посмотреть на то какие возможности она предоставляет этого будет Понятно чем чем она уже оперирует под капотом она по сути поддерживает три ключевых направления Первое это мультикластер то есть из коробки Вы можете в рамках одного окружения сервиса диплоить сразу же несколько кластеров при этом Например если у вас в есть некоторое сегрегация какие-то разные бизнесы направления можно сразу же из коробки получить мультисенантную платформу то есть задать какие именно там Application и в какие там зоны тьенанты могут каким-то ценам могут относиться Например у нас там может быть большое Авито и там статья Да это там разные сервисы они соответственно принадлежат разным проектам это все заложено с точки зрения зон нейминга так далее на уровень изначально архитектурно вот плюс workflow их можно довольно гибко настраивать то есть нет какого-то я уже говорил там обязательного использования там холмаргой чего-либо еще каких-то сиаев Сити чего-либо еще это все заменяем вот теперь по поводу этих вот возможностей Первое это мультикластер мульти кластер достигается тем что вы заносите в систему губернации с кластера которая у вас есть таргеты таргеты это по сути просто можете задать перед заготовленные пары кластер Space и как раз уже сущность которая капсулирует собой кластера вы говорите что у нас есть и он под собой содержит эти вот три с кластеры Всё круто это все задали дальше этим можно уже манипулировать с этим работать для мультснатности у нас появляется проекты задаете проекты в рамках них разработчики делают Application Я думаю здесь понятно довольно такой стандартный подход далее разработчики также могут кастомизировать workflow которые есть в рамках Application есть еще специальная сущность piplines на примере Если вы хотите сделать там какой-нибудь тестовый стенд на уровне проекта например несколько applicational диплоить в какой-то контур постоянный здесь определяется pipeline который эти все маркистрирует постоянное условие поддержку что он важно еще сказать есть системы аддонов которые мы сейчас тоже будем пользоваться это по сути такой набор различных предзаготовленных описаний связанных с инфраструктуры Как пример Вы можете там Как аддон поставить сразу себе кластера там примерно с тем мониторинга там скреперы графа Ну что-либо еще такие заготовленные кубики которые можно легко переиспользовать есть общая экосистема этих аддонов которые можно использовать если посмотреть на старт Как именно на взаимодействовать сэллой установка делается через команду веланд стал естественно если мы говорим о продакшена окружении так делать не стоит да стоит сдамбит манифест их там через какое-нибудь Арго сиди за диплоид к себе в кластер Вот Но как для теста можно использовать вот сила утилиту вела далее можно с помощью аддон команды включать аддоны и мы сейчас отключаем аддон в LX это по сути графическая оболочка которая позволяет взаимодействовать если посмотреть на инстансы которые у нас в конечном счете получается то здесь у нас вот после таких манипуляций по сути есть одно монада монолитная один монолитный под это велокор Который реализует всю механику Белла есть вела их Сервер это собственно графической оболочки есть еще компонент кластер гейтплей это по сути такой инстанс который позволяет работать с мультикластером он проксирует в настроенные губернации кластера все там тип Конфи которые подкинули Давайте посмотрим как это выглядит с точки зрения интерфейса мы будем сейчас смотреть это в три этапа а Сначала мы посмотрим как это настраивается со стороны платформенного инженерам роль когда мы из платформы и дальше мы постепенно пройдем до уже непосредственно продуктовых разработчиков Да как они используют это инструмент вот при этом будем это все делать через вот такой вот интерфейс графический который называется кибелы X вот единственно важный момент который сказать начали что все что мы сейчас будем делать через графический интерфейс естественно но все описывается также через манифест Это все можно применять кластер до без накликивания мышкой там этих всех параметров сейчас просто визуализации посмотрим это в графике вот начнем мы с инфраструктурного стыка это грубо говоря то что нужно настроить в интеграции с вашей существующей инфраструктурой register и так далее Вот и после этого уже перейдем к настройке того что необходимо для разработчиков Вот давайте посмотрим небольшое видео по сути вот там переходим в административный интерфейс У нас есть некоторые набор сущностей которые предоставляет им было Вот здесь мы видим кластеры можно задать необходимый набор там кластеров которые у вас уже есть соответственно закидываем конфиге определяем их было будет знать куда именно нужен вот дальше настраиваемый шерсти вероятно у Вас свой приватный redships приходят в системе здесь можно его добавить там параметры авторизации и далее Все Application в рамках проектов будут уже его использовать как основной раджестве при этом есть проекты в целом наверное нечего комментировать это такая красота история про мульт здесь можно докинуть все необходимые проекты и есть система работы с пользователями почему это показываю здесь довольно гибкая такая развесить остались можно явным образом определить какие есть ролики накинуть Что может делать конкретные там человек в системе То есть кто-то может приблизить кто-то не может кто-то там может поменять Добавить новый компонент и так далее Все эти вещи настраиваемые можно поставить сделать авторизацию есть вот значит такие основные возможности по настройке именно стыка с инфраструктур дальше мы переходим к самому интересному на самом деле вот это вот зона она скажем так трудозатратные данные более со стороны платформы здесь нужно платформенным разработчикам хорошо подумать и как раз определить какой именно интерфейс нужно предоставлять пользователю и здесь мы как раз определяем все вот эти вот компоненты трейды и так далее Давайте посмотрим как это делается здесь у нас появляется Вот такая история как extensions и написано здесь мы видим вот эти вот все компоненты полюсе трейты которые можно предопределить для разработчиков например компонент может быть выбрать Там какой-нибудь крон Да и посмотреть какие параметры мы выдаем пользователю настройки справа это можно так графическом интерфейсе видеть Вот вы соответственно здесь можете задать любой набор который считаете нужным для ваших пользователей вот дальше если мы вернемся назад здесь будет там полюсе какие-то трейды например там горизонтальный под авто скейлинг gitway и прочие истории это все Здесь тоже можно конфигурить что можно использовать Вот и для того чтобы дальше создавать applications последняя вещь которая нам остается это настроить окружение чтобы настроить окружение нужно задать таргеты это по сути mapping на губернатик кластера например мы здесь хотим задать продакш Таргет будет в наш локальный кластер по умолчанию который можно затем переопределять по сервисам будет затем Ну и то же самое делаем для того мы их задали мы переходим и настраиваем уже окружение это как раз та самая точка в которой можем сказать что под окружение провод нам на самом деле нужен набор таргетов набор кластеров один центр второй третий вот мы соответственно здесь сделали можем сделать такое же аналогичные манипуляции останавливаться дальше не будем Вот и после того как мы это задали после этого уже по сути конечный пользователь может с этим всем работать манипулировать и по сути не взаимодействовать непосредственно с губернатисом каким образом это выглядит сейчас опять же посмотрим это через графический интерфейс естественно все что мы сейчас будем печатать это по сути вот тот самый Application манифест который мы видели в начале просто мы сейчас его на кликаем из интерфейса таким образом это создание Application работает пользователь заходит и нажимает что он хочет новые Application и соответственно здесь выбирает какое там его название это обязательный параметр и дальше Какой компонент то есть что это за сервис например сервис уже стоит дальше выбирает Какие Продакшен и например мы хотим там это Серви банальный enging завернуть говорим что будет это контейнер и мышь Джинкс какие-то по умолчанию значения там request of памяти CPU и хотим достать наружу это какая-то локальный сетап все это через НОД порт все по сути мы все сделали У нас есть уже готовый сервис для того чтобы его можно было релизить можем видеть здесь сразу же компоненты там полюсе Трейд и все это сразу отображается для нашего сервиса и дальше можем перейти в онлайн например Production и увидеть статус что сервис ни разу не диплоился в пластырь его нет он автоматически определяет нажимаем на релиз одной кнопкой и по сути Велла берет этот компонент который мы описали Из него делают набор сущности cubernations уже которые мы здесь можем видеть вот все у нас все это успешно перейдем на вкладку логов можем видеть там стандартные Джинкс который тут же запустился и готов и еще и на вкладке Flow У нас есть Discovery автоматически он говорит по какому-нибудь переходим видим вот он уже работает при этом мы ни одного манифеста на самом деле руками не писали теперь перейдем влоги посмотрим вот мы через браузер сделали Там два обращения вот Ну и по сути Вот такая система она как бы абстрагирует всю сложность которая у вас там может быть под капотом на уровне Куба Вот это с точки зрения пользователя что важно сказать на Что остается под капотом то что я сейчас не затрагиваю и таки было workflow естественно когда мы сейчас Нажали на кнопочку диплой никакой там инструмент типа холматы и так далее они использовался это просто банальные механика преобразование этого Application config в конфигурационный файл губернатиса который залетели в брюнеттис да и просто были применены он подождал когда они все пришли в Ready State по сути такое примитивный диплоир встроенный валу это сделал вот можно использовать тот же самый Hell Да там есть посмотреть там есть уже предзаготовленные обвязки на компоненты которые будут резать Это все через Hell можно настроить это легко если вы используете какой-то диплоир вида оператора например argoroload мы просто делаете Так что у вас генерирует кастомный ресурс под названием который будет просто применен Выбирать из кластер с помощью кибела А дальше уже оператор который лежит в кубе он его соответственно подхватит и зарядит ваше приложение по той стратегии по тем параметрам которые вам необходим Вот давайте подведем итоги так как именно Что что можем сказать про эту систему какие здесь есть преимущества На мой взгляд самый Ключевое это предоставление понятного и удобного интерфейса пользователям то есть мы сейчас очень так быстро пробежались по всем там шагам на самом деле вот это вот фаза формирования компонентов Да и там трейдов так далее А самое важное вы здесь хорошо подумав какие именно возможности нужны research фруктовых разработчиков закладываете это в платформу и дальше конечная разработчик абсолютно не тратит время на какие-то настройки на дебаг низкоуровневых манифестов просто манипуляции на уровне Application Вот это очень круто это экономит время при этом гибкости расширяемость в таком подходе заложена архитектурно я могу сказать что действительно важно потому что мы Однажды стали сталкиваться с тем что из-за того что используется прямо совсем конкретные технологи не прибитые прямо гвоздями в разные кусках жизненного цикла Просто со временем нужно было что-то апдейтить что-то менять это было сложно вот на уровне архитектуры кивала это учтено это можно все менять любой компонент использовать который Вам нужен вот при этом timed Market время которое тратит пользователи разработчики здесь уменьшается то есть ускоряется и количество инцидентов в конечном счете падает потому что каких-то ручных настроек больше нет хочешь базу данных просто говоришь вот хочу компонент например какой-то скажем так хорошо настроенные заранее с репликацией какими-то гарантиями которые описаны в документации так далее Это все не нужно взаимодействовать из недостатков естественно здесь есть большие жирные вещи о которых Стоит подумать на ранних этапах это первое это вот та самая сложность в поиске баланса между простотой и гибкостью то есть по сути вам нужно решить такую задачу что вот есть огромное количество возможностей которые предоставляет например куб А что именно из этого нужно выделить пользователю да И это не простой вопрос потому что здесь можно пойти Там историю того что вы на любые какие-то фичеры квесты Добавляйте все больше и больше параметров и в итоге это превращается в тот же самый куб смысла нет никакого вот Либо вы даете там три какие-то там настроечки которые можно поменять и в итоге ограничиваете разработчиков им не хватает возможностей люди тоже уходят либо в другую технологию либо Там постоянно терроризирует вас сапорте добавьте там что-нибудь возможность вот и это это не простая вещь которую нужно качественно прорабатывать вот второй момент тестирование я его уже касался в начале это тоже вещь которую нужно продумать заранее к счастью у Q вот этого языка есть довольно неплохое такая система туллинг которая позволяет вам как раз вот эти вот тесты из коробки настроить валидацию сделать что пользователь пишет именно тот манифест который подходит под то определение которое вы сделали вот но тем не менее заботиться нужно потому что появляется новый очень критичный компонент Вот и если говорить конкретно про кипеллу мы не используем мы используем свою реализацию которая была еще до на самом деле появление уама и подобных решений вот Ну я бы сказал что она пока что сыроватая А на уровне того что ее довольно много кто использует в основном это компании из Китая Вот но у нее adoption я такой высокий он не такой зрелых если например сравнивать то есть и В чем выражается сырость это какие-то такие острые углы То есть вы хотите что-то настроить но например ты фичей там пользуюсь не так много людей Да и вам нужно самостоятельно понимать как именно там что-то за конфигурить на уровне платформы аскевеллы Или например вот у меня был кейс что пока я работал с этим графическим интерфейсом аддоном вело X но он там пару раз упал с паникой понимание уровня зрелости этого инструмента но тем не менее у него довольно много уже пользователей он хорошо развивается вот ну и По мере увеличения зрелости Да и времени жизни Я думаю он придет тоже хороший стоит вот сравнивая например с другими инструментами какими-нибудь пробовали примерно такой же стадии я бы сказал что здесь даже получше с точки зрения изначально реализации Вот на этом У меня все Спасибо Саша спасибо У нас есть еще несколько минут мы можем взять Я думаю один или может быть даже два коротких вопроса из зала Есть ли вопросы Я не вижу к сожалению сейчас принесут микрофон Да спасибо Привет Слушай я вот посмотрел то что показывал а это очень сильно напоминает opensi dashboard Ну то есть принципе то что некоторые инструмент позволяет делать если там придется все-таки писать какие-то ямки Ну хотя бы купе сделать вот если я правильно понял вот реализованном сервисе вот явно не нужно писать а остальное Ну в общем-то уже есть в чем цель использования чтобы совсем не писать ямы или вот какие-то еще профиты прям заметные есть это вопрос по сравнению слышал вот он еще богаче а ну смотрите на самом деле Здесь ключевое отличие Да это по сути то что я показывал X Просто некоторые хореографическая оболочка чтобы увидеть как это все пользователи в том числе можно предоставить Вот но как бы Ключевая ценность этого как раз таки в том что вы инкапсулируете манифест да То есть вы делаете так чтобы разработчик получал только тот интерфейс с точки зрения настроек который ему необходим и дальше Вот просмотр какие именно сущности получается там диплом это сервисы ингресса как раз таки разработчикам с этим взаимодействовать вообще не нужно Все что им нужно это типа нажать на кнопочку определить какие-то параметры Да и получить Готовое решение вот Если сравнивать с дешбордом просто визуализация Да это грубо говоря то что сейчас примененов выбирается кластер то что там через Keep Control можно вытянуть другого класса решение я технология Следующий вопрос такая еще очень просто абстракция у вас как реализовано что можно вот такой вариант использовать когда четыре строчки написал сервис получил или всегда Можно ли идти Можно еще раз конец повторить Можно ли Вот самый простой вариант который вначале показали а потом четыре строчки написал сервис получил вот если ему не нужны какие-то дополнительные штуки сложности Да я понял да ну смотрите на самом деле да то есть все что нужно разработчику это по сути вот в случае нашей реализации это об Том некие графические оболочки не нужны да то есть разработчик пишет об Том соответственно он говорит что у меня сервис на гошке и меня там например нужны такие базы данных все Дальше он либо через силовая утилиту говорят я хочу за диплоид сервис либо он нажимает на кнопку dashboard для тех кто любит интерфейс графический Белла то же самое только здесь не об Том а соответственно вот этот манифест покажу Application то же самое соответственно он пишет Вот здесь что я хочу Лепс сервер с типом который понимает что нужно например там какой-то скрыть метрик дополнительно добавить Да это все под капотом зашито на уровне платформы и там например определяет базу данных все это то же самое плавится через какое-то готовый план в губернации и пользователь получает свой сервис в нужном окружении полностью готовом Да там стейджинги в тесте в деве в продакшене все ему ничего не нужно а графическая оболочка Это просто как один из интерфейсов если разработчик не любит графическую оболочку он работает через сила утилиту вообще не заходит браузер прекрасно в своем мире Спасибо Вот и на этом на самом деле времена закончилась если есть еще вопросы встретимся Вот дискуссионной зоне Всем спасибо спасибо"
}