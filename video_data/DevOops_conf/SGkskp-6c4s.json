{
  "video_id": "SGkskp-6c4s",
  "channel": "DevOops_conf",
  "title": "Барух Садогурский — Паттерны и антипаттерны непрерывных обновлений в практике DevOps",
  "views": 2635,
  "duration": 3586,
  "published": "2020-02-07T07:56:11-08:00",
  "text": "у а спасибо антон это было совершенно вот да и то по старому знакомству заставил вас стать я надеюсь что вы проснулись а если нет сейчас я вас еще раз разбужу потому что мы будем показывать сегодня в нашей передаче всякие ужастики потому что мы будем говорить о непрерывных обновлениях и как вы понимаете что же может пойти не так примерно все начнем мы с интересного вопроса который намного менее риторически чем кажется вот зачем вообще что-то обновлять как вы считаете существует в природе вот софт который вот написали и он готов да ну принципе да конечно существует вот вам пример есть такая утилита называется би си би си и значит такое калькулятор калькулятор да вот его написали там в 91 на самом деле его написали очень давно назывался ди ди си диск калькулятор это было чуть ли не первая вообще программа которую написали независимо от железо на языке и в каких то там пятидесятых годах ну вот такой модерновый имплементация она вот в девяносто первом году я честно говоря не знаю зачем они на выпускались только версий и вот и 9 лет его обновляли но вот где-то в 2000 году решили что вот все вот калькулятор все вот он работает до вот-вот больше не надо его обновлять и действительно 19 лет его никто не обновлял и он до сих пор работает и все с ним отлично но кто из нас тут пишет калькулятор деньги зарабатывает калькулятором вот смотри действительно кто-то есть зарабатывать деньги калькулятором а биллинг но чаще мне кажется биллинг чуть-чуть после по сложнее чем визит и наверное все таки обновляться должен но если мы не пишем беседу все-таки зачем у нас есть как минимум две хорошие причины первая хорошая причина этого кто мы такие пользователи чего мы хотим ведь когда мы хотим этих фич да мы хотим этих фич вчера ну можно еще сейчас потому что под сейчас есть мужу значит но мы хотим фич и наша пользовательском с ю мирская культура она очень изменилась кто достаточно старый чтобы помнить как мы работали мобильные телефоны в 90-х до помните у вас например было nokia и вот на ноги и не было змейки помните а вы хотели змейку да что вы делали когда вы хотели змейку вы покупали новую ночью там потому что вот даже можно было пойти в сервис сказать вот я хочу пробудиться может быть они бы вам про быть или змейка бы вас там не появилось а кто помнит такой этот до этакий был такой специальный шнур для которой нужно было покупать отдельно вот devops вот вот наши люди которые помните его нужно было покупать отдельно он не шел в комплекте а что с ним можно было сделать ничего не может был контакты забэкапить змейку можно было установить не нельзя нужен был священного delfa а потом случилась революция естественно iphone и все дела и сейчас если мы хотим змейку мы можем пойти скачать змейку но вот новые уровни до это какой-то уже продвинутый devops да нету на самом деле было все очень плохо но тем не менее как то допустим даже если было а теперь у нас новые уровни для змейки они вообще скачиваются совершенно автоматически и мы как-то привыкли на это рассчитывать там то есть вот наше требование к тому чтобы наш софт постоянно обновлялся а но оно само по себе разумеется и поэтому если мы хотим если вот есть производитель змейки которые там у них 7 и змейки и производитель змейки у которых зеленые если один из них перестанет свою змейку обновлять а другой будет продолжать обновлять то естественно тот который перестанет обновлять достаточно быстро потеряет всех пользователей то есть мы как пользователи сейчас ожидаем что софт будет обновляться еще один отличный повод для того чтобы обновиться это естественно дыры в безопасности дыры безопасность закрывается тем что мы обновляем свой софт поэтому это естественно тоже необходимость тех из вас кто получал на права могут быть помнят вот этот вот прекрасный диаграмму про скорость и тормозной путь и помнит что тут у нас есть два сейчас это я сейчас вот два разных два разных фактор который влияет на тормозной путь осознание и торможение эти два разных фактор они совершенно по-разному работают осознание это про значит сигнал сигнал который попадает на сетчатку глаза идет воск мозг там осознает что у нас опасность передает сигнал значит на ногу мы нажимаем на тормоз то есть это какая-то физика химия человеческого тела а торможение это физика там у нас состояние покрытия общины и тормозные колодки и в общем то мы можем бороться с сокращает тормозной путь и в обоих направлениях у нас есть значит лучше шины у нас допустим есть лучше дороги у нас есть лучше тормоза а вот с осознанием как мы боремся роботами да правильно автопилотом естественно как только мы тормознут их людей значит заменяем на быстродействующий машины то осознание у нас уменьшается и соответственно у нас больше ну меньше меньше аварий на дорогах две совершенно два совершенно разных действия для того чтобы увеличить безопасность в одной отрасли с нашими и дырами софта абсолютно тоже самое у нас есть три разных совершенной механики борьбы первое это нам нужно найти что у нас есть какая-то дыра безопасности да мы ее можем находить там мониторинга месите аудитами какими-то там и машин lernen гамп андрейко днищем honey pot есть сто пятьсот разных способов дальше нам нужно придумать как обезвредить это история про разработчиков которые значит должны найти как правильно написать печь чтобы закрыть эту дыру там если у нас sql injection значит нам нужно срочно пойти и за искупить наши параметры до добавить какую-то валидацию и так далее дальше есть третий шаг который совершенно опять же другая динамика и это за деплоить fix в продакшен и все три истории совершенно разные но каждая из них уменьшает вот это время от того момента когда мы голой заднице оказались на наружи до того как мы наоборот в тепле и в безопасности и естественно наша скорость обновлений она напрямую влияет на вот этот вот третий шаг который имеет смысл уменьшать безотносительно что происходит с двумя другими я вам приведу пару примеров один пример это петя анон петя там вася или кто он там был который атаковал всю сеть медицинского обслуживания в британии пару лет назад в общем то там было достаточно грустная история потому что ну ранцем мэром находится сразу и в общем как только этот петь он он петя значит обнаружился немедленно выпустили печи на все операционные системы которые существовали в последние 10 лет проблема в том что все эти в больнице они там на windows xp у которых end of life сто лет назад и этот windows икс пи никто не пошел и соответственно значит все эти больницы полегли от вот этого вот транс mr значит ну в чем у нас проблема проблема у нас конечно в том что никто не обновлялся годами и вот так вот мы попадаем на то что у нас есть какие-то серьезные проблемы и за отсутствие обновления и еще один пример это equave ax это наша грустная американская история 143 миллиона это не конечная цифра конечная цифра была по моему что то в районе 180 записей о кредитной истории были украдены и на самом деле это очень большое дело потому что то информация которая там она является приватным ключом для в общем-то всей жизни там в в северной америке то есть зная эту информацию которая была украдена можно спокойно там открывать банковские счета открывать новые кредитки брать там ипотеку под дом и вообще все что угодно то есть это действительно у кого кто-то сейчас сидит на возможности представить себя любым жителем северной америки для любого финансового для любой финансовой организации значит что там случилось там на самом деле была какая-то история которая в течение двух месяцев была дыра из-за старой версии struts 2 и вот из этой дыры потихонечку-потихонечку скачали вот эти вот 185 миллионов ну ладно допустим сложно было найти к тому времени как нашли fix уже давно был выпущен было уже существовал новая версия но потом два месяца взяла тупо обновить то есть собрать новую систему и выложить ее на продакшен занял его кайф акции еще два месяца за эти еще два месяца там выкачали еще черт знает сколько миллионов соответственно вот если бы нам вот хотя бы вот эти два месяца убрать или сократить до минут часов даже дней естественно ущерба было бы было бы сами понимаете меньше теперь вы можете сказать это все старые примеры два года назад и в общем то это достаточно редкость но существует другая проблема помните с чего мы начали этот год спектр их meltdown надо он вызвал прямо вот совсем панику панику потому что там десять строчек java скрипта позволяла украсть пароль из другого приложения но meltdown очень быстро за подсели буквально там через пару дней начали выходить патчи провайдер в операционных систем и мы в общем то справились с этим молдом нам легко а вот спектр он зараза не такой простой в общем-то консенсус в том что спектр type your abilities то есть в ней рабиль с которой построены на принципе который был показан спектре их вообще невозможно предотвратить их невозможно предотвратить кошмар их а мы же уже видели мультики поэтому звук с компьютера можно вообще вырубить да значит это невозможно предотвратить потому что как они работают мы можем предугадать спекулятивные оптимизации процессора на основании хода который на этом процессоре бежит при условии что код выполняется одинаково спекулятивные операции будут одинаковые что значит код который выполняется одинаково это код который написан по одним и тем же принципам это код который основан на одних и тех же дизайн паттернах и на одних и тех же каких-то best practices то есть это аккуратно то как разработчики пишут код большинство программ написаны более-менее одинаково и поэтому изучив какую-то базу определенную программу мы можем предположить как другие программы будут себя вести поэтому вот этот вот спектр в не робейте который на нем на нем на этом принципе разрабатываются их невозможно предотвратить поэтому мы сразу же начинаем отсчёт с того что у нас есть дыра и теперь чем быстрее мы ее закроем чем быстрее мы выкатим против продакшен тем более надежными наша система будет но это как бы достаточно очевидные вещи но вот как бы нам нужно найти как можно быстрее починить как можно быстрее и за деплоить как можно быстрее это очевидно но тем не менее сожалению очень многие этого не делают и мы сейчас у нас будет очень много фана разбирая как раз тех кто не делает или тех кто делает неправильно кто читал state of devops report мало мало значит это в общем самый одну не знаем самые но один из самых главных документов в мире devops это годовой отчет который проводит d-max research and assessment групп который сейчас google cloud уже тридцать одна тысяча организаций опрошено очень серьезный в общем-то такой отчет и они делят все команды на 4 когорты ло перформанс медем перформанс хай перформанс i lied перформанс из хороших новостей у нас же 20 процентов или перформанс то есть каждая пятая команда попадает вот в эту верхнюю когорту и это значит что каждая пятая команда умеет деплоить он димент мало тибул тепло и спереди да продакшен и это в общем то естественно отличные новости потому что вот эти ребята умеют поставлять фичи быстрее всех умеют закрывать дыры быстрее всех и в общем-то они очень хорошие и мы знаем что так можно делать потому что на самом деле ничего нового нет все принципы начиная с 1998 года extreme programming иском и тойота продакшен систем и канбан они все на самом деле рассказывают об одном и том же они рассказывают о том как деплоить чаще и поэтому неудивительно что в очень ну хотя бы одна пятая нашей индустрии уже с 98 года наконец научилась это делать это хорошие новости ну как вы уже знаете меня зовут барух я работаю в компании dji фраг chef стикеров то значит что у меня есть наклеечки вот кроме того я заведу девелопер advocacy и самое главное на этом слайде это конечно мой twitter как вы уже поняли нужно срочно меня зафолловить чтобы вам было удобно он на каждую естественно на каждом слайде вот и давайте поговорим о том что же может пойти не так если вы хотите обновляться почаще и мой любимый пример это пример из мира jaffe кто из вас работает джавой диплом джаву вот все даму почти все ну вот кроме виталия но это мы пофиксим да значит если вы помните в 2017 году два года назад марк рейнольт который hand of платформ чего-то чего-то самый главный человек в жанре сказал мы будем релизе чаще и мы перешли от номинального релиз сайкл который был 2 года и реально длился где-то от 2 до 5 лет на очень строгий release a cold полгода каждые полгода мы будем фигачить новую джаву неважно что хотя и фичу успели успели какие нет ждут следующей и в общем то это все должно быть для чего чтобы мы все могли апдейт тиц и чаще вот новая java там новые фичи его на более безопасно она быстрее и мы каждые полгода очень хотим правда же хотим же эти посмотрим хотим мы или нет отчет другой прекрасной компании jetbrains стендов акустическим 2019 года тоже очень серьезный документ 7000 девелопер заброшенная как там наши java поживает просто чтобы поняли java 8 было как раз продакшен релиз когда марк объявил что вот теперь-то мы будем диплом быстрее с тех пор вышло 9 10 11 12 13 все на java 8 и тут как бы ему непонятно потому что что-то пошло не так очевидно ведь весит он нужен был для того чтобы мы начинали больше брать новую джаву но как-то почему-то никто не берет но мы же знаем для чего нужны новые версии мы с вами говорили а фичи а безопасность у нас же без если мы не объединимся с 8 джавы у нас там нету ни джексон модуль орите не фара не там какого-нибудь нового свеча ничего же у нас нет мы впишем как неандертальцы почему же так получается должно понять почему так нет не получается нам нужно понять как в принципе мы решаем хотим и обновить наш софт или не хотим вот например есть апдейт вышла новая java мы хотим ну допустим мы хотим там есть вот только вот этот вот джексон джексоном все поломает никотин пользы нет ну как бы ну и не надо если мы хотим следующий вопрос будет если у нас риски очевидно с java и но мы все тут отвечаем за продакшен рисков овер дофига да потому что скорее всего она нам что-нибудь поломает а у нас извините продакшен ну бывает такое что нет рисков на апдейты ну бывает там какая-нибудь почему вы помните те которые тепло и там алтиплато им задай их не смущает трески например они тепло от netflix алтиплато ем за день ну как бы ну допустим ну и сломали аллен netflix ну и что ну мы пойдем место то в youtube мультики смотреть какая разница риски маленькие а вот если риски есть следующий вопрос доверяем ли мы провайдеру я долго думал какой бы пример провести и вот прям сегодня с этим туго но помните несколько лет назад как мы им на каэс обновляли вот вышел новый апдейт а давайте все будет работать уже к сожалению давно не так и большинство умных людей отучилась доверять эту есть идиоты которые накатали ну правда телись кроме меня ну вот остальные молодцы потому что вот мы больше не доверяем но если бы вы доверяли думаю бы естественно брали убрали апдейты а вот если мы не доверяем то возникает вопрос а почему мы не доверяем а что нам мешает взять и проапдейтиться до новый java очевидно качества потому что мы так подозреваем что в большинстве наших провайдеров качество гарантируется примерно так я тебе гарантирую все отлично вот да но ну как бы это не совсем честно потому что мы умеем все-таки тестировать и мы умеем хорошо тестировать и тем не менее этого мало этого мало потому что проблема не в коде а в количестве информации которой она проводит должна обрабатываться вот петабайты мы все знаем что это много больше петабайтов есть эксабайт и а уже потом идут вот эти вот это байт и з табой ты это очень много и вопрос как вы ахи если у нас на продакшен из это байт и мы можем собрать стейджинг который будет как и должен быть стейджинг похож на продакшн очевидно мы не можем если мы не можем то тогда что мы делаем некоторые например тестируйте продакшене и тут начинаются веселые истории значит вы в фейсбуке поищите хэштег пустой конверт из китая то вы найдете несколько постов в пару лет назад моей жены который был совершенно крепи experience сейчас под хэллоуин самое время рассказать ну она была зарегистрирована в алиэкспрессе я заказывала оттуда какие-то странные штуки а потом даже если она ничего не заказывала раз в пару недель ей приходил пустой конверт in a normal совсем пустой а иногда в нем были странные артефакты значит белый носок красная лента кусочек черной ткани резинка для волос пластиковое колечко это было жутко крепи ну вот реально вот приходит конверты открываешь там ну как чёрная метка да там больше не понятно она же ничего не заказывают мы заходим на ее и к мы сначала подумали хакнули деньги никто не снимает да то есть это что то вообще очень очень странное и тут лео небе голль ник с которым вы все я надеюсь знакомы по предыдущим die wut сам как-то сидел у нас мы ему рассказывали эту историю он горит а что непонятно то ребята тестирует в продакшене они взяли кусок продакшен базы данных и тестирует на них свой provisioning да вот они оформляют заказы вот они предъявляют shipping ну вот вы попали в этот кусок в базы данных на которые они тестируют ну вот но я дьяк чему к тому что мы не доверяем потому что мы не доверяем качеству то есть возвращаясь к нашей диаграмме мы не доверяем качеству и нам нужно проверять это бывает два варианта иногда проверять просто не имеет смысла как например в случае с релиза java раз полгода если мне проверить все мои системы занимает больше чем полгода то что я буду очень напрягаться потом через полотно major будет я уже на вы потестирую там правда есть некоторые лук поскольку тут тоже не имеет смысл тестировать потому что будет следующее но там накапливается какая то по крайней мере база того что стоит тестировать а вот каждую очевидно не стоит но даже если мы можем делать приемочная тестирование это все равно будет дорого долго и не факт что мне вот этот вот быстрый цикл разработки понравятся и действительно когда мы спрашивали у наших клиентов и делали такой мини-опрос как часто вы релизе ти почему мы достаточно часто слышали ответ наши клиенты не готовы принимать слишком частые обновления это вот об этом это такая прохладная история когда я обвиняю жертву в том что они не хотят тестировать нашу хрень до и и на данный момент нам нужно чтобы у нас было достаточно всяких ништяков в релизе чтобы оправдать апдейты ждем и то же самое в итоге все конечно правда биться с 8 java но там должно быть дофига всего накопилось за пять разных версий чтобы оправдать вот эти полгода приемочного тестирования с которым я буду буду страдать то есть наш трейдов это фичи который мы очень хотим и цена наших приемных проверок да то есть вот таким образом у нас трейдов можем ли мы хотим нибудь образом эту систему обмануть можем ли мы каким-нибудь образом заставить принимать релизы принимать обновления которые мы хотим ну можем да значит есть обновление мы его хотим да а ну и дальше если риски нет да это вариант netflix а тут добавляется то что нас никто не спрашивает в принципе это работает например для кто знает какой версии chrome он у него сейчас ну вот три человека зачем вам это знать ну хорошо ну три человека да почему потому что риски ну не очень большие ну что ну в крайнем случае у вас не поднимется браузера вы откройте сафари найдете и откройте сафари ну хорошо twitter в браузере это вы оба плите ищем там очевидно есть какая-то версия но вы сто процентов не знаете какая и обновлять ее или нет вас никто не спрашивает в следующий раз когда вы обновите страницу у вас может быть новая версия вот с этим мерзким юань но у вас никто ничего не спросил кто знает версию twitter приложения в айфоне тоже никто не знает кто знает версию смартфона вот тут сразу же как минимум половина как минимум половина почему потому что есть риски раз у нас есть большие риски на в риске у нас брик нашего телефона терпит а кирпичи наш телефон то у нас сразу здесь вот этого вот нас никто не спрашивает больше не делают и для того чтобы обновить операционную систему слава богу к нам приходят за вопросами и умные люди говорят мы не будем обновляться вот значит ну вот теперь вы понимаете что единственный способ для того чтобы имплементировать частые обновления это позаботиться о том что мы их делаем качественно потому что мы хотим восстановить вот эту вот утерянную доверие когда наши обновления будут принимать не проверяя давайте посмотрим что же может пойти не так и как мы с этим боремся еще одна история лично я это про то как я купил google on hop луговым хоббита такой роутер очень хороший он сейчас называется google вайфая это там и мыши репетиры все дела когда это был просто один раутер и главная фича которая меня подкупило это что он становится лучше и лучше со временем потому что к нему прилетают апдейты автоматически и это как бы очень круто значит и тут в дело было два года назад тоже 2017 году я был в какой-то командировки и мне звонит моя жена играть бору дети сидят в темноте я такой что такое отключили электричество она говорит интернета нет я говорю ну они кричат алекса включи свет алекса включи свет и ничего не происходит я говорю ну ладно но ты им покажи и выключатели пусть знают вот но тем ни менее интернета не было ну как бы ну нету и нету бывает всякое бывает позвонил я значит провайдеру провайдер говорит у нас сердечно и тут я получаю email email говорит извините мы тут прислали апдейт и он случайно рецепту ваш роутер на factory settings и поэтому он теперь не подключен к интернету и мы не можем прислать опадает который это починит потому что ваш роутер не подключен к интернету вот ну им для того чтобы имел получить нужен интернет которого нет но я был в командировке поэтому я получил на конференци он нам вай-фая но и смог сказать что делать и действительно восстановилась но в общем история вот такая значит что-то пошло настолько не так что прислать исправлением посети невозможно как мы это лечим мы это лечим локальным откатом у нас есть предыдущая версия которую мы сохранили на девайсе никогда после обновления если что-то пошло не так то можно откатить версию не ожидая новой версии по сети это в случае конечно с раутером потому что мы пошли к раутеру зашли на его интерфейс и настроили его заново а вот в случае например какого-нибудь солнечных батарей где-нибудь в сахаре и куда нужно на верблюдах три дня добираться это реальная проблема потому что если там признать апдейт который весь этот рай погасит то в общем то они очень понятно что собственно говоря и делать то есть это достаточно дорогая фича для того чтобы ее имплементировать но безусловно в определенных ситуациях она имеет смысл и тут сзади сидите и думать ученом парит мозги своим aiuti мы тут все значит у нас server-side у нас сервера у нас клауд это все не про нас но на самом деле aiuti интернет of tanks он про все потому что tanks это и ваши сервера и сервера вашего клауд провайдера и ваши десктопы и все на свете поэтому когда мы говорим про интернет of tanks мы говорим обо всем вот вам еще один пример машины апдейтить казалось бы что может пойти не так там прекрасная машина jaguar фпс вообще вот и и она только недавно вышло в этом году и тут в июня объявляется rehau как по-русски recall отзыв объявляется для того чтобы починить тормозов нужна правда edit софт для того чтобы ну логично да это же почти не провода тормоза понятно что нож про близнецов но слушайте это же какая-то шиза мы же умеем апдейтить сов нам совершенно не нужно для этого загонять машину на сервис для того чтобы правда эти софт потому что все что нужно сделать это что нужно сделать это обновление по воздуху нужно имплементировать же правда и тогда можно чинить тормоза где хочешь потому что физические отзывы они же очень дорогие и что самое главное их невозможно заставить да ну вот сейчас едет с бракованными тормозами ну вот что вы ему сделайте мы ему пришлете email вы пришлете письмо вы обретете письмо в красном конверте вы ему угрожали письмом в красном конверте на красной бумаги что ещё можно сделать ну как бы его заставить и пойти в сервис я с у вас имплементировать на обновление по воздуху то они просто прилетают и чьими в ему промо за поэтому обновление по воздуху это очевидно правильный выход а лучше всего непрерывное обновление непрерывное обновление по воздуху а не как обычные только лучше почему вот вам еще одна машина в этой машине есть обновление по воздуху тесла у теслы и есть автопилота тесла есть один очень неприятный баг называется фантом breaking значит машина едет на автопилоте по шоссе рядом никаких машин нет светит солнышко никаких теней никаких помех и тут со всей дури автопилот выдает по тормозам водитель не ожидал водитель чуть ли не выходит через лобовое стекло значит у него тут этот самый хочется ремень пассажиры все значит начинает на него орать и что он а я нечего не делал да конечно ну короче вот это реальная штука вы видите есть очень много постов которые значит ну где народ негодует и вот приходит апдейт до там среди всего есть вот этот маленький мая norrebro в mines and bug fix с этот маленький improvements and bug fix включает в себя fix вот этому вот фандом breaking значит этот апдейт ну он после предыдущего выходит через месяц знаете почему он выходит через месяц после предыдущего не потому что только через месяц сообразили как пофиксить а потому что нужно было подождать пока шахматы закончат потому что вы же видите в одном апдейте там шахматы и bug fixes редкие обновления группируют фичи и тогда важные фичи ждут всякие не важной фичи тут мы можем поспорить что важнее шахматы или фонтан breaking допустим но если я не пользуюсь автопилотом зато мне когда я заряжаюсь вот кровь из носа надо поиграть шахматы то может быть для меня шахматы важнее и тогда с чего вдруг я буду ждать пока не закончит работу над этим фиксом фандом breakin которыми я не пользуюсь в любом случае как бы вы это не повернули группировать фичи плохая привычка потому что фичи ждут одна другой и на самом деле зря если у вас будут непрерывное обновление такой проблемы не будет как только фичи готова можно сразу выпускать это обновление а если вы уже все равно контролируете то что вы обретёте ну потому что иначе у вас вообще нет никаких апдейтов то нет никаких проблем это собственно говоря сделать как это например сделано вот в наших смартфонах там включен а авто апдейт у кого-то у кого выключена стоит его чет я не ожидал ну потому что обычно у всех включен ну хорошо да вы же devops у нормальных людей авто будет включён не но я шучу но на самом деле если бы у большинства у большинства обычных людей аптечку of the bride включенный это хорошо потому что они получают новые фичи новые уровни и змейки там security обновление и так далее и вот значит еще одна прекрасная история 1 разработчик решил попробовать себя в разработке для мобайл и начал это учить и вел дневник о его значит вот этом вот ну и двинь чарда значит аа каком-то своем приключении заодно так назвал игру игра на самом деле прикольная 4.2 очень много пятизвездочных отзывов и из всего этого блога самые интересные это вот один из один из постов про то как он решил запилить новую фичу эта фича было монетизация да он решил там за деньги отключать рекламу и можно купить вот этот вот фичу отключения рекламы прямо внутри приложения значит у него там android java все дела темплейты тимплей ты начинаются со знака доллара и он это все тестирует настей джиговых серверах эппла цену стриминговый сервера apple а отдают без валюты 3.19 и все выглядит нормально вы уже догадались что будет дальше что будет дальше production сервера отдают с долларом до казалось бы уже смешно некоторые продакшен сервера отдают с валютой а некоторые нет ну и дальше естественно все очень грустно потому что совершенно это рандом ально случается сначала он как-то выяснил что это случается только в странах где знак воды . это как бы уже такой step forward а потом и здесь что то не у всех там и совершенно не понятно почему она действительно рано давольно на какой сервер попадет там или упадет или не упадет никакой совершенно у него нету возможности это все отгиба жить потому что сам он живет где-то в европе там не доллары и в общем-то единственная как он получает эти фидбэки это с помощью мото в reviews до года ему ставят одну звездочку пишут там у меня все закрывалась и ну как-то сложно дибашки на основании этой информации в итоге он сумел вписаться ну с достаточным количеством человек для того чтобы понять в чем дело разобрались пофиксили наконец fix он нашел он значит в четверг нашел этот фикс или там в пятницу и написал эту просьбу на экстренное рассмотрение ну потому что серьезный bug fix apple приняли его заявку на экстренное рассмотрение и ушли на выходные потому что даже экстренное рассмотрение не может быть причиной нарушать work life balance в конце концов выходные и поэтому соответственно еще несколько дней это все было с богам и пока и пока починили и на основании вот этой прекрасной истории у нас прямо очень много патронов во-первых к на речные релизы когда что-то пошло не так если мы сделали релиз всем то все и страдают мы можем релизе небольшому проценту пользователей уменьшая радиус поражения и дальше наблюдать если что-то пошло не так то по крайней мере не все пострадают мы сможем откатить и в общем то все будет хорошо для этого нам конечно нужно наблюдать да потому что тяжело де бо жить по матерным пользовать отзывам пользователей и для этого нам нужно имплементировать tracing мониторинг блогинг и все прочие прекрасные вещи которые вы знаете и любите и нам нужно возможно сделать откат и нам нужно сохранять предыдущую версию чтобы если что ее сразу за деплоить значит в чем проблема в том что и у эппла и у гугла не существует вообще функциональности отката нельзя сказать эй google google что-то пошло не так возьми прошлую версию и поменяй в плен на неё нельзя вместо этого вы можете хранить предыдущую версию у вас переименовать ее в следующую версию и сделать что дать на провал который займет выходные праздники никто не торопится сколько займет как мы решаем эту проблему в чем флагами если у нас по платформа не поддерживает откат там и имплементировать возможность отключать новый новые версии по воздуху через какой-то роста и пьянку если бы это была сделана он бы мог сказать убери вот эту кнопку отключить рекламу и в общем то по крайней мере народу и очень-очень быстро перестал перестал страдать и тут у меня вы уже должны быть достаточно раздражены этой всей фигней потому что тут есть и в мобильные разработчики тут нету есть а идти разработчики там машины вот да там сел в drawing apc ну вот тоже нету вы все пилить и сервисы на клауд и в общем-то сбегали собственно говоря я тут распинаюсь проблема в том что если вы думаете что вам тяжело то то что вы делаете ерунда по сравнению тем что делают айтишники и g и так далее рома вон там вены уже покраснел весь все это слушай а потому что например вы полностью владеете доступностью вашего девайса не важна ваша the server или он в claude или он отзывается или он не отзывается если он не отзывается вы знаете что делать если у вас есть рэй вот этих вот солнечных батарей где-нибудь в сахаре то вы не владеете доступностью вашего девайса вы владеете состоянием вашего девайса то что бежит на сервере то что вы туда поставили то что бежит на телефоне у клиента вот эти все до сэндбокс и вот эти все отсутствия рута отсутствие jailbreak это жалкие попытки контролировать состояние девайса иногда она срабатывает иногда нет существующая версия когда вы обретёте а ваш софт на вашем сервере вы прекрасно знаете с какой версии вы переходите на какую и вы можете сказать а а мы не можем сразу стретен опять нам нужно сначала накатить четвертую а потом пятую что делают люди на своих девайсах какое у них там состоянии искать их версии они будут отдать на коте вы не имеете никакого контроля и то чтоб физических девайсу опять же если у вас там в серверной чего-то там отвалилась вы можете туда пойти и посмотреть что там случилось то же самое в клаудии то будете не вы но тем не менее у кого-то есть доступ а с доступом к любому другому девайсу который вы не контролируете все будет хуже то есть вашу жизнь на самом деле намного лучше чем жизнь вот этих бедных ребят про которые мы сейчас говорили но даже в таком случае когда мы контролируем все у нас есть совершенно эпические файлы и один из самых эпических файлов это давняя история но она поражает своей эпичностью это история night капитал 3 августа 2012 года 2 августа точнее night капитал является одной по моему из четырех крупнейших инвесторских фирм на уолл-стрите который занимается электронной торговлей и торгуют миллионами и миллионами долларов значит что происходит написали новую версию программы и решили переиспользовать какие-то старые флаги которые были на серверах ну казалось бы что может пойти не так один сервер из 8 серверов кластеры забыли обновить и там бежал старый кот клиенты новые включились высылают команды которые должны что-то одно делать с новыми флагами они вместо этого что-то делают совсем другое со старыми и грубо говоря начинают торговать мягко говоря неправильно они переключили флаги в старой системе и тут вместо того чтобы зарабатывать деньги это фирма начинает терять деньги немедленно все вызываются на он холл что делают разработчики первым делом отключаю те семь серверов которые были пройдены потому что там что-то не так сто процентов нагрузки идет на неправильную версию софта и в течении 40 минут ребята теряет 440 миллионов долларов и разоряются из всей этой истории до мониторинга никакого не все это в live продавшим там ребята пытаются чего жить честно говоря ну 440 миллионов это достаточно абстрактная вещь и нам тяжело себе представить каково это потерять 440 миллионов но вот я себе прекрасно представляю вот я когда мы сидим на он колли и у нас есть какой-то production аутрич ну вот адреналин да и вот как то вот потряхивает и вот да ну все же лежит что же делать а теперь то же самое только теряя десятки миллионов минуту а вот он кол мы сидим и вот надо надо бы вот здесь посмотри миллионы и миллионы бегут а давайте проверить биллионы пекут это конечно страшно вообще не у меня мурашки вот только я себе представляю вот эту картину ну и естественно там у нас все плохо отсутствие автоматизированным дипломанта люди на самом деле отвратительно умеет делать повторяющиеся действия и поэтому им ни в коем случае нельзя доверять машины для повторяющих детстве самые она поэтому за автоматизировать deployment она на самом деле конечно помогает еще одна проблема они это был новой версии которые они писали два года соответственно редкие обновление это прямо вот что то такое стрессовое и необычное и страшное и так далее если вы обновляете раз в неделю раз в день несколько раз в день то для вас ничего необычного нет и поэтому шансов что вы ошибетесь естественно намного меньше кроме того ну вот это решение переиспользовать старые флаги она во-первых довольно странная а во-вторых уж точно должно было привлечь внимание то есть даже если вы хотите переиспользовать стоит вы должны по крайней мере осознавать что вы делаете и если вы делаете rollback то не забывать естественно про это тоже следующая история это история про клад flair knopfler вы наверное слышали эта компания которая занимается diedas protection и эти ребята вот опять же свежак июнь они упали и они упали виноваты были не а не виноват был ли ryzen и seo club flora публично пошел хамить we raise он типа ахнуть такие нехорошие и вы нас уронили вот зачем же не прошло и двух недель как крот флору balsam и единственная реакция в интернете было ну что сейчас вы не можете обвинить верой зам ну как бы они получили хорошую дозу сарказма потому что в общем-то ну вот не надо так делать не надо кого-то шейн эти когда у кого то проблемы надо посочувствовать и быть хорошими коллегами но на самом деле вот давайте поговорим про вот этот вот второй второе событие когда они упали сами что же все-таки случилось там ну они постоянно обновляет свои правила рафтинга потому что они борются вот как раз этим видосом да ну это такая гонка тут они какой-то написали одно из правил неправильно значит что там случилось естественно как обычно регулярка задралась и пью на 100 процентов на самом деле вот эта история доказывает что наша планета она погибнет не вот вот это вот там метеорита или там ядерной катастрофы дам проснулись все и даже не из-за того что у нас будет загрязнение природы планеты конечно погибнет когда кто-то напишет реально нехорошую регулярку и вот клаус флэра не это подтверждают вот у них был на статус плеч прям так и написано аффлек театр и джон на самом деле достаточно дико потому что ну мы же уже говорили к на вечные релизы уменьшают радиус поражения с apc да меньше чем рф и самое непонятное что канареечное релизы научила делать всех их мама когда им было 8 лет и они первый раз учились как стирать потому что на любом отбеливатели написано проверить на незаметном месте проверить на незаметном месте и это канареечный deployment она вы пробуете на маленьком кусочке и смотрите испортилась краска или нет ну вот это же ну серьезно ну вот мы все умеем поэтому абсолютно непонятно почему это все не делается ну и последняя история пожалуй самый эпичный из всех это movie пас мою пас это подписка для кинотеатров в америке вы платите какую-то сумму в месяц и потом можете ходить в кино хоть вообще оттуда не выходить ребята решили про апдейтить свое приложение и выключили его на несколько недель и не запланированный down time несколько недель говорят вы через несколько недель приходите все будет хорошо мы тут говорим про обновление без недоступности про зиру time deployment ну на самом деле вот пять недель и тонизирует own time и вы будете смеяться но познал как они вернулись почему то клиент они пришли они обанкротились хотя казалось бы что может пойти не так и конечно же обновляйся без недоступности можно это выключить потому что я от тебя не могу только вы можете но будем надеяться ну вот без недоступности лучше чем пять недель потому что они обанкротились ну и для того чтобы нам суммировать то о чем мы говорили для непрерывных обновления не должны быть частые они должны быть автоматизированы и они должны быть оттестированы и насколько это возможно и мы же говорили что невозможно оттестировать все к на реечные они должны учитывать состояние они должны быть наблюдаемые и насколько возможно с локальными откатами но мы говорили локальная отката это такой упражнение со звездочкой это не для всех но честное слово если вы будете делать все остальное этого будет вполне достаточно для большинства приложений с которыми мы имеем дело потому что локальные анка ты нужны только в крайних случаях и вот тогда если вы все это будете делать я вам обещаю что наша диаграмма обновлений будет выглядеть вот так у нас есть апдейт мы его хотим до хотим или нет не хотим не важно потому что у нас автоматический апдейт есть ли риски если нет вообще нет вопросов но даже если есть риски мы начнем доверять нашим провайдером нашего софта потому что мы будем знать что наши провайдеры все сделали как надо у них есть вот эти вот штуки и на самом деле вот самые самые самые главные два и так она речные лизы и абвер mobility до наблюдаемость потому что вот эта пара мы уменьшаем радиус поражения и мы смотрим что произошло если что можем откатить в общем-то гарантирует большинству из нас очень очень надежный апдейты да кто-то всегда словит какой-то баг но во первых как я уже говорил таких фраеров которые готовы а птицы не важно что достаточно они издеваются да это деформирован у меня вот машина там авто апдейт там есть такой обычный молд есть и твинс твинс mode это я фраер я хочу непроверенные фичи в моей машине ну естественно я на эдвин смут ну потому что же там же шахматы могут быть быстрее на два дня чем у остальных конечно я хочу да вот и таким образом большинство из нас действительно получат надежные надежные апдейты которые могут быть непрерывные и мы будем получать новые фичи и очень ду то что мы хотим это перейти от вот этих вот больших кусков редких кусков обновлений на обновление настолько частые и настолько маленькие насколько возможно как только у нас есть готовая фича мы хотим сразу ее выкатывать настолько частые и настолько маленькие что они выглядят практически как поток информации от производителя софта до клиентов до пользователей софта и мы это называем liquid с авторов написали мы про это естественно книжку я х автор двух кофаундеров джефф рога фрида саймона и и овалом она и я буду очень рад эту книжку вам сегодня подарить подписать на дискуссионной зоне сразу после доклада мы туда пойдем и я соответственно каждому за 100 хочет книжку эту и подарю перейти на вы закончим давайте поговорим про исключение у вас наверняка уже сложилась картинка ой-ой-ой когда же мы никогда не будем обновляться до там например ну я незнаю медицинское обнаружены во время операции наверное ну не очень хорошо обновлять до хотя еще будут примеры когда вот нехорошо в пятницу в пятницу нет проблем потому что канарейки обзор mobility и автоматически rollback вам абсолютном даже не надо из кровати вылезать атомная станция хороший пример да мы все видели чернобыль а о самолет самолет спасибо я не платил пока еще по крайней мере самолет он прекрасный пример кто считает что мочить самолет когда он летит наверное не очень хорошая идея всех все считают дам дону почти все доводилось 1 бижу хотите один я вас первый убежу да это мы сейчас сделали уже вот у аэробуса у него есть моему relic раз в сто сорок девять часов у него кончается память я не шучу правда раз сорок девять часов его надо ли будить теперь смотрите допустим его забыли про ли будет ну бывает забыли да и он отправился значит вот в какой-нибудь перелет из какого-нибудь сан-франциско в какой-нибудь тель-авив это 14 часов лёта где-то часов через пять лет вдруг пилота и слушая мои reboot 0 и его перед тем как полетели черт забыли а у нас через три часа закончится память и они таких юстон у нас проблема плюс он поднимает разработчиков разработчики бы год говорят мы нашли мы мурлик у нас есть новая версия как вы считаете мы хотим же с правда эти самолеты in flight хотим потому что хуже не будет может быть он починиться а может быть нет но шансов что он подчинен что он подчинится хорошее потому что разработчики хорошие мемы relic нашли пофиксили если бы у нас была система непрерывных обновлений по воздуху самолетов мы бы могли этот самолет пропатчить и довести такие людей и посадить и так далее вот ну там атлантика сесть негде все плохо ну неважно на даже абстрактный пример но меня не катимся мы делаем что хотим нету никаких ничего мы делаем что хотим мы сейчас голосовали хорошее или плохое де они разрешают закон или нет мы же не об этом ну ладно ну чего пристали абстрактно в вакууме летим мы нету земли нигде слушайте а вы думаете никто никогда не обретет самолеты в воздухе boeing 777 вот проблема была никто не мог погибать поэтому мы посадили всех инженеров на самолет взлетели и они вот так вот на 1 нашли сразу бак вот сразу вот сразу нашли баг и его соответственно про пачелли а вы говорите плохая идея прекрасная жизнь отлично да это это про мотивацию да ну и в общем то на этом все самый важный слайд числовые маркетинг самая важная строчка этого слайда давайте срочно fallout меня в твиттере и так ты понял как делается вот ли хоть со 2 то очень официальных хэштег нашей книжке там может быть есть пять твитов дпс trending между прочим мы молодцы у нас питере trending хэштег нашей конференции liquid soul тут ком это куда вы идёте читать всякие блоги и прочее покупать книжку вам туда не надо идти почему сейчас подарю спасибо большое"
}