{
  "video_id": "Ourz8tRtIfU",
  "channel": "DevOops_conf",
  "title": "Антон Вайс — Зачем нам сервисное сито?",
  "views": 946,
  "duration": 3567,
  "published": "2020-02-07T07:49:19-08:00",
  "text": "у а спасибо воров привет на как настроение не устали второй день конференции но если кто не устал я постараюсь вас добить я тебя перебью еще раз я все разбиваю рассказать как у нас работает общение с залом значит если доклад про длится меньше часа то оставшееся время могут святим вашим вопросам вы задаете вопросы через 2 conference бот в этом боте нужно пойти в полное расписание отмотать the time слота который у нас сейчас 12:30 1:30 30 числа и там у вас появится кнопочка задать вопрос эти вопросы мы зачитаем если останется время ровно через час в 1:30 антон вместе с вами пойдет дискуссионную зону и там уже даже можно не ботом а прямо даже словами задавать вопросы вот теперь уже действительно все антон извини за интервенцию так сложите кто был на моем докладе об из тебя в прошлом году замечательно а кто не было может быть видел в ю-тубе даже больше чем были замечать а кто не был и не видел окей соответственно если я хорошо понимает теорию гроб то все уже на нынешнем должны были хотя бы один раз поднять руку если кто не понял то он видим в состоянии квантовой неопределенности почему доклад называется на хрена козе баян насколько мне известно у этой фразы есть два возможных продолжения одно на хрена козе баян она и так веселая а второй на хрена козе баян у нее же рухнет и то и другое в некотором смысле применимых случае сервисного сета как я надеюсь доклад поможет нам увидеть пару слов обо мне это я меня зовут антон или еще называют and white я родился в питере 16 лет уехал в израиль там я 20 лет занимаюсь информационными технологиями немало от этого устал как бы то ни было последние четыре года я являюсь учредителем и генеральным консультантом компании от mac os after delivery где мы пытаемся помогать компаниям быстрее доставлять качественный софт и именно с точки зрения доставки с авто нас пару лет назад заинтересовала вот это вот новое что-то под названием сервисные сито мы стали интересоваться запускать пилотные проекты как результат год назад я приехал сюда рассказал про есть у как она устроена как его автоматизировать для получения к на речных релизов где-то полгода назад я обнаружил и присоединился к такому сообщества которое называется layer five до сервис меж комьюнити который начертал он своих знаменах благородную цель исследования и развития всего что связано с сервис меж то есть есть уже сообщества которое этим занимается ну и в связи со всем этим я сегодня здесь вот так выглядел последний слайд моей презентации в прошлом году очень удачны презентации как оказалось где я пытался заглянуть в будущее я все время пытаюсь это сделать у меня даже вот на на штанах написано фьючер и в связи с этим и что я говорил и говорю что вывести уже появляются альтернативы я говорил о том что мы начинаем видеть коммерчески имплементации сито ну и значки знаки вопроса на на моем слайде обозначали что видимо впереди нас ждет немало интересного приятно осознавать что я оказался прав действительно интересного за последний год произошло очень много ситы раскалилось до била руками не потрогаешь давайте посмотрим что произошло за последний год и так и стью как раз на тот момент когда мы с вами разговаривали вот-вот должна была выкатиться версия 1 0 якобы первая версия готовы production ну готовая production оказалось приблизительно ну да неважно баги были подчинены перформанс был улучшен более того же в декабре прошлого года google запустили истек отменит сервис на своем облаке на google контейнер engine так что теперь google не только развивает и популяризирует и steel он его еще и продает чего и следовало ожидать далее конкуренты и steel подросли компания баян отбросила неудачное название кондуит вернулась к более удачному и уже за служившему добрую славу на рынке названию linker де вышел linker di2 мы поговорим о нем позже hаши карповский консул отрастил себе хвостик виде коннекта и превратился в сервис мыши теперь поддерживает on вой как сайт корр прокси кроме этого особенная жара в области сид началась последние два-три месяца когда вышла сразу две новых имплементации сито 1 от компании контейн нос который является производители известного некоторым из нас балансировщика трафик их сито называется мышь вот я еще думал что может быть это по украински это марш марш сайту в год ну и компания kong производители опекает в под названием kong выпустили свою имплементацию сервисного сета которая в enterprise версий называется код bash а в open source версия называется qumo кроме этого все это увенчалась проектом который связан со всем этим хотя это не совсем о том же проект очень свежий проекта от клауд найти в компьютер foundation под названием network service мышь или сетевое сервисное сета на этом этаже посмотрим о чем это и к чему плюс понятное дело компания которые продают софт за деньги они за всем этим совсем за всей этой шумихой и наблюдают и в нее немало вкладывают потому что шумиха полезно для бизнеса поэтому мы получили за последний год большое количество коммерческих реализаций сито начиная с амазона кончая вы им в r есть куча всяких разных вариантов того как сито нужно и не нужно делать обо всем этом мы не будем говорить нас конечно больше интересует open source проекты в которых мы с вами сможем как-то поучаствовать ну и когда начинается такая шумиха у нас возникает вопрос а о чем собственно говоря шум и зачем все это и как так мы до нынешнего момента запуска ли микро сервисы и пользовались cabernet сами вроде никакого это был не нужно вдруг теперь оказаться она нам нужно и мы начинаем задавать практические вопросы такие ну во-первых мы пытаемся разобрать что такое сервисная сито о чем все говорят во вторых когда мы поймем что это такое зачем она нам и нужна ли она нам вообще когда мы решаем что она нам зачем-то нужна мы задаем вопрос какое сито брать да идем на рынок много разных продуктов как нам выбрать то что нам нужно ну и наконец одним из факторов выборе на не всегда решающим потому что есть и другие факторы такие как политика иногда сито спускается к нам свыше и нам приходится просто справляться с вопросом сколько же нам это будет стоить и всегда речь идет о деньгах зачастую и даже чаще всего речь идет о времени которое мы это вкладываем усилиях сложности которая появляется в наших системах изменение процессов сотрудничества и так далее вот на все эти вопросы мы с вами попытаемся сегодня ответить ну и начнем с того что же такое сервисная считая начать нам нужно будет с определение которое насколько концептуально важные правильно настолько практически бесполезно а суть заключается в том что в тот момент когда мы построили запустили микро сервисную систему мы неминуемо получаем сервисная сито все том многообразии соединение все эти переплетения каналов связи по которым данные перетекают между нашими микро сервисами и образуют то самое пресловутое сито а вернее то что мы видим верхней части этой диаграммы так называемый сервис меж дата плей до а вот как раз тот практический подход который позволяет нам всем этим хитросплетение им управлять это и есть то что мы на самом деле имеем ввиду когда произносим сегодня слова сервис мышь в этом подходе все управление соединением между сервисами производится при помощи сито из легковесных прокси поскольку сито во многом выросла из кубер не тисато соответственно эти прокси бегут как сайт корр контейнеры или коляске прокси коляски внутри каждого из наших кодов который перехватывает весь трафик который заходит в под и выходит и спада и каким-то образом видимо помогают нам этим трафиком управлять но на впендюрить везде коляски это конечно забавно но настоящая супер сила появляется когда мы можем действительно всем этим централизовано управлять и это нам позволяет то что находится в нижней части нашей диаграммы а именно так называемый сервис меж контроль плей до панель управления сервис миша в которые обычно мы ожидаем увидеть такие компоненты как некий надеемся что удобный пользовательский интерфейс возможно графический чаще всего com онлайн но и поскольку мы хотим чтобы это все было программируемое динамичные современно то обязательно api потом поскольку у нас теперь везде коляски то надо как-то понимать что с трафиком происходит поэтому там будет компонент отвечающий за наблюдаемость мы хотим управлять это значит мы хотим определять какие то полисе в отношении того кому куда можно и нужно для этого нас там будет какой-то полисе engine ну и поскольку мы хотим что все наши сервисы общались между собой в соответствии с современными стандартами стандартам безопасности там будет какой-то компонент отвечающий за безопасность как правило он занимается тем что генерит сертификаты раздает сертификаты и следит за тем чтобы они не протухли тут следует упомянуть о неоднозначных взаимоотношениях между ситом и разнообразными видами шлюзов есть до шлюза я имею ввиду такие вещи как api guide вы ingress игр с контроллеры и прочие виды балансировщик of которые стоят по краям нашей системы есть в индустрии люди которые говорят что вообще это грань между трафиком восток запад то есть тем что происходит внутри системы и трафиком север-юг то есть тем что обращается из системы наружу и снаружи внутрь что это гора я должна быть стерта они говорят разницы никакой нет и там и там мы общаемся с какими-то ненадежными эфемерными и вероятно враждебными сущностями поэтому нам нужен везде поголовные mt ls и управлять всем этим нужно одинаково при помощи одного и того же контроль плейна что по большому счету и делает и steel где ingress и игры с gate вы являются неотъемлемой части установки есть же другие которые говорят что нет набор забот разный поэтому не надо мешать шурупы с гвоздями как бы то ни было суть заключается в том что на сегодня когда мы говорим сервис на сито мы в основном все-таки имеем в виду общение восток-запад да хотя парадоксальным образом возможно ваша дорога в сито будет пролегать через шлюз ну просто потому что незнакомые места проще эти знакомыми путями места действительно не знакомы и потому что вот мой вроде посмотрели на то что такое сито нато чем она отличается от шлюза поняли что везде коляски но все еще не очень понятно о чем это это наблюдаемости или об управляемости или все-таки о безопасности что нам с этим делать вот для того чтобы дать какое-то более-менее предсказуемый вопрос на предсказуемо ответ на все эти вопросы и для того чтобы контролировать как-то попытаться контролировать вот этот безудержно набухающий рынок и шумиху группа компаний во главе с microsoft кто любит microsoft и red head чтобы нам было проще всех любить выступила полгода назад с инициативой создания общей спецификации под названием сервис меж интерфейс заявленной целью описать некий базовый функционал и которого мы как пользователи можем ожидать от сервисного сито ну и некий прослойки такой слой слой абстракции общего языка api при помощи которого разные ситы смогут общаться друг с другом мы сможем общаться с разными сетами увязывать их все подносит а ну и с не заявленной целью понятное дело дать некий отпор тем силам которые как мы ощущаем начинают узурпировать рынок потому что если мы посмотрим на список очень уважаемых компаний на этом слайде мы заметим что не хватает нескольких имен которые мы вроде как ожидали бы там увидеть где google где обеим где лифт то есть все те компании которые стояли за разработкой есть их тут нет когда я спросила об этом гейба монро который product with с эммой в microsoft и он мне сказал что их вступление в эту тусовку является всего лишь делом времени но пока полгода прошло google продает из тела других новостей мы не слышим поэтому будущее самой не очень понятно хочется сейчас сама является еще одним примером такой тенденция которую мы наблюдаем в нашей индустрии которые называют тотальная серди зация всего то есть мы берем существующие объекты интерфейсы и переписываем их в виде серди вк обернитесь и и называем это инновациями вот более-менее то же самое делает в данном случае с эммой он переписывает то что умеет делать седла в виде объектов виде серди кубер не tissot и тут еще следует заметить что вообще у сид также неоднозначные взаимоотношение с кубер нити сам в целом это началось всё система которое самого начала говорил он и стью привязана к оберните суно не совсем она в общем то и не привязаны вы можете запускать действие где угодно у вас есть темы пожалуйста есть даже примеры как того как это можно сделать но по-моему этими примерами кроме самих инженеров которые разрабатывают если никто не пользуется по крайней мере мы практических примеров этого не видели в индустрии как бы то ни было многие ssid на которые мы сегодня будем обращать внимание говорят то же самое другие говорят наоборот нет мы нормально с кубинцем все все хорошо понять их можно потому что не далее как вчера здесь был баф на котором мы все ждали когда кубер нить из наконец умрет привязываться к чему-то что возможно скоро умрет и тем более есть люди которые хотят чтобы она умерла как-то вроде как боязно другой стороны другого бога кроме купюрница у нас по большому счету и нет что делать появляется амбивалентность так вот при всем том нога абразии опции подходов которые существует все-таки с эмо и это очень неплохой способ понять чего же нам ожидать от сита и на хрена козе баян поэтому давайте посмотрим что входит спецификацию там есть четыре группы api 1 по большому счету просто описывает как выглядит трафик какие виды трафика есть у нас системе вот этот пример объекты которые надлежит к этой группе который по большому счету определяют у нас есть два вида раутов один отвечает за метрики другой отвечает за общее здоровье нашего сервиса в тот момент когда мы определили какие виды трафика мы поддерживаем мы можем начать уже по поводу этих видов трафика этих раутов определять что с ними делать этим занимается например следующий следующая группа api под названием трафик акция с контроль это то самое полисе это то самое решение кому куда можно кому куда нужно мужчину куда вы идете вот здесь пример объекта который относится к этой группе трафик таргет что нам определяет он говорит я говорю о рауте который мы определили на предыдущем слайде под названием metrics я говорю что к сервису айдентики которого определяется сервис аккаунтом сервис на port 88 8080 можно обращаться любому сервису который принадлежит к сервис аккаунта prometheus нами спейси дефолт по большому счету при помощи этого мы говорим про митю су можно стучаться на metrics and point наших сервисов а всем остальным видимо нельзя следующая группа api и наиболее близка моему сердцу как я сказал мой основной фокус это доставка софта выкатка софта это именно то что позволяет нам осуществить практике прогрессивной доставки все те самые экономичные релизы blue green тепло и темные запуске иже с ними трафик сплит позволяет нам по-умному разделять трафик перемещать его с места на место определять вес трафика который идет на разные версии сервиса вот у нас есть объект который для примера определяет что у нас есть сервис под названием май об у него есть два бэг-энда 1 версия один другой версии 2 мы посылаем фифти-фифти пополам трафик на две версии и таким образом например получаем возможность осуществить практику оба тестирование для того чтобы понять какая из версий дает нам лучше производительность или больше удовлетворяет наших клиентов ну и наконец когда мы научились управлять трафиком понятное дело мы хотим понять что с ним происходит в результате всего этого и этим занимается группа api под названием трафик metrics который во-первых позволяет нам определить направление трафика то есть трафик может идти либо как в этом примере от кода фу как ты его танк по дубас как-то его там или в обратную сторону ну и после того как мы определили направление трафика мы решаем что же мы хотим верить вот виды метрик которые поддерживает этот объект разнообразные процентили latency и подсчет того сколько вызовов закончились удачно а сколько не очень вооружившийся самое можем ли мы наконец ответить на вопрос нафига козе баян давайте попробуем ну во-первых тот момент когда у нас есть повсеместно коляски которые управляют всем трафиком и у нас есть такие api как трафик access и трафик сплит мы действительно получаем управляемость всего трафика в системе во вторых поскольку коляски пропускают через себя весь сетевой трафик и мы можем собирать с них данные то у нас получается есть возможность весь трафик мерить далее хотя я сама об этом ничего не говорит но есть нам но нас научила и нам обещала что мы можем имплементировать разнообразные техники устойчивости такие как тайм-аут и ретро и переборки и прочие важные вещи экспаншен быков что у нас там еще в четвертых безопасность об этом то же самое ничего не говорят но если мы посмотрим на то как имплементировать подавляющее большинство или даже все варианты сид которые мы видим на сегодня мы понимаем что все они пользуются тем тем фактом что у нас есть теперь коляски который управляет всем трафиком мы все их знаем и нам очень просто раздавать им сертификат и таким образом мы можем зашифровать и сделать интерес sensation на весь трафик ну и наконец опять же наиболее близка моему сердцу прогрессивная доставка трафик сплит позволяет нам делать такие вещи как канареечный релизы blue green тепло и темные запуске более того на мой взгляд это и есть самый интересный способ использования сито потому что ну я об этом уже говорил вчера и не устаю говорить книжка непрерывная доставка вышла 12 лет назад вроде как сегодня тоже общее место но на деле организация которая на самом деле осуществляют непрерывную доставку софта их можно пересчитать на пальцах почему потому что вы катка софта до сих пор по крайней мере масштабов каких-то промышленных масштабах является очень стрессовым событиям почему потому что у нас нет достаточного контроля потому что да действительно техники прогрессивных доставки они могут позволить нам сделать это событие менее стрессовым мы будем меньше бояться обновление наши пользователи будут меньше бояться обновлений бору вчера говорил о том насколько это важно но факт заключается в том что на сегодня все эти техники имплементировать до неприличия сложно и вот как раз сито обещает нам вроде как дать некий стандартный способ которым относительно просто будет пользоваться при наличии вменяемый авто автоматизации для того чтобы эти вещи осуществить ну по крайней мере на сервер сайт тут хочется сделать небольшое отступление важное концептуальное отступление есть люди очень уважаемый например марк берджесс автор такое сын джон и марк бернес сейфе джон это первый конфигурационный инструмент который собственно предвосхитил появление по 5 шефа ansi было все то что мы благополучно начинаем потери вот сегодня но в любом случае это то что очень сильно повлияло на то как мы сегодня управляемой ти системами его идеи и вот марк берджесс и другие люди говорят о том что вообще сервисная сеть не является правильным способом решения всех тех проблем которые предлагает решить они говорят что это нарушает сквозной принцип построения компьютерных сетей потому что это делает сети слишком умными таким образом наша прекрасная распределенная система превращается обратно в монолит потом его будет очень сложно менять потому что любое изменение системы потребует изменений в сети это создаст бутылочное горлышко все закончится плохо сторонники сервисного сито с другой стороны говорят что это может быть верно но на нынешний момент факт состоит в том что количество сложности по краям сети то есть самих по себе приложениях он настолько высок когнитивная нагрузка на разрыва в котором нужно поддерживать техники устойчивости наблюдаемость безопасности прочее своих приложениях настолько высока что пришло уже время спустить часть этой сложности в нижние слои в умную платформу это вот видение умной платформы желание того чтобы наконец появилась она она не отпускает над последние несколько десятков лет и по большому счету что сервис что сервисная сеть это все об этом а правда на мой взгляд она где-то посередине то есть нужно вам это или нет зависит конечно от вашей организационный ситуации оттавой технической экспертизы которые у вас на данный момент есть от того вообще чувствуете ли вы тем более которые сито вам позволит решать и насколько вы можете их решать силами разработчиков или силами инфраструктуры ну и если вы все-таки подумав над всем этим решили что сито вам зачем-то нужна возникает вопрос какое сито брать также давайте посмотрим что же нам предлагает бешено клокочущей рынок что лежит на полках начнем с эссе о котором мы уже говорили до нынешнего момента из тебя все еще является эталонной реализацией того что сито может нам дать наиболее широкий набор функционала и это не всегда хорошо если умеет делать такие вещи которые не умеют делать вообще фактически никто например как пример izeo.ru рафтинга в амазоне то есть другими способами это можно сделать но очень очень сложно estel как мы уже говорили вроде как не привязана к оберните со вроде как поддерживает гибридные конфигурации на деле сделать это достаточно сложно в качестве прокси коляски истину началась первыми начали использовать он бой и это стало уже де-факто стандартом по индустрии пожалуй единственный кто не использует онлай в качестве прокси коляски и делают это осознанно это линьки rdio которых через минутку и стю известно проблемами перформанса многие из которых связаны с архитектурными решениями которые были приняты на заре проекта в основном речь идет конечно же а миксере компоненте который сидит посреди и стью и отвечает за сбор телеметрии и определение по лисиц и через него по сути дела проходят все вызовы архитекторы есть осознают проблему уже есть предложение бета-версия решения этой проблемы который называется миксер вид 2 суть решение заключается в том что те самые фильтры которые накладываются на трафик на нынешнего на миксере будут компилироваться в виде модулей в бассем ли спускаться прямо на коляске и запускаться там самих по себе сайт корр праксис решение технологически несомненно очень интересная насколько она масштабируемая и к чему это приведет и не приведет ли это к тому что у нас сдуются прокси до такой степени что им будет вообще невозможно пользоваться пока мы точно не знаем из известна своей сложностью постепенно сейчас идет работа по снижению сложности известно что есть одна версия 13 устанавливала больше 50 ардис на каждый из наших кластеров версии 13 наконец часть целых 30 штук сервис оказались ненужными были выброшены на свалку части зови сложности вызвано высокой модуляр насти из то есть если само по себе микро сервисная система у него много разных модулей это его слабость и его сила потому что по большому счету можно установить только кусочек ести только с тем функционалом который нам нужно все остальное не устанавливать или установить потом когда мы наконец поймем что и мы тоже хотим пользоваться с точки зрения сбора telemetry из тебя поддерживает стандарт and racing через адаптеры на миксере и конечно же интеграция с про метиса который можно было бы и не говорить сегодня это делают все наиболее интересный пожалуй на нынешний момент конкурент из тела это linker де тут следует во первых заметить что компания баян стоящая за linker д это первопроходцы идеи сервисного сито словосочетание сервис мир впервые была придумана их продуктами применила было к проекту linker дик кто знаком с linker devil первая версия ok у ленки rdi успело сложиться не плохая слава среди некоторого количества инженеров суть проблемы linker div первой версии состояла в том что он вырос из клубный тип но не в том виде в котором мы его знаем сегодня он появился до кубер не tissot он был основан на twitter of sky библиотеки финал то есть он пришел из мира j в.н. сам по себе он был написан на скале идеи сервисного сито появились именно там но с точки зрения перформанса который мы ожидаем от сайт корр контейнера он не давал ожидаемых результатов поэтому компания боинг ощутив эту боль переписали linker де сначала пытались назвать его кондуит поняли что это не работает вернулись к названию которой уже была известна на рынке назвали и валенки рдд-20 тоже создает определенную путаницу но как бы то ни было что они сделали они во-первых сказали мы будем поддерживать только куб нас не интересует вся эта история про гетерогенное окружении мы хотим делать то что мы делаем для куба но делать это лучше всех ну и соответственно поэтому они решили написать свой собственный прокси хотя есть слухи что они решили написать свой собственный прокси потому что это были ребята которые вышли из twitter точно также как оттуда вышел мат клайн создатель онго я и когда их спросили почему они не хотят пользоваться анвар в качестве сайт корр прокси они сказали что мат клайн и мне нравится как человека они не хотят пользоваться его кодом вот такая вот история о том как человеческие взаимоотношения влияют на технологические решения очень часто так вот их прокси написан на расти языке который нам дает очень эффективную работу с памятью безопасность работы с памятью и обещает нам перформанс даже лучше чем с пласт класс на котором написано on вой и за счет того как говорят создатели linker здесь что они их не интересуют все другие сценарии кроме кубер найти со они имеют возможность отбросить все то не нужно и что делает on вой и обещают нам гораздо более высокую производительность не только обещают как мы увидим на примере бенчмарков микрофоном они еще и выполняют свои обещания вообще на знамени linker де начертано четыре принципа простота устойчивость безопасность и наблюдаемость они говорят вот эти четыре вещи мы вам дадим вообще без всякой конфигурации просто установили и получили поэтому они дают нам встроенную телеметрия установка linker де уже приходят с прометеем который от конфигурировал внимательно сохранять минимальное количество данных для того чтобы никак не влиять на производительность хотя можно и перри конфигурировать и чтобы хранить больше данных ну это дает хорошие результаты и дает нам простоту в обращении оставили не замечаем начинаем собирать телеметрию далее хэш карповский консул кто использует консул использовал раньше ну да много рок как ожидаемо испытанный боем инструмент прошел немало реинкарнации сначала это был просто ки вылью 100р потом это оказалось сервис discovery теперь у него вырос хвостик виде connect и оказалось что он у нас теперь сервис мышь опять же достоинства то что он уже испытан боем немало багов отловлено многие люди умеют им пользоваться поддерживает соответственно поскольку он не вырос осквернить из это он поддерживает разнообразное окружении вот мы как раз тут разговариваю с эриком о том что консул поддерживает даже все что бежит на windows и таким образом это его выделяет из всех остальных в качестве прокси коляски он тоже пользуется ангар для того чтобы не изобретать колесо вместо яму о котором обычно мы конфигурируем прочие сито можно воспользоваться из целом если с вашей точки зрения это преимущество то что я могу об этом сказать но кому что нравится я стараюсь никого не судить телеметрия собирается напрямую с проксей сам по себе консул нам не дает этой возможности поэтому для того чтобы собирать теле метры нам нужно добавляется на трещины на наши объекты тоже не супер удобно да то есть что-то конфигурируется из села мачта то нужно все-таки прописывать ям ли не идеально но опять же если вы все-таки уже пользуетесь консулом уже является частью вашего стаккато стоит посмотреть на их решение с точки зрения поддержки сэма и они поддерживают только трафик акциз api а во всех остальных они отзываются очень положительно потому что они фигурируют на том слайде который мы увидели в начале но пока не очень понятно что происходит с поддержкой всех остальных актов теперь это новички компания контейнер с производители балансировщика трейси кто пользуется трафик ok гораздо меньше людей чем тех кто пользуется консулом и понятно они будут по свежей да по новее так вот они не заморачиваются поддержкой всего на свете говорят мы работаем только на кубе в качестве прокси понятное дело мы используем трафик в общем-то все это опять же выглядит как просто сказать у нас есть прокси давайте пользоваться им для создания сито поскольку трафик написан на кошечки они на си плюс плюс и не нарастит а понятное дело такого перформанса он нам обещать не может в качестве сайт корр прокси он подходит не очень поэтому умеешь пошли по другому пути они говорят мы будем без колясок вместо коляски внутри каждого пода у нас будет агент который сидит на каждый из нот и таким образом мы будем осуществлять все соединение через него кому-то это подход даже может понравиться потому что вот это вот впендюриваешь колясок каждый под но она действительно как-то ощущается так немножко тяжеловесно в целом да вот как же наши самостоятельные под и вдруг них теперь везде коляски как же они меня вдруг коляска сломается как же нибудь без нее обходиться лишь говорит на шоссе это полностью прозрачна в этом смысле а кстати они поддерживают самая полная поддержка и самой находится как раз в мышь конфигурируется он при помощи аннотаций на объектах кубер не tissot кому то нравится кому то нет но и вот по поводу прозрачности то есть по большому счету из за того что у нас нету колясок они говорят следующее мы вы можете продолжать пользоваться каберне сам как будто никакого сито и нет хоть с другой стены slim продолжаем это делать то зачем она нам вообще нужно но если вы хотите пользоваться сетом вы просто должны будете обращаться к новым адресом и вот вы должны быть обращаться к сервисам по новому имени которая по их fq дену который будет имя сервиса именно им space а и в конце волшебное слово меж не очень элегантное решение я не для того стал пользоваться купюрница сама его сервис discovery чтобы обращаться к другим сервисам по f1 но в любом случае зато можно без колясок обходиться ну и наконец последний наш претендент и так ума от компании kong они сразу говорят у нас универсальная сервисная сеть это просто таки вселенское сервисная сито который можно запускать где угодно в качестве прокси коляски используется все тот же самый on вой тут вообще стоит сказать о том что конга они же производителя офигеет в которой основан вообще на чем на engine.exe окей поэтому все это выглядит так как будто бы просто вот они решили что им они делают enterprise api gateway видимо энтерпрайза стали спрашивать их про сета и они пошли быстренько написали контроль plain для n go который вообще контроль план лианга это последнее время выглядит как очень популярная тема для хобби проекта на новый кент их сито как я рассказал вселенское универсальная не привязана к оберните sony привязанная к самой не привязана я фактически ни к чему кроме вы иконок но и в общем то основной упор они делают не поддержку энтерпрайза в общем и целом по документации и потому как это ощущается на нынешний момент всё это выглядит как скорее маркетинговая стратегия основанная на сервисном city я могу быть не прав я могу ошибаться если так я заранее приношу свои извинения ну и наконец все это вся эта история получила интересное развитие в виде одного из самых свежих проектов сеянцев который называется network service мышь или сетевое сервисная сито о чем это а это о том что все существующие сета на которые мы сами до сих пор это прикладные сервисные они позволяют сервисом общаться внутри одного кластера да есть уже решение которое говорят вот так мы будем запускать разные сито в разных кластерах и увязывать их в одно каждый из сид дает какое-то решение пока что все эти решения работают кривовато вот а все больше растет понимание того что облака это не все что у нас есть у нас есть еще девайс и он по большому счету интернет вещей начинает окружать нас все сильнее и вот об этом этот проект он говорит о том что во первых нам уже становится понятно что нам необходимо поддерживать гибридный сценарии и необходимых поддерживать по-настоящему они так как нам обещают все эти сервисные сито которые это делают как некую при шлюпку чтобы защититься от привязки кубер не tissue сэм позволяет нам соединять контейнеры в разных кластерах позволяет нам поддерживать экзотические протокол и потому что весь все управление трафика нам спускается еще на уровень ниже то есть если в сервисных ситов в остальных мы управляем трафиком на l3 и l4 с заходом наверх в прикладные слои то здесь все спускается на второй третий уровень и таким образом становится возможным поддерживать из коробки тоннели можно осуществлять динамическую локацию интерфейса для того чтобы общаться с разными очень экзотическими девайсами снаружи и в целом можно сказать что нсм это проект который призван нам дать возможность осуществить то что называется network фанкшн виртуализация для которого до нынешнего момента чаще всего использовался openstack опыт так как мы все знаем потихоньку умирает нам нужен ответ который будет клауд не тиф и вот попыткой такого ответа видимо является нсм проект набирает обороты очень-очень быстро уже вот на ближайшем кьюб кан сан диего будет специальное ответвление под названием нсм con посвященный только этому проекту кстати там же пройдет первый сервис мышка он так что все о чем мы здесь с вами разговариваем это очень горячий что конечно же при выборе сито не последним фактором является эко-система она тоже растет и множится тут стоит особо обратить внимание на компанию соло которые являются во-первых одним из инициаторов сервис ваш интерфейс а во-вторых автором целой линейки инструментов которые посвящены работе с разными видами сид главным из которых несомненно является супер glu проект который позволяет нам во первых увязать установить от конфигурировать основные сеты а не поддерживает на нынешний момент консул linker diy still i am a зоновский appcache установить на него всякие примочки часть из которых тоже приходит от компании соло все проекты open source в у них достаточно неплохое комьюнити но поскольку проекта разрабатывается одной компанией ступить поучаствовать этот проект и становится немножко сложно например наш пол request висит уже больше чем полторы недели потому что сломался я и конвейер и ни у кого в компании нет времени на него посмотреть кроме этого конечно же хочется пропиарить сообщество li.ru five частью которого я являюсь сообщества полностью открытая и open source avaya целями своими она ставит во-первых некое создание описание ландшафта вот этих вот технологий то что я здесь пытаюсь делать и сравнительный анализ а также создание какого-то софта который позволит во-первых сдать нам песочницу в которой сисечками можно поиграться во вторых запуска сравнительных анализов бенчмарков между разными видами сид этому посвящен проект программный продукт сообщества под названием мишари logo которого мы видим вот здесь сообщества молодой а там дико не хватает сильных инженерных ресурсов так что если вас это интересует не только как пользователей присоединяйтесь там реально поможет ваш вклад из-за того что сообщество такой открытый молодой там публикуется буквально за два-три дня так что присоединяйтесь поднимайте свою инженерную карму кроме этого уэсти а как у самого популярного всех сет есть своя экосистема со своей организации в гитхабе тут среди проектов которые есть там особенно хочется отметить адмирал который решает проблему увязки сид разных кластерах в одно сито а также проекте под названием дин с discovery от наших приятелей с компанией тухин который показывает как можно интегрировать ну даже не совсем сито а игр с контроль кистью с интеграционными тесто тестами дело в том что то что происходило с из тела до версии 10 когда вы устанавливаете а вы вдруг с удивлением понимали что ваши сервисы не могут достучатся наружу потому что весь трафик проходил через игры сгорит твой из тела игры сгорит вывести закрывал все нафиг и для того чтобы получить доступ наружу нужно конфигурировать сервис-центре для каждого каждого адреса на который мы хотели обратиться поскольку людям это очень сильно мешала проекта из тела начиная с версии 11 открыл все полностью и таким образом сделал в общем то игра с контроля и стива полностью бесполезным вот для того чтобы всего этого не происходило ребята из компании то финн поскольку они занимаются security построили продукт который позволяет во время запуска интеграционных тестов отследить все обращения наружу которые происходят из всех мест вашей системы и автоматически сконфигурировать игры с gate вы и сил для того чтобы потом знать как его конфигурировать в продакшене производить одитинг всех этих конфигураций и так далее то есть вот ещё один пример такого любопытного использования истин далее по поводу того сколько нам это будет стоить с точки зрения производительности системы компания боинг в желании доказать что ленин terre di лучше чем истец заказали независимой компании keen волк сравнительный анализ между линекер 9 кен волк серьезно подошли к делу они не только провели сравнительный анализ но еще и построили целый целый набор инструментов для осуществления таких анализов в будущем опубликовали его на гитхабе и опубликовали результаты своего исследования на который мы сейчас посмотрим а также конечно же layer five о котором я уже говорил мы тоже там занимаемся сейчас созданием спецификации вот такого вот бенчмаркинга хотя кен волка конечно уже убежали вперед так вот вот результаты сравнительного анализа между linker де и estel estel тут присутствует двух конфигурациях потому что в первый раз они выглядели очень плохо поэтому архитектор есть рассказали что вы неправильно от конфигурировал есть давайте кого-то конфигурируете его так и запустите еще раз разные конфигурации если здесь отмечены светло голубым и синим мы видим что конфигурация не очень сильно помогла помогла только в некоторых случаях аллен кирби здесь отмечет светло-зеленым цветом даже не вдаваясь подробности видно что rinker де бьет из тела фактически по всем параметрам производительности по всем параметрам кроме мощи маркетинговая машина которая стоит за их спинами и ну соответственно таким образом популярности проекта и размеры сообщество все это немаловажно далее все дальше становится понятно что сито без автоматизации по большому счету не очень-то и полезно потому что разрабы плохо переваривают яму кто его хорошо переваривает но есть люди которым приходится с ним все равно общаться и вот если например этим занимаются devops и админы инфраструктур щеки то мы опять получаем та самая бутылочное горлышко о котором нас предупреждал devops чтобы этого не происходило нам необходимо как-то автоматизировать те штуки которые происходят в сети для того чтобы создать ту самую умную платформу которая наконец дает даст нам возможность быть продуктивными тут стоит обратить внимание на проект flogger от компании works который позволяет это по большому счету более зрелая имплементация тех идей которые показывал в прошлом году со своим не доделан недопиленный птицы смотром да это более зрелый продукт он поддерживает уже разные виды ситы linker diy консул и из тела и по моему даже и добрее sap меж хотят там тоже достаточно все непросто потому что разрабатывать его по большому счету один человек а сколько уже может сделать один человек кроме этого есть тоже любопытный инструмент от компании соло который нравится глушат который позволяет нам и описывать и запускать разнообразные сценарии тестированию конфигурации сид по принципу how снова тестирования поскольку мы тебе перехватываем весь трафик то эти вещи становятся гораздо более простыми на него тоже стоит посмотреть кроме этого как я уже говорил умная платформа и сервер лес и сервис меж это все о том же самом поэтому сервисная сета становится неотъемлемой частью любых видов имплементации подхода без серверных вычислений на базе кубер не tissot если неотъемлемая часть kane & tiff от гугла linker де вошел в так называемый planks так это prometheus linker диап infos nazik uber не this is nick украине тиф от гугла linker diy все остальное других кто выиграет как вы думаете чему научил нас история ну посмотрим итак предположим после всего о чем я вам рассказал вы решили что сито вам зачем-то нужна возможно коза у вас не достаточно веселая возможно у нее отрасли какие-никакие руки что мы делаем до чему научил нас небольшой опыт внедрение сид в разных организациях ну во-первых имеет смысл начать шлюзов если они у вас уже есть то может быть имеет смысл попробовать перейти на что-нибудь основанное на двое для того чтобы понять как работать с современными динамичными pro grip программируемым прокси который дает нам такие вещи как горячие рестарты и прочие штуки потом когда мы научились работать с этими шлюза а какие варианты там есть есть во первых гну от той же компании соло есть ambassador есть сам по себе энгр из gate вы из тела который можно установить и пользоваться только им потом можно начать впихивать везде коляски но сначала ставить их на полный байпас ничего не контролировать просто собирать телеметрию и смотреть что нам дает это наблюдаемость нашего трафика что она нам рассказывает о том это как раз неплохой момент попробовать начать что-то конфигурировать вносить некий хаос систему и смотреть как это на нее влияет для этого можно воспользоваться blue шо-то котором я рассказывал поскольку каждой оси это дает нам возможность не включать его сразу по всему кластера ограничить это все одним namespace он то можно сделать это сначала грубить в одном на экспрессе и посмотреть что будет это неплохой момент задуматься о таких вещах как авторизация синдикация как сито будет со всем этим вместе сотрудничать каким сертификатов орете вы будете пользоваться как вносить изменения в сито кто это будет делать как решать проблемы когда в сети что-то засорилась очень важный вопрос как вы будете делать апгрейт сам брэдом из тебя уже было немало очень грустных историй если вы решили все эти проблемы можно раскатываться на целый кластер если мы раскатились на целый кластер то что же нас теперь останавливая весь мир одно большое сито мы видим что в этом наше будущее так что вперед давайте просеивать трафик спасибо спасибо большой антону у нас есть чуть-чуть времени 10 минут у нас есть много интересных вопросов опять же то что мы успеем мы зададим сейчас дальше у нас есть дискуссионная зона для продолжения дискуссии и я думаю что мы можем начать стать их но мы пропустим вот это все ой название плохое почему сито и так далее просто потому что как бы мы уже выиграли она уже у нас в сердце в документацию но тем ни менее да но тем не менее все равно есть хорошие такие трудные вопросы вот например есть ощущение что сервис мышь есть не что иное как реинкарнация старый добрый enterprise service бас архитектуры есть я об этом говорил в прошлом году как бы основное отличие которой мы говорим что сервис мышь не содержит все бизнес-логики то есть большому счету единственная часть бизнес лайки это можем все что связано с policy и даже это не обязательно там делать вот как бы сервер дает нам возможность минимизировать количество ума которые мы туда вкладываем но понятное дело что когда у нас появляется возможность напихать куда-то сложность то мы это сделаем да тут несомненно есть опасность собственно с происходило то же самое да да да именно об этом говорит марк бернес ничто не ново под луной я наверное вообще вот эти вот как бы люди они говорят о следующем надо быть очень дисциплинированным когда мы строим систему как бы определять но эти люди не очень много общались с людьми я так подозреваю вот мы знаем как правильно а берет свое так и есть да вот вопрос чем сына и лучше кинете мне кажется это немножко затронул может быть ты хочешь что-то добавить чем что новый новый спик а сэма и лучше чем когда да ну как бы это разные вещи сама это просто speck это определение того как выглядит api для того чтобы большом же как работает и сымай это по большому счету ciare диски для них потом пишут адаптеры которые читают то что написано в этих сердер шкаф переходит переводит их на язык который понимает та или иная сета и конфигурирует сито кейн этих это серверная платформа для кубер не tissot которая использует есть внутри не пользуется да ну и пару вопросов на по сравнению значит дух лидеров link or die и если значит действительно ли каждый январь сайт карт требует под себя 512 мегабайт памяти это так это так соответственно планируйте свои ресурсы и соответственно и финансовые тоже и уяснил есть проблемы запуска набор металл для этого нужно установить металлургии но последний тоже есть проблемы сплошные проблемы как у этого слинки rdi сбер metal у есть это интересный вопрос дело в том что металл лбы нужно устанавливать если мы хотим контролировать при помощи есть трафик юг-север исходящий трафик для того чтобы контролировать трафик в между сервисами есть больше ничего не нужно linker де просто не решает эту проблему не к клинкер дени занимается энгр из игры с трафиком поэтому только запад-восток поэтому металла убитом не нужен да хорошо еще вопрос насчет то бенчмарков если бич марки не сравнительное одной из тела с другому а сравнительно sti без сито иссита если на самом деле на слайдах кен волка там первое сравнение они дают желтый цвет это без это вообще понятное дело что любое сито нам чего-то стоит бесплатных завтраков не бывает да стоит ну как собственно любая библиотека которую мы в пюре мы начнем как-то контролировать трафик нам будет точно так же стоить чего-то большому счету если вы делаете управляете трафиком при помощи библиотек тех же самое там финна главке стрекозов всего остального у вас тоже есть тоже чего-то стоит другой подход ну да и вот в продолжении не не логично ли было бы реализовать вот эти вот сервис смешные вещи именно в сетевом слое то есть куб рапси и так далее вместо все на и вместо того чтобы фигачить везде коляски это можно во первых сделать делает контроль совсем прям совсем централизованным и вроде как при колясках все еще каждый под становится в некотором смысле автономным и у нас может полететь 1 коляска но не слетает все сито да потому что все таки с централизованных компонент распределяются вот эти вот конфигурации и в тот момент когда вы себя есть вот это вот отвязка так которая в каберне тебя если мозг номер-то руки-ноги продолжают функционировать таким же образом тоже преимущественно нынешний момент есть вести если это сделать ну так как например это делать тот же самый меж который горит мы без колясок то там если умер мозг то как бы и всем остальным становится плохо но они отказались от этого сказав что вообще вы пользуетесь другими именами и тогда у вас все будет хорошо непонятно как сказать сервиса только чтобы он перестал пользоваться другими именами если они не отвечают да много новых вопросов ну хорош и интересные дроидов и еще наверно пару вопросов мы успеем как на твой взгляд самый простой способ организовать обзор вами лети всего трафика и каким инструментом лучше всего воспользоваться смысле из сип на верными ну конечно естественно ну linker действительно самый простой способ как бы реально действительно он работает из коробки и дает все что нужно и и действительно дает хорошую производительность единственная проблема с linker диета опять та же самая проблема что они идут как давид который вышел против голиафа но только что не очень понятно если у него в руках нормальная праща да не порвется ли резинка хорошо как у нас безопасностью в принципе вот в сервис мышек дела обстоят обстоят ну внутри как правило хорошо выясню например безопасность это opt-in то есть можно установить без blinker де наоборот это опыта у то есть бы дефолту мы устанавливаем сразу intel с и все сервисы начинают общаться безопасно дальше возникает вопрос того что происходит если у нас уже сервисы общаются а безопасно но то что происходит на самом то деле просто поскольку прокси не могут распаковать этот трафик то они просто ничего с ними не делают они пропускают через себя как как зашифрованный трафик ну то есть по большому счету все становится лучше можно с точки зрения разрабов об этом не думать с точки зрения общения между сервисами мы получаем фактически intel и за бесплатно возникают вопросы когда мы начинаем вдруг из сервисов внутри обращаться наружу пользуемся одним и тем же серии или нет вот там вот тоже возникают всякие затыки cigar this hard просто не будет если вот внутри ну тут тоже возникает вопрос есть люди которые горят а зачем нам вообще нужно делать внутри это паранойя если кто-то забрался внутрь системы нам уже это другая история уже я думаю что в 2019 году спорить перемен тросик your периметру достаточный линетт уже как-то ну поздно да поздно уже все уже все внутри да вот последний вопрос и дальше может быть как то мы подойдем к самому главному выводу этого этого доклада насколько сравнимы в принципе linker diy из тела и в общем то но если они настолько разные может быть это сравнивать не имеет смысла они сравнимы потому что они дают а не делал то что мы частично маленькие дает собс от того что увидел то есть вести уметь делать очень много всякого разного чего не умеет делать никто но за это нужно очень серьезно заплатить большим количеством сложностей linker 2 говорит мы умеем делать меньше если вам нужно это то вы можете просто другой сегмент я думаю что вот можно как-то подвести итоги сказать что очень тонул я правильно понял что мы болеем за linker де в этой борьбе в некотором смысле да просто их аргументы они очень для инженера действительно убедительны то есть даже вот как бы пытаясь смотреть на все это объективно поговорив я поговорил с уильямом который seo баян той но он действительно говорит очень вменяемые вещи с точки зрения инженерного сознания что произойдет дальше слинки rdi не очень понятно я думаю что их главная надежда это то что их кто-то большой купит и будет толкать дальше потому что иначе есть все шансы чтобы задушить ну будем надеяться что не задушат anthem спасибо большое это было прекрасно"
}