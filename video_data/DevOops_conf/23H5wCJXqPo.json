{
  "video_id": "23H5wCJXqPo",
  "channel": "DevOops_conf",
  "title": "Виктор Гамов — Kafka на Kubernetes: история создания облачной платформы поточной обработки данных",
  "views": 2165,
  "duration": 2935,
  "published": "2019-07-01T07:08:42-07:00",
  "text": "я работаю в компании confront и мы пилим кафку в ее различных исполнениях и что важно в этом некров к единой да то есть мы пилим не только кафку но мы пилим то что мы называем streaming платформа по-русски вольный перевод это платформа обработки потоковых данных это никакого отношения к streaming video олег streaming audio не имеет это когда ваши данные бегут каким-то единым потоком и вот новое слово давайте тоже ssd тренд да девка в коп стать люди которые кафку production есть такие звезды афк афк афк aux abs о отлично замечать я нашел своих людей кто знает вот эта мужика отец так сказать даже не то что отец а вот не то чтоб он он стоял и принимал этого ребеночка кубер нити сада он не совсем отец но присутствовал келси хайтауэр очень efini найти дядька очень топит за всякое такое убираете суд видите какую-то количество ретвитов просто там чудовищное значит что он говорит что он вали давайте прочитаем что за последнее время кубер нить из стал совершенно замечательный ту лом и много всего улучшилась для того чтобы держать так называемый street workout то есть предложения которые должны сохраняться после рестарта тех иных кодов до дикое количество ретвитов но важный момент он такой немножко api не найдет как я уже сказал и еще в добавок вот еще некоторые апеннины технологий люди пришли пожалуй присаживайтесь не мешайте проводить конференцию да значит что он говорит что он говорит дебоширы пришли какие что он говорит что я лично steel пришел на ту ван дамм он кубер нить из это очень важно потому что следующим твитам он объясняет что не то чтобы купить из не может я не могу то есть опять же проблема то что они технологии идеально люди не совсем и я сегодня буду вам показывать как я могу давайте сейчас быстренько прервёмся я могу да я вам покажу как я сейчас сейчас за тепло и как буковку вот давайте посмотрим вот у меня бежит где-то гугла claude мой мои этот класс так давайте посмотрим сколько там у нас нодов и значит к это мой курсе дел сокращал когда ну берут какие-то но ты много много компьютеров я могу сказать вот так могу сказать вот так вот инсталируй вот так вот инсталируй кафка replicas 3 получится не получится давайте запустим посмотрим оставим вот так вернемся через некоторое время посмотрим что получилось нет там всё нормально мы потом об этом посмотрим что то вот приблизительно я со подтверждает что подтверждает опрос который мы провели в чатике в telegram канале у кафки в telegram канале 2 что это клево давайте запускать а вот энтузиазму сразу поубавилось когда мы говорим про какие-то стоят ли на самом деле это достаточно сложно и с точки зрения просто какого-то опыта да то есть никто не хочет там тренироваться на кошках никто не хочет быть первым поэтому опыт становится здесь важным аспектом человеческий фактор становится важным аспектом значит давайте поговорим почему это важно для нас собственно почему это важно для вас я уже понял дату стиль люди которые подняли руки которые сомневаются запускать это не запускать во первых для нас это важно потому что мы делаем стримлю платформу что такое streaming форму о чем вообще речь вот кто-нибудь в своем предприятии представляет вот такое ну да здесь так хорошо начну здесь происходит да как как система как предприятие как человеческая система она строится на различных потоков инфо токах информации взаимодействия потоков информации но и заканчивается тем что в этом подразделений у нас своя база данных в этом подразделении своя база данных эти данные откуда надо перекачивать кто-то додумался написал и пиарить из дерева через заперта додумался где получил прямое подключение база данных и вытягивают их оттуда и причем вот такая вот система она как убить она слоеное разные уровни ответов да например если мы требовали про в приложении там требуется там быстрый ответ если мы говорим про какие-то data warehouse мы там уже все немножко медленнее и значит когда вы приходите к своему наблюдать архитекторы слушали расскажи а вот как на получаете данной и он начинает тебе рассказывать всю историю группы нам что он долго работаю в компании он расскажет все как было все как есть и как будет твое будущее и так далее и вот витте зоопарк всяческих идей вот такой такую ситуацию мы пытаемся как бы изменить ну да мы там приносим свою какую-то выпрямлялся вот этих проводов ребят проходить садить вместо мест полно вот здесь можно прям в первый ряд сесть и мы вдумаемся да действительно мы должны построить какую-то платформу которая позволяет людям обмениваться различным системам обмениваться эта информация и мы будем говорить сегодня не только кратко как кафка потому что она является ядром все этой платформы она является непосредственным главным моментом но также мы будем прыгать другие элементы которые будут связан непосредственно дипломе то значит кафка была придумана в lingq и не для решения одной простой задачи нужно было побыстрее ускорить in jest данных hadoop и чтобы как это решить и в теперь как-то не помогал и вот они придумали как-то вот по кусочкам эти данные передавать в кафку кафка начала был пыток иметь популярностью поэтому те люди которые придумали и в ленты не они думают ну хорошо давайте попробуем бабла на этом как-то сварить и они основали компанию где мы где работают в конфе и начали строить у так называемую стриминга платформу которая будет сердце ваша организация которая будет позволять супер фоточка отлично погнали кафка значит тыковка само по себе это такая штука которая пишет всего в файл по сути дела это большой набор файлов причем файлов такого рода что пишем постоянно в конец файла это важно потому что я потом еще объясню все это дело размазано по множеством кластером это размазано по множество машин более того кафка было бы не кафкой если бы на или оно пришло из мира big data и если инструмент пришел из мира big data как мы узнаем что он умер беда ты там есть звуки пир правильно барак спасибо вот задается есть звуки пир закипит тоже распределенная система и тоже хранит данные где-то хранить файлах и это тоже важно потому что в каких внуки перри хранится важной информации о распределении пар тишина вы он использует закипит чтобы выбирать лидеров и так далее и тому подобное то есть много всякий интерес информации в принципе в теории она может кафка просуществовать какое-то время с выключенным звуки perm но уж не надо очень сильно зависит да как мы работаем наше приложение пишут в кафку читает из кафки с помощью различного нативного пья мы пишем продюсером читаем консьюмер также для того чтобы вот помощь вот это болото с петрушкой соус с соплями с лапшой почему это происходит потому что все изобретают какую-то свой формат данных все изобретают свои свойства описания схем и наша схема хранится в схема речи стве эта часть нашей платформы которые осуществляется данной схеме попадают схема registry данные от данных попадают в кафку но тот еще интересная особенность такая что в принципе неплохо было бы обойтись без каких-то дпн досидо поэтому с кем речь если используют кафку в дочках хранилище с одной стороны она дает папу лично интерфейс чтобы взаимодействие с этими схемами с другой стороны она хранится это дело внутри кафки дальше есть также фреймворк который позволяет писать и обработку этих сообщений мы сегодня не будем нанес concentrate называется кафка с римскими дальше чтобы данные от куда переносить вот помните у нас базы данных у всех приблизительно одни и те же базы данных потому что их можно на пальцах перечесть которые люди используют одни и те же похожие системы хранилище и так далее поэтому не надо изобретать велосипед и каждый раз писать какую-то приложение которое будет данной перекачивает отсюда для этих целей есть кафка connect который предоставляет фреймворк для написания вот этих замечательных коннекторов значит он тоже пишет все читает все из кафки есть ещё люди которые любят писать в кафку карлом например есть такие супер а знаете на самом деле нормальная идея да есть вполне себе нормальный интерфейс выборгский да и надо как-то образом туда писать и читать поэтому раз прокси для этой цели существует он позволяет писать в кафку тем языком на которых нет нативно клиентов ну таких дисков очень сложно найти сейчас вот вот это приблизительно будет представлять наш нашу стриме новую платформу но как бы главное главное у нас это минимум который мы должны запустить минимум опять же чуть-чуть и для тех кто не знает нужно чуть-чуть ввести в кафку какая проблема опять же сейчас есть здесь или можно перемотать коротенько окей коротенькая капка предоставляет такой интерфейс который называется топик топик он размазан по множеством машин топике партиции раваны и вот эти партиции как раз хранятся на множестве машин это важно для обеспечения горизонтально искала бились с горизонтальной масштабируемости простите продюсеры пишут в определенный партий шин в зависимости от ключа если ключ не указан то он пишет паран дроби ну вот мы пишем все записывает все хорошо как мы читаем читаем мы таким же образом есть консьюмер и которые подписываются на определенный топик специальный конце специальный процесс который бежит внутри кашка брокер называется can sing you котроллер он распределяет эти партиции в топике между консьюмер и в консьюмер группе консьюмер и группируются в какую группу чтобы обеспечить горизонтальное масштабирование на чтение мы читаем тоже хотим читать достаточно быстро то есть что здесь происходит можно сказать похож на базу данных да действительно похоже на базу данных и и потому что есть партиции рования да есть и там конце весны fishing который позволяет найти как у партизан записать вот и вот это все дело тоже отважно есть репликация который позволяет данным не теряться если вдруг одна из нот упала до этого нормальная ситуация в определенном мире когда мы не говорим что ой там мы не можем предотвратить чтобы у нас там надо не потому не может поэтому нам надо уметь как-то выживать поэтому репликации спасает каждый парте шин имеет реплику можно настроить его при создании топика сколько реплика нужно создать поэтому ребята будут ходить на другой машине то есть здесь вы понимаете что сетевая как бы составляющая вот это все дело тоже важно как быстро будет происходить репликация 1 сломалась другая машина будет принимать на себя ответственность за то чтобы эту эту реплику так сказать выдавать все как бы здесь со своими платформой как бы определились дальше теперь мы думаем ok как нам теперь помогать людям во всем вот этом деле дату все начинают с монолитного приложения переходник micro сервисом запаковывать накрасился в докер а потом докер отправляют внутрь кубер не tissot чтобы все это делать бежала тоже замечательный вид тоже собрал отличное количество лайков я сделаю это за лайки как говорится что паковали всем и красиво если в 14 году 16 стал популярен докер теперь популярен кубер notice и задумались я не знаю как перевести слово backbone для русских ряда русской аудитории чтобы он звучал они не противно как позвоночник или хребет или что такое но это связующее звено который позволяет марка сервисом общаться купер нить из хорошо вот я так понимаю по аудитории мы много по запускали там всяких микро сервисов всяких замечательных веб-приложений до которые не хранят не какой-то тип в себя стоит а например общаются база данных который рядышком где-то бежит в них оберните сада когда мы знаем как ее там подкрутить под настройки так далее потому что хрену значит на кубе ранец происходит вот значит но мы считаем что если вы бежите выбери вашими красавица бегут там вам нужно этот бурбон для обмена потому что вы можете использовать кафку как система обмена сообщениями потому что она дает такой 5 до можно подписаться на какие-то изменений в топике также она позволяет некоторыми к чертям который были вот момент в дауне перечитать эту информацию симу не надо быть постоянно онлайн чтобы получить эту информацию то есть с одной стороны это похоже на маленьких систему но с определенной степенью дерби лить вот значит разобрались нам нужно кафку деплоить в купер нить из какие для этого нужны нам билдер блоки кстати давайте сделаем коротенький взгляд что-то там что-то поднялось и ничего не поднялось подожди у меня тут все сломалось должна была запустится кафка а не запустилась а я знаю мы сейчас вместе бы вам своим чинить вас спроси себя незачем а потому что могу зачем значит на зачем потому что потому что мы хотим мы хотите мы хотим иметь унифицированную возможность запускать на все в одном месте наши предложения бегут в кубер нить если не надо лепить вот этот самый огород сбоку сзади спереди и так далее этого нам не нужно это с точки зрения управляемости это с точки зрения какого-то контроля это неудобно и непрофессионально потому что начинается опять вот это вот вот это вот сопли ему рассказывает появляется дат архитектор как тут здесь база данных вот здесь hadoop вот здесь data warehouse и все такое нет такого пожалуйста стоит волос на чьи-то кубер нить из офигительная платформа не просто потому что там можно все на нем тепло и а еще под неё клево программировать потому что все построено на концепции пьян и вот здесь кстати как очень клево было написано что я говорю ай но мы то знаем что наш главный его это куб сидел да кстати опросик кто называет откуп сидел кто называет куб катал ну интересно а кто-то еще как называет куб control руки я не знаю это на любителя куб сиделку прятал прикольно потому что как бы ну приходит вот эта концепция этих стад да ну как бы вот вы знаете что у вас вы теперь больше не не у вас ваш сервер на ваши не животное теперь вы вы не дорожите мяу у вас стадо да если кому-то поплохело вы выкидываете вы статут к котлы зовут это вот как стадо короче мы общаемся с этим сервером есть специальное внутри базы данных который называется сиди в которой хранится эта информация и есть какие-то ноты которые вот и все это дело выполняют значит есть такая штука которая называется контроллер по сути дела контроль это вид и пиа я которая контролирует определенный ресурс к нему можно подписаться на определенные события определенного контроля и получать какую то пользу от этого дальше у нас есть коды интересная концепция почему у кудрина и this dish и или диплом все входы почему они не решили где правит просто контейнера потому что опять же очень и при на эти люди но не подумаю действительно а вот если мы не можем медь и мы не имеем возможности модифицировать под нам нужно каким-то образом влиять на его состояние до поэтому нам нужно как-то может быть тепло и еще один к нему рядышком под то что называется сайт карт или например специально ему давать ему под через которые могут общаться с внешним миром да то есть мы не хотим давать нашему контейнеру доступ он был запрограммирован работать на localhost ну вот так вот завернули и он ничего нельзя поменять ну то есть это было дав до 12 фактор applications и так далее ничего не гони контроля дальше будет ходить на локалхост коды делит контейнеры в пади вышивают в колхоз поэтому у вас будет момбаса door который собственно по сидит и слушает этот локалхосте уже делает что-то с внешним миром это тоже достаточно такой приятный поттер ну и как бы вы понимаете что знаете под это вот такая вот штучка которая тут все намешано и белое синяя и зеленая это наши коды значит как мы можем это все дело расширять мы берем такую концепцию к называется касмир создать унижен определение ресурса это такой способ как бы решили не пиарим спишь специальный контроллер который будет обслуживать все вызовы к этому ресурсу и делать что то желательно чтобы опять же наш юань курсе тел оставался оставался тем же что не надо было там какой-то свой tool еще приносить и так далее там подобно сторож важно потому что ну да мы пытаемся сделать какой то стоял систему нам нужно хранить нам нужны диски здесь такая концепция каспер систем болью мтс вы определяете как вот эти диски и потом вы отправляете такие как они называются заявки вот вы отправляйте заявки говорите сушки хочу 500 гигабайт диска и вам говорят а вот тебе потому что у меня нету столько и тогда-то обломаешься а если есть он тебе дает и это будет твой опять же как определить что это мои чтобы определить что это моё для этого не нужно определить стелса стыд full set это еще один вид и pr который дает нам две важные вещи он дает нам стоит full сетевой один titties and full network один из and soul диск оденете это означает что перезагрузки после перезапуске пода он а присобачить нам тот же самый диск и присвоит ему тот же самый тоже сами имя хоста не вот это вот там 6f а чего-то опишу 012 и так далее и все ну то есть я как бы мы можем вот этот доступ к этим как этим это можно выдать через так называемый сервисы и так далее и он очень подходит для того чтобы запускать кафку ну клево да нужным берем вот это все и начинаем deploy как диплом кто тепло и так уклад вам все остались в наших селениях еще до бойцы и старообрядцы кто тепло от холмам интересно я на самом деле не большой любитель и воды фильма или я мало и вообще все это все это как то все это как то странно и обещает что следующей версии холма будет хорошо да а что значит хорошо у нас появится язык программирования что можно на промерзать какой-то момент появится lua lua как вы можете вот прийти и рассказать у вас родители спросят ты программе стариком и затянула я не знаю наверно клёво наверное да а вот как я программист на скале да вот такой язык должен быть значит что такое hell быстро значит в текущей вариаций пока не поменялось ничего в home 3d поэтому это все хорошо подходит для chrome два два компонента один компонент сидит у вас на машинке на вашем компьютер на моем лаптопе сидит ваша миссия сервере называется hell эта утилитка которая ходит и общается с его сайт компонента которых 20 лет мы упаковываем наше приложение в так называемые чарты ну так я не буду объяснять тут морская тема тут эти держатели руля чарты определяет карту и так дале там подобно вы все это и так знаете значит что дает нам чат чар дает нам тим плате за чем бы шаблонизатор и и дает нам возможность модифицировать и тимплей туда модифицировать вот этот шаблон в момент выполнения например что дальше он берет это все дело при процессе и стравливают это теле router это отправляет на понимает распаковывает и это все выполняет внутри кубер не часа значит следующий момент мы хотим расширять мы хотим расширять но давайте поймем зачем значит что нам дает hell in hell нам дает возможность просто унифицировать наши наш дипломе мы взяли стандартные утилиты и мы взяли след facetime и взяли пир свистом волю мы мы все это за затем плате zero вали мы использовали тот самый и мод шток лейкерс да кто использует image to play this хэштег вело да мы знаем что на самом деле надо использовать правильную версию wot но тут возникает ситуация кафка например хочет чтобы hell например нам когда мы диплом новую версию она позволяет все это дело так rolling restart сделать да все это дело там перезапустить очень очень удобно все это работает каберне this на все это дело дает но в общем не задача кафку надо по особому перезапускать до в кафки есть специальный компонент специальный компонент брокера который называется контроллер этот контроллер на самом деле содержит себе всю информацию о кластере все что хранится звуки перри контроллер держит у себя в памяти потому что работать через кафку кафка брокером удобнее чем работать им каждый раз звуки переходить контроллер должен быть перезагружен последним как узнать что-то контроллер есть специальные пища которую нужно дергать и сказать да вот этот чувак контроллер его нужно последнюю очередь перезагружать вы делаете роль не старт вам нужно проверять каждый раз они стал ли вы там не поменялся ли контролем дальше репликация мы не хотим терять данные мы мы мы хотим чтобы как бы наши начальники спали спокойно потому что не буду спать спокойно густой спокойно они могут спать не спокойно если ему знать что данные могут потеряться поэтому репликация тоже важно мы должны погасили одну ноту мы посмотрели что привлекаться я прошла подняли новую ноту репликация прошла то есть есть логика логика эту логику знает человек один ну может быть группа вот эти девках cops эти люди которые знают как правильно надо варить кафку как именно держать как вы правильно пир стартовать какие мониторить ее параметры то есть и начинаем думать о кей как нам все это дело автоматизировать то есть нам нужно взять вот этого человека который сидит в дата-центре помните в великом малый там человек сидел где-то жил в дата-центре вот этого человека который менеджер кафку его нужно автоматизировать да ну потому что незаменимых людей нет поэтому должны работать роботы они человек то есть вот этот концепт человеческого оператора концепция вот эту алё петя были там вы надо кафку там обновить на колесах 2 вот поэтому эту концепцию нужно нужно загрузить в мозги нашего q памяти вот этот и пленки сидел мозгу вот эту информацию нужно принести в купер на эти чтобы купер нить и сделать за нас вот и поэтому вот этот концепция оператор стал популярны для различных программных продуктов которые требуют определенного вот этого подхода значит что будет писаться просто представляет оператор оператор это специальный контроллер который работает современную вида ресурсов что он позволяет делать всякие хитрые штуки потому что мы запрограммируем эти штуки в нем потому что это нормальный язык программирование того более того не обязательно писать на ногой есть люди которым гол противен и мерзок можно писать на что угодно потому что и пи ай по которому ходят все внутри кубер нить из джерси в принципе есть и специалисты которые на джаве пишут эти операторы внутри кубер натиском мы считаем а lua хороший вопрос наверно можно если ты сможешь разобрать жир 1000 пайлот в лоно верно можно вот ну как бы останется как бы вот знаете как написано и вот этим транслитом вот вроде как бы все понятно читать как-то неприятно вот также и вот если не написан не нога это я со своими инженер нужно сушить я а почему мы нажали там не напишем наш шкаф к на джаве все no ja aed но неприятно вот и значит он делает всякие штуки давайте сейчас быстренько поглядим что должно происходить устройствами просто подошло на экране видите я им сказал дружок дико заде плойка мне кафку а он не фиг тебе ничего не сказал но я то знаю что важный момент здесь это это зу гипер я же не сказал ему чтобы он поднял руки перу тоже поэтому сейчас и мы поднимем пара чтобы он запустился чтобы потом уже не тратили на это время в гипер обновим сейчас что-то вывалится естественно все асинхронно все бежит в облаках сейчас мы увидим как начнет подниматься звуки пер все хорошо теперь будет нам счастье мы продолжим значит какая история совсем эти звуки перу нужно диск закипел нужно стать full set который определяет количество нот нужен специальный маркер который скажет слушай понимаешь такое дело я в принципе сильно много ресурсов ниже но желательно со мной ничего рядом не запускай потому что если упадет будет плохо всем поэтому нужно определиться чтобы под на котором есть другой звуки пираньи не попали на одну физическую ноду потому что один звуки пир умрет ну как бы и ok но если 2 пир одновременно три юзуке перу могут одновременно нам нужно настраивать такую анти affinity политику которая позволяет размазывать звуки пары по по всему кластера ну это все клево да мы все сделали дальше за кибер запустили теперь кафку такая же петрушка кафка может быть добрее использовать тоже другие ноты для о санте affinity чтобы ничего другого вообще не бежала только один контейнер на котором лежит кафка интересный факт например в компании который вот эти для вк of cups и работают и в которой судя по флинт и не например у них все бежит на более или менее все приложения бегут на более менее стандартным железе к для кафки не заказывать специальные железы потому что они знают эта собака вот может жрать вот значит к чему мы пришли для начала значит я уже сказал что храм в принципе неплохо если мне ямал но что делать вот такие с дела значит первым шагом который мы вот приняли делать мы сделали deployment наши стриме платформы с помощью фирма что он отдает это такой просто берет стандартные имидже до который у нас доступна для всех кто может взять у нас лежат тоже в по фабрике мы берем эти имидже и просто напросто автоматизируем их с помощью холма да давайте поглядим на этот самый на ямал хотите я мог посмотреть клёво на давайте посмотрим чуть немножко яму на чьи-то где мой charts да значит что на собой представляют наши черты вот вам видно всем нет вот здесь сбоку нормально ну будет терпимый отряд я вижу что непал неплохо просто вам хотела сказать про чарты значит смотрите чарт это такой набор всего да то есть главный чарт у меня вот здесь лежит в корне и он говорит это вот типа can find open source км час лежит здесь и дальше все эти черты лежат у нас в папочке charts принципе одной командой деплоить вся платформа тепло и перди плойка вко тепло это эскимо речи строки сиквел сервер и всякие такие балалайке значит как выглядит все это дело опять же для тех кто это ни разу не видел может показаться немножко странно но ничего странного нет вот эти вот странные загогулины это тимплей тэгу тимплей который позволяет брать значение которые прописаны вот файлики в и льюс по сути дела не слышали которого меняете то есть вы указываете количество брокеров указывать как время живите не использует лаетесь да это как бы хороший хорошая практика теперь наш мукасан куда все это пишется самое важное мы указываем здесь что стоит full set тоже используют определенные persistent свалим где у нас все это дело вот самым прописываем тимплей так что запрашивать и так далее там подобно все это хорошо значит какой недостаток опять же вы можете это вот просто сейчас взят с деплоить и играться с этим будет работать и все будет прекрасно до того момента когда нужно там это все не подносить production потом делать то мониторинг и так далее там подобно монитор не кстати тоже работает здесь использую parameters просто-напросто эти коды отдают информацию через джеймс экспортер и это джеймс экспортер прометея находит через через лайбо дату который прописан в аннотации кстати о прометее руси чтобы задефать parameters мы пишем там хеллман стол стоял про метис и он тепло что он тепло это пирата правильно кто сказал оператор человек знает разбирается да то есть на самом деле про метаются тоже они уже давно пришли к этой модели оператора чтобы чтобы тепло потому что оно должно быть когда определенная костанай лойко да то есть вот эти как раз обнаружение тех падов которые помечены нашим лейблом вот то есть вот эта штука хорошо уже хорошо уже стало лучше и в принципе с этим можно жить до если вам не надо деплоить каждую новую кафку каждый день например ра найти клауд кто радует клауд здесь какой-нибудь в праве же не маг и так далее мы ранен клауд мы так называемый кантон клауд который является лучшим ну естественно лучшим клаудом кафки то есть если вам нужно кафка в амазоне мы можем вам дать как пума зоне есть вам нужно кафку джузеппе мы будем ранкед а за вас самого начала самого начала становление то это идеи мы начали думать как это все как нам сделать так чтобы было меньше крови и чтобы мы могли подавать это все скелете так далее ты с самого начала начали писать вот этот оператор который все это дело вот он был слишком заточен под определенный клауд он очень опьянены тит был сильно завязан определенную инфраструктуру мы начинали выдавались из начале он там сильно не использовал там на стандартные средства шифрования кафки он использовал will be до чтобы делать я взял термины что такое значит пришлось как бы когда происходил переход в другом кладу нужно было это дело унифицировать дальше пришли как клиент если слушайте вы конечно молодцы вы там клаус вы подняли но нам надо как-то вот у тебя это дело делать мы мы большие компании мы можем позволить себе про правит клауд можем все собрать мы хотим чтобы наши разработчики приходили и говорили хочу кафку хочу кафку поэтому пришлось заняться разработкой вот этого оператора который будет автоматизировать различные разворачивания развертывания кластеров кафки проводить различные операции мы на следующем слайде а какие операции имена будут проводиться я покажу позволяют проверять здоровье этого кластера и собственно чтобы монитор них работал из коробки значит какие какие ну вернись , там слайду да какие операции мы оператор делает во-первых security кто любит делать security certificate есть люди есть и у нас сильные ребята наверное они этим деньги зарабатывать плане того что они ходят и консультирует всех тех кто не любит делать супер это ну не то что сложно что что делать а ну да да да да правильно то есть я когда работал в банке я работал в отделе безопасности и нас тоже была такая шутка что люди которые работают в отделе безопасности мешают людям которые будут в отделе автоматизации потому что нужно блин security делать дальше есть такая идея что в принципе если мод мы запустили эту в дуxовку надо ее как наружу выпустить да она уже выпуск не так-то просто потому что опять же вспоминаем картинку когда он показывал продюсером костюме каждый продюсер имеет прямое подключение каждому надо почему потому что как-то назад к session да потому что каждый продюсер пишет в конкретный парте шин по конкретным ключу то есть нужно иметь подключение нельзя просто так взять и выставить это наружу и сказать что вот через степи ходите по там же кафкой работать не почти типа такого на работу по тисе пи и каждый каждый там под должен отдаваться каким-то особым образом можно выставить один сервер может вызвать 17 он будет называться им bootstrap серого но этот сервер должен просто это будет как как jump сервер он даст вам только информацию о том где взять остальные поэтому вот работа с внешней стороной опять же очень хитро там надо сконцентрироваться конфигурировать эти листы на же чтоб кафка понимала какой интерфейс наружу как у интерфейс глядит внутрь это все можно сделать это все как бы кодируется да это даже я вам сейчас покажу в ямале смотрите как сделан элегантно сейчас покажу где мы в лесу вылет это очень элегантно давайте лучше даже не здесь покажу а вот здесь где он у меня стоит full set и мы напишем listener есть дело с листьев вот выглядит очень элегантно вот вот так да то есть мы должны перед тем как стартануть наш процесс мы должны вы читать всю информацию о кодах айпишник их так далее потом от передать на вылет врать этильную да потому что мы пишем какой нашел скрипте внутри я мало но даже вот я вот когда раздавали сейчас мы на языке это неприятно значит еще интересно особенно это будет был вопрос люди спрашивал как будете например когда мы тепло им в в multizone нам режиме на когда у нас кластер тепло от в одном в одном регионе но но требуется чтобы был диплом в разных зонах как это делать то есть там очень тоже надо надо понимать где ваши диски лежат и как эти диски подписывать каким потом и так далее тому подобное как выживать и как с келли тоже не понятно значит то что делает оператор он дает вам такой и сел карманный свой собственный dsl для кафки вам не нужно лезть и думать там стоит full set of вы думаете в в терминах кафки вы говорите хочу 3 кафки и он делает вам три кафки сейчас кстати хороший хороший момент посмотреть но мы позже посмотрим получилось или не получилось значит х он остается потому что home все-таки местами хорош он позволяет нам идти не писать этот куб сити ел каждый раз там вот эти портянку файла все равно на проезд что хотим что-то кастомизировать значит здесь мы называем здесь мы называем у него какой файл мы диплом который определяет собственно наш вылью да он переопределяет значение которое в главном чарте прописаны и вот это определяет на номер имя нашего релиза это автоматический провяжем ну давайте как раз о и посмотрим получилось у нас чего-то или нет вот он бежит за кипер вот бежит звуки пир что-то что-то запустилась давайте теперь попробуем запустить еще раз кафку значит что здесь происходит мы говорим что запускаем систем в степи я вам сейчас покажу этот файл целиком как он выглядит с именем кафка и запускаем количество реплик 3 подождите подпирать и выпущу давайте посмотрим еще интересными и когда я сказал что вот хотим чтобы куб сидел это все дело поддерживал мы можем хотим сказать что get ковка можно вот смотрите можно как сделать на а вот давайте посмотрим кафка кафка потому что это название кафки а кафка это ресурс в этом случае есть какая-то кафка я даже могу сказать диска раме и смотрите какая прелесть значит что здесь происходит во первых он сейчас мне написал ее стандартные средства что не хватает где-то не хватило есть звуки пера да ну теперь закипит появился должна должна приподняться кафка но что-то никак не прочухается давайте посмотрим как лист что у нас какие у нас релиза сбегут вот значит первое это оператор сам по себе оператор тоже тепло это через фильм да есть звуки пир который бежит и кавказа dipline но вот что то конечно не так поэтому мы скажем как велит где мы hell i lied граф к порче сотрем потому что как бы всегда можно начать сначала это тоже очень клёво потому что не надо думать что там произошла к там ничего нет да мы-то стерли давайте посмотрим здесь ничего не происходит и теперь мы говорим ей давайте теперь тепло им кафку значит кафка реплика фактор 3 все должно должно теперь полететь по опять же пока я буду рассказывать я надеюсь я надеюсь что у нас диплом по пошла все хорошо все не могу идти дальше по слайдам пока что-то не поднялось следующий момент вот мы сейчас показываю вам автоматически праведник 303 кафки поднимется сейчас дальше теперь хочу скелет сейчас она поднимется я вам покажу как я это делала целью это же интересно особенно помогал пролиферацию про про всякие штуки кафки и вот эти партии шины они лежат на диске и поэтому кафка не очень хороший не очень хороший кандидат для того что делать такое on demand горизонтальные с келли не потому что нужно двигать диски мантия если кто-то меня помнит по временам когда работу узел кости там было все в памяти там все быстро да то есть убили ноду ну нету пирсе за свои хорошо мы просто восстановим это все делает рубрикации в кафки не совсем все так и модель re балансирования этих практично чтобы загрузка not была равномерной она тоже требует определенных знаний есть специальные тулы например который который позволяет переопределить где лежит та или иная портится в каком на какой конкретной но не в моем случае этот ул он бежит внутри пиратов но будет бежать в час по чесноку говорю он это как бы следующая фича но она будет автоматически определять план скелете вам покажу как вот перед определением партизанов там интересно и третий момент мы хотим получать rolling дипломе да то есть таким образом помочь вам рассказал мы что-то там поменяли мы что-то там какой-то момент с поделали теперь мы хотим это все перезапустить чтобы это все было без потерь ну и плюс плюс мониторинг давай теперь посмотрим все таки пока пока все это дело поднимается давайте еще раз здесь край посмотрим и вот видите что поменялось вот по идее-то кафка которого звали супа упавший она должна через какое-то менее провела время прочухаются я не помню сколько там у нас тайм-аут чтобы он перепроверял потому что он такой экспоненциальный баков да когда он пробовать что-то не отчёта нет чего-то нет и он вот этот промежуток чтобы там не сильно все настоялся на вопрос увеличивает теперь все понимается и состояние у него провяжем когда в текущем состоянии реплики 1 то есть он должен достигнуть режиму running когда когда это все дело будет на уровне в 3 реплики потому что мы запросили 3 реплики опять же что делает оператор автоматически он создает нам автоматически настраивает там северный доступ кафка умеет работать по низким протоколом она умеет просто по плане тексту к нему подключаться любой там заходи в любой сосал который позволяет определить такой просе не пас пароль для этих целей он использует этот логин модуль который называется плагин модуль он все равно использует стандартный типе он не использует с с л но для все дела работает и с и целом тоже также то есть мы можем определить сказать что если наблюдать он кстати покажу пока это все дело с оператором сейчас мы перейдём в оператор и как наши вот этот pro-vision выглядит вот по сути дела этот фильм чат который определяет как ведет себя моя как будет диплом смаков к он знает о существовании публичных облаков да в этом случае есть специальный 5 который умеет правильно разбрасывать диски по правильным зонам дайте им покажу где у меня но для разбросаны чтобы вы понимали о чем мы говорим то есть я сейчас запускаю обычный наш любимый курсе тела и передаю выпуск его в джейсона в специальному тулу который все это дело красиво парси то есть у меня есть ноты который сзади провал dipline и views and roll это зона это это региона в google диск в одной зоне но в принципе мои ноты могут быть разбросаны по зону google это позволяет делать из коробки автоматически и оператор умеет вот это дело про здесь нужно написать ещё одну зону и и мы дальше понесёмся разбрасывать все эти дела между различными нотами дальше да неважно значит по поводу пароль это пароль не для того чтобы доступе тыковки сейчас эти имидже лежат в приватном репозиторий кстати который артефакта риэлт ушел человек уже можно говорить значит и этот пароль дает только доступ на пол чтобы вы когда ди платить имидже в своем вы там либо через свою как будто там артефакт ари прокси это все все закачиваете либо когда это все лежит у вас в кабинете чтобы оператор имел возможность это делать но ты решил воротится расчет молодец значит надо дальше это глобальный доступ да он показывает мы тепло им все это в дтп он показывает какой диск использовать и сообразительные люди которые немножко работали может быть же цепью они знают что это специальный сторож класс просто-напросто мы используем айпи определенные который позволяет это все дело для нас завести то есть я могу сказать ему что я написал с тестем волен клеем вот и это вот он показывает кто что использует и кто как завел и так далее там подобно давайте посмотрим что тут кафка поднялась давайте пока у нас еще кафка поднимается еще еще поднимем так называемый все три секрета мониторинг который тоже сейчас должен каким-то образом найти эту кафку и показать что здесь происходит ну естественно у нас дима поэтому мы используем где мой port port forwarding да сейчас мы когда увидим когда она поднимется мы можем запустить port forward дальше что здесь еще интересно и дальше я описываю каждый элемент своего классного вот здесь у нас есть жуки пирс тремя нодами в 1 акт памяти вот столько тут нас краски и так далее тому подобное вот он control center наш запускается тут мы можем у него также прописать пароль там до доступ и все такое и у каждого элемента мы можем прописать и унификацию матери тела с работой тоже из коробки все это дело вот он большой файл целью по умолчанию видите все забито поэтому нужно представьте фильма мне выдавать эти штуки также поддерживается не только не только облака но и стандартный обычный обычные кубер нити с которой vanilla тоже поддерживается значит запускаем джимми хендрикса значит что есть происходит админ секретный пароль пальцы толстый вот значит запускает запускается такой tool который все это дело умеют мониторить он понимает что он не мониторит кафку то есть как же можно взять и про метаются и рисовать все графа не но нужно разбираться дату смотреть какие джим x метрики брать какие из них важны какие неважной читаем документацию от кафки читаем документацию комплименты понимаю открываем контент-центр мы все видим здесь мы видим что важно количество контроллеров количество контрольных не должно быть равно нулю и не должна быть больше единицы значит что-то не так значит давайте пока по-быстрому у нас время что заканчивается я сделаю такую штуку которого не должны делать production небольшое вам показал это вы можете делать тут такое то есть мы используем сейчас курсе тел чтобы прямо на живую поменять чего-то значит что у нас здесь происходит у нас есть вот это количество реплик давайте их все до 5 под ними и сохранимся все вот так мы отсняли кафку в реальной жизни вы так не делаете правильно вы делаете там там новый запускаете сделать и холмам греет и все такое то вот и теперь потихонечку понеслась через какое-то время мы сейчас увидим сейчас если мы скажем здесь показывая нам количество брокеров и он control center на все это дело покажет очень клевый клёвый tool который показывает немножечко больше о кафке там всякие топике можно создавать их здесь к ним можно подключаться и все так далее давайте попробуем пока у нас есть две минутки не знаю попробовать не попробовать я не буду сейчас пробовать мы с вами в экспертных зоне попробуем этом телек поставили поэтому сейчас ig g майк мы подключим и будем дальше продолжать нашу беседу кому нужны эти девочки на правильно показывают все самое-самое нужны сейчас быстренько мы откроем поглядим как у нас статус здесь видите чуть-чуть стало больше брокера стало четыре уже то есть он потихонечку потихонечку поднимается мы здесь видим что раз-два-три-четыре где-то сейчас должно быть 5 подняться немножко полетела значит оператор вообще это огонь мы будем дальше как бы развивать и всякие штуки будущее спасибо славе что он подсказал эту идею что надо вам рассказать о нашем будущем это на самом деле очень крутая штука я прям почему я да не задумался значит такие компоненты как connect внутри кафки позволяют нам также строить компонент градус репликатор репликатор позволяет нам приносить данные сказки из одного места в другой оператор умеет деплоить connect умеете плойки этот репликатор и было бы клёво все-таки мы хотим переехать в клауд как нам это сделать да у вас есть этот кластер кафки в он принес и вы делаете кластер правки в claude между ними ставите репликатор все реплицируется красота но это можно даже так как у какой то в какой-то момент жить а можно переезжать между облаками да то есть вы такие в амазоне а потом думаете на даче в google сделать чтобы там начальник опять же ему хорошо спалось поэтому вот такое буду на счастье где все это дело взять начихал мчат можно взять уже сейчас оператор можно взять будет чуть чуть попозже весьма тип можно пойти и подписаться на e-mail у нас есть slug кто любит флаг любите вышло как и люблю его я у нас а кто у нас в тонус и любит telegram у нас есть тоже telegram приходите к нам в telegram про разговаривать про кафку в нашем лаки можно прийти поговорить про купер нить из можно писать мне письма до востребования мелким почерком можно написать не в твиттере я скорее всего в 33 отвечу быстрее и если среди вас есть энтузиасты любители кафки и прочего приходите к нам работать мы нанимаем активно везде по всему миру поэтому наседаете буду рад а мне еще есть 16 минут поэтому я в минут 16 секунд я отняла их а тебе а ты хорошо все спасибо ребят мы сейчас с вами продолжим мы для тех отъявленных спасибо"
}