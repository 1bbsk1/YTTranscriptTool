{
  "video_id": "gdhUGbyJopI",
  "channel": "DevOops_conf",
  "title": "Артем Железов, Андрей Девяткин — Гибридно-облачная платформа поставки приложений с Consul и Nomad",
  "views": 1915,
  "duration": 4402,
  "published": "2021-04-30T01:29:20-07:00",
  "text": "артем андрей александр крайне рад вас здесь в спасибо большое что пришли адам и с таким настроением андрей вижу у тебя очень солнечно и судя по карте ты так далеко от всех остальных кто находится на данном докладе может ли нам рассказать как как она там у тебя как у классика всем привет всем кто подсоединился у нас эту классика мороз и солнце день чудесный по местным меркам мороз то что 18 градусов и дома немножко зябко если выйти на солнце там хорошо конечно нам сейчас окей да нижнем конечно не 18 градусов 15 но не тепла и холода так что да у нас немножечко попадает здесь настроение александр расскажешь ли ты нам про свои условия да привет ребята у нас ульяна сейчас -13 то есть казалось бы примерно какой нижнем но по ощущениям такой холод собачий что как будто все -30 и сейчас вот мало того что и так все по домам сиди на сегодняшние ледяные узоры на окнах прям во все окно так что вообще ничего не видно тут получается вообще полной изоляции ну в общем то перейдем к докладу я сначала скажу так что раскрою небольшой секрет несмотря на то что сам я очень люблю купюрницы для меня это кажется безальтернативный вариант но примерно треть отзывов одеваться конференция звучат как опять стаж беременный каберне this как будто еще другого и не существует вот ну конечно да да должны что есть еще отзывы которые звучат как мало кубер ниц и сейчас интересен только он давайте его больших обернется он но тем не менее вот кобрин из он действительно клёвый и лично для меня после множества лет работы с разными инструментами купер найти был как глоток свежего воздуха то есть наконец-то нормальный инструмент в котором не нужно знать и иметь свой набор костылей уметь нормально и правильно интерпретировать ascii келли все прозрачные расширяется на циане полноценного кода они с помощью какого-нибудь dsl или ещё каких-нибудь сбоку странных вещей он и однако действительно в этом мире есть еще другие инструмент крови купюрницы они тоже довольно актуальны местами на самом деле гораздо удобнее эксплуатации вот и сейчас вот как раз будет такой докладе церкви те кто устал от кубер ница и хочет послушать что-то хорошее по другие технологии и когда они лучше чем кубер nights вот поэтому мне кажется это будет очень интересно поехали я начну и у нас мотивам трудимся в компании five excel консалтинговое агентство к нам пришел заказчик и у заказчика такая ситуация они строят продукт который состоит из и состав несчастна формы то есть у них есть use racing часть то есть у пользователей с мобилка который на которую нужно передавать какие-то данные а эти данные это то как этот пользователь играет в гольф то есть на полях стоят камеры и задача распознавать видео с этих камер показывать ему как он красиво машет клюшкой подсказывает где махнуть можно получше и нужно было платформа чтобы девелопер могли быстро разворачивать приложение их обновлять и гораздо гаже нам пришел все это бежала в 9 love и были просто подняты несколько виртуальных машин на которых такер компотом все запускалась больше часа все происходило руками было достаточно статическая система плюс были он сайт системой где абиджане а где стояли небольшие машины с дробью которые отвечали за обработку видео потока который шел из камина и нам нужно было все это как-то объединить в одну систему и очень часто когда заказчики там приходится когда начинаются с ними разговаривать африке и счет delivery platform все можно чесать сальник показать то есть под облетевший delivery platform и мы понимаем комплексную меру которую состоит из банковских инструментов и процессов которая позволяет предоставить разработчикам интерфейс возили контракте если хотите и это сервис контракта то есть самообслуживание за качество разработчиков нужно как можно меньше общаться с операциями людьми и операционные людьми потихоньку становится платана платформенной команды которая разрабатывает эту платформу что развитый топик сейчас то есть книжки которые проекта будущего превратили то получишь а если вы читали последние devops репорты папе то-то они центральное место и на платформе нам командам там выделили и очень часто компании хотят понять devops извините за это выражение но это то что они пишут в своих объявлениях на работе и дома не горят надо будет делать cabernet с надо будет делать сделки и надо будет делать еще что-то там дженкинс я не знаю гитхаба кшенский ttl общей но они не пишут контекста да то есть на самом деле они не хотят делать купер нас они не ради отделал title обсе они хотят выстроить платформ сожалению не все это понимают хорошо и зачастую приходится делать большое образование и вот вот мы используем эту картинку и если купили на следующий сайт мы увидим как технологии которые мы применяли в этом случае и артем будет очень подробно рассказывать о выборе этих технологий на данный момент мы просто показываем как они технологии которые мы выбрали переходит на эту картинку и следующем сайте я на следующем слайде я немножко расскажу про себя меня зовут андрей девятки называю себя клауд engineering специалистам специализируясь войду в лесах аж из таки я являюсь основателем консалтинг бренда five xl я часто выступаю на конференциях как-то прямо вчера на типсе сегодня и также ввиду англоязычный подкаста deep sea club стол вам понравится что вы услышите сегодня настраивайте своих подкаста приемники на волну де всех abs talks и сможете услышать больше от меня там артем да и теперь пару слов обо мне я так же как и андрей занимаюсь облачными технологиями специализируюсь на h6 и amazon также являюсь основателем бренда файл excel и работаю независимым консультантом но и в свободные от работы время увлекаюсь игрой на барабанах металл команде и теперь пару слов о том основные темы которые мы сегодня раскроем и докладе первое это то почему мы выбрали х6 второе это то как мы организовали zero траст network для нашего сета по и то как мы диплом приложение с помощью намах так поехали во первых хотелось бы упомянуть и о том какие ограничения стояли перед нами на старте проекта когда заказчик пришел к нам и дал нам понять то что возможны различные типы нагрузок который предполагается запускать на серверах то есть чтобы было понятно это не обязательно должны быть канонизирован ее нагрузки но также где-то на горизонте маячил даже windows то есть ну пока конечно нам с ним поработать можно может быть к сожалению может быть частью не удалось но такую возможность на будущее предусмотреть стоило также как уже андрей упомянул часть приложений должна была работать в приватных дата-центрах то есть это гольф-клуб и и этих самой в клубах с камер пишется видео и это видео поступает на сервера то есть непосредственно гольф-клубе также важно было заметить то что это стартап и он не обладает миллионами инвестиций то есть бюджет предполагался достаточно ограниченный и также команды системных инженеров состояла всего лишь из одного человека то есть это я теперь мы расскажем о том какие возможные решения мы рассмотрели на старте возможными решения и виду такой такие с scheduler и возможно было использовать для запуска приложений и первые то что о чем мы подумали это amazon и серез он конечно обладает своими плюсами как это сервис она мне потребовалось бы тратить силы и время на поддержание ретро сервиса он прост в обращении но при этом обладает одним важным минусом то что он работает только для облачных серверов его не получится запускаем серверах в приватных дата-центров то есть это решение нам не подошло также да конечно ну да я хотел сказать что давая назад нури инвенция объявили что теперь возможно исчез теперь нам стал доступен он прим но это про технологические ставки то есть когда каждый стартап когда они начинают у них есть технологии с того что есть сегодня им нужно сделать ставку 2015 году это был намного интереснее потому что было много с кедром были там deckers форма бизнеса расскажи-ка у пиратов всех съел 5 лет а позже вот и люди обычно идут по дефолту в купер notes но например татьяна задка люди выбирали и был намного сложнее выбрать сегодня все тут почти поп по дефолту и тут купер на на и сейчас еще артём расскажут почему мы не пошли в купер нас да конечно мы рассматривали эту возможность это решение обладает одним большим жирным плюсом то что это на данный момент самый популярный и schedule a но со всеми вытекающими то что у него есть богатой комьюнити то есть это можно найти решение какой-то проблемы если возникают какие-то сложности в процессе использования но по своему опыту я знаю то что поддержание кластеров обернет занимает достаточно много сил и времени но как я уже упомянул в команде системных инженеров был я один и таким образом нам не хотелось тратить свое свободное время на поддержание работоспособности кластеров с тем чтобы я мог делать какие-то выполнять эти повседневные задачи также мы рассматривали возможность использовать uber нас от амазона название к с сервис то есть отпадает головная боль с тем чтобы поддерживать в рабочем состоянии но он обладал такими минусами достаточно дорог использование наш бюджет был ограничен поэтому это решение мы также отмели да и также мы рассмотрели возможность использования hаши портного среди его плюсов как да как говорится в документации к шакор и вообще хочу форм позиционирует себя как компания которая продвигает решение для гибридного облачных платформ что а красного подходила также в судя по документации на март это всего лишь один бинарный файл то есть предполагалось что у нас не займет много сил и времени чтобы его поднять и заработал и также предполагалось то что повседневным обслуживание он будет прост и также важным плюсом послужило то что нам от есть возможность запускать различные типа нагрузок или в том числе его можно запускать иной windows нам это возможность показалось на будущее очень интересный да ну так же к минусам стоит отнести то что ему пришлось считать ведь сам сталин да да да я да я ворвусь еще немножко то есть до когда обсуждалась решением был такой один из ключевых вами то есть один из маме один из ключевых моментов которые сейчас скорее все еще раз повторюсь что было то что нужно было гибридное решение но другим это было количество контейнеров на то есть вопрос по силе ну ладно хорошо а сколько у вас контейнеров их было меньше десяти поэтому что но скорее всего купер нацистов будет перебором здесь и мы предлагаем запустить опросник как вы думаете сколько контейнеров нужно для того чтобы запустить купер на то сколько у него gypsies там бежит контейнеров и сколько вы считаете нужно где этот порог находится когда есть смысл уже рассматривать губернатор стать когда начинают это инвестиция времени и усилий окупаться да то есть где с вашей точки зрения порог например в количестве контейнеров вопрос интересный нам теперь давайте поговорим почему мы выбрали х6 то есть сейчас речь идёт не только она more но и вообще всех продуктах hаши к аргументам послужило то что продукты ратхаш и короб тесно интегрируется друг с другом а мы уже давно используем тираж форм и в данном случае нам показалось интересной возможность использовать тира форум для конфигурации консул и нам от кластера также нам необходимо было быстро стартовать то есть чтобы за короткий промежуток времени мы могли уже показать какие то результаты предоставить решение заказчику на которое позволило запускать ему свои приложения в данном случае мы наткнулись на тера форму гранд парк модуль это было достаточно неплохое решение которое можно было взять как она есть и начать использовать также по опыту многих крупных компаний мы видели то что нам от может скейлится нам этом нам было важно в том плане что старта на начальной стадии конечно небольшой но в случае если труппой потек сравнить рост на мы должны были предусмотреть возможность нарастить мощности также благодаря фичи консула сервис мышь представлялась возможность бесшовно мигрировать на хубер нету если вдруг по какой-то причине нам антанас не устроил или возник неважных либо какие-то сложности в процессе его использования также так как это все продукты hаши core представлялась возможность использовать у него также хорошие интеграции с консулом и и снова там мы сейчас упомянули консул ну и было бы неплохо наверное упомянуть о том для чего он вообще нам от понятны the scheduler позволяет запускать приложение но для чего же нам нужно полком консул решал ряд важных проблем у нас таких сервис discovery ты столько сервисы будут находить друг друга также он предоставлял полезную фичу тиристор с помощью нее очень удобно оставлять конфигурацию для приложений также он предоставляет встроенные hell стейки да нам от может также запускать шейки без кунцево но в этом случае они достаточно ограничено функционале то есть если у вас работает контейнер то считает что он здоров если контейнер упал то нам отмечает его как нездоровые это конечно такой базовый функционал ему который может быть хомуты и что достаточно но если вам нужны какие-то более интересные проверки таких как или скрип чайки то здесь уже потребуется интеграция с консула дали также пан сул в нашем случае обеспечивает безопасность перемещения тонах теперь немножечко поговорим о сетевых сетевом сеток а так как все общение между сервисами обеспечивается с помощью консул то в данном разделе собственного ним поговорить то что предлагает хочу пор своей документации случае если мы используем несколько дата-центров допустим как в нашем случае одним дата центра является amazon друг другим дата-центром употребляться какой то ли спортклубов предлагают в каждом из дата-центров понимать по 3 сервера и общение между дата центрами в этом случае будет организованным окон для чего понимать нужно принимать сервера в каждом из дата-центров есть объяснение в случае если вдруг один из кластеров одном из дата-центров походит из строя 2 дата-центр оставался работоспособным работоспособности обеспечивалась за счет у серверов и сейчас я покажу то как это сделали мы в нашем случае это понятие серверов в приватных дата-центрах большого смысла не имело как выход из строя фермеров в амазоне означал бы потерю работоспособности вообще всей системы смысла работы приложений в приватных дата-центрах поодиночке не смысла не имело система работает как единое целое и что делали мы мы соединили приватную сеть в амазонии дпм туннелями с приватными то-то центрами и таким образом приватных дата-центрах нам оставалось лишь поднять консул клиент и сервер а нам оказались там уже не нужны таким образом все общение между нотами происходит повод lan артём можно еще та баба допишем здесь еще важный момент том что ресурсы которые есть на стороне private data center и очень ограничены то есть в некоторых случаях у нас просто даже не было возможности физической поднять 3 сервера дополнительно и количество нагрузок которые нужно запускать на стороне клиента значительно меньше то есть там буквально несколько задач которые именно занимаются обработкой графики ну или может быть какие дополнительные больше работы которые бегут на свободно jet peel плюсом когда были устроены тоннель и соответственно трафик сильно резался то есть и режется то есть разрешен трафик только через консул connect to хочу из эти порты и именно поэтому для нас было важным моментом выстраивание сервант раз network а то есть даже если кто-то каким-то образом умудриться пробиться через тоннелем со мной дата-центр чтобы там все было зашифровано и на всех нотах были открыты только порты консулы и консул connector все так наверное было бы вашим упомянуть то что удобно при этом для нахождения сервера метров круга использовать настройку ретрит то есть это настройка позволяет использовать теги на серверах для их автоматического определения друг друга то есть если мы вешаем какой-то другой сервер будет искать этот ток и если его находит попытаться подключиться да это это можно использовать необязательно для облачных серверов но и для железных серверов приватных дата центра для этого потребуется поместить на сервер ключи от amazon с соответствующим разрешением и вперед да это также важно упомянуть то что нам от клиента и сервера также находят друг друга через консул используя консул и раз уж мы поговорили об инфраструктуре то хотелось бы упомянуть то что мы используем имеют оба infrastructure то есть мы подготавливаем образы виртуальных машин с помощью пакета есть готовим по-геркански в котором прописываем установка всего необходимого для запуска ноты софта и затем поднимаем эту ногу с помощью тира форм данный данный сетап позволил нам использовать 100 tanks инстанции и сэкономить приличную сумму денег то есть я поясню сейчас наши консул и нам от серверах тестовыми marmite работают нас плотах и если вдруг какую-то из парнас выдергивают то of those келин группа тут же поднимает вместо нее новую такую же точно из песка нового образа подготовленного акира и в принципе вот этих вот подергиваний инстанциях из-под нас никто не замечает до кад и не перешел на тропе слайд если вам интересно узнать больше про это по инфраструктуре вы можете мой доклад со вчера послушать где я достаточно глубокие детали еду почему мы считаем что это было про структура это хорошо плюс например когда мы эту презентацию показывали другому форме был интересный вопрос что будет если если выдернут все все сервера например не потеряется ли стоит то есть мы это оформл так что каждый на каждый сервер из трех есть свои of those келин группа только с одним нодом то есть of the skin группу там нужно для того чтобы перед создавать на вот если их выдергивают из ответ состоит хранится на и без время который отдельно цепляется к ноды он то есть макаешь таким образом лимитируют себя к определенной вал ability зоне но все равно мы получается в полностью независим от от влаги лице и и на самих инстансов то есть по нас могут все вы тут у нас остаточки пьески и мы все перед перестанете всяком случае можем сюда отъехать на призер чувствуется когда бывает такое что наплывает много людей со спотами плюс мы запускаем достаточно маленькие инстансы на которых нет интереса дата способами такая ситуация что обычно с плодами пользуются когда запускают большие инстанции . лара числа от что экспорт а мы так как нагрузки небольшие больше частью держимся в районе small medium и за ними не так часто приходится спорт и поэтому interaction of почти нет да все так окей давайте теперь поговорим немножко о том как мы настраивали резеро красный at work андрей уже упомянула нужен для того чтобы теоретически возможна такая ситуация что допустим все есть все эти гольф-клуба попадет быть злоумышленник с тем чтобы ограничить его в действии чтобы он не смог пробиться дальше в нашу инфраструктуру то есть для этого мы и заводим это озеро тростника и зело вам создание больше артём на территории перебью тебя немножко извинить дано лишь даже побольше скажем что когда система проектируется надо ее проектировать не если а когда а то есть когда в нашу систему загореться злоумышлять исходить из этого потому что это в принципе реальность что пробиваются постоянно и нужно быть к этому готовым особенно когда в публичных облака мини фабричных товаров то есть и у нас очень много было идей нашего того как там обезопасить артем например упомянул то что мы раздаём амазонские креды на ноты которые бегут бегут в приват и дата центрах и это в принципе мы считаем как полностью зона который мы не можем доверять потому что там есть локальная админ у которых есть полный доступ до этих машин они могут сделать 70 что угодно поэтому все то что мы отдаем на эти машины то есть локальные креды амазонов ские токены для консула они все имеют максимально за лимитированной при привилегий так если отмена паче когда отменял этот токен или когда админ взял эти creedence и что он может сделать расти мы стараемся месяц но если он сможет целую копить нашей три наших консул сервера инстанции блоки это в принципе информация диск лорд но мы считаем это допустимого риска вроде в котором в данных ситуации сложно защититься да и нужно три главных шага при первый это с control list то есть настройка помогает ограничивает доступ консулу за счет предоставления токенов с различными правами тел с encryption здесь наверно все ясно это шифрование трафика и консул connect фича которая позволяет разрешать или запрещать общение между сервисами и вот сейчас мы остановимся чуть подробнее о каждом из них по поводу и сиел консул позволяет группировать правила доступа в полисе и затем ассоциируете полисе с токенами впоследствии токены распределяются на консул клиенты консул сервера нам от клиента или сервера либо даже на приложение которые работают на мат кластере здесь важно упомянуть что если вы уже защита пили консул plaster и изначально у вас не был настроен и сиел и вы хотите его внедрить то здесь важно поставить на стройку дефолт policy илал с тем чтобы вы при включении и сел и не потеряли весь доступ к кластеру то есть изначально он выставляется дефолт алексей love вы настраиваете и сел и затем включаете fall policy данной с тем чтобы все лишние функции стали недоступны был доступ только лишь потоки нам да и важно упомянуть то что удобно полисе и токены конфигурировать с помощью тира форм таким образом у вас будет наглядно и составление того как выглядел как выглядят ваши полюсе будет подобное случае чего как-то погиба жители изменять следующий шаг это tls у консула есть встроенная фича которая позволяет сгенерировать все необходимые файлы для включения тела после создания этих файлов вам будет необходимо их распределить на ноты и так же здесь можно упомянуть то что позволяет использовать of the encryption метод для он сел клиентов то есть не не доставлять ключи не не складывайте закрученную ключи на console клиенты он пал этим займется сам теперь консул коннект это интересная фича которая позволяет ограничивать общение между сервисами как это работает есть сервис и сервис и рядом с каждым из сервисов поднимается сайт корр прокси контейнер и каждые сервисов может общаться только лишь своим сайт корр рокси и уже трафик от одного сервиса к другому будет идти именно через эти сайт контракте контейнеры удобно в данном случае использовать так называемый консул intention которые позволяют разрешать или запрещать общение для того чтобы включить эту фичу вам достаточно прописать соответствующую настройку конфигурации консула установить все на и плагины здесь хотелось бы вспомнить о том что как ммо маркетологи говорят что консул это всего лишь один бинарник ну вот как видим не совсем один далее необходимо объявить использование консул connect файле на март job и и при этом необходимо быть осторожными с тегами для сайта прокси контейнера я чуть позже объясню почему да и после того как вы все это сделали необходимо указать каким сервисом разрешается друг с другом разговаривать при этом важно знать то что разрешение работы разрешение общения работает только в одну сторону то есть если вы указали то что сервис разрешается общаться с сервисом и то вы разрешили трафик только в одну сторону если вы хотите чтобы трафик 1 га сторону вам также явно придется указать что сервис б разрешается общаться в сервис а в обратную сторону и также здесь хотелось бы рассказать о том что если у вас уже есть консул кластер в нем есть в нем работают какие-то приложения и вы но на данный момент консул connect свечи не включена и вы хотите ее включить то есть слева показан конфиг нам от чтобы она будет выглядеть у вас если он был коннект у вас не включен в данном случае определение сервиса происходит на уровне тоска и если же вы хотите включить консул коннекта определение сервисов вас перекачивают на уровень выше на уровень группы если при этом для сервиса у вас прописаны какие-то ящики вот в данном случае скорее holster вам необходимо будет явно указать какому dance будет принадлежать данные чек чек должен знать в какой drummer ему использовать и сообщить им об этом можно лишь указать явных какому-то ху он должен принадлежать в данную данное вещи мы уперлись прессе так как он сел connect и если в данном случае мне указывать явно так-то просто будет целиться и в блогах нам от или посол варенье не увидите ничего об этом как оказалось это баг на мотор который на который мы завели вишню и на разработчики ответили что-то действительный тапок и обещали его фиксить в версии нам 10 которая на данный момент уже вышла надеемся скоро это попробовать и посмотреть что действительно это заработало артём по-моему сегодня с утра тоже сапега ли release candidate в 1 дома-то первого ректора не знает и кто использует нам от то есть в первой версии которого тот выйдет будет залп insertion но над namespaces то есть раньше это было enterprise на я фича и она теперь выходит в консорциум принципе удивительно что мне было потому что в кооперации например те же самые дали space и бесплатные используются сколько хочешь в намазе это было таких достаточно сложным ограничением вам приходилось строить костери вокруг этого если вы не покупаете этот проект здорово что они вынесли этого концов и я потратила добавить но то что ты уже сказал а что до к приезжаешь наших клонов ты смотришь как они рассказывают весело проконсул connect и как это круто и вот и вот здесь вот одну штучку добавил в селе и стала стали тебя волосы длинные шелковистые сразу когда ты на самом деле начинают что настраивать то есть тебе нужно и сена и плагины поставить хочет себе с мдф с омп поработать поставив все сайт плагины контейнер 40 интерфейс все найдите кто не знает контейнер network интерфейс то есть у вас на самом деле получается ситуация по даже похоже на кубер на это знают о соску бернадетте сиди в котором хранится стоит здесь у нас по сути это консул потому что матовый используют как если не ошибаюсь так как сор из когда функций есть на намного царя замаскировать вас уже два процесса плюс когда вы запускаете консул коннектору он начинает поднимать свой сайт кара плюс вам нужен сена и силоса и за что я скажу хрон хорошо хорошо в кабарде да то есть когда вы устанавливать определенную версию brother колсон и там куб спрей не неважно что у вас есть зачастую вас есть уже определенная версии там докера куплета сереной вагинов которые протестирована в месте то есть хорошего ведет интеграция с хорошо корпус смету лагерь нет такого поезжай на который можно посмотреть и чаще всего приходится немножко экспериментировать с версии очень напоминает ситуация с дженкинсом если кто эти грабли наступал его плагинами дженкинс коры вас могут работать работать и вот здесь а то приходится немножко не поймите меня неправильно это не проблема мы не на чё такого серьезного дела т.к. это просто такое что приходится самому учитывать вроде как обратная совместимость работы достаточно неплохо и мы пока мы это делаем него что-нибудь да спасибо теперь давайте поговорим о том как мы тепло и приложение с помощью нам от первое о чем хотелось бы рассказать то как устроено наше репозитории разработчики пишут в приложении таким образом что на каждое приложение выделяется отдельный репозиторий и структуры этих репозиториев является повторяемые здесь можно увидеть у нас есть отдельная отдельная директория для диплом and в котором лежат конфиг нам от чтобы и также телефон спецификации которые относятся к данному приложение то есть для чего это делается чтобы инфраструктуру которая с которой работает данное приложение которое использует и находилась именно в этом репозитории а не в каком-то едином репозитории с инфраструктуры аспект миксера форм все это дело мы стараемся максимально растаскивать по отдельным территории круг туда не передали нам то есть такая структура но я считаю что структура репозитория очень важно если выстроить выстраивать этот вопреки нашим delivery platform она потому что вы хотите выстраивать автоматизацию то есть какие-то общие pipeline reusable pipeline и который у вас будут и соответственно pipeline нам нужно предсказуемая структура директорий что они будут знать что если вы хотите сейчас запустить тира for the pipeline и знали где этот тира форма скальная вы конечно можете это пробовать конфигурируем в каждом pipe они но даже с точки зрения людей это работает лучше особенно когда у вас вы хотите чтобы вас инженеры переходили между репозитория не мог прийти на из одного из другого репозиторий переходить а не знаю структура не знают где найти modify не шанс здесь катера форум есть там mutter пакир файл искать они все это знаю где это найти это очень предсказуемо это очень удобно особенно когда ограничены по времени есть у вас какой-то инцидент происходит то есть вам нужно быстренько разобраться что там происходит то есть и это важный момент но я не скажу что этот что то такое что всегда работает да то есть оправдываете команд это может быть у к для больших команд например если у вас есть юрий ти команда да то есть если у вас много репозиториев может быть проблемы с например сия с доступом да то есть убеждаться в том что все та же там происходит она происходит адекватно то есть маленькие командах обычно уровень достаточно высокие разработчика не понимаю что они делать зачастую не всегда на зачастую они тут понимаю вот в более больших организациях обычно security команды хотят чтобы у вас например на все что работа с доступом скриптами швами и выставлением вещей наружу она как-то проходил быть review то есть для более больших команд может быть более подходящим если у вас часть вещей которых приложения находятся в централизованных репозиторий либо еще до другого проекта не на этом проекте на другом проекте мы убирались в имитацию такого подхода в том что например если вы используете какие-то жареные ресурсы то есть например если у вас приложение используется один радио списка приложений вот один тоже отец сын 100 создают не просто отдельные поста нах так можно делать но тогда у вас получается приложение не создается кардио сенсорсо нужно думать куда и тартессы наносить то есть в моменты когда у вас есть необходимо какое-то комплаенс или security чеком на парнях или когда вы начинаете шарить ресурсы эта система может не всегда хорошо сработать что иметь в виду да спасибо андрей за дополнение и также важно упомянуть то что мы стараемся максимально шаблоне zerowatt конфигурацию на март жопу файлов что нам это дает то есть мы как как видно здесь мы все имена сервисов и прочие параметры заведений переменные окружения которые мы передаем через в процессе прохождения 7 вот и таким образом ими один шаблон нам от файла мы если хотим оформить какое-то новое приложение разработчик может легко взять его как бы этот скелет и с каким-то минимальными правками его скопировать в новые территории и уже начать работать тепло из приложения еще хотелось бы упомянуть то что онлайне мы стараемся везде перед диплом приложения прогонять тира форм нам это позволяет быть уверенными в том что мы избегаем configuration 300 то есть я немножко поясню облачные ресурсы которые описаны в терра форм спецификациях они также доступны и через amazon мужскую консоль то есть вы можете пойти через браузер что-то поменять и таким образом сервис будет находиться не в том состоянии как в как в котором предполагалось прогоняет тира формы приводим всю инфраструктуру то состояние которое заложенных телефон спецификации уверена в том что приложение диплом цели на на нужную инфраструктуру на напомню том как разработчики diablo или приложения до организации вот этой платформы они ходили по ssh на сервера и руками поднимали там toker кампус файлы то есть необходимо было помнить адреса серверов вырученными манипуляции это как-то не очень хорошо если мы можем что там автоматизировать лучше это автоматизировать и мы это сделали с помощью нам от сервера у нас сгруппированные о определенным лейблом то есть в данный момент если разработчику хочет за тепло вить свое приложение например в город вильнюс он взвешивать соответствующий флажок и и он будет уверен то что приложение отправится именно на серверах которые ему нужно и также бывают ситуации когда вся и прошел приложить приложение якобы сзади бросилась в нам от но контейнеры нет не поднялись для отслеживания таких ситуаций мы написали небольшую автоматизацию которая некоторое время после тепло и mind мониторе allocation и поднятые и случае если какой-то из них оказывается нездоровым то макетным болит нам от валит учебу и отправляет соответствующее уведомление флаг и собственно разработчик уже сразу в курсе то что его тепло не прошел и на это нужно обратить внимание нести какие-то поправки также разработчики обратились с просьбой написать некую автоматизацию который по отслеживала убийство по памяти то есть дали мне не всегда приложение бобовой такие ситуации что приложение не укладывается в лимиты по памяти прописанные для него нам конфигурации на матч о б ы в этом случае если она пресекает границу она убивается в этом случае наша автоматизация вызовут как big было ее первоначальной реализации мы на этом не остановились немножко увлеклись и сделали так что теперь она умеет отслеживать не только убийство по памяти но и вообще любые типы ивентах ну и на данный момент она не доступна он source то есть вот по этой ссылочке если вдруг пригодится то вы сможете увидеть да и с выходом на бам от версии а ты как раз хотел это сказать 10 и и приговори говорит ван стрим будет доступен в 10 то есть сейчас мы немножко по-другому а татьяна я скрипт пока не адаптировано когда был переехать переводить заказчик на 100 соответственно мы скрипт адаптируем подобен стрим или может быть просто вторую версию этого скрипта сделаем чтобы сохранить обратную совместимость до тех кто ещё не закрывался на 10 да все так портал также одна вещь которую хотелось бы упомянуть при попытке за скинули jopu на ноги на которые есть четыре вывел если труба предполагает использование этого джеппе у вас есть ограничение вы можете запускать не более 1 1 тоски то есть если какая-то одна тоска уже использует купил на сервере вы уже не сможете запустить вторую на этом же к пиву даже несмотря на то что вроде как у вас там есть большой запас памяти еще и лимитами памяти не исчерпана как оказалось данное ограничение присутствует не только для дома но и кубер нас есть такая проблема и она на данный момент есть и и некоторые решения которые могут показаться кому-то немного костылями но тем не менее что есть на данный момент вы можете нам от использовать почти джо бы то есть это временные которая по необходимости запускается отрабатывает и закрывается тем самым освобождает же фильм для последующих джонов либо вы можете использовать рюкзак драйвер то есть запускаешь команды просто командой докер докер ран и собственно так таким образом использовать одном жупел для нескольких task-ов и мы поговорили о том как - это кризис сердца о том как мы тепло или приложения также важным стоит упомянуть о том как эти приложения становятся доступными потребителю как мы их выставляет интернет для этого мы используем трафик у него есть встроенная фича которая позволяет использовать консул of the discovery для этого лишь необходимо указать какой тип на сервисе ему необходимо найти в данном случае здесь указан трафик так name low то есть если трафик видят на сервисе данный так то он понимает что ему нужно с этим сервисом работать и смотреть дальнейшую конфигурацию сервиса здесь показана та как вся эта конфигурации собственный описывается здесь важно то что конфигурации происходит на стороне сервиса они не на стороне трафик чем это хорошо тем что это дает свободу разработчикам то есть им не нужно обращаться ко мне с тем чтобы выставить какой-то сервис интернет они могут взять пример какого-либо из сервисов которые уже настроен ну грубо говоря скопировать то что уже есть и как-то подстроить под свои потребности то есть конфигурация проходит именно на стороне сервис от этого не нужно менять конфиг трафика и еще хотелось бы упомянуть что если вы так же как и мы собираетесь или используете уже и new to balance the страха и ваше приложение часто переезжают с not an одной ноты на трубу you to в случае с трафиком важно директорию в которую сохраняются в этом креп сертификаты сохранять на какую-то жареный болью с тем чтобы они у вас при переездах снова на латуни не пропали и вы не уперлись в цикле митинг то есть если вы упретесь потолок на прошлом перестану кладутся сертификаты что будет не очень хорошо таким образом я хотел бы немножко подытожить о чем мы сегодня говорили мы рассмотрели на mac scheduler который позволяет организовать достаточно просто процесс тепло и для разработчиков при этом говорили маркетологи то что он очень просто настройки зависит от того какие задачи вы преследуете если вы собираетесь делать такой сетап серьезный продакшен ряде отраслей и прочими вещами то возможно конечно это будет не так просто как говорят маркетологи тем не менее в принципе он себя зарекомендовал достаточно неплохо что мы настроили она сейчас работает и заказчик и разработчики того также мы рассмотрели сервант раз на it works это что позволило нам ограничивать доступ к приложениям и быть уверенными в том что если вдруг ну или как андрей да сказал когда появится дырка где-то в нашей обороне то злоумышленник не сможет далеко уйти долину и также важным хотелось бы конечно упомянуть то что для всей конфигурации описанные нами мы использовали форум что позволило сэкономить время и деньги и нервы и в конце концов это очень удобно и тоже камерной ты пока не пей скачал тебя просто добавить стал ту задачу которую мы оставили до твоих там нужна была минимизировать моей-то нас в идеале потому что артем азии и задач намного больше да то есть если работаешь с куда разобрались как бы не только снова нам работаем много работы артём до этого работал скутер нету сама проектах я работал и работу собираться на проектов и просто даже поспевая за всем чем там там происходит это требует времени потому что постоянно что-то пузырится что-то новое появляется наш японскими продуктами этот ритм он намного ведь до 2 раза посмотрел конференцию в код и уже узнал что случилось идти в принципе больше не надо особо дергаться и в принципе он оказался неплохо план того что он бежит и есть не просит это его настроил один раз а потом дальше сильно не меняется его артёма была возможность именно работать над бизнес-задачи той помогать бизнес выполнять те задачи которые необходимы они стать нам от инженера как у многих компаний есть купер нас команда который чистого затем что они выстраивают купюр это все настраивать то мы автоматизируем поэтому мы хотели избежать потому что старта ресурсы визирование и мы не хотели чтобы артем черным время уходило на работу саркис трат и эту задачу я считаю выпал гарри вполне было достойным решением пойти с консулом и на мадам в этом случае да да да и я конечно еще хотел добавить то что то что данный сектор он сработал для нас и мы ни в коем случае не претендуем на какое-то истинное мнение возможно я надеюсь то что многим из вас что-то полезное внесут что пригодится вам из того что мы сегодня показали ну и в заключении тоже немножко хотелось бы рассказать о планах на будущее кто знает может быть это послужит темой для последующих докладов до ближайшее время хотели пор не треть хорошо пор пол который позволил бы облегчить менеджмент секретах а также было бы важным заботиться инфраструктурой отход на железных серверах потому что на данный момент у нас есть некое решение но не совсем то что нам хотелось бы мы остановились пока на kickstart файлы которые в котором прописана то установка необходимых to lose но мы бы хотели использовать тот же подход что мы используем то лубочных серверов а именно запекать образ и уже готовый образ тепло из на железные сервера но силу определенных обстоятельств всем известны корана вирусных ограничений у нас сейчас нет доступа к серверам и вела как только границы откроется я надеюсь мы этим вопросом тоже озаботиться кажется а ты не добавил слайдов буквально посредине артём работал интересной задачей мы боролись с уборщицей главы так называемые которое включало интернет серверах на твоем джипе юшки нужно было обсчитывать задач и то есть артем интересную задачу решал все раньше он не включил то слайд то есть ивенты от консул рф чайке срабатывает для мда который определит а то скелет группу и у нас поднимается на спотах но даже пьюр в амазоне и так и клей были все те же то все заначки который должен были обшитого цена этом джикию они уходят соответственно обсчитывается в амазоне как только восстанавливается интернет опять срабатывает линдой эти задачки перемещаются уже в это центры сердце то так бы стал healing архитектур таким образом это решая на саша интересная задача тоже думал над этим но хотелось бы все таки то она еще немножечко в процессе это задача хотелось бы и уже до конца довести и уже тогда с полной уверенностью рассказывать я уже близок ну и заключение тоже еще хотелось бы добавить если вы так же как и мы работаете с продуктами хаша пор и труп застряли у вас что-то не получается полезно используют такие ресурсы как кашу порт лобби вести там такой чатик в котором сидят разработчики консул no more вы всегда можете прийти туда со своим вопросом и большой вероятностью вам помог ребята очень приветливы и до также ну как вариант их нет хоп и shews который мы также попробовали себя хорошо зарекомендовали в моем случае и да и если вдруг что можете писать мне также возможно я уже сталкивался с проблемой которую вы решаете и смогу вам помочь и аккуратно сделать на этом все спасибо за внимание спасибо артем спасибо андрей это прекрасное участники конференции сейчас говорят вам не скромничать и что у вас был хороший опыт и хорошо презентовали молодцы я присоединяюсь вообще было очень интересно послушать про нам а про вот эти вот все вещи вокруг его из чата такой вопрос приходит какой синай используйте вместе с на маты и почему как вы организовываете сети еще раз можешь это сказать на самом деле в настройки seo но и там нет ничего сложного то есть есть документации на сайте hаши пор разделе где-то в разделах нам а ведь если вас интересует какой-то конкретное решение то вы можете прям обратиться к гайду который на хорошо пар плен по моему у них есть ресурс вот и там прям пошагово расписано то есть как установить точную как если франции просто вы устанавливаете бинарник прописываете по-моему в конфиге номада соответствующую строчку и в принципе она должна завестись там практически сразу людей которые мучить какой бинарник какой бинарник ставить калека панель касино и артефактов не поводов скидку какой настрой по какое-то время назад полу честно говоря не припомню но можно просто подойти ко мне я скину ссылочку на базе длинное навряд ли окей ну да или в зуме обсудить если что-то случай такой вопрос а сколько ушло времени на изучение номады настройку вот этих штук вокруг него то есть понятно что она матата один бинарник хорошо ладно но тебе же еще вокруг пришлось построить очень много инфраструктуры ну вот просто со стороны совсем понятно сколько ты выиграл времени сравнении с например настройкой того же самым скутер нет ну я так скажу на самом деле я до сих пор работаю с настройкой на маты окружения то есть это как мне кажется работа который закончится никогда то есть можно бесконечно улучшать и улучшать делать его безопаснее более надежным более удобным начала я бы посоветовал начать наверное с готовым тира for модулем от гранд вор который позволяет то есть лежать тира форм код и прямо запустить его как есть то есть глаз с минимальными усилиями получится сразу рабочий кластер в которой вы постепенно сможете его тянет некоторые настройки добавлять функционал как тело из шифрование как и сил сертификаты консул кнр вот это вот все вот сколько у меня ушло на то чтобы выполнить всю эту работу я думаю что то около четырех месяцев или наверно уже даже больше пяти я вот этим всем занимается это пол пол и настройка да то есть как бы первые приложения были запущены в течение первого месяца уже потом мы уже по необходимости подключили потому что приходилось еще балансировать бизнес приоритеты с настройкой инфраструктуры да то есть нам нужно было какую-то базовую структуру запустить начать переносите здесь что о вашем приложении и потом в процессе откручивая немножко добавляли функциональность что решила отметить то что чтобы закрепить эти знания полученные и сделать их общедоступными у нас скоро будет открытый репозиторий где у нас будет песочница с консулом и на мадам где путь все эти фичи уже настроены это можно будет запустить в амазоне и мы планируем либо в этом если бы следующем месяце сделать питал и мы обычно объявляем в ружье корка телеграмм канале то есть сырую вам подчеркивание хаш accord то есть если в этом в этом канале вы узнаете либо например питерская метафор которых ок мы там тоже так что те кто захочет попробовать и будет еще быстрее чем потому что пасторальный сеть с здания закрепить как конца задокументировать все необходимые шаги прикольно молодцы ребята слушайте но все таки возвращаясь в отключении я слышал несколько раз такой знакомый фидбэк но мэтти что не очень сильно хватает документации на первых порах особенно по изучению его и вы не сталкивались с такими проблемами что ну просто просто недостаточно коммент ации вообще говоря проблемы конечно были но сколько я работаю с нам от я вижу то что их документации все время меняется и меняется в лучшую сторону когда мы начинали да это был бы приходилось скакать по документации по разделам как-то это было не очень хорошо структурирована не понятно с чего начать куда продолжать вот то что я вижу сейчас сделали очень классный на мой взгляд обучающий ресурс в котором на которые везли на которых попасть там примут по порядочку содержится уроки то есть ну такой некий workshop или это для умели рандат hаши коротко это шикарно и у них есть прям по сценарию по шагам там тебя ведут хочешь это включить вот тебе прямо по шагам a guy делай так то есть большую часть мы в итоге делали полярных ascii-код тот кого не писать добавляют новый сценарий если вам что-то нужно очень рекомендую обратиться к этому ресурсу приходим такой вопрос вот просто настройка всего стыка настройка кластера настройка всех этих вещей зима действия это это сложная часть действительно тут нужно много почитать ним там какой-то порог вхождения преодолеть технологии все такое но есть ещё одна сложная часть которая по мнению людей некоторых еще сложнее чем самонастройка это поддержка всего этого добра и вот из наш корпус технологии из тех что я пользовал из таких самых расстроенных это был концерт сыра форм с конским в принципе проблем нет но вот стара формам например каждое обновление каждой версии бывает болью на самом деле потому что они очень часто любит ломать какие-то вещи и отсюда вопрос не приходилось ли вам еще обновлять этот ваш дом ацтек их со всеми этими вещами особенно что сейчас nomad 10 вышел возможно до 10 там они обратную совместимость как уйти не обещали я не уверен и вы уже смотрели в эту сторону что вам придется делать до когда конечно смотрели здесь важно понимать для чего обновляться то есть если это не обновление ради обновления если вам действительно нужен какой-то новый функционал который есть в новой версии этой пофикшены какие-то пайки которых которые присутствуют поле ранних версиях да мы уже пробовали обновлять и консул и но здесь нам очень помогло то что мы используем инфраструктуру как по конфигурации серверов записано у нас в покер конфиг файлов и ну на данный момент мне достаточно лишь в одном месте поменять в этом конфиг файл и версию нам от и и пересобрать вопрос ну да лестера формам просто этот обновленный образ по очереди за тепло и на все сервера ну и перед обновлением конечно же было бы полезным посмотреть на у шимпанзе именно марк есть веб ресурс у в котором прописаны все портным compatible изменения которые вносятся от версии к версии если вы обновляете перед обновлением очень важно конечно заглянуть туда чтобы не было вас никаких неожиданностей не отвалилась переход вести себя и сидите сити тут на и 10 3 в купер над если там тоже надо получить флот почитать и сделать стекло либо дальше можно было установить спасибо за очень подробный ответ и в целом за очень интересный рассказ о вашем путешествии это круто альтернатива и в общем ваш путь описан крайне круто особенно ваши открытые в open source выход находки в общем вы просто умнички спасибо огромное александр спасибо за чудесно про транслированы и вопросы и задания тебя это было супер а дальнейшее обсуждение можно провести с двумя посылочки или продолжить его в телеграм-чате еще раз благодарю вы все молодцы"
}