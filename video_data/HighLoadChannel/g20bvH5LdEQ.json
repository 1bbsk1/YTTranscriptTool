{
  "video_id": "g20bvH5LdEQ",
  "channel": "HighLoadChannel",
  "title": "SSO-решение на 5 млн пользователей / Ирина Блажина, Николай Зайцев (X5 Tech)",
  "views": 104,
  "duration": 2600,
  "published": "2023-10-06T07:19:24-07:00",
  "text": "Вот пока есть просто время немножко переварить обед расслабиться настроиться на серьезный доклад мы сейчас будем так сказать проходить второй кликер не зарабатывал Может там Логин Нет жалко это не Снегурочка которой можно было кричать она бы заработала но нет к сожалению это не так это просто кликер О отлично Ладно так о себе мы уже сказали Нет не переключается видимо есть еще один кликер который кликает это не наш кликер это чей-то еще кликер ребят дайте пожалуйста его залу кого он есть друзья пока голосом будем переключать Алиса следующий слайд пожалуйста Ну я в общем давайте нечего то что для такого проекта Нужна команда достаточно большая потому что помимо того что это нужно по крайней мере разработать сначала спроектировав конечно же затем нужно это еще и обслуживать Да чтобы То есть были люди которые способны в дальнейшем эту систему развивать потому что как только вы делаете удобное решение в моменте точно найдутся и ваши команде вашей компании коллеги которым захочется больше лучше и добавить хоть новый функционал поэтому развитие это просто будет неотъемлемая часть такого проекта можно следующий а Да Слушайте это же техника действительно следующий слайд пожалуйста хорошо Также можно пробовать все мой работает а мой нет Советское решение лучше держи оно Надежда Давайте теперь послушаем нашу историю самого начала по ставку представились как мы какой путь мы прошли с самого начала поехали у тебя это просто на самом деле Стендап шоу это не настоящий доклад но нет конечно конечно хорошо Спасибо Да пока попьем водички Спасибо ребят что такое терпение проявляете Да мы не специально Мы правда очень высокие нагрузки Да много кликеров все кликают как бы поэтому наш не работает Нам просто не повезло быть фокус-группе попробовать А это потом будет онлайн-записи да мы все вырежем Оставьте пожалуйста Это хороший кадры пригодятся для поколений Да и так ура у нас работает важно принципе Почему важно сказать почему мы здесь у нас компания достаточно большая у нас более 20 миллионов 20000 магазинов у нас более 15 миллионов пользователей которые ежедневно приходит и что-то покупают большая компания большие нагрузки соответственно вытекающие отсюда проблемы как это бывает часто там где много пользователей там много проблем не не в прямом смысле а в плане нагрузки итак у компании Еще также много продуктов много приложений но там у нас компания работает по принципу работы отдельных продуктов каждый продукт это отдельная фактические приложения и здесь мы с технической точки зрения уже сталкиваемся с классическим законом конвей Когда у нас отдельный продукт отдельное приложение это как отдельное государство фактически и к чему это приводит это приводит к тому что отдельного для отдельного приложения нужно отдельно вести один и пароль вот здесь бывает обычно очень больно пользователям это раздражает не знаю как вас меня точно раздражает чем больше Логинов паролей тем сложнее работать Итого у нас крупная компания у нас большая клиентская аудитория у нас количество приложений также все время увеличивается еще стоит сказать что в отдельном в каждом приложении Когда у нас пользователь аутентифицируется то есть вводят логин и пароль ему еще нужно отправить против SMS и так как у нас каждый раз нужно отдельно вводить логин и пароль отправлять СМСку это приводит дополнительным расходом на СМС и тут уже больно компании это Дополнительные расходы и наши конечно же пользователи которые не очень довольны текущей ситуации нужно что-то делать мы переходим к проекту запускается проект нужно сделать удобно реализовать технологию единого входа sso чтобы пользователю было наконец-то удобно далее нужно это сделать быстро за пару месяцев это пилот и все всегда хотят быстро это силави дальше нужно нам сократить расходы на SMS чтобы компании тоже было не так больно да и пользователям хорошо компании хорошо Ну и между делом бы неплохо повысить еще и Безопасность нашего решения так как компания большая очевидно что архитектура дел распределенная от каждого приложения у нас требуется чтобы была реализована своя форма входа это то есть на полтора года назад Да мы делаем шаг у каждого приложения своя форма входа и свои учетные данные что же с этим делать нужно искать решение почему бы взять Просто ну два месяца взять просто не написать свой сервис о на самом деле быстро не будет Почему Потому что разработчик он должен обладать рядом большим количеством знаний по ряду технологий Да он должен разбираться в ряде фреймворков стандартов и как правило не так просто найти разработчики которые бы это все знал и умел но вдруг все-таки мы решили что у нас есть разработчик он пишет сам все Ну пусть это не по стандарту не по фреймворку Да каком-то мы что-то написали но тут мы сталкиваемся с другой обратной ситуации во-первых это поддержка это своя собственная реализация развития А еще вдруг взял разработчики уволился все знания ушли документации не было написано потеряли знания потеряли решение пишем сначала так себе перспектива на самом деле далее мы учитываем что компания у нас трупная в компании достаточно разнообразные как только мы делаем централизованное решение мы должны понимать что к нам придут те же разработчики из других проектов которые захотят подключиться к нашему серверу и тут мы должны обеспечить разный степ то есть мы должны поддержать разные языки разные адаптеры Это тоже не так просто не так быстро Ну и что же с безопасностью а с безопасностью обычно сложно здесь я немного отступлю и расскажу реальный пример из практики разработчику было дано задание сделать вход по ОАО 2 он его сделал прекрасно все здорово пользоватеводят в один пароль реализуется полностью Flow В итоге приложение получает сотен там если там было по опыту но все здорово Он реализовал токен получил но далее разработчик не поняла что нужно с этим токеном делать Для чего он ему вообще нужен и доступ к сервисам был организован просто напрямую без какой-либо защиты без использования токена идентификации вот так бывает то есть технологии реализовали но не поняли Зачем вообще нужно было защищать весь вход есть еще другой пример Это не наш пример это ученые из Германии провели исследования где разработчиков фрилансеров просили реализовать решение которое бы хранило при этом еще и пароли Но на самом деле разработчики они пошли по преимущественно по пути наименьшего сопротивления сделали Как проще и многие из них в принципе не озадачились тем чтобы шифровать пароль они хранили в открытом виде 10 только из участвующих использовали надежные шифры для кодирования для шифрования алгоритмы для шифрования остальные использовали не надежные либо совсем ничего не делали если кому-то интересно можете с этим исследованием более детально ознакомиться о чем мы хотим сказать если вы реализовываете свое решение Или Вы реализуете решение которое хоть каким-то образом обеспечивает безопасность затрагивает вопросы безопасности вашей компании то нужно учитывать тот Аспект что Безопасность это все-таки сложно Итак Наша компания останавливается на решение на Open Source нам решение в принципе так как у нас нет задачи реализовать что-то свое у нас Ритейл и мы берем Готовое решение Чтобы не изобретать велосипед мы используем Open Source на решение киклок решение достаточно хорошее оно умеет уже из коробки работать в два знать что такое Как реализовать технологию Если вы используете именно это решение для всех ваших приложений понимаешь что такой вопрос доменный запросы он уже имеет ряд адаптеров которые позволили вам подключаться к этому решению еще и попутно Он позволяет управлять пользователями выполнять регистрацию управлять сессиями работать с базой данных и если вам необходимо Вы можете это решение чуть доработать это готовое открытое решение у него комьюнити достаточно активная в том числе в России за последний год она тоже очень актив набирает некую популярность и комьюнити у нас растет Итак у нас есть архитектура пилота у нас теперь будет единый если свой сервер со своей единой формой аутентификации и учетные данные мы наконец-то будем вести централизованы Они отдельно в каждом продукте Привет безопасности Простите мы должны еще и позаботиться о масштабировании мы понимаем что нам придется расти и планируем архитектуру для распределенной для отдел распределенной архитектуры с двумя цодами Итак у нас есть некая выбранное решение готовое которое должно удовлетворить нашу потребности У нас есть архитектура пилота на небольшой аудиторию и есть план масштабирования до 5 миллионов пользователей это та цифра которую мы планируем получить в итоге по пользователям все спланировали А теперь давайте узнаем как было все на самом деле Да немножко о практике о том что у нас получилось и как оно происходило при обновлении первая проблема с которой мы столкнулись когда стали работать это то что при обновлении его нужно полностью перезапускать полный перезапуск кластеры клока отнимает время это время простое так как это неизбежно на начальном этапе мы договорились с бизнесом что то время которое простое если оно неизбежно будет то должно быть не более чем три минуты То есть это наш предел и вначале нашего пилота в принципе нас это устраивало то есть мы как бы были в той точке когда всем более-менее комфортно Но нам-то нужно быть по крайней мере для пилотов для быть готовыми обслужить пользователей и хорошо пришло время это не изменилось имея те эмпирические данные которые у нас были на момент пилота мы посчитали Примерно сколько будет занимать время старта кейк Лока с ростом пользователей и получили что для 300 тысяч пользователей мы получаем более 40 минут времени простое то есть на то чтобы обновить нам нужно всякий раз потратить 40 минут времени когда сервис не работает Это понятное дело очень нехорошо и первая мысль которая приходит в голову это отказаться от времени простоя то есть полностью не убивать кластер кейк лока Что такое типичная инсталляция клока это фактически если просто взять его в вакууме это некоторый контейнер в котором есть сервер приложений и есть кэш infini spent infini span можно сравнить с редисом Это примерно такое же решение только работает оно и написано на Джаве вот где-то еще вдалеке должен стоять должна стоять база данных Где хранятся оффлайн данные откуда собственно они подгружаются в кэш и начинается работа а у нас есть uber в качестве архитектора поэтому что нам мешает использовать плавающие обновления то есть полностью кластер не ронять а просто постепенно все ноды Шаг за шагом перезагружать Да и Вот рассмотрим типичную ситуацию Когда у нас идет процесс обновления из трёх нот одну ноду мы отрубили и хотим к оставшимся кластеру это обновлённую ноду снова добавить мы её добавляем и что мы ожидаем мы ожидаем что эти ноды между собой так как это кластер посикаются и мы получим полностью стабильный кластер из трех нут Казалось бы все здорово но Что происходит на самом деле на самом деле после синхронизации происходит С практической рейтинхронизация снова и снова То есть этот процесс Он повторяется снова и снова и всякий раз пока Он повторяется у нас фактически время от времени пропадает доступность нашего решения то есть Лог не работает стабильно такое решение нестабильно поэтому полностью отказаться от времени простоя На этом этапе мы не можем она двигаемся дальше получается что те данные которые оказываются в infini-спании это кэш и первая мысль которая касается кэша да давайте Просто этот кэш уничтожим он не нужен да то есть это же просто кэш Он снова заново закачается и все будет здорово но Беда в том что мы не можем его уничтожить полностью потому что среди этих данных есть данные пользователей именно сессии пользователей А теперь Представьте ситуацию вы себе установили приложение любимого магазина сделали это летом зимой решили пойти в магазин Вот вы спускаетесь подвальное помещение подходите к оси вытаскиваете свой телефон и ожидаете увидеть там карту лояльности Что вы-то можете увидеть экран входа Пожалуйста поднимите руки кому это знакомо кто с этим сталкивался да Будь честной К сожалению То есть это как бы очень серьезная проблема без всяких шуток мы к этому относимся серьезно и поэтому Понятно совершенно что мы не можем терять данные пользователей нам нужно с ними как-то оперировать получается то что нам нужно обязательно сохранять и каким-то образом беспрепятственно передавать из Холодного хранилища в горячее в чем же проблема Почему так долго происходит процесс обновления именно почему так много времени занимает Старт клока Дело в том что кейтлок должен полностью Передать все данные из Холодного хранилища в горячее хранилище из Холодного прогресса в горячей инфиниспен и только после этого он сможет обслуживать запросы А все это время он просто ждет процесса этого завершения То есть получается чем больше данных Тем больше мы ждем чем больше пользователей тем больше это все дело у нас висит мы обратились к официальной документации кейт-лока с тем чтобы найти решение которое советуют официально те кто его сделал и действительно есть решение для этой ситуации особенно когда у нас есть несколько содов это вынести инфиниспен кластер отдельно от kicklock то есть взять контейнер и поделить на две части отдельный кластер стоит и отдельный кластер кэшей получается тем самым отдельно обновляем кейтлок никому не мешаем оставляем наш кэш который стоит и не работает так что почти который работает вот и отдельно У нас есть база данных Собственно как бы в которой хранятся холодные данные все вроде Здорово Но это теория что касается практики на практике же не получается полностью отделить infinisman откейк-лока по крайней мере потому что в infini SPA не есть рабочий кэш который должен быть подвязан к каждой ноде klock А для того чтобы обеспечить синхронную работу всех нот и получается что по факту мы имеем в таком случае в два раза больше кластеров infini spena то есть и нам нужно их обслуживать Все мы больше занимаем место и фактически мы не Решаем проблему то есть мы по-прежнему остаемся с той же самой ситуации ввиду Чего нам пришлось вернуться к обычной схеме более и традиционной когда-нибудь находится вместе с кейт-локом для информации так как использует базу данных Прогресс Она не умеет из коробки репликацию поэтому используем патронник кластер которые заменяет нам это решение но как бы у нас пользователи да то есть они Вполне себе живые они страдают из-за того что у нас происходит обновление или еще хуже когда случается аварии это тоже развал кластера и все это сопровождается временем простоя и все очень сильно негодуют по этому поводу поэтому Давайте попытаемся просто разобраться в тех данных которыми оперируют кейтлок и что можем с ними сделать для того чтобы как-то это дело оптимизировать данные фактически трёх типов это локальные каши и фактически это бизнес данные которые ограничены в объёме Это только эти данные которые используются для того чтобы ускорить работу самого кейк-лока это Самый классический кэш который ограничен в размере и мы можем терять без всяких последствий Ну то есть мы получаем маленькие маленькую посадку в скорости работы если его потеряем совершенно не страшно дальше есть кэш реплицированный его главный представитель - это конечно Ворк это фактически кэш который является рабочим телом только фронтай мне нужен для того чтобы все остальные кэши могли синкаться нас он тоже не интересует то есть мы соответственно как бы если нет runtime нет кэша Нет проблем и Самое интересное это кэш распределенный в нем хранится самые важные данные а именно попытки входа информация о токенах а также именно сессии пользователей те самые сессии которые нам терять нельзя в размере он не ограничен и соответственно потерять мы не можем потому что это приводит к разлогину пользователей на момент старта нашего пилота мы использовали десятую версию лука которая была актуальна тот момент сейчас актуальная версия уже 20 но к сожалению или счастью многие механизмы работы с данными в Кик Локи остались на прежнем уровне Однако вот этот слайд конкретно он для тех пользователей у кого 10 Поэтому если кто-то у кого сейчас есть десятый блок мы собрали для вас здесь все рекомендации которые можно сделать для того чтобы данную ситуацию как-то исправить первое можно настроить infinispany можно выставить количество репликации данных в единицу это просто нам это нам как правильно сказать уменьшит то место которое у нас хранится в оперативной памяти да то есть улучшит ситуацию и ускорит процесс синхронизации потому что не нужно будет больше данные реплицировать для настройки прогресса мы можем настроить количество подключений базе данных обычный и очень важный момент то что в 10 Локи не было индекса который отвечает за выборку тех сессий которые выгружаются из постгресса в инфиниспен добавив этот индекс мы соответственно существенно ускоряем процесс передачи данных что Здорово в самом кейк Локи есть параметр тайм-аута это параметр который ставит отсечку времени после которого считает что запуск является не релевантным и некорректным То есть он в это время не укладывается он просто начинает процесс сначала Поэтому если никакими другими способами ситуации исправить не получается можно соответственно этот параметр установить то значение которое нужно хотя мы так уже 15 минут и очень важный параметр количество сессий за сегмент Дело в том что данные из спазгресса передаются в кейтлок пакетами и размер этого пакета Вы можете настроить мы смогли этот параметр разогнать до значения 12 записей большее значение приводит к ошибкам уже в самом гибернете в Кейт Локи то есть в реализации работы с базой данных на стороне кейк-лока поэтому Будьте здесь осторожны и Собственно как бы сама оркестрация то есть мы используем kubernetis поэтому можем легко управлять количеством реплик которые обслуживают нашу систему здесь нужно тоже быть осторожным Потому что если будет очень много реплик то будет у вас проблема фронтальной прессинхронизации кэшей потому что нужно дать информацию всем его нодам о том что есть кэш он есть именно на этой ноте соответственно Здесь должна быть Разумное значение мы остановились на девяти репликах нас это Вполне устраивает И что же в итоге получаем на самом деле после всех этих настроек мы получаем ситуацию такую же которая была в начале просто мы сместились по времени по шкале пользователей немного правее изменили сам характер зависимости времени простой От количества пользователей но опять же в той точке когда нас все устраивает теперь это уже 300 тысяч пользователей для пилота это Окей но впереди предположим будет 1 миллион и мы хотим быть в точке б Ну на той же прямой но окажемся мы в точке C где опять же время простое будет порядка 20 минут что неприемлемо Итак здесь подытожим то что мы стабилизировали наш пилот но это не конечное решение потому что впереди нас ждал первый миллион пользователей вроде бы как мы стабилизировались нужно идти дальше нужно расти наращивать аудиторию Но конечно же мы ожидали что это у нас произойдет Ладно пользователи будут постепенно пребывать А на практике конечно же все не так как мы ожидаем мы получаем стресс-тест напротив и снова у нас примерно исходная ситуация у нас пользователи недовольны пишут отзывы нам нужно снова с этим что-то делать У нас есть два пути налево или направо идем налево что мы можем сделать мы можем поднять версию но был Пилот никто не подумал о том что нужно бы покрыть тестами наше решение Почему Потому что на пилоте еще использовали провайдеров от идентификации которые встраиваются в киклопе это самописная реализация Kid Lock подразумевает что они могут быть как кирпичики у него стройны но при поднятии версии мы должны протестировать что они будут подходить новой версии об этом никто не подумал не можем идти налево идем направо что мы можем сделать направо если пойдем мы смогли понять что в более поздней версии в 12 есть решение которое теоретически может решить проблему с которой мы столкнулись в части нагрузки но эта версия несовместима с 10 Поэтому приходится решиться на Отчаянный форк о котором как раз сейчас основное его участник и расскажет дальше собственно так и получилось то что у нас фактически пользователи стали все пребывать и пребывать и нам нужно было решать уже эту систему эту проблему кардинально и я Изучая проект мы нашли то решение которое в целом подходит для 12 версии но 12 версии кейк-лока она по коду несовместима с 10 версии поэтому взвесив все риски Мы пришли к решению что будем адаптировать эту версию под наш десятый клик-лог Итак что же мы сделали Мы изменили те функции которые получают данные о пользователях эти функции раньше ходили только в кэш и случае если эти данных они Не находили то в таком случае они заканчивали свою работу наши новые функции сначала ходят в кэш его проверяют если там данных нет они ходят в базу данных и после этого эти данные возвращают в кэш соответственно тем самым мы получаем загрузку сессии по необходимости для пользователей также мы изменили логику функции старта фактически мы упразднили логику подгрузки сессии при старте потому что и позволили сессии позволили нашим пользователям сессии выгружать с той скоростью с которой им нужно просто потребованию у нас Достаточно мощный кластер база температура эту нагрузку без проблем выдержал Вот и соответственно также поменяли те функции которые работают самой базой данных мы добавили функции точечного получения сессии из базы данных и что мы получаем в итоге мы получили стабильное решение которое уже больше не зависит от количества пользователей потому что все сессии получаются по требованию по необходимости самими пользователями но мы получаем наше собственное решение наш собственный форк и получается все новые проблемы это наши собственные проблемы и больше мы не можем рассчитывать на поддержку комьюнити Мы уходим в опасные воды и получается что если мы захотим в дальнейшем обновиться то нам нужно будет наш Костыль который мы сделали тащить с собой дальше то есть получается что в целом решение стабильное и оно решает задачу в моменте Но это решение совершенно точно В перспективе нам не даст больших плодов это не путь Джедая Так какого же да а путь Джедай на самом деле все-таки стоит состоит в том что нужно повысить версию так или иначе потому что повышая версию мы продолжаем пользоваться продуктом всеми теми фичами которые дорабатываются есть более поздних версиях но что делать с нашей доработкой фактически начиная с 14 версии в формате preview и 16 версии уже по сути в дефолтном значении есть доработка которая логически как раз работает именно так как это сделали вот 5 ID Таким образом мы практически протестировали нагрузку протестировали решение не повышая версии то есть новая версия но не повышая версию и в целом Почему мы сейчас достаточно много рассказали вроде бы как версия старая зачем нам это рассказывать потому это фактически Все что сейчас есть В текущей версии до 19 включить на 20 там есть изменения это все работает именно так как мы и рассказали Несмотря на то что это было адаптировано к более ранним версиям Итак версию нужно повышать это вот Best practis работаем с коробочным решением максимально не отходим от него далее покрываем тестами Ну вот чтобы не было развилки да Или одного какого-то пути чтобы мы могли выбирать когда мы на развилке далее не храним пользователь в базе данных kicklock вот если вы крупная компания не нужно этого делать мы заботимся о том чтобы у нас сервис который отвечает за аутентификацию занимался только аутентификации храним учетные данные в другом месте не в базике плохо это тоже без практики это более гибкая это хорошая практика работы в крупной компании для того жить потребности Трубной компании дальше мы когда проектируем архитектуру мы придерживаемся стандартов Почему Потому что безопасность обеспечивается надежными фактически алгоритмами нам нужно безопасно хранить пароли но алгоритмы при этом должны быть надежны а это как раз обеспечивается стандартизацией проверенными подходами теми которые разрабатываются многомиллионная аудитория Итак получаем отказоустойчивые архитектуру у нас на текущий момент даже без выноса infinis Plan в отдельный кластер мы можем выдерживать нагрузку в размере около 5 миллионов активных пользователей это рабочее решение оно проверенное нашей нагрузкой Вы можете вы просто взять и использовать у себя фактически У нас есть два кластера теплока в режиме У нас есть патроны кластер для работы с базой данных и У нас есть инфиниспан который находится фактически в самом пластыре и это работает с учетом тех доработок которых мы рассказали Итого подведем небольшой итог В итоге всего нашего выступления Да мы начнем с того что sso это очень хорошо по двум причинам по крайней мере первое то что Это позволяет избежать зоопарка из решений разных команд в компании Потому что если компания есть куча разных приложений то каждая команда сделает аутентификацию по-своему с разными дырами и соответственно все это нужно будет поддерживать Это очень не очень здорово лучший вариант это когда соответственно можно сфокусировать ресурсы компании сделать один центр компетенции который будет заниматься именно аутентификации это позволит соответственно сэкономить ресурсы в целом дальше делать решение более правильным его легче развивать и второй момент что для пользователей это тоже удобно вы входите один раз в одном приложении вам не нужно в каждом приложении аутентифицироваться по 150 раз это здорово и другой момент то что сделать свое решение это немножко сложный вариант потому что для этого вам потребуется отдельная команда потому что фактически нужно сделать коробку которая будет поддерживать стандарты которые будут работать так как это будет удобно фактически сообщество которое будет им пользоваться либо вашей компании либо еще кто-то кроме этого для этого нужно иметь много сил ресурсов и компаний и команду которая сможет этим заниматься отдельно вакууме этого сделать в рамках компании которая занимается бизнес задачами очень сложно Поэтому лучше все-таки доверить решение какой-то сторонней организации Взять за основу Готовое решение которое поддерживает комьюнити в таком случае у вас есть шанс заниматься своими задачами и эффективно их реализовывать Итак если мы опираемся на какое-то Готовое решение мы читаем документацию но помним еще и о том что в документации тоже бывают ошибки И прежде чем сказать что Мы это сделаем перед бизнесом все-таки стоит проверить что то что написано в документации действительно работает потому что иначе можно столкнуться с реальностью несколько в ином виде не так как документации описано И последнее эксперименты Это классно это путь развития Но если у вас крупное решение большая компания все-таки стоит более аккуратно подходить у нас все спасибо за внимание ваш оценки ваши пожелания Вы можете поставить на вопросы готовы поговорить Да у рак вопроса Здравствуйте вы сказали о том что необходимо провайдеров покрывать тестами можете хотя бы примерно рассказать как это организовано У вас есть провайдер написанный на javascrip те и вы классическим образом пишете тесты на то чтобы какой-то базовый сценарий который реализовывается провайдером проходил при подключении вот новой версии то есть здесь все стандартно на самом деле это JAVA да вы пишете провайдер на Джаве и вы тестируете что при подключении к новой версии он не сломался то есть у вас получается тут есть два варианта тестирования первый вариант соответственно любой провайдер это фактически просто джарник который использует как Интерфейс Да То есть ему подключается Поэтому если вы пишете какой-то локальный тест Вы можете использовать интерфейс написать свою просто мог его реализацию и протестировать чисто ваш провайдер и собственно второй вариант тестирования Когда вы берете тестовую сборку ставите на него все провайдеры и гоняете уже тес снаружи Ну то есть тут вариантов не очень много мы им Так и делаем но просто мы это делали как бы ну понятно То есть пилоты отдельно тесты отдельно поэтому здесь Извините Здравствуйте Меня зовут Юрий у меня Спасибо их за доклад хотел сказать что он достаточно полезный но возник такой вопрос Вы вначале сказали что вы не готовы были нанимать команду создавать чтобы написать какой-то свое решение но по факту вы создали Fork который вы опять же дорабатывали своими силами программистами вопрос заключается в том кейк-лок достаточно часто выявляет у них уязвимостей которые нужно постоянно дорабатывать если у вас там условно десятая версия Вы дописываете то там достаточно большой стек получается вы опять же берете своих программистов которые переписывают и дорабатывают то есть в чем тогда получился Профит 1 до о чем мы старались именно весь доклад стать о том что не переделывайте исходники клока поднимайте вверх Не пишите сами не меняйте их потому что это за обстрелом краем глаза Ну вот то что мы его дорабатывали это вот как раз из-за того что мы попали на стресс тестирования напротив нужно было что-то Быстро делать поэтому ответ что команда на самом-то деле есть и она растет но она растет на поддержание уже готового решения не было команды которые бы писала это с нуля фактически Да конечно я просто сказать то что так Я участвовал именно в этом форте Да грубо говоря то есть Есть разница между написать свою с нуля и фактически даже написать свои фотки клок Мы прям по большому счету заново не изобретали Да это мне какую-то часть его просто взяли то решение Ну то есть уже есть комьюнити которые сделало решение для 12 версии для следующей версии и все что мы сделали это адаптировали его и это поверьте в разы как бы проще чем собственно писать свои команды Хотя бы даже часть Лога потому что ну там очень много всего там реально то есть этот как бы этих помников Внутри там ну штук наверно 100 Я думаю это минимум просто поэтому А еще есть такой лайфхак о котором я не сказала если вам очень хочется доработать Да но чешутся руки ваши изменения в исходники самого будущих версиях они были и тогда будет это полезно на Первом всем А во-вторых вы будете пользоваться той работой которая которую проводят разработчики со всего мира кстати из России тоже и у вас будут ваши костыли в хорошем смысле в их роде что не может не радовать ещё будут вопросы да здравствуйте Спасибо большое за доклад вопрос а все видим из просто свет извините да да почему вы используете Active standby решения а не actifective и планируете ли вы добраться до Zero Down Time решение своего во-первых у нас это вызвано тем что мы используем базы данных Она не умеет по крайней мере опыта такого У нас не было И именно поэтому у нас режим плюс сейчас технически та нагрузка которая поступает и в режиме она Вполне себе обеспечивается То есть пока такой потребности нет Да если можно Я просто хотел бы такой еще скажем вопрос на вопрос да А зачем потому что фактически Представьте У вас есть может быть даже несколько разных содах и если у вас соответственно решение в рамках одного отсюда вполне как бы выдерживает ту нагрузку которая на него поступает да ты зачем вам параллельно держать еще одно решение которое будет есть столько же ресурсов но фактически как бы ничего вам не будет давать или же предположим они вас работают вместе параллельно и Вам в таком случае нужно будет гонять трафик между содами опять же это лишние затраты и денег и как бы ну все ну как бы в принципе ресурсов компании Поэтому в этом смысле то есть задача наверное у нас принципе не стоит потому что мы можем обновляться там скажем в течение там минуты или двух если это будет происходить там в какой-то именно техническое окно то в целом никто от этого сильно не пострадает Ну по крайней мере То есть у нас нет такой оценки что это какие-то вызывает серьёзные проблемы для бизнеса то есть при условии что там остальное время это будет там четыре девятки грубо говоря Поэтому а-а в целом снизив Вот именно то время которое вам нужно на то чтобы кластер перезапустить вы в целом решаете проблему а для того чтобы сделать прямо совсем за рузеру даунта им да то есть когда у Вас Именно кейт-локи они прямо ну то есть вот вот прям на Живую обновляются Один за одним вам придется очень плотно поработать протоколом groups мы с этим начали работать честно скажу не очень получилось вот поэтому Просто если у вас получится то Ну мы бы хотели услышать ваш доклад или просто хотя бы ваш опыт нам было бы интересно чем вы тогда столкнулись Спасибо еще я дополню наверное в 20 версии как заявляется документации есть возможность вы на кластера отдельно мы не проверяли Можно попробовать и в случае если у вас нагрузка будет выше то к этому тоже можно вернуть если она будет расти Можно попробовать ребят вопрос в чате появился к вам перешел от wildfight kworks что вы планируете делать связи с этим мы как бы будем стараться мы уже смотрим именно в то что вы использовать вместо Для этого нужны тесты для этого то есть в целом получилось что все предыдущие версии Кейт лока они были поверх джебоса даты для тех кто может быть не очень в курсе и фактически Ну то есть каких-то очень больших изменений клыки не было это вот о чем мы говорим То есть фактически код который мы применили как оптимизацию 12 версии для 10 если посмотреть 19 версии просто вам даю звук вы видите именно этот код который был в том полурекласте то есть того самого автора но в двадцатой версии есть изменения то есть плотно пока мы с ними не работали но мы стремимся к тому чтобы его использовать конечно спасибо за вопрос Спасибо за ответ Привет друзья смотрите подарок вас сейчас ждет сейчас ребята будут выбирать самый лучший заберет собой подарок вопрос поэтому Подумайте еще раз а я смотрел там прикольный подарок есть Есть еще один вопрос так здравствуйте Да хотел уточнить Есть ли где-то может быть публичном доступе данные по характеристикам производительности которые необходимы для того чтобы обеспечить нагрузку в миллион пользователей Ну вот фактически вот здесь наверное Ну то есть какие Ресурсы нужны именно там Память сколько там песок Я думаю что давайте просто может быть как бы я просто за сколько мы сейчас можем прям про нашу машину разговаривать да то есть нашей компании какие у нас есть но просто именно в ресурсах я могу вот как бы ну скажем уже когда будет да там автоповать могу с большим удовольствием то есть на эту тему можем пообщаться я могу сказать если у вас это прямо интересует смотрите если стесняетесь сейчас отвечать да Или стесняетесь задавать вопрос справа от входа в зал есть дискуссионные зоны и там можно поспрашивать какие-то неудобные вопросы поэтому можем как бы друзья Ну давайте тогда уж выберем лучшие вопросы имеете в виду что это может быть вопросы зала или вопросы чата Согласен Мне нравится проект Ну в целом он самый такой наверное самый каверзный поэтому что задавал вопрос поднимитесь пожалуйста чтобы вас нашли и вручили вам подарок от X5 Touch очень жалко то что мы вас не видим потому что вы очень далеко от нас ребят Спасибо вам большое Очень классный подарок нравится вам нравится Да пойдет ребят Вам тоже спасибо большое от конференции хайлот вас тоже ждут памятные призы и небольшой презенты Спасибо большое ждем Спасибо большое Спасибо большое спасибо"
}