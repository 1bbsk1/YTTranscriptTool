{
  "video_id": "vgYg5fpXrTY",
  "channel": "HighLoadChannel",
  "title": "Особенности разработки API / Всеволод Шмыров (Яндекс)",
  "views": 1206,
  "duration": 3640,
  "published": "2018-01-16T13:32:11-08:00",
  "text": "как мне представили меня зовут всем вот мой сегодняшний доклад называется особенность разработки апию но давайте немножко по ростов расскажу о себе меня можно называть севом и так называют друзья я разработчику в компании яндекс разработчик интерфейсов участвую не посредством разработки яндекс карты конструкторы яндекс карт моим сегодняшним докладе я буду рассказывать про api я думаю никому зале не нужно рассказывать что это такое наверно абсолютно все в зале каждый день используете несколько api когда работаете с какими-нибудь фреймворком библиотекой даже когда используйте виджет потерявшие социальные сети там тоже есть какой-то армию какой-то вот такой некий язык общение между сущностью и основным приложением и вы нарко замечали что какими-то пи удобнее пользоваться ну может быть вы находили какие-нибудь явные проблемы может быть как он в полной интуитивном уровне вроде как все круто но почему то вот этим а пьют противным пользоваться и села своем сегодняшнем докладе я постараюсь ответить на вопрос какое api является хорошим что будет и закладин начале хочу сказать что-то класть будет именно наш опыт разработки api хоть api яндекс карт это и джесс библиотека ноги принципы и особенности разработки они применимы и к другим эти помоги к примеру к серверным ручкам каким-то standalone библиотекам и так далее все то чему подговорить относится именно к публичному а то есть и допустим если вы разработчик и разрабатываете некоторую библиотеку который блада это api и вашими клиентами является только лишь ваши коллеги допустим каким и другие отделы и вы можете просто ногами до них дойти рассказать что вот тут на то что то поменять то вы не сталкивать 7 проблемы с которой сталкивается разработчики публичного api а чего не будет так лотем накладе не будет ответ на просто нужно ли вам свое open я надеюсь после доклада вы взвесьте все за и против и поймете надо ли он вам вообще я был тем не менее расскажу с какими сложностями приходится сталкиваться разработчикам api какие проблемы решать и что еще делать ну давайте перейдем к основной части api я сейчас немножко анонсировал что меня будет за докладе теперь немножко более детально я расскажу про проектируя интерфейс а как это происходит что нужно учитывать кота остается какой-то новый программный модуль каким кайл какими характеристиками должен обладать интерфейс и так далее я расскажу про необходимость обратной совместимости в принципе сегодня это слово я буду возносить очень много раз обратная совместимость я расскажу про исследование собственно напиток окапи это тоже продукт и вот так же необходимо исследовать и чтобы понимать как именно пользуются пользователя и я расскажу про некоторые дополнительные действия которые нужно делать для того чтобы ваша пиво было успешным но давайте начнем первый раздел очень простой он встречается практически во всех книжках по программированию в основном это какая-то вот самая первая глава и называется быть проще api должна быть простым ну и желательно логичным вроде бы казалось но такая простая мысль о папе должно быть простым что может пойти не так но тем не менее вот в это простое слово люди вклады в сша на разные значения на самом деле степень простаты у всех совершенно разные давайте лучше сразу придем к негативным примеру чтобы бой для о чем и говорю вот несколько лет назад я столкнулся с api одной социальной сети там был метод get френдс на самом деле несмотря на то что на стадии у меня джесс спасибо код на самом деле это была серверная ручка которую написал запрос с параметром get френдс и получал список друзей для удобства я сделал жест чтобы было проще читать со слайда вроде всё логично был запрошен уж друзей получаешь друзей мой кот бойкот работал с этим api выглядел бы как то так ну вот разработчики почему-то решили что этого недостаточно и они решили сделать следующее если у тебя нету друзей то место простого списка ты получаешь ну это на самом деле некоторых его лент был нула но тем не менее но хей мой кот тогда стала выглядеть вот как-то так уже появилась дополнительные условия ну ничего страшного списанного пользоваться этим просто но разработчики решили на этом не останавливаться и сделали следующую лойк уезд у тебя один друг то возвращается не список возвращается ну а возвращаться именно один это единственный друг а то тут уже все понятно что это уже api непростой нелогично это какой-то мой кот уже стал где так на принципе тоже ничего страшного ну два условия что никаких проблем проблемы здесь кроется в другом что абсолютно все разработчики которые используют оперетта социальной сети пишет вот этот один и тот же код потому что без него ну или может быть немножко другой но тем не менее все разработчики будут писать какие-то дополнительные проверки для того чтобы работать с и хотя наверное где-то здесь можно провести эту линию и сказать вот плохое и хорошее хороший обед который не оставляет писать лишние вы получаете используйте какой-нибудь метод api и даже работаете там допустим с данными и вам не нужно писать какие такие страшные условия ну давайте подытожим значит api должно быть простым и логичным оно должно быть консистентными тут подразумевается то что если вас вопи есть методы которые работают с одними и теми же типами данных этими типа данных должны быть описаны одинаково ну к примеру нас часто в api карт используются тип данных координаты они у нас представлены вот как показано 2 точки виде массива широта-долгота я не у нас везде так описано то есть у нас нету методов которые принимали бы объект x y там объекта лом голод или там даже двумя объектами они везде представлены именно массивом даже никакими ему специальным типом данных point принципе отдельную историю но все высказаны конечно не должно уйти ущерб возможностям сочувствую простой интерфейс невозможно сделать по некоторым причинам к примеру есть некоторые сложные задачи которые просто ну невозможно описать просто съесть задача которую требует примерно вход много параметров бывают такие задачи или результат работы вашего метода вопия зависит от некоторые 3 страны тут конечно каждую ситуацию нужно рассматривать отдельно и у сейчас я немножко расскажу как мы решаем такие проблемы но первый случай например есть метод который понимает акиму 4 аргумента мы стараемся как нибудь вывести наиболее популярные кейсы и записать стандартное значение параметров таким образом чтобы они шариков скейте популярный кейсы но чтобы большинство пользователей в данном случае пользователи это разработчики используют api есть некоторые путинцев терминологии пользователей пользователь open писали не чуть-чуть кода то есть они вызвали метод передавать какое-то минимальное количество необходимых аргументов для решения более сложных задач уже расписывали дополнительные аргументы или же мы часто группируем некоторые параметры по объектам но это тем меня в jest на других языках это тоже часто к этому примеру приходит к примеру передает какой-нибудь класс или три просит привести к для какого-то конкретного класса или интерфейса то есть на пол случае у нас есть объект reject он может обладать определенной геометрию может быть . или ней полигоном у него есть определенные свойства там название описание и у него есть опции цвет и так далее вроде как между всеми этими аргументами особо разницы нету но математических разделили что было удобней да и прям скажем геометрию люди меняют значительно реже чем тоже опции лью properties также мы делаем специальные программные хелперы и как я сказал где объект может быть точкой линии полигоном ну вы поняли что примеру там . my place марком пользуется значит им чаще сделали специальный класс который на вход принимает не абстрактную геометрию а только лишь координаты пару координат для обозначения места . соответственно и то же самое сделали celine стрингами 40 тенге из полигоном а вот keys неопределенный результат это совершенно другая задача тут бывает так что нормально сделать не получается и приходится тогда уже практически кстати говоря городить так тут еще собственно что все лашко стали увидит поэтому нужно думать к примеру вопи есть метод geolocation get который возвращает promise который будет зарисовывали ну или текущем местоположении пользователя или заряжать чем ошибкой в принципе то что вообще возможна ошибка в принципе из за того что вообще возможна ошибка нам пришлось данном методе использовать именно promise но не только за этого еще из-за того что все таки это синхронно geolocation get по умолчанию использует браузерную гео-локацию мы как джесс api зависит полностью от браузера какие-то браузеры уже поддерживали api гео-локации какую какие то нет и вот в тех случаях ростки кидали reject но даже те которые поддерживали не всегда работали правильно что происходит человек разработчик написав котики locations guide дальше в коде этот код исполняется браузере вырезать такое окошечко и пользователь уже в данном случае пользователь сайта может нажать до нее соответственно разрешить сайта получите кучу местоположения своем или запретить not некоторых браузеры были баги если человек нажимал на крестик у которой находится там справа или нажимал где-то на странице также пропадала и ничего не происходило я locations guide не возвращал не какое значение promise we sell без значение получается поэтому нам пришлось здесь кварте тайм-аут просто вот такое железобетонные решения если в течение 30 секунд человек ничего не нажала или там куда-нибудь кликнула то кошку пропала то мы кидаем джек time out now некрасиво ноте не менее зато он повысил немножко стабильной все-таки нашего кода потому что браузерной данном случае лажает лан перейдем к следующему разделу он краски посвящен обратной совместимости вас 40 был такой случай вот вы отдыхаете возможно это выходной скорее всего эту ночь вы расслаблены вдруг вам кто-то звонит и говорит что ничего не работает вроде вот ваш продукт сломался вы вспоминаете что последний релиз то был там недели три назад и вроде как все хорошо и ничего не должно было соваться ничего как говорится не предвещают беду предвещало беды там мы срочно достаете из под кровати ноутбук подключаетесь к рабочей сети открываете какой-нибудь отладчик начинаете смотреть что происходит и вдруг понимаете что с вашей страны все хорошо это сломался какой-то пи который вы использовали точнее она даже не сломалось она работает просто она стал работать по-другому так как вы ожидали тут как раз таки в этих случаях произошёл слом обратной совместимости сама брата совместимость это гарант того что однажды опубликованный интерфейс будет поддерживаться и в будущем в принципе хорошо буду бесконечности на самом деле поддерживаться в рамках текущей мажорной версия но вот только тоже с этим сталкивались и в принципе что можно был рассказ про брата совместимость ну всё логично сделал работает не трогай вот оставь как есть я сделала что-то новые то там дело где в стране старой не трогай но не все так просто обратно совместимость накладывает очень сильное ограничение на разработку любых новых компонентов любых новых интерфейсов вот про это я поподробнее сейчас и расскажу во первых когда вы решать опубликовать новый интерфейс вы должны подумать про степень свободы разработчика сейчас я подробно расскажу чем больше 700 года разработчика тем больше ресурсов на поддержку вот допустим вас есть один модуль часть может его использовать по одному все просто создали модель и он работает человека вую разработчика вы использует потом воспел второй модуль появился уже какая-то может использовать первый модуль 1 и можно 2 можно использовать месяц обама для месте потом вас появился то модулей это мы уже вот этих комбинаций каких-то непредвиденных ситуаций которые вы даже не можете предложить который может придумать разработчиках так как разработчиков много вы все-таки ну-ка ваш команда разработки 1 то соответственно повышается риск возникновения какой-то непредвиденная ситуация ошибки и так далее и соответственно еще очень долго все это поддерживать приходится писать дополнительные там uni-t степан цены интеграционные тесты перед каждой минорной версии вы все это проверять это дорого нуладно вытерпишь или что некоторые сущность нужно опубликовать тогда нужно думать о том что интерфейс должен быть расширяемым могут давайте тоже тут придем к примеру примеру у нас когда-то был метод . сейчас есть баланс и от падежам туда можно было передать две координаты широта-долгота обозначив как x y потому что они просто на свадьбе не поместились ест его название вписывал но как и говорил ранее у нас все координаты записываться не двумя аргументами одним так как это они оба являются обязательным аргументом поэтому лучше их скрепить в один аргумент и память всего как обязательный потом подумали что хорошо было разрешить передавать в кроме широты и долготы еще и проекцию у нас есть некоторые проекция по умолчанию но люди при желании могут задать какой-то собственную проекцию проекция того как будто ваться координаты мы могли бы добавить опцию про action но потом нам бы потребоваться только добавить какие-нибудь дополнительные опции тогда мы решили что сделал лучше хорошо absence внутри укажем проекцию и будущем можем добавлять любые другие ключи то есть мы сделали интерфейс расширяемым и он нам никак не блокирует будущую разработку как раз таки вот все то о чем еще говорил нужно для того чтобы понять не станет ли ваш новый интерфейс блокером будущем давайте тут тоже сейчас сразу приду к примеру когда то давным давно мыши опубликовать метод get layout у сущности overlay ну я не буду рассказывать что такое бирлик скажу то что это некоторый визуальный к визуальный компонент на тот момент у нас был один единственный оверлей единственный я утка который был реализация класса html и ялта но ok мы могли бы опубликовать интерфейс так тогда был мы будущем столкнулись проблемы мы не могли бы создавать другие я вот и кроме как html поэтому мы подумали и решили что лучше сделаем метод который возвращает интерфейс ой layout который по умолчанию возвращать html человек уже разработчиков использовано в зависимости от своих нужд может поставить опцию который переключит макета примеру на canvas layout на какой-нибудь там белая вата свои голая от то есть интерфейс получается уже будет шире май хотя принципе ему потом еще подумали добавили общей promise потому что поняли что нужно делать , и если метод станет асинхронном у нас будет возможность в этом месте добавить под кружку модулей то есть пока человек или пока макет не отобразился на странице модули которую нужно или его отображение даже не загружена это принципе очень удобный получается расширяем интерфейс но ничто не идеально рано или поздно любой api просачиваться некоторые ошибки бывает так что просто какой-то было принято неверно архитектурное решение в нашем случае бывает то что вот мы и завязались какую-нибудь браузерная пробрался на питон взяли и закрыли такое тоже бывает конечно камень в огород браузеров но тем не менее бывает то что пришли к выводу что некоторый интерфейс неудачный и превью нужно его переделывать некоторые рабочие в этом случае начинают помечать методы как deep реки и тут мы эту практику не очень приветствуем новых к сталкивались когда есть api где там допустим 40 мажорных релизов в течение шести лет какой-нибудь метод появился в 11 версии v15 стал теперь кита то в 20 вообще удалили и ты сидишь в документации даже понять как и травм как вообще работает приди прикид методах апельсин очень сильно разрастается и документации пользоваться становится не так удобно и примеру часто используем алиасы на тоже такое решение не очень хороший скорее от бедности подолян сами подрывается к примеру то что нас вот есть макет иконок мы вот в данном случае используем оба варианта написания слов угрей так как часть пользователь пишет по-американски я часть по-английски принципе мы тоже самое периодически даже делали с метлами когда находили опечатки но самое главное обратно с вместимости то что не все можно исправить периодически приходится просто как поется моем любимом мультике отпустить и забыть где-то примерно полтора года назад и там чуть больше мы приписывали backend api сатой сервер технологии на другую ну там на санкиртана но да но это не так принципиально разработчики который использует api использовали а после таким образом вот есть на складе ссылка человек или подключал скрип на странице и все прекрасно у него работала мы переехали народу и вдруг пошли жалоб от пользователей мы не поняли в чем дело смотрим них действительно ошибке на странице а дело было в upper санте часть пользователей где-то копировал ссылку и копируем ссылку со спиц символом который ваш тиммейт трактуется как амперсанд их хорошо работает но часть пользователей копировал эту ссылку как есть оставляли и специальные законы загрузчики скриптов и соответственно сервер уходил именно такой запрос и самое странное что старый сарай backend прекрасное это обрабатывал потому что то есть в нашем случае у нас же сашок происходило следующее получается вместо параметрам от приходила ; мод стал бы контент обрабатывал потому что на сайт не очевидно он считал символ . запятой наравне с символом а персонал то есть разделителем get параметров то есть если говорить есть начать рассматривать какой список и параметр приходил на приходил link моды и куча пустых а мeтpoв но вот нам эти пришли жить мы посмотрели сколько пользователя делает такие запросы к нам и поняли что мы не можем объяснить то что так делать не правильно поэтому про запилили поддержку забыли metal gear который добавляет то удаляется amp и из get параметров и только лишь после этого их обрабатывать до это глупо но приходится из таким жить но не все так безнадежно как я всех напугал обратная совместимость сделаешь ошибку на все будут последовать до конца твоей жизни на самом деле не до конца до следующей мажорной версию где-то примерно года три назад мы решили выпустить на версию api версию 21 мы ее на сам решили выпустить потому что мы решили обновить список браузер в котором поддерживаем версия api 2 0 она была уча сторона поддерживал даже интернет эксплорер понимаете да какой то боль поэтому решили что нет в какой-то момент выкидываем выписали 21 но к сожалению мы там все еще подержим е83 года назад это был достаточно актуальный браузер и и прямо скажем и сейчас тоже к сожалению я сейчас я вам скажу по секрету то что только между нами то что в будни доля и 8 где-то порядка там четырех процентов а на выходных она проседает поменьше процента просто тут каждые выходные в воде не такой так что если у вас на предприятии используется и обновляйтесь хватит терпеть так вот мы решили выпустить новую мажорную версию обновить список браузеров обновление списка браузеров это тоже сам обратной совместимости 2 браузерах api его работ с ним будет поэтому мы назвали эту версию 21 но так как муж равно обновляем слонов ломаем обратно сместим из решили пуститься во все тяжкие сломать обратно совместимость даже там где это не было необходимо мы почистили код от всех тех вот алиасов каких-то вот люди прикид методов нас нету но вот почистили код от алиасов от каких-то костылей которые на был необходимо поддерживать за брата совместимости примеру мы могли бы тогда братьям но этому уже обнаружили несколько позже и вообще произвели чистку от удалили некоторые вот старые полифилы для е6 понят что мажорной версии это тоже не панацея вам все равно придется выпустить новую мажорной версии тоже стресс для разработчиков которы использует ваш опе им придется заново читать документацию какой-нибудь миграционный файл поэтому все-таки мажорный вертины лучше не баловаться если перейти к первым пункта выпуск можно дверцы все равно заставит их переписывать код что говорит о том что ваша был бы не таким хорошим если бы вы не оставляли это дело с пользователей частичным решением является специальный режим работы в джеймс есть такой режим работы но сейчас уже почти нету кроме раньше был строгий режим когда вы пишете тот же самый код визуального где также но трактуется он немножко по-другому у нас есть похожие режим работаем продано служит совершенно для другой цели у нас есть этот параметр card or dark которым можно управлять порядком координат мотивчики в которой говорил раньше по умолчанию у нас широта-долгота можно передать долготу широту просто в разных герой системах использовать разный порядок координат есть допустим какой нибудь базы данных в декары над хранятся строчки и людям удобнее просто вот ровную прямую работа сопи так соответственно при указании get параметра получается другой режим работы все api работать немножко по-другому ну в нашем случае это не так заметно но тем не менее внутри там при расчетах это часто нужно учитывать что еще можно сказать про брата совместимость что обратно совместимы влияет не только лишь на копен как можно было подумать если вы разрабатываете визуально опять ну то есть ту api который что-то показывает то вас есть обратная совместимость и на визуальную составляющую совсем недавно в данном случает буквально там пол месяца два назад мы выпустили новую версию минорной версии api где мы обновили элемент управления карты они стали более цветами более плоскими как сейчас модно но вы заметили может быть то что они практически не изменили свой размер там немножко скачиваться того что слайда нисколько не совпадают почему мы так поступили мы могли в теории сделала скинуть большущий кнопки сделал сектор полукруглыми изменить иконки ли общего брать конки мы тут тоже уткнулись в обратно совместимость когда мы создавали control of api мы подумали что было бы хорошей идеей дать разработчикам возможность добавлять собственные элементы управления и добавлять их среди наших то есть не сверху а вот прямо среди соответственно если мы сделали стандарты макет кнопок больше то у разработчиков на сайтах поехала бы верстка допустим они добавили там у нас по умолчанию 5 кнопка не добавили чувствую у них бы все перескочила так что даже с таким приходится смириться и и ну я скажет им это у меня ожидали когда опубликовали элемента управления но это тоже приходится учитывать при создании новый вид минорной версии что еще можно сказать про борта совместимость очень часто обратная совместимость ломается каскадно в нашем случае ломается что-то браузере ломается что-то вопи у нас был в такую книжку грустный забавный случай когда в одном браузере у которого примерно 60 не тоже помню уже 80 процентов доля пользователей в событий mouse wheel друг поменялся знак курсе ул колесико мужскую тебя приходил не плюса приходил минус естественно когда человек пытался приблизить карту колесико мышки она начинала от него отдаляться нам за два дня вот пока браузер это не починил вот они выписали быстренько fix через два дня у нас всех докатился нам приходил за где-то примерно порядка трех тысяч писем в день чтобы понимали обычно приходит где-то порядка 10 писем в день в случае это в самую такие напряженные то есть людям прямо вот реально это вот доставил боль и неудобство то что карту поменял вдруг резко свое поведение но давайте перейдем в следующем разделом этот раздел конечно больше посвящен джесс api но тем не менее он торт остаточный крейсер api камере же сопи работает в чужом контексте что это значит ну допустим есть первый сайт который использует api карт там все хорошо работает и есть второй сайт который использует api карт но он ещё использует и библиотеку джек вере тоже все работает нормально а есть третий сайт использует api карт и некоторые иглу джесс который зачем то переопределяет базовые методы пример массива данном случае ошибка в том что индексов не возвращает -1 но человек решил видим поддерживать и f6 не проверил существование настоящему индекс слов и написал такой apis тесно в этом случае ломается или примеру мы сталкивались в этот реальный код человек зачем ты написал такой css селектор который заставляет абсолютно все на странице быть анимированному когда меняешь размеру экрана браузера там просто пока мир меня ноутбук начинает по моему уже работать как которую на коллайдер там такие звуки страшно издает в принципе я в рамках этого доклада не буду сейчас подробно рассказывает как с этим бороться с меняется возможно я об этом более подробно рассказывался в другом докладе скрипт в айфрейм данном докладе я просто хочу подчеркнуть то что на это тоже нужно тратить 1 курса обычно у нас происходит где-то с вечным образом канал в саппорт приходится жалобы пользователя то что что-то не работает он прикладывает ссылку мы ее открываем смотрим ага на пьешь что-то сломалось начинаем смотреть его css его джеймс и это не всегда бывает удобно поскачу отметить то что это тоже придется тратить время если вы разрабатывать именно библиотеку или другую другой api который внедряется в чужой контекст что еще можно рассказать про пи api как и говорил раньше этот продукт и вы также не знаете как вашим продуктом пользуется когда-то версии 2 0 мы столкнулись тем что очень много людей выдавал такие маленькие карты а мы про такие спрос не подумали вот белая карта карта малюсенькая 150 на 150 пикселей видно что то все control друг мантру наехали а мы просто когда вы задавали 20 об этом не подумали кому нужна вот такая маленькая карта то но когда мы это увидели два один мой поработали над этим там видно control и все уже помещаются и сделали адаптивный control и ночь простое решение чем шире карты тем шире control и соответственно больших картах поиск допустим полностью отображается она маленькая кнопочка по клику на которую об сверху уползает поиск но это стало возможно только лишь после навешены не кучу метрик на собственные методы api ну тут я хочу отметить то что если вы заработаете api вам необходимо постоянно собирать информацию об использовании может быть вам кажется что какой-то модуль важная на самом деле им практически кто им пользуется и тогда можно не пол стука что его забить но скормить временем уделять важно понимать как именно использовать ваша период у нас в случае пример важным параметром был размер карты мы кстати stalker с тем что за 30 лет как и маленькие карта так и большие у нас даже нет реки периодическое вскакивать значение типа там пять тысяч с чем-то на 4000 с чем-то не знаю видимо какой-то стенд где эта карта я даже насколько она открывает а потому что он стал чтоб только toyota загрузить достаточно много времени и конечно нужно собирать формацию об окружающей среде в наш случай это браузера что понимать какие браузер нужно поддерживать и нет какие можно уже перевести типа в слабую поддержку это тоже важный пункт от себя добавлю тоже чтобы еще лучше понимать как люди используют ваш опе вам нужно использовать самим апию знаете не просто абстрактным там вот вы знаете как работает какую-нибудь там не знаю документированный метод использовали а постараться придумать задачу который бы решил разработчик помощью а shape примерно так я несколько за пытался делать приложение для вконтакте у карту где люди могли бы отмечать где они путешествовали ранее просто ставиться метка там сбоку был бы список друзей и ты мог бы открывать карту друзей и делиться шерсти на стены но это было уже года четыре назад в 3 и пока ездил в приложении я нашел очень много узких мест в документации где будут просто не очень понятно как это реализовать понимает звучит странно как бы разработчиков минусом критикую документацию но это было просто необходимо я просто вот как постарался очистить сознание в таком состоянии открыл документацию и пытался думать как разработчик и прочего нашел несколько достаточно критических багов работы api внутри oriflame а просто он про этот кейс как ты не думали а он оказался login вконтакте открывает приложение нашему приложение через айфрейм соответственно там эфиром открывается другого домена и там есть свои особенности работы пример событиями которую мы счастью за фиксили тут и сквозь упоминал про документацию в любом так ладьи пропин наверное этой темы невозможно избежать хотя она конечно достаточно модным это то что никакой pi не может быть себе документация api documentation не опять документация это как раз таки документ который подтверждает публичке методы которые должны обладать свойством обратной совместимости у нас документацию пишут сами разработчики через долг у нас есть как и справочник по все методом так и есть некоторые вводные статьи как пример подключите при как создать карту но опыт показывает что людям это не очень интересным то есть ну да при желании они могут зайти в документацию почитать но когда разработчик еще не работал с вашим api нашем случае с картами они зайдут какой-нибудь поисковой системы наберут создать карту доставки отметить карту доставки что-нибудь такое и соответственно в документации документация по такому запросу не будет выдано потому что ну а на рассказ про был более абстрактные вещи поэтому это нужно создавать специальные стенды где с вы собирали бы каким популярны кейсы у нас таким стоян например является песочница ну это буквально обложка где тут можно посмотреть на живые примеры использования api там слева codes правый результат морда что-то подправить импортировать и экспортировать на джесс виду но и тут не все так просто как могло показаться сделал точно все прекрасно однажды мы заметили вот такие карты ну вроде как все порядке там card карта а если приглядеться можно видеть что тут два почему тазом контрола мы стали думать почему так получилось и оказалось что в одном из наших пример было 2 зам контрола мы хотели сделать пример с элементами управления на карте и подумали что будет хороший день добавить глазом control room смотрите у наступить большое за мкад роллы и маленький он работает итак а так люди разработчики несмотря просто копировали код как есть и вставляли себе на страницу ну ладно и конечно их воли но мы и после этого решили что в примерах будем делать максимально живые кейсы ну то есть если есть кейс про поиск то только лишь этот поиск будем освещать никаких дополнительных крутых опций которые могут и не потребоваться большинству разработчиков только же самые необходимые конечно же еще никакой api невозможно без обратной связи нужно общаться с разработчиками которых скорость вашего api у нас для этого есть кубик там разработчики api общаться с разработчиками которые используют api конечно нас еще есть техническая поддержка но тем не менее все равно часто просто переадресует непосредственно разработчикам потому что кто ещё может ответить на вопрос который возникает у программистов кроме как программиста у нас еще есть клубы в социальных сетях и в принципе вот любой фидбэк это тоже очень важный звонок если вам часто жалуются на то что каким-то методом не понятно как пользоваться почему люди могут даже не очень четко формулировать свои мысли вот периодически человек приходится какой совершенно какой-то вот каким-то страшным котором в голове как там сделался омона самбина совершенно другой модуль тогда следует задуматься что возможно можно что-то поменять самом и поменять в документации сделать какой-то например песочница это очень хороший всегда индикатор также кроме песочницу документации обратную кроме фидбэка еще необходимо делать некоторые рекламные страницы так как часто api вопроса выбора пи лежит не на самом разработчики она его руководителей или менеджеры который может не быть программистом ему пугают все вот все вот эти страшные символа ему нужны красивые лендинги с тем как работает ваша api просто с результатом этот на эту тоже нужно тратить время начать доклада я говорил про в пункт озвучил пункт будь проще но можно пойти уже еще дальше зачем давать зачем оставлять разработчика программировать если у вас есть какой то наиболее популярный кейс его можно решить через какой-нибудь специальный инструмент к примеру наш полярно кейсом является просто зато его отображения карты на странице или там же не карта страниц каюты меткой поэтому мы сделали конструктором человек открывает браузер карта на клики был отметки рисуют линию полигоны там задает описание и получает код для вставки на сайт все логично и просто но и тут не все так на самом деле просто как кажется на первый взгляд конструктор на данном случае у нас есть другие подобны инструменты но по сути конструктор является ложку упрощенной версии open и могут пользоваться даже не разработчики тоже учетом накликал получил ссылку вставил свой html все работает в красном но мы деле даю меньше свободы разработчикам и это намеренно шаг сейчас я поясню человек когда получает код для вставки на сайт он получает ни тот же самый код который был оон спа гомер лапе он получает скриптик который подключает специальный модуль который уже сам загружает api и на основе данных которые человек указал в конструкторе создают карту он данном случае может управлять разработчик небольшим количеством параметров примера только лишь шириной высотой карты если он создал карта в конструкторе он потом на странице никак не можете с ними нужно взаимодействовать с поставить другой центр добавить метку и так далее мы это сделали не намеренно потому что это очень хороший способ обойти ограничение обратной совместимости но то есть если чек не может в данном случае ничего контролировать то мы можем для все что угодно так примером и в этом виджете в какой-то момент спокойно так учили версию с 20 на 21 вообще ни одной жалобы не было всё замечательно если бы мы дали возможность программ что-то вставлять там это либо большую степень свободы разработчикам и соответственно это привело бы каким-то неизвестности каким-то ошибкам так что возможно вам и не нужно при возможно вам нужно какой-нибудь такой инструмент который позволяет что-то делать легко вместо пи но нашем случае сейчас есть разработчикам требуется легкий см и андуин конструктор если более сложный там допустим нужно уже сделал с какой мы там боковое меню рядом с карты как ты сама действия сделать про вязка между этим меню и карты там и это должен командуем upper но давайте подведем итог как и сказал хорошая api не заставляет разработчиков писать лишнего она всегда помнит про обратную совместимость и вдруг случайно или намеренно не ломает и и рабочих которые создают api и следует свой api чтобы понимать как люди пользуются какие параметры вставляют на что следует больше времени уделять на что меньше и так далее на этом у меня все меня покорил в конце доклада есть пару интересно ссылок это нашей документации и ссылка на тот другой доклад где я рассказываю про ограничения странных перри определений ну и сейчас я готов ответить на ваши вопросы ну и в целом я сегодня полдня где-то под будущую мотаться он может быть судим посмотрю окружностям здравствуйте не один из тех недовольных то никому не понравилось инвертированный scroll проблемы не два дня месяц но это еще зависит от того как пользователи склонны обновлять следующий молдаванки крупной обе для яндекс карта и я считаю что сколько не пиши а лучше документация это типизация соответственно вопрос почему вот эти парни типизировать и почему мы типа не создаем сущности типа point и так далее нет я например про typescript потому что все робот использует как скрипт далеко не вся ну я например не знаю крупных проектов на которых не используются ну вообще api карт появилась задолго до typescript а я тут как бы это у нас часто спрашивают вопроса почему api пример не стоят реакций раньше спрашивай чем api использует же квиррел есть определенная мода в индустрию которую во-первых рано или поздно пройдет во вторых на них ездили туда же услышали этом зале кто-то начал рассказывать есть люди которые просто не дают из окна ты кстати я вот сам в прошлом actionscript разработчик и меня принципе нравится типизированный языки на если не знаете actionscript это тоже диалектика скриптовых который в 2010 году призывался то что сейчас есть в из 6-и в темп скрипте ну просто есть ему гипотетически вот мы сейчас возьму выпустим api 30 на typescript а то это повысит порог вхождения людям для того чтобы использовать api против еще использовать typescript то есть смотрите есть две возможности использовать типизацию либо ты пишешь на этой ted скрипте ты подтягиваешь живешь к вы рядом с ним лежит да . но то есть требуется пансино жск кроме самого ага да я-то уже минус большой многие не хотят использовать краски библиотеки когда у них есть публично зависимости мы поэтому и не использовал это залив на раннем этапе разработки то есть пруди и уже нет но в праге люди-то используются не типизированные тогда данное да то есть типизация существует только на этапе разработки она работает чисто как документации для аналитики поле это понятно но тут еще и другими есть моменты ну кроме того что сказал что все-таки повышение порога вхождения даже есть ничего не появилось подключать переписать всю api на typescript это тоже задача достаточно нетривиальная хотя выпускать отдельной типизацию чтобы люди пользовались наши даже когда люди пишут на java скрипте редактор видит что есть типизация и даже на java скрипте работает autocom притом у людей выскакивает типизация соответствии с документацией там какие параметры принимают что принимать что она возвращает все это безумно удобно подумаем но не знаю я чуть не уверен то что мы на это решимся потому что все-таки это достаточно 3 потребует много ресурсов спасибо с тем большой возникло несколько вопросов к тебе например вот когда вы ушли на версию 2 1 и решили проблему сидишь и были ли проблемы в сафари потому что бытует мнение что сахаре это современные проблемы как player на момент выхода и 21 проблем сафари практически не было сейчас есть вот и сейчас сафари то уже практически 2 е в какой-то момент android browser был второй есть сейчас уже даже он стал правление стоит сколько сафари в самаре проблем основном с тем что у них всё таки достаточно долгий цикл релиз где-то там развод вообще вопи к этому api 21 мы писали племен так три три последних мажорных версий браузеров всех кроме и так как там тот же edge уже тогда появился там первая версия той да сейчас мы сафари сталкиваемся с проблемой насадилась углов долгое время проблему супер 12 так как все-таки постов как опера пришла на blink совсем не наливайте использовать или отказались обновляться но в конечном итоге им тоже мы видим что переходить потому что все таки уже опер 12 развивается еще это вопрос про тайм-аут который 30 секунд получается если пользователь зашел на вкладку перешёл на другую вкладку там всю эту поделку им в полностью на карты тайм-аут уже прошел и кету то появилась да ну я говорил то что это не очень хорошее решение но это лучше чем метод который никогда не получает значение то есть это решает большую часть кейса но тут всегда такие вопросы всегда приходится искать наименьшее зло а потому что зачастую другого выхода и нету начала документируйте api вы потом менеджер или кто-то дописывает чтобы более как бы приятно для пользователей будут написаны нет да отдельно уже совсем недавно была конференция гипер батонов которая посвящена написание техническую документацию ты индекс там краски уступала мой коллега из документация и она рассказал про процесс прямо сейчас мы иду кататься пиво общин английском пью шум и по сути потом переводчики приводит его на русский ну потому что мы решили что нужно больше времени уделять анализ к документации на страже это было писать на русском переводчик переводил на английском это занимал долгое время сейчас решили немножко сместить вектор и по сути переделали его но в любом случае есть 2 мин татар который во первых вычитывать текст на предмет всяких ошибок нелогичности потому что ну опять таки у всех своих критерий понятности ведь человек может написать вроде как понятно и предложение а там по сути штатно ливийском и плюс еще до комментаторы хорошо пишут всякие статьи как ну типа первые шаги подключения api и так далее the top необходимую хотя конечно они часто консультироваться с разработчиками потому что есть всякие тонкие моменты такой последнего просто как анализируйте информацию это браузерах и методах используемые то есть вы яндекс метрику использовать или ну метров не использовал тому что тоже дополнительно жизнь библиотека но у нас по сути есть собственный сервис потом от celine get запрос с параметрами может быть заголовками дополнительные дальше просто во втором этаже внутри api на вашей стороны все приступили на пленке но на клиенте также дана славится здравствуйте она еще и сейчас кончу отвечу еще естественно смотрим логи то есть пример выпав с там случае виджета конструктор мы можем просто пологому обращение понять какой размер карта бита вставляет ваш варвар я хотел такой вопросик спросить немножко не по теме вы часть рассказывали про какой-то внешне api а вот мы не могли бы вы что-нибудь подсказать про внутренние какие честным best practice и всякие существу библиотеки ростом мир с сокетами работа и так далее чтобы внутри своего приложения общение клиента сервером как-то как сейчас лучше делать но это зависит в большинстве случаев от задача я данном случае могу рассказывать тоже из своего опыта ну как говорил я раньше работал в нашел рабочих написано скрипте и приходилось писать в бэг-энд мы использовали и обычную модель клиент-сервер где клиент посылал у команды серверу потому что бы стрикис это было достаточно мы же использовали постоянно подключение через ну там не через babes опыт на socket ну по сути аналог этот стенд обучения но это тоже зависит от задачи то есть нам требовалось примеру допустим там происходил бой и люди должны были все го клиент которых а здесь бою должны были синхронизироваться тогда естественно вне вы используете постоянное подключение к серверу потому что в одной комнате может быть да пусть не больше восьми игроков один посылает команду и всем приходит формации о том что там произошел удар но когда человек и вне боя то мы не держим спину воссоединение потому что в этом просто как то нет необходимости то будет уже какой-то мир хоть тогда удобнее чтобы человек периодически сам послал там кликнул почему-нибудь пошел запрос к серверу и сам работал в данном случае я не могу подробнее ответить на вопрос потому что все зависит от задачи нужно смотреть скажу что риск не идеален мы тоже там допустим разрабатывали какой-нибудь внутренней сервис-лист и очень быстро так алисе него ограничению то ли допустим приходилось сделать некоторые допустим патч методы для того чтобы работать сотнями и тысячами объектов они потому потому что иначе это было бы не очень производительно так что кадра все оценивает семена с позиции того что вам нужно на самом деле сам лучшее решение для кати ваш решению в программировании нет идеального решения кто бы не навязывал сейчас мысль одно время vds была популярная мысль то что сам лучше интерфейса синхронности the promise его сделали всем понравилось отчасти пользователь не понравилось появился появились генератор и они тоже не всем понравится появились осинка вы это они отлично мне очень нравился и вот скажем во первых есть моды есть разные задачи и нужно сюда смотреть по ситуацию понял спасибо привет спасибо за доклад очень интересно у меня такой вопрос вы в процессе разработки сравнивайте свой 5 с другими популярными сервисами от google maps если да то на данный момент в принципе как вы считаете что более удачно у вас что у них может просто переняли может быть вы наоборот там увидели у них какие-то ошибки и смогли их избежать мы сравниваем себя с другими api в основном и конечно это сравнение происходит вас позиции производительности ну потому что интерфейс переносить не так просто ночь мы не можем взять там допустим если вдруг увидели q нибудь курта интерфейсу лифлет и или в google карт известно моего пива в таком же виде реализовывать зачастую не то чтобы там не хотим ускорение можем потому что и должна быть консистентной то есть мы не можем просто взять там ведь он слышен другой модуль часто смотрим на производительности и они тоже смотрят на производительность потому что мы по сути делаем ну примерно одну и ту же работу и но если вычту конкурента что-то работа это что-то у нас не работает то есть с надо просто будет глубоко копать естественно есть какие-то общей практики вопрос преследуемы ru конкурент тоже свету цвету была другом святят никто не требует всего спасибо большое за доклад 3 показывал там песочницу премьера ну также можно редактировать куда это не понимаю да там есть автодополнения вот просто там как раз человека той же типизацию на сказал что степи также есть тогда комплит собственно в песочнице есть нету собственную а документацию я понимаю что при вдохе вас пишите нам почему бы тогда ее не использовать пасту для слова и для авто completo мне кажется это будет удобной и соответственно опять же с док я так думаю что наверно это у вас нету просто поделюсь нашей 11 практикой также док можно использовать для покрытия в то тестов вот и соответственно нашу же основная цель пакет с нами по сути public api и можно проверять что вы покрыли полностью public api как с повредил его против жизнь бог удлиненного типа на основе джаза дока формируется теста или ниткой тесты слов полученный код кого это сравнивается с public api уже сдох а то есть дополнительное тестирование личного трофей станут хорошим то есть считается не только войновка врач но и папа бликовые что же но дан ну вот и есть разные подходы к описанию тестов ты сейчас там я не могу сказать что мы как-то особо не придерживаемся просто когда публикуем культом интерфейс и понимаем что допустим нужно быть куют опцию прям покрываем его тестино но тоже и к минусу то что да не все не все возможные варианты можно учесть бывать всякие ситуация все всем спасибо за отличный доклад вот вопрос а какие у вас еще есть соображение вы против гибриды этот крем того что в случае большого количества то мажорных версии надо выискивать а где к какой метод был деп река этот вот и в принципе эта проблема опять же решается видом представления списка функции списка версий виде какой-то таблички с которыми можно сразу оценить и какую версию выбрать вот то есть если какие-то еще сопряжения почему не стоит так делать ну по сути меня в докладе хоть и был раздел против рикки это был и алиасы я какой-то степени от практически очень схожи концепция deep реки и тацита публичный метод который вы все очень поддерживаю поскольку быть использовать алиасы это уже как бы более спрятанный метод так примерно тут коммутацию был пример с креме у нас тут лишь один описан у нас были случаи когда просто была опечатка название метода тогда мы создавали другой метод который работал также как запечатывая метод печатку убирались документации но тут только что смотрите просто deep лики этот метод прост как бы если ты публикуешь api у тебя есть публичный интерфейс то у некоторые рабочие хотят подчеркнуть то что вот у нас этот метод остался просто deep red data можно куда-то его скрыть но просто как у нас так же стопу язык том что у нас есть возможность давать спокойно альянса то просто удобнее deep реки этот да возможно не так много минусов может быть они во рту краски но мне кажется что все таки когда то читаю коммутацию если видишь допустим 3 публичных методы там подкатом где-то ещё с вами 70 спрятанных кому-то из идей причина а за чувствующий бывают ситуации когда ты смотришь на типичные методы понимаешь что тебе хочется их использовать а не можешь потому что там иметь баги есть еще что-то аппетит может быть допустим браузер выписал к вы митя поэтому завернул как было sb3 api выпустили поняли что-то не безопасном состоянии батарейки определялась можно было и идентифицировать пользователя и потому и возвернуть или примеру там сейчас очень много что браузеры сейчас делают по клику по какому тактику действий пользователя поэтому некоторые методы просто невозможно этих цветов и возможно полностью избавиться из нему сзади предтеч на самом люди постараются использовать спасибо и вот еще один собственно как часто возникают вот эти ситуации с evil gs то есть единичные ли это случай там систематизировать вы их как-то сколько там процент времени поддержки это допустим отнимает но тут нас прям ну абсолютно решение нету есть всякие css селекторы пол но не к сожалению работать не во всех браузерах сейчас прихода веб-компонентов можно часть своей миски туда спрятать у нас вот есть и раскат работать через айфрейм там вообще это проблема нету и скорее при чистоту то есть они про конкретные решения просто на насколько часто вообще сталкиваетесь такие жесты чуть ли не каждый день просто если видим что какое-то решение почему-то часто не работает у нас пример был домой чуть ли не каждый день на придумал пользователь жалобы то что него не отображается карта высился то что есть моды для вордпресса который устанавливал больна стильно все канваса максимально ширина высота сто процентов поэтому 2 ст отображается и тогда вот мы уже написали директор таким образом чтобы было их сложнее сломать потому что надоело уже отвечать шаблонными ответами но в целом да регулярно но если видим что можно какие-то кейсы сгруппировать придумал для них решения если они кадр основы то например индексов нас решение нету ну не тащить за собой же весь все стандартные методы это как бы невозможно да себя большой спасибо за доклад очень понравилось вопрос про проектирования пьют там был кусочек про асинхронность у меня вопрос к на проектируешь api бывает что довольно низкоуровневая вещь становится асинхронный и если мы не выносим хотим избежать состоянии что у нас есть там до загрузки после загрузки то это синхронно себя протекает до самого конца этот не очень нравится всех фасадных методов как в таком случае вы боритесь ну мы особо не боремся ну да у нас есть низком уровне асинхронной вещи есть высокоуровневую то есть бывает так что у нас есть какой-нибудь метод у которого есть допустим но есть сущность катар метод есть где твоя утопал и его получения и события там по сути это тоже фон интерфейс просто уже по-другому работающий полностью синхроны ну мы как то задача так уникально потому что как то не знаю люди не просили то есть если человеку сейчас перефразируем есть вещи которые всегда нуждался синхрон например у нас есть метод яма посреди которой дождаться загрузки модулей и событие дадут ему чудилось не можем ну вот просто мы не можем заработать поэтому написали эту коммутации а все остальные синхронные вещи они принципе не очень обязательные например для locations guide там тоже mod browser зависим какой быть гиблый олаф это уже более редкий кейс и соответственно люди которых пользоваться смиряются с тем что он асинхронный ну плюс мы еще использовать библиотеку уже слов не нативные promise и ну так как тоже из-за того что мы на через пользу кроме того к не вывелись подавляющим мышцы браузеров там есть всякие хелперы на ней нельзя сказать что прям уж очень сильно помогает с позиций асинхронность но помогает хотя потом пример обработать 20 когда нужно несколько провинций подряд обработать все вместе и так далее хотя бы один чтобы отработал вопрос скорее был немного про другое то есть вы зао пользователь мапей осуществляете там решать что ему надо ждать она вызывает сначала синхронный методы дальше синхронным и асинхронным api уже правильно просто иногда хочется сделать чтобы пользователь там могли дернуть любой метод и ему не надо было выстраивать меня бывает у вас таких случаях нет вы делите асинхронная и решайте пользовательским надо инициализироваться ну да то есть простые задачки решаются че без всяких дополнительных вызовов поэтому-то мне такую проблема более сложной ну один а то и более сложной проблемы спасибо спасибо за доклад скажите у вас не было таких мыслей попыток и как-то отслеживать какую часть и api используют пользователи dan balan им но мы нас и счетчики конкретно на модулем можно понять там тоже конечно это немножко не честны в том плане что api встраивается на сайт допустим усадку learn интернет-магазин то соответственно только сниму будут приходить очень много использования методов которые возможно другие люди не используют поэтому там тошно от еще и учитывать популярность как это сатана в целом да мы смотрим какие вам этот более популярный какие нет то есть как это реализовано просто на сервере запрос кого-то javascript файлы отслеживается ли что это но у нас сервер api он написан технологии вмс в принципе там ну по сути то наш командами писала в начале видео это просто было обертка над gulp а потом это стало целым сервисом который по запрос может возвращать с некоторым модулям и пришел он возвращает еще загрузчик для этих модулей так далее вокруг то мы можем отслеживать серверные посева налогом что загружают но это не очень удобно значительно удобнее просто добавить метрику news такой-то модуль и мор дополнительный параметр передать ну вот часто бывает нужно потому что это от этого зависит допустим мы хотим диска и обновление модуля и нам нужно понять насколько он очень популярен использовали какой-нибудь человек эту опцию и тогда там вот можно уже придумать какой-нибудь вариант не сломать обратно совместим с новым как тут более немножко свободнее действует рамках какую-то модель допустим нас была ситуация сейчас и что сказать тоже такая мода работал неправильно бывает и на это неправильно люди могли связаться тогда вот красного собираемых метрику поэтому модуль его понимаем что ну на этот баг никто не сглазь мы можем спокойно вы исправить это как бы не будут слова совместимости или то видим что их немножко пользователей и там видим что это допустим там вообще один сайт а если видим что пользователи там допустим половина пита уже тут ничего не сделаешь придется с этим жить и дальше но на она ронни методов отдельных такого не только модули конкретных моделей но можем взялся на модуле ну да ну установлена смысле на можно делать на отдельные методы просто основном использую модели ну то есть обычно они просто оперируем понять метод наберем им понять у сущности типа создан баллон с таким-то параметрам что такое хотя методы там great баллону опытные так далее всем спасибо"
}