{
  "video_id": "4BAbP2SVTCE",
  "channel": "HighLoadChannel",
  "title": "Универсальные пуши для андроид. FCM, HMS и RuStore в одном месте /  Артем Ковардин (RuStore, VK)",
  "views": 288,
  "duration": 2458,
  "published": "2024-04-17T01:10:25-07:00",
  "text": "и я приглашаю на сцену завершающего спикера сегодняшнего дня Артём кабардин прошу Всем привет Да это действительно никогда не знаешь сколько людей будет на докладе возможно еще меньше чем сейчас на самом деле когда я начну тоже может быть Ладно давайте начнем действительно последний доклад он не будет сложным страшным и каким-то очень сильно хардовым на самом деле постараюсь немножко развлечь рассказать что есть в мире кроме бэкенда и вот это все и расскажу про то как мы делаем делали делали мы будем делать пуш уведомления в истории это такая очень смежная тема между мобильной разработкой немножечко фронтендо в общем очень много всяких технологий затрагивает и очень много всяких интересных тем здесь можно обсудить кто я такой вообще чем занимаюсь я руковожу командой разработки пуш сервиса sdk в истории я пришел в рустров сравнительно недавно там около полугода работаю до этого я занимался всякими сервисами для рекламы мобильных приложениях и для рекламы в мобильных приложениях Вот и теперь хочется делать что-то полезное для людей чтобы немножечко похолоднее был тот котел куда попадают все рекламщики вот и хочется Да действительно в истории делать нормальные интересные и полезные инструменты для разработчиков для таких же ребят как я Какие сейчас есть решения для пошей чем сейчас пользуются Что популярно что не очень конечно же есть firebase даже если вы никогда не занимались мобильными приложениями Наверняка вы слышали или так или иначе сталкивались с тем что нужно отправлять какие-то пушив какое-то firebase вот ФРС это сервис Google Очень популярный очень используемый это такая прям Монолит которым все пользуются и которые так просто с рынка не уйдет его не победить есть еще Apple pushentification Service это что-то похожее на пациент только от Apple и для яблочных девайсов очень похоже на firebase только дороже и хипстерские и есть еще с Huawei mobile Service это такой отличный пример борьбы с монополией с санкциями когда ребята из Штатов сказали Всё теперь Huawei не может пользоваться нашими сервисами самом начале написали свои сервисы и сказали Окей теперь будут вот еще такие сервисы pushay Кроме этого есть еще некоторые такие экзотические эзотерические штуки типа Авроры Вы наверное тоже слышали но мне кажется сейчас в новостях много всяких планшетов на Авроре вот это все и Да действительно там тоже есть сервисы push-уведомлений там тоже нужно отправлять их нужно их показывать получать и так далее И на самом деле там тоже довольно интересная штука работает и есть ещё всякие хипстерские вещи типа юнифают Пуша Они пока ещё не очень популярные это такая очень гиковская Тема мы её затронем в конце доклада просто потому что это интересно даже если там не особо какие-то быковые нагруженные темы но интересно к чему это всё приведёт локализация неизбежна понятно что нам нужно защищаться от санкций и в итоге мы пришли к тому что мы в истории VK делаем свой транспорт ушей а Зачем И для чего вообще свой транспорт Ну как я уже сказал во-первых это конечно же чтобы в какой-то четверг не произошел Не произошла какая-то блокировка firebase или других угловых сервисов и мы все серии в лужу с тем что больше пуши не приходят новости узнать нельзя такены банковские получить нельзя В общем очень-очень страшный мир рисуется Если вдруг нас заблокирует Ему больше не сможем отправлять пущу уведомления второй интересный момент это то что используя свой транспорт совместно там с firebase можно повысить доставляемость push-уведомлений потому что пуши будут отправляться по двум каналам и еще один немаловажный пункт это то что Google он где-то там и он очень не гибкий он достаточно неповоротливый А мы вот прямо здесь общаемся с вами понимаем все ваши отчаяния готовы общаться советоваться с вами Как сделать лучшее что вам действительно нужно поэтому мы намного более гибкие и намного лучше знаем локальный рынок и готовы делать какие-то штуки которые вот прям горячие нужны людям здесь сейчас как вообще работает Свой кастомный транспорт пушей С чего начинается и Чем заканчивается самая наверное очевидная штука это то что на девайсе должно быть должно быть что-то что будет эти пуши получать связываться с сервером и вот эта штука у нас называется дистрибьютор это на самом деле это мобильное приложение которое просто держит соединение с баком и таких приложений может быть много оно может быть не одно на девайсе пройдемся немножечко по схеме что тоже стало чуть понятней начинается все с того что запрос нажимаем пользователь нажимает кнопку хочу подписаться на push-уведомление в этот момент вызывается некоторые метод в конечном приложении И после этого конечное приложение от того стороннего разработчика приходит Простор и говорит А скажи-ка мне пожалуйста У этого пользователя если у него авторизация в истории какой у неё такие на авторизационный потом с этим такие нам специальные сервер авторизации запрашивает некоторые промежуточные такен Чтобы в дальнейшем не манипулировать какими-то авторизационными какими-то такиными пользователя Да мы просто подтвердили что пользователь Действительно существует нам нужно это запомнить и в дальнейшем чекнуть что этот пользователь действительно сделал запрос на подписку после этого уже сервер пушей получает запрос на подписку с вот этим промежуточным токетом который мы выписали на шаге до этого опять же проверяет его что он Действительно существует и все отдается пуштаген подписка совершена на самом деле ничего особо сложного тут нет но наверняка смущает зачем вот это вся штука с авторизацией для кого это вообще нужно И зачем мы авторизуем во-первых да в качестве авторизации мы как правило используем VK ID мы можем использовать если вдруг у Вас например есть какой-нибудь телевизор на котором Вы тоже хотите показывать здоровские пуши или там воспользоваться нашим сервисом то мы можем подключить вас к нашей системе используя там какую-то альтернативную авторизацию но по умолчанию это VK ID потому что ВК используется в истории Зачем вообще нужна авторизация конечно же для того чтобы нас не заблудили потому что если мы будем подписывать всех пользователей подряд без какого-либо какой-то проверки правильности мы на каждую подписку генерируем пуштаген он достаточно большой это строка и таких пуштагенов может стать очень много Даже если мы будем ограничивать РПС если мы будем как-то защищаться от дедовса всяких то нас просто может какой-то ботнет прийти Там выйти из Тора и заблудить всю нашу базу которую мы потом будем разгребать ещё очень долго и чтобы защититься от этого нас есть вот эта авторизация через ВК ID и как я уже сказал у нас есть свой сервер авторизации в котором модульно можно подключать различные провайдеры авторизации То есть это может быть не только ВК и идея это может быть какая-то кастомная авторизация наших партнёров или какие-то авторизации которые внутри ВК приняты Вот так схематично это все выглядит здесь важно понимать что на девайсе стоит приложение rustore и именно приложение rustore держит соединение с сервером пушей то есть не каждая конечная приложение устанавливает соединение А в нашем случае это либо Socket либо http либо это другое http смысле обычное Что такое пол и в этом случае мы во-первых безопасно Передаем пушиб потому что наше приложение русторовское оно подписано мы знаем его отпечаток подписи и так далее А во-вторых мы очень сильно экономим батарею девайсы Да это конечно проблема больше мобильных разработчиков наверное здесь на хэллоуиде это не так очевидно Но чем больше запускается на мобильном девайсе приложения тем быстрее сжирается батареи И там чем больше сокетов открывается тем быстрее сжирается батарея нюансы получения ушей соединения всегда держится на стороне рустора как я уже сказал у нас нет никаких соединений внутри клиентского приложения соответственно и получить ничего нельзя минуя нашего ту сторону наш дистрибьютор и здесь есть очень много нюансов потому что действительно работа фоне на Андроиде это отдельная тема отдельная конференции здесь мы это упоминать особо не будем но это действительно проблематично и мы постоянно с этим боремся по поводу того как вообще в принципе устроено взаимодействие между нашим дистрибьютором и бэкэндом есть отличный доклад с одного из прошлых хайлодов от Кирилла Алексеева там можно больше подробности узнать именно про клиент серверное взаимодействие я расскажу чуть другие темы они тоже интересные но они не про прям вот глубину всего этого во-первых Почему я говорю что может быть несколько дистрибьюторов Это довольно прикольная реализация Как по мне достаточно оригинальная потому что нам пришлось реализовать на девайсе такую межсеть практически в свой Консул или там идти которые умеет общаться между распределёнными приложениями которые стоят на девайсе по умолчанию если у нас все хорошо У нас есть приложение rustore то это приложение выполняет роль дистрибьютора оно подключается к серверу и передает пушив конечное приложение если с приложением простора что-то происходит его например просто удаляют то у нас есть механизм который позволяет переключиться на другое вы конечное приложение и теперь другое приложение выполняет роль дистрибьютора Это достаточно интересная схема Она потребовала много подумать и написать всё это взаимодействие но почему мы не можем просто оставить там 5 дистрибьюторов и там через все их получать пуши опять же потому что нам нужно делать как можно меньше ipc вызовов ipc это interprocess Communication между приложениями на девайсе потому что каждый взаимодействие это потребление это циклы процессора это потребление батареи дистрибьюторы в отличие там от какой-то быковой конфигурации того же консула Где у вас все инстанции одинаковые версии на девайсе мы такого гарантировать не можем Поэтому нам нужно перед тем как устанавливать связь между всеми дистрибьюторами нам нужно понять какой у них протокол какой они версии и конечно же нам нужно постоянно следить за безопасностью Потому что если вдруг кто-то начнет перехватывать push-уведомления то это однозначно не круто Как работает вот этот механизм взаимодействия между несколькими между несколькими дистрибьюторами у нас изначально выбирается приложение арбитр он выбирается идемпотентно это очень простой алгоритм буквально приложение которое начинается на букву А я конечно утрирую но суть в том что там первое приложение в списке оно отвечает за выбор мастер Хоста так называемого мастер дистрибьютора уже После выбора арбитра арбитр ходит каждому приложению собирает информацию по версии по названию приложения по его версии протокола и отправляет все это на наш бэкент где уже На бэкенде У нас есть список доступных дистрибьюторов список того какой протокол лучше работает то есть просто список версий протокола и сервер принимает решение о том кто Сейчас будет обрабатывать пущу уведомление на девайсе в таком подходе Мы спрашиваем У сервера кто какой дистрибьютор будет работать мы еще защищаемся от того что нам сложно подстроиться в нашу схему вставить какой-то другое приложение которое станет дистрибьютором и начнет получать push-уведомления и с другой стороны если мы храним на сервере список всех дистрибьюторов то нам достаточно просто добавлять новых партнеров каких-то Если вдруг мы там договоримся с какими-то другими приложениями то нам достаточно Просто их на бэкенде внедрить в нашу схему выбора правильного дистрибьютора и на девайсах Где стоит это приложение все начнет работать В чем недостатки своего транспорта вообще конечно же во-первых не у всех есть Store не у всех есть вы конечное приложение и это накладывает ограничения на покрытие потому что мы не можем там всех пользователей Андроида обеспечить наши уведомлениями второй момент это то что мы заставляем разработчиков еще и нашу систему очередное интегрировать там а не только закончились Huawei буквально месяц назад а тут еще пришел и говорит Давайте теперь еще через нас уведомление будете отправлять и все-таки да и просто и конечно же у нас значительно меньше всяких возможностей которые есть firebase у нас пока нет там рассылки по таргетингам но мы над ней работаем У нас до какого-то момента не было рассылки по топикам но она появилась И вот такие вещи Конечно мы пока еще отстаем от функционала даже того же hms сервиса и чтобы как-то нивелировать вот это отставание мы решили один из ДК который поможет со всеми этими проблемами как я уже сказал я не хочу Как разработчик еще один раз интегрировать sdk еще один раз настраивать на бэкенде рассылку по шее теперь еще в другую опишку Я хочу один раз подключить что-то и жить с этим всю жизнь отправлять просто в одной фишку push-уведомления и все получают эти push-уведомления все радуются вот здесь список того на что сейчас нужно ориентируется ориентироваться делая там приложение в России да Этой в целом hms rustore и ещё возможно какая-нибудь Аврора потому что это какой-нибудь коммерческое приложение будет возможно ещё какие-нибудь дополнительные там хипстерские штуки и гиковские потому что заказчик так захотел очень много получается и в итоге мы сделали у него шёл Push по сути это такой набор пакетов которые инкапсулируют в себя работу с фцмом см и Рустам надевайся и с другой стороны это одна а фишка единая которая что позволяет отправлять пуши FCM и чмс рустор с некоторыми плюшками при которой мы поговорим конечно мы не первые кто это сделал тот же Яндекс У ребят тоже есть возможность отправлять там в фцм в СМС и то же самое работает в самом же firebase точно также можно отправлять андроидовские уведомления и iOS на уведомление то есть по сути тоже некоторые абстракция над сервисами по уведомлений но транспорт свой транспорт есть пока только у нас вот про который рассказывал в первой части доклада это пока только мы реализовали очень много всяких разных настроек над всеми этими пуш сервисами тут же Ван сигнул наверное Возможно вы слышали такой монстр который может отправлять пушие сообщения вообще куда угодно но у них у всех нет своего опять же транспорта поэтому здесь мы немножечко выигрываем Ну не немножечко достаточно приличные хорошо выиграю как вообще в принципе работает Universal Push мы здесь постараемся быстренько пройти потому что это все мобильная тема не очень возможно вам не очень интересная но для общего развития полезны есть набор пакетов для фрбей за Huawei rustore вы говорите что вы хотите что вы хотите в свое приложение подключить подключаете инициализируете то что вам нужно это либо rustore либо firebase либо все вместе и Можете получать токены которые в этом месте там где написано Лог отправляете на bknd И точно также у вас есть некоторые настройка что если у вас есть свой код который работает с пушами Вы тоже можете использовать нашего пушевого sd-кашку интегрировать туда вот специальные Universal Push Manager и все будет гоняться Через наш код при этом в этом отправлять сможете через одну боковую фишку Как выглядит запрос на отправку push-уведомления никакого рока ценца вы просто указываете через какие провайдеры вы хотите отправлять это либо rustore либо FCM такены айдишки проектов указываете в которые хотите отправить и само тело сообщение само тело сообщение такое же самое как firebase там тоже никаких хитростей нет потому что и Huawei подстроился под эту штуку и соответственно у Гугла Такой формат сообщения поэтому здесь все достаточно просто какие есть возможности универсал пуш помимо того что в этом используете одну опишу и одну из декашку во-первых да Можно отправлять сразу два канала То есть вы можете отправить в rustore и firebase и где-то потеряется где-то не потеряется звучит как объяснение Почему мне нужно выплатить квартальную премию Да действительно можно отправлять сразу через два канала Google тоже не совсем прям совершенная штука он теряет иногда те же пуши Тем более что Google очень большой в отличие от нас и у них нет такой возможности там хранить там все эти пуши очень долго да у них есть ttl но при этом они все равно оценивают там важность этого сообщения и могут эти сообщения дропать у нас все пока значительно проще у нас намного меньше пользователей поэтому мы стараемся хранить вообще всё что у нас есть и таким образом действительно можно повысить доставляемость отправляя сразу в через нас и через вот так выглядит запрос на отправку одновременно два канала здесь вообще ничего не поменялось Кроме того что добавилось айдишка это детишка уникальная по которой мы на клиенте де дуплицируем уж уведомление и покажем только одно Да если придут сразу мы просто одно дропнем и Забудем про него и покажем только То которое пришло первым где-то на 1-2 процента На достаточно синтетических тестах там на наших приложениях внутри ВК внутри рустора мы видим сейчас улучшение у нас пока нет большой статистики по там большому использованию нашего sdk потому что собственно мы ходим на конференции чтобы вы начали использовать наши языка давайте уже начнем Вот Но когда у нас появится аналитика мы вернемся и расскажем насколько лучше все стало еще одна возможность Universal Push это таргетинги что такое вообще таргетинг это если очень грубо говорить это сегментирование пользователей Вы можете расслать push-уведомления в принципе двумя способами это либо конкретному пользователю отправлять Push либо рассылать на сегмент пользователей сегмент подбирается собственно по таргетингом в нашем случае это какие-то Поля Поля с определенными признаками значениями это может быть город пол возраст модель телефона версия операционной системы и так далее и ВК в ВК есть еще сервис My Tracker который собственно очень много знает про самих пользователей и мы интегрируемся с моей трекером получаем из моей трекера часть информации экспертим информацию из моих трекера и соответственно мы достаточно много знаем о наших пользователях которые подписались на push-уведомления есть важные моменты которые нужно учитывать при рассылке по сегментам push-уведомлений во-первых то что токенов может быть очень много и их по этим сегментам нужно получать очень быстро второй момент это то что значение этих полей значение таргетингов оно ограничено сейчас вообще всего 10 признаков используется это прям совсем небольшое число но мы пока только учимся и второй момент опять же да что значение полей может быть ограниченное количество то есть кардинальность у них небольшая в случае с полом Да там всего два варианта в случае там с возрастом тоже значение достаточно ограничено и так далее То есть это такой конечный набор и ориентируясь на вот эти вещи про которые рассказал Мы решили использовать bitmap индексы потому что они достаточно неплохо ложатся на всю эту схему вкратце что такое битмаб индекса и какими пользоваться если прям совсем не погружаться во всякие эти битвы и байтовые операции то индекс это индекс в которой значение можно представить одним битом то есть в этом примере у нас есть набор пользователей и есть набор собственно значение таргетинга версия операционной системы Android и у каждого пользователя поднят бит там где его операционная система указана соответственно нам нужно выбрать одиннадцатый Android он есть у двух пользователей Мы видим что beautica подняты у двух пользователей и можем этих двух пользователей вытащить с помощью достаточно достаточно банальных битовых операций Мы уже давно хотели попробовать что-нибудь такое для таргетингов внутри пюре внутри решили остановиться на фьючерс Я надеюсь что у нас с ней все хорошо сложится выбор конечно достаточно рискованный Если вдруг вы не слышали Future Base Возможно вы слышали такую штуку пилоса это собственно база данных в которой хранится весь индекс она Создана для того чтобы очень быстро бегать по индексу сейчас там есть только битмаповые индексы причем внутри самой пилоса используется там как правило используется rowing bitmapы это тоже достаточно большая отдельная тема для разговора по поводу пятноповых индексов Я надеюсь что когда у нас все сложится и мы там получим какие-то первые хорошие результаты мы еще раз к вам Вернемся и тоже расскажем как у нас все замечательно взлетело с Fish Base и что немаловажно клиенты для написаны на окошке те которые мы используем и поэтому там все тоже прекрасно работает пример того как мы работаем с пилосами на окошке У нас есть клиент мы подключаемся к пилосе и записываем какие-то значения водичку 1234 1235 и пример того как мы получаем данные из пилосы просто запрос говорит Дай мне айдишки там где есть значение 34 например на кошке все достаточно просто есть достаточно много нюансов работы с фьючерс например воткнулись тем что за экспертизанные в пилосу в фьючерс не так уж и просто как мы думали изначально но мы стараемся а если вы хотите попробовать докер контейнер запускаете примеры того как настраивать фьючерс и как работать с ущербэйзом на гол ссылочки все тоже будут доступны в докладе и наверное самый главный вопрос А что по нагрузке Почему вообще на Хэллоуин рассказываем К сожалению пока у нас на таргетинге нагрузки вообще нет И вообще в принципе мы очень надеемся что в ближайшее время мы наберем там достаточно большую массу пользователей которые будут вообще в принципе пользоваться всеми нашими сервисами пока что у нас там нагрузка на пуши достаточно ну она чувствительная но не такая как хотелось бы поэтому очень надеемся что вы начнёте нас использовать задавать вопросы и говорить как это всё плохо работает или хорошо работает и мы сделаем мир ещё лучше и завершающая часть Это куда мы вообще идём Дальше что дальше будет спущу уведомлениями потому что кажется что мы не остановимся на пушах русторовских во-первых Да во-первых не знаю будет ли ру Android но если будет то Мы готовы туда наш сервер сервис встраивать возможно что это будет возможно что нет кто знает для iOS А конечно же сложно сделать какую-то езды кашку потому что там все огорожено и в Андроиде на самом деле тоже в последних версиях они еще сильнее огораживаются с работой фоне поэтому там точно на iOS Не будет никакого своего sdk но мы думаем что проблем с тем чтобы подключиться к опишке апоэйнеса я отправлять пушить через нас еще и впнс тоже каких-то проблем не будет и unifight Push это вообще довольно Прикольная штука это открытый проект в котором ребята подумали что Черт побери сколько можно терпеть Монополию угла Давайте что-нибудь с этим придумаем и решили сделать схему похожую на нашу у них тоже есть дистрибьюторы которые отдельно стоят на девайсе у них вот такой протокол взаимодействия между дистрибьютором и конечным приложением очень простой здесь хотелось показать что здесь всего четыре сообщения в этом протоколе это вообще очень легко и просто работает вот так выглядит схема взаимодействия есть конечное приложение на девайсе которое взаимодействует с дистрибьютором и есть push-сервис под этот дистрибьютор и есть сервер приложения которые взаимодействует с push-сервером то есть здесь они пошли чуть дальше они еще сделали протокол того как должен взаимодействовать push-сервер если у вас соответственно есть другое приложение дистрибьютор то вы можете просто конечное приложение на него переключить и получать пуши уже через другой сервер и через другой дистрибьютор какие есть нюансы ну во-первых нужно специальное приложение дистрибьютор Да это уже сложно не так просто как например во-вторых они работают не с такими с конечными инфантами потому что сервисы приложения могут быть сервисы могут быть разными и плюс для пользователя это то что всегда можно выбрать Через что я хочу получать уведомления через какой дистрибьютор через какой сервер ушей какие есть плюсы это как я уже сказал супер простой протокол четыре события для взаимодействия между там коннектором и хостом и там два события еще служебные очень простая логика которая там у них протоколе никак не описано Как вы должны эти там push-уведомления формировать То есть в принципе под этот протокол можно построить вообще всё что умеет там как-то продюснить сообщение и опять же пользователь сам выбирает Через что он хочет получать уши тоже ощутимый плюс Из минусов это то что опять же на девайсе должно работать несколько дистрибьюторов это потребление батареи это значит рано или поздно эти дистрибьюторы удалятся и что с этим сделать мы пока не знаем никто Пока не знает работать через конечный поинты Это хорошо Ну потому что кенами мы уже привыкли к этим строчкам поитами не очень понятно что это такое как с этим работать как это хранить как-то менять в общем вызывает вопросы и один из минусов это то что опять же пользователю самому надо выбирать Через что он хочет получать уведомления Да если вы гик и разбираетесь там во всяких только с чатах каких-то распределенных системах то это круто если вы там какая-нибудь пожелая дома или там не знаю а пенсионер какой-нибудь то вам будет сложно понять как вообще получаете пошиву просто хотите получать пуши а не заниматься определением дистрибьютора unified Push на девайсе мы пока точно не будем в истории поддерживать этот протокол потому что это слишком гиковское решение и опять же сложно будет объяснить пользователям как им с этим работать поэтому Пока нет но в принципе каких-то ограничений нет опять же я сказал протокол достаточно гибкий Поэтому если вдруг когда-то будет где-то реализация то это будет интересно но это точно будет не официальная реализация И на самом деле на этом все Спасибо что вы выдержали рассказ мобильные разработки и мобильные импульс уведомления Мне кажется это большой задел на будущее Спасибо тебе огромное ребят не забываем переходите по qr-коду голосуйте за доклад высказывайте свое мнение безумно интересно сейчас будет сессия вопросов и ответов Если вы слушаете онлайн Если вы все еще с нами во-первых Вы можете задавать вопросы жду ваши вопросы пожалуйста Нет не видно Наверное Привет Спасибо за доклад вопрос по поводу масштабирования и тестов ваших У вас же mail и ВК под рукой Почему вы туда не затянете в приложение пушине обкатаете это все вопрос масштабирования и тестирования все все верно сказано обтесты Нет на самом деле мы в процессе мы там собираемся интегрировать пуши вообще куда только возможно их интегрировать в принципе все наши тестовые языка и здесь скорее вопрос в том что это достаточно не быстрый процесс это не сделать там за 2 недели э-э это нужно там Обсудить с ребятами договориться взять им в портальные планы и так далее но в целом мы к этому идём действительно общаемся со всеми и рано или поздно там наши э хостовые части будут везде в целом Спасибо Спасибо огромное если у нас еще вопросы две руки вижу пожалуйста микрофоны Привет Артём Спасибо за рассказ Меня звать Владимир есть Тиньков вопрос про что Про то как работает hms hms получается ты встраиваешь sdk в свое клиентское приложение а дальше что происходит если у тебя нет их стора Huawei то у тебя не взлетят они или как это работает там hms используется только на девайсах самого Huawei то есть на Harmony OS которые запущены там где есть сервисы самого Huawei то есть они сделали просто полный аналог того как это у Гугла сделано и в Гугле Когда вы покупаете Android телефон не знаю ребята которые ходят пользуются Android телефоны или нет Или у всех Айфоны О'кей хорошо то у вас Просто сразу Там стоят сервисы Google которые никак не можете удалить ничего с ними сделать не можете и они как раз таки выполняют работу вот этого дистрибьютора который получает по уведомление и доставляет до конечного Предложения то же самое у Huawei Если вы получите покупаете девайс на какой-нибудь на гармонии то там уже стоят Huawei и сервисы и они точно также подключаются к бэкенду получают пуши и доставляют через Но это ipc да обычные эписи в Андроиде это называется Idol взаимо айдол протокол они доставляют пуши до конечного приложения то есть нет Там все будет работать если вы на гармонии запускаете свое приложение Спасибо И второй вопрос что по iOS если у вас какие-то инсайды Я могу рассказать на iOS нет не будет Ну в смысле это в принципе Физически невозможно пока сделать какие-то кастомные пушие уведомления там кажется кастомный sdk для пушей К сожалению потому что нет возможности работать фоне Может хотя бы есть какие-то инсайды когда рустор появится в AppStore там вот в сентябре не в сентябре Я боюсь что я не могу Ну я я занимаюсь достаточно типа узкой специализации Я занимаюсь там сдэшками про сервисом Я не думаю что я могу вам про что-то такое рассказать Возможно если у нас будет какая-нибудь конференция И там будут какие-то ребята из рустора то они чем это расскажет Я про sd-кашки вот с удовольствием все могу рассказать Да Артём Да спасибо большое за доклад у меня будет два вопроса вопрос первый я правильно понимаю что по сути ваша сдэкашка позволяет заменять сервисы FCM их МС вот и нет ли конфликта собственно с виндорами с этими это прекрасный вопрос на самом деле вопрос человека который Вот чувствуется что разбирается в мобильной теме нет конфликтов не будет потому что у нас предусмотрено взаимо Google не разрешает приложение использовать hms в если они выгружаются в Google Play он прям банят такие приложения у нас это предусмотрено просто есть примеры как это правильно разрулить У нас есть докашки Так построены что это кирпичики и вы используете только те кирпичики которые вам нужны То есть если там Google Play не разрешает фцм то вы можете работать с firebase например соответственно Если вы укладываетесь в сторону вообще все кирпичики использовать и работать через все языкашки так что да это предусмотрено Окей И второй вопрос насколько я помню по моему ростора 10 миллионов Мау вот и ты говорил что у вас Пока нет нагрузки понятной папушам насколько у вашей серверы сейчас готовы вообще там даже хотя бы к этой нагрузке или там еще больше нагрузке серверы готовы к любой нагрузке Я бы так сказал Но скажем так они готовы к той нагрузке которую может в России сделать вообще рассылка push-уведомлений то есть мы в принципе знаем сколько пользователей Андроида в России Да их там не может больше их там не может быть больше ну соизмеримо с количеством населения с количеством пользователей Андроидов и вот эту нагрузку мы сможем проживать без проблем по сути вы уже её при восхитили и подготовились к ней да да Ну не то чтобы мы прямо там держим железки которые готовы там которые простаивают просто мы действительно её посчитали знаем и ждём О'кей спасибо большое спасибо огромное Добрый день Спасибо за рассказ такой вопрос Насколько я понял По вашему докладу мы можем заменить Huawei или frp сервиса с помощью вашего но в докладе было строка про то что система часто убивает приложения которые работают в фоне связи с этим вопросом есть какая-то статистика Насколько часто могут эти пуши отваливаться есть статистика Да действительно такая проблема есть не будем кривить душой но у нас очень много всяких Ну не лайфхаков типа очень много всяких подходов которые постоянно рестартят этот сервис и статистика У нас есть только потому что пушит точно дойдут сервер сервис рано или поздно поднимется Но действительно могут быть задержки наших пушей относительно фрб за особенно ночью когда девайс в заблокированном режиме не не стоит на зарядке да то есть он в режиме максимального максимально сбережения энергии и В таких случаях действительно наши пуши будут приходить медленнее чем фрэбасовские они рано или поздно придут но будут это делать медленнее и здесь К сожалению Ну на данный момент у нас прям какого-то конкретного решения нет На данный момент конкретное решение это использовать Вот именно универсальными пушами если вы там не из банка и вас ещё не заблокировали в Google Play или firebase то пользоваться вот Universal pushdk и тогда вы сможете вот эти моменты невелировать в принципе по поводу конкретной статистики Ну мы доставляемся измеримо с firebase по поводу задержки это может быть там задержка до нескольких часов пока девайс находится вот в этом режиме девайс Находится в таком режиме но на Android большое количество оболочек большое количество вариантов системы точно ли ваши лайфхаки помогут во всех случаях Я наверное неправильно назвал Что это лайфхаки Это просто правильный подход к тому как взаимодействовать с приложениями на Андроиде они точно помогают мы видим аналитику и действительно видим что Да они помогают и работают всё всё вот это взаимодействие там если не погружаться очень глубоко в андроидную тему да то это приложение которое будет друг друга опять же хорошо спасибо супер Ну что если у нас еще какие-то вопросы есть Отлично спасибо за доклад Меня зовут Андрей Подскажите планируете ли вы выпускать свою библиотеку под реальных на самом деле у нас сейчас уже есть под Юнити под флаттер Мы у нас в планах довольно много всяких обёрток и скорее всего это будет на самом деле вы уже Можете даже на гитхабе поискать там скорее всего вы уже найдете пару реализации потому что пока пока мы там занимаемся своим то ребята уже пилят эти обертки вот и в целом какой-то проблемы с этим нет потому что все эти обёртки это просто обертка библиотекой поэтому В общем если даже еще нет на гитхабе то рано или поздно появится этим можно будет пользоваться подряд Спасибо так осталось ли у нас что-то недосказанное Ну что тогда самый главный вопрос к тебе все вопросы были классные интересные но надо выбрать сколько 2 до 2 тяжелый выбор Пока спикер мучается Не забудьте пожалуйста уделите ему время перейти по qr-коду и оценить доклад вот там вот молодой человек задавал вопрос по поводу того как мы справляемся с работой в фоне на Idol Device а поднимите руку пожалуйста вот Да у меня есть книжка и А можно никто не поможет чтобы я не ходил Спасибо большое я просто буду вам передавать я Вы уже туда дальше выйти передать и второй вопрос это вот я не очень человека но он там за монитором сидел молодой человек за монитором Спасибо за вопрос человек который много раз был не только ведущий спикер Вот это очень важный Классно Спасибо большое И тебе тоже большое спасибо интересный доклад"
}