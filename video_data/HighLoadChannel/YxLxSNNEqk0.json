{
  "video_id": "YxLxSNNEqk0",
  "channel": "HighLoadChannel",
  "title": "Игровой сервер: что там внутри? / Марк Локшин (IT Territory/Mail.ru Group)",
  "views": 4624,
  "duration": 3237,
  "published": "2021-10-04T02:50:23-07:00",
  "text": "здравствуйте меня зовут марк я занимаюсь уже почти 9 лет разработкой игровых серверов я работаю в студии а идти и территории которые входят в состав mail.ru group сегодня мы поговорим о том как устроен типичный игровой сервер какой stack технологий мы используем при его разработке говорим о том как мы обновляем наши сервера и выкатываем новые версии также я расскажу о том из чего состоит игровой кластер из каких обратных и программных частей и какие у нас есть варианты для масштабирования всего этого наша студия состоит из 200 более чем 200 сотрудников которые одновременно занимаюсь разработкой нескольких игр в активе студии более 15 успешных проектов которые охватывают аудиторию более 100 миллионов игроков по всему миру наши студии в частности разработал такие игры как аллоды онлайн хавка с поезда justice world of и rush royal также и другие игры в конкретном разработки этих игр и я принимал непосредственное участие студия эти territory состоит из двух подразделений воронежский московский офис я расскажу про разработку игр в воронежском подразделение и так из чего состоит типичный игровой сервер существует мнение что разработка игр и разгар водка основного программного обеспечения это фактически два параллельных мира и непересекающиеся части я в докладе пытаюсь вам показать что по-крайней мере для серверной разработки это совсем не так из чего состоит игровой сервер прежде всего это авторизация добывают наверное такие игры в которых авторизация не нужно но сейчас такие игры практически никто не пишет и авторизация это компонент который присутствует в большинстве игр также она присутствует в большинстве в очень большом количестве других приложений банковские торговые такси и так далее чат и дальше из чего состоит и гора серы это игровая механика ее можно условно разделить на метр игра это описание игрока его предметов там квесты вещи валюта то есть они описываются какими-то действиями по какому-то действию они получаются и как-то преобразуются за счет каких-то действий очень похоже на то что делается в различных учетных системах приход товара на склад перемещения расход верификация действия более даже общее понятие это интерактивное взаимодействие игрока с игрой то есть он куда-то пошёл а нужно проверить имеет ли он на возможность edit или выполнить это действие в банковских и в любых приложениях тоже такого очень много на самом деле можно вспомнить историю если кто-то помнит раньше в старых версиях word был скрепыш это вот остатки попытки microsoft сделать интерфейс в игровой форме ну попытка провалилась но кусочки от нее остались так что на самом деле даже в офисных приложениях игры немножко немного ближе чем это может показаться следующий компонент из чего стоите rowid слой хранение данных тоже что то что сохраняет данные это может быть радиационная какая-то новую цель база данных или иным орестович кому как нравится в одном случае это будут играть ее и его предметы квесты и задания в другом случае это накладные проводки в случае учетной системы все в принципе очень похоже следующий компонент это платежи то есть нужно принять этот клиента деньги списать за какую-то услугу в принципе все приложения этим занимаются следующий компонент это реклама и кросс проектной связи достаточно много дохода игр получают от рекламы видеохостинги социальные сети также имеют деньги с показа рекламы если вас не стоит блок то там везде демонстрируется реклама торговые сети также имеют партнерские отношения между собой дают купоны на покупку в других сетях например следующий компонент из чего строится сервер это почта очень похоже на обычную почту картинку конечно вы наверное не отправите но зато можно отправить своему другу меч по почте в качестве вложения также в почте в игре присутствует внутрь игровой чат по сути это старая добрая ой сетью или какие то другие новомодными санжары также частым сейчас очень активно пользуются банковские приложения и мобильный оператор все хотят сэкономить на кол службах следующий компонент который активно используется игровом сервере это поиск пути то есть мы отдали команду какому-то например юниту атаковать вражескую базу и он находит путь через непроходимые препятствия так чтобы построить путь до базы и подъехать и атаковать казалось бы это очень специфическая вещь для игры но нет гугл и яндекс карты приложение taxify тоже строят прокладывают маршрут и подбор соперника или матчмейкинг чтобы вам было интересно играть вам нужно подобрать соперника и подобрать соперника не просто абы какого по определенным критериям чтобы он был близок к вам по уровню то есть вас все время не переигрывал но и вы чтобы все время не выигрывали потому что вы потеряете интерес к игре банан будет казаться слишком легкой где мы такое видим например службы знакомства подбирает вам партнеры по определенным критериям социальная сеть ищет вам предлагает друзей сетевые магазины предлагают вам какие-то категории товаров со скидкой банков и приложение дают вам повышенный кэшбэк на некоторые виды товаров или действий но также они эти категории товаров и кэшбэк подбирают не просто так а чтобы вы не смогли слишком многое сэкономить но и не слишком обиделись в категории совсем бесполезны и для вас следующее это система логирования то есть это протоколирование действия присущая практически всему спектру программного обеспечения которая разрабатывается дальше что есть это инструмент управления игрой то есть прямая аналогия вот админка сайта например у вас сайт какой-то интернет-магазин соответственно нужно как-то администрировать товар который продается в магазине прямая аналогия в игре также есть внутренний двор и внутриигровые магазины нужно редактировать его ассортимент дальше продуктовая аналитика то есть это она идет по сути с системой води рования в связке с вы получаете какой-то набор данных потом загружаете в свою какую-нибудь систему аналитики и выявляете какие-то закономерности ну занимаются и банковские приложения и торговые сети от там математика она и есть математик ну да наверное какие то есть некоторые особенности при анализе игр но в принципе все более-менее аналогично теперь поговорим про использован из тех технологий который мы подобрали откуда вообще у нас появилась потребность выбраны стеком технологии изначально мы работали на вегасе с эти собственные разработки разработка этого стыков было начато где-то в году около в 2007 году было на java написано потому что в то время пожалуй особый не было фреймворков которые обеспечивали работу в распределенной системе соответственно если это был свой стек то ему соответствовали присущей ему некоторые недостатки пропили тарные протоколы api библиотеки которые туда подключили и возможно часть библиотека уже не поддерживалась часть библиотек каких-то делали форм и не взял их было обновить соответственно было много очень всяких интересных вещей типа генерации кода на лету который было достаточно сложно отлаживать собственная разработка документации поскольку она внутренняя было зачастую не полный и если новый человек приходил то приходилось много тратить времени чтобы ввести его в курс дела а и достаточно много людей люди отвлекались от работы показывал практика что входил человек в проект достаточно долго также в девяностых и там в начале двухтысячных чтобы программировать если разбираешься какой-то вечером иногда приходилось очень долго сидеть пытаться так и не начали сделать сейчас ты набираешь в гугле и фразу в девять из десяти случаях эту проблему уже решали в одном случае из десяти когда ты не нашел с первого раза ты просто неправильно вел поисковую строку если по farmer переформулировать опять же и с очень большой вероятностью найдется то человек с которыми это проблема сталкивался если у тебя какой-то собственный фреймворк ну ты всегда решаешь сам соответственно весь функционал который тебе нужно добавляешь ты тоже добавляешь сам никто новую версию не сделает в результате всего мы рассматривали определенное отношение становились на таком вот наборы из систем части игровой механики и верификация действия у нас идет с помощью фотон клауд это решение она может быть на сервере на отдельном или облачным запущена мы пользуемся облачным сервисом это отдельные такие комнаты и для игры людей а то есть по сути это такой pipe которому подсоединяются несколько игроков и они друг другу передают команда клиенты в этой комнате мы можем установить и обработчики которые как то вы лидируют те команды которые переданы и можно из этой комнаты на наш сервер отправлять различные различную информацию например о том что мы выявили что игрок ticket подменяет команды если пользоваться фотон клауд то у него дата центра находится там в нескольких десятках точках на всех континентах кроме антарктиды соответственно можно выбирать на более близкие дата центры для игроков с которых мы смочили ну то есть и matching вести с учетом географии игроков и тогда это будет обеспечивать относительно минимальное время пингов между игроками и соответственно между задержек при пересылке данных также поскольку это облачное решение можно организовывать динамическое выделение железа под эти комнаты в зависимости от нагрузки фотон клауд это решение заточенные под игры но не только в принципе его можно использовать для передачи текста звука или если сделать свои видео чат так что может быть полезно и не только в играх где мои как храним данные мы используем ты хранение данных асгард это основная у нас система почему мы используем потому что нам кажется что для хранения данных лучше всего подходит радиационная модель как и для игр так и для других применений на самом деле весь мой опыт лично примере показывает что чем дальше мы отходим от традиционной модели тему больше у нас возникает в результате всяких непредвиденных ситуаций с данными данные по итогу оказываются кривые и даже если у нас все хорошо там якобы хорошо валиде руется на сервере проложение но в результате потом данные загружаются не понятно что с ними делать потому что они немного испорчен следующий компонент где мы храним данные это apache кафка кафка это распределенный брокер сообщений написанные на java и искали ключевые моменты почему мы используем кафка это горизонтальное масштабирование из коробки можно собрать несколько машин для обработки сообщений соответственно в карте можно хранить сообщение на диске то есть случае аварии сообщения не пропадают и встроенная репликация повышает надежность хранения в apache кафку мы пишем и собственно говоря ладе всей игровой механики и вообще всех игровых событий следующие системы которая тоже относится и к хранению данных и их немного к обработке игровых действий это хазал каст это высокопроизводительная горизонтально масштабируемая не реляционная субд e in memory для нас было важно то что хазал каст интегрирован vertex может из коробки работать в кластере есть балансировка нагрузки горизонтальное масштабирование на ходу может поддерживается добавлении или отказ узла одного из узлов или нескольких системы хазал каст поддерживает распределенные структуры хранения данных мы в основном используем by will you также мы используем механизм транзакции за счет него мы механизм блокировок за счет него мы эмулируем некое подобие транзакции так как в связке vertex их azov coast транзакции недоступны то есть их нету в api vertex vertex я чуть позже скажу так же сказал к съесть запросы но в vertex они тоже не протянут и и мы их практически не использую что такое vertex вот для вирт секс это фреймворк который по сути склеивает воедино все системы которые мы используем это фреймворк для создания реактивных приложений событий на ориентированный и не блокирующие фреймворк разрабатывается eclipse основные моменты вертится вверх есть vertical vertex это по сути это единица развертывания некий аналог 1 поточного сервис который слушает общую шину данных принимает предназначены ему команды можно поднять один или несколько экземпляров верте клана 1g vm или на разных живём на одной машине или на разных машине следующий момент что есть vertex это распределят наши на сообщение которое обеспечивает обмена сообщениями между компонентами системы ну то есть между вертикалями достаточно простая модель параллелизма применена в такси за счет того что сервис в котором исполняет скотт однопоточный мы освобождены от проблем с многопоточном программированием также достаточно простая модель работы с асинхронными событиями но есть некие проблемы которых на следующем слайде мультиязычность и компонент приложение могут работать с языками написанными на джаве java script скала котлин наруби и группе но мультиязычность мы не используем вот vertex его работа вертикали построена по шаблону реактор ну на самом деле там мульти ректор но это для понимания не так важно запросы которые поступают от клиентов выстраиваются в очередь и исполняются на ивент это поток в котором исполняется код вверх текла там исполняются достаточно быстрой команды никакого ввода-вывода там и нельзя делать если вам нужно вы отдельно запускаете на так называемый worker у ли это действие которое там что-то делает и обратно в call back возвращает результат в которой вы можете опять встанет в очередь и когда-то будет обработано на этом fn2 то есть это может продолжаться несколько раз если вас там нужно что-то разное читать в зависимости от условий и в конце ну либо грабар водка будет закончена либо это закончится отсылкой по шине какого-то сообщения другому вертикали бы клиенту при выборе фреймворк мы рассматривали vertex spring клауд и а.к. разработка на vertex нам показалось наиболее быстрый с точки зрения вхождения и написании приложений vertex дает хорошие возможности для написания приложений но если вы используете язык правила которые не поддерживается программой к рутины то у вас начинает возникать некие проблемы код становится достаточно запутанным поскольку вам нужно исполнять часть действий на worker пули с калмыками и обработка этого всего как минимум и либо это разделяется на разные функции приходится либо это на разный объект и согласитесь когда есть у вас какой-то код линейные которые в 20 строчек а вы это разделили на 10 классов ну понимании это не очень добавляет поэтому если вы не используете котлин то мы смотрели проект квазар но вот началу семнадцатом году когда мы это выбирали стек он уже не поддерживался a project loon который тогда уже разрабатывался он до сих пор еще до продакшена решение не доведет и в связи с этим мы сделали свой такой объект который нам позволяет покрыть большинство случаев для обработки сообщений значит декларативно мы объявляем сущности с которыми мы работаем в этот момент для обработки сообщения объявляем блокировки то есть уровень блокировки с которым нам надо поработать берем необходимые блокировки достаем объекты с которыми мы хотим поработать дальше исполняем код операции транзакционных после исполнения если нужно отправляем в хожу к с измененной сущности есть они изменили снимаем блокировки и дальше вот в этом вертикаль и исполняем call back если нам там что-то нужно кот за счет этого получается внутри операции линейной и ну еще раз подчеркну покрывает большинство наших случаев для обработки сообщений когда мы писали этот оператор у нас мы как порядочные люди написали тесто и наткнулись на интересную ситуацию оказалось что в то время vertex выстраивала все потоки в очередь когда брал блокировку ну чтобы дальше мясом можно в кулуарах поговорить мы с разработчиками и vertex связывались и они это мотивировали тем что вот у вас есть какая-то система например на вебе вы кинули один запрос который что ты звонил потом запрос который что-то читает и поскольку вас все асинхронно у вас может запрос который читает исполнится раньше и они за счет для этого делали такую очередь блокировками но на самом деле это решение было нерабочая в конце концов их удалось убедить и они этот момент переделали также мы когда делали на грудь на тестирование своего прототипа когда начинали делать запускали его в разных конфигурациях работала как-то странно потом в результате мы подключили метр эти метрики мы используем параметр сыграв она prometheus это time series база данных в которую удобно класть оптимизирована для набора с измерением ранжированных по времени а у нее есть свой собственный графический интерфейс но как все используют графа ну в grafana есть даже борды от популярных программ и например у нас в графа ну под газ выводятся возможно эксплуатации еще что-то выводит и данные нашего сервера и вот очень достаточно удобно когда ты и непонятно случае по графикам смотреть что происходит ну то есть мы поняли что у нас ну оказалось что мы неправильно готовим vertex но в то же время в такси нашлась проблема там с созданием канал мы их создавали слишком много и это был нити ботаник дальше я расскажу как мы обновляем игру требования бизнеса это минимизировать время обновления простое при обновлении и другой требование это ценно разработки естественно цена разработки хочется снизить и но соответственно можно вообще не ничего не разрабатывать и тогда не нужно будет ничего обновлять но там есть бизнес и другие требования например выручку делать больше поэтому приходится искать компромисс в обновлении мобильном давление есть инете особенности так если это задержка до обновления в сторах она может достигать суд соответственно да если мы выкатим сразу новую версию клиента и будем поддерживать только и это до суток может игрок не зайти в приложение естественные нам это не очень поэтому нам приходится одновременно поддерживать несколько версии сервера работу в связи с этим обновление у нас включает две фазы мягко это обновление когда игрок может скачать новую версию но может работать со старой и жестко когда он и со старой версии уже работать не может вот так выглядит график переходы игроков на новую версию фиолетовая вначале это мы открываем новую версию сервера где-то на 10 процентов игроков и они практически сразу все переходят потом мы в течение одного-двух дней убеждаемся что сервером все хорошо там и никаких тактических ошибок нет в это время на споры разливается это обновленной версии игры она уже будет доступна во всех регионах тогда вот мы посередине открываем мягкое обновление доступны для всех и там вот порядка восьмидесяти пяти процентов игроков сразу переходят на новый сервер потом соответственно не по чуть чуть чуть чуть еще переходит и где оранжевая линия в ноль падает это мы включили жесткое обновление то есть игроки не сидят на старой версии предпочитают перебежать на нового в принципе понятно но вот можно за это не опасаться что игроки будут очень долго сидеть на старой версии так структура нашего игрового кластера каждый шар это несколько машин которые объединены одним экземпляром vertex и хазал каст на каждом узлов запущено несколько экземпляров механик механик а это каждый механика это vertical который занимается обработкой команд клиента то есть например есть vertical который обрабатывает задание каркаде есть vertical который обрабатывает работу с и темами игроков есть и vertical который обрабатывает работу с загрузкой загрузку игровой модели и так далее некоторые механики мы и делаем в единственном экземпляре то есть можно сделать и во множественном но да это single point of failure но разработка таких механик может просто она будет очень дороже и мы считаем это нецелесообразным также в на каждому шарди есть локальный кэш который мы используем для быстрого доступа например а это я не игрока является ли игрок онлайн или нет все сервисы с обмениваться сообщениями через vertex механизм диксона синхронизирует состоянии с базы данных вот как выглядит enforce полная инфраструктура проекта клиент подсоединяется каком сервер который определяет на какой shard ему нужно идти соответственно это либо по версии старые новые либо если мы сортируем на один из сортов дальше механики лоббируют свои сообщения во время работы в кафку которую из которой данные забирают аналитики входу либо мы их перекачивает через отели в базу кгм админом так люди которые управляют игрой они смотрят и разбираются и мой вот так же через веб-серверу управлять игроком игрой там забанить игрока вы дать ему какую-то компенсацию или наворот отобрать какой-то фрагмент который он получил незаконным путем также мы по этим logo мы можем искать ошибки если что-то у нас пошло не так все шарды объедены одним экземпляром х заказ дополнительным знать мы используем 2-х заказ то один и хранит данные внутри игрового шар да и по сути мы его используем как кэш перед базы данных там хранится информация в играть я его предметах заданиях и так далее в общем хазал костях хранится информация которая нужна если игрок равно может находиться и на одном и на другом шарди одновременно ну то есть когда когда он переходит вот какой ему случае рассматривали на новую версию игры например он участвует в турнире который длится неделю за этой неделе вышло новое обновление соответственно информация турнире ему должна быть доступны и и на одном и на старом шарди и когда он пришел на новый шар мы вот используем разные и в значения структуру чтобы хранить информацию о турнир индексы мы не используем то есть местный нас мы тоже используем ещё одну лапу чтобы оставаться в парадигме vertex ну то есть в его api комет слов о производительности мы рассчитываем производительность на 50000 пользователей для этого по спецификации у нас вот есть три двухпроцессорных восьмиядерных сервера под базу данных сервер с одним процессором но памяти побольше и аккаунт сервер то есть его можно куда-то приютить но он не требователен не по памяти не по процессору на самом деле есть еще набор разных сервисов ну которые тоже они в принципе не сильно требователен и по памяти и процессору их эксплуатации потеряет там на разные другие ноды можно заметить что здесь не такое большое количество ядер требуется и в принципе 50000 пользователей на свежем железе у нас держит вот вместо первых трех строчек которые там пять машин это где-то на 2 машины то есть два сервера 2 процессора ных где-то 20 ядерных 50000 пользователей держит запасом ну конечно все зависит от игры для какой-то может больше для какой-то меньше но в нашем случае выходит где-то так если у нас не хватает то какие у нас проводить какие есть варианты масштабирования по циpкa вот два сервера если использовать то 1 что у нас упирается будет это в циpкa то есть циpкa горизонтально очень хорошо масштабируется просто добавляем еще один сервер в кластер и у нас увеличится производительность до тех пор пока мы не упремся в пропускную способность шины но у нас там сейчас все достаточно хорошо дальше мы начнем упираться в базу данных поскольку мы используем ванильный под gars то соответственно из коробки нету там никакого сортирования вариант масштабирования лучше железа там лучше raid-контроллер сейчас у нас стоит ssd raid controller с 4мя дисками это обеспечивает мы по нашим подсчётам более ста тысяч пользователей конкурентных работу там даже с запасом если железо по какой бы причине недоступны лучше следующее что мы можем сделать это оставить запись в in memory datagrid то есть в казал cast a синхронизацию с гор сделать отложенный например 1 5 минут так можно еще в несколько раз понизить требования к железу производительности по сброса ну и если все это не поможет ну а это уже там разговора нескольких там сот тысяч пользователей то есть там уже ближе к миллиона тот ну тогда вариант это сортировать на разные инстанции выводы какие технологии которые мы подобрали он реально хорошо работает масштабируется и в принципе обеспечивает на небольшом количестве железо достаточно большое количество пользователей я считаю что фрейм vertex framework реактивный и в принципе его стоит попробовать либо vertex ли бы любой какой-нибудь другой реактивный фреймворк в работе так как обеспечивает он хорошая производительность какие еще есть вы у дать немножко может быть капитанский вывод что ошибки встречаются особенно если фреймворк не очень широко используется или только начинает его использование могут встречаться ошибки даже которые казалось бы ну как вообще люди которые делают framework про параллельности и асинхронности такие допускают в коде ошибки то есть они концептуальные и приходится с ними спорить даже что так нельзя делать и то есть универсальность это хорошо но не всегда это как бы в принципе тоже известно что любой rm может одинаково плохо работать с базами данных одинаково хорошо нет так же и тут у нас сверх так само получилось что vertex может работать с и на море да там горит мы к из shinee сообщение как хазал cast a pas cher знает и кафка то есть можно легко переключиться с одного на другой и на третий и попробовать да это как бы плюс и мы пробовали и даже продакшене апачи знает но за счет того что там есть универсальность мы не можем использовать все возможности поэтому вот думаем сейчас в ту сторону чтобы использовать и хазал каску напрямую чтобы получить все возможности которые он дает так все спасибо за внимание так у кого есть вопросы пожалуйста поднимайте руки и если у нас вопрос из онлайна как всегда понятно традиционно нет вопросов и суммой на невезучие мы статья спасибо за доклад вот вы сказали что у вас для быть player ну когда слайд фотоном был используется комнаты для матчмейкинга я здесь да да и хотел спросить что есть комната для аллодов онлайн то есть я так понял вы говорили освещенных играх вон вы еще принимали участие в разработке ему lpg и что там было комнатой в аллодах онлайн и фотон не используется и я принимал участие в разработке аллодов онлайн и про lego system это как раз про в частности про аллоды онлайн там в аллодах не используются соответственно комнаты там сервер один он для графический не распределён по этому то есть для игры и с нормальным пингом например и замерить вам нужен по сути сервер в америке как бы игра разрабатывалась как раз в 2007 год это начало разработки этой игры ну тогда я еще не работал студии а вот ну то есть я потом работал в студии ловким и перешел его эти территории ну и тогда такой инфраструктуры и еще облачный она только зарождалась и концепция там балладах несколько другая она он рос добрый вечер спасибо за интересный доклад николай колоса в сбер мегамаркет excuse точка ру вопрос такой судя по вашему рассказу игровой сервер это довольно сложный монолит который выполняет огромное количество разных функций чат инвентарь так далее что мешает его распилить на микро сервис и получить возможность например тепло есть отдельные компоненты канареечно ну ничего не мешает и даже я так и немножко не понимаю почему вы решили что у нас монолит или микро сервис . в докладе я эту тему не касался в принципе у нас скорее монолит но аккаунт сервер например у нас отдельно мы постепенно распиливаем части какие-то например у нас сервис который отвечает за дружбу он тоже отдельный сервис но как бы монолиты микро сервис это отдельная дискуссионная тема мы можем дискутировать например как целостность базы в микро сервисах поддерживать это такой достаточно нетривиальный вопрос который коррелирует как но у еско или из реляционной базы данных что там образуются в результате мусор потому что constraint of нет этого пользователя нет зато у него есть какие-то вещи которых у него будет не должно ну там начинаются проблемы с этим поэтому да мы делаем какие-то движения в эту сторону но все разбить на микро сервисы я считаю что скорее будут проблем много и особо больших плюсов ну может и не быть потому что одно дело если сделать микро сервис когда ты да он один на все игры но практика показывает что гейм-дизайнеров в каждой игре и хочет вот что-то еще свое сделать дополнительное нужно доработать и в результате нужно все кастомизировать ну и я прям я так подозреваю что разделение на микро сервисы связано еще с достаточно длительным сроком жизни проекта ведь проект же у вас я так понимаю не появлялся там вчера позавчера там в прошлом году им гораздо больше лет я так подозреваю комарно и но разные из проекта ну как бы типичный срок жизни проекта там это от 2 и выше я там колоды они там более 15 лет уже здравствуйте зовут кирилл а компания дома reef hotel спасибо во-первых большой марк нам за доклад интересный хотел бы вас поинтересоваться как уже было ранее отмечено мне тоже показалось что рассказ больше про какие-то сезонные многопользовательские игры а у меня и у меня вопрос конкретных части обновления игровых серверов то есть если для сиси он их мобильных допустим до игр мы можем представить себе мягкий апдейт когда у нас одновременно в продакшене две версии серверов крутится то есть для старых для новых клиентов то как вы думаете для массивных вообще возможно такое ближайшее время потому что насколько я помню проблема апдейтов с down таймами и возможно даже вайпами она принципе никуда не ушла спасибо вы мама да то есть это если некая проблема аллоды онлайн они обновляются с да вон той мам и с профилактикой ну когда у тебя открытый мир и вообще достаточно сложно как-то так сделать чтобы у тебя это работало и на старом и на новом сервере то есть у тебя появился какой-то там npc который который старый сервер не знает как взаимодействовать или там на новые там какой-то меч в грудь вели бьешь игра к которой у которого старой клиента и про этот меч он ничего не знает ну то есть можно наверно как-то разделить на слои чтобы они бегали друг друга не видели и там в результате когда будут перетекать ну наверно так сделать можно ну то есть такой сложный процесс который приведет еще к большим проблемам но поддержка одновременной работы старые и новые игры на одной базе данных она требует дополнительных затрат потому что так ты просто обновил и ты у тебя либо старая структура либо новые код работает а так ты должен понимать что у тебя и новый код работает с этими данными которые добавляются и они могут еще и старого кода приходить и то есть если вы какое-то поле добавили то вы можете и заполняете там какое-то значение вы должны быть не должны рассчитывать что если даже ваш код в новой версии заполняет его у вас могут появиться данной который в которых он не заполнен из старого сервера поэтому это дополнительные трудности в разработке такая поддержка вносит понятный есть ли у нас ещё вопрос из зала а у нас ещё два вопроса из зала но наверное на этом закончим вот рядышком вы сказали да что у вас не понятно или монолит или микро сервисы что у вас всех зации отдельный отдельный то есть вы идете по пути такому что эта игра это микро сервисы то есть дружба авторизация социальные взаимодействия но непосредственно игровой сервер который обрабатывает игровую механику его не разделить ввиду того что у как вы сказали там проблема согласованностью данных и так далее так получается вы идете в могу ну да мы сильно недорогим то есть вычленяем смотрим на игровую почту возможно там можно например он у нас сейчас не вынесено как микро сервисы и вынести как микро сервис там какие то вещи можно наверное сделать но опять же все еще упирается в дизайнеров которые к тебе приходят и говорят что а вот надо сделать именно так и это там в два раза должна поднять выручку проекта если ты не делаешь это говорит и из-за того что программист не хочет делать вот у нас такая маленькая выручка в проекте поэтому та ты шо оно приходит к то у меня же микро сервисы я его сделал один на все проекты как я могу сделать то что ты хочешь я не знаю делай дополнительными зато как бы делать форте микро сервисов сперва мучиться выделять от все метро сервиса потом делать на каждый проект кастомные микро сервис ну тоже не очень хочется так у нас еще вот вопросик самом конце и обретение забыла про mind games а подскажите как у вас ну какой инструмент используется для работы гейм-дизайнеров и могут ли они менять в реал тайме что-нибудь заливать на сервак изменения и как это происходит гейм-дизайнеры геймдизайнера ли либо он ставит задачу программисту через веб-сервис чтобы можно было какие-то параметры подкрутить тогда ему рисуются формочка ну или тому человеку который имеет доступ продакшена чтобы он подкрутил либо мы используем механизм blue green deployment когда есть игра есть конфиге ссылка на конфиге игра зная от версию если такая случилась проблема что нужно поменять какие-то параметры то мы их меняем в конфиге игры в аккаунт сервер всем этим делом и заведуют мы выставляем что от нас новая версия конфигов когда пользователь заходит он видит что новая версия конфигов соответственно мы поднимаем рядом новый сервер и но игрок переходит на новый сервер либо если он находится на старом сервере туда посылается на старый сервер в сообщении он доигрывает игровую сессию вот в этой комнате на фото нина старая версия конфигов и когда он выходит и входит в глубину незаметно для него игра переключается на новый сервер погружая новые конфиге ну возможно сперва подгружается новый конфиге потом она включать ну как бы это не суть важно и ну и за счет вот этого можно поменять какие-то параметры в конфигах и в принципе наверх такси можно хорошо сделать с использованием каналов такое обновление даже на одном сервере например в имени канала версию этих ресурсов в шить и тогда поднимаешь вверх тиковые которые общаются там из одной версии вот этих ресурсов потом мы тебе нужно изменить ты поднимаешь рядом другие вертел и и если все сообщения будут иметь префикс с номером вот этих ресурсов они как бы не будут пересекаться и все будет работать по идее но теоретически поскольку там есть всякие каши может в теории это должно но на практике скорее всего могут возникнуть нюансы поэтому мы чтобы обезопасить себя просто рядом поднимаем новый сервер и туда игроков переводе и так поблагодарим марка за интересный доклад напоминаю что после доклада есть возможность пообщаться в цифровой зоне то есть вот у нас за нашей аудитории есть цифровая зона также там могут пообщаться пользователей из онлайна марку большое спасибо также у марка хотелось бы узнать какой вопрос оказался лучшим кому мы подарим книгу что надо было выбрать вопрос да либо вот девушка либо вот молодой человек мне они как-то оба понравились если у нас возможность две книги подарить до ответа нет ну давайте девушки подарим давайте тогда рпп первый раз за день вот ну на этом все"
}