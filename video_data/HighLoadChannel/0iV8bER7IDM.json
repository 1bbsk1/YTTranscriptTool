{
  "video_id": "0iV8bER7IDM",
  "channel": "HighLoadChannel",
  "title": "Сегментация объектов на спутниковых снимках (Kaggle DSTL) / Артур Кузин (Avito)",
  "views": 1231,
  "duration": 1347,
  "published": "2018-01-16T12:28:18-08:00",
  "text": "да всем привет , я артур манер даяков работу в компании avid и занимаюсь там каменным зрением и сегодня расскажу вам про решение конкурса на кабеле который был посвящен 17 объектов на спутниковых снимках во первых кто из вас отлично ok зачем было посвящено тому чтобы нужно было выделять объекты на снимках то есть были даны снимки со спутников сделаны в разных диапазонах то есть это были снимки не только в разных длинах волн то есть ими которые имели физически разные природы сигнала они еще и обладали очень раз в разрешении то есть они были самые разрешающий мили 0 3 метра на пиксель самые низко разрешающие примерно 7 утра таки ксель и нужно было предсказывать объекта разных классов таких как дороге это асфальтовой дороги и тропинки здание это но обычные здания и что-то вроде заборов леса поляк держит а выращивают два типа рек и точнее воды это быстрой реки и если бы смог узким моря и пересыхающих реки и озера также нужно предсказывать еще машин двух видов это грузовики и автобусы то есть большие транспортные средства и молили транспортные средства обычно обычной машины и мотороллеры которые выглядят сами как типа пиксели на асфальте то с ними имели очень маленький размер соответственно как можно увидеть нужно предсказывать объектов очень-очень разные диапазоне и это ну довольно сильно больше челлендж потому что но они имеют очень разный размер метрика это jakard это что-то вроде отношении пересечения к объединению областей где области этапе сказанная маска и grand rouge а также можно видеть воспаление доле площади каждого класса от общей площади снимков и видно что здесь бен и которые соответствуют машинам они как бы отсутствуют потому что их сильно меньше одного процента и ну как бы и поэтому буквально 100 пикселей подошли ко всем классом но при этом в общем скоро не значит такой же вклад как и но как бы другие классы и это довольно тоже то вещь которой нужно считаться данные нам выдали 20 снимков размеченных данных и сказали что весь тест состоит из 425 снимков следственно остальные сказал в том что есть якоре poble который срез подвески процентам теста и а проектом и строится уже финале leader board естественно было понятно что по данным организаторов в паблике с ником гораздо большую строение и на мой взгляд было бы логично сравнивать результат по публику на самом деле орги разметили только тридцать два снимка из всего теста и соответственно в паблике было буквально 6 снимков поэтому это взывал никто расхождения между локальной валидации лидер бардом и вам расскажу про кавел потому-что это какие-то очень как бы абстрактные соревнования к этому не имеет отношения к реальной жизни стихло на самом деле здесь чтобы семена не было в том что нам были выданы буквально старые снимки со спутников то есть в кито разных диапазонах сигналов а также конечно разведки были даны со свои файлы в которые содержали полигоны масок и предполагалось что наш алгоритм он должен выдавать тоже свой файл с и полигонами то есть это те вещи которые бы ну как бы используются на практике в том чтобы размещать данные то есть это не им на своей маски виде пикселей а csv-файлы тоже бла некоторые проблемы соответственно нужно было не просто бы сказать маски но еще есть конвертировать их формат который принимал как средство перед тем как сказать очень про все решения могут рассказать про bass line которая сделал и который то есть которую я новичка я начал потому что ну вот и но не был много проблем и я очень долго не хотел участвовать потому что был много стадий и то из-за чего я принял участие то болото что накапливал диски в который позволит конвертирует как раз из масса которые бы сказать нейросеть в полигоны которые скармливают можно скормить карлу и как бы из этого я не решишь нужно участвовать и сделать следующий штуку все снимки 25 штук я слепил в один большой файл изображение его можно видеть слева так же я сделал то же самое с масками а дальше из рандомных мест я дергала патче под размер входа нейросети с картинками и смазками очевидно обучал не россия это была юна это дальше скажу что такое и даже следующем окном предсказывал маски которые как раз после этого конвертировались помощью скрипта и образовался свой файл вот в принципе боишься который я сделал и дальше я выложила на форум cs после этого каждый мог воспользоваться этим бы celine площадь пример такое же решение я-то привлек много участников в это соревнование потому что круто дальше я хочу израильская некоторую килечку с толку что такое очень растить потому что возможно и все здесь специалисты ну как бы и предыдущий докладчик говорит что-то очень слабо интерпретировал вещь хотя я считаю что то не так поэтому стоит рассказать идей в том что как бы простой задачи классификации когда вас есть картинка и нужно искать какой-то класс объекта то изображение при прохождении через нее россии становится меньше в плане размеров эшлин и высоты но становится более богатым плане представления то есть калле полет плане количества каналов и на каждом стадии преобразования то есть при проходе через твои и но он становится более абстрактных точки зрения представления потому что разные слои реагируют на разные структуры то есть сначала таки это директор граней и их перед переходов который дальше кладутся в текстуры которые соответственно дальше после этого складываются уже более вас к вороне в объекта такие как типа морда собак колес автомобилей или там не знаю часы а после этого такие куски картинок складывается уже в более абстрактных картин которые давали сложно как раз на пикировать но который даже имеет принципе довольно простое преставление которое дальше уже раскладывается на лейн ростовского селена преобразованием соответственно идею то не расти в том что она просто мешает картинку уменьшать размерность и получает абстрактное представление которое легко разделить или иным линейным преобразованием что же такое юные этом плане это та же самая нейросеть только сделано для цементации во первых ее разработали для классификации биологических объектов и как типы клеток или мембран в микроскопе я на себе очень хорошо показала предыдущем кегли который был посвящен цементации нервов в шее иди здесь вот в чем как и в ярости здесь происходит уменьшение размерности до come to battle на кота из узкого горлышка и дальше обратными преобразованиями она увеличивается до исходного размера так чтобы предсказывать маску то есть такой типа encoder декодер только единственное отличие что здесь идет пробрасывать не фичей от таких же слоев на и сын хоть в части в дикой 1 часть если пусть это очень хорошо хорошо помогает сети обучаться я на довольно стабильно получилось то есть это мы припарковали хоть вдруг которые использовали я найду очень хороши помогала средства что же я дальше улучшил в этом решение которое стелс мы бы celine во-первых ванильный unit он не содержит услугах больше нормализация ну то есть обычная вещь в современных нейро сетях то есть я добавил его в между между свёрткой активации я также был обмен тации то есть такая вещь как то когда вы обучать нейросеть мне очень выходных параметров и она легко перри обучается на картинке потому что но она может их просто выучить его может искажать изображение чтобы она не выучил а именно конкретно изображение выучил принципы ну вот естественно я добавил админ таций и очень клево вич который хорошо зашла из обычного капитонова зрения это что-то вроде hard негатив майнинг и здесь была реализована следующим образом то есть я также рандомными патч не дергал какой-то обучающий пул обучался на нем предсказывал его и дальше выбирал для каждого класса самые сложные примеры в плане скоро то есть я брал пример и где все тяжбы с наиболее сильным образом и дальше добавлял их следующему обучение таким образом каждый пол не состоял из 30 сложно пример с предыдущей эпохи и где-то 70 процентов новых сэмплов это позволяло сети гораздо быстрее сходиться и показывала более высокий скоро конечном итоге также я да здесь утопись утихла так же я сделал сеть которая имеет несколько входов опять же как я сказал картинки здесь имели очень разный размер и и средств если себе в себе раза сигнал соответственно можно сделать следующие вещи все то масштабировать к одному размеру и подавать все слои целиком но секрет обычный как бы очевидно большой overhead на то что ну как бы у нас мы очень маленькой картинг увеличиваем восемь раз мне ничего не остается плане информации поэтому было бы логично добавлять картинку по мере того как основное изображение в сам бранча сети уменьшается и становится пример таким же как эта картинка то есть дальше я прикажу уменьшение картинки соответствующее количество раз конкатенировать с этим фичами картинку после слоя свертки то есть я никогда не вел свою картинку и фичи потому что свечи разной природы а я к кате мерил после свертки ед как бы ну да логично а дальше все обратно все было так же как в один эти я просто увеличил к размеру маски и так получил наилучшие разрешение естественно мой финальный pipeline который я сделал до момента менения в команду с арманом выглядел так что я разные классы предсказывал новых сетями с разных konami данными использовался с низкими входами и тоже получил не 3 класс и также чтобы стабилизировать в решении я смешивал разные эпохи то есть я брал лучше эпохи и смешивал их предсказания чтобы решение было никогда не были более точными так выглядела примерно лог обучения то есть это по вертикальной оси и the score то есть условно говоря точность работаю не расти абстрактная точность по оси икс это эпохи то есть это 1 обучения здесь можно видеть мой взгляд две вещи во-первых некоторые классы но не обучается вообще просто из-за того что есть как бы на некоторые сложности с классами они обучаются разное время несмотря то что и выравниваю sample и и есть некоторые провалы которые но мне как бы непонятно откуда взялись и если застал интересно что же происходит в этих местах где ноги проваливаются поэтому я сделал следующую вещь я на каждой стадии предсказывал валидацию и это видео где маскируют а как вы сейчас не раз сеть здесь синим показано маска grand rue зеленым показанной предсказаний сети а голубое это пересечение маски и ground руб то есть то что ну то есть это там где сеть приказывает верно средства здесь показан обучение разных классов это например структура это очень тонкий объекты которые начался причуде предсказать должна сваливаться это минимум мы начали предсказывать вроде как довольно неплохо но опять же видно что я во первых колбасит и видно что она по мере увеличили количество пор немного улучшат свои предсказания да вот на дороге особенно хорошо видна дорога здесь сначала ничего не предсказывается дальше подсказывает какой-то трэш и дальше она понимается дорога здесь и начинается опять же улучшается компании чтобы сказать меч и мусора здесь и больше дороге в этом месте настройками не очень понятно тому что они очень были сильно похожи на просто ну грязь поэтому ну то есть да здесь все пять штук колбасит да ну прям видно что она немного лучше деревьями это более красочно потому что здесь на прям улучшает из казани в том плане что она и меньше колбасится со временем и деревьев находится там где находится маска это поля с полями виден артефакт который связан с тем что я предскажу с клеящим окном то есть здесь видно такие прям квадраты которые соответствуют тому как сеть идет нарезаю на некоторые патчи дальше расскажу как это можно избежать но да это некоторый тип факт который даже ввиду этого да сначала точно предсказывает дома потому что крыши домов похожа по цвету на воду лишь на понимать что вода здесь а это это небольшое озеро который является медленной водой и класса медленно воды и быстрой воды они до самого конца плохо различались по этому то есть как бы с этим было все плохо да вот здесь здесь он не получилось то есть озеро здесь она предсказывает ничего сейчас я не могу чепак да вот она потому что сделать на нет не получилось и все плохо было с машинами потому что ну машины здесь ну да немного видно и вина что он пересказывать их вообще где угодно только не здесь есть очень небольшой пересечении здесь видно но дано очень большое это да ест другим . мне тоже плохо там что-то предскажет with the trash ведь здесь они на самом деле здесь и пересечении очень большое ну вот примерно так это выглядит и ну то есть после того как я посрал этиология понял что можно за следующий штуку я взял тест которым я не был размечен я не размещал и нарезал из него куски линии с этими регионами которые показались наиболее сложными например здесь левая часть это как бы дома которые сложно предсказывать это карьер который выглядит выглядит как дома это кусок моря которого вообще нет настроения здесь вода с рябью но и так далее то здесь как бы все очень спорные объекты которые подсказывать еще очень сложно из теста каждый раз я предсказывал еще и тест снова как он выделит глазами и дальше глазами добрал просто лучше эпоху который мне казалось что выглядит наиболее адекватную это помогло как раз стабилизировать решения и сделать его лучше чем у многих участников дальше я бился с романом соловьёвым с тоже скажу про его решение потому что она тоже вдоль прикольное роман брал все каналы как раз просто белых одному размеру то есть он взял самый маленький канал из увеличивало 20 раз и дальше в большую пачку каналов он скармливал охотнее россетти но он сделан низко другую вещь в плане валидации то есть я публикация существовал глазами а он сделал довольно грамотно он разбил на 5 болтов при том так что фалда он убирал что-то вроде эстраде файка fold если вы в курсе что такое не в том чтобы глазами разделить картинки так чтобы в каждом fall back было примерно одинаковых лично каждого класса средства вас выровнена количество то есть вы равен конечно сэмплов на в каждом фолде и это хорошо для копилка ли валидации или соответствия скоро потому что как вы обучаете сеть и так дальше на каждом вполне обучал не россия смешивал его и он предсказывал не все классы с помощью нойнер сети оон для каждого класса обучал нейросеть притом для каждого класса для каждой нейросети для каждого класса он переборами скал параметр оптимально следующего диапазона то есть он опять же игрался с optimizer омс админ тации с дропауты и количеством итерации как долго на буче эту семью заняло очень много времени но опять же таким перебором он очень даже неплохой результат он еще также мы дефицит милиционера сеть он сделал ее глубже идея в том что можно взять хоть бы больше добавить количество слоев и как бы сделать ее очень огромное этом плане он это сделал они тоже тоже тоже помогло кроме того он не увеличена только глубину сети в плане количества pulling off канва люцию нащупал свой свертки на комбинацию свертки быть нормализации активации свертки и еще конце добавил dropout это тоже довольно интересный подход потому что я не думаю что то еще сработают но для него хорошо сыграла а для машин он обучил более маленькую сеть потому что ново машина не имеет очень небольшой размер то есть он использую очень большой вход и также он пытался наказывать нейросеть за то что она вышибается в местах которые советуют тачки это можно было сделать в коэффициенте лосса то есть он тоже протестировал но тачки у нас получилось не очень хорошо а вот примерно выглядит финальный pipeline если бы он не съехал то есть верх решение роман с завершением мое решение то есть мы опять же просто объединили наши не россии итак мы обиделись на поздней стадии то был бы логично самом деле россетти но у нас их не было электро классов поэтому просто брали причине регионов это более слабо техника смешивания но как бы нам их твой хватило чтобы занять второе место ну вот естественно для некоторых классов мы просто брали лучшие снизить ярость лучше предсказания от скажем и романа где-то мы смешивали а где паз был очень сложно сложно мерч это типа 2 нейросети и одно экспертное правил одно том что такое вода штата невада и это как бы было хорошо но наше финальное решение даму залива тогда второе место и дальше расскажу уже про решении других участников от например кайл это малазиец который занял первое место его решение выглядит так это в лучших традициях игла огромное количество ассамблей и перебор всех порвет возможно параметров как-то внука как как можно было сделать если вам не видно то не переживайте я сделал более в этом варианте то есть кайл перебирал берджесс параметров таких как количество каналов разные входы не родительстве если разных личных каналов разная глубина сетей и разных способ декинга и объединения нейро сетей то есть он в этом плане потратил очень большой силе чем романы перебралось всевозможные варианты с большим все удачно смешал apple занял первое место то есть это вполне себе отлично решения также расскажу про третье место это сам людей будет наиболее простое решение в плане straightforward и 10 вот в общем они также взяли все каналы масштабировались к одному размеру и добавили такие вещи как индексы то есть это некоторые преобразования каналов скажу можно взять красный канал прекрасные поделить вычесть их друг друг с другой плитных сумму в этом случае будут контрастно выглядеть деревья потому что не поглощает определён объем длины волн я-то как раз тип такие ручные фичи которые подсказывали расти на что обратить внимание то есть помощью индексов они еще увеличить количеств каналов и скармливали их тоже на вход и на это также чтобы избежать артефактов связано с тем что мы в нарезаем на некоторые патчи скале чем окном они брали предсказания и вырезали из них центральную часть то есть избавляюсь от артефактов на углах и это же ушел решение ну вот примерно так и на 5 месте были ребята которые долго очень были на втором месте это была мощная команда они попробовали много всего так во первых но все предыдущие участники использовали юнит и пожалуй ник стремительную системе они использовали dance at sea гниц и они единственные кто смогли инициализировать vesa юнита из весов виде джесси начинает а то есть ты типа но более социализации который позволяет обучаться лучше для нейросети но они ошиблись с классом с одним единственно класса медленной воды и это позволило то есть как бы это была причина почему не скатились на пятое место то есть у них ошибка была в том что они как то неверно пускали 5 класс и зато скатились на лидер городе также они сделали следующие вещи то есть не вы ли руками вырезали машины их было очень мало и просто накидали на картинку так чтобы не носить обучилась на не успели это проверить кажется девочка сны том плане что вы просто пересобирать его шуточки тем самым все должно выход лучших лучших выучить и они еще решили проблему связанную со структурами собственными не были очень узкие они просто руками их расширились при обучении то сделали полигона большие и нейросеть их выучила а дальше когда уже не подсказали полигона них обратном мишели и отправились саммит ты тоже позволило лучше точность еще она прикольно история дело в том что я вложил скрипт который шокировал который как раз позволял получить разрешение на в нем был один бак то есть я там как раз приводил флоту винты и все остановилось черным его пофиксили и выложили с весами то есть это привело к тому что лидер бор сломался все начали его использовать потому что ну когда выкладывает не российский сами можно сделать и сказания и площадь но скоро этих весов средства на лидер борде появились 100 человек с одинаковым скором это было довольно забавно некоторые еще смешали свои модели меню ехали вверх но справедливость восторжествовала когда опубликовали про и вот потому что на про его те модели учителя при обучилась в себе скатились обратную всех использовать своей модели или смешивали своими моделями они как бы остались на прежних местах это как бы пущенной история на мой взгляд которая началась которая удалось дальше в конце я хочу как закончим но работа предсказании россетти слева это картинка которая просто картинка а справа показано как не россии сказать разные классы то есть это последуем на просто класса которые были в ярости а вот как выглядит довольно прикольно потому что ну выглядит вполне юзабельны и доволен акватон tablet виде довольно залипательная думаю что но мы можем продать смотреть я принципе готов ответить на ваши вопросы если есть у меня все меня вопрос а как долго заняла разработка месяц чистого времени ноте по 4 часа каждый день и выходные фунта опроса за интересные вопросы мы даем на третьем который вы можете обменять нам визы"
}