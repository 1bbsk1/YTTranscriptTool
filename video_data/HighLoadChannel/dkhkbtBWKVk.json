{
  "video_id": "dkhkbtBWKVk",
  "channel": "HighLoadChannel",
  "title": "Крадущийся сервер, затаившийся диод / Андрей Аксенов (Sphinx)",
  "views": 2472,
  "duration": 3191,
  "published": "2017-04-25T16:38:35-07:00",
  "text": "андрей аксёнов с докладом крадущийся сервер затаившийся диод сегодня так называемую скорость в целом завтра но тем не менее вот поставили нефти зал ни слова более поэтому не приемлете слова жилых техническом догнать от вашей командой вам возможно получше покинуть зал сразу или на сегодня кушали что-нибудь защиты и например защитные доклад про скорость план примерно вот такой как весьма на профаны планировать скромности так далее подрастающий виде подразумеваются прилагательное правильно не надо думать что я как бы знаю как правильно и являюсь экспертом в этой области так что таскался но есть надежда что как минимум как у него пару-тройку параметры ключевых слов расскажу хоть доклада после чего вы сможете их значит нагуглить почитать или получится стать экспертами и настоящему х и логика вот рассказать уже как совсем правильно без кавычек который есть на своей частью мир один про пичкать в парк нередко выглядит вот так любой то есть а вот попросил счет замерить какая там скорость чего-то супротив чего-то не важно чего все ищем кончается выглядит вот примерно вот так мне сказали приезжать красный fox лазерные указки то есть это делать что есть три ничего значить цифры и они есть одна из них очевидно больше автора как нетрудно нация меньше и они ничего не значит сами себе такие вот для цветов бабками тем не менее я предполагаю что 90 95 процент взамен скорость скачать ровные значит надо ситуация улучшается мы видим картинку вот такой вот роду у готовые вместо двух цып есть две оси и какие то вот графики на них или возможно графиков даже несколько 2 3 4 линии которые показывают нечто вроде там или что транзакций в секунду в зависимости от числа 3 если я правильно понимаю последний вариант должна все это достаточно четко видно опять же вот на этом почти почти всегда мысль устанавливается нет уже неплохо конечно же построить там за миску с транзакций в секунду или табличку с в год в зависимости от какой-то переменной которые вы собрались крути числа тройных стася нервов там числа на китайцев которые у нас там фотографии модерирует него и короче да и давайте коноплева графика там очень клёво они от времени подмен хотели будет скатываться мы cascade собирали свои цитаты о том как по значку ps выглядит через мод нарисовать брать было больше всего тумар серой уже устали рации , спорта по замерам вдвое и еще вот этот бар которые мы допустили в апреле оппозиции либо августа мы в принципе могли бы поставок посетить хотя бы в мае если вы выиграете начали строить на полгода раньше качки это ваш каприз но это уже еще прыжок с рамис цифры но немного не хватает есть вот в идеале идеального отсчета тестирование производительности не хватает у нас есть ли у рпс не дай бог там какой-нибудь или любой другой ничего не защиты и буду ради надо немного больше информации распределение график всем этом дело во времени по разным осям возможно в смысле как там график разных временных штук время отклика всякие перцентиле конфигурация методология всего этого beach park идеально еще и сырые данные чтобы кто-то другой мог по вашему соус и тот же самка не смог повторить и конечно же получить совершенно другие данные потому что вы из как у ревущая копать все это потому что внутри одной точке на этом волшебном практике может как бы находиться маленькая вселенной почему перед окна . то есть вот тут даже не плохо видно а я уж петроса а значит мы два часа поселке два часа жаль нет не будет я убрал сзади два часа шах аль с транзакциями в московии некоторые из них там глазами с некоторые на стене не суть важно собрали вот такие вот времена вот клика более того это уже срединные оригинала сколько там 90 95 процентной перцентиль после не этого вот такой вот интересный паттерна котором помимо значит линии разметки видно еще каких-то в любопытны провалы кто вас быстро этом лили синенькие точки или точечки то маленькие общем так как то все не очень понятно есть какое-то на внутри поведение она все внезапно схлопывается в одну а черт его в одну руку сдуру в одном вот в одном из точку на графике что опять таки может быть это приемлемым но на самом деле не совсем факт нужно прикрепить не работает как же мы ну почему я не знаю как на дно так ли что все клики вот все начинается любая вещь марка region which усилилась и деятельности с постановки целей и вот там всяческие разные цели они расписка на слайде я остановлюсь на сравнении двух систем надо понимать что точно раз когда ты устраиваешь пичкают с целью сравнение двух систем это ты не просто тома использую против пост длится мире ешь и привычную при кошка и высокому в том что после с много лучше эта система довольно широком смысле слова программно-аппаратные комплексы в любом случае в любом случае вынужден работать которой входит жилья за возможно железных не празднуем и простой ни одна машина еще сетка разные версии софта разной конфигурации одного цента вот в этом понимании систем то есть в этом искусстве если печворк испанскую версию 50 51 успокаивают конфигурация номер один по иску версии 5.5 конфигурация номер два года опять таки три разные системы 30 а если дай бог еще и на разных серверах и тем более вот вы еще один замечательный момент который выясняется что то целей больше чем просто сравнительной системы и выбрать лучший тем более что лучше камешки когда нет по всем параметрам и так далее поставленные вами цели они автоматически порождают нужно вас использовать какие-то определенные метрики и характерные ошибки этими рик только одну конкретную метрику которая говорит что-то о чем-то ну еще говорит и говорит о системе в целом например поехали исключительно количество запросов в секунду ну прекрасно диск под нагрузкой жесткий диск под нагрузкой вот невероятное количество запросов в секунду а картина в супермаркете работают активнее всего когда то вот такой вот в этом супермаркете стоит и время обслуживания полюблю начинается от получился приближается к бесконечности то есть тебя куда без застать их там три водка стоим в плагиате черный запуск и так пошло добавилось рпс отличный максимальный но от несчастья забываемо валентность за обслуживание и наоборот мере вот это из 1 трасти другую ну хорошо по мере в один поток жать надо было в 16 потому что оперирование потом of production запускаем школу мальчик свет в 16 марта все совершенно не так вот это проспали даже не 16 1 раз тоже связано или вот еще прикольные метрикой потому что его посмотреть командой по пулевой стрельбе загрузки сервера вода из количества устав если банк почитать что-то написано среднее количество процессов или там легко местных отрядов которые стояли мучить исполнении schedule его с последним британской прекрасный метрика чего-то говорят о том чтобы у меня объектов класса флагов в 1 гигабайт памяти с какой скоростью . за использовать чуть менее чем ничего не даже не можете увидеть если бы ее не было в облако было бы понять цели они порождают нет метрики найти только и функции в который ты хочешь понятно этих метрик смотреть и средние на примере статья про 5-литровой агрегатная метрика которой пользуется чуть менее чем все и я постоянно пользуюсь потому что просто я вообще нет хорошо один нюанс средний анук несчастью не говорит никому ничего средней температуры по больницам и суммируются между лихорадочную пальцами и трупами этом при определенном соотношении тех и других у тебя 36 и 6 мм ура ура никого в жопу а тебе эти камни на трубы в принципе действительно не надо буду живых хотелось примеру математики который может привести к удивительному на слайд в первом случае у нас на самом деле средне средне я почти все 90 град фоткают задавили секунду мы думаем что они в 10 раз уже нам кажется что система работает десять раз хуже в среднем от кредитам стресс размен во втором случае опять же но наоборот то есть мы уже видим что что-то так нехорошо происходит но не видим того что в половине случаев все в принципе хорошо а во вторых на ней случаев все там совсем нехорошо вот люди там за 1000 миллисекунд это или алтай человек заметил иногда иногда годятся агрегатные функции минимуму макс атипические гоняться тоже они нужны ли понимание худших случаев то есть для планирования емкости этот сервер вот мы там на меня лишь у нас минимальная быстром такой и хуже уже не будет ну ладно значит если у вас нагрузка выше таких величин не вырастет тарас это все выдержит или соответственно катастроф когда вот мы не думали что худший случай случится овал случится за случилось стать и все это вдобавок вообще в принципе любой агрегатная функция находишь это может значить только при соблюдении ограничение на всякие другие параметры чуть подробнее про это уже значит шел требует страх и ненависть в лас-вегасе разные метрики не связанными так так если мы намерены что у нас когда запрос отдаются за десять миллисекунд либо 100 запросов с hidra отдается то это ничего не значит несчастье это чисто интуитивно прям хочется взять и поделить стоят давайте давайте поделим наверно получится чтобы весь негатив в среднем запросто дается и вот давай вдвое больше я ни вставил быстрее будет ни фига подобного а не связанными как по тем же самым несложно мультик арифметическим этим как причинам потому что вот эти 100 рпс которые мы намерены этом тесте персик хватает на стене последние которые не значит ничего значит немного поколдовав с цифрами из этих средних можно выкрутить кого угодно и минимум и максимум как угодно media lab то есть . ниже готова вся процент клиентов и вышка только разных клиентов и так далее а больше я ним север и простоять прощай может просто навредить если его пределы муж-то первым вести по тем самым 4 ядра потому что в начнет чтобы если у пиратских цветов в сервер шухер у диск или память то стоящее хуже с кем дальше цели еще философски слой все еще в добавок ренином провоцирует план борьбы и вот есть у нас какой то запросто еще одна деле давайте его оптимизм важно поставить конкретные цели ценятся или цели цели 20 лет подряд который принятой оптимизации преследуешь или зачастую опять же агрегатный метод этим среднего либо него еду максимум она опять ни о чем потому что вот опять значит два примера колдовства с этими как со бригадами мы сильно лучше ли худший случай в первой строке с 10 секунд a drum set то есть вот этот вот самый недовольный клиент один на тысячу у нас стал второй довольно все равно не довольна потому что он раньше он ходил за рейс и удовлетворенно испечь всего за 3 и у нас среднее время обработки снизилась с 11 по моему бились и воды до пяти и нам кажется что все хорошо но на самом деле всё плохо потому что 95 процентов на 95 процентов клиентов скорость обслуживания ухудшилось вдвое и обратный случай когда оно улучшилось 10 раз на самом деле ничего не изменилось с точки зрения агрегатных показателей крайне враг нам надо с ними быть как именно с ними собственно быть вот так и взять еще день нельзя мире теплые салаты запуск не дай бог там время которые диски было выйти проводят известные метрики users the system space на процессоре тогда еще из этого перед нельзя надо мне все целевые метрики одновременно они просто забыли с ним и еще не торгов полях этого усреднять и чисто для справки модов скорее всего не к они прошли целевой метрик смотреть на него прикольный то по всем том что на сервере мужичок диванное происходит не более того и нужна мире всегда распределения они средний по больнице максимальную длину и прочие интересные что не значение штуки чем нужно тебе социальную жизнь и но ему нужно обслуживать побочные клиентов и ему нужно их служить максимально быстро туристам с минимальные задержки на обслуживание каждого клиента и при этом максимальное количество таких клиентов в пятницу времени то есть та самая цели цели царицы она вот такая его массировать пропускную способность но при этом и это важное дополнение на стланником странном синтаксис при этом владевших определенные требования по минимальные латекс допустимой бегу то же самое нельзя ли снова при этом которые обрабатываются в 1000 запросов в секунду они действий необходимо мерить распределению то хотя был так то есть несколько разных перцентиле то есть что такое перцентиль для тех кто то прогулял математику как положено беремся значения располагаем на оси от 0 там до 100 и смотрим 50 процентов значений нас попали в диапазон от 0 а потом 100 миллисекунд что значит что 50 процентов клиентов если мы мерили больного тут web-страницы они взяли и увидели ответ им отдавать ихняя страница за 100 миллисекунд 80 процентов зерно сказать процент звезд 19 то же самое перцентиль там названием 100 это вот худший случай то есть вот был один так пришла рик возможно возможно 2 которые подходят лучше ущелье попал то есть мерить его у возможно тоже нас просто на чисто для общей для общего образования и перцы тип 1 под номером ноль это опять же лучший случай один подсчёт один идеальный человек совсем измерения вот там увидел свою веб-страницу за две миллисекунды они за 10000 миллисекунд как самый лучший ты такой прикольный метрики чтобы понимать какие ханов пронизывающие безумных границ походит они более да вы совсем хорошо строить график всего добра и гранит около темп на стеной пропускной способности например или других интересных лад метре от тех параметров которые вы собираетесь оптимизировать от тех систем которые от тех ран их в общем случае от тех разных вариантов систем которые вы сравниваете ускоренную цель ну вот примерно вот так найти красиво картинка как бы понятно чтобы когда мы потрачены почерпнула на какой-то версию сервера то у нас вот так вот растет пропускная способность вот так вот при этом одновременно вот а вот такое одновременно происходит с открытыми на основании этих данных уже видеть осмысленные решения можете немаловажное края видеть как это вообще часто бывает в жизни и боль тротро ничей то есть о том что мы оптимизируем извините ту самую заметную латентность например и вакууме и саму пропускную способность то же самое не в вакууме то есть оптимизировать пропускную способность само по себе например это означает что давайте станем пропускная способность я уверяю максимально она реально пропускает максимальное количество человека минут времени которых принципе способны пропустить только на недостаточно это пропускная способность и вот в этом бутылочное горлышко то люди напиваются набивайте набиваются обратно это же справедливо и лучший случай оптимизировать тоже не интересно и всегда помним словно цельсию это звучал примерно сто семнадцать раз уже еще не поисковый раз прозвучит всегда помним чего чего ради мы всем этим занимаемся вот цель которая своим измерение производить мы преследуешь что что мы хотим сделать вот написать красивый матовый слайд что после сна пример победил наконец сфинкс по скорости по мотик става поиска особенно когда несет на поиски в москве на базе данных достойно я одобряю все целы здоровы и рассказать за здоровой конкуренции так далее не даёт расслабиться и там в парк south beach толпа сметана желез в конце концов настройки потянуть немаловажно отклонения по этому поводу это такая академического звучащая может лишь можешь что-то под названием план эксперимента говорю по-русски надо сравнивать конечно чужие уже сравнить их и за ним уже это интересно но результат дают классные и самое главное эти результаты можно интерпретировать как водный и любой необходимый выход эти результаты натянуть померили что в 30000 раз попробовали греции был сделать он и случае не на земле существенно медленнее чем тот же самый кредит ты был случай и memory таблиц откуда делаем немедленно и мимо того что и на себе отстой пользуйтесь ими марина вниз и вот внесли какой-то правку вот которая позволила оптимизировать отчет который раз в неделю в 3 утра воскресенья строится и скорость построения этого отчета улучшилась в три раза учет опять же ну так клёво измерение хорошие ребята могут попробовать все быстрее есть нюанс постоянно то есть скрипты пылают милый таблица действительно два-три раза быстрее чем она тебя то еще кроме того но вот все остальное так далеко не так хорошо особенно индексный поиск если вам оптимизация в кавычках отчета убьет производительность всего остального наверно тоже зря мы сравнивали только производительности отчета не проводили производительность всего остального мы спонсора не та же стандартная наколка что скажет давайте поверим к котлу гидру работает но они последние пять лет органиграмме поэтому надо сравнивать сравним собственно именно из-за этого и возникают про вначале делать первоначально идея делать доклад говорите письмах так далее с удивлением прочитал на хабре статью что swix когда сто пятьсот раз по линии мамы я всецело поддерживаю этот вывод как бы несчастью как будет возможно плохо влиять на наш половой жизнью с вообще не занимается дайвингом и поэтому конечно партнера себе найти на форуме open source ней полнотекстовой поисковой машины написанный спасёшь свет на си плюс плюс значительно сложнее чем формальным результат одобряют правильный но интересной методология при помощи которой результат получен значит не быстрый честно говоря не быстро это это dota в 3 утра давид не сильно быстрый осмотр мебель я поставлю показываете что в моем я не померяли значит опять яростным peanut шел доклад они повели на самом деле очень люблю чтобы глупых очень грубо говоря ну ка по индексу на самом деле значит очень интересный метод быстренько быстренько просканировать ровно одну колонку индекса просканировать его клевыми съеден омичи ский сгенерить потом так далее года три четыре пять и так уж тут написать тоже пестрит поверить но не хватает сфинксе панельные fusco вот реально функция красть систему использовали как микроскопом за телефон это чтобы микроскоп разогревался прекрасно то есть в переносе на склеенные термины а я регулярно пропагандируют думать о свинце как они до базе данных из клиенты переносе на использую термин и мы взяли топтала детстве блин то есть помедленнее fools контакты или построить индексы ну это известная как бы трагедия как мы все грешны я сам регулярно бывает парню полю с запросом сквозь потом марианна если дэкс построить из тридцати до двадцати можно с оптимизатором с 30 довольно 0 1 0 не сравнивайте сравнимые вещи не полный перебор с индексным поиском индексный поиск с индексным поиском и или там чтобы такое придумать ряду еще не придумывается у меня например есть лапти раз ты еще интересные варианты почти по всем вариантам как меня лично попадал давайте померим атласный пьют например прекрасный спорт вот так просто запретом pin таки скопировать взяли от вас любил jeffree ну супер супер мы померили вот оплачены менеджер памяти в все что библиотеки и скорость работы ассетов и еще что-то блесну масс в оплаченным года померяли а боевой системы безопа так бывает иногда еще значит замечательным расплаты туда вообще не будет считать имитацию давно по мере уже дефолтные настройки вот я вообще люблю ну то есть с обоих сторон к когда меня в тихом режиме берете когда миллиарде фолком режиме я потому что палец как по исторических так и вполне подхватить иным причинам у многих системы и дефолту постройки безумно low price фунтов до последнего момента была такая не важно настроить его под названием она departure пул выкручена в 32 мегабайта что это значит если что база данных смотрит на мир через размером в 32 мировая если вы делаете письма от пожалте 10 гигабайт она на 32 мегабайта умолчанию на том что genovese мой сфере я просто провожу этот пример потому что будет качественное еще стояла замечательная настройка каждый раз к этому и фиксирую транзакцию обязательно делать меня всегда диск то есть автоматические у тебя количество транзакций в принципе не может быть количеству больших количествах они с которой нанести есть 2 3 4 стандартной на полке которые тоже каждый теперь должен знать о каждом за рабочим и мгновенные тюнить сразу мой спорить достаточно древний версия сторон сейчас уже вроде печенек говорят 5556 я не значит но с диффузными настройками это маску из миссий с grease конце концов so far cry наверняка скорее всего из какое-то внимание на стройке под ваши цели и все вместе совершенно ужасно или то чтобы победы принадлежали уже и выяснили что ешь конечно колющие пробок в целом я щетину this is уже и потому что ешь плохо растягивается недостаточно эластична но вот и еще один стандартный спорт это название то что преподаватель затем они запросто еще раз приветики ему том что правильно они проверили производим скушала мы не поняли запросто направим производим скажи но это какое интересное занятие сравнивать нато сравнимое если вы миритесь сатил написано металла линейку моделей с правильного старая стала затем естественно исключением если все эти прикладывания не ставят собой цели маркетинга немножечко ошибившись немножечко ошибиться в измерениях приложить линейку не стала края стола или почем получить este кратное преимущество но вот это конечно такой не страницу маркетинговый прием нами полезны пользуются все до сих пор часть 2 еще будет 3 еще должны незаконно вопрос останется вообще хорошо прав они внезапно означает изменение производительности к измерению производительности но есть нюанс измерение про внимательности которое бенчмарка давайте по мере в широком смысле слова давайте поделим две системы сравнить и поймем что делает еще почетной систему в широком смысле разные конфеты разные сорт разной железы и так далее про афонин это несколько другое это одна система она у тебя есть под руками и ты вне что ты должен починить штатная ситуация это когда тебя туда запланирована раза два месяца мы там с друзьями едем в баню чтобы как бы поспокойнее себя чувствует на знающий рабочий день после этого устраиваем плановые тест насчет того а быстрые у нас все работы методика этого делать совершенно понятную надо посидеть подумать и печатаю раз паника исполнять понять что конкретно ты хочешь померить какой конкретный эксперемент поставить какие результаты от него получить что ты хочешь измерить учете интересует живопись памяти и там или количество запросов в секунду или там вниманию клик rip сайта собрать все панель щечки которые ты можешь собрать попаду на старте скота дтп посмотреть на них еще вот так вот посетить два дня отыскать диод и повторить такой медитации и процесс на самом деле довольно увлекательно ну опять таки для определенного очень странно во внимание слова увлекательный новый с ним свое время сидеть и потихоньку проценте к выдерживать из производительности эта вот некоторые водитель с более типичная ситуация номер два выглядит вот так типично происходит после того как какой-нибудь очень очень уважаемые сотрудники всеми остальными сотрудниками я уже 15 матерных сегодня вас перебрал коллегам решает например устроить production выгоду в пятницу вечером хоть есть такие есть такие люди которые могут почти ничему не учит или вот например еще значит курилов клевая такая тема потому что никого в офисе дел по типу проходим под ; на высоте неправильно давайте я поменяю пожилому по-быстрому иногда срабатывает но иногда и не все пропало паника и так далее что интересная ситуация отличается ровно она отличается степень утомления снова ночь и его изнутри черепа то есть набора черепу , этика звать злобной сил которые вроде начальством и изнутри черепа конечно на тебя самого томит личная психика в зависимости от твои степени ответственности были бы просто желания пойти домой чтобы потерять еще за дела уже за то чтобы наработать сказался 10 не осталось рабочих тебя начальник перил за то что сервер значит уронили методика борьбы с внезапного падения производительности которое произошло продакшене и софт совершенно руку такая же физику не обманешь единственное что твой эксперимент который плановом режиме ты бедолагами планировал так думаю что хочешь получить потом анализировал многое у успешно возможно даже плодотворно и этот эксперимент уже не станет планированием нужно быстро полете поэтому чтобы и споров зиры воткнется что интересно опять личное наблюдение значит у вас может случиться совершенно не так работать при этом как обычно по 3 ну то есть я часто рассказываю что вот люди волнуются на экзаменах там например или вот когда давление такое что у нас продавшим plaster лежит и непонятно с ним происходит тоже начну искать интернете и так далее у меня слава богу этого не случается это перед выступлением и холодец лишь по 50 хоть на колени к 0 но работать быстрее в штатном режиме так обеспокоен туда лучше не бывает заборе это начальство может показаться начни достаточно ревностным исполнением своих обязанностей вот так тупо быстрее потому что психику в отличие от физики там могут удаляться из тот момент не надо сильно не любящие что скорее все работаешь медлить стандартные тузы книги по стандартным всем известно кто не знает что такое что кедровки не спрашивали пользоваться любым что такое xd банк таиланда высокие нагрузки x2 не пропали все пропали чем долги а вот подобрав ари кто там хоть раз захотела не смотрел толк в системе есть такие люди в зале у попроще уже кирове ступа больше хорошо по что то что это серьезно я так мал пишу как ты считаешь мало величину поэтому так полон пса по то есть когда вы заработаете если нет специализированные тузы и проваливай тогда ведь их никто гиш когда приходится режет по живому и анализировать не просто производитель встроил в приложении а производительность всей системы подчеркиванию в целом это значит с потрохами домов с железом с сетевыми кабелями с парящими дисков и внезапными космическими лучами память против которых даже несите непала иногда невский случай это когда приходится все задел анализировать постфактум ведь и по примеру вот она сломалась когда-то года в 3:02 утро мы точно знаю потому что именно в этот момент на в поддержку британский пришла но записи у нас таких нет потому что несравнимую ни к акции никакие другие страшные слова будет носить вроде поставить плена глупо ставить заранее а после этого уже по приборам еще может нестандартный тузы вот такие надо с ним полтора момента что о чем речь последними щечками просто замерить что у вас все используя бросов предложено в приложении заняли там для всех запросов производя для всех показов страниц произошедших за текущую минут у вас все запросы суммарно за него 60 секунд это очень клево но вообще не мешало бы знать рассмотреть трех дам по каждой конкретной страницы что вот это запросик базу вот эта часть заняло 10 секунд 20 вот это еще 50 ампер вызов внешнего ли пьянь и минут проезд на две секунды ура ура проблема решена что как бы довольно сложно понять и если вот эта конкретная часть не обставлены счет не оставлю счетчик или либо по этим счетчиком считаются агрегатные функции сыра информации не записывать еще один неожиданный инструмента разглядывания проблема производительности используется право слава богу редко жаку в проблемный темам седлом туда посмотрели бы он просит порку и проанализировать стек значит используется крайне редко но когда помогает помогает очень хорошо и я считаю это вот опять лично религия бывают такие люди которые все знают все слова в свою секту и я примеры статьи я считаю что надо знать мировые константы или понимать как устроена наук арифметика не иметь определенный у небольшой оффтопик тоже украина если человек чужой презентации потому что плагин . а ставки - не помню ну я по меньшей мере знаю где посмотреть и украсть отрублена с точностью до порядка 1 то есть на самом деле понятное дело процессор современные утюги миллиард операций в секунду исполнят 23 миллиарда хорошей дозы жидкого азота и все опять всеми местами проблему слишком сильно потому что на пол порядка но тем ни менее порядок величин ясен единство что порядок или вот операций в секунду почему-то остался что интересны мне пока то есть процессор там сколько чисел сложно способен сложите секунду бывает миллиард сколько раз он способен совершить условный переход и при этом не ошибиться тоже для сколько раз я спрашивала способен совершить условный переход и при этом ошибитесь не про него предсказывать уже 100 меньше на порядок 10 разных в 10 раз сто миллионов раз чувствует доступ к холодный память они там горячая чисел до прочитать из тех двух мегабайт киша который у нас на крестовине вот еще на порядок меньше и так далее так далее так далее а то хрен все это знать ради одной простой вещи в тот момент когда ты как бенеш общее представление о том что там из калифорнии в нидерланды посетив сходить это как 100 200 миллисекунд и таких операций в секунду 510 можно прокачать а память ходить в произвольное место памяти кроме нас это все-таки так 5 10 миллионов операций тоже можно прокачать этом вызывает где я уже формируется определенные ожидания по поводу дал насколько быстро некая система должна работать и иногда это сильно помогает друг воле если у вас есть страничка которая ходит в базу по первичному ключу значит это станет из нее какое-то значение лет значение печатает ну а если до в группу а я выдает обратно браузер и вы понимаете что значит на самом деле сходить в память достать по плечу значения это несколько миллионов раз в секунду трепать тупо по сетке отослать пакет туда-сюда-обратно тоже тысячи операций в секунду вадим потока ним несколько кто вас формируется определенное ожидании производительности вас внезапно 10 запроса всего с этой строчки не устраивает вы знаете автоматически знаете что там есть в чине более хорошим хорошим примером не придумал поэтому и автобус как значит все это применять на практике я не знаю я готовы методологии нет могу только поделиться память конкретных кейси один значится боевой во второй прямой неинтересный ну кроме только конечно те кто участвовал в возрасте возможно чего 2 как бы не нашли утром вот не интересный кейс он не интересен тем что тормозов разошлют без нагрузки то есть бегут лье нагрузку на глостер все ништяк там демон кликается поиски там шарж от все хорошо знакомы снимаем загрузка утилизация просто сомов улетит на небеса еще происходит ваще непонятно было складываем все об этом что закрывать помогло помогли стандартной утилиты смотреть что собственно происходит в этих процессов которые as кукуруза цепью по-моему это делалось там тоже без привлечения сравнить их тяжелой артиллерии типа он профайла обошлось и стрессом и дтп выяснилось достаточно быстро что там куча этих процессов висит над их разными текстами 2 смотрели еще внимательный вход выяснили что кое кто то грубая вместо абсолютного времени написала относительно и ну то есть по задумке надо было ждать там определенного момента до для текущего времени плюс 100 миллисекунд абызов ждали до момента времени которые через 100 миллисекунд после 1 января семидесятого года и этот момент сразу наступал и ожидание продолжалось когда нагрузку значит наливали то вот на этот вызов пасечника подомну вот такой интересный значительно более интересные кети края грамм ну вот mais quand продакшне фол все хорошо суббота так вы все отдыхают внезапно минуты место миллисекунд на каждый запрос или клиент значит брешь что все хорошо но что она съела в первую очередь исключить глупости отдельность совершенно безумный намного глупости это когда виртуализация потом вообще не значит гипервизор партию день до бороться изолировать проверили глупости виртуализация нет глупости гипервизора исключая данные хрониста с ним со не правельно что действительно стать клиент не врет запрос тормозятся шоу просто средства у них дойдет действительно так проверяем что с самым все хорошо куб легенд наших зашел водку давал посмотрел статус она говорит нет сам этих боях оспорил еще не говорим ну ладно откопать дальше шел процесс листвой кстати рост от что видно из шел процесс лиза видно что куча запросов при висит в фазе или кстати кометы извиним статус у нас тут видно что стопроцентный л.в. утилизация таманская но мало запросов исполняется в секунду то есть большая всего редактор на систему просто народа в 10 раз больше нагрузка чем рад что все тормозит в тот момент когда ты видишь что-то типа сара простаивают и тонкие и стану все нормально иметь утилизация зале зации сетки 0 утилизация значит дисковой подсистемы через потолок статус дисковый под системы согласные мониторе кутузов нормально вообще ништяк вот в этот момент важно психологический прыжок не потеряйте себя так сказать эвери потому что видишь вот товарищи не потеряли себя оба земли тому что видишь зрители и начали исследовать дальше был архип информация собранная сара стала не что в момент сбора в тот момент когда все их наступил резко упала количество транзакций на чтения на запись о транзакции не в смысле аббас этом смысле одесской под систему и резко выросло то есть сто пудов это все-таки дисковую систему она не просто компов обученного запущена зацеплены и мотивами шкаф следователю много разных точек слоя и следовательно нужно сделать что правильно постепенно исключать эти самой точке сбора исключаем исключаем тут унесла был посидела всем своим длинным хвостом сделай письма взрыва сервера параллельно с этим некоторые возможно уже догадались что произошло правильно с этим до мнение не это было бы слишком просто клиентов так он волнуется до не спит минут ну все плохо на улице просто запрос исполняться одну миллисекунду а начал исполняться одну минуту это падение производительности ровно 60 тысяч раз а после чему хорошему не приходит он волновался как мог и в один прекрасный момент нажал кнопку f5 браузер а тут сам мониторинга статус осознавала браузера затишье вала в локальных browse результату сам никто не увидел того что на самом деле в нем в районе ездок таких диск через что-то многократная деградация дисковое тут систему на этом самым со не лечили что все собственно плохо напомним первое что значит клиент сказал это что там в полет нормальный и вот все хорошо еще не менялась мораль но очевидно дам никому нельзя верить доступна людям еще нельзя бились моим собственным глазам там же как там за этим на эту страничку и папы хавку нажатия мониторинга статуса системы не нажатие в пятницу уж нормальное явление регулярно бывает их там за эти по старому энди адресу накладывался неоднократно вот больше если я рассказывать не буду потому что им не совсем нет или в это время в это время которого совсем не я запихну самую странную часть тому вообще глубокого философского теоретическую если угодно названием предсказанием как можно пытаться предсказывать масштабируемость то есть я вам планирую уложится во время если щупалец встать и вопрос поэтому все ключевые слова не сразу здесь есть несколько основных таких странных законов пробовали физически но на самом деле математических который ты в принципе не способен обойти вот например давно придуманы придуманных далеко не ебу на гаити а просто в теории обработки вся фото на складах и так далее названием закон бритву то есть если у тебя есть там про теленка грим на обработку клиента и там определённый темп прибыть эти клиентов to practice луком его матчей но все равно ты больше клиентов обработаешь то есть если тебя в среднем приходит там сколько вот если theorist вырывать 10 worker of и на обработку одного завода статья требуется полсекунды с этого worker а ну как бы сильно больше пяти клиентов одновременно не обработаешь меньше клиенту все будет хорошо несколько локеров был просто вид больше клиентов постепенно начнут копиться очень добро пожаловать пробку но атаку физику не обманешь будто знаешь закон выглядят как полный идиотизм надо понимать что вот эти числа не пиковые какие-то явления а сложной математики заключается в том что длинные средние то есть средние значения усредненные с достаточно длинные периоды нетривиальные математические выводы как раз в этом заключается что вот мы как интуитивно понятно а ты поднята гаражи что вот если мы наблюдаем систему в течение одного года про именно вот так все и будет туса или что средний можно перемножать они просто текущее значение вот оказывается можно еще один закон значит законов дала длинный тап и он взял смелость переформулировать чтобы ты есть то что мягкость и не бывает красивые графики с википедии выглядит вот так и смысл неё довольно страшно самки что если у нас как-то масштабировать работы параллельной работы представьте себе что средства этого работу которую пять процентов не проливается по той или иной причине всего 5 процента это значит что интуитивно понятно что 20 раз ускорение закидывание в железо скажем так это максим который мы тоже получим этом случае или более того то форму внутри подставляю в лицо руб оставляем эту формулу разное количество практических профессионалов которые мы набрасываем на эту задачу которая всего на пять процентов не параллельно со всего 5 процентов от общей нагрузки должно быть и последователь мы получаем довольно страшные цифры что значит даже не смотрю нее 60 процессоров об ускорении в 20 раз не получим палочку в 15 раз вот такой грустный но обещание закону после чего человечество почти еще сильнее потому что он дал был давно и поняло что даже отдала им стабильности не бывает смотрим на смотрим на смог смотрим на смотрим на исход игры который оправдала кривая растет растет и постоянно растет а потом дала говорит что если мы будет постоянно задач которые там хочет параллель саботировать процессоров то у нас конечно в один прекрасный момент там кто-то не будет от этого никакого горка и македонии это тысячи процессоров на 2000 пасторов у нас все равно там эффекты есть нос сломал но при этом вот эта вот кривая будет расти на самом деле если мы посмотрим на такой то письмо которое это самом начале приводил первый попавшийся тратились уже спать то видно что это не так накидываем маркеров она тормозит то есть кривая не выглядит она не естественно нелинейная масштабируемость то есть товарищем толковали что линейного еще не бывает но она выглядит даже не как бывает вот постоянный рост против прекрасный момент он начинает как это сказать забухать еще сильнее значит еще уже делаем вот другой умный человек понял еще одну простую вид что значит есть две причины по которым систему на которую ты набрасываешься больше больше и больше ресурсов все больше больше больше правильных работников не буду тебя масштабироваться нелинейной не даже вступление во первых есть не пора ли вещаю ся часть работы во вторых у тебя скорее всего есть какая-то степень когерентности которые не учитываются в истории исходным мега уравнение и надо ее ущипнуть тоже если у тебя есть какие-то данные которые надо вдобавок синхронизировать между всеми нодами из чего исходная модель не учитывает есть ли паралич если работа или климатом затрат на синхронизацию потоков как бы нету исходный материал на самом деле они есть и на самом деле общие данные синхронизировать на самом деле все еще хуже и выглядят примерно вот так или емкость то есть степень масштабируемости другого какой speedup мы можем ожидать во сколько раз когда мы можем ожидать если напросто там 20 баксов за дочь 50100 и так вот времени нет совсем то поэтому практически вывод из этого всего никакие из этих вот страшную форму и и вот этих страшных графиков а вот я начну не оседал вставить слайд о котором красиво нарисовано что вот эта кривая на очень близко кривая предсказано законом комочков универсальным законам масштабируемости она очень близко там мы наблюдать на продать хотя может час будут еще пазл отрезал практически году простит и на самом деле в чем родства во-первых потушить контенту то есть мешать вот когда у вас есть система которая надо васина масштабировать сильно раз параллели то значит ваша основная головная боль чо говорит теория теория говорит тушить контент душить кафе люси тушить вот это вот количество не параллели щийся работы во первых и количество данных которые надо продюсировать между всеми 3 2 автор и улучшать проблемы с любой другой любой значит ценой и еще есть один интересный вывод что есть определенная . те производительной системы оптимально в отличие от законом дала вот чуть более сложная модель рассказывает что есть . таким вот есть вот этот максимум 2 сколько надо 3d фокеров стоит ли ровно столько машин кластер или ровно столько значит человек китайцы сажать в офис потому что если больше китайцев посадишь в офис порядка длина коммуникаций они как бы вот все съедят и этот самую воду следует спад не знаю по-русски честно говоря сам самую маковку наверное можно ее измерить во-первых очевидно но если нет никаких ресурсов на то чтобы при каждом новом значении трейдов гонять бесплатно 3 часа дрянной ее можно оказывать еще и смоделировать потому что зависимостям внутри довольно простая квадратичная и натравить на него регрессию нет никаких сложностей вот живой пример опять выбрать несколько точек несколько измерений скорости и за этим она вот пусть постоянно растет то есть если ты надеешься на то что у тебя линейная масштабируемость это уже по этим слайдам поэтому поэтому 4 5 делений можешь не надеяться что трение масштабируемость но ты можешь надеяться что диазом воном дала работает и вот оно будет расти расти расти или так она не будет расти расти расти она от повышения конкуренции повышение трейдов коровок китайцев и т.п. в определенный момент начнёт замедляться вдумайтесь замечательный поставили сервер в котором 256 шпор базы работает если день арка хорошо вот исправленная модель который учитывает то что есть еще определенная когерентность она дает вот такой вот кривой который где-то там отсекается и битвы производительность дает вот налоги 2027 3d что интересно результатами как пульт не вполне по модели что как бы лишний раз доказывает вот и лишний раз показывает чему любая теоретическая модель отличается от практики они и уверенно опережают но тем не менее видно что в один прекрасный момент этот самый slide спад прямо для достигается и что действительно вот примерно вот этих самых 27 грн то есть вывод что вот оказывается в один прекрасный момент можно все сути смоделировать они померить это очень приятный и в тот момент нет никого технической возможности для каждого значения ордеров от одного до ста двадцати восьми все перебрали итоги подведем итоги прости три части было поймут эти слои со слов про бенчмарки когда делаешь печати надо помнить проценты не путать числа и путать что у тебя количеством запросов в секунду как это связано с владом пастей наоборот латентности не гарантирует никакое количество работать в секунду мерить надо нужны они молодыми rich мерить не надо средне надо мире хоть какое-то распределение хоть там пару-другую квантиль x и перед медиан 95 процентов 99 так далее пути все и на лучше чем среднем даст тебе сильно более мокрый концу не надо забывать об ограничениях и верить вот он мне мире другой конечно надо сравнивать сравнимое они там fools как майская сравнивать с специализированные железка revo 2 раза про про то что же наплети это такой или рука уже про профайлинга тропонин полтора момента технических полтора психологически полтора технических момента на то что стандартных пузырь на самом деле дают результат просто надо знать новый список там слайдер плитный гримстад потому что в одно смотрите простоту и т.д. и т.п. над пренебрегать архивный то есть все у кого там самом деле туда и тобой проще средств мониторинга и аккумуляции счетчиков не настроены срочно бежать их настраивать я считаю потому что иначе пап наплачетесь тот момент когда будете анализировать производительность просадку производительности которая произошла в 3 утра и очень сильно шейлис флаг надо вместе арифметику которой какое-то представление о том какую такой порядок производительности ты можешь free system ожидать ты вот на пальцах можете вопреки ну не надо ничего бояться том что страхую верный путь завала проекта и не надо никому верит в том числе само по себе на дверь потому что ты видишь глазами и обои видишь глазами и даже не на двери того что ты наметила перепроверим и наконец не радостно и одновременно радостно и сходство предсказание что вот нет никакой не любит и масштабируемость и суд линейной масштабируемость поэтому все расчеты которые вы делаете о том что вот сегодня у нас один сервер и это хорошо мы завтра можем поставить 10 ей получить десятеро большую производительность они внезапно если аккуратненько участие линейные эффекты могут оказаться куда более грустными ну да что вверх front-end и таким образом масштабируется типичного хорошо как бы тот самый к хироси тот самый контент небольшие с базой данных например все куда более печально даже sublime масштабируемости нет по закону наблюдала и я жив два вывода этих есть обходимся с ростом может наступить беда ты построил поле мышцы сильно работать медленно это один странный минут а второй стороны вывод что вот всегда есть такой по всему систему оптимальный режим эксплуатации и вот эти точки значит важный на графике их можно померить а можно предсказывать делает с простой советской линейной регрессии разгар отеля уже там пять минут на предмет это почти все значит заботиться о запахе хочется вот на этой ноте . на твоем вот этот товарищ вот этот товарищ или там для царства крайне вот этот товарищ то есть небезызвестный шерлок холмс любая проблема как измерение производительности как поиска внезапно возникшей опять же внезапно возникшей петли с производительность так и вообще честно говоря почти любая этим проблема она честно говоря решается с помощью и затягиваем mothra что если все абсолютные возможные варианты ты исключил то именно то что осталось даже если она выглядит абсолютно невероятным обязан и справа значит делайте beach party правильном и там не верьте весь в себя уровня"
}