{
  "video_id": "BX0Pwywen2k",
  "channel": "HighLoadChannel",
  "title": "Консенсус на пальцах, или Как договориться в распределенной системе / Владимир Протасов",
  "views": 2950,
  "duration": 2625,
  "published": "2021-10-04T02:45:37-07:00",
  "text": "меня зовут владимир ворота saw я технический менеджер в яндекс облаке часто спрашивают кто такой технический менеджер это человек которого заставляет работать менеджером но не получается сказать что у меня лапки я не буду писать код потому что технический давайте там я могу сейчас рассказать какие классные проекты запускал о том как написал там свой консенсус когда еще не знал что такое консенсус он работал очень плохо не рекомендую так делать расскажу что примерно 80 процентов жизни я пишу код и где-то последние 11 лет это распределенной системы в продакшене иду на этом мы остановимся а давайте расскажу что будет во первых не будет никакого хардкора не будет никаких формул не будет там вот этого человека с тремя докторскими степенями который читает вам научную работу все будет очень просто на пальцах но большей частью и мы с вами построим алгоритм консенсуса на самом деле даже 32 с половиной и посмотрим что же может пойти не так мы разберем несколько ситуаций не все потому что в распределенной системе может пойти не так все что угодно и если бы я вам рассказывал все мы бы тут с вами засели до конца дня и потом еще на всю ночь и возможно бы еще не все разобрали и постараемся захватить некоторые трейдов и если успеем я постараюсь не сильно отставать и так давайте разберем вообще зачем нам консенсус я возьму хрестоматийный пример возьмем банк представим что у него всего один счет и он хранит наши деньги им мы спрашиваем дорогой банк сколько у нас денег он говорит 1000 долларов и мы таки а здорово мы их можем потратить тратя мы все хорошо теперь у нас три сервера в банке и каждый из них хранит информацию на нашем чате но там 2 вели он там неправильно транзакцию откатил и не сохрани синхронизироваться с первым 2 вели он вообще ни с кем не синхронизировалась у него там нолик и вот мы получили такую ситуацию и вполне нормально что мы пришли таки сколько он денег ну ты еще все хорошо до 900 долларов не у тебя всего 100 таки что за ерунда запрашиваем баланс он нам говорит 0 мы таки не понимаю вообще что происходит паника звоним в банк ругаемся в банк тоже ничего не понимает все бегают ничего хорошего также есть важная история со скоростью здесь был другой логотипчик нам него поменяли кто по описанию догадывается про какой алгоритм тут вообще про что история о есть один человек 25 транзакций в секунду медиана и время транзакции от 3 10 минут вообще транзакция может зависнуть на неделю на месяц это bitcoin консенсус и текущей биткойн алгоритм там вы можете конечно заплатить кучу денег но в итоге вы не представляете не знаете сколько у вас транзакция времени займет если вы возьмете этот алгоритм консенсуса и зачем-то запихнёте не знаю какую нибудь распределенную систему продакшена вот я для примера привел кубер nights кластер но это может быть все что угодно у вас какой-нибудь failover занимает от 10 минут мне определенное время представляете там к вам пользователь прибегает такой что где а почему ничего не работает гендир прибегает а почему ничего не работает а вы-то кинул нас тут консенсус считается мы тут на система договариваются и это когда-нибудь может быть закончится дайте кратенько посмотрим вообще что есть вообще есть три их назовем их семейства алгоритмов это paxus ровд и без антен fault tolerance который часто обозначаются как bft тут можно много про них говорить мы сосредоточимся на пак си си и рафти известной реализация это chubby pigtails панара зуки перцев в общем много их я выписал только очень малую часть уров то там вообще бесконечный список его так вот скроллишь скроллишь скроле скроллишь скроллишь и он не заканчивается тут есть на шоу и де беф который реализован свой показ потому что у нас задача такие что периодически приходится что-то делать такое с нуля здесь есть войти в котором очень очень давно еще когда рафта не было был реализован алгоритм консенсуса который сейчас потихонечку сводится крафта тут есть в списке клик house у кого возникает вопрос и вообще почему в списке рафта клик house нет вообще клика us использует закипел и естественно paxus под капотом но если вы поймаете ребята футболках клик house не тормозит они вам расскажут почему кликал со смайликом и в колонке равта и есть ещё один важный момент давайте я кратенько расскажу про без анте нфл толеранс алгоритмы вот буквально одну минутку выделю и мы перейдём к сути собственная история про про византийские алгоритмы они идут из задач и о византийских генералах генералы окружили город и им нужно скоординировать атаку если они все принимают решение атаковать то город падет и они победили но среди них могут быть предатели которые могут перебирать сообщения и им нужно договориться так чтобы их атака была скоординировано несмотря на то что там могут быть предателя это систем это ковалентная какой-то production системе в которой какие-то ноды могут действовать нечестно или могут просто сбоить там кто-то накатил кривой код ответственно чтобы понять как работает это вся история нужно разобраться с тем как работают алгоритм р.а. access которые лежат в основе являются можно сказать упрощенной версией давайте на примере обеда разберем эти все истории у меня одна знакомая говорит что все сложные вещи нужно объяснять на деньгах и найдя деньги я уже использовал вот теперь и да давайте познакомимся с нашими персонажами это аня и боря они front in der и васей галя бы киндеры и дима он 2 они работают в одной компании и вот стоят в одной очереди на регистрацию на холоде им нужно выбрать время когда они будут обедать значит они стоят и так и думают но как когда тут много сложных вариантов еще как-то между собой договориться нужно им и самый простой очевидный вариант мы говорим что они у нас вообще еще лиц в команде поэтому пусть она решает и как она скажет так и делаем вот они говорит ланчбокс кто тут не первый раз на холоде многие не понимают под 100 выслать боксом в общем раньше были ланчбоксы теперь нет опций и только кафешка поэтому они такая ланчбокс и на регистрации говорит не неких ланчбоксов нет вы что у нас тут только один вариант но можно выбрать время и она говорит ну окей дайте с 1345 будем обедать и все-таки ok все хорошо здорово быстро просто все довольны все уходят кто недоволен но как-то они приняли правила игры есть один нюанс у этой истории если они опаздывает мой классную картиночку с такси убрали ну ладно в общем если они опаздывают на регистрацию то все стоят в очереди таки так ну мы же договорились что они решают все как нам договориться все плохо сложно очередь за ними стоит бунтует они недовольны очередь недовольно люди на регистрации недовольны все плохо если в реальной системе такое происходит-то это вот выглядит примерно так нас теряется мастер лидер все плохо ничего не работает в лучшем случае работают запросы на чтение ваш дежурный администратор выглядит примерно так собственно что же будем делать давайте мы по моделируем это системы смоделируем первый алгоритм и разберем где что может пойти не так как мы обычно поступаем когда нам нужно принять решение группой мы голосуем поскольку нас пятеро ребят пятеро решение принимать с тремя голосами это обеспечит большинство и не возникнет ситуации что половина решил одна половина решила другое мы все хотим вместе пообедать также чтобы не разводить сильные споры мы договариваемся что но если что-то предложили там и это принимаем то есть если у нас пришло какое-то предложение то мы с ним просто соглашаемся если мы конечно не приняли какое-то другое потому что нельзя менять решения и у нас по одному голосу и вспоминая задача византийский генералов мы говорим что все говорят правду и никто не обманывает у нас все люди честные чтобы не усложнять историю первая проблема которая может случиться это мы можем начать голосовать за разные вещи кто то говорит что ну kyani предлагает давайте в 13:00 и бери такое тоже давайте в 13:00 все соглашаются но они и вася думают что это на сегодня а боря и галя не такие ну сегодня мы тут еще посмотрим может еще в крокус сходим пообедать потому что ну как-то кофейку попьем и вообще там доклады сегодня интересные это вот завтра будет перерыв чик как раз сходим и вроде бы договорились там где мы вообще без разницы он так потусить пришел и вроде бы договорились что в 13:00 но по факту кто то считает что сегодня что кто-то считает что завтра то есть вроде договорились а вроде нет к это такая ситуация шрёдингера но давайте подумаем как это можно решить давайте мышь программисты поэтому пронумеруем почему с единицы но так уж вышло начнем с единички и будем каждый раз увеличивать номер голосования так чтобы мы каждый раз далее что мы голосуем о чем-то одном они о разных вещах и если у нас разные номера кто-то такой думать ну я голосую за второе а его сосед говорит ну нет я голосую за 3 номер который больше побеждает с тест на если у нас голосование за разные номера то мы считаем что это третье голосование они второе вот дойти прямо на примере разберем чтобы было понятно то что я уже наверное всех запутал вот допустим они а сборе у нас вот они так вот они там справа они уже голосовали в рамках какой-то группы у них уже номер голосования 2 или они просто плохо выспались и что-то там не вспомнили но неважно в общем у них второе голосование остальных ребят 1 они еще ни за что не голосовали у них все хорошо и дальше они обмениваются номерами голосования вообще все со всеми я тут нарисовал только часть стрелочек и когда кто-то видит номер меньше чем у него то он говорит нет дорогой друг сейчас не первое голосование сейчас второе и в итоге мы приходим приходим к такой историю у всех второе голосование все хорошо мы договорились о номере мы считаем что мы голосуем об одном и том же и все бы хорошо но если вы знаете что происходит когда инкременты числа они в какой-то момент переполняются в общем есть такая история с apache за кипером там есть куча старых богов самый первый счет десятилетней давности там переполняется один из идентификаторов которые мы обозвали дентифик котором голосования за теперь он называется за exedy и кластер сходит с ума он считает что а у меня тут новый лидер появился пытается понять что вообще происходит находят какие-то странности и в этот момент tickets даже нашел показал там у меня где-то в примечаниях должны быть ссылки в чем ваш администратор когда это происходит вот он абсолютно спокоен с ним все хорошо он уже привык ну ладно как-то это частная проблема мы считаем что у нас все хорошо у нас номера не переполнились у нас пока только двоечка и вообще 2 миллиарда раз людям договориться не так уж просто нужно договариваться несколько раз в секунду на протяжении 30 и 60 лет не реальная ситуация так что у нас все хорошо мы выбрали номер и давайте будем делать предложение на голосование только пока мы тут с этим всем разбирались у нас вася отошел кну им очень нужна была как мы без него справимся и так боря предлагает пойти обедать в час а галя говорит в полтретьего пойдем дальше они предлагают это они едины соответственно еще не голосовали принимают дальше они ходят друг другу все уже проголосовали и мы получили ситуацию когда никто не понимает что мы не набрали 3 голоса у нас разделились голоса большинство не собралась как-то ну что делать мы там в данной ситуации мы проголосуем там теперь он вам напишет кучу всего в логах или там эти сиди и консул они ругаются что там смогли выбрать лидера и давайте там еще раз попробуем так все хорошо пока мы тут разбирались этой ситуацией другой случай произошел к нам подошел наш знакомый женя это темный двойник димы и говорит о привет ребята давайте с вами победы таким конечно же не давай присоединяйся к нам пока мы разговаривали вернулся вася все сделал готов дальше обсуждать и собственно начинаем предлагать там они предлагают в час а отдавать вообще кофе попьем что там доклады то интересное зачем этот обед дальше моря такой ну давайте в час галя такая окей кофе дальше они дошли до 8 и же не соответственно те приняли предложение один в час и другое предложение попить кофе и мы получили прекрасную ситуацию у нас по три голоса за каждый вариант и это наш любимый сплит brain мы не договорились мы не договорились у нас получилось две группы которые приняли разные решения а вообще-то вместе хотели пообедать то тут что мы сделали не так мы взяли нового участника но не увеличили необходимое количество голосов так чтобы у нас большинство могло быть только одно есть это так называемый кворум очень размер кворума который везде устанавливается обычно статически и если вы в реальной системе введёте дополнительный узел и не увеличьте размер кворума то у вас пройдет ровно такая ситуация у вас появятся две думающих головы и ваш системный администратор или дежурный будет вот абсолютно спокоен а продакшен будет гореть но ok давайте посмотрим что было бы если бы же не и не пришел мы договорились о номере все хорошо мы после предыдущего голосования у нас мы сошлись на троечке ровно тем же способом обменявшись друг другом номерами и они предлагают в час же и предлагать но он отказался от этой дурацкой идеи не обедать он говорит дайте в 14:30 все хорошо дальше они доходят до боли и галле берри с галей принимают следующие предложения дальше моря с они доходят до вася вася говорит о'кей в час пока там остальные ребята до него доходят но говорит не ребят я уже проголосовал и zaps на обед спасем мы договорились идти обедать в час а еще мы изобрели paxus ну и пока там договаривались разгневали те кто стоял в очереди за нами но как мы уже решили проблему так что ребята могут быть спокойны собственно чуть-чуть про paxus это история его очень интересная где-то в конце 80-х systems research center запустил файловую систему эхо это распределенная файловая система про нее никто не знает потому что она кажется закрытая было и ей где-то во внутрь of пользовались но один из исследователей если лэмпард посмотрел на эту говорит мне ну нельзя такую задачу решить то есть нормально сделать распределенную файловую систему чтобы там ничего не путалась нельзя и сформируем ролл проблем распределенного консенсуса и начал доказывать что так нельзя сделать где-то в начале 90-х полном как раз в девяностом году он доказал что вообще можно решить проблему нашел решение и сформулировал алгоритм баксов написал статью отдала ее на публикацию и никто ничего не понял потому что он назвал ее кажется партой парламент и объяснял все на примере греческих деятелей парламента и там ребята из журнала говорят окинул как ты конечно интересная история про грецию там про археологию все здорово ногу при чем тут компьютерный журнал что вы от нас хотите и где-то кажется лет этак так 8 он пытался всем эту историю продать объяснить вообще что происходит за это время у людей начали возникать аналогичные проблемы они их пытались решать и в какой-то момент там были уже другие публикации какой-то момент он дошел еще раз да журналы говорит вот ребят смотрите вот тут публиковали вот тут публиковали вот тут и раз людям важно давайте тут опубликуем как вновь найденную старую работу которая касается предмета и в девяносто восьмом году только опубликовали все начали обсуждать все говорят ну как бы да интересно но мы ничего не понимаем начали разбираться с этой всей историей и где-то кажется в 2001 году он опубликовал историю puts a simplified упрощенное описание пакса south он выкинул оттуда все не важные части которые не являются необходимыми и опубликовал и я все хорошо но никто опять ничего не понял то есть все смотрят что это такое зачем это куда это но кто-то начал реализовывать в общем история как-то пошла в access а есть немного проблем первое это то что он медленный то есть нужно со всеми пообщаться сначала номере договориться потом нужно опять со всеми пообщаться голосами обменяться долго сложно и непонятно там куча всяких действий пока ты разберешься что происходит можно с ума сойти если у вас продакшен системе такая история то пока вы ее де бо жить можно там начать рвать на себе волосы я знаю некоторых людей которые выкидывали выкидывали paxus и брали другого алгоритм раз потому что ничего не понятно когда она ломается а главное он очень далёк от практики тут ничего не сказано про тайм-аут и ничего не сказано про то что делать в случае там потери пакетов непонятно но можно значительно ускорить мы кстати к этому вернемся после этой лекции вообще кто-нибудь помнит что я рассказывал про людей которые probed договаривались помнит о класс я не всех запутал это хорошо давайте разберем другой вариант построим другой алгоритм попробуем как-то обойти эту историю нас опять ребята в очереди все очередь пока спокойно никто еще ничего не знает мы только пришли только наша очередь подошла мы решаем что же нам когда же нам пообедать эти новые договоренности у нас как в самом первом случае решение принимает кто-то один лидер но чтобы избежать ситуации когда мы не можем принять решение потому что кто-то опаздывает там или отошел можно предложить себя в качестве лидера если текущего лидера нет и мы выбираем лидера точно также тремя голосами то есть достаточно чтоб три человека поддержали кандидатуру у каждого один голос и решение менять нельзя помним про наших византийских генералов мы пока не нас никто не врет все честные все-все идеальные люди вот давайте начнем процесс выборов здесь очень хитро история мы в начале процесса предлагаем каждому участнику загадать случайное число от 0 до 300 и дальше он считает от 0 до выбранного им числа все хорошо здорово ребята считают вот галя дочитала до четырех боря досчитал до 5 это случилось примерно одновременно галя чуть чуть раньше дочитала и они такие а мы кандидаты мы сейчас будем предлагать свою кандидатуру голосуют сами за себя и вот у них по одному голосу можете видеть и дальше они предлагают свою кандидатуру они единица тест на те их поддерживают потому что еще не голосовали дальше галя предлагает свою кандидатуру вася вася поддержит потому что же еще не голосовал и галя объявляет себя лидером нужно набрала большинство тем временем вася приходит о вере тоже приходит к вася говорит подержи мою кандидатуру вас такой не меня я уже голосовал извини и тем временем галя всем сообщают что все я для главное все делайте как я говорю поскольку мы верим что все частные то все говорят окей мы тебя слушаем был делать что говоришь я на говорит о'кей мы идем в час записывать эту бумажечку и всем транслирует бумажечку все-таки о мы идем в час отличное все-таки говорят о кей все мы идем в час люди на регистрации выдают карточки все довольны все здорово но как вы понимаете история очень похоже на то что я объяснял в предыдущий раз и пойти не так могут ровно те же вещи кто-то может отойти кто-то может не проголосовать общем история очень похожая но интересно а чтобы у нас не случилась история с тем что если галя где-то опаздывает или отошла а нам нужно срочно принять решение она регулярно всем напоминаю что ребята я еще здесь и как только коллеги не получают от нее отмашки начинаются новые выборы ли выбирается новый лидер если галя вернется она ей скажут не сушит и больше не лидер вот у нас новый лидер и она станет слушать его естественно лидер всегда ведет журнал и раздает его всем остальным собственно история гораздо быстрее потому что не нужно договорятся номерах не нужно каждый раз причем каждый раз доделать все очень просто понятно ну правда я не разбирал проблемы которая выглядит вот ровно так же как в предыдущем случае чтобы вы тут не уснули а мы тут не застряли на целый час но давайте посмотрим на ровд и такие ну посмотрим как же можно улучшить показ один из вариантов это называется мультипак сос у нас любой из участников может сделать следующее выставить на голоса не следующее предложение я лидер и когда вся эта машинерия пройдет мы называем говорю что вот он лидер и теперь он выбирает номера голосований все здорово понятно просто и давайте немножечко сравним paxus и ровд вообще баксов не требует выбора лидера то есть он может работать быстрее если мы выберем лидера но целому мы не обязательно и он нормально без этого работает случае равта здесь обязателен выбор лидера и в целом если вы для вас важно чтобы там не было центральной точки отказа то возможно вам подойдет paxus также paxus не требует журнала и в целом как то он может работать только сохраняет текущее состояние но никто не мешает вам вести этот журнал ведь вам так же нужно выбрать лидера который будет вести журнал и все будет очень похожим на 1 1 by журнал не работает там очень много внутренних связь завязано именно то что там журнал более того если вы начинаете вести журнал у вас появляется дополнительное требование случае если вы живете без журнал вы можете принимать любые решения и транслировать результат случай если вы ведете журнал у вас каждый участник группы перечитывают журнал и выполняет те же действия с там написано что мы идем обедать в час все хорошо а если там написано пройдись по хэш-таблицы и выведи список значений которые там то результат быть недетерминированные что хэш таблица будет упаковано на разных новых по-разному с очень высокой вероятностью если вы не применим не примените для этого специальных приседаний собственно другая история еще это очень субъективная часть если тут кто-то кто готов меня ругать за этот слайд нет никто окей вот вообще в целом paxus субъективно более консистентной потому что узлы каждый узел принимает участие в принятии решений и здесь у каждого узла актуальная информация пока он не выпал случай равта здесь узел может отставать и может считать что у него все хорошо но при этом иметь неактуальную информацию но в любом случае вам нужно спрашивать большинство участников если вы хотите узнать что же сейчас решили иначе вы можете получить неверный ответ даже случае paxus а также есть такая уже больше математическая история пак ха сон доказуемо сойдется есть теорема что за конечное время pax вас примет решение никто не гарантирует что это конечно и времени будет несколько миллионов лет но тем ни менее ровд теоретически может не принять решение но за счет случайных таймаутов он но в какой-то момент на практике сходятся если у вас конечно генератор случайных чисел не сошел с ума и не выдает одно и то же число ну и в целом access он немножечко сложнее потому что там больше движущихся частей больше раундов в случае с raw там все немножечко проще и он ближе к практике потому что там прям стандарте написано вот здесь подожди от 0 до 300 секунд здесь регулярно опрашивать здесь делай так здесь делай так и в целом если вы берете там пайпер про ровд то можете взять и написать алгоритм он там он не сразу заработает потому что все равно еще не все прописано но в целом он очень близок к практической реализации собственно тут вообще дать небольшой небольшой выводы сделаем из того что я рассказал распределенный консенсус кстати там что я рассказал вообще понятно то есть там кто понял о отлично я думал меньше рог будет то есть все таки понятно а кстати да кто из вас до этого не понимал этого так ладно вот теперь картина уже более реалистичная но вообще разделен консенсус он в целом если вот его так рисовать он очень простой пока вы не начинаете писать код потому что там начинает вылезать куча проблем куча разных костылей как куча таймаутов куча разных нюансов плюс там пакет и начинает теряться сеть сегментировать в общем может пойти не так что угодно поэтому лучше взять готовую реализацию и вообще лучше взять ровд потому что пока с он довольно сложно его довольно тяжело де пожить там если кто то сталкивался с серьезными богами в зуке перья что там что-нибудь за кибер кластер развалился это не очень часто бывает на если развалился то обычно дебаг занимает очень очень много времени я вам накидал немножечко статей почитать многое из этого вы наверно уже видели или слышали из этого всего имеет смысл обратить внимание на две истории про paxus это paxus медлайф и pax из моих practical paxus майк practical это история о том как из вот этого простого подсоса получить мультипак csa еще дополнительные оптимизации то есть как это все оптимизировать где тайм-аут и навесить она не очень большая но показывает большой разрыв между теорией и практикой также история про paxus медлайф это работа от угла где они рассказывали про то а как они вообще делали сервис распределенных блокировок chubby и то есть вот тоже тот же самый разрыв между задумкой и реализацией там очень хорошо расписывается все более что они там сделали что чтобы это все заработало на этом спасибо я готов ответить на ваши вопросы и если что у нас еще будет время в кулуарах если мы не успеем владимир спасибо тебе за доклад и вопросы кто хочет что-то спросить так я подойду первым да пока несут микрофон мне сказали что за лучший вопрос будет подарок да все правильно мы за лучше вопрос подарим книгу так что запоминайте да я буду старательно запоминать вас привет спасибо за доклад у тебя вот в начале был довольно интересный когда у меньшинства участников был уже следующий тур голосования и и забавно как они к этому пришли меня вот мучает такая проблема вот тут аня моя видите гали дима неважно они все знают что они из делегации яндекса и а а вот все знают что они в питьевом пришли можно ли как-нибудь решить проблему консенсуса когда каждый из участников знает что он относится к 1 группе но он не знает сколько вокруг него других и он может только спросить о привет от это уже из яндекса давай вместе голосовать могут ли они при этом формировать свой пластик избежать сплит брейна в общем случае это как раз эквивалентно за индийской проблеме проблем византийского консенсуса потому что тут пока ты не знаешь сколько у тебя человек ты не знаешь сколько тебе нужно к тебе нужно большинство и не можешь использовать методику голосования естественно если у тебя кто угодно в любой момент может подойти то там набрав три голоса ты не можешь понять это вот большинство или не большинство или там еще 20 человек который тоже хотят голосовать на просто не дошли до тебя пальцем за ваш вопрос а во первых привлечение свое время обнаружил что если в алгоритме голосования есть какой-то критерии выбора лучшего голоса но например мы самое большое время выбираем то факса сходится значительно быстрее быстрее значительно стабильный авторы вопросы почему вы не упомянули про алгоритмы которые и стива реакторов пришли ну там гранола так далее на основанные на упорядочивание сообщений да есть еще там семейства алгоритмов на самом деле очень много я упоминал те которые реализуются на практике в распределенных системах эти алгоритмы существуют но я не припомню ни одной реализация которую там можно было бы пощупать руками в продакшене где то есть возможно где-то у кого-то in-house и то есть на в целом не видел ни разу не вопрос глубже в залив а я вот из-за доклада услышал такое ну мне показалось новой явно эмоциональную привязанность скорее крафту потому что он проще и практичнее не можете это не поможет это не так я ошибочно считал это но мне показалось что выглядит будто бы нет какой-то особой практической ценности сегодня пытаться лезть в pax с принтами за до того же клик хауса ну собственно это было видно потому что они убрали рад а так ли это то есть можно ли говорить о том что ровд будущее хоть и теоретически необходимым на самом деле проще фактический и реалистичный в сегодняшних новых реализациях и к подсосу нет смысла пытаться у него лезть сегодня формально лето и лет и лет они прольет я понял да в целом все так потому что показ он действительно в каких ситуациях может работать быстрее но за счет того что случае того когда все идет не так как вы ожидаете и какой-то ситуацию вы не покрыли с патрисом гораздо сложнее разобраться потому что него больше движущихся частей когда у тебя распределенная система и какой-то сложный алгоритм в распределенной системе то о чем больше у тебя движется и частей тем сложнее ловить баги и тем больше вместе тебе может выстрелить вообще в то место куда ты не ожидаешь там уже могло выстрелить то есть поэтому ровд который расписан который очень простой в котором прописаны все тайм-аут и все стандартизировано и он целом лучше подходит для реализации и для практики спасибо за ваш вопрос здравствуйте меня зовут александра зон я хотел бы спросить по поводу количества участников в конце контент как участники же должны договориться о количестве участников которые нужны для принятия решения или о списке этих участников если мы смотрим на реальную жизнь то есть количество динамическое мы хотим добавить какие-то ноды новых участников это список должен обновиться у всех участников соответственно и должен тоже произойти какой-то момент договоренности между ними всеми чтобы не допустить библию сплю брейна как это предусмотрено в целом идея изменять количество голосов которые необходимо для принятия решения в runtime я очень плохая идея сейчас я попытаюсь вспомнить но в целом я что-то не помню вообще у кого-нибудь чтобы это можно было в ран таймере изменяйте вот да там но технически это конечно можно сделать но на практика у вас может развалиться в разных местах поэтому там даже если вы попытаетесь прогнать это через текущей консенсус и договориться что вот теперь нам нужно не 34 голоса то вы можете легко налететь на ситуацию что у вас следующей итерации что-нибудь отвалятся или там в параллельной до нужно гасить весь класс то чтобы добавить дополнительные ноды если вы хотите изменить суммарное количество узлов если вы хотите вывести один ввести другой то если вы гарантируете что тот который вы вы вы вы вывели он не вернется то у вас все хорошо спасибо за доклад а у меня вопрос по второму алгоритма вот когда есть лидер он пропадает происходит перри голосование и лидер возвращается ситуации где все в семье ряд какой-то не потом в ситуации с двумя лидерами приходят простите вас очень плохо слышно ситуации когда есть один лидер и он ходит по сети происходит перри голосование выбирается второй лидер а вот первый леди он возвращается вопрос там все детали гнула и вот получается по лидера вот как система приходит до старый лидер приходит говорит я напоминаю вам что я все еще лидер а другие но дыму говорят что нет у нас уже новый лидер слушай его спасибо большое за заклад я хотел бы сказать что алгоритмы на основе ровд и конечно сводится production активно большинство клуб членов которым они не используют именно модификации этих алгоритмов и у них статьях ссылки если на показ in a raft пусть это очень здорово повлиял с учетом крутится сотни миллиардов долларов в этих сетях все это вроде и в ран тайме количество валидаторов конечно изменяется и может изменяться скачкообразное все это довольно стабильно работает так что все работает да все так я когда рассказывал про проблема взять если генерал я не помню упомянул не упомянул что да действительно в основе византийских алгоритмов полежат of access раб собственно то есть это такая основа база на которой все старается владимир спасибо за доклад они поглощают лошадь или"
}