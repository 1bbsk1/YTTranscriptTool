{
  "video_id": "BJnVWjvU2hk",
  "channel": "HighLoadChannel",
  "title": "Что такое хорошая интеграция / Максим Цепков",
  "views": 1751,
  "duration": 3186,
  "published": "2022-03-21T13:13:02-07:00",
  "text": "начат всех рад видеть работа интеграции есть в любых enterprise проектах и собственно то вот что я буду рассказывать основана на разном моем опыте тут вот проекты старые первые которыми мы занимались там первый проект там еще интервью было распределенная банковская система при том что каналы связи были с модемные практически то есть очень медленные были вот каталог мастер данных здоровой и что интересно его сделали в треть в 2003 году он до сих пор работает с репликация my и там периодически устраивают аудит заказчики и мы нет ничего готового лучшего пока не находится вот ну и там проекты вот в большую банковском январе минти где нам шину интеграции продиктовали снаружи а все подрядчики писали адаптеры разные интеграцию с ней вот и мы могли сравнить нашу не ношу вот ну и множество других проектов и собственно в этом смысле фишка в том что вот грабли на пути интеграции они похожи и не зависят от технических стыков которые менялись много раз в этих проектах они были разные сейчас еще другие современные а грабли одинаковые и более того есть системные причины они вот не то что лежат они вырастают на определенных местах и собственно об этом и доклад такой обобщенный с примерами и так далее и для начала собственно вопрос что такое хороший интеграция него на самом деле не явно отвечают когда эту интеграцию проектируют есть два подхода первый подход можно сформулировать как то что интеграция ну и конечно от сделать но профит системы в другом поэтому делаем быстро из подручных материалов подходящих знакомых но самописных по-разному вот быстро и дешево второй вариант наоборот у нас есть правильные технологии крутые современные там когда-то это было со потом эта шина вот потом это сейчас вот место jing всякий в зависимости от предпочтений вендоров у заказчиков он правильный может быть разный это не важно важно что общее заблуждение будто технология тут решит все из коробки и не надо думать вот это тоже ложное заблуждение вот она самом деле если отвечать на вопрос что такое хорошая интеграция то надо думать про стоимость владения стоимость эксплуатации и вот тут вот основная фишка в чем что в эксплуатации всегда будут инциденты особенно на этапе внедрения и на этапе развития и поэтому нужно во-первых админка чтобы их решать и с ними разбираться во вторых шаблоны программирования устойчивые к ошибкам и потерям при передаче потому что связь рвется транзакции теряются сообщение теряются и так далее и более того они ухитряются потеряться незаметно то есть посылаю щая сторона думает что все хорошо потому что она это послала принимающая сторона думает что все хорошо потому что она этого не получала она не знает что ей послали и так далее и вот хорошая расширяемость соответственно как всегда важно архитектура и дальше которая позволит сделать все это естественно и тут вот есть два варианта исторический первый вариант был передачей вызовов более распространенный эта передача объектов собственно между ними часто выбирают передача объектов замечательно тем что мы можем из обоих системы ежели чё выгрузить объекты их сравнить и найти там все то что потерялась исказилось и так далее потом вручную исправить а вот передача api но при этом нам надо чтобы объектные модели двух систем разных от разных вендоров и так далее друг другу соответствовали это накладные расходы они вот очевидно на этапе первые реализации очень очевидно и мы хотим сделать побыстрее и часто говорим а давайте мы не будем вот заморачиваться объектной моделью давайте у нас будет просто вызов api а что там делает а пену мы внутри сделаем посмотрим и собственно вот тут получается что это проще сделать у нас больше свободы в разных системах но при этом нет соответствия данных и очень сложно или даже невозможно выверка данных а сплошь и рядом бывают ситуации когда то когда ошибкой интеграции проявляется редко блуждающие ошибки иногда вообще не связанные с нами у нас была история ошибку ловили полтора года потому что оказалось что там сложная проблема ворог ли вот с кометами которые иногда падают на это не фиксируется вот и когда это вскрыли оказалось что у оракла табак стоит уже четыре года и обещанное во исправление в будущих версиях вот за эти полтора года там было много данных это испорчена их надо было чинить вот ну собственно в этом вот но с передача объектов тоже есть свои сложности объекты большие поэтому часто передает не объект целиком а их изменения и вот раньше это называлось крут теперь rest api она по сути очень часто используются его с точки зрения идеология тот же самый крут плюс вызовы для массовых операций между объектами наконец если вен sourcing в общем-то это частный случай это способ передачи когда у вас есть подписчики и при этом вообще говоря в зависимости от ментов мы вы можете через иван sourcing делать передача объектов когда события тока изменения объекта вы это приняли как политику а можете делать передачу api когда событие у вас любые как прореагируют тоже любые и то есть и вот это как бы иное измерение хотя часто этого не понимают или считают очевидным вот он у меня и when sorting ивенты это обязательно изменения объектов вот тут вот когда говорите про архитектуру очень важно вот эти вот полагание вскрыть явно произнести и вот второе важное что критерий выбора у нас не просто то реализация по-прежнему устойчивости разбор инцидентов и вот когда об этом думаешь и на выбираешь не всегда простой api а вот передачу объектов и прочее и собственно для простой для простого разбора инцидентов нужна хорошая админка тут дальше у меня будет слайд о том что такое хорошая админка но на самом деле вот опыт многих проектов говорит о том что вот этот чек лист ну если его просто написать он воспринимается как нечто ну навязываемая зачем а давайте сделаем потом у нас mvp пока без этого фишка в том вот и чтобы получить реально хорошую админку с самого начала надо понимать что word реалистичный сценарий ввода в эксплуатацию состоит в том что первый проблема обязательно будут особенно на этапе стартап когда все устаканивается и после старта и тогда сообщение будут теряться пути неверно отрабатываться и эти проблемы будут решать сами разработчики потому что больше некому потому что систему а без этого система там не внедрится вот будет эскалации будет много проблем и только когда и пусть они для себя приду смотрят средства вот минималистично потому что ограничение сроки прочее но вот для себя разработчики если они что-то делают для себя они делают придумывают как это сделать невзирая на ограничение вот там и вот сценарий в том что мы передаем можем передать эти проблемы другим только если средства хороши у вот дарой вид эту тему потому что очень многие разработчики на самом деле вот это когда у нас есть команда разработки есть команда поддержки есть этот неявный предположение разработчиков что инцидент р забирает команда поддержки и только иногда меня зовет и для проектов которые в стабильном состоянии так есть просто вот ну ты же не все время делаешь новые проекты вот внедряя период внедрить небольшой и готовились ты забываешь об этом забываешь вспомнить подумать о решался ну вот вот про этот сценарий и собственно второе этот же сценарий должны знать про руководители проектов как реалистичный потому что под это надо заложить ресурса согласовывать заказчиком говорит что по песне и там говорит что нифига не фига вот эта форма это не mvp смысле это формы она вам ведь и потому что без них у нас риски что она вот встанет мы же не хотим таких рисков и так далее и при этом в общем то если у вас команда не очень опытная тает сценарий надо поддерживать практически через аудит опытных разработчиков экспертизу решений потому что я когда многое смотрю я вот просто вижу я могу накидать сценарии которые люди ну вот команда разработки на самом деле принимает ну да они тоже вспоминают свои кейсы вот и так вот она идет собственно а если теперь обернуться уже на функциональные требования то хорошая админка она не только показывает ошибку но и позволяет с ней разобраться и это вот главное казалось бы очевидно тем не менее вот как я регулярно вижу админке где у вас журнал сообщений каких нибудь там они горят красным и зеленым ну можно красной отфильтровать и дальше вы это как-нибудь служит поддержки с ними разберитесь методами скриптов еще чем то в лучшем случае можно посмотреть сообщение вот но при этом вам вы либо лет вот такой xml неформатированный ну потому что он такой придет еще хорошо если это полное сообщение то есть вы можете скопировать и получить а бывает что там конверт это xml внутри пошел бинарник который чем-то зашифрован и вам надо еще и расшифровать и это же получить xml и так низко раз и все вручную ну блин вот в этом смысле надо посмотреть и это вот не выдуманная штука я вот это встречал слушал боль и сам боролся первый раз боль была как раз в первом проекте 97 года когда вот я выяснил что у оракла так устроена удаленной транзакции есть табличка где лежат ошибки а вот тело транзакции в бинарном виде ты не знаешь что там такое можешь догадываться вот по ошибке ну вот как-то так вот для меня это было урок но не не у всех есть такие уроки вот а так вот надо смотреть сообщение смотрите объекты см от если передаются объект и сравнивать их с тем что есть локально передавать повторно потому что если вы передаете объекты но в конце концов так вы передаете изменения крутая так перри послал его целиком он там принялся у вас все синхронно и это может сделать инженеры разработчику это не нужен ну не надо отрываться и так далее и устойчивость к большому потоку опять же потому что очень часто особенно когда делают mvp вот думают что ну вот давайте мы встанем на первые ошибки мы с ней разберемся пойдем дальше и так далее ну как потом оно пошло впрок потом она встала на первые ошибки в 4 часа ночи и потом у вас 8 утра помимо этой одной ошибки еще большой вагон сообщений которые просто не обработались и ночью и соответственно рабочий день люди не могут начать работу и так далее в общем так что сверка мониторинг настройку уведомление прочее это все как бы очевидно но не очевидно что из этого вам випе тут вот каждый раз вот это вот баланс и разумное решение вот разумное решение это как раз то о чем предыдущий слайд для реалистичного сценарии старта и разбора ошибок которые обязательно случаться вот и да вот предотвращение ночных авралов на внедрение вот вот так теперь про админку всё я надеюсь будут хорошие админки и идем дальше устойчивые шаблоны тут не так чтобы вот опять же это грабли которые лежат стандартный шаблон который все учили при работе с базой данных что у вас есть insert и есть апдейт и когда вы сделали insert вам база данных вернула ключ вы дальше с ним работаете все замечательно и правильно почему потому что у вас транзакции если insert не прошел то его ваше приложение упало после ensure that a пошел rollback и все хорошо когда у вас на 6 без или любой асинхронный место jing транзакций нет поэтому вы послали insert вы не получили ключ и вы не знаете что там вставилась приложи вставилась это запись или не вставилась напечатался чек в налоговой ну ушел чек в налоговую и там принялся вы просто ответ не получили квитанцию потому что упали или связь упала или таки он туда не дошел вот чтобы этого избежать и опять же есть стандартный шаблон другой absurd причем он есть в этих самых в промышленных решениях кассандра так работает я вот когда последний раз его объяснял мне долго-долго разработчики говорили что ты придумываешь курица сложную вещь зачем вот а потом у них вот а я не знал что так в кассандре потом они поняли а говорят то что ты рассказываешь это как в кассандра нам тут кассандру запретили поэтому вот надо вручную написать поняли будем писать вот важно что арест он связан с круто и там нет транзакционных тину вот в обычных описаниях это воспроизводит я не знаю почему так вот но вот факт ну и и это на самом деле частный случай если мы прогну запись говорим и дам патентных операций иди и дым подобные операции следующее что если вы какую-то операцию отправили и вы не знаете результат а то вы можете отправить ее еще раз и она на делается ну сделает все с нуля или до делается вы отправили документ из тысячи строк там она половина обработалось вот вы можете опять отправить документы с 1100 к его c500 который уже есть они не создадутся заново осадок до создастся вот это хорошо работает на вот устойчива к падению агентов которые на принимающей стороне но это надо проектировать на обоих сторонах и тут есть большой нюанс по созданию уникальных идентификаторов чтобы и дамп антенной операции вот absurd работал у вас посылаемый на создание информации должен быть ключ который уникально идентифицирует по которому как раз при повторной посылки принимающая сторона увидит а это уже есть ну и в идеале до делает работу в мини идеальном случае вернет вам объект своим ключом уже существует и вам надо разбираться все равно лучше чем когда мы ключа нет вы проверить не можете и должны работать с этим как вот ну другими способами и ежедневными сверка my еще что то вот в этом смысле я вот упоминал печать чека в налоговую отправка там нет ключа методом патентных операций поэтому ежедневные сверки и геморрой с ними и когда у вас что-то засбоил а покупатель ждет чек а вы должны плюнуть отправь ведь чек еще раз а потом разбираться с возможным за двоение это проблема с другой стороны вот эти самые таможенники тоже казалось бы госструктурах там вот всё хорошо в этом смысле и их протоколу публичный рассчитан на это там ключи на ваш стороне значит соответственно эта штука должна быть устойчива к потерям и дублем сообщений и это надо так проектировать вот собственно и это все если у вас один патент на я операции то вы можете в принципе работать без транзакций это даёт большой плюс потому что распределенной транзакции это зло это взаимный локи это сложные достаточно протоколы которые фиг поддержишь потому что я тут недавно узнал что например вот этот вот транзакции по tp link у ворот ли промышленное решение современной версии а вот с помощью которых вы можете получать дубли мы прорабатывали тему что через них ну передается на теневую копию и в случае которая в случае если мать ну основной сервер упал она может его заменить что в некоторых случаях она оказывается зависает в ситуации требующие ручного разбора поэтому автоматом перри поднять нельзя хотя вот у раков 2 ну да как они пишут в инструкции в документации в том редком случае если это случайно произошло в крайне короткий неудачный момент и так далее вот но вот вот бывает вот и в этом смысле дальше следующая тема это понимание межсистемных взаимодействий опять же тут проблема больше в том что вот проблема кораблей как вот выдан патент операций в absurd их проблема в том что многие ну разработчики и не только разработчики учились по шаблонам обновление базы данных а там insert и апдейт вот два разных шаблона но есть транзакции которые лечат так и тут многие учились вот писать процедуры ну синхронные взаимодействие ты вызвал получил ответ ну да ты ждешь и все хорошо вот но опять же все хорошо если у вас есть план загс и если у вас транзакции нет все это сыпется так хорошо не бывает и в этом смысле дальше вопрос вот а проблемы с производительностью надо идти на синхронные вещи вот с асинхронными вещами все сложнее есть очереди и вот в этих очередях что-то может пропасть приходить долго более того есть вот обычная синхронное когда у вас она однонаправленная например rush степи и сервер не может послать ответ а должен с про ты должен с клиентов спрашивать вот есть реактивный взаимодействия когда ты фактически ну формально ты отправил сообщения с камбэком который вызовется когда сообщение обработается под капотом там очереди в две стороны и вот фишка в том что дальше благодаря современным библиотекам синтаксическому сахару и так далее вот есть посыл типа вы расставьте там где надо a way to sing и у и пишите также при обычном синхронном взаимодействии в процедурах и примеры вот все такие что это просто легкий порог входа вот понятно что потом она это не работает есть много докладов я слушал объясняющих как не работает зачем и вот фишка в том что вот вот эту вот картину когда у вас меж системное взаимодействие со всеми очередями и прочим ее надо рисовать и представлять потому потому что без этого вы не можете адекватно разобрать инциденты которые произошли как раз при нарушении взаимодействия она всегда есть мигнула связь ну вот перри поднялся connection что-то потерялось там потерялась очередь упала агент которая обрабатывает сообщение а там устроено так что диспетчер ну например диспетчер распихивает сообщение быстренько вы chery в очереди конкретным агентом и агент хранит свою очередь они централизованная очередь так бывает тогда он когда пропал он пропал вместе с кусочком очереди которую он хранил вот ну вот вот эти вот побочные ветви надо представлять и проблема опять же системная проблема в том что когда говорится что вот у вас есть amrita singh & и синтаксически все это выглядит как при обычном вызове то вот интеграция падает но это не новая проблема потому что когда-то давно вот эти артерии могут кол тоже была идея что опасно пометьте процедуры ремонт кол вынести на другой сервер и у вас все будет как будто вы на одном сервере на самом деле она подала из базой данных была такая же идея с до былинками вы вынесете таблицы на другой сервер тут и процедуры кусок база данных сделаете синонимы и у вас будет в коде работать так как будто она все на одном сервере ну потом она падает и возникают проблемы один из тяжелых инцидентов который был у нас это в распределенной системе а вот один из серверов масти ну с резервированием через базу данных мастер спин байк мастер начал деградировать по производительности ну недопустимо что там происходило непонятно и ну вот те кто следил за мониторингом приняли решение переключиться на стендбай собственно он для этого и есть там симптомы были так что может быть проблема с железом вот и собственно они на стенд бай переключились при этом потерялась там три минуты последние работы но поскольку это энтерпрайз всех пользователи оповестили что вы проверьте что вы делали за последние 5 минут и переделываете это не проблема проблема оказалась он в том что смежные системы тоже потеряли эти три пять минут и в отличие от пользователей которые могли это дело ну вспомните переделать они-то не могли ну не было предусмотрено вот об этом не сразу вспомнили а потом пришлось вот пологом обмена смотреть что там потерялась вот и вот такие вот вещи а техника она не столь важна она разная вот на самом деле по-прежнему файловый транспорт является хорошей штукой вот при хотя вот он был когда-то давно придуман у нас было опять же примеры вот было репликация сделанная бог весть когда на файловом транспорте с прокачкой по слабым каналам от нее потихоньку отказывались думали уже каналы лучше уже скоро она будет актуальна и тут она оказалась что это а потом в какой-то момент это поднялись технологии и возникла задача передавать в магазин в офисы в магазин и из офисов эти hd рекламные ролики мега тяжелые их сначала попробовали посылать по почте и оказалось что почтовые клиента когда качают много mega batt 100 мегабайт вертеть mind устроено так они забивают весь каналов и остальная обмен не идет вот там сколько-то секунд минут и это много потому что по тому же каналу идут распределенные транзакции другие связи и это не рулится административно но в смысле настройки сети почему-то ну вот начали их снова передавать по файловые штуки которая умела их прокачивать через канал заданной толщины вот messaging шины данных удаленный вызов транспорт поверх б.д. главное что я хочу сказать есть заблуждение что вот этот транспорт он как-то диктуют архитектуру не диктует на любом транспорте можно сделать любую архитектуру и удаленной транзакции распределенный и прочей вопрос в сложности вот в этом смысле тут как со схемой бэда есть логический уровень и физический и они разные и там ну есть ограничения но в принципе есть гибкость и вот тут вот как раз все это дело все взаимодействие есть надо просто представлять как она работает вот ну и последняя устойчивость к расширению она как бы понятно но почему-то опять же она на базовом инфраструктур нам уровне далеко не всегда делается вот совсем недавний проект пример начат было ясно что мы там передается нет при объекты по место джингу со одного сервера на другой сервер и было понятно что будет им веке потом все будет расширяться будут нужны дополнительные атрибуты для бизнес-логики потому что ну как всегда первой версии у вас например заказ имеет один тип а потом появляются их штук пять со своими особенностями там были чеки тоже один тип там появляется с особенностями а вот и как бы это заложили во всяком случае на уровне базы данных во всех табличках были сделаны поля где вот дополнительный атрибут но только основные атрибуты были вынесены отдельно все остальное лежала в джейсон как собственно этот борту но вчера рассказывал вот и все хорошо казалось бы вот ты если у тебя чё то появилась r3 бут ну ты его добавил в протокол и в нужном месте в бизнес-логику вписал его обработку вот а иногда и не вписывал потому что и он тебе нужен вообще для разбора ну комфортного разбора ошибок исключительных ситуаций для логов то есть тебе его надо просто показать вот в этом сам в админке и все ну типа а потом уже может быть написать в алгоритме вот но оказалось что на уровне приема джейсон щиков был выбран была выбрана библиотека которая требует чтобы все атрибуты были в ней перечислены а из благих целей а мало ли что пошлет отправитесь и та же ошибка вот и блин там ни было из коробки возможности указать что принимаю любые атрибуты вернее не так возможность принимай любые а требуют ну нет не делай фатальную ошибку на любых атрибутах было но она их не пропускала дальше ты не мог их ну получить помимо вот структурной информации которая нужна ещё и сходный с джейсон чик со всеми атрибутами она тщательно ненужное убирала вот понятно опять же от чего это ашет защита от ситуации когда вот у тебя атаки с публичного api и там тебя шлют много мегабайтами атрибуты которые все у тебя портят но у нас энтерпрайз у нас нет а ситуацию нас в другой стороне тоже наше приложение вот ну вот так и вот эти задачи не решаются то есть и наверно ей если бы об этом подумали в самом начале то быть может выбрали бы другую библиотеку их много разных но вот не подумали и аналогично еще серьезная штука смена типизация атрибутов вот у нас атрибуты этот пол в системе одежды и обуви ну вот вырос сначала было три значение m же и детский потому что детское а потом детские поделился на подростковой девочки мальчики совсем детский вот и еще на что-то в общем там 17 значений вот а иногда бывает что справочнике тоже растут и так далее причем еще важная штука вот чего делать сплошь и рядом возникает до атрибут добавили в мастер справочник и он используется там в бизнес логики на основной ноги и там все хорошо и думали что больше никто не будет его использовать ну там вот а тут он потребовался например вот как в каталоге товаров дух потребовался во всех магазинах потому что там на него ветвления какое-то потому что в магазинах нарастили функционал там управления размещением товаров ну где-то они только управления товарными остатками в общем нужен и вот прокачать весь каталог заново передать по системе репликации не получается потому что там дофига но он большой она на это не рассчитана когда поднимается новый instance магазин он поднимается сразу с каталогом и ну заполненным вот и вот вот как передать атрибут надо это понятно скрипты но если каждый такой скрипт надо писать трое суток а потом отлаживать потому что он не работает и это выясняется на внедрение то как-то вот плохо это должны быть типовые процессы не обязательно от автомат ну собственно на этом я нади я закончу я могу рассказывать много разного вот но лучше я отвечу на вопросы тут вот рисую некая резюме как раз о том что ошибки будут ошибки разных уровней в том числе массовые из семи надо уметь работайте лучше это захват вот этот вопрос задавать на проектирование если его задает что многие альтернативы выбираются не так и не обязательно другие альтернативы тяжелее в конце концов вот когда ты работаешь с базой данных использовать всегда absurd или использовать insert и апдейт это безразницы вот если в базе данных есть оба оператора вот надо просто вовремя вот понять что надо делать вот и собственно вот нацеленность на том что вы не хотите больших скриптов и ночных авралов позволяет сделать интеграцию лучше независимо от стыка это максим cycles спасибо тебе огромное сусле я заслушался я сплю я вспоминал как я разбирал event лук в свое время в видео но что-то похожее на engine is a он же тоже весь накал б как это и это конечно сумасшествия синхронная супер это мои любимые просто все все синхронно мои любимые ваши вопросы давайте у кого микрофон еще раз руку она и поднимать руки заранее у меня три вопроса первый вопрос расскажите как вы используете до кад и и тех перерывы штаб покатые тех перерывы например приемник лег нам надо все-таки сообщение отправить второй вопрос были опыт использования канала интеграции для вспомогательных технических целей например контроль сертификатов с целью сроков действия значит смотрите вот я тут на таком уровне не готов отвечать в рот а я по вопросам об я думаю что это было то есть вот я сейчас вспоминаю проекта но я уже но вот детали я не помню мне их надо вспоминать они поднимаются по то выбирается извините хорошо у нас есть еще рука и если вы в онлайне нажмите кнопочку справа от трансляции мы вас выпустим в эфир или напишите на ланы там еще раз здравствуйте меня зовут федор дмитрий компания а во первых спасибо за доклад вопрос и сложный простой на самом деле при передаче данных возникает часто проблему что эти данные нужны видоизменить но что-то насытить добавить и это еще одно колено который является ошибкой вопрос где лучше эту процедуры заняться в базе источники в шине данных вы любите получать или начнет ответ такой точно не в шине данных очень важно чтобы на выходе и на вход если у вас шина данных каналов то там данные были одинаковые и вы могли если что их сверить и так далее вот на тему из вот источника или получателя там сложный ответ бывает и так и так потому что вопрос чем их насытить откуда ну там это какая-то дел нормализация обычно и вот в принципе опять же если тут вот какая ситуация она че-то у вас есть некоторые ну на источнике некоторой модель данных там и там лежит например ссылка по ссылке лежать другой объект и вот это вот тоже используется в бизнес логики его атрибуты вот но при этом бизнес-объект он из реплицирует их справочников и в теории должен быть такой же но необязательно или на ту ночь а получатели его нет в общем в этом случае лучше обогащать на источнике потому что вопрос версии объектов в момент обработки он может отличаться поэтому вот лучше на источники и передавать вот ну наверное есть ситуации на получатели тоже кейсы можно подумать чего точно не нужно делать это у нас были вот грабли когда полагаясь на вот в мес но вот на источнике киты вещи являются вычислимыми на лету и чтобы сэкономить на интеграции вместо того чтобы их передать воспроизводит алгоритму на получатели вот дальше алгоритмы как обычно разъезжаются но в смысле они модифицируются и также да спасибо в правой части зала вопрос еще друзья руки ваши поднимайте чтобы мы увидели подойти здравствуй меня зовут филип ппсп бэтмене у меня скорее такой риторический вопрос ведь даже более спорт я не совсем согласен по поводу того что транспорт можно любой для любой архитектуры и был очень хороший пример с почтовым клиентом 2 кейса прямо с почтовым клиентом из моей жизни да тоу я каско на 1 значит клиент начинает слать видяшки для баров через почту почта то есть они начинают расти почту клиента плохое connect означает сбиваться почтовая что делает он берет эту видяшку заново потом все заново значит на следующий день хоть клиенту звонит хостер то есть я да там и говорит извините а у вас то что наш почтовый сервер занимается только вами а еще через день ему приходит счет на 10 лет интернета от правой но есть и второй кейс когда значит и такого много такого я встречал много в своей практике примат десятки когда значит клиент ждет вот эти медяшки у него скрипт скрипт видит видяшки не прошла почту не прошла не доставила он ее еще раз тут она его же почтовом сервере стоит лимитом в 50 мегабайт значит во первых он не видите тяжек во вторых значит он начинает разбираться и во время разборок ему сначала звонит хостеры битвы у вас трафик там на 10 лет хостинга амазона а потом ему звонит провайдер ведь у вас еще там трафик на 50 от интернета примерно так и то есть не совсем выбор любого транспорта для любых целей да я тут полностью согласен но вот что важно любой вид транспорта имеет ограничения там вот на размер сообщений на скорость передачи на вероятность потери и так далее е эти ограничения надо учитывать я тут скорее говорил о том что у многих в мозгах есть связка что если асинхронно то это место джин грабят mq и все и если синхронно там база данных до биллинг и все вот это не так вот вот в это тогда я согласен вот с видюшками с пересылкой вот с почтой вот но при этом вот какие то вещи через почту можно пробовать делать у нас был а про нетривиальные репликации прочее был прототип он не пошел в пруд но как прототип сделать распределенную мастер данные на просто за счет того что мы их положим в jit в каждом месте будет свой репозитарии файлы будут ходить и забираться с агентствами jit тоже как-то великолепный случай еще вопросы друзья поднимите ваши руки а вот я вижу глубине зала you do добрый день меня зовут дмитрий спасибо за доклад хотелось бы задать вопрос посмотрите вы везде употребляете какое-то промежуточное состояние до которые это ну брокер в этом сообщении условно шина например да не является лишена в основном еще одним потенциальным источником который может упасть то есть ну и из за этого может простить и интеграция так у нас только две точки есть потенциального провала да и нас появляется еще 3 проблемное насколько это правда на использование сюда брокеров это первый вопрос строишь насколько оправдана использование шины брокеров в принципе сторонник если есть возможность принцип интеграции напрямую но на самом деле шинам всегда транспорт так или иначе есть шина частный случай транспорта и она может упасть более того шины они иногда еще и сложно устроенные в том смысле что у вас есть собственно транспорт внутри к нему с обоих сторон по включены адаптеры которые иногда написаны ну как независимые агенты на другом стейки потому что xxi ну у вас основное приложение не знаю там база данных и сишарпа вот шина там технологии такие что к ней java хорошо подключается а сишарп не очень вот и вот туда это точки отказа их может быть много вот и вот нужны ли они или не нужны ну вот вы смотрите в этой предпринимай только случае если иностранец системы получателя и отправителя не могут реализовать какой-то драйвер подключения это драйвер уже есть готовым к какому-то решению ну если драйвер уже есть и если есть прямая связь то и замечательно в этом смысле тут на самом деле вот часто шину делают прозрачный но когда вы сделаете там связь через doubling баз данных то как бы у вас транспорта нет на самом деле он и просто его ну не видно но инциденты с ним тоже бывает да и вот следующий вопрос механизм отслеживания изменений же озвучивали подскажите пожалуйста как бы вы реализовали самый базовый механизм отслеживание изменений каким образом отслеживание изменений где объектах вот данные могут быть дома системе скучно и я понимаю значит и это вот как раз та же вопрос но технологии используемых фреймворков то есть умею я знаю и у нас были решения и ситуации когда это возлагалась на базу данных вообще на триггеры и в ситуации когда это возлагалась на вот хранимые процедуры базе данных или садилась тоже был 1 китай в итоге то есть ситуация что включался механизм база данных этих самых арчи флагов для таблица демоны их читал там тут были доклады тоже на эту тему уже на современных платформах на разных и были ситуации с другой станок да это возлагалась на сервер предложение на а р м и тоже могло быть по разному потому что сервер приложений тоже есть верхнюю уровневая конструкции мы договаривались ну любое изменение объекта должно лагера ваться и где вы вписываете там вы можете вписать и что-то еще либо вы можете писать так аллаха и по посадить хук на запись лога и там писать или через аспект на и программирование примешать и это в общем то разные проекты разные команды разные стейки групп разные вещи я тут не имею предпочтений я понял и соответственно вопрос связан и это правильно ли на ваш взгляд хранить все изменения данных на системе получателя с историей начата правильно ли хранит на системе получателей с историей скажем так ну тоже зависит от ситуации для разбора проблем ошибок очень важно очень удобно как данной системе получателя есть изменение с историей потому что ты видишь ну у тебя бизнес логика сработала не ожидаемым образом но ты видишь и прилетела от этого это самое сделал новую фичу какую-то или ну просто прилетел инцидент что вот она вот тут атрибута такие мы их там вчера по меня позавчера поменяли а нам приходится как будто мы не поменяли а ты видишь что там по репликации она доходила дошло только вчера к полудню а действие было сделано вчера утром и так далее и вот если это видно если можно сравнить то это хорошо и вот удобно это рождает проблемы связанные с тем что ты расходуешь место на системе получатели что вот эту историю надо чистить есть альтернативная штука когда ты ухитряешься ну прошлое состояние объектов можно хранить версии а можно на лету восстановить из лука вот то есть ну вот но поскольку это разбор инцидентов но когда и злоба в тот и завязано опять же на то что логе есть и и что процедуры выполнение эти логов конкрет корректно отработает в общем вот в этом смысле я при предпола поскольку ошибки всегда есть я предпочитаю закладывать избыточность а потом по мере стабилизации предложения и и выпиливать но это не всегда возможно seba спасибо огромное"
}