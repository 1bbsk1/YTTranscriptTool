{
  "video_id": "E8sEITa5Qtk",
  "channel": "HighLoadChannel",
  "title": "QUIC illustrated / Александр Крижановский (Tempesta Technologies)",
  "views": 1645,
  "duration": 3211,
  "published": "2019-05-14T14:54:36-07:00",
  "text": "я начну издалека собственного сначала скажу о том кто мы такие общие чем занимаемся мы занимаемся заказал разработка вот уже примерно 10 лет занимаемся разными сложными штуковинами в основном это высокопроизводительные силы приложение система хранения но в частности мы сделали продукт для компании но фактически подключай выпусти его первым версию и этот продукт был упомянут гарднером и мы еще кантри beauty мария тебе в частности для здесь три мы сделали одну из имиджевым feces вот кроме того что мы выработаем деньги на заказал разработки мы занимаемся еще сработка собственного продукта тем тестов w это а при конечно деревья контролю собственно поскольку при кашле контролируется то в конечном итоге htp axe регаты собственно мы занимаемся и htp соответствия нас интересно спасибо для нас соответственно интересен вот о чем пестум соответственно до нас очень интересен был quick дубовый инициатива и но мы вообще очень долго были довольно скептически и как фиг у нас даже есть вот задача который здесь на ссылки и мы собственно че с того что в общем зачем это нужно и ткать непонятная штуковина у нас как бы и так все хорошо когда одел презентация постарался все-таки найти максимально чем он всё-таки хороший что он может давать нам в общем не так все однозначно собственного в интернете очень много докладов по к пику презентация статей от гугла есть статьи есть ганя статья на 14 года о том как он вообще спроектирован что в него входит и очень много статья того же гугла и фасции сидя на том что насколько он быстро насколько хорошее так далее в этом докладе а больше расскажу ну попытаюсь показать вообще как вы отлаживать как как с ним работать как можно как как вообще в нем и забраться изучить его для того чтобы вовсе носит свой проект и с вам это нужно ну и соответственно как бы до куат маленький стандарт к небольшой это сейчас даже не один вовсе готовится там порядка 10 может быть 15 документов достаточно объемных описывающих quick вообще quick это очень большой протокол который там нет ни один охватывает целый стек в протоколов и попозже расскажу ну в в опек почему вообще для нас будет интересен quick и почему он вообще важно сейчас в принципе цифры сейчас по интернету не такие большие даты всеми процентов интернет кафе к в основном он весь принадлежит гуглу у гугла порядка тридцати пяти процентов севе лов работают на квики но есть сейчас интеграция у quik-а и the phase two и собственно фас ли это седин который в частности работает над стандартам фаз и google наверное одни из самых активных кантри битов в стандарты мазилу еще amazon уже интервью к себе quick 25 технолоджис это apple уайт спит все у него есть открытая версия она не имеет века закрыта уже имеет quick и есть еще целый ряд компании который интегрирует себе quick частности для меня послужило некоторых такой точкой что вот quick скорее всего к нам придет когда выяснилось что mellanox встраивает в свои карточки оптимизацию египет для того чтобы работать на крики то есть целом софт писать это очень долго менять железо это вообще очень долго если производить и оборудование уже идут на то чтобы делать что-то с этим потоком значное но он будет иметь местом далее проблема с крюком и изначально когда он только по ней проэкте вас этого 13 и 14 год тогда было сразу очевидно проблема с миду боксами это некоторые девайсы может быть ваши домашние гаутаму же быть какие-то его вашего провайдера который вот пропускают ваш трафик и в целом они считают что и теперь это некоторый такой вторичный протокол которые часто режет как с котом в общем плохо обращаются и поэтому quick часто блокируют частности вот на последнем на деве летом фаз и и google рассказывай по то что но в целом миду боксу все по-прежнему плохо поскольку quick очень быстро меняется миду бокса считаю что должны быть определенные поля в к реке по ним фильтрует a quick уже изменился и поэтому по попадают под блокировку и так далее как dice и но сейчас с активным изменяется и самые как бы асаны поинты в крике но для меня самой важно был point это в том что квик это некоторое агрегация http cs и цепи и по сути вот каждый из этих уровней он знает о друг друге то есть это некоторых такой кубов больше у нас нет вот и логично х 7 уровней а для максимальной производительности все уйду к друга знают принципе это близко к тому что мы делаем в темпи есть мы тоже в твоя весь папе стек мы там кажется каждой цепи пакет зная то тело и seo паштет и так далее то есть намного ты-то близком второе это то что он поверх и дипика проектируется как замены the happy в целом поверх него можно другие потапова гонять ну вообще да за базу для шкип 2 ну и за решалась проблема head of one black in и отсутствие round trip а в хан шейках в текущем состоянии вообще как бы стандарта очень своей даже те способ вот эти вот бумажки так страшны погребы там будет очень много слов tbd тоби дискос очень много пометок редакции вот это удалить вот это у нас неправильно и так далее но и соответственно же вот сегодня мы насадок увидим что в целом вот хам и всегда шьют одно в создать как говорится другой . очень сильно меняется у нас есть несколько серверных реализации по все видим енот сивилла которые можно поставить и там у вас будет quick жить клиент узких baby attack есть несколько но вот именно вот такого продукта который вот прям вот можно поиграться и тут видимо только один хлам ну его шаг умеет работать с криком давайте посмотрим на проблем которые решает quick прежде всего это хэдов line black ну как бы за всю историю человечества мы боролись с этим проблемы она у нас сквозных поставь их было прежде всего аж типичных еда fine black and заключается в том что у нас например вот клиент отправляет 3 запросы они pipe они цена сервер все хорошо но вот первый запрос у нас почему-то долги о друге они все быстрые соответств все два других запасы будут ждать пока первую нас не пойдет и вот первый сам медленный запас он блокирует все последующие запросы это не здорово ты сейчас вы шьете tomcat запросы на быструю статику вас там медленная динамика баз данных the bat это у вас все грузит создает пока у вас база данных не отработает это плохо соответственно в htp 11 нас было много техник матка выигрывали много sp соединением мы делали дамы из причин когда сайт располагали на разных доменов чтобы гаузы указом доменом открывали большое количество соединений в общем разные техники и ваш теперь два вели стримы в виде фильма которые позволяют в одном типе соединение сразу гнать много фильмов для каждого аж тебе запросы у нас они могут вмешаться и по сути получается эффект аптекой нескольких степи соединением ну это мы пришли на уровнях теперь и пришли к той же сам проблемы на уровне цепи уходит несколько пакетов внутри кондишен window какой-то из них он попадает первый у нас опять же все становится например над с мы уже не можем поднять потому что мы должны создать полностью построить наш стрим соответственно опять же если у нас теряется себе сегмент это аж теперь два у нас мы ничего не получаем никакого хэмминга у нас не получается ну и quick соответственно решает эту проблему тем что вводит фэй мы ее стримы уже на уровень цепи на видео и теперь у нас вы как бы не будет ходу фламинго king ну прежде всего мы вспоминаем что у нас есть по такой сети пика то у нас уже больше десяти лет он уже реализовано в библиотеках и за space в ядре уже было много research по поводу реализации аж теперь поверх степи и в принципе с ним немного получают там производительности указать почему бы его не использовать есть бумажка достаточно ставлю от гугла пап почему вы собственно детей вас не используется и ctp ну их пытались адаптировать но во первых они все-таки зарабатывались немного не для того чтобы именно побороть проблему долгих задержек и помогать именно сделать именно быстрых хан шейки и во-вторых собственно изменяйтесь и т.п. или детей в с тоже не очень удобно потому что опять же есть миду бокса которые нам если они знают наши степи то вот мы поменяем и как бы они перестанут работать у нас все встанет поэтому в гугле решили что мы возьмем gdp которые видео по пускают и мы возбудим газ уже с филиппин следующий вопрос собственно у нас есть осипов особым тоже достаточно старая техника и у нас есть с 13 вот в частности вот мы в своей задачи описывали что в принципе мы все тоже там получаем сцепив востоку нам дала дает делают эти юнцы тела с 13 тоже дает сделайте тихо шейкой мы по идее должны быть счастливым как выхода фланга кинг вообще-то говоря решается ну моему мы уже умеем решать в помощи большого количества спи connection of key пылает в connection of и так далее в принципе как непонятно зачем это нужно вот если посмотреть на то что из себя представляет стив особ и мы увидим что вот все на картинку слева это у нас первый хан шейк на картинг спал уже установление соединения без хорошей к то есть что там делать там добавляется сыпем опциях который представляет собой куку эта cука это просто зашифрованный зашифрованный айпи адрес клиента приватным ключом сервера то есть это нужно для того чтобы потом когда всех клиент запомнит эту куклу и пойдет к нам на сервер мы будем знать что это не спасен голый запас что это не томсен food о том что если ну вот у нас тот же самый api адреса он зашел в нашим ключевым соответственно мы можем мы знаем что это клиент уже с нами работал от того же самого перец мы можем пропустить окно лишь упустить это все на прикладной уровень данные а потом уже подтвердить данные есин клиента одним пакетом и потом когда-то получить окно домен который после выкинем по сути вот а анка проблем какие здесь нового первых поскольку мы им данные добавляем в первый пакет теперь вместе сином ну у нас цепи фасовка но он должен быть совместим с обычной цепи из у нас реализации не умеет этого расширения до работы с ним то тогда ну по спо игнорирует опцию соответственно мы можем данные только добавить в первый сегмент а эти данные принципы могут быть достаточно большие то там поттера килобайта то что в mass с нам помещается в в ethernet фильм второй это то что у нас по прежнему остается ходов while making и последнее проблема в том что вот в нормальном типе если к нам приходит два сына 2 пакеты данных у нас есть окно лежи менты и мы можем выкинуть выкинуть дубликат и все же мы не можем нам приходит сын будет разные порядковые номера будут данные мы не понимаем то есть это пришло два запроса от клиента после последовательные ли это дубликат и мы в принципе можем это сделать и здесь говорится что по сути мы уже имеем эту проблему что клиенты в своих глазах они жмут кнопку refresh и по сути мы тоже там получаем то есть вот у нас что то затормозила нам клиент снова персонал соединен отправляют новый запас и принцип мы приходим к той же самой ситуации и любые веб-сервисы до которых важны не еда подобные запросы должны с этим бороться с патентами запасы мы можем просто передать два ответа ничего страшного вот соответственно в принципе разобрались почему текущие технологии не очень хороши давайте посмотрим что из себя представляет quick fix собственно эту вот агрегация тел с а сейчас последней версии к века остается надеяться 13 стоит этот поверх ю д п и некоторые части от ешьте переехали на уровень как а поскольку у нас уже есть флеминг у нас уже есть три мы-то нам не нужно аналогичная функциональность и ваш т.п. по поводу компрессе она тоже сейчас пришла на уровень quik-а я расскажу чуть позже почему первое что это по тела с 13 собственно вот два стандарта я даже по презентации буду указывать стандарты карту в которых описаны те или иные топики ну собственно вот в одном из них говорится о том что тело с и quick они взаимосвязаны в частности сам quick решает с помощью криптографии проблему авторизации что это вот там не fucking что у нас тут решают подобным механизмом когти пифа стопы на унификацию клиенты что это у нас не просто так идет spoofing клиенту с нами уже общался ну и дятел с соответственно использует транспорт для того чтобы быстрее выполнять свои хан шейки проблема в час в частности еще одна подъем которые решают quick это динамические рекорды то есть есть такая проблема что тело и стрекот ну вот наш текущий он заставляет там максимально 16 килобайт кондишен window ну вот у нас м с цепи это порядка полу таки лабой то есть у нас в одним в одном теле среди может быть его порядка 10000 и сегментов помещаться и кондишен windows pe не обязательно будет 10 пакетов он может быть меньше то есть мы вас сформировали на прикладном уровне большое тело из рек а дальше опускаем его в 2 объем на цепи сегменты и отдаем в сеть но у нас может так получиться что у нас вот только 8 на 3 месте сегментов уходят остальные два стоят ждут отец устроен так что у него есть теги дверью в которых хранится в аутентификационные данные по поводу того что то там вот как раз хранится подпись клиента о том что данные целостные том что подписаны этим клиентом и так далее соответственно делась не может приступить к дешифрации тела с рек ада до того как получил полностью полной реку и пока у нас вот не пойдет полным все отсека туда-обратно соответственно мы один и тот и будем точно ждать у нас будет задержка в decryption ним это плохо соответственно прогрессивный htpc вина вводит такие так называемый тевес динамика records можно даже загуглить они в принципе есть большинстве веб-серверов суть их заключается в том что когда у нас только начинается соединение по новому цепи соединению мы формируем тела с реку ты поменьше чтобы они точно у нас поместились в конце шин window но проблема в том что на прикладном уровне мы не знаем какой у нас все так angels in window в ядре соответственно просто как-то наобум это вставляем и все в quik это не так у нас делась рекорд 13 точно попадают в пакет века и он всегда в одной египет это гамме уйдет в сеть соответствует проблема нету чтобы поиграться нам с крюком нам достаточно просто иметь хлам достаточно новый вот меня аж по моим 63 не за работу соответственно по новее сейчас последние семьдесят в нем уже все хорошо соответствие мы выпускаем собственник века мы включаем ожог к векам вова конфигурации мы можем запустить типе дам крик у нас по дефолту работы на час и сорок третьем пока сок третьем порту и т.п. и мы можем кроме того что тебе дам вам записать трафик мы еще можем в самом храме попросить его заводили все сессии он нам в джейсоне напишет всю нашу сессию давайте это сделаем еще что мы можем сделать вот если мы зайдем на в google.com мы можем посмотреть вот на вкладку quick и там увидеть вот внизу все текущие quick сессии сколько по нему было передано пакетов сколько там стримов но и connection айди по collection eau de сейчас попозже поговорим собственно давай давайте это сделаем вот запустили мы цепи данг я вместо того чтобы идти на в google.com потому что он будет много запросов я взял одну маленькую картинку и и загрузил и я увидел там что никакого у меня и repined у меня идет обычный happy easter этом аяте идет только в конце и вообще говорю очень очень поздно уже после вся эта картинка уже после всего там немножко египет совсем идет вот и все зашифровано в общем ничего не понятно соответственно мы можем пойти посмотреть митинги серверов вот есть еще одна вкладка полезное в хламе это alt svc то можно понять что вот просто как у меня вот это все повернулось у меня появляется такая запись и когда у меня есть такая запись альтис вается это значит что у меня сейчас пойдет все по клику у меня будет не будет сипим и сделаем еще повторный запрос и теперь у нас все уже идет по идите все хорошо давайте посмотрим теперь ну собственно мы записали наш джейсон всю нашу сессию давайте посмотрим посмотрим на тот запрос в лицо не можно будет найти htp 2 запрос и у него мы увидим такой еды альтис vc он описан нас в обсе он описан нас вот в новом готовящемся 100 дать уже до крика и собственно если вы все описано после сам федор то вэном создать описывается его содержимое она тоже постоянно меняется два важных параметра здесь эта точка : 43 ты на каком порту у нас работает quick и к какой версии quick у нас работает соответственно что у нас произошло мы мы обратились к нашему ресурсу наш картинки по https обычно htp с chrome не пытается сразу пойти по новому этапу он идет поставим по таковым сева вместе с картинка дает ему аж теперь хедер что у меня есть quick и запасе у меня по клику пауза добавляют запись себе и в следующий раз уже пойдет по и т.п. и для проверки того что у нас все хорошо у нас как раз происходит тот видите ханши которым мы видели во время первой сессии теперь давайте по вам обратную ситуацию из у нас кто-то отфильтровал наш youtube и вот я добавил по его на своем компьютере и 5 босс заблокировать эпический сок 3 порт и у меня снова все за работу по цепи потом я сниму 5 bulls павел у меня все vines на этапе то есть эта штука она гибкая она хорошо работает в крике есть два главных типом заголовков это длинные заголовки колодки заголовки бедность заголовки используются для хорьков для восстановления для обмена информацией изначально короткий заголовки это непосредственно для афганского данных есть еще под типы но есть вершин не детей шин это когда к нам клиент приходит с какой-то новый версии кряка который мы не умеем мы ему же отправляем специально заголовок которые уже на уровне заголовком говорит что у нас вот какая-то другая версия но есть изначальный хан шейки так далее заголовки но они под мышцу длина заголовка собственно один из голов и выглядит так вот type 7 битные вон как ас описывают каково это типа заголовок там хан шеек обычный дальше у нас идет версии 32 битная у нас идет 24 битных поля длины connection а это новая опция акция и дальше идет сами connection и дефекации длина пакета ну и по номер пакета номер пакеты можно читать не этом при движении аналоги sequins нам бы в чем собственно версии с 0 то у нас мы мы ждем списком по collection 1 собственно что это такое для чего это нужно почему нам не хватает пост нашего и египет 443 багдада с адресом и портов и дипика к нам всегда этого хватало в цепи во всех физиков и таков дело в том что квитко заботу со для того чтобы он был в опек живучим и походил через мидл боксы с нами до бокс у нас стоит над который нам меня твоего вот сейчас у нас он красиво адрес в один потом он устарел ascension перед консервов соответственно все время будет меняться адреса поэтому если у нас до целого адреса дошел наш creed пакет тапу connection айди он восстановится то есть папа ты у нас могут меняться благодаря наших миду боксом но что мы от этого еще хорошо получились что вы горя collection айди у нас сейчас сессии например шла на один компьютер потом нас например как педагог он пришел на другой на другой пи адрес и там нас фотосессия поднимется то есть мы можем пабло совать соединение здесь и это было совершенно не тривиально то есть были решения там тех же фаустов у которого позволяли мигрировать себе соединение с одной машины другое крики это вообще пост у нас как бы все автоматом поднимется благодаря collection 1 ну и соответственно нас есть поддержка мульти homing здесь формат короткого худого он спас один collection eau de то есть начальном от нас был наш collection айтик на котором мы ожидаем данные от точки и connection айди которым мы присылаем той точки здесь вот только мы указываем конечно один которым мы отправляем данные дальше у нас здесь вот в поле type указаны некоторые биты которые вообще говоря вот в моем случае то что я почистил на своем к вике они вообще другие ну и в шок лидере старший 0 старший бит равен нулю схватили первый пакет это первый пакет сразу зацепить сессии по крику и давайте посмотрим что у него будет во первых убираем сразу айпи и и теперь синий и оранжевый байт и дальше видим первый байт это ноль значит у нас по идее здесь должен быть короткие пакет дальше у нас идет де там пакет какие-то флаги который я не нашел подходящего стандарты по ним но это вот реализации криком в хаме дальше у нас есть шестнадцатеричный дефек а то connection а который соответствует у нас нет там десятичному числу вот этому начинающийся с 89 и дальше идет номер к века сорок третьем и дальше мы видим попадос и новелла это так называемые теги к века по которым он обменивается в конфете своими параметрами в частности сначала нас идет причисления тредов какие у нас есть теги в каком порядке потом у нас идет заполнение достаточно объемная байтами 2d и потом уже значение самих тегов первый пакет в крике у нас обязан быть не меньше тысячи 200 байт сделано для защиты ну блокада по двум причинам для защиты adidas так тип амплификация и для анализа mtf сети по тедас попозже расскажу поехали дальше вот если мы пойдем на вкладку quick в хаме мы увидим как раз вот это наш вот слева серым выделен наш номер десятичный сессии он не печатаются стиле чем 50 десятичным но мы видим что это наша сессия и дальше в ком к это собственно коэн хром пакеты у него есть вот набор тегов вот не то чтобы нас интересовал конкретно так исчез на скорее интересует вообще класс этих тегов в тегов там достаточно много несколько десятков разные опять же они сильно меняются от редакции кредо акции но там интересно что прям в протоколе quick его хан шейки в его хедере уже идут криптографическая keychain шейк который указывает о том какой у нас кингфиш какие у нас стефи коты какой у нас скрипт алгоритм и так далее здесь взята картинка из дании статьи гугла по реализации собственно сначала это обычный хан шейк мы сделаем изначальные гуанхуа типа такого который мы сейчас видели потом у нас идет серый на ответ который дальше глоба тут ключами материал там включаем диффи-хеллмана и так далее и потом уже у нас идут данные когда у нас идет zeon хотите их анджей кто тогда у нас уже сразу вместе с изначальным запросам идут данные давайте на него более подробно посмотрим собственно так он выглядит то что зашифровано то что подсвечена синим окрасом это шифрованные данные апликэйшен дата разумеется тоже шихова на но сначала синим шифруется это то что нас остался ключевой материал с предыдущей сессии но поскольку нас должна быть perfect for вот secrecy то есть как бы ключи все время должна обновляться вот мы минимум данных отвали с первым хан шейком дальше мы перерабатываем ключевым материалы дальше уже данные шифруются новым ключом уже пошел к сна криптография пост рим и собственно как badass одна из основных идей в крике во первых это никто abs акция сообщения то есть это не abs oxo collection абстракция сообщения в крике стрим создать это очень дешево контекста очень дешевый соответственно каждый стрим это пока ответа запас который мочиться ваш т.п. мы потеряем еще кроме того что нас данный передает пас римом весь еще контрольные стресс 3 мы в частность по контрольным стримом у нас идет согласование хан шейков у нас идет согласование компрессии так далее пакет каждый каждый египет датаграммы может содержать несколько quick пакетов каждый клип пакет содержит несколько фильмов отвязных стримов но может и по одному содержать и еще у нас к реке в отличие от того же цепи у нас кременной длинные интервью то есть мы можем кодировать длинные int и нам на габаритные у совсем короткие используем ну как бы старшие биты для того чтобы закодировать сколько у нас длина текущего интан здесь показана ходу стримов и им соответственно тип стрима длина фильма ефима и под фильмом можно немножко немножко смочить жизнью себе стрима себе connections quick stream он вот есть и диаграмма она сильно сильно проще чем tcp стоит машина собственном и в нормальном состоянии мы отправляем данные получаем отсека и как бы все на закончилось вот если у нас пришел в гости на знать все отвалилась и у можно немножко смочить west с триумфом стс было соединение можем закрыть текущие стрим тем что у нас вообще при конечно закрылся либо connection закрылся у нас есть пинг bfm и то есть вот все что вот вот этим курсивом выделены это отдельный типа фильмов отдельного отдельных стримов контрольных мы можем сказать что у нас вот есть нам приходит другая точка на заваливает данными мы ее можем отдать фильм vogt или стрим бог-то и сказать о том что либо мы вообще не хотела тебе ничего не предпринимать либо о том что только вот этот стрим он уже полон а по другим с ремонт и можешь дальше писать данные пример стрима но опять же нас возможности ограничены поскольку у нас все за закрепленного тела с 13 соответственно что мы видим ну-ка опять же htp эти степи 2 1 то что хлам нам показывает вот у нас есть такой htp запросу нас есть quick приоритету стримов о том какие мы раньше обл аббатом какие позже quick stream айди уже 5 хотя это только первый запрос это у нас уже 4 пошло стрима 3 перед нами которые были контрольными и дальше мы покоем это все в фильм фильм по койку им в пакет и отправляем пакет маленький но и квт спидом в тесной что мы видим при анализе снесем это только connections крики остальное у нас все закрыто то есть в отличие от ccp quick это только один индификатор can экшеном но еще вот теги на самом раннем этапе установки соединения по компрессии у нас в htp 2 есть оч пак это код хаффмана которые указывают что у нас вот есть текстовые данные аж теперь заголовки мы их есть статические данные которые часто частые заголовки есть к динамическим их к делу некоторые чисел коми в степи это все внутри одного стрима происходит в кепке мы работаем с многим стримах поэтому нам хочется глобально вы выпытать глобальную таблицу для всего нашего соединяем поэтому крик водит отдельные стрим по нему и согласовывается обновляется вот эта таблица куб окно внутри себя ты пока такой же чпок который просто работает на глобальном уровне по всем стримом которые подают передаются мы дошли до алгоритмов quick a quick определяет на самом деле нам вообще quick разрабатывался по текущему состоянию 5 стека ядра linux там есть весь джентльменский набор у него есть результат сми тайм-аут и если у нас ушел пакет не приходит окно лишь момент мы при переписываем его по recieve тайм-аута есть phase 3 transmit вас редко смит знаете что если мы отправляем например 10 пакетов и мы понимаем что сеть может преодолеть наши например три наших пакетов последовательно мы отправили 10 пакетов например мы получаем отсека на 4 пакета первые три мы не получаем соответственно понимаю что первые три они даже если триоды реста уже как бы мы превысили наш предел ринга мы переписываем первые три пакета или transmit значит что если мы в конце наших 10 пакетов уже и не получаем окно элемент то по очень маленькому таймауту мы переписываем последний пакет есть еще suck & fast окно элемент рекавери и есть цепи ты ос проб и т.п. вот давайте на них это все сейчас посмотрим собственно мой здесь а сева посылаем 10 пакетов последние теряются приходится цикла на 5 а с последними не понятно то ли они как бы еще вот в процессе то есть вот у нас папаша утечь ride on some time out но потом вот мы он нас истек мы отправляем 10 пакет клиенту и нам приходит selective плазмид ну как бы по стандарту поставлю стандарт спинам приходит подтверждение 5 но у нас есть еще расширение в цепи что мы можем еще тыс его и опциях если у нас all the fold пришли пакет это мы еще можем 3 с дырками подтвердить это селектив окно и jammed у нас приходит актив ag ночь бы на 10 пакета здесь мы понимаем у нас срабатывает наш мы это называется повод а кто ж меня ты мы вот понимаю что у нас потеряюсь пакеты мы быстренько все отправляем вот вот эти механизмы они все есть в к реке в крике они проще чем в цепи в частности в цепи у нас поскольку всего места хватает на 3 директив окно ли джи мин то у нас может так получиться что друг у нас образовалось много и мы их все не можем передать клиенту соответственно мы передаем только некоторые из них а другие теряются получается что вот сейчас мы поучились реактив окно тебе на 10 пакетов сейчас мы и не получили и цепи поскольку он все равно переписывают данный он предпочтет и до 10 пакета в крике это запрещено у нас специально есть окно люмен фреймы который делаю несут полный список уже всех потерянных пакетов соответственно реализации проще как бы ну и она как бы работает лучше так же как в тисе пи им требуется что отсека должны отправляться не сразу а подождать немножко попутных данных вместе с данными от по они должны подождать немножко может быть нам еще данные придут и мы можем тогда окно сегмент более поздние вызвать ну еще во важный point что у нас quik-а отслеживает потери на уровне пакета в который несет себе фильмы то есть например вот мы видели у нас пакет там сойди например десятым он потерялся в нем в указанные файлы лежат соответствие мы не переписываем пакет 10 мы пересылаем пакет 11 у нас все время изменяются номера пакетов но внутри у нас будут лежать фреймы и также как тыс и первое тифом будет нести в себе сеты и длинные в тех сегментов которые у нас потерянным есть x принцип кондишен notification собственного интеграция сайты уровнем когда у нас миду боксы . прием может инфицировать о том что нас кондишен произошел можно в блогах на them for the correction а крики сейчас его нету то есть раньше поселилась и даже на закипеть было написано что quit посылают больше данных чем нужно сейчас это уже не так единственное где живет этот в мульте кости к века поскольку quick у нас и типичное соответствием и нас нет ограничений . перекупил у нас мы можем прям откосить и мультика сеть наши пакеты и соответственно если мы вызываем в группу quick сообщения то а цикла нам не очень хочется от этого получать им по это как нам с ним жить то есть нас на получим перед пенную связь соответственно цикла у нас в этом протоколе нет и вот там вот иди сам где мы задействуем вот этот дополнительный передачи данных что вот есть мы попали мы передали дополнительные данные нам хватило то все окей если нет значит нет все потерялась хами ум это монстр он огромный он умеет абсолютно все опять же он писать по текущему ядро linux у него есть куча confession гонта алгоритмов bio кубик pr не помню как называется это более более медленный более умный откат при возникновении контур есть слов старт стандарт требует только базовые реализации не уже на само по простой и медленного стал это требуется пакет песен пакет песен как то что мы имеем в линуксе уже давно спиц фокус это делает и делает один опция прессинга собственно для того чтобы мы не за отапливали миду бокса не за отапливали приемник мы отправляем пакеты с небольшими небольшими группами и с некоторой задержкой либо по часу пакетов либо почву по времени вот из у нас есть ограничение есть фильма которые позволяют нам сказать о том что вот у нас сколько мы данных можем передать поэтому стриму и либо по всему connection ну вот мы уже почти добавить до конца по безопасно то что мы видели что квик это просто connection нам вообще ничего не видно на миду боксе соответственно вот на уровне повода там уже нельзя взять какой-то умный тома были бы five там написать какие-то алгоритмы хитроумны которые будут смотреть на цепи к какой-то стресс и содержать и так далее здесь все площади что мы можем делать это т.к. текло и тыкать collection айди но в целом в общем да открывается достаточно хорошая возможность для того чтобы и досить точки амплификации adidas это то что для чего у нас есть ограничение на размер пакета собственно вот суть в том заключается в видосов что атакующий шьет небольшие какие-нибудь запасы на некоторые сливалась вода отвечают огромными ответами вот эти вот это по сути вот такой потому то есть у нас кван хо вода сасси маленький в ответе у нас приходит сертификата сервера и вообще как бы там много всего там кичеджи так далее соответственных много для того чтобы вот этот трафик уравновесить мы кончаем как as 1200 бат для того чтобы более-менее был был симметричным график в обе стороны еще одна проблема в том что квик по природе по своей он уязвим к исчерпанию ресурсов то есть вот того что мы у нас очень дешевые стримы но стримы все она требует некоторого контур блока мы их можем создавать очень много мы можем не высылать и цикл и заставлять другую . накапливать эти данные то есть у нас и она нету вот так автоматическим механизмом как-то себе окон по поэтому реализации могут очень легко и щипать всю память и в стандарте в драфте рекомендуется как раз делать эти ограничения тем не менее если вы посмотреть на треть и снизу point если нас сейчас есть эти одного сервера приложения например потоковая то окей у нас есть библиотека quik-а все соединения живут вместе и библиотека quik-а может внутри себя смотреть сколько у нее памяти расходуются сколько она а то жировая сколько у нее есть если у нас работать несколько процессов изолированных по памяти то уже каждый процесс не знаю сколько памятью используя соответственно очень легко выжигать эту память и тяжело контролировать если мы запускаем глазные приложение с мы представим что на скрип какой-то момент станет вообще как бы полный замены цепи ваш типе у нас есть базы у нас есть какие-то жениш типичные все используют свои ограничения на стримы и в общем мы легко после открывая много приложение щипач и память на компьютере соответственно это один из поинтов почему неплохо бы контролировать память налобник еду а также как у нас есть ccp мем искатель который задает ограничение цепи памяти по всей системы не зависит от того сколько в ней connection of далее у нас есть проблема того что в статье гугла говорится о том что вообще говоря quick почти всегда быстрее цепи но иногда и очень час мы видим что считаю у нас выжигаются больше чем на цепи уже в принципе понятно потому что у нас очень много идет в use space у нас какой-либо и сервисный пакет который у нас остается в ядре и быстро отличается без копию ней без контекст свечей в какие-то все идет виза space там идет криптографии идет к пинка тех свечи поэтому как бы тоже не очень здорово это иметь визу спейси следующая проблема снизу вверх это проблема с инфой который решена в кете с недавно проблема достаточно просто если у вас есть что-то крипто wanna у вас сейчас все криптон и если вы хотите передать большой файл the page типе вы его сначала читайте из ведра с диска в память процесса копируйте с дисков память там crypt уйти обычно я тоже значит еще одну копию не в памяти потолка пьете и двое отправляют собственное тело с это решаю что вы за весь стенд файл и все у вас внутри ядра крипту ица и отправляется то же самое с крюком единственно причин почему quick view за спейси по сути потому что google нужно очень быстро по то типировать home гигантский он пишется быстро и вы сменяется поэтому сейчас реализацию за space на далее то что делать сейчас смело но акций у них есть в адаптерах и в последних версиях едва вскипел с есть как серию отца крипты вы можете уже больше делать не после сын файл клип давать в игре вы send file crypt уйти на сетевом адаптере и двоечку вообще не занимаются криптографии они вводят виде песен vintage на вход мы эти плюшки теряем если мы живем и за спейси сейчас как обсуждается реализация quik-а в ядре именно то по пути кеттела способ ты активизации о том чтобы цикл о том чтобы криптографии делать ведре то есть не идет речь о том чтобы вообще абсолютно весь мой сводный quick со всеми канзаши мк он со всеми вами в насос видео но может быть и так здесь перечислены и его подсосные реализации и тасовать скорее больше на как бы на на потом здесь интересно что как бы разница я ещё добавлю как бы размеры реализации что есть реализация века совсем посты на 9 тысяч строк хотя они в принципе вполне боевые тачки 2 о sega есть реализация хаммером который перевалить за 130 тысяч строк есть реализация на этап очевидно если мы имеем виде превью за спейси и все в usa спейси почему бы не сделать я на байпас не используя fmap для того чтобы быть еще быстрее это официальные документы все полезные это то что и хорошо почитать это статьи по дизайну и ну каких конечно вики из обложение по разработке меня все спасибо вопросы да сразу здравсвуйте спасибо за доклад а не работает работает работает на вопрос такой о да практическая реализация века то есть я так понял что на текущий момент он настолько глухой россии что для сетей общего пользования в принципе не применим пока еще из-за банальный metal box of a вопрос такой вы при этом самом начале упомянули что в принципе как поддерживает поддерживаться амазона если мы допустим построим какую-нибудь хоть и русскую архитектуру чтобы у нас между собой они пошли тебя общались в весе то есть насколько известно будет ли это работать попытаемся график я я с офис вообще не extremity of planning века но вот в плане медов баксов ну вот я взял google я со своего домашнего компьютера через домашние голод а какой-то стала билайновский я сходил в принципе у меня все работает да то есть вы хотите на youtube все будет хорошо работать metabox в принципе сейчас становится лучше то есть они тоже вот это все правит уже несколько лет пошел к воде как хорошо богу называют плаценты что нет мне кажется что то что они называют твоей там 10 процентов случаев когда отваливается блокируется цене и то есть это не драматичные какие такие цифры что вот он вообще как бы не работает тогда еще док вопрос то есть то что вы реализовали на крики это было для получается сад и общего пользования я не реализован чего я просто взял обычный home новый и сходил на google и вот все это как бы в это в обычной сети домашние то есть ну вот она она работает сейчас у сейчас станет такой что она будет работает спасибо мы вы можете сказать я повторю вопрос стоит ли вообще тащить крик ведро ведь у нас прям в ближайшей перспективе а fxp и соответственно вот ту реализацию которой она над mapi мы с точность таким же успехом можем запустить но не на модифицирован ядре linux на ближайшем будущем это первый вопрос и вопрос 2 решили проблему состоит состоит из рецепт в реке когда два сервера могут пакетик между собой гонять до бесконечности и там были всякие разные предложения типа давайте с некоторые вероятности дроп ним пакетик чтобы разомкнуть эту петлю спасибо за вопрос по первому пойду если вообще если мы всего в адаптера поднимаем пакет внизу space у матери в общак ситуацию на этом адаптере мы естественно что поднимаем пакет и его обрабатываем у нас больше нету криптографии мы это все должны делать насыпью нам нужно тогда уже знает маг и какие то доделать и очки чтобы он работал с адаптером мы ходим туда далее проблема с use space стеками принципе сейчас это и есть и в use space по верх над mapa de пеньке это так далее всем проблема в том что у вас реакция linux авансов и структуры вот я сейчас папа под уступе дампом вы можете попользовать свои шагом вы больше не можете это делать use space ре зация крика то есть у вас как бы поднимается трафик он виден только приложению вам нужно уже внутри этого стека реализовать sniff и реализовать firewall и то есть вот то что я даже в этот синтез попользовался 5 босса и цепи дампом вам надо это все заново делать вот в этой kryukov реализации который примет хламе мы там еще от кого-то по поводу проблем и гонения пакетов если честно я ее не слышал и вот сейчас последние реализации пока пока мире она не обсуждается и не знаю когда она возникает xd п.а. и съест все вот эти люди которые neo x2 пит этого вообще как-бы другой это как вы штуковина который работает и бпф работает на уровне драйвере даже вообще охотиться на сетевую карту на силу карту мы quick скользящим контур вообще никак не со фолдим и ну нового тех там он seo наработано dpf бпф это ограничение там в одну страницу инструкций нет упав и вообще чего то есть вообще как бы гриппе и биты в принципе не работа чем-то таким сложным и дится что он может делать и забрать пакет что-то в нем поразил собой статистику заблокировать там сделать он боюсь их что такое то есть здесь все равно у нас есть прикладной кот кота на делать на сплю там college его контур там вот эти все вещи мы не постимся да да давайте в фанты да вот всем спасибо спасибо за вопросы"
}