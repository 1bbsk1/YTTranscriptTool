{
  "video_id": "pkob6Ydi6jE",
  "channel": "HighLoadChannel",
  "title": "Архитектура бэкенда карт sputnik ru / Максим Дементьев (Спутник)",
  "views": 276,
  "duration": 2599,
  "published": "2017-04-10T07:24:58-07:00",
  "text": "меня зовут заменить в максим я представляю команду карт компании спутник я хочу рассказать о технической части нашего той лова бэг-энда о некоторых интересных как мне кажется технических моментах которые используются в нашей разработки спасибо много здесь людей которые пользуются на ли хотя бы заходили на карты спутника да ладно достаточно много людей я думаю вы могли заметить что наши карты используют данные проекта openstreetmap опыт street map это такая замечательная штука это открытая база геоданных она поддерживается энтузиастами по всему миру туда вносят данные огромное количество людей попробуйте ура у нас презентация на данный момент это без малого два миллиона участников по всему миру и участвовать принц сможет любой человек по-моему это потрясающе я бы наверное мог целую презентации рассказывать о том насколько хорош а по street map почему его стоит использовать всем и каждому но сейчас нас будет интересовать включительно техническая сторона вопроса поэтому мы собственно переходим к архитектуре нашего бренда и к тому как мы живем в данный опус ритма по если рассматривать весь стек ума street map от он достаточно сложен но коротко его можно представить вот такой простой картинка из трех больших элементов в сердце проекта лежит база данных это вас gres с расширением пост гис в нем хранятся все объекты карты пользователь с этими объектами взаимодействуя двумя способами во-первых он может загружать свои программы вносить изменения с помощью публичного и пиаре во вторых большинство людей все-таки заходит на openstreetmap не для того чтобы редактировать или внести какие-то изменения а для того чтобы посмотреть на замечательную карту карта отображается с помощью целого стек технологий которую коротко можно обозвать рендером если все что касается и пей находится на серверах опыт street map а то нижняя часть вам необходимо если вы хотите себя построить свои карты на основе данных о queen street map вам придется поставить базы и вам придется воспроизвести стек рендеринга давайте немножко окунемся в технологию веб карт как они работают какие есть подходы чаще всего используются в картографии подход на основе растровых файлов расстрелы и тайлы это такие квадратные картинки которые генерируются на сервере затем отправляются клиенты клиент уже делает из них красивую карту этот подход не идеален у него есть ряд проблем так например если у вас есть устройство с высоким разрешением или наоборот с низким то масштабировать картинку можно но возможно вы потеряете немножко в качестве на медленных connect ах возможно будут какие-то проблемы загрузка большого числа картинок но тем не менее на текущий момент это наиболее стабильная технология и при этом технологиям отлаженная простая и очень мало нагружающая клиент есть разное количество экспериментов на тему отказа от растровых файлов но тем не менее они все имеют свои ограничения и эта технология будет с нами еще очень долго скорее всего победит что-то гибридная для того чтобы получить эти самые тайлы нужно взять данные нужно их скорее всего чем-то дополнить например генерализованными геометрия миль еще какими то вещами которые обычно хранятся в шип файлах нужно поместить иконки на карту чтобы все было красиво потом нужно взять и написать инструкцию как же все это отображать на карте для этого существует такая штука как стиль потом взять какую-нибудь библиотеку для рендеринга к их есть несколько штук отдать и все эти данные подождать немножко и получить картинку собственно какие технологии используются в мире openstreetmap весь мир область ритмом держится на трех китах первый кит эта база данных как правило используются базы данных postgresql или конечно же с расширением пусть гис без расширения под гис говорить ни о чем во-вторых вам нужна библиотека рендеринга библиотек рендеринга тоже много чаще всего используются библиотекам об ник она open source на я все замечательно также вам потребуется клиентская библиотека чтобы в браузере отображать карту большинство сайтов используют лифлет и наши карты не исключения и так чего же мы хотели добиться создавая свой собственный стиль на основе данных openstreetmap мы хотели получить прекрасную полную карту но при этом она должна была быть достаточно чистый не замусоренным всевозможными лишними объектами должна была смотреться легко просто но при этом содержать все необходимые данные отлично течение джаз ептыт сделали без визуальной точки зрения все получилось здорово но такой стив технической точки зрения оказался достаточно проблематичен в чем проблема а проблема в том что очень много фильтров то есть мы получили достаточно сложный стиль это потребовало заранее генерировать большое количество тайлов ничего не оставлять на генерацию по требованию соответственно мы вынуждены держать огромный кэш кроме того у нас используется вокруг от каждого генерируется во вторых у нас используются несколько нетипичная для мира по street map и диалоги обновления карты в мире а после ритма принято как пользователь поменял какие-то данные но и со временем когда освободились ресурсы тайлы перри генерировались то есть вы внесли правку через некоторое время получили новую карту мы обновляем весь мир сразу то есть раз в некоторое время сейчас это месяц возможно мы пересмотрим политику мы скачиваем новые новое обновление и полностью получаем новую карту к сожалению среди тех утилит которые доступны сейчас свободном доступе не было тех которые позволяют делать это достаточно удобно все это превращается в некую боль для сравнения привожу несколько цифр по сравнению с оригинальным стилем опыт streetmap в резюме достаточно простой наш стиль в два с лишним раза сложнее кроме того если уже вдаваться в подробности там есть достаточно сложный элемент этого самого стиля который еще больше увеличивает время генерации осложняет нам жизнь какой есть классический подход к построению той лова бэг-энда все базируется на веб-сервере apache у него есть расширением оттаял приходит пользователь обращается к патчу apache пытаться достать данные из кэша конечно это обычная файловая система если вкушение обнаружил с нужно картинок мы обращаемся к бренду рендеринга в качестве бэг-энда рендеринга может выступать несколько систему обычно это либо рендер де либо terex вроде бы все здорово на что здесь не так проблема первое это файловая система то есть это действительно файловая система все общение происходит через нее если вы хотите использовать скажем в качестве кошаку это облачное хранилище у вас возникают проблемы а проблема здесь тем что все ориентировано на синхронную работу если вы попробуйте использовать что-то с венчал консистенция вы скорее всего очень расстроить пользователя ну кроме того есть некоторые проблемы с масштабируемостью формально она есть на практике она превращается в огромные проблемы ли системных администраторов в принципе ему какое-то время и жили с таким стеком но в какой-то момент мы решили поставить эксперимент и получился зверь со смешным названием гопник происходит от язык огонь и от названия библиотеки map ник эксперимент мы признали удачным и оставили систему жить дальше чем же она чем же она лучше того что было во первых она связана от файловой системы вы можете использовать абсолютно любой стороны для каширования какой захотите проблем нет мы изначально предусмотрели масштабируемость все необходимо для масштабируемости сервиса есть сразу на борту мы постарались сделать систему как можно более модульной расширяемой чтобы впоследствии изменяться под любые нужды которые могут возникнуть также мы постарались максимально сохранить простую конфигурацию для системных администраторов и сделали ряд утилит которые облегчают жизнь с нашей политика обновления карт если посмотреть так в крупную клетку на схему нашей системы получается такая картинка есть две категории демонов во первых это диспетчер она который через балансиры приходит запрос от пользователей и есть все тот же бакан тренды ринга диспетчеры получают запрос проверяют кэш если каша нет запрашивают тайл рендера если эту схему рассматривать она в принципе похоже на то что было в мод тайл в чем же отличие отличие в том что все сделано в угоду облачным хранилищем в чем тут некоторая проблема стоит немножко поподробнее погрузиться в процесс рендеринга тайлов если вы думаете что при запросе генерируется один этот маленький то ли который обычно здесь 56 на 10 6 пикселов то это не так во первых если вы будете генерировать маленькие картинки вы либо сильно усложните алгоритм рендеринга либо получите огромное количество подписей по всей карте поэтому используются как правило генерации больших картинок на слайде нарисован пример когда генерируется картинка 4 на 4 на 4 tylo два на два мы используем genius 64 тайлов одновременно то есть рендер генерирует картинку причем с некоторым запасом по краям потом ее разрезает на тайлы уже tylo отдают использовать или сохраняются в кэш это позволяет во первых несколько простить алгоритмы убрать лишние подпись из карты и избавиться от проблем на стыках тайлов то есть в принципе если вы прощаете алгоритма вы можете столкнуться с тем что на границе картинок вас подписи пострадают и возник какие-то неприятные артефакты такая схема позволяет есть не полностью от этого избавиться то минимизировать возможные проблемы до ничтожно малых до ничтожно малого количества чем это плохо с точки зрения архитектуры с точки зрения архитектуры это плохо тем что пользователь как раз у нас запрашивает один тайл а генерируем и 64 мы не можем ему отдать сразу все и сказать на держи делай с ними что хочешь таким образом мои пользователю сделаем плох и наши сети сделаем плохо что делает в этом случае мод тайл он просто складывает все на файловую систему и говорит вернее как это делает бог and bug on складывает на файловую систему говорит об а чё я положил забирай apache приходит и забирает с облачными хранилищами это не работает с облачным хранилищем приходится делать по-другому мы спрашиваем tyloo рендера рендер генерирует 64 отдает один все остальное складывать сторож вопрос что случится если в это время пользователя придет за вторым тайлов а скорее всего он придет поскольку он смотрит картон и как-то сдвигает там как-то через сеть проходит запросы к нам если у вас сторож это что-то свинтил consistency ну скажем кассандра то поняли скорее всего может ничего не получить это плохо поэтому все рендеры оборудованы специальным локальном кэше он в котором все тайны лежат до тех пор пока мы не увидимся в том что они сохранены успешно в каше кроме того там есть дедупликации и прочие полезные вещи все было бы неплохо если бы не одно но вот это вот нарисованная схема это как раз требования тайлов генерация тайлов по требованию нам же периодически нужно сгенерировать весь кэш полностью не весь мы генерируем большую часть мира на самом деле исключая местности где очень мало данных где-нибудь не знаю на край на краю света где особо никто во первых карту не смотрят во вторых сгенерировать тот кусочек довольно быстро и просто но все населенные пункты по крайней мере крупные должны быть гинер он и заранее потому что то долго процедура и заставлять пользователя ждать скажем 20 минут пока сгенерируется карты это просто смешно он подождет немножко на может быть заварить себе чая в конечном итоге он уйдет сервиса это несколько обидно поэтому мы задались вопросом как сделать так чтобы кэш генерировался но при этом это не у кого не вызывало более и мы сделали утилиту для заполнения каша во первых мы позаботились о том чтобы ее можно было гибко конфигурировать то о чем я только что говорил все крупные населённые пункты генерируются всегда в процессе обновления карты все менее интересное генерируется по требованию планета на больших увеличениях то есть когда вы смотрите на россию с высоты не знаю школа там не птичьего полета полета спутника все это гневается конечно заранее конечно же на одной машине это не генерируется до генерируется на кластере машин потому что операция долго и ресурсоемкая мы постарались сделать так чтобы система была максимально простой но при этом достаточно надежные ну кроме того чтобы для того чтобы облегчить жизнь нашим системным администратором мы предусмотрели различные интерфейсы этой консольный интерфейс и графический веб-интерфейс все это управляем этим можно рулить непосредственно процессе генерации наш стены администратора довольны как это все устроено под капотом схемам на удивление просто есть набор узлов на которых работают славы sleeve это такая штука которая всегда готовы делать работы генерировать вам tylo кроме того есть координатор здесь обозначен как пре-рендер есть утилита которая подготавливает задание для координатора на вид конечно схема ненадежная в первый раз это видит говорит о боже ваша один координатор что будет если он умрет все же все же будет плохо на самом деле не совсем во-первых у каждого элемента здесь есть своя очередь некий такой блок каша запас задание то есть если у нас что-то случится сетью что периодически случается допустим там на несколько секунд всем будет чем заняться никто не пострадает процессор простаивать не будут что будет в том случае если кто-нибудь умрёт не знаю сеть умерла сама машина умерла если это много генерация что случается чаще всего по разным причинам ничего страшного не перри за не произойдет координатор конечно же знают кому какие задания выдал он их просто перезапустит они пойдут дальше здесь никаких проблем нет вопрос что будет если умрет сам координатор координатор это такая утилита который запускается системным администратором мне некоторые люди говорили что ну как же она запускается вручную где же автоматизация где же счастье что ты пришел уже подумал она уже сделано на самом деле никакой необходимости пока в автоматизации не возникало когда ты можешь нажать кнопку и поучить пока это решение здорово по-своему так что же случится если эта кнопка умрет а на самом деле не случится абсолютно ничего любой элемент архитектура хранит информацию о том что когда он сделал кроме того у вас есть некоторый план задания обычно он как-то генерируется локальный у него есть копия или в любом случае можно и воссоздать заново никакой проблемы нет с помощью достаточно гибкого интерфейса управление заданиями вы можете сказать что я не хочу генерировать то что уже сгенерировано там в такой-то промежуток времени отдать ему вот эти самые performance влоги и сказать продолжаю задание с того места где мы остановились и он будет работать администратор выполняет всего три команды и все летит дальше кроме того таким же способом можно переносить элементарно работу с кластер она кластер допустим мы решили что все происходит слишком медленно взяли кластер больше запустили там или взяли другие более мощные машины пожалуйста это что касается архитектура теперь я хочу немножко поговорить о других интересных вещах технических например обсудить почему мы в основном разрабатываем на языке go на самом деле команда к этому пришла не сразу когда мы только развивались мы пробовали разные технологии у нас год в какой-то момент целый зоопарк различных языков различных технологий скажем так стек был очень замусоренным у нас были если + + и 1 python искала все подряд что с ними не так почему мы от них отказались sti плюс прекрасный язык ничего не могу сказать про него плохого я часто пользуюсь для разных вещей но тем не менее для повседневной разработки он оказывается слишком сложным он насколько функциональной насколько настолько и перри усложненный для многих вещей это просто не нужно это чревато ошибками это чревато очень долгим временем разработки зачем нам эта скала тоже прекрасный язык но тоже сложный кроме того у скалы есть и другие проблемы во первых она все таки часто меняется я от многих команд разрабатывающих на скале слышу следующую историю что мы написали приложение под какую-то версию нас все нет времени перейти на следующем минорную версию потому что там есть какие-то изменения но правда это не очень приятно во вторых если вы захотите найти нового разработчика в команду который будет писать на скале вам либо придется его долго учить ну либо вы его просто не найдете потому что их единицы правда эта печальная история спирали python в этом плане все намного лучше но у них есть другие фатальные недостатки во первых это интерпретируемый язык и что немножко сужает их область применения по крайней мере там где например нужна скорость или мало потребления памяти во вторых они лишены такой прекрасные вещи как статическая типизация опять же та вещь которая очень сильно сокращает количество ошибок при разработке ну и куда же двигаться было от этого дальше можно было конечно перебирать и щепкин языки не знаю попробую трубе но мы решили пойти по другому пути и взять максимально простой язык и пока что мы не жалеем об этом выборе какие плюсы для нас go во первых он очень простой допустим вы хотите взять нового человека в команду вы можете взять хищника вы можете взять питаниe 100 до кого угодно вы даете ему книжку и уже наверное через неделю он начинает писать вам приложение нагон фантастика во-вторых это компилируемый язык то есть принципе он достаточно быстро для большинства задач по такой средней температуре по больнице он всего лишь раза в два медленнее чем плюсы а в некоторых случаях и примерно такой же и не так уж он прожили в памяти очень здорово у него строгой типизация меньше ошибок опять же у него есть сборщик мусора это тоже хорошее такое изобретение человечества которое ограждает вас от всевозможных ошибок общение с памятью у него очень простая понятная модель многопоточности вы пишете совершенно безумный кот который постоянно for cats постоянно запускать какие-то задачи это все работает и работает быстро синхронизация нужно по минимуму совершенно что-то написали запустили расплодили гору then и она работает бегает не потребляет ваш цпу замечательно он очень быстро компилируется то есть вы можете написать огромное приложение и вам не нужно ждать полчаса пока она перри соберется где-то у нас выход к на тестовый closure занимает считанные секунды куда большее время занимает непосредственно копирование данных на сервер раскатывание пакетов и так далее сама компиляция занимает секунды очень здорово можно ничего не ждать на что-то написал посмотрел на юнит-тесты ахо в тест такой хороший шаг continues delivery идеальному continue с delivery кроме того у него прекрасная стандартная библиотека в общем-то не уступающая питону практически не уступающий немножко уступающий но все-таки и у него прекрасный набор полезных утилит которые очень сильно облегчает жизнь разработчику например есть встроенный тест к вич есть встроенный детектор дата рейсов много хороших вещей встроенная система документации вы просто себе ставите стандартную поставку из-за кого и пользуйтесь еще у нас осталось немножко времени я хочу поделиться таким рядом замечаний про тестирования то есть понятно что написать кластерную систему это здорово но вам еще нужно будет ее протестировать первое что приходит в голову это юнит-тесты где не тестов жить невозможно для всего должны быть юнит-тесты ну конечно в граничном количестве без фанатизма в год опять же все хорошо в сам язык строим тестовый фреймворк вы просто создаете файл заканчивающиеся на underline тест записывайте туда определенно оформленная функция и у вас есть тесты поскольку у нас периодически встречается язык си плюс плюс но к сожалению сторонних библиотек нельзя все это так взять и переписать на ком-то другом языке кроме того местами все-таки использование языка си плюс плюс она оправдана например из-за критичной производительности для си плюс плюс есть прекрасная библиотека google тест если здесь кто-то пишет на плюсах и не пользуется очень советую но тем не менее это всем давно известно ничего особо интересного здесь нет интересное наступает дальше когда вы хотите посмотреть как работает ваша система в сборе то есть конечно в идеале вы можете рассказать о на какую-то тестовую конфигурацию приближенную production ну и конечно же в итоге так и делается но обычно это довольно долгий процесс зачастую завязанный на системных администраторов а часто хочется что-то такое в коде подходить и сразу посмотреть что все работает как этого добиться здесь нам помогает такое очень нынче модное слово докер докер позволяет вам защитной мгновение запускать кучу-кучу контейнеров то есть вы на своем ноутбуке запускайте какой-нибудь скрипт который вам в мгновение ока поднимает кластер скажем из 10 20 и 100 машин сколько захотите вы можете смотреть как система себя ведет можете написать какие-то автоматизированные тесты для этого убедиться что все работает но конечно если вы ходить по нише нас в реальной жизни будет работать то докер в чистом виде это довольно смешно и решение понятно что на локальной машине когда все рядом когда нет никаких не знаю кабелей порванных ислама вш ихся у вас все будет работать идеально здесь нам помогает замечательным модуль на этом про который к сожалению мало говорят и мало кто о нем знает это такая штука которая позволяет вам эмулировать всевозможные сетевые поломки взять и потерять часть пакетов получить медленный канал в каком-то неожиданном месте получить задержку скажем секунд 30 если у вас какие-то вещи связаны с потоковым видео вы можете взять пересортировать все пакетов самым неожиданным порядке эта штука прекрасно интегрируется с докером то есть в принципе докер когда вы сдаете контейнеры он создает уже все что необходимо на этому то есть уже есть уже есть мост уже есть виртуальный интерфейс а все что вам нужно посмотреть что именно вы хотите сломать не сломать кроме того есть замечательная вещь индекс танк которая во время этого всего позволяет вам симулирует нагрузку основной паттерн используем для таких тестов очень простой вы берете логин с продакшена загружаете немножко форматируйте формат индекс танка загружаете их в яндекс танк ставить его да даже пожалуйста на своем ноутбуке и заставляете о воспроизводить какую-нибудь вполне типичную нагрузку для вашего сервера сервиса или например симулировать какую-нибудь ситуацию которую вы из мысль или по дороге на работу едете в транспорте думать господи а вдруг кто-то придет и сделать какую-то такую пакость сделает ее 1 тысячу или раз десять тысяч доз прямой же сервис умрет надо проверить приходите пишите инструкцию запускаете все в докере думаете что у вас реальная дата-центра не какое-то такое мифическое железо с единорогами ломайте немножко сеть запускаете нагрузку и радостно смотрит к косте ломается падает где вы забыли какую проверку где вы выставили неправильный тайм-аут срочно бежите писать fix поэтому очень рекомендую использовать такую связку это здорово удобно ну и куртка хочу поделиться с вами нашими планами на будущее на текущий момент мы для себя подготовили пока некоторые такую базу развитие то есть мы сейчас такой проект находящийся статусе бета и мы можем себе позволить делать какие-то задела на будущее в плане стыка той лова wakart мы подготовили такую вещь который впоследствии можно адаптировать в принципе по да все что угодно достаточно гибко достаточно просто это здорово что мы хотим дальше мы на самом деле видим постоянно какие-то исследования разных интересных вещей в частности мы хотим попробовать сделать сервис discovery может быть там на основе протокола sip может быть на основе чего то еще кроме того если вы говорить если мы с вами говорим о доставке картинок пользователь то это большая проблема с точки зрения сети поэтому хочется как-то попробовать оптимизировать процесс сейчас google разрабатывает разные интересные вещи решением проблемы с задержками взаимодействия с сетью это протокол о спиде я протокол quick тоже мы как-то стараемся исследовать не до всего еще дошли руки но моно я надеюсь что мы ближайшее время этим займемся но кроме того все-таки базы данных в основе такой системы она не является узким и негибким местом введем разные исследования темы того как можно базу данных преобразовать во что-то такое более масштабируемая и гибкая ну и конечно же самая приятная вещь эта штука гопник то бишь в очень скором времени отправиться open source я думаю до конца года это случится поэтому она будет доступна всем и каждому может быть приживется в мире оку street map или будет полезно людям таким же как мы которые делают свои карты на основе по street map а я надеюсь что людям это понравится ну собственно все ваши вопросы спасибо большое за доклад у вас очень крутое название но собственно гопник собственно вопросов в нос на вопрос на земля 1 вы просто не рассказали что вас внутри этого самого гопника вот о чем вы делаете кластеризацию использую что такое либо что-то что-то родное как вы делаете очереди перв перво ки локального что вас а что внутри технически ну понятно к сожалению времени было не очень много то есть если бы у нас может быть было 23 часа беседы можно было бы рассказать подробно обо всем мы в архитектуре старались сделать все максимально просто то есть может быть это выглядит ну как то так очень по-простецки но тем не менее для того чтобы как-то размазывать нагрузку по машина мы в основном используем сама простой хэш от координат tylo тем самым мы добиваемся дедупликации в большинстве случаев стопроцентной нам не нужно то есть если у нас вдруг запустилась задачи в двух местах это неприятно мы живем лишние ресурсы но ничего плохого не произойдет сгенерируется одни и те же данные они положится в одно и то же место в к шее в конечном итоге просто какая-то копия выиграет ничего страшного не произойдет поэтому здесь такое вполне позволительны для очередей мы опять же не используем никаких модных вещей типа рыбе темку или кафки здесь это не нужно они все достаточно простые то есть это просто локально очередь в памяти 2 локальных очереди в памяти к между которыми есть установлены и соединения по которому просто гонится очередные блоки заданий я на что-то не ответил да на все ответили в принципе ну основной чтобы интересно да и второй вопрос вы каким-то образом решили проблему не пить и ценность этой love not вы обновлять по одному они по системность она автомата появляется смотрите здесь спасает такая штука она называется по-разному например сине-зеленое развертывание то есть у вас есть два зеркальных продакшена один является пред production а другой является продакшеном вы все разворачивается в том что сейчас является pride продакшеном смотрите что у вас все в порядке и в какой-то момент вы просто переключаете их местами это понять речи стал обновления тайлов вот у вас есть клубни который обновляет тайлы вот вы начинаете обновлять tylo по одному да я понял смотрите когда мы обновляем тайлы по одному то координатор ведет tracking всех ошибок любая ошибка она будет задать их china и задание будет поставлена заново то есть принципе ситуация что у нас что то сломалось но она мала вероятность единственное адой кроме того конечно же мы начинаем все описать в абсолютно чистый кэш то есть даже если нас обманул скажем базы данных она сказала что она все сохранила рендером закончился без ошибки но там образовалось пустое место ничего страшного нет то есть после выкопки кто-нибудь на это наступит запустится рендеринг по требованию и все будет генерировано то есть это тоже такой венчал консистенсии с точки зрения пользователя ясно спасибо очень короткий вопрос спасибо за так вот я понимаю что выбрали openstreetmap но все равно вопрос такое векторные карты вы думаете будет за ними будущее или нет вопрос что что понимать под векторными картами к сожалению этим понятием называют огромное количество всего не так понимаю ну а ведь виду клея клиентскую часть да да то чем занимается мама бокс например смотрите это технологии имеет ряд ограничений то есть например если вы хотите богатую карту с кучей иконок с кучей всяких мелких деталей то генералитет на клиенте довольно сложно то есть в большинстве случаев у нас клиенты достаточно простые какие-то ноутбуки мобильные устройства не всегда там можно сгенерировать всю карту целиком достаточно полно поэтому все на текущий момент векторные тайлы векторной карты они достаточно просты и они облегченные если вы посмотрите на мои боксом и другие вещи там минимум элементов то есть мне кажется что выиграть какая-то смежная технология когда некая подложка в том или ином формате будет загружаться сервера а всевозможные вещи которые требуют изменчивости зависимости от клиент например надписи они уже будут генерироваться впоследствии потому что нам все-таки жалко батарейки пользователей жалко процессор на и время это сказывается очень на отзывчивостью ой так что так максимум спасибо за доклад ждут кости я среди прочего контрибьютором пустит map в свободное время естественно я примерно представляю как устроено и как раз данные там и поэтому ну во-первых респект за стиль это действительно очень круто области тм об очень нуждается в стилях и то что делать спутник с то через те ли это классно я понимаю что это очень сложно и вопрос скорее в том как бы как вы решаете то есть выпустит mapi очень много не согласован ну как данных с разными схемами тагирова не разных несогласованных много мусорных личных данных вам хватает только стиля для maknika для того чтобы все убирать или вы еще дополнительно чистить и сами данные выгрузки адонис with map и и второй вопрос сразу pro retina ну хорошо я правитель тоже план вопросы отвечу и на тайна то ну смотрите я не зря упомянул что у нас местами есть очень сложные запросы то есть данном хватает стилем об никому все чистим непосредственно при рендере но зачастую это довольно сложная задача то есть часто там идет анализ скими 3gp спамим большими в принципе это не проблем с точки зрения разработки эта проблема с точки зрения рендеринга то сюда отнимает кучу времени из-за этого мы страдаем на этапе рендеринга pro retina вы хотите нами спросить будет ли у нас витино если она сейчас посмотрел на айфоне нет родины мы в эту сторону активно думаем но к сожалению с retina есть большая беда сейчас уже в современном мире довольно сложно понять что такое именно retina то есть устройство они развиваются постоянное количество точек на дюйм растет какой-то жуткой сколько жуткой скоростью если сейчас делать ретину с точки зрения и пэда например то для некоторых устройств это уже будет плохо поэтому здесь есть некоторая большая проблема как именно это стоит делать мы пока в раздумьях драсте такой вопрос вы используете библиотечку лифлет джесс да она даже упоминалось на слайде как ваше руководство относится к тому что русские национальные карты используют библиотека украинского националиста агафон кино это первый вопрос а второй вопрос тоже серьезный а вот если у вас поисковый движок над картографическими объектами и какой поисковый движок используется в картах поисково дверь поисковика спутник очень интересно тоже надо конечно такой прекрасный наброс на самом деле о по street map это такая вещь не имеющий национальности я в принципе ждал когда будет вопрос не знаю про национальный интернет или просто нет еще такое а по street map весь бизнес без национальностей и в лифлет на самом деле кантри будет куча людей не только агафон кен поэтому это тоже такая вещь интернациональная никакой проблемы здесь нет поисковый движок но смотрите нас поисковый движок собственной разработки специально сделанной для адресного поиска потому что на самом деле задач адресного поиска она не просто и она плохо решает с каким-то курсор свершениями ну можно взять скажем не знаю ластик search в него всю загрузить скорее всего выдачи вы получите плохую поэтому мы разработаем свой движок он пока может быть тоже еще не идеальный но мы стараемся расти в этом направлении дай он тоже написано go ahead тогда у меня есть три вопроса первый правильный правильно ли я понимаю что вы не используете наминать им ни в каком виде да и для адресного поиска используется полностью свой второе то что вы используется для реверс гиа кодинга и гиа кайтинга и третий вопрос а сортируете ли вы баз данных если да то как смотрите про обратный decoding пока что мы используем власть ключ для этого но я надеюсь что мы скоро уйдём про базу данных ответ на вопрос какую пузырь с да но все влазит в одну жертву до но все влазит в одну их просто много много одинаковых подвесов еще вопросы скажите пожалуйста как вы тестируете сам рендеринг от что ваши toilet склеились во что-то вразумительное то мне кажется юнит тестами это как-то даже возможно то менять ну наверное возможно но лично у меня пока не получилось то есть тайлы мы отсматриваем глазами можно попытаться сделать что-то роботизированная но пока что получается что это что-то роботизированное нужно тестировать скорее и чаще нежели то что оно должно тестировать то есть мы можем изобрести а вот систему компьютерного зрения которая будет рассматривать наш тайлы но скорее всего ничего хорошего это не найдет а элементарных ошибок не заметить еще один вопрос про коллекцию данных еще раз все таки задам вопрос то есть карты позиционируется как российские часть спутника русского национального проекта до рано или поздно скорее рано выставляю ситуации когда выпустит map имеет одно мнение на то какая страна существует и не существует и как она называется российской федерации другое уже на текущий момент вы сталкивались с этим или нет что для этого планирует делать потому что это будет на 99 процентов но мы понятное дело как национальный поисковик придерживаемся официально мнение российской федерации как вы это делаете просто возможно нек-рых случаях придется вносить исправления на самом деле это все делается на уровне рендеринга на уровне рендеринга вы можете это сделать это правило на уровне венгрии газ то есть вы но вы же понимаете что в принципе расширение месте ли вы можете сделать карты абсолютно все что вам заблагорассудится да окей в том числе соответственно национальную принадлежность названия пунктов и прочих да то есть вы дополнительно это все уходит а засеять этом 7 спаянный тысяч правил и 100 тысяч строк xml для макарий касается дополнительных данных данные да как бы стиле тянут еще из дополнительных данных все спасибо"
}