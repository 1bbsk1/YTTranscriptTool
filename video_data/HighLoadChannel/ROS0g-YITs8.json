{
  "video_id": "ROS0g-YITs8",
  "channel": "HighLoadChannel",
  "title": "Блиц-доклады",
  "views": 455,
  "duration": 3234,
  "published": "2017-04-22T14:48:18-07:00",
  "text": "ну видимо начинаем а можно мне кликер принципе все может могут сесть поближе вас довольно таки немного слайды будут собственно всех к не пришли сами себе злобный буратино это довольно интересная и веселая сессия в общем у нас есть выступающих двое выступают смысле двое один выступает дважды собственно я пробегусь быстро расскажу что такое blitz доклада и как это происходит то есть ровно пять минут на доклад ни больше ни меньше ну меньше может быть ну тогда докладчик уходят раньше больше никак на 5 минутах ровно останавливаемся на четырёх минутах я даю предупреждение сейчас покажу как никаких вопросов докладчиком собственно какие у нас доклады доклад но если за тобой за за search то есть как использовать свой сквер базу как поиск асинхронные запросы в mais quel это проход php москве в общем такая классика нюансы работы слов тарантул довольно интересный и веселый доклад как убедиться что конфигурация докатилась до куратора довольно объемный доклад использование киото tycoon в общем разбавим тарантул на презента на холоде немножко другой базой данных очень редко представляется про балансировку к т т п с т т т т т т т п с в общем то казалось бы тривиальная тема но может быть довольно интересной нам николай покажет систему яндекс amplify в действие без слайдов нам расскажут про тегирование кэш на базе тарантула довольно простой на первый взгляд доклад про пропускную способность и задержки и завершится нашу сессию доклад как делать проект когда вокруг тебя аналитики собственно все поехали значит это будет происходить так собственно когда остается 4 минуты я стучу тихонько но у меня не получается вместе с микрофоном вот так когда прошло четыре минуты когда осталась одна минута когда время выходит я зазвенит громко и мы сразу переключаем презентацию на следующую все включаем первый доклад слова первому докладчик подожду официального таймера авто бистами а не умею так мне я просто достаточно дима зовут я буду задавать вопрос аудитории отвечайте быстро меня времени нет окей всё а и clicker круто кто из вас на чешском база данных поднимите руки кто значит стуканул цель кто работал отлично я расскажу как и зной склеить сделать поисковый движок кто значится к поисковый движок сфинкс люсин elasticache отлично считаем что все все знают осмотрите и ничего не вижу посмотрите покупала на текст и поясности такие документы это могут быть там web-страницы это могут быть в посты в блоге письма в ящике что угодно но только что за чертовщину документов есть какие-то текстовые зоны для письма этом фронту сам же базе то есть какие-то кусочки текстов эти текстовые зоны они бьются на слова алгоритм разбиение таки не зация небес на слова от них дает какой то хуже не становится одинаковой длины все и потом по этим словам мы ищем то есть поиск это что-то обратно вот мы вводим слова находим зоны находим документы получаем вот такой результат научу вот так вот то есть выдавать виде пары то есть лучше вообще я снова результата как список пар и как мы нам сделать это с помощью но и сколь база данных вода пусть нас есть все диск то значит кризис все знает и видит там самый основной проблем чтобы все-таки это большей частью хэш табл то есть по факту от сала вот так будет расположены поперек только перемешано и значит мы не можем нормально и тренироваться и что мы делаем то есть сюда мы кладем какие-то списке ну тут одна проблема добавляйте эти списки не очень удобно будет но искать мужем просто берем по ключу ищем но это не очень красиво не очень быстро еще будет когда нас есть дерево какие баз данных бы вы знаете тарантул кто знает кто такой все на холод пришли ней куча как титранта вы не знаете в такой тарантул база данных такая моего разрабатывается этот человек был они разрабатывает а вот он сидит тарантулов вот смотрите у нас и смотрите вот это немножко сложную схему до боли вот эту связь и вот первое слово видите у нас там как а документики и текстовые зоны раз мы сюда поместили сюда зона то есть это ключ-значение второе слово поместили 3 слова поместили вот так вот всё красиво получается что из этого как из этого то есть слова у нас это четыре байта какой то какой то have от каких-то токенов документу насколько the bait ну в почву нас восемь байт зоны это просто какие перечислению нас их dance уйти не больше 8 будет поэтому мы возьмем просто битовой масках представим ну в общем зон то есть вот ровно что было вот щебетала маска представили в виде числа пересмотрите мы это всё ресторан туле данные хранятся в топах им это все приставим вот такими вот тапами то есть вот то же самое и у нас вот тут композитный ключ будет это b3 и собственно все как искать по этой штуки мы берем открываем оператор открываем итератор вот и первый элемент а по будет от наш искомое слово 2 элемента нолик третье это 0 вот такой-то итератор и он откроется на первым table который подходит под наше значение не знает не вижу ведь на туда нет ты не походим вот 12 дом и потом мы делаем там это риру имитируем 3 м пока первый элемент не станет двойкой ему от прошли два элемента то по все дальше мы не даю им а вот наш ответ то есть у нас документ 2 им битовая маска по зонам 3 и документ рейки и битовая маска 4 соответственно все мы нашли если будут вопросы rigant не позволяют подходите пишите спасибо всем привет меня зовут максим я печки разработчик компании mail.ru сегодня я расскажу о такой теме как асинхронные запросы в mais quel или когда подрос становится мало это часто выпускаемая возможность печки начну я свой доклад с небольшого обзора как обстоят дела вообще сейчас с взаимодействием с mais quel из языка php вот на слайде схема такая что в с версии печки 53 у нас появилось расширение москва лендина этих драйвер она написана на языке си и предоставляет нам три api для взаимодействия с mais quel им вы наверняка знаете или слышали про них это москва элем моей сколь ой от improve и домой из coil подробный я разберу только последние 2 потому что mais quel с версии пичко 7 вообще удалили ну в общем такая вот история давайте их немножечко сравнимого такая вот табличка обе оба этих api умеют отображать объектами результаты выборки умею подготовленное выражение умеют поддерживают исключение к сожалению москаль ой не поддерживает именованные параметры потому что сам сервер mais quel их не поддерживает впадай это достигается за счет работы эмулятора pripyat также моей сколь и не поддерживает моя сколь версии младше чем 41 потому как сама расширение была основана на версии 41 зато абсолютно полностью поддерживает все возможности более старых версий в то время как под эти возможности поддерживаются или частично или вообще никак то есть если немножечко подытожить то о чем я говорил все таки есть некоторые преимущества где моя сколько является возможно не так у удобным но более хорошим инструментом так вот это 3 пункт это производительность в среднем просто если вы будете использовать мой сколь ой ваше приложение будет ну где-то на 6 процентов в среднем быстрее предоставляется api для получения статистики этих запросов также полностью поддерживают все возможности mais quel а в частности асинхронные запросы о которых я собственно сейчас вам расскажу и readonly транзакции например которые были введены начиная с версии mais quel 56 ну так вот давайте перейдем к синхронным запросам собственно мы имеем вот такой вот небольшой листинг важный нюанс в том что работать это будет только на различных соединениях базам данных вот у нас здесь в примере 3 шарда которым мы отправим знак одинаковый запрос есть флаг морской лессинг который показывает что эти запросы должны быть выполнены асинхронно далее мы просто опрашиваем до тех пор пока не получим в серии все три результата в данном случае все три выборки если рассмотреть это на диаграмме как выглядела бы это по того это водка картинка слева то есть каждый из трех запросов выполняется последовательно и суммарное время выполнения у нас 1200 миллисекунд абстрактная такая величина если мы используем асинхронные запросы моя сколь ой то суммарное время которое мы затратим это максимальное время выполнения какого-то одного из запросов то есть в данном случае это 600 миллисекунд то есть ну вот в абстрактном таком примере мы получили выигрыш в производительности в два раза что согласитесь очень хорошо и я хотел бы обратить ваше внимание при смотреться к этой возможности и возможно вы сможете внедрить это в своих проектах спасибо добрый вечер меня зовут игорь я работаю в команде облако mail.ru тем моего доклада была выбрана не случайно я-то знакомств тарантулы относительно недавно и хотелось бы осветить некоторые тонкости которые привлекли мое внимание на моем пути не в ту сторону собственно в tarantul и для написания хранил процедур используйте язык лу-лу это императивные язык программирования с низким порогом входа что собственно позволяет использовать тарантул программистом которые прослушали один курс по программированию без изменения парадигмы массивов и хэшей на парадигму таблица кортежей и лу имеет хорошую странности быструю скорость исполнения но как и любой шикарный инструмент он имеет свою особенность собственно первое особенностью люди привыкшие программировать таких языках pearl питон все привыкли что индексация массив начинается с 0 но это не так одна начинается с единицы вторая особенность многие люди которые программируют на таких за как как первости питон привыкли что 0 касается к falls но это не так в лоб фолз касается только нил и сам фолз рассмотрим более жизненный пример использую тарантул 15 нам нужно выбрать пользователи у которых некоторые а требуют больше либо равен единице и вернуть это все упаковано джейсон массиву но как таковой не различает массивы и хэши на отдельные существa у него есть таблицы которые можно по-разному интерпретировать соответственно если нас нашлись такие юзеры то мы получим хороший упакованный джейсон массив а если они таковых не нашлось мы получим пустой объект но надо как-то ситуацию обходить поэтому можно придумать вот такой простой хак явно проверить длину массива на ровность нулю и вернуть захардкожены пустой массив или нормально упаковать таблицу в ином случае но даже с длиной массе углу не все так просто рассмотрим первый пример как видно на слайде она создает в таблице ты из пяти элементов и раскатывается ее длина но есть особенность она не вставляет значение nil при вызове инструкций требуя enter и игнорирует значение nil на краях таблицы при создании таблицы таким способом как приведена на слайде соответственно 1 принтом вернет четверку далее ставим минус единицу на сотую позицию и многие из вас скажут что длина массива будет либо 100 либо 5 и все они окажутся неправы потому что она останется равным 4 потому что лу не умеет работать разреженными массивами и это сочник будет храниться как массив из четырёх элементов и хэш с ключом 100 рассмотрим другой пример создадим таблицу а с ключом объединиться типа число и значением единицы распечатываю его длину она будет равна единице вроде психологично теперь создадим таблицу и с ключом единицы равна строка и значением единицы и результатом его длину она будет равна нулю просто потому что low не умеет считать длину таблицы интерпретируем и как хэш таким образом мы видим что наше решение с проверки длина массива 0 приносит баги если мы не гарантируем интерпретацию таблицы как массивы ну и вернемся миног и джейсон и их различием в тарантул 15 тарантул 16 + рассмотрим второй зал 15 таблицу т определенную на слайде проверим что 2 элемент этой таблице касается cforce вот таким аналогом тернарного оператора упакуем эту таблицу 1 по ком ее и сравним данные до упаковки после распаковки они не равны так почему же потому что бог ситжес он любезно упаковывает нил в боксе джейсон all который мало того что не коситься к фолз как мы видим это из 2 строки так он еще и не равен самому нилу 2 до 16 вторая проблема была пофикшен а как видно из вывода но 1 проблем все таки осталось спасибо за внимание добрый день так здесь лучше видно добрый вечер меня зовут копеек андрей я расскажу вам о том как пользоваться немножечко чужими инструментами проблема выглядит вот так у нас есть сайт достаточно большой одежный магазин достаточно большой с тем что пользоваться куратором для защиты сайта и сиди иен для раздачи картинок при этом картинки через ассистент картинки тянет тоже из куратора потому что сайт спрятав внутри куратора все хорошо значит настраиваете давите нагрузку и в один прекрасный момент прилетает письмо о том что вов ничего не работает над на каталоге нет картинок идете на каталог магазина да нет все есть вот они картиночки читаю блоги никаких ошибок него заявитель говоришь все хорошо проблему вылечилась а через неделю она повторяется он приходит уже скриншот действительно картинок нет читаем блоге опять все хорошо так просто вот повторяется несколько раз наконец через месяц сюда естественного счет посмотрев логе идете на сайт вот они картиночки все есть через видно что происходит сашин непонятно месяц идет разбирательство между а к моим куратором со всеми языковыми проблемами и выясняется что в какой то прекрасный момент один из узлов куратора может hitter поломаться так что на нем есть все кроме конфигурации вашего сайта akamai хитрый он читается на сайт не обнаружив там картинок он идёт к другому своему узлу вычерпывай картинки они на неделю кладутся в кэш и все хорошо то есть ситуация когда нас айна каталоге нет корзины как наваливается там 10 секунд за неделю вот тем не менее оно есть куратор говорит что мы вылечили больше такого не повторится gaming ли отца но проблемы есть ее надо как-то порешать когда обнаружил где-то раньше чем это сделают клиенты или сотрудники из магазина стандартные средства мониторинга здесь не годятся потому что они меряют там любой из одной точки либо есть ли он меряет из нескольких мест он не может понять к какому углу он пришел все узлы куратора по дтп не каст раздают один и тот же адрес на котором находится наш сайт мониторит такой мониторинг хитрый все-таки нашелся значит это делает рай принцессе называется a-класс a-класс райт нет представляет из себя сеть из представляет из себя сеть из прав которые разбросанным по миру сейчас примерно 20 штук они позволяют пинговать они позволяют делать стресса вот вот видно там во втором графике что вчера вечером венгры закончился интернет по каким причинам не позволяет делать ионические хитрые штуки например о сморит где видно московская копия conrod сервера вот в этих а на местах нам это не значит нам интересно другое собственно мониторинге в этом смысле штука не бесплатно я вам надо получить такую же леску сам уже леску выдают вы расплачиваетесь электричество вместо в стойке и расплачиваетесь трафика трафик а правда немного он все укладывается в 10 мегабит и килобит значит настраиваем мониторинг мониторинг асель который нам нужен в данном случае он достаточно дорогой вот он занимает 44 процента от дневного количество баллов которое приносит 1 право право дает ссылку по которой мы получаем начинаем получать кучу ценного меха но это в том случае все хорошо нас это не интересует вас интересуют ошибки первые ошибки которые будут в промышленных количествах это проба не смогла разрезал ведь адрес а вторая ошибка которая будет вот у нас отсутствует сертификатом пустой массив это ровно то что мы искали натравливаете свой мониторинг на это пищите извините стучите в куратор эта штука была изобретена валтора год назад примерно в процессе подготовки это клада уже и райт порекомендовал что такую штуку можем пользоваться не проводники другое поднимают под клаудом вот если будут вопросы да всем привет я вам попытаюсь впарить киоты tycoon которая не очень популярная база данных но она действительно очень хорошая они я узнал лет шесть назад и но на самом деле это такой русский клуб по интересам людей которые который знает про эту базу данных ну да почему именно эта база данных но исторически шесть лет назад я провел нагрузочное тестирование это база данных победила но что сейчас получается сейчас она быстрее манга тебе подобных баз данных то есть которые сохраняют данные на диск и при этом она не требует как редис чтобы все ваши данные помещались в оперативную память потому что к примеру платить такие деньги за 32 гигабайта ну ты даже даже за 32 гигабайта оперативной памяти обычно лениво особенно если проект слой при этом стабильно работает то есть от жалоб от нее я не слышал от манга деби и слышал очень много и да она поддерживает серверные расширения ладно lua то есть основные протоколы не минимальны но вы можете делать свои расширения соответственно сравнение теста производительности это мелко примерно ну как я всегда говорю на тест производительности что они меряют ничего потому что в данном конкретном случае они показали такие результаты но соответственно я сравнил с marksman gps aerospike на моем макбуки с виртуалки они показали вот разница 20 30 процентов с киото по производительности соответственно кто использует как внезапно выяснилось основные разработчики они уже слегка подзабили на эту базу данных вот клауд флейра и о подхватила начал использовать клад флаер это крупнейший сидел который недавно хвастался что отразил там крупнейший в мире достаток ну наверное они у них нормально с нагрузками соответственно а не допилили библиотеку для подрезки для киото tycoon и сделали пост грессов render the proper чтобы и работать спускаться с данными из киото ну соответственно я использую для нашем центре пиара соответственно данных больше чем в оперативной памяти так проект мой за оперативкой платить лишних денег не хочу и соответственно очень очень много байтов такая так она на один клик из там миллионы миллионов клипы кликов пользователям не нужно сделать как минимум там около 20 ответов соответственно она работает уже около полугода никаких проблем с ней нет и в качестве бонуса если вам нужно быстро ну к примеру быстро inserted обретите пока чем покидает значения а потом для аналитики иногда нужно сделать какие-то запросы там сегрегации уже со всеми такими модными шнурками вы можете использовать после surrender оперов в котором используя пас кривые функции там мои врачи дали считать аналитику соответственно там должна быть есть мой форд френд этого пира который позволяет делать больший процент запросов чем стандартный клод флоровский но вот вот такую штуку она есть и и стоит использовать цель доклада было рассказать про базы данных про остальное можно загуглить вот что и порекомендовал ну у меня все так и бой активно развивающийся проект рано или поздно сталкивается задачей балансировки трафика собственно зачем мы это делаем ради горизонтального масштабирования где высокой доступности ради низкого времени отклика ради быстрого и к 100 обслуживания ради плавного вода из нагрузки на картинке представлена схема сферического физическая балансировки днр на dns вакууме для сайта с купаемся и воздух дата центрах и так горизонтальный масштабе масштабе о нет да до 25 api адресов на укаб ответ с доступностью да если ваш сервер смог ответить смог сбросить соединения браузер клиента тут же попытается подсоединиться к другому айпи соответствующем вашему сайту если ваш сервер тотально недоступен то часть пользователей будут испытывать проблемы в работе сайта быстрая быстрый отклик никак нет из-за несовершенства баз данных делай пи и популярности диоды с дело балансировка на dns не работает лучше выделить отдельные имена для каждой группы серверов под ваш проект что касается вывода из нагрузки сожалению клиента не ходят на прямую на наши dns игры они пользуются сами провайдера среди проводов попадается очень хорошие люди и попадаются люди которые copy paste it so стыковых full не понимая что они copy постят медленные вывод из нагрузки он да но он слишком медленными наиболее наименее стабильна и частью вашего проекта как правило является серый реализующий бизнес-логику проект может стать более стабильным если перед ним поставить этот эпоксид вот их от этого коксе может выступать индекс ваниш окси спаси господи squid если один из ваших обсерверов вышел из строя запасы будут прозрачен для пользователя при направленном другой обсе но будьте осторожны и своей практике я помню как минимум три случая когда удача сформированный запрос повторялся и джексона каждом обсе 2 и таким образом выводил из работы весь кластер в предыдущей схеме есть один существенный момент наш айпи адрес нашего сайта все еще привязана к железке если железка ломается сгорает и и заливает водой сайт становится недоступным или частицами часть еще не доступен если у нас несколько адресов dns решить эту проблему может потакал веры и или как для любителей фиби ездим айпи нашего сайта выводится в отдельную виртуальную сущность в которые которые могут обслуживать 2 балансира как правило они работают в паре и страхуют друг другом х ттп протокол как правило асимметричен и наш исходящий трафик обычно сильно жене и входящего используя api вы с в одной из конфигураций с инкапсуляции трафика в ай пи пи от балансира до об сервера можем построить схему в которые входящий трафик полу проходит через балансе исходящий трафик идет напрямую от observer что позволяет существенно повысить горизонтальную масштабируемость данного решения я видел схемы замечательной работающие с 50 s 500 синигами за балансиром стоит отметить что виайпи ты как и как требует l20 между серверами это может стать проблемой эту проблему может помочь решить потока управления пошути зации би джи пи если мы работаем с внешним миром либо успев ай би джи пи и ип черт возьми люблю это название для работы внутри собственных сетей в данном случае мы уже нет и нам уже не требуется отдельная имена для наших у психов по такому по линии вашите зации пит на ближайший силы для то пользователям ну что стопроцентного вам тайпан господа спасибо я вместо того чтобы показывать слайды меня зовут николай шадрин risen дженкса я вам покажу живую систему в действии эта система мониторинга engine xmp фай которую мы некоторое время назад выложили как публичную бед и оно доступно полностью для для вас кто-нибудь уже пробовал ее в живую эта система доступна как saas сервер но тем не менее давайте вопросы вынесем на следующий вопрос и можете можно будет задать после всей этой сессии сейчас мы просто посмотрим на то как оно работает значит как engine xampp лив ай у нас ставится мы берем и устанавливаем агенты на ту же машинку где у нас живет индекс запускаем ее сами и переключим которые у вас есть в аккаунте и дальше от агент читает конфиге engine.exe конектится к стоп статусу если он у вас настроен считает сам блок форматы разбирает лог форматы читает все ваши логе если у вас в лоб форматах какие-нибудь интересные переменные есть а именно как и какой очень хороший пример этой переменной up stream response time мы можем брать и ставить делать графики по ней и смотреть как у нас отвечает сервер вот естественно можно менять time scale это все очень хорошо если вам посчастливилось быть пользователем если вам посчастливится быть пользователем engine.exe плюс вы можете получать 100 ты напрямую вот через эту штуковину это отдельная вещь и интересную вещь которая хочу показать это костанае дашборде то есть у нас есть такие замечательные дашборде в которых можно ставить графики на любую из ваших переменных по любым вашим индексом и на графике ставить фильтр фильтр берем берет переменные из логов сам самостоятельно разбирает какие у нас существуют переменные вы можете добавлять какое-нибудь перемены с регулярным выражением и набирать какой-нибудь уже сложный запрос фильтры начинают обрабатываться как только у нас идут как только мы его ставим поэтому историю фильтр мы не можем получить можно получить только с момента как мы воссоздали и при и после интереснейшая вещь которая очень нравится нашим пользователям это анализ конфигов так как apple по и вский агент умеет читать конфиге он у нас умеет смотреть внутрь и смотреть не просто на ошибки она такие вещи как вы давать советы по без practices например вот здесь мы забыли поставить серверным и он нам говорит в каких именно сервер блоках куда нам стоит его поставить в конфиг вот здесь мы не добавили праксиса хеллер вот у нас тоже рекомендует его добавить там у нас огромное количество проверок есть которые мы очень рекомендуется прокатную прогнать ваш конфиг и посмотреть что что из него можно получить дальше это alert и но они в принципе достаточно просты и понятны и на сегодня они выдаются только по емейлу в планах чтобы они выдавались и павлов хуком по всяким другим интересным каналам вот давайте давайте вернемся вот к этой части а именно к к даже когда же бардом значит что интересно я хотела здесь отметить примеры которые нам часто задают по фильтрам которые можно здесь создавать это например как мониторить какой-то конкретный сайт если у вас за engine xm их 20 вот можно настроить мониторинг по метрикам по количеству запросов или по определенным ошибкам на определенные url и конкретно вот этот график которая вам показывал он показывает время ответа джон x1 какой-то определенный уровень именно здесь это url равный и пиаффе три порции если у нас какая-то страничка тормозит можно по ней сделать особенный специальный график далее что интересно и в эту же самую систему можно использовать если даже у вас engine x на сервере не стоит просто как простейший системный мониторинг такие вещи как диск сепию memory она может вам показывать далее из доступности системы сейчас-то работает как бета там есть ограничение на несколько десятков то ли 9 10 то ли 20-х став вы можете добавить и можно ставить смотреть насколько нам нравится здесь в углу есть прекрасная кнопкой которую можно нажать и получить ответы на ваши вопросы если что-то работает не так как вы ожидали обычно у нас в московской там зоне работает евгений которые очень оперативно отвечает на вопросы вот в общем рекомендую пользоваться ставьте смотрите и главное сообщаете нам как она вам нравится и что вам нравится и что мне нравится из чего-то не хватает спрашиваете система в активной разработке добрый вечер и так во первых хочу отметить что все о чем я буду говорить это правда без преувеличения ну начнем с того что я никакого отношения к тарантулу в принципе не имею и все о чем не буду говорить ни в коем случае не является рекламой продукта или типа того так вот цифры которые написаны в данной на данном слайде на самом деле округлены в меньшую сторону крикет так значит говорить я буду о проблемы кэширования поскольку все используют кэш в том или ином виде мы будем говорить о проблеме инвалида цей кэша поскольку проблему именование я так и не решил я постарался разобраться со а со второй проблемой и так если сохранить в кэш в принципе и ходить него это не является какой-либо сложной задачей можно поставить тупой монтаж и без проблем попытаться из него все получать поставить какой-нибудь таймаут на истечение кэша и в принципе все но не всегда это работает правда не всегда это работает корректно по логике приложения предположим что у нас есть некий объект это просто объект например это изображение в данном случае он зависит то есть у него есть ключ и он зависит от двух других сущностей например это аватарка маленькой аватарка такого это юзера которая используется в некоторых местах и она зависит собственно от самой аватарки пользователя котором загрузил и от формата в котором оно выводится то есть если меняется что то из этого то мы должны инвалиде ровать кэш бывает более сложные примеры когда этот кеш используется внутри других кашей более того используется внутри других к шее и тот же самый кэш в которых используется данный объект и инвалида вать это в реальном времени не используя x парни является практически возможным то есть ну либо это является очень сложной вычислительной задачи нужно действительно посчитать в данном случае это самый простой пример он написан на php и он очень наглядный есть функция которая генерирует этот кэш то есть она пытается достать cashis кашира случае его отсутствия она создает его при этом обратите внимание что все зависимости проставляются в момент после того как с уже создан более того эта функция уже существует приложение она в альфе она будет доступна в open source как сам cashier прилла клиент на гог толкать тарантул эпичный код так вот данная функция search постулат пост они внутри себя используют какие-либо кэше и если объекты которые там есть они будут добавлены к зависимостью к текущему кашу и далее пример с инвалида цией то есть юзер просто сменил аватарку в данном примере там числа 120 это просто означает что весь кэш которая зависит от этой аватарки например все посты и вообще любые страницы если это сайт они будут инвалиды раваны в течение 120 секунд ну и в различных режимах можно в синхронном можно в асинхронном можно как здесь в примере можно другой режим это когда ключи нас начнут перегенерировать автоматически то есть их обойдет просто специальный алгоритм после того как кожа сброшен наступает проблема все за ним приходят если каша нет то это является проблемой поскольку все начинают его перегенерировать данной ситуации все эти проблемы учтены и добавлена специальная защита защита от стада то есть то получил первые возможность его перегенерировать тот собственно этим и занимается все остальные они просто либо ждут пока и появится кэш либо использует устаревший если это допускает логика приложения собственно он может также автоматически перегенерировать кота как это работает это кластерное приложение она использует сша родирование она использует must multimaster они она использует внутри себя специальную репликацию поскольку репликация тарантула как таковая не подходит данной ситуации консистенции в данном случае что означает это означает что будет непротиворечивость если кэш действительно сброшен то ни при каких условиях он не появится нигде больше если его запрашивает соответственно узлы могут падать он автоматически ришара де руется автоматически поднимается автоматически добавляется узлы и это все работает спасибо часть меня дима зовут для тех кто пришел после мой первый докладов я решил на самой главной конференция страны а эти конференции сделать так а для нубов давайте поднимите руки кто является нубом отлично на видео и я угадал как у не половину аудиторию так вот так глаз выпутаемся то есть понимаете что такое нет чем отличается я хочу низко жизненный пример привести от видели такую картинку кто видел колол и около дома такой магазин скажите вот видите там продавщица какой у нее свой путь к не пропускная способность когда мыть один минимальным a light in si alte ничего не и хорошие то есть вы пришли по купить там сигарет молока не знаю она сразу взяла еще потому что другая картинка трупу тут виде сколько раз он большой то есть по сути ска многоядерной стенка все хорошо отпустить кластеров сказать даже встретил из абсолютно новый тон seat вот вы заходите и молоко чего знает где да то есть на обед то есть по сути систем white раза смотрите я давайте кому кому что нужно коммуну ступка можно задать несет из 3 человек пользователь программист и бизнесмен скажите нужен ли пользователю стал тут нет нет вообще по барабану к hotels материться но удержалась 20 ему отлично узнаете за то что вы цепляетесь мы не важно сколько там магазин как сколько магазине отслужить человека может как бы своего личного служит для программистов что важно программист существо не сильно отличаешься от баб рабовладельческом строе если напишу медную программы его hotels материться ясно пишу программу с низким и это счетов сами а бизнесмену что нужно а прибыль от чего от пользу прибыли не только от пользователя еще ему нужно минимизация расходов то есть чем меньше его фон купить тему согласно то есть чем быстрее один сервер обработает запрос of the знать тем меньше ему собственно нужно этих серверов и чтобы нужен ну и довольно пользователь должен они деньги при ночь найти сервера то есть единство и которыми ну не нужно путать то пользователям а дальше мы пойдем вроде как обратно величина кредита у нас 10 кусочков то есть мы здесь запросто флим получим есть ответов то есть там есть 22 до 22 секунды лет на двадцать обратной величины где ошибка но допустим мы просто шлем запросы но асинхронный не ждем ответ это у нас там как минимум несколько ядер есть он может параллельно это делать там есть какие-то блокировки поэтому то не стопроцентно такой провели за то есть нельзя равномерно число ядер и делить какие-то мьютекс и поэтому в просил он хочет и не так величин не пойми как связано и что меня сподвигло на доклад я фейсбуке одна моя коллега девушкам фейсбуке открыл для сенти рез ный факт что она не могла поверить что когда люди стоят метана левой правой стороне вот как сейчас очереди быстрее проходит быстрее люди проходят она в астане ну если идут люди они в быстрее идут логично вот как раз опросов бутылей то смотрите вот у нас очередь эскалатор и они стоят и эскалатор за одну минуту проходит вот . на эскалаторе снизу доверху соответс каждый человек проходит тест 1 1 минута для каждого человека as input примерно простите мое плохое зрение 16 человек из нас минуту до с нас минут а вот если мы сделаем вот так вот то есть люди идут по зелёнке у них по-прежнему будет еще одна минута но у медианная лет иначе будет тоже минут на самом деле тоже тех людей слива меньше у них дистанция больше но средние будет там чуть-чуть или какая перцентиль будет чуть чуть чуть пониже там меньше минуты но человек вот то есть если он конечно скоростью света идет он ее довольно шустренько не не пустая от начнет сквозь скала то ее ссылку будет ниже а именно супу то зависит насколько очередь у нас быстро кончится и последнее что хотелось как называется вот эта штука бедолаг вот это d-блок специальный think подобрался показать основная причина почему нас latency вообще говоря не является обратной величиной к супу тут даже если мы поделим слоя дирги та не блокируется но не dedok вообще любой лак на самом деле и это не блокируется и вот в этот cardin как раз пример когда вроде бы со всей стороны у нас может быть любой сон put a light in se черт знает какой спасибо а ваши ваши презентация здравствуйте это такой легкий доклад он вообще не технический и советует и воспринимать немножко юмористичный то что жим так ситуация у меня была такая дед полтора года назад помогал людям хорошим как выглядел история не знакома подходит и говорит нам помочь одной конторе который они очень сильные математики они все знают про математику и про проблему вопрос но мягко говоря не программисты надо помочь ну я говорю то что там может быть но не горит ну и рассказывать например вот такие красивой сказки что у них там все хорошо все прекрасно проходит какое то время а ну ладно это же полезный сайт это немножко про то что надо понимать знать и уметь так cicek ну вот и там как-то на это смотрели смотрели и там рассказывают что они там знают как обрабатывать временные ряды понимают там вы знаете понимают многомерное пространство доль и поперек но как-то плохо сил поэтому они попросили меня им помочь что на самом деле у них оказался сказал что-то примерно вот такого адского состояния что куча портянок ода на разных языках там питон peach писи где-то чуть-чуть lua где-то питон и все это еще как-то должно работать вот это пример сам такой очень урезанный того ужаса который у них вообще находился в кодовой базе то есть вот каким то образом папа плай ну и туда-сюда гонялся с жестким диском оперативки и мягко говоря это даже умудрились одному заказчику в холодные страны где они занимаются производством деталей для машин продать но как вы понимаете это мягко говоря не продакшен и жить этим больно больно и страшно ну у меня примерно вот такое ощущение было"
}