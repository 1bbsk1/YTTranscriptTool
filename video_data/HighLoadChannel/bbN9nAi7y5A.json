{
  "video_id": "bbN9nAi7y5A",
  "channel": "HighLoadChannel",
  "title": "Как (и зачем) переехать на архитектуру ARM в облаке? / Михаил Голубев, Дмитрий Иванов",
  "views": 776,
  "duration": 2708,
  "published": "2022-03-21T12:55:00-07:00",
  "text": "спасибо что пришли меня зовут дмитрий иванов сегодня я и мой коллега михаил голубев да всем привет я михаил с компанией ws да мы вам расскажем про процессор на архитектуру arm в облаках да сразу же вопрос почему нужно остаться и послушать наш доклад по двум причинам первое мы расскажем про такую технологию армы а также как и почему она помогает экономить а также мы расскажем про процесс перехода на технологию михаил больше расскажет про теории перехода а я расскажу как она проходила в нашей компании компании apple вы сперва что такое arm это вопрос не такой простой как может показаться потому что вот в этом мире arm там очень много таких аббревиатур который начинается с аром и дальше продолжается буковками и циферками поэтому первое arm это одноименной компании и зарегистрированный знак поэтому у нас в углу слайда буковкой r в кружочке а также arm это семейство процессор ных архитектур с сокращенным набором инструкций которые эта компания разрабатывает и и лицензирует различным другим производителям этих производителей или очень много потому что арма используется в большинстве мобильных устройств таких как планшет и смартфон и а также телевизоры ну а теперь еще и облака и надо сказать что в процессе это докладов мы будем рассказывать про архитектуру который называется арам 64 она же от 64 она же арам в 82 пару слов про компания так как про idps вы скорее всего уже слышали компания занимается построением эксплуатации платформ для онлайн над гардой zynga для интернет рекламы частности мы использовать такую технологию который называется all time bidding rtb это такой вид рекламы в интернете где решение о том какую на рекламку показать пользователю она применим применяется в момент захода пользователя на страничку в процессе аукцион понятно что эти аукцион должны происходить очень быстро у нас этих аукционов очень много поэтому у нас самый настоящий hallowed и поэтому мы тратим много очень-очень и денег на нашу инфраструктуру и именно из-за этого мы взялись за этот проект потому что оптимизация затрат на нашу инфраструктуру это для нас какой-то постоянный процесс мы постоянно ищем как бы нам по меньше денег платить а также мы верим что у технологии orm и все получится так как в прошлом году они начали свое движение в сторону десктопов и ноутбуков пользователей и скорее всего эта технология будет в тренде следующие десятилетия для пилотного проекта миграции nor мы выбрали одно приложение я про него еще не сказал но я могу его описать его особенности это вот она обслуживает тот самый real time bidding трафик его можно представить как обычный reverse proxy то есть она принимает тысячи теперь запросы отправляют написаны нагло вследствие того что она работает с rtb она испытывает так называемые дневные нагрузки то есть ночью минимальное количество запросов днем она начинает расти вечером больше всего и так повторяется и она за тепло и нам нескольких регионах да а теперь михаил ты как-то хорошо стоишь на сцене уж не сил или гравитона тебя к ней притягивает ну гравитон безусловно находится в облаке но давайте вообще я расскажу что это такое на самом деле немножко шаг назад дмитрий сейчас рассказала про архитектуру arm но сразу возникает вопрос как вообще связано армии ws что такое вот это страшное слово гравитон про которое мы говорим и как все это использовать опять же возможно многие кто пришел на сессию уже работали за это был с но если нет то немножко такой общей картинки как все это работает в это будет я сервис который называется amazon найти ту это сервис который используется для запуска виртуальных машин в облаке соответственно в и ситу вы можете выбрать instance то есть ту самую виртуальную машину и мы думаем что чем больше выбор тем лучше потому что вы сможете подобрать instance который подходит к вашему приложению соответственно будет какая-то оптимальная производительность при минимальных затратах и сейчас уже есть больше 400 типов инстансов мы постоянно добавляем новые и естественно возникает вопрос как вообще выбрать правильный instance как выбрать виртуальную машину которая подойдет вам здесь есть несколько моментов во первых безусловно есть инструменты которые помогают с каким выбором один из таких инструментов называется из вид уинстон селектор он доступен на гитхабе но в целом если смотреть на подход первое что нужно понять это нужно понять и тип вашего приложения то есть каким ресурсам приложения наиболее требовательные после этого собственно понять количество этих ресурсов которые вам нужно ну и затем выбрать какие-то дополнительные опции например если вы работаете с машинным обучением с графикой возможно подключение каких-то дополнительных вова печей и один из таких выборов которые вам нужно сделать при подборе инстанция это выбор процессора сейчас у нас есть три основных вида процессоров это процессор от компании intel на них мне кажется основывается большинство инстансов далее если вы хотите использовать архитектуру x86 64 но чуть более экономно вы можете выбрать инстанции на процессорах от компании мне и наконец самое новое добавление это инстанции на процессорах от самой компанией ws который мы разработали сами и как раз в таком мыслить о таком процессоре мы хотели сегодня поговорить он называется это был с гравитон на самом деле первое поколение этих процессоров вышла еще в 2018 году на них основывается инстанции который называется один их все еще можно использовать но в конце девятнадцатого года мы анонсировали второе поколение процессоров соответственно как несложно понять называется гравитон 2 гравитон 2 в 4 раза больше виртуальных степью примерно в семь раз выше производительность по сравнению с первым поколением то есть производительность на каждой виси пью примерно в два раза выше они основываются как раз на тех самых ядрах от компании arm hydra называется армия берс n1 мы работали вместе с инженерами arm над созданием этих я тёр и их основные особенности не создана как раз для запуска виртуальных машин в облаке на самом деле я не буду сейчас рассказывать много о том как все это устроено и какие то особенности этих ядер но один важный момент который я хотел упомянуть если вы работали уже с и ситу все-таки то есть если вы знаете разные наши инстанции то знаете что часто вести пью включает себя гипертрейдинг случае же гравитон 2 каждый виртуальность и пью это отдельное физическое ядро и все это замечательно то есть у нас есть архитектура arm на этой архитектуре созданный процессоры гравитон но процессоры напрямую использовать не может нам нужно выбрать какой-то intensity процессорами и как раз вот здесь на слайде я привел несколько примеров таких инстансов это неполный список но я думаю в принципе уже видна общая особенность что у них у всех после номера серии идет буква g достаточно просто в полном списке найти грабит он это instance или с каким-то другим процессом одна общая особенность почему собственно про это рассказываем сегодня это улучшенная цена производительность у инстанцию на базе гравитон 2 здесь я привел цифру до сорока процентов но на самом деле это безусловно зависит от приложения и от паттерна использования этого приложения то есть например какие-то из замеров которые мы делали самостоятельно то есть до сорока процентов и такая общая нагрузка в случае ардис запуска окон собственных баз данных то есть паз грех мой сиквел оправа производительность получилось цена производительность получилось примерно на пятьдесят два процента выше случае аврора это наша база данных который мы разрабатываем вы ws примерно на 35 процентов случае elasticache то есть это рейтинг hd где-то примерно 45 процентов и вот здесь я хотел немножко подробнее рассказать про производительность потому что мы можем приводить какие-то интересные цифры безусловно но важно эти цифры чем-то подкрепить какими-то данными и первый тест производительности это speck speck это стандартный тест производительности вести пью который используется в индустрии мы взяли версию от 2017 года потому что я уже несколько лет она достаточно стабильная и собственно на этой версии мы как раз и сравнивали разные инстанции которые есть в и ws успех написано на си си плюс плюс и фортран и запускаются одновременно на всех виртуальных сепию они состоят из двух частей то есть это тест с целыми числами это какие-то бенчмарки на первую компиляция кода на джесси построения маршрутов и другие и вторая часть это операций с плавающей точкой здесь различные физические симуляции трассировка лучей предсказания погоды и так далее и что мы получили здесь я показываю сравнение m5 и m6 джин что было понятно м 5 таинством с текущего поколения на архитектуре x86 x64 ну а им секс-джихад я сказал это как раз вот те самые instance на гравитон их если мы возьмем производительность м 5 а сто процентов то по нашим тестом получилось что у гравитонов например на на 44 процента выше производительность в операции с целыми числами и примерно на 24 процента выше в операциях с плавающей точкой ну и синтетические тесты это безусловно интересно но интереснее посмотреть все таки на какие-то настоящие приложения у нас на сайте w6 много постов каких-то статей от наших партнеров где сравнивается производительность для разных инструментов здесь я показываю результат memcache днк жди и таки блю хранил к она часто используется вместе с базой данных в качестве такого каширу ющего слоя чтобы уменьшить время ответа для пользователей и что мы сделали мы запустили memcache d соответственно на инстансах тех же самых и 5 и на инстанции м6 джин и после этого мы начали с двух других инстансов которые находились в той же подсети просто бомбить его запросами и еще стоял 3 instance который измерял выйти то есть задержку в ответе отметка жди что получилось во первых по пропускной способности у гравитонов получилось примерно на 43 процента выше по сравнению с инстанциями m5 но все-таки мы говорим про каширование в кэширование пропускная способность это наверное не самый важный параметр гораздо важнее время ответа то есть то самое или tense и здесь вот на правом график можно увидеть синяя линия это время ответа для гравитонов но тоже получилось ниже в принципе при различной пропускной способности и еще одна такая интересная особенность как в принципе процессоров на архитектуре arm так и безусловно гравитон 2 в частности это энергоэффективностью сразу возникает вопрос а зачем нам эта информация но прекрасное энергоэффективное не и что с этим делать а важна эта информация потому что во первых так как это был из тратит меньше денег на электроэнергию соответственно и цены на сами инстанции для наших заказчиков будут ниже то есть вы можете посмотреть в прайс-лист а цены на группе тон ниже чем инстанции текущего поколения на x86 и 2 сейчас достаточно часто говорят об изменениях климата к этому вопросу можно относиться безусловно по разному но я думаю все наверное согласятся что если выбрасывать меньше углекислого газа это будет хорошо с этим тоже помогает энергоэффективности дмитрий можешь рассказать что было у вас в компании под web какие результаты вы получили да мы тоже провели тесты производительности и в нашем случае производительность полезной работы отношения полезной работы к одному миссию оказалось сравнимы с инстансами на x86 над сказать что я говорю про производительность относительно одного вести пью потому что у инстансов на x86 и arm у них может быть разное количество этих лиц и пью но учитывая таинственно arm они дешевле получается что переход норманны к экономически оправдан михаил может и тогда расскажу как перейти на arm хотя бы в теории да давай я расскажу про теорию а тогда потом ты расскажешь как в эту теорию применили на практике первое вообще переход на arm состоит из двух основных шагов первый шаг но это безусловно составить инвентарь того что у вас вообще используется то есть найти все зависимости вашего приложения в первую очередь это конечно библиотеки то есть это как какие-то стандартные библиотеки языка какие-то окон source на библиотеки которые вы используете возможно проприетарной библиотеки конечно не забыть что одни библиотеки могут использовать другие в общем составить полный список кроме этого посмотреть какие-то другие инструменты продакшене возможно агенты для мониторинга агенты для логин га какие-то bizarre инструменты для безопасности после того как мы составили полный список всех таких зависимостей нужно проверить собственно работают ли они на ram 64 здесь несколько моментов 1 я думаю имеет смысл просто зайти на сайт соответствующего инструмента посмотреть если такая сборка или может если инструмент архитектурный независимый то все еще лучше если такой информации нет то есть если arm не поддерживается пока что я очень рекомендую писать и вендору и пообщаться с ними потому что как дмитрий сказал он сейчас в принципе идет таким быстрыми шагами по миру и у многих вендоров уже есть поддержка его где-то в рот mapi есть можно у них попробовать узнать насколько быстро не планирует это выпустить если не получается найти можете написать архитектору в дпс например я работы архитектора моей таблице в принципе любой у кого есть аккаунт у вас есть архитектор даже если вы не знаете этого человека можно зайти на сайт переключиться на русский язык и выбрать опцию связаться с нами и вам обязательно ответят если вы не хотите искать архитектора вот здесь еще есть email адрес это email адрес прям нашей команды гравитон то есть тех самых людей которые эти процессоры разрабатывали можно им отправлять фидбэк в принципе мы рады любым отзывам и посмотрим на примере собственно какие на что обратить внимание наверное самая базовая конечно операционная система многие операционной системы apm поддерживают достаточно выбрать образ то есть они в терминологии и ситу и собственно на этом все важно исключение это windows server если ваше приложение пока что работает только на windows перенести его никакой возможности с ней нет то к сожалению пока что его запустить arm не получится и какие то другие инструменты на самом деле понятно что инструментов может быть очень много здесь я не смогу привести полный список но вот несколько примеров наверно такие достаточно популярных решений я здесь указал то есть это какие-то open source на базы данных которые уже поддерживают армы это инструменты для конфигурации мониторинга какие-то системы безопасности себя сиди системы но как я сказал список неполный поэтому имеет смысл смотреть на сайте разработчика все хорошо с инструментами определились проверили возникает логичный вопрос все-таки мы здесь на hail audi наверное многие из нас или пишут или поддерживают какое-то собственное приложение что делать с ним здесь есть несколько вариантов первое это если ваше приложение использует интерпретируемым язык программирования большинстве случаев перенос тогда будет супер простой то есть вам достаточно просто взять новый instance соответствующим образом установить соответствующую сборку интерпретатора и все должно работать но есть важный момент стоит опять же вспомнить по началу первого шага смотреть на библиотеки особенно важно в случае питоны java у них это очень часто встречается что может быть какая-то библиотека которая собирается только под определенную архитектуру второй вариант если вы используете компилируем язык программирования но я думаю здесь очевидно нужно пересобрать приложение вот архитектуру arm 64 многие инструменты это был с гравитон 2 поддерживает из коробки то есть какие инструменты часто заказчики когда работают сервисами ws используют какие-то из детей используют инструменты командной строки используют какие-то инструмент командной строки для специфичных сервисов большинство из них также поддерживает он по из коробки единственный важный момент нужно брать последнюю версию и наконец управляемые сервисы то что имею ввиду здесь это какие-то сервисы когда вы запускаете не просто виртуальные машины а например вы запускаете управляемую базу данных тот же сервис amazon rds или вы запускаете рейде смерти в сервисе elasticache или какие-то аналитические нагрузки в и мари многие такие сервисы тоже поддерживать гравитон 2 здесь я не стал приводить список потому что на самом деле постоянно добавляется новая поддержка я думаю если бы я указал здесь на слайде они бы уже наверное завтра стали устаревшими поэтому что имеет смысл сделать стоит зайти на сайт это псы прям в разделе прайс инга посмотреть если вот там те самые инстанции с буквой g и я думаю многие сейчас упакуют приложение в контейнеры docker пожалуй самые такое популярное решение и хорошей новости докер поддерживает безусловно архитектура bc4 важный момент когда вы собираете ваш образ вы собираете его под определенную архитектуру соответственно есть несколько выборов первые вы можете забирать его прямо подарок 64 полностью переехать но многие все таки боятся сразу сделать вот такой резкий переход и собирают образы сразу под несколько архитектуру у докера это называется мульти арк образы и вы можете их собираетесь либо с помощью плагина buildex либо вы можете вот кстати здесь как раз ссылка на блог компания где они показывают как этот сам buildex использовать либо второй вариант можно просто в вашем соседи пайкой не сделать две параллельные сборки под разной архитектуры после того как сборка заканчивается ну просто создать манифест вот этот сам мульти арка манифест и по поводу сервисов и ws для контейнеров сервис и her который используется для хранения образов безусловно поддерживать мульти арк но я думаю понятно что docker hub мульти арк тоже поддерживает и в регистрации у нас есть 2 основных сервиса это исчез для артист рации просто докер-контейнер of наш сервис и amazon и кейс который используется для запуска cabernet из они также поддерживают архитектуру arm и в том числе поддерживать смешанные кластер вот то есть тот самый случай про который я сказал когда вы боитесь сразу переключить весь стек и хотите чтобы часть нот в вашем кластере были на одной архитектуре часть на другой такой тоже можно сделать после того как мы определились с инструментами поняли что все у нас поддерживается на архитектуре arm 64 или узнали когда она начнет поддерживаться второй шаг но я думаю понятно что тестирование тестирование это один из самых важных моментов особенно важно если вы используете компилируемый язык программирования скорее всего вам тоже понадобится создать какие-то новые тесты ну и в принципе здесь каких-то особых рекомендаций нет имеет смысл тестировать все то есть это и стандартные unit тесты и интеграционное тестирование и acceptance тесты в принципе протестировать оттуда протестировали теперь нужно все это как-то развернуть мне кажется уже почти все наверное перешли на инфраструктуру как а то если не пережили то очень хотят это сделать в инфраструктуре как от все достаточно просто то есть это инструменты клад formations и детей или например тира for нужно обновить несколько параметров обычно это тип инстанция то есть выбрать вот тот самый instance буквой g после этого нужно поменять образ то есть они потому что как я сказал образ операционных систем для разных архитектур имеет разные айтишники и затем обновить юзер тату easy to the это пользовательские данные то есть это такой скрипт который запускается при старте вашего инстанса то есть обычно он не зависит от архитектуры но если вы где то там ее за hard ходили то безусловно стоит это поменять создали новый стек теперь нужно как-то на него переключить наших пользователей я бы рекомендовал использовать в люблен подход то есть стандартный подход когда у нас есть два стакана стоят по соседству друг с другом и мы как-то начинаем переключать трафик с одного на другой можно делать вручную но лучше естественно через все сидим в автоматическом режиме и конечно не забывать про мониторинг при этом каких-то специфических параметров которые нужно мониторить для гравитонов нет то есть ну просто следите за стандартными метриками вашего инстанса за какими-то критичными метриками вашего приложения до того как вы переключите весь трафик то есть переключать сразу сто процентов трафика наверное не стоит и безусловно у нас здесь всего 30 40 минут по моему во поэтому все полезные советы я не расскажу и я вот здесь привел ссылку на это был лес гравитон кайтен started это инструкции в которых есть как шаги по началу перехода на гравитоны так и какие-то полезные советы когда вы уже перешли как можно оптимизировать ваше приложение под архитектуру arm и эти инструкции они созданы самой командой гравитон то есть как я сказал вот те самые люди которые разрабатывали эти процессоры помимо всего прочего они делали много комментов разные вотан собственные приложения и у них достаточно много опыта по оптимизации для архитектура в качестве одного из примеров хотел сказать например печки очень много комментов от инженеров amazon было в печке 74 и у него производительность где-то на 37 процентов выше норман по сравнению с предыдущей версии 8 говорят даже еще больше будет но честно не тестировал пока что да я по этой ссылке тоже ходил вот всем рекомендую что мне там понравилось то когда то что там содержится именно практический опыт для различных программ и систем дайте при давайте я расскажу про наш опыт в компании б как мы приносили то самое приложение про которые я говорил лучшим в нашем случае переход составил примерно из трех этапов то есть первым надо было собрать приложения и протестировать его производительность это мы уже обсудили второе нужно было перенести всю остальную инфраструктуру которая вертится вокруг этого приложения это компоненты deployment мониторинга сборки логов метрик ну и третье нужно очевидно поднять нова кластер переключить на него трафик и сделать это как-то аккуратно и и потом смотреть что все работаю первый шаг поскольку приложение написано 1 то здесь все достаточно просто мы просто меняем целевую архитектуру и собираем приложение здесь все все просто второе добавление поддержки остальных средств здесь не все так очевидно поэтому мы двигались от обратного вот михаил рассказывал что часть перенесена часть нет поэтому я делал как я поднимал новый incense который как бы как стандартные для этого приложения только он нарам дальше рано или поздно я натыкался на какую-нибудь проблему чего то не хватало мне не хватает какого-то пакеты или какая команда не работает значит дать дальше я искал кого-нибудь кто это почти нет дали подчинился мысли никого не нашел и переходил к следующей такой проблеме и повторял до тех пор пока про все проблемы исчезли на что как бы мы обратили внимание несколько примеров просто для пример для обзора количество работы которые можно представить как 1 мы используем ubuntu и у нас есть свои собственные зеркала репозитория ubuntu и естественно что на них нужно тоже добавить репозиторий для arm 64 здесь все достаточно просто единственное что адреса репозиториев для arm отличаются второе мы все еще пользуемся системой управления конфигурация который называется popped некстати сказали что я могу воспользоваться своим положением скажите кто не пользуется попила давайте я подниму руку вот раз два несколько рук мы с вами как амурский тигр поэтому это специально для вас сам баббит написан на ruby но у него есть различные бинарные части такие как фактор это система которая собирает фактах хостел и поэтому ее тоже нужно переносить в момент когда мы переходили папито от компании 25 labs для arma не было поэтому мы перешли на паппет который сборки от компании ubuntu от от ubuntu вот он скорее но на наш кодовой базе работает и в качестве долговременное решение по петлям мы уже собрали далее сборка debian пакетов когда вот поддержки находится всего одна архитектура то так с такими проблемами не сталкиваешься с с какими проблемами столкнулись мы первое это когда какой-то интерпретируемый код так написано и например на python не был запакован в пакет у которого написано что он для архитектур amd64 здесь как бы все просто нужно в contra файле депозитарную пакета поправить что он для архитектуры all и такой пакет тоже будет работать на армен 2 это обратная ситуация когда код который нужно компилировать он собран пакет скомпилированный собрав пакету который указывал такой вот надо запаковать в пакет у которого в contra файле but написано архитектура и не и она будет собрана в родную архитектуру для arma ii для amd64 соответственно и 3 интересным случаем связан с тем что мы нашли плагин для системы сборки метрик который был написан нами но от которой исходный код задам если лет потерялся все в порядке не переживайте исходный код нашли есть бэкапов но как бы вот этот случай заставляет задуматься если у нас исходный код от всех которые программ которые написали мы вот но могли потерять его и переключением здесь представлена упрощенная схема понятно что переключать трафик нужно как-то аккуратно то есть поднять энтин сканере аккуратно поднять поднять новый кластеров аккуратно переключить часть трафика но в общем упрощенном это выглядит как поднять новый кастер переключить трафик dns выключить старый кластер если все в порядке наблюдать и в общем то все хорошо или не все хорошо а произошло вот что после того как мы переключили трафик раз несколько дней incense на армии начали испытывать подобный керну loops в момент high times а то есть всего кластеров несколько десятков машин 1 год начала так падать потом подавал другая и так продолжалось и что же делать 1 ну естественно что нужно сделать это поискать решение что мы сделали мы поискали решение проблем в интернете а также попытались обновить все пакеты и ядро надежды что это поможет когда это и конечно же не помогло мы обратились в и ws они попросили нас собрать какую-то информацию частности мы включили систем который взывает окей дам кто не в курсе что такое кейдан вот тоже несколько рук давайте я расскажу что кей дампы это система которая вроде как кернел дамп она собирает dom pedro во время падения основного ядра как она работает при загрузке ядра linux загружается еще одно ядро в специальную область памяти и ему передается управление когда основное ядро падает вот происходит паника или вот подобный упс дальше то ядро который загрузилась она снимает нам памяти и перезагружается что очень неудобно потому что вы получается что машины выпадает там на несколько минут сохранять свой дам сейчас она может это делать по сети и и возвращается обратно также мы конечно же попытались воспроизвести проблему на тестовом стенде но у нас не получилось но вот у кого получилось это у рыб с получился их михаил получилось но тоже далеко не сразу что мы попытались сделать вначале мы взяли дам который нам прислал дмитрий и стали его смотреть стали пытаться понять какие вообще какие-то идеи сгенерировать как вообще такое могло произойти и по этим идеям стали писать тесты но ни к чему это не привело потом опять же дмитрий нам прислал образец исходного кода приложения фнб мы попытались воспроизвести проблему на нем но я думаю всем очевидно смотрим на шаг 5 почему айкан веб не получилось у нас бы получилось в принципе тоже ни к чему не привел потом мы не отчаялись мы решили просто написать какой-то рандомный тест который вызывает просто случайная операции на file descriptor ах и пол тоже никак последний что мы сделали мы написали sockets сервер на самом деле супер простой соки сервер в котором который принимает подключения и использует и пол для того чтобы их складывать в этом соке сервере мы использовали event полсе с дополнительным де важным выводам и потом просто ли бомбить его запросами с клиента мы это делали совместно с инженерами из компании arm и свяжу я вечером наслаждаюсь прекрасным вечером после работы и тут приходит сообщение что наконец-то проблема повторилась как раз у коллег изар где-то после этого наверное в течение пары дней проблемы повторялось раз-два в день после этого мы придумали еще включить лог torture на е3 и проблема стала воспроизводиться но наверно примерно каждый час поймали ну по крайне мере мы думаем что мы поймали после этого после того как мы понимали проблему наши инженеры из компании из команды гравитон на выпустили для нее патч соответственно этот патч отправили в список рассылки ядра его приняли причем интересный момент то что этот патч на самом деле он не специфичен для архитектура arm то есть это почти как для архитектуры x86 так и для архитектуры arm то есть просто на x 864 он вас призвать на такая проблема воспроизводилась реже чем на рамах пофиксили для обеих архитектур вышла новая версия ядра скинули эту версию дмитрию но и сталина все что на ждать потому что ну мы думали что это та самая проблема но стопроцентной уверенности у нас в этом не было дмитрий давай развеять тайну получилось пофиксить или нет получилось именно поэтому я считаю что это слайд это лучший слайд нашей презентации да и подводя итоги что хотелось бы сказать что в нашем случае для кластер а приложения про который я говорил миграция на рм позволило сэкономить 20 процентов intenso на 20 процентов бюджета на инстансы а также то как мы совместно с idps починили проблему позволило сделать мир чуточку лучше ну иммиграция в нашей компании продолжается в данный момент мы выбираем как следующего кандидата на миграцию у нас все задавайте вопросы вот если мы накатить вопросам спасибо если мы не успели на какие-то вопросы ответить там и сегодняшнем в течение дня будем а также на сайте должны быть наши контакты можно до спрашивать да отлично спасибо за доклад вы ничего про лоджик мне рассказали как же такой план выплат как там с perform как там с орлом да но это не по вашей части да я я понял ваш вопрос спасибо вот это приложен про который я рассказывал там нет logic она на go написана она там нет лучшего вот с ним все в порядке но logic нормаль перевезли получилось в данный момент нет мы не приносили лоджик насколько мне известно вот тот logic pro которого говорите он сейчас доступен на гитхабе и по моему его компания apple уже не поддерживает то есть он уже живет своей жизнью ok это ловил называется верно да ну вот давайте озвучим чтобы было понятно спасибо за доклад меня зовут георгий у меня будет два вопроса один вопрос к михаилу один вопрос дмитрию и вопросах михаила будет касаться в первую часть презентации провели результаты бенчмарков x86 инсов против гравитон инстансов ну против organs of и там коварно с очень большим перевесом выигрывает и вопрос насколько это benchmark вообще репрезентативные когда дело касается каких-то вещей которые специфичны для x86 ну вот например там расширение к инструкции для сим и все вот такого то есть это но этот мяч марку ночью как-то учитывал потому что это ну не какая-то вещь ну я спрошу потому что мы там числу дробилка мы занимаемся но это там люди с помощью сент инструкции там и json и парси от вот приколочу например эти индексы то есть вид овечка это не специфичной там для вычислений до на самом деле спасибо за вопрос здесь есть несколько моментов во первых действительно ну вот как я сказал синтетический тест но не скорее наверное я их привел для понимания такой общей картинки целом результаты зависит ну вот то есть как метро сказала в iphone б у них производительность примерно получается один к одному то есть выигрыш чисто за счет цены я сам тестировал с коллегой у нас вот два человека нам очень понравились гравитон мы сами тоже тестировали много приложений не только наша команда разработки вот кстати про cliff house я как раз кликнул тестировал у меня получились достаточно интересные результаты я не хотел их говорить здесь на конференции потому что они меня даже самого испугали я несколько раз перепроверял получилось что на тестах яндекс метрики результаты гравитон надо то сайте яндекс метрики результаты гравитон получились где-то ну примерно процентов на 10 лучше чем на аналогичных инстанциях из 100 x 864 а на результатах new york taxi надо взять у нее arctic sea я тестил там получилось два раза выше вот меня это испугало честно я пытался вот понять как такое происходит я не докопался до сути но вот вроде коллег призвал мы все метрики посмотрели вроде проблем в тестах моих не было вот но безусловно то есть опять же возвращаясь к вопросу это зависит от приложения то есть один такой интересный момент которая заметил своих тестах это то что особых хороший выигрыш скажем так идет при идет приложение с высокой параллельной нагрузкой вот соответственно если у вас ну где-то средненькая нагрузка но наверное выигрыша только вот выигрыш в цене будет выигрыша производительность не получится но я думаю в целом весь смысл этот вопрос как то глубже обсудить то есть в принципе можно написать мне можно как я сказал нас на сайте есть там сравнение на столе для достаточно большого количества инструментов но и уже посмотреть подробнее понятно спасибо и второй вопрос тогда представитель open web вот по части портирование вопрос такой композитный первое это вот вы сказали что вы получили ну такой абсолютной валью это уменьшение стоимости на облака там и даст процентов но при этом решении каких-то достаточно тривиальных проблем то есть по запуску по пересборки и запуска приложений ну пришлось подключать для этого инженеров и зарабатывается разработчиков архитектуры оригинальные вы считаете что это 3d фон ну это вопрос без предстанете что это ну адекватны или thread'ов получается и 2 повторяющиеся вопросы то что пару лет назад еще один используется высказывался на счет применения арма в севера и вот основная проблема насущная проблема как раз таки армов это то что люди не хотят деплоить продакшен туда ну короче не хотят тепло из на архитектура отличную от своей домашней архитектуры ну не буквально то что они там разрабатывают на x86 и плоть нам приходится вот как вы с этим вот да я понял что что вы спрашиваете спасибо про трейдов ну естественно что мы оценивали и в нашем случае мы посчитали что нам нам это имеет смысл также вот я там начале говорил что кроме того что мы сэкономим денег мы также верим что это редкая по технологии она будет в тренде про него будет на конференциях рассказывает на сайтах писать вот поэтому это какая-то в том числе может быть расценена как инвестиция в будущее но выстрелит она или нет это да вы правы тут вопрос дискуссионный надеюсь ответил если нет да спасибо здравствуйте спасибо за доклад вопрос был такой какие прикладные задачи вы решаете с помощью арман для таких сервисов и используйте его да так это ко мне да вопрос мы используем мы мы занимаемся онлайн invert 1 gom то есть интернет рекламы и наше приложение про который рассказывал она обслуживает торте ветровка real time bidding то есть но по сути и как я говорил это как reverse proxy то есть она принимает запросы почти тебе отправляют там на бренды на сайте больше наработать сетью нежели с дисками лично не совсем там сеть там за действом достаточно хорошо на большую часть она опирается в цепью поэтому у нас там будешь большой кластер нескольких регионах развернутых и ещё хотел спросить про остальных вендоров помимо помимо арма есть еще инструкция по моему арка на других чипов от intel и и от md тоже ввс михаил я сейчас просто очень удивился ну то есть безусловно есть то есть насколько знание станции на arm архитектуре есть только от это был с в нашем счету инстансов то есть инстанцию на intel и но они тоже до 10 меня насколько знаю коллеги их тоже используют да это правда коллеги спасибо больше кого привел два вопроса один кмв был второй к на зону коллега привод из ммвб подскажите пожалуйста какая команда работала над переводом и сколько времени заняло большую часть большую часть перехода сделал я это за него у меня 3 месяца но там еще был новый год соответственно минус 2 недели прекрасно я не только этим занимался явно этими равно и вопрос кама зону я немножко знаю экономику любого железо я знаю что условно стоимость электричества это примерно 80 процентов от стоимости вообще в принципе вот всего того за что мы платим в дата-центрах вы показывали что энергоэффективность arm архитектуры в три с половиной раза выше чем энергоэффективность классической intel архитектуры а почему тогда стоимость всего на 20 процентов ниже боюсь я на этот вопрос не смогу ответить потому что не я эту цену делал честно вот но спасибо за вопрос да я думаю попробую коллег узнать но вот так сходу я не отвечу то есть но я думаю в любом случае стоит понимать что эта разработка процессоров то есть это тоже какие-то рэнди инвестиций которые и ws вкладывает и постоянной выкатка новых фич то есть что но это тоже не бесплатно происходит сила но честно на сто процентов не смогу ответить да спасибо за доклад у меня вопрос следующий понятно что прямо сейчас не все приложения на x86 архитектуре и можно легко так перевести по даром парным по различным причинам собственно компании apple решает эту проблему с помощью эмулятора розетта и вот даже в эмуляторе многие приложения они работают быстрее на армия чем на x86 собственно вопрос планируют ли компания amazon какое-то свое решение предоставляет похоже эмулятор или вообще может бик-бик тихий есть какой-то тренд может есть какие там ну road map такому комнаты решению general я вообще одну чтобы люди могли переходить там на арму быстрее и проще было до к сожалению по поводу планов я не смогу подсказать то есть у нас сейчас наша основная работа по поводу вот перехода на архитектуру arm она направлена скорее на такую грубо говоря образовательную деятельность у нас сейчас например идет гравитон челлендж то есть на нашем сайте можно почитать правило то есть основная идея это такой грубо говоря хакатон перенести приложения на гравитон и там всякие разные призы поездками и reinvented и тогда у нас в основу в эту область идет на безусловно мы также занимаемся то есть с какими-то другими активностями вот например тот же самый getjar про который я говорил здесь вот различные оптимизации и наверное третий поток этого то что наши инженеры помогают scary но сама окон собственных инструментов то есть вот все эти коммиты которым видео ли то есть там были кометы в мангу ну и вот понятной и в ядро и в печке то есть вот наверное вот это основные моменты вот про такой инструмент который прям поможет с приходом если честно я не знаю у меня вопрос кама зону если поддержка сент эти гравитонов неон или что то типа такого и второй вопрос остается ли вообще что-то в перспективе какая-то миша за x86 если расходы энергии и меньше и так далее или эта новость есть проблема только вот кто не смог квартиру ваться тот остается остальные все переедут со временем по поводу первого просо сейчас я даже дали стою пока я листаю по поводу второго вопроса на самом деле мы в компании это был west но мы считаем что в принципе будущее есть за всеми архитектурами вот и то есть идея в том что например если посмотреть в августе мы выпустили новые инстанции на на intel вот то есть мы будем продолжать и дальше использовать и intel inde то есть мы не заставляем никого переходить вот на рм и его ценится за зоар маме будущее вот ну то есть мне кажется будут развиваться все имеет смысл то есть смотреть по по каждой рабочей нагрузки то есть в первый шаг и у меняют дмитрий это был все-таки квач парк посмотреть вообще как как работает ваше приложение вот smt вот отсутствует еще вопросы рост назад алексей судя по графику время ответа у arm выше чем у intel случае с ним cached изучали вопрос то есть удалось понять почему то есть проблема софт варна и и какого уровня то есть софт как приложение лесов как ядра или это проблема именно тура процессора вот сейчас просто очень удивился потому что вот результат который показывал я время ответа на арма хоть ниже наоборот то есть вот здесь лишь выше это больше чем ниже линии тем меньшее время ответа вот поэтому честно я вот именно вот этот бенчмарк с memcache где я знаю достаточно в таких в общих деталях и насколько я знаю у нас на сайте он не опубликован то есть детально как это исследование проводилось но коллеги из из компании arm у них в блоге прям есть статья где они тестировали с использованием мем тир на самом деле результат и даже получились лучше чем у нас они использовали немножко другие инстанции не 5 а r5 и r6 вот можно у них посмотреть как как именно это проходило и чуть больше деталей узнать поэтому если в google и бить мин каждый arm там одна из первых ссылок перед если у нас еще вопросы в зале пока мы пытаемся понять если у нас вопрос я бы даже маленькие у меня есть вопрос наверное ко всем коллеги а кто-нибудь вот и здесь собравшихся кроме нашего замечательного докладчика пробовала уже arm и железные или в облаках мы есть прикольно может быть у нас line есть вопрос ну как будто бы нету если вдруг кто-нибудь стесняется ловить потом спикеров а нет вот у нас появился вопрос могу врать или спасибо за доклад вы не могли бы отмотать еще раз на графе chicks ммк вот вот он меня смущает тем сейчас я что этот кривая man каждый она действительно ближе прижимается да но время насыщения получается когда ну вот saas-сервис она достигается быстрее чем на and аллахом это наверное значит только то что приложение будет себя по другому вести и к этому надо готовиться ну собственно вот безусловно мне кажется это даже наверное не вопрос это комментарии да я соглашусь все так вот но я думаю здесь в принципе на этом графике можно увидеть еще то что изначально говорил при ответе на вопрос по производительности что на более высоких нагрузках производительность на арбах на гравитонов получается ну вот как раз выигрыш он он больше идет на более высоких нагрузках в принципе на графике это тоже можно заметить но так сам да согласен"
}