{
  "video_id": "Kt2AWG-NChE",
  "channel": "HighLoadChannel",
  "title": "Современные методы построения платформы мониторинга / Илья Петропавловский (VK, VK Cloud)",
  "views": 308,
  "duration": 1762,
  "published": "2024-10-29T03:05:54-07:00",
  "text": "Всем привет краткий дисклеймер про что это доклад сразу ребят скажу архитектуры системы я буду касаться местами очень косвенно в основном доклад у меня про то как не сжечь команду когда мы бежим с сумасшедшей скоростью при создании очень сложной системы платного мониторинга сонно я буду про Люде про Команду профило разработки собственно чем я занимаюсь в рамках ВК Cloud я руковожу портфелем продуктов мониторинга артин логирования дрессировки Да и удивительным образом немножко такой псевдо cm системы по сбору сообщений больше 10 лет я занимаюсь Прай проектами соответственно хотел от этого немножко отдохнуть пошл в ВК думал будет классно облако лити вот это вот значит гибкая разработка вот после чего компания ВК принимает жёсткую цель и свою стратегию это идти в Прай сегмент это то что облако должно быть полностью чуждается продуктом on prem для Enterprise людей я такой ну ну ок как бы Ладно вернулся туда откуда ул но ничего для меня нового см для ряда коллег это была шоковая терапия собственно из облако в рй что я под этим подразумеваю что у нас есть жёсткий план релизов что у нас обязательно протестировано решение оно отказу устойчивое оно соответствует мировым стандартам вот это вот всё да у нас максимально описанная документация ребят Ну к сожалению да то есть вариант что мы из уст Уста тут уже не прокатывает Потому что эти Уста - это заказчик и подписанная папка там в 240 страниц например да соответственно возникает вопрос как же со всем этим жить когда компания привыкла к циклу у них всё было хорошо мягко и комфортно вот а тут абсолютно понятные водопадный требования которые надо на это всё натянуть и это хороо ребят потому что позволяет всей вашей компании команде бежать в едим темпе и духе Да он является мерилом вообще некого производства является понятными контрольными точками для ваших коллег соответственно его не трогаем немножко добавляем такой вещи просто как квартальная планирования и прогнозирование ресурсов все все ворчат но всё ещё это остаётся для понимания разработки очень гибкой штукой Сами мы при построении проекта соответственно Ром его виртуально голове Да используя там следующие методологии это спиральная модель Бома кто-то на неё посмотрит скажет батюшки Да этоже скрам говорю нет ребята он на 30 лет старше В чём суть Да что запуская проект вы его раскручивает То есть каждый виток спирали это некая и Вся фишка в том к но прикинуть сколько итераций нам потребуется на какие итерации мы хотим разбить проект как мы хотим до этого всего добежать дела И что мы будем с этим делать Ну то есть для ядра системы я проект разбил на пять итераций То есть это архитектура Лиз и подготовка к интеграция и первый виток всегда посвящаем видению и архитектуре Да и погружаем в принципе команду разработки в то что же мы хотим с ними бедными делать в чём подвох спирали Да в том что она спиралью остаётся полтора Витка вот дальше это всё Разумеется параллели распадается на треке у вас возникает огромное количество параллельных процессов они друг на друга влияют и кажется что это всё вас подведёт к вот к этому мему на самом деле всё не так страшно Хотя регулярно в режиме паники Я встречаю людей руководителей проектов Тим ледов потому что большинство людей пытаясь реализовать большие сложные проекты интуитивно используют спиральную модель Да но не до конца понимают как же отследить то что в ней происходит Да это к чему к чему это приводит да то что на вас давит менеджмент который тоже не до конца понимает что вы там отслеживайте и к чему это приводит Да это может привести к недоверия к команде то есть ребята от нас тут требуют какой-то результат результатов никаких нет чем вы там заняты вот этот микроменеджмент все горят и совсем беда да ну и третий вариант то что там легко в режим паники попадаешь по неопытности К сожалению опыт не нивелирует первые две проблемы Да только позволяет Чуть более грамотно с ними работать то есть неизбежно надо держать свою позицию Итак как я говорил Я разбил проект на пять итераций Да размер итерации штука относительная но рекомендую её привязывать к понятным вещам да то есть это либо квартал либо полта както это привязывается принта в зависимости от того Какого размера проект вы делаете соответственно там условно за один квартал мы сделали бету и архитектуру то есть архитектуру mvp системы Да в следующем квартале мы уже сделали бету этой системы потом мы сделали релиз Ну и приступили к интеграции классная понятная схема для руководство на самом деле не отвечает вам на вопрос что же на самом деле происходило внутри этих итераций происходило Примерно вот что да с правой стороны мы видим классический waterfall абсолютно да то есть это формирование требований разработка концепций технические задания эскизный проект разработка решение Я здесь немножко отошёл от госта чтобы вы увидели Где где оно находится Да рабочая документация вот действие сопровождения То есть восемь пунктов я укладываю в пять кругов условно разработки почему это не является каскадным водопадом потому что я довольно легко с любого уровня итерации Да обращаюсь к ранее проделанной работе дополняя её Да соответственно ожидаемый мой результат в конце это то что на завершение пятой итерации Я имею систему полностью описанную в соответстви со стандартами там близкими к ГОСТ да то есть удовлетворяющим любого заказчика при этом не выводя свою команду из циклов спокойно работа Ну ладно относительно спокойно работа на самом деле всё всё очень и очень плотно а таким образом когда начинают разбирать ваш проект А что же вы там на самом деле делаете да у вас есть там Прогресс бар по каждому артефакту этим можно отчитаться перед заказчиком перед руководством перед любым техническим менеджером который в курсе вообще что вы делаете Для чего Да и проект идёт вперёд плюс этого подхода да то что у вас есть два этапа архитектура mvp Все муки выбора они находятся там то есть Да вы инвестирует что вам там лучше это будет которую мы кстати в итоге и выбрали вот или вы хотите написать что-то своё как я говорил да там пятый этап - Это всего лишь там подготовка к интеграции дальше начинается самое интересное Да это необходимость проинтегрировать всё то что у меня есть в Облаке с моей новой системой мониторинга Ну возникает Разумеется конфликт Ну как бы КД мониторинг уже какой-то существует для дата пна да Control Plan там живёт в своих каких-то вещах инфраструктур так вообще отгородились сетевым доступом и говорят нет ребят мы вообще не с вами Да но задача у меня другая у меня задача чтобы этот мониторинг я мог отдать как продукт соответственно любому кто наше облако у себя развернёт и приходится об этом хорошенько подумать А Что это значит Это значит что там любое событие дата у меня должно иметь сквозную связанность с того что у меня происходит через слои то есть Я создаю базу данных база данных генерирует свои метрики при этом под базой данных там отработал он генерирует свои метрики привязанные к этой базе да под этим всем лежит слой инфраструктуры с виртуальными машинами которые мне дают ещё по эти Ну привязать их уже конкретно к тем Ну почти нереально на практике весь этот объём работы вызывает соответствующую реакцию руководству и и ваших коллег да То есть вы предлагаете интегрировать и сделать что-то Да вот и ребята такие ну ну это космолёт этот этап очень стрессовый для многих вообще менеджеров Кто когда-либо делал крупные проекты потому что именно в этот момент происходит ревизия полностью всего вашего проекта вас разбирают на косточки вы паникует вы говорите что ребята ну я же делаю хорошую штуку А Все говорят ну ну хорошая но Ну как бы да но как же так вот соответственно тут входит к нам выходят принци из государст управления которые были упомянуты на слайде у меня в самом начале да о том как же мы Этот проект должны продвигать внутрь компании чтобы когда наступает этап по факту ревю всего вашего цикла да то есть на пятом это по факту конец пятого цикла вы попали в зону ревью просто в ревью У вас теперь значительно шире смотрит себя компания Да и приходится продать заново весь свой проект который они же раньше и согласовали Заново заново продать бизнесу Причём я специально использую слово продать потому что это означает что они должны захотеть то что вы делаете то есть не сказать да да у нас нету выбора Да а прямо захотеть сказать что Ребята вы делаете именно то что является нужным для нас да три главных постулата Как продать своё видение бизнесу Да оно должно иметь стратеги реалистичность сценарно Стратеги да то есть какие стратегические задачи для компании мы решаем Казалось бы ну понятно у нас есть частный сектор мы для них там должны допили эту функциональность круто нет недостаточно Да слишком большой проект для того чтобы закрыть только одну такую потребность идём дальше Да мы говорим хорошо Ребят я ускоряю запуск и контроль по сервисов потому что у меня всё стандартизированные метрики соответственно удовлетворённость команд разработки резко вырастет вот скорость работы команды техподдержки тоже значительно вырастает вырастает скорость реакции на инцидент мы теряем меньше денег в случае поломки класс да то есть мы уже переходим от Стратеги к реалистичности то есть где мы что тут немножко выигрываем такие Ну окей это уже это уже что-то говор даво ем Это заработать Ну потому что мы облако да давайте мы продадим классный сервис который будет там соответствовать ожиданиям наших заказчиков Вот моя модель монетизации Вот соответственно ожидани наших заказчиков вот у меня абсолютный стопроцентный ч идём такие все говорят хорошо говорит А что у с реалистичностью тамс ядро разработано дизайн вот он говорю расклад по деньгам вот он Да учтите что деньги штука всегда важная в принципе ваш бизнес не понимает ничего кроме денег да То есть вы тратите время вы не тратите время вы тратите деньги Вы улучшили работу другой команды вы заработали деньги то есть держите это всегда в голове да то есть любое улучшение вашей системы это значит вы заработали денег Да ну плюсом ещё мы говорим мы оптимизировали систему она будет тратить предположительно меньше ресурсов практика иногда расходится потом с теорией но продаём же к сожалению иногда приходится этим поделиться вот ну и Последний пункт сценарно когда продаём бизнесу мы должны им обязательно предложить другие варианты не обязательно самые плохие есть гово Вот вы показываете то что вы проанализировали на этапе видения Да И говорите что вот ребят есть такая-то такая такая-то реализация вот это вот закроет наши потребности там условно в следующем полугодии но быстро да но потом приведёт к катастрофе послезавтра либо мы сразу делаем хорошо и десяток лет предположительно Да спокойно поддерживаем систему и не заботимся о будущем в том виде как тревожная забота скажем так с бизнесом понятно с разработкой всё ещё немножко сложнее потому что ты приходишь к людям и они такие Слушай не у меня есть уже система я и с ней работаю у меня всё хорошо вот в общение в общение Приходи А ещё у меня нету времени на тебя и ресурсов нету И вообще кто ты такой И так по кругу Да абсолютно нормальная ситуация более того прийти к людям вам придется не то чтобы один раз да вам придется прийти десятки раз к одним и тем же людям прежде чем они начнут с вами работать такой отоп Да но опять-таки что важно в вашей команде разработки Я думаю большинство здесь и так понимает что самый важный момент - это функциональность что же вы им предлагаете Да какие же пробле принци синерг когда мы говорим ребята смотрите Есть потребность У вас есть потребность у вас там ещё в соседней команде Есть потребность вот э фича мы 100% её делаем потому что у вас вот вас много соответственно от команды разработки появляется к вам Доверие потому что аргумент все же все же согла таким образом происходят продажа есть один нюанс Да есть нюанс под названием своевременность то есть в перегружен ную команду очень тяжело прийти и продать какое-то вообще взаимодействие вместе да если у людей капасити не просто ноль Да там А -10 что очень часто случается и приводит к дальнейшим конфликтам выгорания и прочим да то что человек идт и говорит Ах вы не можете у меня тоже сроки горят у на проект Да вот вам эскалация Ну всё мало того что ничего никто не двигатся так ещё все поругались а эскалацией чуть-чуть Более сложный да то есть там как говорится надо это делать с уважением то есть стоит подойти к команде И сказать ребята Я всё понимаю у меня нет выбора сейчас будем эскалировать Давайте меня всё-таки послушаем Ну хотя бы чуть-чуть да вот ВС равно будет больно но уже уже будет диалог Да уже не будет конфликта Итак для процесса интеграции использую Ту же самую спиральную спиральную систему Да чтобы запустить процесс как я сказал Надо выстроить диалог для этого приходим к людям Да со своим видением предлагаем им некие известные практики неважно если они с ними не солас чтобы с вами кто-то начал разговаривать заодно поднимайте свою экспертизу в этот момент Вот И разумеется документацию полную о том что же мы и как делаем чтобы к вам вообще лишний раз никто не ходил да у вас много будет таких проектов Ну и начинаем разговор да то есть спрашиваем их потребности какие у них есть приоритеты по этим Метрика какая у нас есть обработка для этих метрик если она нужна Чего бы вообще в принципе хотелось диалог пошёл и всё это переходит плавно в следующий шаг абсолютно незаметно для них Но очень важно Для нас да момент когда мы используем принцип субъективности то есть мы такие раз всё обсудили обсудили а потом говорим хорошо Ну значит А дядя Вася у нас будет отвечать за проработку метрик Да там Петя у нас будет отвечать за взаимодействие с бизнесом если нам требуется бизнес логика Да Илья значит за всем этим всё это отслеживает То бишь у нас на каждое действие обязательно должен быть ответственный Если вы пропустили этот момент и у вас нету ответственного на это действие это Либо вы либо Теперь вы как понимаете вариантов нет самый приятный этап Да в котором Многие почему-то думают что менеджер отдыхает на самом деле в этот этап менеджер носится как угорелый со всеми общается даёт разъяснение и пытается там донести видение уже не просто до лидера группы Да а иногда до уровня самого обычного программиста чтобы у него получилось всё то что собственно говоря было задумано собственно на третьем этапе первой итерации Да надо получить всего лишь две вещи на выходе это таблицу ключевых метрик Ну пря что для команды важно что они хотят отсле Метрика и описание страничка на Да и дашборды уже в вашей системе в которую эти метрики выведены если они отдаются вашим заказчикам в данном случае с которым вы интегрируется соответственно те метрики которые не отдаются и не попали на эния а также планируем следующие итерации начиная со следующей итерации уже можно размышлять об атинг о дополнительной бизнес логике к системе Да и там проанализировать вообще что у нас где и как происходит важный вопрос Да там сколько требуется итерации вообще на проведение интеграции в системе да то есть как я говорил да для базовых метрик Это около двух итераций то есть первую итерацию мы получаем сырой массив данных Да на вторую итерацию он уже превращается в абсолютно понятную абсолютно понятную выстроен ную базу метрик Да которая у вас отдаётся при добавлении бизнес логики Это Че итерации Ну соответственно для крупных проектов как я показывал раньше при разработке ядра Это около пяти итераций как это бьётся с опытом других компаний Да там если в этом году кто-то слышал выступление компании Тиньков Они утверждали что там внедрение мониторинга с бизнес логикой у них занимает примерно 12 линейных шагов Да То есть это прямо соотносится с моими тремя итерация вот Единственное что по времени у меня итерация на интеграцию где-то пол спринта спринт у меня двухнедельный То есть это около 3 недель реального рабочего процесса ретали что можи наверно Можно наверное кто-то перегреться Итак В чём сложность да то что мониторинг ребят Это абсолютно Бесконечная история все там обсуждают как же нам когда-нибудь сделать чтобы вот оно всё само нет Само не будет само не будет Поэтому придётся об этом немножко подумать да то есть там отбалансировать Единственное что здесь есть очень хорошая рекомендация что надо понимать что там делать ревью инфраструктурных метрик раньше чем раз в полгода например смысла как правило не имеет Да они очень редко обновляются вообще по по составу да то же самое там Control п у него Лиз цикл довольно долгий то есть там Максимум в полгода для продуктов которые быстро развиваются Да и соответственно полгода для продуктов которые уже стабилизироваться на поддержке А с дата пном Всё конечно очень тяжело да это ревью ить приходится раз в квартал обновляется это всё с сумасшедшей скоростью всё время там то новую базу данных выкат то обновят версию то ещё что-то вот и по факту приходится Да делать шелер То есть можно прямо спокойно вашему цикле в джире прям поквартально себе расставлять задачки на ревью с командой о том какие же метрики они как и куда подают а собственно на этом У меня в этом докладе всё спасибо за доклад вопрос который касается выбора метрик вы сказали что у вас набор метрик определяется на этапе проектирования расскажите пожалуйста почему выбрали именно такой подход Почему фиксированный набор метрик смотрите Да объясняю Потому что если вы скажете ребята просто зашли мне ВС вы получите набор метрик без описания к ним всё да у меня уже это пройденный этап То есть если Говорите хорошо ребята вот просто интегрируйте но диалога у вас нет с Вами просто кто-то интегрируется у вас просто валится там куча метрик там слава богу есть далин как-то там со Чтобы эти метрики были описаны поставщиком Да понятно спасибо Да можно вопрос пожалуйста вы говорили в конце доклада о том что каждому продукту соответственно свои метрики и что нужно их ревью время от времени и вот у меня вопрос У вас есть отдельные люди которые занимаются этим и они сами приходят к продуктам давайте-ка мы доработали или вы даёте какую-то уровень Свободы самим продуктовым командам для которых вы собираете метрики чтобы они могли свой мониторинг и визуализацию я Разумеется даю уровень Свободы да то есть как я говорил тут самое главный момент котором вы руководствуетесь это корпоративность да то есть какие-то команды ведут хорошую документацию им можно там дать кар Бланш и ты знаешь что ты гарантированно от них получишь там результат Да какие-то команды настолько перегружены что если ты им скажешь да просто сделайте они просто сделают Но это нигде не будет записано то есть ну опять-таки Да это вопрос работы с людьми то есть с одними это можно сделать да то есть дать полную свободу с другими нельзя да и у меня продолжение ещё небольшой вопрос Как вы контролируете такие ситуации что какая-то команда может сделать высоко кардинальные например метрики Они вроде как адекватные но при этом довольно неплохо грузят систему и возможно избыточно какое-то ревью Ну скажу Так у нас есть просто Рей лимит они в него у прутся и на этом всё Ну это вынужденная меры Да поскольку у меня облачная система Да у меня метрик просто огромное количество то есть если у меня не будет литеров у меня соответственно не будет возможности вообще чтобы эта система жила И у нас следующий вопрос Дарья cloud.ru хотела бы спросить по поводу запуска системы мониторинга вы говорили что на третьем шаге когда мы говорим об артефактах должны получить таблицу ключевых метрик а также уже дашборды в системе Но как правило клиент обычно ещё запрашивает какие-то базовые алерты может быть у вас есть пример когда у Вас просили только дашборды без алертов потому что обычно Ну скажем так не оставляют возможности тут как раз да ещё раз подсвет что весь смысл был в итерационного подходе Да что мы сначала должны вообще понять сырой набор данных да хоть каким-то описанием с чем мы работаем а алерты мы уже начинаем Планировать на следующую итерацию когда мы понимаем вообще от каких данных что мы и как хотим Арти Ну то есть они находятся в следующем цикле они не попадают в первый цикл Ой спасибо спасибо за вопрос и у нас следующий дажа тери пожи захотят завести какие-то кастомные метрики возможно бизнес метрики вот при Вашем подходе как-то отрабатывается такая ситуация никаких проблем нет у меня есть разделение вообще по по доступу да то есть пользователь который захочет какие-то кастомные метрики Ну мы говорим пользователь облака да то есть в данном случае да я у него есть карб в рамках своего лимита без проблем то есть есть возможность настроить поставку собственных метрик Але дашборды и вс прочее понят цель системы быть максимально гибкой универсальной в данном случае друзья не забывайте голосовать за доклад давать обратную связь Это очень важно и спикером и организаторам и у нас следующий вопрос Ну наверное традиционный вопрос от ведущего у нас сегодня Два подарка он те один от нашего спонсор са Сара Выбери Два лучших вопроса А пока думаешь Тебе маленький презент от организаторов Спасибо большое спасибо Валерий подходите на сцену Я думаю как заслужили это вот от тебя Ага Это от команды ВК подарочек и ещё один так а чуть с мужчиной сидел да да задавал вопросы про качество метрик Большое спасибо о спрошу Спасибо СБО Спасибо за отличный доклад Спасибо за отличные вопросы оставайтесь с нами"
}