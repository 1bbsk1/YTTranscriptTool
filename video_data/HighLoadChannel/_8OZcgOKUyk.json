{
  "video_id": "_8OZcgOKUyk",
  "channel": "HighLoadChannel",
  "title": "NewSQL: SQL никуда не уходит / Константин Осипов (tarantool.org)",
  "views": 10172,
  "duration": 3343,
  "published": "2018-01-16T12:21:03-08:00",
  "text": "хорошо значит давайте начинать Меня зовут Костя Осипов я делаю Тарантул доклад про New SQL вот ну доклад такой про больше про тренды про поговорить скажем так Откуда родилась тема доклада Ну вообще-то мне как бы полагается понимать вообще что происходит в мире да баз данных Чтобы не изобретать велосипед как минимум Да вот и какое-то время назад я же до этого е делал mysql участвовал в разработке mysql когда я пришёл и начал делать новую базу данных меня очень долго парило Зачем это делать вообще вот зачем зачем нужна очередная база данных и в частности вот этот весь Хай который там лет 7-8 назад был очень популярен сно сэлем А меня тоже затрагивал Я не понимал Зачем вообще нужны SQL изначально не понимал и там как-то постепенно разбирался и всегда с ним относился очень скептически то есть вот на SQL это такой вот недо SQL Да изобретает велосипед непонятно зачем и сейчас вот так вообще тренда уже лет наверное 8 де но тренду и доклад как раз про то что с трендом происходит сно и вот у него такой заголовок про Да ну ну такой заголовок значит как он устроен этот внутри доклад Сначала мы попробуем вспомнить Зачем вообще родился почему он родился мы посмотрим что из этого хорошо что плохо да то есть вот было очень много хайпа и все считали чтот в очередной раз сво уже умирал неоднократно вот в очередной раз он умрёт от и мы посмотрим что выдержало испытание временем Вот и собственно окажется что мы понаблюдаем в первую очередь на на то посмотрим как вообще возможности которые уже есть в скуле появляются вной Сколь убд то есть мы посмотрим нач на кандра на Мон что у них там есть ничего подробного пори табличек и вот когда мы это увидим мы поймём что на самом деле ль как бы чуть лучше чем мёртв то есть происходит такая конвергенция и собственно мы поймём Почему доклад называется именно так вот после того как так сказать констатируем смерть больного а возникает естественный вопрос А вообще а что-то хорошее вообще есть в ноль базах данных ну всё-таки 10 лет усилий там разработчиков усилий проктологов коммьюнити огромна да да и вообще все сейчас пользуются и как бы в не дуют И вообще о чём вообще речь Какая смерть вот мы посмотрим что хорошего осталось Вот и после того как мы это сделаем мы посмотрим то что будет дальше то есть у меня в 12 Начинается ежедневная летучка на работе Поэтому звонок значит поехали вообще там сейчас много людей пытаются Прима к термину Но вообще термин получил распространение в 2009 году был такой хэштег чувак из Last Fm захотел как бы посмотреть на dist и изобрёл тег для Мита вот он назывался SQL и после того как это всё произошло стал набирать популярность в Твиттере и стал такой сливной бачок Да а воронка для фрустрации я это называю воронка для фрустрации которая накопилась за многие годы работы с традиционными продуктами традиционными базами данных то есть вот эту вот эту фрустрацию её нужно как-то структурировать то есть это вообще Ну что что не нравится Там и строгая там типизация допустим сэ Вот она может не нравиться и то как работает со строкой может не нравится но вот крупные такие блоки это Они здесь перечислены на слайды горизонтальное масштабирование новый модели данных и новые модели консистентность значит ну кому-то надо рассказывать что это такое Да кстати я не упомянул вообще меня прикольно перебивать это меня вышивает Я начинаю более нормально рассказывать не туплю Так что задавайте вопрос значит вот вот есть эти три крупные блока знат что они из себя представляют можем чтобы возм Какая основная идея у тебя база данных очень простая Но зато она масштабируемая то есть мы огромную кучу головни перекинули на разработчика но зато мы дали разработчику строгую гарантию что у него база данных будет бесконечно масштабироваться Вот то есть тут очень сложно было изна сообще мо масштабирования вот если посмотреть на ту же кассандру у не изначально была модель данных называлась то есть Широкая колоночная база данных и идея была такая что как бы там есть два два индекса первый индекс - это по ключу а второй индекс вот индекс по ключу он шарди а индекс пока коп горизонтального масштабирования но при этом получили что-то Вроде я это называю Joint Table в вот в Oracle есть така такая штука можно а как бы задать двум таблицам а физическое размещение уже в Joint виде Вот то есть вот Joint Table это такая такая история то есть мы изобретаем модель данных но при этом она ровно такая вот мы как бы разработчика загоняем в такую значит кайло чтобы это всё хорошо масштабировать потом появились вот эти новая модели консистентность и кап теорема вот а кто что сейчас уже сколько лет кап теореме меня очень забавляет тоже эти разговоры про кап теорему кому вообще пригодилась кап теорема Ну кому Ну вот вот постгрес он какой по кап теореме это ПГ трек кто может кто знает какой постгрес по кап теореме что никто ЦП О'кей C Да блин а что это А что это мне даёт вот как Поэтому вот новая модель консистентность - это очень тоже Интересная история и вот собственно тезис который я в первую очередь хочу высказать это то что из всего ноль движения выжило горизонтальное масштабирование а документ нае и графовые модель А что у меня случилось с этим Крутяк Так ну как мне с этим бороться сейчас нано надо попробовать вообще было бы круто если бы кто-то из организаторов помог мне с этим справиться но Я думаю что этого сейчас мгновенно не произойдёт может быть попробуем люди в жёлтых футболках А вы рулить да то есть мне тут ничего не ломать пока А вот эта штука погасла Ну чтото так вообще интим сейчас затемнение разворачивай ноутбук не ну давайте я так поговорю сейчас пока сейчас я попробую вставить вкл выключил вот может быть это поможет Так а у нас свет газ Там никто случайно спиной не нажимал А ну это это кстати вообще круто сейчас я попробую пере это самое пересказ дальше Боже мой так Ребят давайте я на это забью так Смотрите мне нужно потом чтобы вы перезапустили проекцию хорошо ау люди ведущие трек нет у них у них всё не сло Ну давайте мы поговорим просто так Ну что что что делать я всё помню картинок не будет Ну да можно рисовать значит давайте я не буду останавливаться у нас на самом деле времени дофига до часа сейчас проектор остынет и мы его Перезагрузи отлично значит Поехали дальше то есть вот смотрите я утверждаю что из трёх тезисов горизонтальное масштабирование новые модели данных и новые модели консистентность выжило фактически полтора и полностью умер умер тезис про моде Я это буду подробно рассказывать далее на слайдах Вот но Дава Но вот сейчас я попробую рассказать словами значит почему почему модели консистентность какие-то не выжили Вот кто пользуется базой данных у которые такие работающие векторные часы и вот на это вот прям заложена бизнес логика приложения Кто пользуется коммутативный tyes crdt подскажи пожалуйста Никто Да тоже никто Кто пользуется риком никто Да ну вот видите как здесь все постгрес наверно Поль Кто пользуется посо это же пог трек хорошо а все остальные Чем пользуются асинхронная репликации это очень простая в понимании Вещь Вот хотя на самом деле даже в асинхронной репликации есть четыре вида асинхронной репликации О отлично Ну сделайте проекцию пожалуйста Значит есть четыре вида асинхрон асинхронной репликации потому что репликация может быть асинхронно после того как транзакция заметила локально до того как транзакция закатилась локально комит может ну то точка комита е можно точка комита в основную базу она может соотноситься с точкой комита в реплику совершенно разными способами да то есть Вот мо db изначально у него же какой был режим запрос прилетает на сервер база данных ответила Окей он ещё даже на диск не попал ни в журнал никуда вообще и всё полетели дальше за счёт этого всё очень быстро но потом их за это стали критиковать они включили по умолчанию по-моему в более поздних резах 3 плюс Там они по умолчанию в журнал вс-таки локально сначала пишут потом дают ой с репликации даже с асинхронной репликации там уже ещё есть опции да то ты записал локальный журнал но на реплику это ещё не улетело Вот ты допустим хочешь дождаться что оно хотя бы улетело на реплику улетело не значит прилетело прилетело не записа не значит записалось локальной Женей реплике То есть даже асинхронная репликация - это бездны семантических моделей Да вот и поэтому модели консистентность - это слишком сложная штука и они умирают значит Поехали дальше Прошу прощения за интермедия значит новые модели данных вот да на фоне смерти модели консистентность ещё есть интересный тренд в развитии на самом деле более строго консистентность то есть дис добавляет транзакции кучу времени назад транзакциями я бы это не назвал но тут вообще даже по транзакциям ходят споры что Что такое настоящие транзакции опять же не могу не потроллить ПДК настоящи транзакции акци поса значит мо db идт начинает с Амика да то есть атомарность на уровне документа потом они добавляют такой режим выполнения isolated Да когда хочется но всё-таки хочется и нужно разработчикам обновлять несколько документов сразу то есть вы понимаете Сначала мы будем парить людей про то что они Ну вы положите вообще весь ваш бизнес-кейс даже есть такое понятие в ноле как Боже мой В общем идеология того что нужно всё сложить в одну корзинку вообще всё что связано с одним бизнес-кейс нужно положить в один документ тогда у вас всё просто Да вы сделали один одну бизнес транзакцию Да один бизнес-процесс и у Вас одно изменение томар одного документа оказывается не работает и к его eval consistency совершенно такая Пионерская Ну Пионерская в хорошем смысле база данных она сейчас всё меньше используется Вот теперь давайте поговорим про следующую историю Это история с моделями данных вот если так как-то группировать модель данных которые изобрели после S то были value документ col ST называется dat structure Server и есть графовые базы данных и вот возникает такая история Что Круто У нас есть столько моделей данных а я утверждаю что горизонтальное масштабирование давит абсолютно на всех то есть горизонтальное масштабирование некий тези который связан в первую очередь с гипернн так называемой ккто знает что такое гипернн как надо расшифровать Да всё идёт на одно нито сервера У нас у нас мы не покупаем вертикально масштабируемые машинки Хотя вот там есть секция weale it и там ещё говорят про вертикально масштабируемые машинки Но даже внутри этих вертикально масштабируемых машинок сидит сейчас уже горизонтально масштабируемый софт То есть как бы какой то есть людям продают конечно стойки но стойки эти Денте вот есть горизонтальное масштабирование - это тренд который давит на всех давит на в том числе на изобретателей новых моделей данных и возникает вопрос Вот какие модели данных хороши для горизонтального масштабирования Какие плохи то есть вот SQL он хорош или плох для горизонтального масштабирования плох это спорно на самом деле мы сейчас посмотрим но Ну вот сложно дорого да а это как у Тёма долго дорого Круто да Ну вот история значит Но вот редис дис когда добавил редис кластера Выяснилось что не все операции модели данных они нормально горизонтально масштабируется и вот такое цитата из документации что Ну вот что-то у нас работает на конкретном шар А что-то у нас действительно работает как в настоящем кластере Какой какая проблема фундаментально этого подхода та же самая собственно проблема взять mysql и его руками да то есть у разработчика появляется две модели данных он мыслит в одной модели данных это реляционная алгебра и потом когда он мыслит о шардирование самостоятельно он мыслит в модели данных вот этого шардирование но тем не менее редис добавляет редис кластер Да потому что все хотят горизонтально масштабироваться значит вот история про горизонтальное масштабирование графовые баз данных здесь примерно такая история что как бы это хороший пример который говорит про горизонтальное масштабирование вычислений и хранения вот хранение можно распи По какому угодно количеству корзинок Но если база данных по своей природе предназначена с теми данными что она хранит что-то полезное делать это и вычисление эти полезно горизонтально не масштабируется то здесь возникает уже и проблема того как хранить эффективно горизонтально чтобы вычисления работали есть мы сейчас будем говорить кстати про реляционные базы Вот почему реляционные базы тоже плохо на самом деле действительно льно масштабируется но не так уж совсем но но достаточно плохо Вот вот есть графовая база данных вот мы как что мы можем сделать вот у нас одна нода заполнилась мы начинаем заливать ещ какие-то другие ноды понятно что эта нода становится перегруженной Да и понятно что мы теряем локальность запросов у нас какие-то запросы по графу они вынуждены ходить по нескольким физическим узлам То есть у нас появляются сетевые задержки Допустим мы сделали несколько иначе мы взяли и разбили всё какой-то хорошей функцие шардирование то есть мы вычисляем некий хш достаточно случайно ше кластеру получили другую проблему опять же что 100% вот здесь хотя бы какие-то запросы работали нормально Здесь 100% запросов тупят потому что большинство запросов баз данных они связаны с обходом от узла да то есть вот мы любой обход от узла он куда-то должен попасть и чаще всего должен то что вычислить запрос нужно перейти на другой узел то есть возникает идея что графовые баз данных надо ровать как-то вот так находить кластера и кластера размещать на своих так сказать нода и то есть у нас есть сильно связанные подмножества они размещаются вместе слабо связанные подмножество как бы разносятся да то есть это некий идеальный вариант Но тут возникает следующие Следующая история что ну этот это идеальный вариант только в теории живые данные они не поддаются статической статическому разбиения да то есть мы должны придумать какой-то способ постоянно это всё перековать в зависимости от появляющихся и исчезающих связей вот поэтому 4G они масштабируется по большому счёту Как там и Сколь сейчас классические базы то есть они уже довольно долго работают над шарлин но при этом есть какие-то вот Кто пользовался графами распределённые базами титаном допустим Ну как сколько данных в Лили чего А чем так Ну и как для каких операций операции с документами или операции с графами с графами вообще всё чудесно Ну вот но тем не менее то есть тезис который я собственно выдвигаю заключается в том что горизонтальное масштабирование давит на всех и все модели все модели данных рано или поздно будет вынужден это сделать но какие-то модели при этом с нами останутся а какие-то нет И вот если смотреть на и на там докумен в чистом виде то мо что этого не будет А вот если смотреть на графовые баз данных то графы уже сейчас отож достаточно с то есть вот как бы Когда фрустрация вся произошла Да стали люди изобретать и в том числе появился шанс голос у пропонент графо вой теории скажем так и сейчас я думаю что тренд забегая вперёд будет такой что графы войдут также как документы во все продукты то есть вот для меня вот эта трендовая история Она про то чтот и это что будет не в одном конкретном продукте да А в многих продуктах что продукты будут копировать между собой и в этом смысле Я хочу посмотреть как раз на Джейсон вот здесь Это пример того как тренд который становится все охватывающим собственно работает то есть утверждение такое что любая база данных которая вообще хоть как-то способна поддерживать Джейсон Будет поддерживать Джейсон то есть вот если она написана на там я не знаю Ну если она вообще что-то то есть Может быть какие-то базы данных для матричных вычислений не будет поддерживать Джейсон А все остальные будут и вот мы это видим в том что происходит и мы видим что на самом деле реляционные базы в своей поддержке Джейсона они даже впереди каких-то нереляционных той же кассандре вот не ключей по по Джейсон полям и даже графовые базы данных они тоже начинают себя включать Джейсон потому что Джейсон нужен всем то есть вот тренд который мы можем зафиксировать это что-то что останется отно серьёз И надолго Теперь давайте ещё зададим се такой вопрос А если вот эти базы данных они поддерживают Jon Нахрена вообще нужны данных есть остатся только одна история э история горизонтальное масштабирование да то есть мы хотим горизонтально масштабироваться и только поэтому вообще мы используем какие-то другие продукты А теперь мы смотрим на но Томаса улина который говорит про будущее ма и мы на самом деле знаем что самое происходит пост сообществе вообще во всех абсолютно каких-то продуктах Я говорю что это давление горизонтального масштабирование сказывается на все продукты за сч переходу к гипер конвергент вычислением и вот он говорит что у нас вин такой что у нас будет один продукт у которого будет высокая доступность То есть это речь идёт высокая доступность в первую очередь О inb кластере да то есть это Груп репликация плюс ndb кому понятны эти слова здесь а кому не понятно Ну Пара человек вам не понятно но ради пары не буду рассказывать но смысл в том что никогда это не подыхает в общем-то база данных можно молотком бить она вот всё равно живёт и при этом scaling он говорит что scaling features baked in Да мы запекли эти все возможности то есть речь идёт о том что там через X релизов и там ну я думаю что X = 23 мы собственно получим а mys CL в чистом виде да то есть он будет поддерживать SQL на кластере он будет поддерживать там Jon хранение в кластере да кто-то слышал что в маско там есть протокол X Да который пря вот работает как очень похож на мо да то есть вот он уже предназначен для работы с Джейсоном А теперь давайте посмотрим на движение с той стороны вот для того чтобы констатировать смерть нужно не только смотреть на там SQL баз данных нужно смотреть нано SQL и и здесь на самом деле тоже есть интересные инсайты то есть вот я взял Опять же лидеров Кстати по поводу лидеров очень интересная история Почему эти ребята лидеры может я не пра кто-то другой Лидер Ной Сколь движения кто Тарантул Так мы не считаем себя ноль сбд мы вообще сервер вычислений эластик эластик офигенная тезис эластик Лидер Ной сколи Я согласен на 100% но эластик немножко с другой стороны заходит поэтому на ластике кстати есть база данных Create тоже на лю сине точнее но ещё Ну хорошо что кто ещё Лидер AOS Spike Нет ну не надо не надо теребить дедушку Ну значит influx influx Time Series вообще как как тренд я вообще не затрагивают среди Time Series движение что Time Series databases значит это а отдельный отдельная ниша как вот графовые есть А есть Time серс куда не копь форка нутый постгрес То есть как бы с одной стороны отдельно а с другой стороны там тоже постгрес да то есть это в машинах баз данных тоже куда не копь там гнп постгрес ну вот что же делать значит хорошо Я сейчас не об этом вот смотрите мы говорим сейчас про возможности вот есть возможности которые я здесь перечислил про них по ним хочу пройтись вот самая На мой взгляд такая энтерпрайз возможность она есть У кауч беса то есть вообще CB - это ш Да все знают то есть был ш его форк да Для того чтобы он там горизонта что как его зовут-то дарман в общем-то у него совершенно другое продуктовое видение Да вот он всех послал нафиг с горизонтально масштабируемых и это как-то зашло и вокруг этого стали пилить бизнес потом они слились там с и так далее и так далее и так далее значит вот смотрите Какая история говори что да О чём не надо думать мы сейчас посмотрим как это меняется вот в принципе то есть вот CB например есть Second Да а Second - это уже на самом деле начало схемы я Потому что если ты говоришь что у тебя есть какие-то поля по которым ты собственно строишь индекс Значит ты уже что-то говоришь о базе данных и более того Вот бы следите за руками Я думаю что как у постепенно также уних будет в будущем выпилиться из документации история про хотя там них очень много истори вобще Надо подумать что это себя представляет сечас про это поговорим значит Ну вот прикол в том что у есть то есть они это драйве синтаксис несовместимый но драйвера это фактически это часть стандарта SQ А теперь давайте посмотрим на забегая вперёд на синтаксис а синтаксисом они крупно облажались потому что они почему-то решили что так как у них хранятся документы у них схемы нет то им нужны какие-то интересные операторы то есть во-первых они изобрели Ну полностью аналогичные истории да то есть вот у них есть из missing история зачем она нужна если в стандарте есть клауза изл вот из val То есть если значение прис то есть вот понимаете мы имеем со skim Database и мы должны всё-таки Ну не заходит у нас structured quy Language на skim Database нужно Здесь здесь подпереть то есть вот вот опять же как бы почему это уже смерть больного потому что 30 лет назад 40 лет назад когда с стандарт не был доминирующим в мирель баз данных как есть сегодня да а все вели себя ровно таким же образом То есть все пытались делать vender Все думали что можно здесь что для клиентов достаточная ценность если они изобретут свой собственный жаргон и так далее кончилось это чем мы знаем да то есть вот один Лидер условно говоря держит индустрию вот так вот в кулаке А все остальные Ну они там тоже база данных значит Поэтому то что добав это как бы в принципе Франкенштейн но хочется поговорить про другое ещ хочется поговорить про secondary Ke вот смотрите я говорил что основной Завет SQL - это горизонтальная масштабируемость да то есть вот просто если ты не горизонтальной масштабируемый Ну если только ты графовая база данных ты кому-то нужен но опять же есть вот как мы выясняем который гонта масштабируется неплохо Вот теперь есть база данных они принципиально Ну ничем не отличаются поми работы со схемой тоже про это поговорим более строгой типизации более строгой схемы данных Ничем не отличается отно кроме горизонтального масштабирования теперь у нас появляется в данных как горизонтально масштабировать в принципе есть два способа та СПО какие-то эзотерика два мажорных способа реализации вторичных ключей в кластере да либо у тебя вот каждое подмножество которое находится на конкретном узле поэтому подмножество строится локальный вторичный ключ да Но тогда этот локальный вторичный ключ он может быть используем только для запросов по этому подмножество ренж запросов в первую очередь а SQL - это в основном э запросы использующие там от и до Да Range значит либо ты м делаешь следующее у тебя Ты выносишь вторичные ключи То есть ты у тебя отдельно есть Index noes так называемые которые хранят вторичные ключи и тогда у тебя всё работает гораздо гораздо лучше с точки зрение аналитики именно ренж запросов и тому подобное Да но у тебя сразу теряется локальность апдейта то есть любой апдейт любое изменение а потенциально должно зайти на дата ноду положить туда новое значение посмотреть какие данные изменились сходить на индексные ноды обновить индексные ноды если много вторичных ключей обновляем много индексных нод то есть кстати вот мне кажется что это не очень круто запирать проход и можно встать вот где-нибудь или сесть где-нибудь вообще и просто пустить людей внутрь Вот то есть если есть возможность заходите и Садитесь Не парьтесь то что вот то есть смотрите предательство происходит на наших глазах с одной стороны но базы данных подсовывает нам какое-то вме вместо с другой стороны Они придают потому что добавляют вторичные ключи и в этой связи тоже опять же почему вот сейчас вот наверняка Вот вот сейчас вот смотрите тезис в этой аудитории очень многие смотрели с интересом Наро Кто смотрел Наро в это аудиторию Поднимите руки 2Т 4 5 6 7 то есть л больше рук Но идея СМС мы велосипед Давайте изобретён то есть Вот давайте сделаем Давайте вот понятно почему там My так медленно и будем говорить уверенно ползёт к шардирование очень много Legacy То есть это миллионы строк кода это миллионы приложений это очень много всего процессы и так далее э вот в итоге мы получаем что ль движение сейчас обременен тем же самым Legacy за 10 лет своего существования Да его там меньше Но его всё равно много и проще взять и написать сю базу данных с нуля там Чем пилить постгрес условно говоря им да Или счм для чтобы он был тру трушно Вот вот примерно такая динамика значит что ещ О чём ещё здесь хочется почему вот здесь ещё Интересная история Да значит вот никакого у них свой язык но посмотрите у них на самом делени есть у меня неправильная табличка поправили сво время вот значит у них тоже есть то есть вот этот функционал он он у всех есть теперь ещ поговорим Вот вот дис Почему у него он везде а он Заложник своей Моу главную ценность потеряет он перестанет быть простым то есть И вот так мы будем видеть вот этих вот продукты которые стали заложниками своей изначальной простоты они будут отваливаться да то есть потихонечку они будут уходить в небытие Я не говорю что редис уйдёт в не бытиё возможно что там ребята что-то придумают они сейчас модули придумали и уже есть дис модуль реализующий SQL знаете это или нет но насколько я на него смотрел он подк парад подкручивает просто в Редик Ну то есть это не прикольно да Stage там другой не ресовский не in Memory вот а теперь вот Хотелось бы поговорить про ещё вот этот столбец потому что на мой взгляд он очень важный и это ровно то Почему ещё SQL база данных плохо горизонтально масштабируется То есть это очень большой кусок проблемы с SQL базы данных а сейчас помимо вот всей фрустрации Почему в общем собственно ски малес вообще родилась Да потому что была фрустрация с тем что а Мы ушли от фола Да в проектировании программного обеспечения у нас постоянны Agile мы постоянно вносим изменения в требования и у нас постоянно меняется из-за этого схема данных и это просто невозможно делать когда у тебя база данных рассчитана на то что ты сделал Create Table и вот всё это навека да И даже есть такая функциональность называется online alter Table и эта функциональность позволяет Вот тебе то есть есть очень много функционально если взять Oracle там есть версионирование схемы данных там каждое приложение может работать со своей версией схемы данных и так далее и так далее но в общем подход Эля к версионирование схемы данных он достаточно заскорузлый На мой взгляд и в этом смысле вот документная модель и подход допустим той же мо db На мой взгляд подход трендовый и этот подход и это с нами останется Что они предлагают у них тоже изначально ребята заявляли про себя мы скис мы всё в общем Кладите что хотите у них появляется возможность валидации данных вот можно определить так называемый валидатор И основная фишка этого валидатора в том что он не обязан быть Рикт то есть есть настраивается так называемый validation level validation Action validation level позволяет вам принять решение Что делать с существующими документами А что делать с новыми документами То есть у вас есть существующий документ он не проходит валидацию вы при этом можете настроить валидатор таким эти существующие документы не и операции с ним по-прежнему проходили но новые документы допустим они уже обязаны проходить соответствовать это этой валидации этой схеме данных которую вы инфорте и соответственно у вас тоже может быть либо там либо War да То есть вы получаете что данные не проходят что это позволяет сделать Вы можете развивать свою схему данных параллельно развитию приложений таким образом К сожалению кроме монго ну ещ это есть у нас да но вот в кассандре в кассандре это поддержка схемы данных есть и Джейсон можно разместить и по Дже можно делать поиск но версионирование и вот настройки этого нету то есть они пошли по другому пути у них тоже если схема данных опреде она должна быть строгая это тоже на мой взг тренд из из который с нами останется Теперь давайте посмотрим вс-таки Почему база данных вообще добавляют в том Илим виде аналитику значит вот есть вот такой убогий сикл который не консистенции получаете Отт который не соответствует ни одной точке во времени потому что это Бегущий Отт пока он сканирует данные он не держит никакие Локи никакой там данные мутируют параллельно сканированию То есть это некая такая грубая аналитика почему такая необходимость возникает Потому что есть мир аналитики который сейчас очень перегрет на котором решение стоит миллионы долларов Вот кстати здесь будет следующий доклад Я хотел бы его так сказать прорекламировать Вот же сидит следующий докладчик замечательный доклад про то как делать аналитику в Гугле в Google Cloud Да но если вы смотрите на решение для аналитики там какое-нибудь ветика эсо и тому подобное это миллионы долларов и вот для SQL это как бы Реально о немножко подзаработать но оказывается что что любой Запрос который то есть результата нельзя использовать TP то есть вот oltp должен быть всё равно по-прежнему Ke value да то есть И именно поэтому я утверждаю что в будущем но система будет затягивать гайки и Бут реализовывать строгую консистентность для своих запросов потому что просто сейчас они реализовали эти эти запросы селекты с джоина и так далее для аналитики вот есть конкретный рынок они хотят срубить немножко бабла но потом они поймут что надо двигаться дальше и будут реализовывать строгую модель консистентность реализовывать транзакции и так далее подытоживая что же вообще от осталось Да значит я уже упомянул документы которые войдут во все продукты Значит мы поговорили про альтернативы к управлению схемой А ещё хотелось бы упомянуть вот такую штуку как в Лови поди плеяду Да самый из них примечательный этол он примечательный и потому что он был самый передовой то есть ребята сказали что давайте встраивать язык работы с данными в каждый домен язык в каждый до specific то есть в питоне он нативно встроен в Python в два скрипте он нативно встроен JavaScript и так далее То есть нету вот это вот двух языков с которыми приходится работать Да это очень радикально отличается от SQ в целом да Когда у вас есть реляционная алгебра и результаты реляционной алгебры уже тащите куда хотите вот но у нас есть не только рекл как таковой Да вот рекл демонстрирует что этого недостаточно для того чтобы образовать свою Ниш это недостаточная ценность сама по себе что вот другой дифференциации db Ну ну можно спорить по db Но вот это основная На мой взгляд это была основная такая интересная штука котора рея потратили много времени но его недостаточно но при этом смотрите что происходит есть куча других языков то есть всё равно рождаются JQ spq вот в ластике как раз появляются простые способы задать сложные вычисления вот основная история про новые языки языки Можно всё сделать на SQ Да но основная история про то что это всё это не продуктивно и мы хотим дать людям проы то есть И вот ЕС опять же посмотреть на историю SQ появляется значит простой oltp язык Да вот потом появляются всякие груба потом появляются Window functions потом появляется возможность работать с иерархически базами базами данных Да иерархически датасета там recursive так называемый Да вот то есть SQL последовательно усложняется для того чтобы добавить всё новые виды вычислений но это же не конец У нас есть всякие модели данных которые есть вли У нас есть всякие статистические запросы которые мы хотим вычислять Вот и вот это на мой взгляд очень сильный тренд То есть то что мы делаем с данными постоянно постоянно усовершенствуйте появиться И главное что не все вот вот взять вот прегель допустим А идея прегель в следующем это распределённое вычисление на графе Вы имеете некий некий цикл вычислений на каждом на каждой итерации цикла Вы можете изменить состояние каждой вершины графы и отослать исходящие сообщение принять входящее сообщения пока какие-то вершины участвуют в итерация вычисление проходят то есть такая простая модель которая может работать как на локальном так и на распределённой графе вот в принципе эту историю как положить на SQL Но вы должны создавать какие-то которые класть вот эти вот промежуточные потому что вы потом-то хотите избавиться от этого всего да потом хотите начать с нуля покатиться на исходное состояние вот в этом смысле на мой взгляд тоже очень важно что новые языки они предлагают другую модель не реляционную а итеративный результатами поэтому это останется мультимодальная база данных если развитие более широкое Почему я утверждаю что графовые СУБД тоже станут Ну не будет такого поняти как Граф СУБД Граф возможности будет во всех СУБД Вот есть такой кейс от Оран db где они рассказывают про льде ценность мультимодальных баз данных для управления парком самолётов значит вот есть парк самолётов любой самолёт можно представить себе как Граф как дерево такое он состоит из частей причём есть какие-то блоки блоки тоже состоят из частей и есть зак этой базе данных вот допустим запрос У меня есть по расписанию так называемый да то есть мне нужно раз там в год или в полгода все запчасти определённой маркировкой тупо заменить во всех блоках и это классический реляционный запрос Да дай Найди мне такие запчасти у которых сейчас окно а есть запрос графовые типично допустим у меня сломалась вот э Дета она меняется мелько в сборе Мне нужно найти модуль который мне нужно закупить и заменить и это типичный запрос по графу то есть что ребята говорят девелопера нужно дать разные способы работы с одними и теми же данных есть в одной и то же базе данных должны быть как графы так и коллекции так и рейны и они должны друг с другом можно в условно говоря в relation включить отсылку на объект который присутствует в коллекции в графе можно использовать данные из рейсов и так далее дальше это уже история не совсем про SQL Это история про тоже просто я добавляю это скажем так до куча тренд который мне кажется очень важным Это ище сколько у меня времени 15 минут Да значит о что что На мой взгляд останется с нами всерьёз И надолго в ни в сле ни в ноле нету сегодня операторов которые были в Only по своей вот природе даже Асер который есть в монго он читает в целом ряде случаев данные insert читающая операция К сожалению потому что нужно ука Ну то есть в чисто документной базе данных это возможно потому что о просто новую Диш добавит и и создаст этот документ вот с новым уникальным аш если у вас адика уже задана в документе то вам нужно проверить что такой ашки больше нет Значит мне с заднего ряда говорят что если есть индексы то Мы обязаны читать вот идея в том что даже если есть индексы то читать не всегда обязательно идея такая читать в коем случае вам не важен результат чтения вы хотите добавить данные в базу данных если они там ещ не существуют если они существуют допустим вы заменяется их старую версию новой или выполняете какую-то команду слияния да То есть вы должны изобрести новую то есть новую семантику для того чтобы не считать вот на мой взгляд сейчас ни одна база данных этого не предоставляет но привлекательность агов велика операцию девелопе предоставить потому что вот убрать о деревьев там вот это ВС иже с ними да level db у них производительность записи без чтения на два порядка выше чем производительность записи с чтением То есть вы раз у вас там я не знаю 10.000 запросов в секунду А так у вас миллион может быть нано на одном узле Вот именно поэтому итто оних него разрыва То есть у них есть поток данных который летит они тко говорят что да это вот и они очень быстро её компактно ОНТ вот и мне не нужно проверять уникальность и тому подоб на порядок быстрее просто потому что нет в традиционных баз данных вот такой вот семантической операции которая была бы я думаю что это появится куда же этоже дас повс данова не останавливается на но скуле она не останавливается нань SQ она а то есть наше представление об информации постоянно развивается и вот один из важнейших трендов такого будущего на мой взгляд - это то что мы информацию удалять будем всё меньше и для этого рождается у нас а целый ряд продуктов которые называется темпоральные базы данных которые позволяют работать вот это скриншоты из Microsoft сикл сервера слево расширения То есть это база данных которые позволяют задавать вопросы на точку во времени То есть вы вы говорите у вас нет истории про то что ну Селект Да на текущее состояние но у вас ещё появляется возможность сделать Селект на какую-то дату в прошлом и соответственно у вас это рождает целый ряд новых применений баз данных То есть вы например можете вычислить во-первых Вы можете проследить историю какого-то объекта Да во-вторых вы можете вычислить а группы какие-то отчёты по периоду автоматически для этого не надо создавать отдельную таблицу у вас всё у вас натуральное представление вот натуральное представление в одной таблица одна сущность одна таблица Если говорить о том как это всё устроено значит фактически там есть основная таблица есть таблица с историей А с каждой строкой ассоциированы два два времени Про которые система знает то есть это не просто две колоночки которые вы добавили это колоночки которые система поддерживает автоматически это время добавления записи в базу данных и время события и это разные времена как не занятно да то есть допустим Иван Иванович так сказать скончался 17 там ноября а в базу данных эта запись была внесена там уже 20 ноября вот эти оба времени они это такие базы данных хранят это и на мой взгляд это тоже один из основополагающих трендов который Почему почему он основополагающий если мы вернёмся к вторичным ключам и к eventual consistency то хранение абсолютно всего как раз позволяет элегантно решить эту проблему То есть если нам не нужно ничего удалять вообще из баз данных никогда то у нас база данных всегда консистентная вот занятная история то есть мы можем просто в каком-то какие-то проблемы решать на порядок площ вот Ну тут есть какие-то примеры запрос вот такой вот итог такой скажем обзор того что Куда движется и меня есть-то чтобы Ответь на ваши вопрос а есть короче баз данных А есть какие-то наработки что будет создаваться какая-то новая база данных которая не будет относиться к каким-то масля пост монго и так далее занятно Бут ли вообще-то вопрос Так звучит по-хорошему Будут ли новые Database стартапы появляться Я думаю что их будет появляться всё меньше то есть буря утихла и сейчас мы будем скорее видеть выбытие чем прибытие как это былом одним из последних так сказать кто прибыл Ну вот это Ну то есть смотрите ус Давайте быва разберём это как-то по существу Значит во-первых у меня вот профессор в университете он говорил что СУБД - это вечно Зелёная область Поэтому мы всегда будем видеть какую-то Движуху значит вопрос был про то будут ли какие-то принци то есть для того чтобы просто прийти то есть Ну любое любой вендер Завтра может вы выступить с с продуктом Ну условно говоря мы завтра можем построить автомобильный завод в России и начинать производить автомобили Но это будет автомобиль это не будет Тесла допустим это будет грубо говоря автомобиль с двигателем внутреннего возгорания То есть если мы можем производить Теслы но теслу уже всё равно кто-то производит то есть Отвечая на этот вопрос вот в ближайшее время будет скорее конвергенция чем как бы чем бум Вот потому что какие-то принципиальные вещи Даже тот же как это что сделали люди взяли Я так понимаю это люди которые каким-то образом причастны к спане и они решили спаннер повторить Ну Для более глобального сообщества в целом идея Благая Ну вот у меня вопрос точнее У меня даже не вопрос А скорее я тут я вас не вижу я тут скорее добавление к докладу в SQL часто стараются делать покрывающие индексы чтобы результат но а сразу же получался из индекса Вот и сам индекс - это фактически такой частный случай графа и таким образом возможно тенденция идёт к тому чтобы чтобы Граф Ну чтобы вся база данных постепенно Вот так вот перетекают все представители графо баз НМ не работает потому что есть много способов ать индекс есть много трейдов которые вы можете при индексации сделать и не всё есть Граф Давайте успокоимся Да как не всё есть реляция не ВС есть Граф ска пожалуйста по вашему мнению эластик и аналогичны куда будут двигаться а эластико не надо никуда зада это эффективный поиск и всё что связано с этой экосистемой так вот я собственно про то что он начинает решать очень странные задачи То есть он пытается и та сери притвориться и аналитической базой под какой-нибудь работу с логами и при этом всё это эластик и собственно главный по на текстовый поиск уже как-то вот под него по такое его никто и не использует уже Я думаю что это всё идёт в первую очередь от того что Калак пытается быть всем но понимаете вопрос от задачи Вот есть Ну задача эластик она очень похожа на задача Time Series поэтому тут оправдано то есть они эластик хорош для того чтобы искать по каким-то неумеренном массивам тех же логов и так далее да Ну что такое логи тоже App история он ну то есть вот есть как бы более узкий кейс это просто текст какой-то там по сайту Но на этом много не заработаешь Ты должен что-то делать да ты должен делать больше для того чтобы дифференцироваться от конкурентов в первую очередь и вот поэтому это всё происходит но это не про то что эластик завтра будет там я не знаю транзакции понимаете как бы банковские делают Ну не будет Вот и и А всё идёт к тому что кауч Base например будет понимаете потому что они А если не транзакции банковские то есть вот Ну что-то такое то есть быстро то есть придумать банк который поставит у себя кауч там через 2 года вот не верю Нет нет конечно монг делали с дого платёжки Нет ну про банки вообще можно отдельно говорить Давайте ещё вопрос а говорили да говори Анн для решения да то есть вот эластик в принципе так и работает он же все документы развиваться эластик вообще такие такого рода вопросы лучше взять офлайн потому что они не совсем про доклад но отвечаю значит будет потому что запросы будут развиваться язык запросов он Пионер во многих во многих вычислениях с он придумывает Как написать Вот такой вот ну как это называется его язык-то на котором пишешь Это Ну вот нет именно развитие эластика как решение может быть будет пиво но непонятно то есть это же й Да й - это фор люсина для но или вот туда Давайте раз Народ уже потихонечку расходится мы завершим всё оста Нет давайте в коридоре"
}