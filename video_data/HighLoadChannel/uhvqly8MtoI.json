{
  "video_id": "uhvqly8MtoI",
  "channel": "HighLoadChannel",
  "title": "Postgres 12 в этюдах / Олег Бартунов (Postgres Professional)",
  "views": 44265,
  "duration": 2830,
  "published": "2019-05-07T13:26:41-07:00",
  "text": "вот я буду рассказывать сегодня проползли с 12 в этюдах почему потому что 12 ip-адрес оказался очень богатым на фичи если их просто перечислять дата просто у получится заунывный текст о том как у нас все хорошо будет вот поэтому я решил рассказать некоторые фичи немного углубленно так как я сам разработчик мне это близко до чтобы вы поняли слайдов много они все будут доступны и конференции на сайте конференции вы можете их скачать и посмотреть полюбоваться в семейку более подробно я буду не все показывать буду пролистывать да вот и начинаю я соответственно ну все знают кто такой бар тонов олег я в первую очередь разработчик пузыри со я профессиональный астроном и я являюсь генеральным директором компании progress professional вот так что вот о чем я начну разговаривать я говорить я буду про рисковали джейсон сначала вы знаете что возрасте 12 ему уже за к метели часть fitch диска или джейсона стандарта это очень классная штука я буду говорить про контролируемой стая все дальше код стояли на наверное так вот сейчас оказывается в 12 релизе кардинально изменится работа с это я и это очень важно то есть изменились умолчания многим разработчикам придется немного посмотреть свои приложения очень важно я расскажу про кнр опыт показал что почти никто не значит что кокаин кто-то знает что какая-то ну совсем мало все остальные не за это на самом деле только жемчужина пузырится которая позволяет решать задачи очень красиво приятное масштабируема то есть я тоже скажу в 12-ой версии появились многом нововведений про индексы в частности появились гагарин индексы улучшились появилась поддержка в гис те кто знает что вы covering индексы тоже не так много а это очень хорошая штука она позволяет индекс английскому играть полноцвет ну схеме цветами радуги бизнес covering индекса эти индексы он риск она практически бесполезной я расскажу про плоды balls тораджи то есть это не говорит о том что мы скатываемся туда куда mais quel идет но в принципе после себя уже в 12 версии 13 скорее народа будут появляться новые стороны то есть наконец-то мы будем делать с тораджи оптимизированные под определенные задачи колонн стороны чинема рессоры chapin дон листа врачу и так далее то есть 12-ой версии за канители вот это опек для stora чей очень много было работ по из улучшение партии шинга по-русски мы говорим секционирование это то на что многие разработчики молятся и говорят что это серебряная пуля для масштабирования приложений на самом деле не так но пусть они верят в это ну и много fitch других и так и на не начиная с колледже сон а вот это слон хвост у него свернут в бесконечный торус торус является грубая логотипом джейсона этого лбу у него логотип нашей компании потому что эту фичу мажорную фичу в 12-го релиза как раз сделали наши сотрудники частности я тоже то есть это наш contribution в международный полис как вы видите вот на этой картинке после сразу эволюция малышку или и и реляционных баз данных увидите что на узкую иль развивался с простых trevi примитивных базу данных ключ-значение долларовых баз в это время реляционной базы вот например под gris он развивался тоже сторону от реляционных which can узкую или фича то есть первые на ускоренный фичи в потряси появились еще 2003 году на шестом году они стали доступны в дистрибутиве это было частот в двенадцатом году появился а джейсон четырнадцатом мы сделали джейсон и сейчас мы за к метели джейсон пас то есть это язык для того чтобы навигировать ну грубо ряд в по структуре джейсона с помощью этого языка вы можете теперь выделять кусочки этого джейсон дерево джейсона и это позволит вам выделять для просто чистили select и вы можете делать какие-то фильтры докладывать вы можете даже использовать их для того чтобы индексировать то есть сейчас вы можете индексировать как бы лишь джексон но вы знаете же джейсон и обычно это большая мусор ница то есть там обычно чего-то такое интересное куча мусора очень жалко индексирует весь этот мусор с помощью джейсон паса вы можете выделить именно те кусочки этого дерева которые вам интересны для индексирования для поисков вот это очень интересный такой язык самое главное что это не просто язык это стандарт то есть это стандарт вскоре стандарт и вы видите что на узкую щель базы начиная с ключ значения потихоньку усложнялись то есть первые на узкую личке они считали что ключ-значение больше нам ничего не нужно а потом они вдруг начали понимать что ключ-значение но им нужен там порядок ода ринг то какой нибудь да чтобы например вот как кассандре family обе сделанное что фамилия имя отчество не встречается часто давайте поэтому их вместе держать на и так далее то есть они начали усложняться другой стороны реляционные базы данных они поняли что часть людей ушла надо давать какие-то фичи где - курильщикам и вот если посмотреть по графикам популярности роста пузырится видно что с 14 года популярность резко возросла за счет как раз вот того что мы сделали джейсон b и многие разочаровавшиеся пользователи ноуз quelle манга и так далее они стали переползать обратно на пол и лиц потому что подлез это универсальная база данных с ней говорится все понятно она вас не не оставит в беде если вам чего-то не хватает вот здесь скриншот как раз документация стандарта вы видите стандарте есть целая голова посвященную джейсону и это называется как иску и джейсон вот мышцу за к мите ли мы заметили джейсон пас он просто-напросто некая строка на самом деле в подвесим реализовали у как тип данных отдельный тип данных используется dot наташин ну то есть доллар и тогрут и дальше точечками деляет сказать ключ иерархии все более менее понятно и и все просто то есть массивы видите квадратных скобочках и через ? вы можете указывать фильтры их может быть много фильтры это как раз то над чем вы не можете делать операции внутри то есть вот этот знак о собаке это оказывается текущей контекстный элемент то есть значение вот этого ключа увидеть там a b c вот из его взяли еще и кстати его значение и мы проверяем больше десяти достаточно гибкая гибкий язык к нему можно использовать методы видите прицеплять type says дабл там floor и даже есть дейта им вы знаете в джейсон не поддерживать daytime но вы сквозь sony они сделали тип поддержку daytime они ведь и хранения даже не видя материализации а видео вы можете использовать ее для проверки внутренних условий фильтрах вот это у нас серенький потому что самом деле 12 версии мы daytime не поддержали не включили я вам могу сказать почему потому что в пузырьке потому что мы хотим чтобы джейсон паз был ему то был тип данных ну то есть по нему можно было строить индексы вы знаете что в возрасте daytime он не очень-то и ему то был зависит от time zone и то есть зависимости от зоны для этой может возвращать какой-то абстрактный результат и поэтому собственно говоря она ищет если мы вы включили эту поддержку с прямо вот сейчас мы бы потеряли бы возможность сделать яндекс и по джейсон полосу а это очень глобальная штука и мы решили этот ложить пока жили без daytime и как-нибудь ещё поживём за это время мы подумаем как сделать то лучше у джейсон паса имеется два типа это очень важно лакс и strict но понятно что джейсон пас он работает джейсоном а в джейсоне отсутствии ключа не является ошибкой большинстве случаев и поэтому вот этот лакс но такой лак с мода она является по умолчанию то есть все структурные ошибки она нивелирует ну ладно нет включая нет но если вы хотите сделать строгую проверку то вы пишете strict и тогда будет кричать про ошибку если кого-то у ключа не будет то есть вы будете стучаться какому-то ключу его не он будет подавать ошибку но по молчанию лакс вот внизу видите выражение джейсон пас то есть мы берем все этажи все квартиры это мы тоже и проверяем их площадь более менее понятно всем до всех тут программирует на любом языке это операт этот этот язык понятен будет вот есть примеры как раз чем отличается lactis strict вот медь и например первый запрос нет ключа мы обращаем скручу б а его нет в режиме лакс мы получаем просто фолз вот а в режиме strix мы получаем ну то есть вы можете говорить что у нас этого нет нашему как бы ошибкой вот все массивы разравниваются то есть ли нерф делаются плоскими в режиме лакс то есть вот вы видите один два три и в этом вложены массив три четыре пять и мы проверяем на то что какой то элемент равен 5 в режиме лакс мы получаем вот нормальный труп вот в режиме strict вам нужно сделать вот так вот строго написать то есть понятно да что встретьте вам придется строго следовать иерархии только ты иерархии а в режиме лакс вы можете просто написать то чтобы пузырь из-за вас сам развернуть эти массивы и проверить что то такое но это вот такой джейсон и так обычные люди с ним поступают достаточно свободно вот мы взяли как сказал что джейсон паз у нас реализован как тип данных соответственно для него есть операции для него из индексы и собственно это как бы подрисовывать ip-адрес новый путь хотя стандарт на самом деле описывает его просто как string как строку вот ворог или скажем миску и лил рисованный как тип данных а как строка контейнер внутрь и как бы как-то запись но у нас антип за нах это дает нам какие-то выгоды вот пример видите джейсон который описывает двухэтажное здание вот это же там адрес apartment и так далее так далее если его визуализировать это дерево джейсона выглядит вот таким образом и вот джейсон пас выражении записаны в заголовке она выделяет вот как вот эти зелёненькие то что зелененькая то есть вы видите мы берем все квартиры на этажах и 0 и 1 да и от 1 до последнего как мы знаем джейсоне идет от 0 поэтому здесь выделяется 1 левая квартира она вообще не выделяется то есть мы взяли только первую вторую этот пример просто показать визуализация например вот как выглядит запрос в адресе первая строчка сейчас и как вы вам пришлось бы этот запрос написать в 11 версии ну видна разница видна что первое сейчас вы пишете приятно логически да понятно строка да и все приятно это еще ничего вот например есть вот такой запрос например найти любую строку в которой содержится москва о джейсоне джейсон паз и вы можете написать вот такую элегантную строчку что мы берем две звездочки то есть независимо от уровней иерархии да то есть мы ищем что то что содержит москву на стандартном иску или в 11 версии вы вы должны написать вот большой такой рекурсивный цветы я и так далее то есть конечно выигрыш очевиден и приятен то есть мы закончили вот такие функции для джейсон паса то есть две бульон функции это мы проверяем на существование ключа значит матч на сына предикат мы берем запрос который возвращает иску или дже су найти мы то есть именно то что вы выделили с помощью jason jason паса вот можем забрать пить это в массив и можешь взять первый элемент массива но такой функциональный api который сейчас доступен вот уже он позволяет делать массу всего приятного хорошего все они имеют одинаковую сигнатуру то есть у него первый аргумент это джейсон бер второй аргумент джейсон паз и дальше вот самое приятное вы можете передавать переменные в это джейсон паз у столько передать переменные в то есть внутри джейса паса вы используете какие-то переменные а вы с помощью например вы можете передать значение с какой-то таблицы виде переменных внутри тот же и сантоса это вот такая штука приятно и вот у нас есть ключ такой silent это означает кричать когда ошибка или не кричать ну такой у нас по умолчанию это фолз здесь примеры вот примеры как используется эти все функции они достаточно очевидны и для операторов джейсон бер джейсон пас мы ввели несколько операторов вот операторы оператор экзист и оператор матч которые имеют так куда так пардон здесь просто кнопочки разнесены обычно интерфейс когда влево и клавиши влево-вправо правоту такая со звездной кнопки вот индексы то есть эти операторы можно ускорять индексами и самое приятно что работают стандартные индексы которые уже существуют в жене для джейсон бер те же самые индексы поддерживают джейсон пас вот но кроме этого то есть на существование ключа значения вы можете прямо сейчас сделать но кто знает что кое-что есть же сквере вот тоже никто не знаю да или кто-то знать же сквере то есть если вы хотите делать операции сравнения например и например больше меньше или более сложные операции включения до то у нас есть специальное расширение же и сквере на гитхабе вы легко найдете в нашем гитхабе джен сквере он поддерживает там есть поддержка вот этих операций для j сантоса то есть для значений внутри из же из запаса вы можете например больше десяти и ускорить эту операцию то есть индексы это все делается в же сквере и то есть там такой ветка скули джейсон мы собираемся как раз через месяц сделать релиз новой же сквере где будут все это по умолчанию поддерживаться вот как я сказал daytime метод не поддерживается 12-ой версии вот мы все арифметические ошибки фильтрах как бы подавляем вы знаете что фильтре на 1 можете вот или видите выражение поделить на ноль вот этих фильтрах эти выражения они и под них не приведут к появлению ошибки ну поделили на роль поделили сами дура виноваты вот на самом деле скули джисона написано много материала то есть у меня есть презентация большая презентация вот есть введением скале джейсон документация и у меня все же есть сказать несколько таких больших постов происходит через он про настоящие что будет будущем и так далее будущее прекрасно и поверьте c т е к ц т.е. знаете что красота это ты был expression вот эта картинка как раз кто понимает эту картинку soul ломится его не пускают кто понимает вот те кто знает что такое toyota и это знаете это блог для оптимизаторов адреса то есть выражение как написано и внутри ct и оптимизаторам не трогается и этот хак люди всегда использовали в своих целях так вот сейчас это не будет работать если вы не использовали этого хака вы счастливчики датской но я отвезу здесь лица такие которые не понимают появится вот внутри этого выражения ct можно писать довольно сложные вещи и которые принципе могли бы еланец его в целых запрос и optimizer мы оптимизируем вот целиком весь этот запрос но из-за того что в полисе до сих пор это является блоком для optimizer плане лизин то есть выражение в выражение внутри это как бы временная таблица она материализуется всегда только абате время таблица материализуется для сессии а вот с этой и выражение в она материализуется только для одного запроса вот и люди которые хотят чтобы при многочисленных вызовов вот это вот и я ничего не менялось они используют вот этот optimizer то есть как бы этот этот хак кто знает вот lime limit of set 0 вот есть можно писать такое выражение и написать офсет 0 то есть ничего не говорит ни о чем да это тоже хак для оптимизировали выражение не будет оптимизироваться то есть вы знаете что es que el выражение они бывают многоэтажные большие и optimizer овцы обычно берет все это выражение и начинает оптимизировать то есть строить дерево запросов оптимизирует смотри какие индексы используются не используются то есть выполняет большую работу но иногда люди считают что он ошибается и тогда люди начинают окружать вот этот кусочек под запрос например какой то начинают окружать видели видео то 20-е либо пишут офсет 0 для того чтобы optimizer отодвинуть вот сейчас с это я на самом деле это достаточно каковым ваня панчами уже говорил достаточно опасная штука вот она во-первых вы знаете что она использует туркмен то есть если вы написали цзы много таких этих выражений да и каждый из них использует воркман вы можете что вы можете легко прийти к свапу это надо помнить то есть в состоянии является такой серебряной пулей логические ctr вот написано у меня она эквивалентна под запросам то есть если у вас имеется под запросы но смотрится довольно ублюдочная скажу так а когда вы пишете я смотрится хорошо вот оказывается выражение spot запросам оптимизируется оптимизаторам а выражение написано ты и я но не оптимизируется поэтому результаты могут быть отличаться вот так скажем пример вот это могущество это я то есть videos вот это я нарисовал прямо под здесь и песку или вот это выражение набрал и с помощью вот этого рекурсивно ты я нарисовал что это такое справа нарисована кто знает до фракталы мандельброта вот видите люди ходили в школу так вот нефть несколько очень интересных фактов про спектру не все знают ct которые записывают они всегда исполняются даже если вы их не вызываете то есть вы поете вы можете подготовить эти все стая а в сосновом запросе и просто не вызвать так вот right about staat будут исполняться всегда не думайте вот те которые цветы я не райта был и которые не вызываются они не будут не будут вызываться вот пример искать показывают как ты работает как я сказал это black box черный бокс для бти mizer а вот здесь пример показываем что запрос об select an вот видите написан сообщили там 1 и запросто т.е. они принципе логически эквивалентные просто красивая запись внизу бы более красиво пишите вот у на самом деле результаты могут сильно отличаться то есть например запрос с этой а может быть вот здесь в сто пятьдесят тысяч раз медленнее чем с об селектор то есть вы сделали как бы красиво а 150 тысяч раз стали медленно начинайте чесать носит голову выдирать волосы это надо понимать что до 11 до 11 версии включительно это так и работает то есть на самом деле сейчас в 12-ой версии за к мите льва такую штуку как везде вот везде ctr рассматривается как вьюшки а у нас рассматривать как материализованная девушка так вот сейчас можно выбирать видите меню пишите ultricies not matter alive то есть вы говорите что вот это выражение внутри ct и не материализовать не материализовать это будет приведет к тому что optimizer будет использовать его для ну глобальной оптимизации всего и как вы видите это умолчание не материализация то есть можно сказать впервые в подписи изменили умолчание я вот не помню чтобы то есть если раньше по умолчанию материализовалась то теперь по умолчанию не материализуется кто это использовала это надо как бы хорошо задуматься вот при этом вот ведь райта был всегда материализуется рекурсивный тоже всегда материализуется вот два примера видите когда новый дефолт мы видим нормальный индекс нормальный план используется яндекс и вот справа старое поведение она отвечала как материал айс мы видим что используйте sex com index не используется и так далее вот почему это вот вы и потом внимательно сядете да и посмотрите на слайде и догадаетесь как это работает на самом деле если cynthia используется несколько раз то писали вымани материала с ним не писали она все равно будет материализоваться потому что пузырь считает что если он используется низко роста давайте мы его ну как бы материализуем сохраним результат и будем использовать поэтому чтобы этого не делать вам нужно специально написать not материала ест не-не-не-не говорить что по умолчанию not лучше вписать но вот материала сюда быть гарантированы вот такая хитрая societe подстава 12-ой версии вот то есть нужно написать явно not материала ест рис примеры вот так что в сад и и мы выяснили теперь мы выходим к н н о к н н означает поиск быка ближайших соседей это очень распространенный запрос 15 говорит хорошо как выглядит запрос найдите 15 ресторанов 10 ресторана поблизости то есть кажется выглядит вполне естественным да ну или на иску или вы его не выразить и вот так просто потому что нету вот этого вы а clause вы не можете взять в вы хотите просто 10 ближайших сторона это вот типичный запрос каина на и в адресе он реализован сейчас нашей командой вот он очень эффективный позволяет вам с помощью индексов делать эти запросы очень быстро потому что раньше обычно люди делают хак какой начинаешь бесконечности и делим потом пополам или начинаю с нуля и увеличим расстояние по-больше приводит к непонятному количеству запросов там да потому что например в париже действует ресторана вы можете найти прямо в ближайшие окрестности а в сибири 10 ресторана вы даете ради там тысячи километров надо круг рисовать то есть непредсказуемая производительность поэтому кой она как раз он от вас этого освобождаете я уже не буду здесь дальше говорить вот потому что времени мало но на слайдах все это есть и вы можете понять как работает кнн видите то есть здесь я специально постарался для вас то есть вот дерево запросы и кнн вам экономит гигантский экономит если в обычном случае вам нужно сделать сиквел скан отсортировать все расстояния и выбрать 10 ближайших то в крайне не вам нужно сделать логарифмы на операций то есть чем больше база данных тема выигрыш от вам от кнр водкой нам можно рассматривать не только в виде расстояние физических любой объект для которую вы можете ввести понятие расстояния вы можете использовать кнр например вот в 3 граммах реализована поддержка кнр то есть там расстояние определяется виде количество разных от 3 грамм уходящих слова таким образом вы можете находить ближайшие слова похожие вот вот здесь пример показывается что как насколько сильно ускоряется кнр и вовсе сейчас 12 в релизе кнн закомитить для поддержки спогис то вот мы сделали здесь здесь на этих картинках показывается что это очень хорошая и полезная фича кнр speedup кнн для b3 его к сожалению успели для нас эту версию загоните но я его таскает оставил для полноты covering индекс что к камере нет яндекс обычно в подписи все любят индекс английском знаете что такое низкого риска это когда информация нужная для запроса вся содержится в яндексе и тогда вам не нужно ходить в хип тратить время на всякое vcc и так далее но там есть условия а просто сразу из индекса выдавать результату запрос пользователю так вот если вы хотите например 5 колокольчик выдать select a b c d и да вот это означает что вы в яндекс должны впендюрить эти пять калачик и они будут портить индексом самом деле то есть они будут находиться во внутренних узлах и так далее так далее так вот covering индекс covering фича позволяет вот эти 4 к1 колоночки по колоночки а вы строите яндекс а вот все остальные четыре колоночки вы просто складываете сбоку рядом и получаете индексу инн и в сумме стран получается весьма весьма очень такой хороший вот до сих пор covering юргис работал для b3 от в 11 версии 12 появилась поддержка для гис то вот например мы сделали писать вот эти запрос вот по этим многоугольником это москва центр москвы в виде всяких многоугольников реальные данные и попробовать сделать запрос найти поставить точку и найти сколько но вот этих квадратиков содержит точку гигантский запрос очень сложные но сложные для базы данных с помощью covering индексом и вот сделали всякие такие исследования показали что грубая вот где стул и и кавери нет яндекс он дает имеет свою пользу и он достаточно хорош вот с индексами была проблема по стала какая то есть когда вы строй индекс каждая операция записи на диск приводило к того что вы каждая операция приводила тому что появлялся вал вал запись вот сейчас сделали оптимизацию мы строим индекс просто строим индекса ничего не пишем а когда построили мы просто его прочитаем это дерево и записываем вал грубо говоря что если что-то случилось сломалась ну и ладно и дык заново построим да но зато мы экономим вал посмотрите во сколько раз вот сначала было был 3 гигабайта водстрой lindex это трафик воловский то в 12-ой версии это 400 мегабайт ну то есть девять раз уменьшился трафик что-то трафик вала это означает что ваша сетка до нагрузка на диск там и так далее так далее то есть все понимают что volta вещь серьезная то есть это очень качественная классная штука причем это сделано для гис то для джина и для и спогис то при индекс конкорд ли ну тут гэбэшники должен сказать наконец-то потому что в продакшене до хочется делать делать 3 индекс до в конкурента не надо эксклюзивы и локи там и так далее все теперь это есть а исключение только системной таблицы системной таблицы так сказать нет поддержки ну и ладно report прогресс тоже приятный для дачников теперь можно просто-напросто смотреть как идет по операция crate яндекс или яндекс то есть вы видите сколько процентов сколько там tube love так далее то есть можете сказать что по жду я обедать или все-таки мне посидеть да то есть теперь это есть 12-ой версии дальше мы переходим к благо был сторож вот здесь я взял слайд из лекции stone брейкеры майка где он написал про postgres что пузырь из внес мировую на что ленский баз данных это юзер define типа ну то есть грубо расширяемость триггеры и но аурой старик кто не знает даже на самом деле изначально позовите как раз и был этот стоить санду ногам то есть действительно одна версия лежала она ищет свежие happy остальные версии лежали get далеко и у нас был еще time travel я это застал сейчас у нас не так у нас сейчас все версии лежат в хиппи и это приводит к чему это приводит блату вот тому самому раздуванию раздуванию таблиц вот так вот сейчас сделали блага был сторож и pr вы видите что теперь можно сказать кредит access method type ты был например да там вот вот можно моей старой так далее сказать на самом деле так опять не туда нажал вот если вы посмотрите на вот эту картинку так на эту картинку то слева это то что было видите вот эта архитектура пузыри со а справа просто напросто добавился слой доступа к таблицам не просто хит встроена а некий слой под которой можно подсовывать разные виды 100 рублей вот всего лишь на rsi вот это изменение но привело к тому что на самом деле работа гигантская нужно было перри потрошить кучу всего потрохов вот но вот это сделано и закончена и сейчас на самом деле вот уже можно сейчас посмотреть например ведь вот пример crate able easy хип хип остался как сторож потому что так было но это просто он уже не встроены по умолчанию вот что собирается поддерживаться в нём и мы надеялись что появится новый тип стороже z hipp это как раз тот самый он дул санду логом вот но к сожалению я как я вижу по коми там эта работа казалась слишком сложны для одного релиза и мы ожидаем ее надо в 13 версии вот то есть это действительно так вот урок ли москвы леску и сервере там старой версии лежат в разных местах нефть не в таблице вот и это приводит к тому что у вас действительно нет болото сейчас вот видите у нас имеется все версии лежат вот таких цепочка ход цепочках а мы придем канду цепочкам то есть у нас видите вот хип там одна версия остальные версии то в другом месте я проверял этот плач и действительно там дело миллиона апдейтов и размер таблицы не изменился абсолюте вообще это мечта для всех вот мы надеемся что это будет так пять минут хорошо партиции переходим партии шингу теперь можно теперь делать просто любые выражения для acronis partition просто пишите это тоже многие люди хотели это теперь возможно вот дальше runtime партий schimb running palmer band это такое умное название на реально означает что уже можно во время исполнения откидывать те партии которые не нужны ну например вот видите внутри sap select select 5 категория до во время плана и планирования оно неизвестно она становится известно только доведет исполнение его теперь оказывается можно теперь видите вот там написано для партиции откинуты используется только одна это вот мерча пьян было очень люди жаловались что когда вы вставляете в 10000 табличек до импортирован этом to insert of было 96 всего tps of insert в секунду 12 версии по видеть это 17 тысяч то есть вы теперь можете с нормально вот дальше есть просто не протестированная таблицы до 19 вещь самая быстрая но теперь вот даже в десять тысяч партийцев можете вставлять почти такой же скоростью по моему это большая победа да дальше френкель кто хотел френки есть такие извращенцы то есть вы фарин кейна 10000 таблиц пожалуйста пожалуйста делайте стреляйте сигналу вот это сейчас можно append вместо мер джапин до для партийцы где есть уже о darling объясняю вот у вас идет time time series у вас партиции таблица попытаемся под время я протестирована и вы хотите сделать выборку сортированы подпадал под а ему по времени это что означает означать что вам your shopping не нужен кто-то умер ship and вы по всем табличкам собрали с мер жили и вы дали результат а здесь уже все отсортировано изначально хорошо поэтому вы можете даже не ждать выполнение всех запросов как только что-то появляется сразу выдавать пользователю обычный append это сильно быстрее удобнее меньше ресурсов вот те кто страдали от того чтобы не могут посмотреть 10000 табличек у них не истери команда дпв песку или backsplash dp и вот она показывает вот эту всю вместе с размерами месяц всеми потрохами это такая простая ну то есть любители тост декомпрессия кто знает что к тост вот есть несколько людей что будет в позлить если будете хранить например большие записи длины вы знаете что у патриса размер страницы 8 килобайт по умолчанию и есть такое требование что на одной странице должна храниться не меньше 4 записей alas запись 100 килобайт или у как любит любите с джейсоном один гигабайт джейсон или 100 мегабайт джейсон как возраст это делает а вот так оказывается он туда в табличке оставлять ссылку на какую то там хранилище где там вот это все добро лежит вот это добро где лежит называется толст и она устроена так что она комп рисуется а потом режется на кусочки слайсы и вы можете бегать вот так проблема в том что иногда вы хай вы хотите взять кусочек да и вам приходится 1 комп рисовать всю этот 100 мегабайт штук уоллас это в начале и дать находится вот сейчас оказывается везде дело сделали частичную декомпрессию как только вы рожали столько сколько вам надо все останавливайтесь вот это конечно не идеал но это уже очень хорошо вот и видите вместо 400 миллисекунд мы получили 10 миллисекунд вот это для такого префикс снова поиска это тост большое такое выигрыш мы естественно решили поэкспериментировать с джейсоном а как он будет работать джейсоном сожалению 12 версии не поет но джейсона мы получили вот такие вещи то есть мы сгенерили такой глупой джейсон с ключами и вот видите четверка там двойка и до одного мегабайта расположили так и стали смотреть время доступа к первым ключам их последним ключам к примеру ха какой вот здесь фишка джейсон бер знаете что джейсон by ключи хранятся сортированы me вот знайте то есть поэт по имени ключа по длине ключа и по имени ключа так что принципе можно будет использовать вот эту частичную к прессу так что наиболее важные значения коротенькие да вы храните в ключах таких кей 1 кей 2 а всякий мусор танкиста из мусора уйдет туда и вам никогда не ну не вам не будет мешать вот мы сделали эксперимент действительно первые пять ключей за десять миллисекунд забирается 7 ключ за 48 миллисекунд а 10 ключ за две миллисекунды за 2 секунды разница существенная поэтому это такой хак так финиш говорят хорошо у меня сколько минут на вопросы до 10 минут на вопросы но если вы будете задавать вопросы вот по теме но если я мог бы до конца рассказать но ладно давайте вопросы да спасибо как раз про то он хотел уточнить все время все рассказываю что не надо хранить много данных у вас лишние данные в базе отличный пример всегда для этого это айтишник и джейсон совсем данным добром и до сих пор не как его нельзя заставить хранится в новости что поедишь нику и нормальным данным ходить реляционными запросами а в толстом раз в тысячу лет что-то забирать если нужны подробности вот я же показал вот вот этот хак он как раз вам это даст он даст я так понял распаковку начала но он будет на каждый запрос и она лазить в тост нет для ты нам в принципе нужно нет забрать что-то в тост лезут а что больше двух килобайт и всегда все что если мне все нужно это джейсон там очень редко используется я знаю что он мне не понадобится но я понимаю его при joy нить можно отдельной таблицей ну вот заставить эти два килобайта да и леска какой-то в 11 версии его немножко поменяли заставить под грыз хранить тост отдельно как-нибудь вот золотая мечта наша сделать переписать тасс так чтобы можно было его контролировать вот как раз как вы говорите например хранить не не компрессировать весь разделить на кусочки а например и поделить на кусочки и компенсируют кусочки так что вы могли знать какой кусочек вам нужно раз компрессировать вот эти все фичи как скажем кастомная компрессия это относится тоже к станкам прессе то что сейчас используется или z компрессии для всех типов данных но мы понимаем что некоторые типы данных можно было очень эффективно сжимать какой не другим алгоритмом вот это все мы написали наш род map золотая мечта есть но пока дорогая не дано уже что-то сделали то есть префикс на декомпрессия уже есть спасибо давайте вот я бы он пока я туда все тут ошеломлены до 12 release кое что очень сильно очень мощно потому что здесь еще например такие вещи как концевые листы добавлены то есть я вам листают видите в документации наконец появились фигурки то есть до уже какой век да вот здесь сообщества еле-еле договорилась что давайте использовать фигурки вот и вот уже тает прямо личная скальпель и df комплект документацию вот уже вот здесь g морские индекс нарисован этот большой пример generating calamus те кто одних мечтал давайте вот вопрос давайте вы думаете вопрос здравствуйте и спасибо большое за презентацию хотелось бы конечно до конца ряда слушать вопроса такой если какие-то мысли как бороться с картами и прочих ликвидирован ими функциями который очень медленный каунт медленная функция аккаунт есть ли какой-то solution может быть папе ну магия понимаете пока у нас есть сторож то есть вам придется эту магию изобретать самим например подсчитывать например если вам нужен строгий каунда вы ничего не особо не сделать кроме как держать приложение но как бы табличку сами считать если вам уже не строги galant может взять например из индексов да там в яндексе есть книга поддерживает как аккаунт вот я не не знаю насчет того что насколько будет если мы сделаем сторож отдельный вот не в царстве например да это возможно там как раз аккаунт будет нормально быстро и но я вот про это честно не скажу что вот z тип скорее всего вам может помочь может не помочь все равно версии последние будет руках лежать вот каунт и да а кому нужен точный каунт обычно вот в маске приложения им там вообще плюс минус там чего-то да да да я таскаю вот я пока тут люди думают вот виде дженерики calamus кто-то мечтал про них это рискуя стандарт теперь у нас это есть колонн теперь можно все фитинги в explay не знаете выйдет делайте в запросы тестируйте запрос а перед этим сделали кучу сетов вот теперь можно эти сеты тут же смотреть для того чтоб потом воспроизвести очень классная вещь отверстия logo теперь в камере в комитет риск версия теперь вы можете промыть стендбай сервер прямо из иску или то есть select позже про молод и у вас откроется он он стал мастером так водить вопросы да вот такие вещи лог сэмпле кого не ловил он говорил под чип сумму им полезно интересная штука появилась добрый день дарси база доклад а подскажите решена ли проблема с abs артами импортированные таблицы возможными они теперь вы узнаете эту историю нашего 11 версии ок обитель а потом ее раз к метели вот а в 12 версию просто решили пока тоже не комитете совсем добавлять и расскажите у нас есть есть insert он он конфликта то есть принципе как бы это но это несколько и стандарт но оказалось что в подписи вот такие перфекционисты что правильно реализовать и вот этот самый и сертан апдейт очень сложно вот целые 2 презентации большие презентации если эту тему почему это сложно вот сожалению действительно или к счастью в подписи очень-очень-очень юристы они вот хотят реализовать что это было хорошо строгой рон того что все знают что вора клей в москве или съесть такие камни подводные с этим insert он апдейт которые они очень приятные forex хотят их избежать но пока вот не получается у людей действительно вот чик суммы точек суммовые используют сейчас идет вопрос к тому чтобы сделать и не db чтобы и checksum и включались по умолчанию если вы заботитесь о своих данных в делайте эту опцию минус к чтобы были чьих суммы или вот сейчас вы в 12-ой версии будет такая утилита позже чиксу может именно дизайн был и не был она будет в оффлайне просчитывать эти блоки и сама проставляет все то есть как бы некое облегчение вообще вот я хотел вот этим хладен закончить вывод о том что действительно для большинства задач и вам нужен только погрыз и все остальное на счету до спасибо за доклад правильно ли я понимаю что в двенадцатой версии лучший дела обстоят с контролем целостности да как благодаря чек суммой да ну не всегда были чиксу мы просто сейчас появилась утилита которая позволяет ими оперировать сожаление в онлайне то есть надо потушить серверы сказать и не был checksum она просто все пробежит по дата файла мы просто вид страничкам ну давайте принципе вот вы сегодня с утра со мной не побежали вот если я все мы могли бы очень хорошо пополнится поговорить со мной бежал только два человека вот ну или была ли с питером кто будет нас тачки нет что нас тачки я как раз тоже организован по две совы пробег мы будем бежать вдоль набережной я буду отвечать на вопросы по полу лицу давайте еще тогда вопрос немножко не про новый подвеса вообще пропала сгрыз и readonly транзакции они с одной стороны много рекомендуется другой стороны мало используется насколько я вижу она в подгрести реально актуальна вот так чтобы мы сказали что транзакции readonly и сняли часть нагрузки сервера или она так все угадает нет если вы скажете стандарты с транзакции readonly у вас не будет генерится косит это защищает что вы будете экономить вот эти эти транзакции и wraparound к вам придется сильно позже но он все равно будет ждать что это последняя транзакциях вдруг не что-то произойдет и нельзя там ничего от меня не говорите сами вы говорите begintransaction readonly мода да и тогда уже пуговиц точно знать что никакую там вы гарантируете то он может что-нибудь за оптимизировать там за фризить странице как я ведь после этой транзакции сейчас вот и когда сколько я знаю вот потроха да ничего сверхестественного такое не делается кроме как того что для readonly не делается генерация едет рад акции но это тоже уже существенно экономя ресурсы если например у вас молотилка которая там миллион миллион чтение с базы до у вас вы сэкономите миллиона и транзакций это вам в этот ад отодвинет от вас карающую десницу вакуум вал все остается как и было до нету как вал для readonly он не не верится тоже экономится у нас спасибо да спасибо большое за ваши вопросы выберите пожалуйста лучше лучший вопрос это было не очень много поэтому появляются лучше вопрос сейчас кажутся хочу сказать кто так ни одна девушка не сказала я бы так девушка бы быть легко бы выбрал бы вот-вот молодой человек он наиболее активным я в действительно проведенный транзакцией сказал кто не знал кстати эта информация может быть полезной так что я еще здесь и что интересно вы спрашиваете сможете проползли сможете про все остальное вчера я рассказывал про про горы вот опять же пришло не так много вот но все таки вот все спасибо большое за доклад"
}