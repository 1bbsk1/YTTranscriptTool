{
  "video_id": "C1C8pSZYYJE",
  "channel": "HighLoadChannel",
  "title": "Разгоняем ASP.NET Core / Илья Вербицкий (WebStoating s.r.o.)",
  "views": 1840,
  "duration": 3418,
  "published": "2018-08-16T04:43:50-07:00",
  "text": "сегодня мы поговорим с вами платформе а этот нет корр последний платформе от microsoft для разработки приложений а также что делать если она она тормозит начала низко слова обо мне меня зовут и любицкий последние 15 лет я занимаюсь разработкой систем в область финансовых трейдинга электронной коммерции 1 момент является владельцем компании веб стал очень наша компания занимается разработка интернет магазинов для тех для того wordpress коммерс и комменте magenta это уже мало она sap и oracle денег не хватает и я использую тот на это начиная с первых бед и 2002 года сначала поговорим что такое современный год нет на данный момент существует 3 направления то есть тут нет тут нет фреймворк тот nightcore xamarin дохнет фреймворк это классический данных которые все мы знаем он работать на windows и используется в основном для разработки десктопных приложений и сервисов отработана windows или классический high speed веб-сайтов самарин это компания который купил microsoft несколько лет назад эта компания занималась поддержкой проектом о на их основной бизнес был это платформа для разработки мобильных приложений на языке си sharp для ос android и также они поддерживали mac os это было был платный продукт который стоил довольно дешево особенно если у стартап на майкрософта купил и теперь доступны бесплатно свободно можете пойти скачать и разрабатывать ваши мобильные приложения и dot net core это довольно новая платформа и на данными по моим три года если не ошибаюсь это новая инкарнация платформы dot net которая поддерживает поддерживает rings windows и mac она кроссплатформенная свободно и открыто и можно ставить и использовать скорее всего вы слышали такой термин как этот на этот стандарт iso результат лидкор чтобы все три эти платформы могли коммуницировать между собой потому что это получается куча кода который тоже как-то взаимодействовать кучу биотек microsoft разработал так называемый дот нэт стандарт это спецификация которая определяет определяет какой минимальный интерфейс должна предоставлять каждый год эта форма будь то тот фильм work или dot net core основная проблема которую стандарт пытается решить это повторное использование кода и на текущий момент существует версия 20 и основная особенность этой версии в том что они добавили режим обратной совместимости то есть в dts стандарт в первых версий когда разрабатывать вашу бид'а телеку вы должны были указать что данный библиотека поддержать такой the standard но как мы все понимаем за последние пятнадцать человек да то что это куча кода который кто-то поддержек тото не поддерживает который еще не перекомпиляции для использует один стандарт и во второй версии был добавлен флаг о том что если вы разрабатываете приложение над nightcore скачиваете просто какую-то библиотечку из муки то и в данном случае этот карп умолчание думаешь что данная игра течку поддерживает от and core соответственно по расчетам microsoft порядка семидесяти процентов существующего кода совместим сотни скоро будет работать с коробки соответственно 30 процентов у вас упадет где-нибудь и придет этой фиксить тед корд на текущий момент дат net core 20 это свободно реализация тот фреймворк как я уже говорил на кросс по форме на работает на практически любых операционных систем современно который можем сервер на десктопе соответственно вы можете использовать любой язык программирования си sharp sharp от что угодно вы также можете использовать любой редактор кода для разработки будь то visual studio бежал суде код атом или imax ну и наконец одно для меня одна из основных плюшек dot net core это просто в развертывании то есть если у меня есть linux-сервер мне не нужно теперь идти устанавливать ману основе с кучей пакетов я просто собираю моего и предложение копируя у нас на сервер запуская все работает с коробки до перед тем как мы начнем говорить о проблемах производительности и какие бывают косяки я хочу быть много философии которыми я придерживаюсь при разработке мы моих решений во первых надо понимать что мы не google я очень часто вижу проекта которые начинаются рисуется гигантская архитектура с кафка мериде сами прочими i'm cool для того чтобы отобразить 2 web странички с котиками соответственно не стоит это делать при разработке проектов или переработки при решении производительностью в частном случае стоит думать о топает таком политика кретинов investment то есть лучше предположим нас есть сто процентов производительности и мы можешь и 95 проблем использовать маленький фикс что здесь подкрутить на сервере и так далее и у нас ещё пять процентов на который мы должны пройти два месяца разработки соответственно лучше сначала пофиксите сделать маленький фикс учитесь 95 процентов профита а потом уже есть когда у нас будет время деньги можно подумать в этих пяти процентов и вообще стоит их решать также не стоит результате велосипед без надобности за то что я очень часто видел интерфейс проектах то есть начинается как-нибудь новый проект он начинает с того что люди пишут свой собственный лагерь свой собственный дальность injection и еще что то в этом роде плюс нужно тренироваться значение какой-нибудь конкретной задачи то есть опять же если вам нужно тратить страничку с котиками не нужно для этого писать собственный лагерь зрителю то что вот из коробки опять же существует множество инструментов которые стоит выбрать попробовать когда вы определились начать их использовать ну и наконец производительность в принципе проблем с по длительности это хорошее проблема то есть это значит что ваш отдел маркетинга поработал отлично у вас появились пользователи которых можно конвертировать реальные деньги поэтому проверять правильность это хорошо в 99 процентах случаев начнем нашу историю предположим вы запустили интернет-магазин все работает хорошо пир месяца вот отлично у вас там 100 покупок и за неделю второй месяц 1000 по продаже за неделю и вот через три месяца раздать звонок от вашего клиента с вами наш стать тормозит все пропало мы теряем деньги никто ничего не может купить начинаем разбираться первое что что я бы сделал этом случае опять же если это не production ищу которые куда нужно идти и сразу все fix на сервере я возьму страничку например страничку каталог подумала сайт google pagespeed insight это сайт который это продукт google и который анализирует вашу страницу и выдать рекомендации возможно можно что-то жрать какие-то картинки слишком большие так далее также он дает оценку насколько он ваш сайт хорош нам случае как вы видите все плохо в том случае если это какая-то корпоративная система и она недоступна извне потому что поистине сайт работает через интро этого приложения вы можете воспользоваться утилитой вайс low разработки ехал данная утилита если не ошибаюсь она не было обновлений течение последних может двух лет она устраивает но в принципе может дать довольно неплохой информацию что происходит вообще на вашей странице также на этом оценку и дать какие-то рекомендации после того когда вы запустите спешит inside запустили вай слову у вас есть хоть какое-то представление что происходит на фронте можно залезть в chrome developer tool sai посмотреть какие запросы идут на на ваш сайт при загрузке страницы посмотреть какие конкретные запросы занимают больше всего времени выполнения то есть сходите на танцы на счете больше всего времени тратится на загрузку самой странице потому что все наши артефакты стиле и джонс этот файл и загружать довольно быстро села в несколько секунд что же делать первое что я в этом случае сделаю я пойду реализую рекомендации от гугла потому что в восьмидесяти процентах случаев этого бывает достаточно история из жизни у нас было проект который работу нормально и вот один прекрасный день мы ничего не меняли последний месяц звонок все пропало тормозит начали разбираться оказалось что отдел маркетинга который занимается контентом у них удобством в миску они поменяли главную страничку сделали редизайн и загрузили туда чтобы 10 картинок каждый картинка по 10 15 мегабайт потому что хорошее разрешение ну и соответственно все упало переходим к рекомендациям первое что я бы сделал это посмотрел на моей стиле с люффой посмотрел можно наезжать случае сайт маткор есть пакет который называется build бондар minifee это разработка microsoft когда установить одну из пакет у вас появится конфигурацию файл bangle конфиг это джейсон где вы можете описать окей этих сжимать эти стили эти java script file и а также также вы можете сжимать ваш фактический html он поддерживает и системе лежать и если мистификацию также вас ждут nightcore добавили так help in warm and он позволяет вам делать разные настройки ваших стилей и скриптов отличие от вашего ремонта если можете написать если это продакшен тогда мы используем унифицированную версию если это девелопмент тогда мы загружаем сирен dream каждый стиль каждый стоит отдельно что было проще отлаживать если это не ваш путь вы можете использует стандартный дал грант или в пк я обычный спор мне важен чисто больше нравится в пк и используется в связке с in warm and the котором и так удобнее потому что ну копейки в гранте у вас будет больше возможностей они про это что-то большее чем просто сжать здесь бы хотелось дать небольшой ступени поговорить управление пакетами в вот но в принципе я думаю большинства знает внуки это стандартный меньше пакет для этот над которым все мы пользуемся интегрирован visual studio код в классическую бежал студию в monodevelop то есть используется повсеместно также существует пакет менеджер пакетов пикет это настройка на друге там который позволяет не только загружать файлы из репозитория она также загружать код из скит хаба работать как похоже на наколок по-моему довольно to be ok мы сжали наши скрипты запускаем наш профилировщика все рано тормозит следующим шагом я бы рекомендовал посмотреть что приходит с картинками потому что в картинке реальна весит много и часто и сжатия просто позвать проект первое утилита которая по сайту это и мы ищем мячик это набор из команды строки которые позволяют вам же сжимать изображение изменять их масштаб и так далее также существует dota это обертка для него если вы хотите его использовать исходы для динамического рендеринг картинок опять же если вы занимаетесь нами ческим рендерингом не стоит использовать стандартные классы из пространстве имен system / естественный windows media проблема вот в чем данное решение во первых работ только для windows вторых но использовать ком технологию и часто вызывают утечку памяти в принципе тоже на кроссовки рекомендуют их использовали для веба в случае если вам нужно работать динамическими картинками я сам пользуюсь г . или б.д. это кроссплатформенная биотик написано носить она чуть поменьше чем и мач magic на мой взгляд она чуть побыстрее соответственно нее есть этот вид обертку или если вам выехать использовать нативный код вы можете воспользоваться одним из этих трех решений и матч простой динамики мочили ему чесались они все принципе работают более менее одинаковое по performance это же более менее похоже хорошо картинки жаль и запускаем профилировщика не работает все равно тормозит следующий пункт на который обратил внимание это сжатии степи трафика данное решение не занимая не отнимают много времени зато часто помогает улучшить загрузку страниц в случае с соседка существует пакет исполинском причин который представляет методы для работы с компрессией по умолчанию идёт в поставке деды джозеф компрессия а также там определен интерфейс который может реализовать для того чтобы написать свой собственный компрессии полежит свой алгоритм это было бы данными можно использовать случае есть вас стендом серебра если вы запускаете ваше положение на аэс тогда вы можете подключить модуль динамиком кришна это модуля с про вопрос получать компрессию для всего вашего контента из коробки если вы будете использовать динамик если вы будете пускать ваш сайт на с тогда стоит обратить внимание что вы удалили response компрессами глыбы из вашего кода потому что в случае динамическом прессе сначала ваш будет сжат при помощи вашего медовая а потом еще аэс будет у пережимать такой маленькой особенность также вы можете запустить вашу запустить ваш вашего приложения за прокси-серверами джеймс если это ваш путь тогда можете оставить response компрессор b2b потому что джинкс умный и он случай если компрессии на странице джинс он будет автоматически удалять и степи кедры о том что ваш коммент подержит там прессе то есть ваше предложение будет давать обычные четырьмя а потом magic самого сожмёт так мы говорим обычно тебе стоит поговорить немножко новом сервере castrol разработки microsoft это новый observer программным кодом который может скачать посмотреть поправить это асинхронный веб-сервер который построен на базе для течки le beau вид который используется в но джесс соответственно ставится также из ноги то данный веб-сервер начиная с версии 2 до новых сервер вы можете его использовать как за engine кс прокси так как обычные веб-сервер который смотрит на прямую в интернет если вы используете более старую версию the microsoft не рекомендуют его использовать как стентон сервер всегда его нужно будет либо всего нужно прости за прокси из основных особенностей тесто можно отметить то что он поддерживает высокий thd ps любой нормальный сервер также он поддерживать поддержку unix акатов которые это позволяет улучшить интеграцию сын джинкс и так хоть бы сделать это имитация более быстрый то есть в данном случае яндекс не будет ходить сюда 6-5 в этот довольно простой во все рывка там существует всего другой 4 ручки которые можно подкрутить чтобы она работала быстрее стоит обратить внимание на параметр макс контент напишем то есть сколько конкретных клиентов может подключиться к вашему серверу по умолчанию сколько угодно также макс боли says это размер вашего эти цепи out put a который вы посылаете на клиент по умолчанию 28 мегабайт случае если вам вы собираетесь стримить есть наконец видео и так далее давайте скажем большие файлы нужно использовать request сайт лимит атрибут атрибут то есть вашем контролере помечаете метод что конкретно этот метод может потому дескать может быть а не знаю один гигабайт вот во всех других случаях я рекомендую ставить эти настройки по умолчанию также довольно интересный параметр мин request будет дейтерий данный параметр определяет скорость соединение между вашим клиентам вашим сервером по умолчанию 245 секунды то есть если клиент посылая данный на сервер и скорость этого соединения меньше 240 бит в секунду тогда kestrel observer будет ждать пять секунд и если это скорость ведения не улучшится просто заведение будет убита ну хорошо мы посмотрели попробуйте считаешь давать но все равно не работает то есть быстро починить нам у нас не удалась ну что ж тогда стоит подумать о вертикальный о том что железо стоят дешевле чем программисты подумает может добавить больше сетевой памяти покупаю сервер пожирней добавляем добавляем памяти очень часто это помогает прям очень часто в случае вот на этом тут нет корр это сделать не так сложно потому что во первых он поддерживать докер из коробки то есть можно сделать ваш сайт здесь ваш контейнер и купить сервер пожирнее носить что уши например также если вы охотитесь в claude то три основных cold провайдера either и ws и было отмечен все они поддерживают nightcore из коробки то есть заливается запускается и работает что же попробовали купить серый пожирнее все равно не помогает то есть что-то память значит что-то совсем плохое происходит надо теперь можно посмотреть что же происходит наши мышцы пипа плане для этого я использую мини профайлер не профайлер это небольшой профилировщика . которой вы встраиваете ваше а если предложение и она позволяет вам отслеживать грубо поля на что вас стать нормаль профилировщика это разработка старались чинче они и повсеместно используются при разработке stack overflow во первых вы должны поставить мини профайлер это собственно сама игра профайлер который который позволяет создавать красочные критические секции и трекать время которые на них тратиться если у вас классическая dot net предложение то я советую поставить плагин для инсте фреймворк данный плагин будет трогать все ваши запросы и давать небольшую аналитику сколько времени на что потратил оси как он так же умеет находить повторяющий запросам также случае с эм би си выставить 74 и теперь ваш провайдер будет тыкать сколько времени уходит на каждый контроллер на и на каждую их у он выглядит как то так то есть на картинке можно увидеть что что-то плохое происходит с нашим с нашими светил запросами мы мы запустили 104 запросу для того чтобы не дарить маленькую страничку вы также можете кликнуть число и у вас будет новое окошко со всеми запросам которым ли выполнено также я рекомендую посмотреть если у вас сиквел сервису запаситесь и рокфеллеров знаете что же там происходит потому что обычно дает гораздо больше информации чем мини профайлер особенно если вы много работать с базами данных что же конкретно в том предложение было просто так направлять след n + 1 то есть мы запустили мы выполнить запрос с помощью институт возили наши объекты потом бежали в цикле по каждому объекту и дергали данные на удивление это проблема встречается очень часто то есть я видела в куче разных проектов мое мнение по поводу р.м. это если можно обойтись без если можно обойтись без полновесной тяжелые рынке поинтов реймер лучше без нее обойтись воспользоваться кого-нибудь маленькими микро лагерем например дайте ram или уоррен light ну и плюс базы данных нужно знать если вы разрабатывать приложения для работы с базами данных и если аргумент который часто слышу по поводу rm что ну вот мы сегодня написали наш приложение для сиквел сервера завтра мы хотим и поддерживать по здесь у нас есть и мы возьмем поменяем нашу ставку соединение и все заработает к сожалению это не так то есть даже в случае с полновесный время придется допиливать и базу данных и приложений что ну и плюс очень редко выражение редко меняют базу данных и совершенно разработана для подвеса то скорее всего она с ним по окей мы оптимизируем вашу бандану на нашем в этом случае не помогло теперь попробую закодировать что не часто помогает случае с донатом . highscore частности существует довольно много различных варианта шивы и то как мы это можем сделать ну во первых существует интерфейс и memory кэш и его лиза стандартно лизации от microsoft edge который находится в оперативной памятью пошел вашего процесса и на вашем сервере если вас это не устраивает вы можете использовать распределенный каш из коробки поддерживается едешь и сиквел сфера куда же без него также на ноготь и существуют другие реализации пример для memcache следующие 2 2 так helper а это конечно дисциплина такая штат helper а это то чего мне не хватало в предыдущей версии спида над то есть если у вас есть ваша razer view вы можете иметь какой-то регион при помощи тогда кэш и он будет за купирован либо в памяти либо в вашем рисе или где вы храните вашу арджуна кэш очень удобная штука если нужно больше контроль над над кашам вы можете использовать в испанской аж от ребят памяти всему ваши методы и указать как вы хотите у кэшировать на клиенте ну если уже совсем все плохо и вам нужен низкого ранний доступ к что вы можете использовать испанская медовая и тогда вы прямо в ходе вашего метода может управиться с психиатрами и настраивать дело тонн вот тонкую настройку отлично за кашира вали начал работать быстрее на теперь нас памяти куда-то утекает в итоге стал работать ещё хуже чем работала соответственно надо смотреть что происходит нашу сборщика мусора вообще сборщик мусора это тема для отдельного доклада может тренинга на целый день поэтому здесь пытаюсь быстро прям пробежаться то есть вот этим ну так to sell or ломаешь happy существует два отдела первое это ларч обжиг хит это то место в памяти хранится большие объекты ваши большие массивы и были большие строки и второй раздел это мальчик где хранятся который управляется имя сборщиком мусора соответственно делится на три генерации любой генерация то объект который только что создали первое это те объект который пережили одну сборщику сборку мусора если ваши объекты пережили в первых генерации с не переживать следующую сборку мусора не прихода вторую генерацию то есть там живут самые большие так сказать долгоиграющие объекта до которых наш больше мусор никто не может добраться и обычно когда вас происходит братва мусора больше всего времени таится именно на сборку второй генерации соответственно существует два режим работы горючка лектора вдохните это фокси и сервер dc во встрече используется для доступно приложений до брейдаблик windows сервисе используются если у вас серверное приложение иногда брусьев или кинуть раз сервисы или для из перед над для каждого из этих режимов существует два под режима это конкурент и нам кантором части в случае с лишним или бэкграунд линдон канкан джесси случае с сервера я бы хотел остановиться на background джесси потому что это режим по умолчанию для испытать лето он работает следующим образом когда запускать ваш процесс в нем создается специальный отдельный поток для сборщика мусора данный поток мониторит вашу вторую генерацию и в случае если у вас нехватка памяти он начинает ее очищать но при этом не останавливается весь мир то есть остальные ваш рабочий потоки продолжают работать ну и соответственно случае если у вас происходит сборка мусора для 0 и 1 генерации то это всегда но он конкорд джесси ты всегда все останавливается очиститься и возобновляется из плюсов нужно отметить то что сборка мусора в 0 1 генерации краской довольно быстро потому что обычные очень маленькие объекты и этой первой такой огромной работы собственно как и сконфигурировать в классическом вот эти мы правим веб конфликт добавляем два параметра джесси серба идиш секондхэнд обычно это делать не надо то есть чаще всего из коробки все работает нормально а еще в случае с физическим год на этом я хотел бы отметить данный атрибут я 10 trim commit an lam эмре данный атрибут очень бывает давай очень полезен если вы в кузин компании или восхочется на одном сервере я не знаю 100 сайтов если вы включите атрибут тогда ваш а.с. когда поехал запрос приходит на сервер dota 2 для этому культу память ваш запрос отработал но память которая была выделена не освобождается молчание потому что ваше положение думают что возможно она сможет использовать эту память для выполнения другого запросов если вы включите данный атрибут тогда dotnet начнет классическая обожаю эту память и нас может быть использован и другими вашими маленькими веб-сайтами то есть это работает только для маленьких of sight of если у вас там их стада куча в случае если вас очередных core вы направите runtime конфликт и там те же сам атрибуты только в джейсон формате окей это в двух словах сборки мусора теперь про профилирование выжал студии 2017 даже комьюнити версии существует довольно неплохой профилировщика мяте то есть вы запускаете ваше положение в отладчике она что-то делает вы можете сделать снапшоты нажимаете так snapshot получаете ваши пшат нажимаете вниз как раз и вы можете смотреть что приходится памятью как она растет и насколько объектов дальше вы можете провалиться в конкретность шо-то посмотреть на какой тип сколько памяти выделялась также если у вас есть несколько что-то вы можете посмотреть разницу сколько дополнительных объектов было выделено между телесным сотами ну то есть и покопавшись покопавшись на моем случае случае с этим маленьким прежним которые просто есть память проблемы с этим здесь проблема с из статической переменный просто на растет каждый сколько 500 миллисекунд хорошо бежал судит конечно прекрасно чудесно но проблема с на сервере и не всегда мы чаще чем не можем запустить зажал студии запретить пропали профилировщика так далее тогда нам поможет нам на помощь утилита под названием первую она работает только для windows потому что использует по система событий ядра windows и w tym так называемые и давайте это по систем то есть которым которая разработана для ядра то есть ядро процессе работы посылают различные различные vento в их разработчики также можете использовать механизм чтобы послать различную мониторингу информацию астане вашего приложения и существуют программы типа первй у которую начинают сбор этих они начинают сбор этих ивентов а потом их всячески анализирует то есть в данном случае я прогнозировал мое предложение с ним рекам и на этом очередь вы можете увидеть какая гибкой генерация когенерации мая сколько места и как быстро она растет кроме того вы можете посмотреть какие именно объекты занимают сколько памяти и как они вызывают то есть можете данном случае может посмотреть что ларчик живет хитона занимая 98 процентов всей памяти приложения кроме того можете посмотреть можете сделать snapshot hippo конкретного приложения к тому же допущено и посмотреть как я объект у вас память и есть сколько они занимают места в довольно удобно хорошо посмотрели 1 первую запустили проанализировали непонятно что-то страшное происходит приходится вызывать тяжелую артиллерию в качестве винда bg винды bb это отладчик насколько я знаю он был разработан для не скоро в ней разработки носи это для ядра для драйверов то есть вы можете с ним от трека все что поднимемся для него существует плагины для работе 105 поэтому он остывает очень необходим особенно если отправлены продакшене то есть данном случае первое что мы сделаем это мы пойдем наш сервак и снимем дам памяти для нашего процесса после этого мы скачем на штампы и начнем анализ то есть это самый примитивный самый примите надо искать можно сделать просто брать как как она выглядит то есть здесь этой команды мы загружаем поддержку от дальше мы смотрим что у нас находится в хеппи начинаем статистике кто больше всего себя памяти дальше можем посмотреть например какие объекты типа string существует лежат нашим хиппи и пойти по конкретному адресу памяти значит там лежит отлично то есть это винды б.г. на этом сайте я хочу привести пример который также очень часто встречается в реальной жизни конкретного приложения я наверное сайтов 7 видел с такой лизации петтингом то есть кто-то пытается сделать прижим по списку контактов и он очень любит link то есть он дергал дергает табличку просто нас сортирует ее и дальше зажать полностью в память и уже в памяти он начинает использовать оператор тейк v-link чтобы взять только топ 100 записей в случае с небом если да и сам тоже если у вас большая табличка прочно нас который быть не запиши равана данный код отъезд кучу памяти и обычно это решается одним сиквел запросам так запрос написана для стекла server 2016 то есть там есть поддержка для при джинга поэтому надо быть очень осторожен когда вы используете link иногда можно получить довольно интересные эффекты ok ручной управление памятью то что поражает на слайде лучше не использовать подошли а если хотите использовать использую осторожно чаще всего данный подхода не применяется в вебе я сам я их сам применял только когда работала в область финансов для проценко сделок то есть во первых если вы хотите написать свой собственный аж вы можете использовать так называемый object class with reference microphones работает следующим образом вы создаете ваш объект то есть по молчанию он будет garbage collector не сможет его удалить из памяти потом пока на него есть какие-то ссылки если вы этот объект обернется вашу big leaf and тогда ваша бегают помечено для сборщика мусора что окей мы можем у вас пояс можно использовать можешь в удалить то есть если работе конференции ведь ваш объект смотрите был либо там есть флаг был удален из памяти ли не был то есть это для к шее если у вас какой-нибудь вы разорваться приложение которое работает например с различными сделками трейдинга vaio платформа иногда у вас бывает моменты когда вам нужно отключить сборку мусора чтобы лучше максимальный performance пиринг это можно сделать можно ставить относи мод в данном если вы поставите его состояние отнеси это будет означать что тут нет пастора что сборщик мусора будет собирать только объект из 0 1 генерации не будет трогать вторую генерацию но опять же это палка о двух концах потому что если в данный момент вы будете выделять много больших объектов тогда ваш сервис просто упадет потому что у вас кончится память поэтому старайтесь имени если вы хотите использовать старайтесь минимизировать регионы где вы используете lattissima и также постов когда вы вернетесь нормальный режим сборки мусора обязательно вызовите джесси collect с параметром 2 то есть воспитание запустите сборка мусора второй генерации если нужно больше хардкора можно выключить сборку сборщик мусора в принципе это делается при помощи price tag научишься регион опять же если вы это делали то есть данном случае вас полностью паркового сборщик мусора будет выключен и 0 1 и 2 генерация это обычная постанова это на необходимо и одна фишка core сила которая собственно только появилась в интернете вы можете взять свой собственный сборщик мусора и уже существует реализация как это делать окей мы настроили hdc а все равно тормозит ну не везет на значит остается только пенять на или на ввод-вывод или насыпью запускаем наш профайлер есть запустили посмотрели оказывается что наш текст этот метод в нашем контроллере что-то делает в чине 5 секунд чтобы следующее что мы можем сделать мы можем открыть наш код и использовать mini pro фанеры напрямую то здесь я хочу посмотреть сколько времени тратится на выполнение конкретно вот этого кусочка кода скрытная тебе запроса в итоге получается что у нас все работает нормально мало и наши степи запрос выполняется течение пяти секунд что здесь можно сделать как вариант вы можете запустить опять же в последний студии у вас есть встроенный профилировщика вы можете запустить ваш профилировщика посмотреть какая конкретно функция занимает больше всего времени то есть если вам нужно кого-то более низкого уровня анализ данном случае эта функция раз ты пьян и не было 5 бешик загруженных поэтому на у того выбрали также можете провалиться и посмотреть информацию о конкретном контроллер как это метод и так далее то есть довольно мощный штуку решение со время в данном случае так у нас идет из тебе запрос мы можем использовать так называемая асинхронной операции то есть как выполняется yspeed запрос принципе в аисе есть трек пул в котором и кажется прихватка запрос приходит на сервер а если да то это будет берет черный поток из пула и выполняет его в случае если у вас ваш степи вопросы если делать операцию вызов катишься запрос и если у меня синхронный the wasted который его выполняет он просто находится здание ожидания и другие запросы не могут его переиспользовать что плохо потому что по умолчанию вайс 5 по моему всего лишь 5000 потоков машине в 3 пули решений решается носитель на просто вы можете вы можете пометить ваш метод контроля ли как асинхронный и выполнять ваш допрос асинхронно то есть данном случае запрос на сервер уйдет вы запускаете ваш запрос но платок который запустил эту операцию вернется обратно в тпу лосс может быть использован другим запросам то есть вот так вы сможете узнать больше запросов асинхронной операции эта часть так как правило бери то есть это не только осинка ведь существует множество других алгоритмов и режиме то вы можете записать сделать правильный for each of our вы можете править досками отменять их сочетать правильный ринг то есть довольно интересная тема чтобы копнуть поглубже ok осинка вы быстрее и быстрее но это неточно очень часто можно слышать мнение о том что о отлично но даже если все асинхронный они все быстро работает давайте мы сделаем все нашего iphone приложение синхронном все будет отлично быстро работать к сожалению это не так осинка weight стоит использовать том случае если ваш код использовать много или нет у него есть куча запросов по сети в случае если вы выполняете какие-то вычисления что-то считаете асинхронной операции вас не спасут потому что вас и нагрузка идет на secu осуществить синхронными операциями когда вас много потоков вас происходит он за вами контекст свечей и ваш процессор дать время то чтобы переключить потоки то есть сейчас у вас против поток потом другой потом 3 соответственно если у вас украине работает количество дробилка она пыталась дольше чем вражда им это второй пункт и а если вы хотите разрешить пользу прерывать долгая операции что скорее характерно для доступны приложения чем для вы предложений потому что в вебе и прерываем как я уже сказал осинка weight будет работать быстрее если стоимость переключение контекста меньше чем затраты на на саму самому полне ней операции и до асинхронные операции не выполняются быстрее то есть вызвали ваш а теперь запрос который занимает 5 секунд он так и займет 5 секунд просто вы если вы используете синхронный вот вывод то вы сможете выполнить больше запросов которые будут вызывать этот ваш вопрос ну это не стоит делать упражнение синхронно потому что возможно даже невозможно скорее всего будет работать медленнее и наконец если вы жизнь ваше предложение сделать асинхронно поверили сепию померили память все хорошо но все равно что то тормозит в данном случае можно воспользоваться еще более тяжелой артиллерии и разбить наше предложение на микро сервиса и начать внедрять мисочки где это может быть применима в случае с лета светлана коммерции это часто применима при проведении оплата то есть ваши предложила что-то продаете пользовать вашу кредитную карточку в данном случае вы делаете запрос на интеграцию с банком или с вашим провайдером кредитных карточек чаще всего скажем так во многих проект которые видел это идет это идет синхронной операции и и тогда ваш сайт становится популярным то он начинает жестко тормозить если у вас куча продаж что в этом случае можно сделать можно ввести какую-нибудь музычку например этот этого может использовать редис вы можете использовать бенз такси рынке то есть практически для любой очереди которые мы считали это рынке существует обертку для и соответственно в случае с оплатой карточке . вы посылаете сообщение на ваш кризис что ok этот клиент хочет оплатить и ждете клиент приходит показать страничку что ваш ваш заказ доставлен и он в очереди ждите подтверждение так далее то есть здесь я показал я привел те ноги в пакеты которые я сам лично использовал в своей разработки также если обычного метилом достаточно выходите вас contender приложение где куча сервисов которые между собой как-то взаимодействует о нужна регистрация вы можете воспользоваться но и зале зации мы среди вас например интерес басом самый популярный бабич март нет ограбить в интернете самой стены быстро это в mass transit соответственно и все подсосные можно познать исходники как все устроено собственно вот и все что хотел сказать давайте подведём некоторые итоги во первых когда вы что-то пишете разрабатываете или фиксить и всегда думаете о стоимости вашего фикса то есть не стоит не стоит приписывать всю систему ради того чтобы исправиться там одну страничку так далее после того когда интер 1 анализ попробуйте запустить google pagespeed insight и посмотреть можно ли что-нибудь быстро похитить чтобы быть чтобы работал что было хорошо соответственно вертикальное масштабирование нас спасет может не стоит брать на холоде но реальной жизни бывает если масштабирование с мне не помогло посмотрите что вас происходит базы данных потому что процентах 70 случаях которые видел всегда ботаники были именно в том как люди работали с базой данных опять же базу проверили посмотреть посмотрите кэш ваш сборщик мусора посмотрите можно ли что то запиши ровать и потом уже правитель нормально поесть профилировщика посмотрите может как проблемы с цепью и так далее в связи выйти код ну и наконец разбейте ваш большой монолитными то сервиса спасибо добрый вечер спасибо за доклад вы рассказывали про то что приложение можно запускать на linux или mac os и собственно насколько я знаю и w тини тун на линуксе новокосино низ во вторых как дела с профилировщика my под эти платформы с проектировщиками и окна linux и mac os не запускал не знаю из того что слышал jetbrains работает над профилировщика то есть увеличить до как он dot профайлер за 2 года до 3 мая туда вроде jetbrains собираются ввести их поддержку то есть пока hdd и ассемблер не очень комфортно это совсем не комфорт это совсем не комфортному чтобы делать из поддержки linux с поддержки windows и mac os а на данный момент поддерживают этот карман поддерживает он бюро завода написали консольных приложений и они воды 50 для поддержки айс этот хор ой я не вечна и вода бросив поддерживать мне кажется пока останется только в этом стандарте потому что microsoft рекомендует использовать раз сервиса и вот последний год найти растирается писатель на очень просто добрый вечер спасибо за доклад вы упомянули что kestrel теперь якобы можно запускать без прокси перед ним до от в каких случаях это вообще нужно и приобрела а если вам лениво настраивать indilinx профита нет никого я не видел то есть и на своих местах не встречал особого вида спасибо ну я подержу коллег по поводу jetbrains действительно это мощность так инструментов и для тебе умеет оринга и для memory мониторинга разные методы мониторинга на век сожаление видел вижу studio то что новая появилась поэтому очень интересно было вопрос такой на моей практике я тоже разрабатывать надутый достаточно долго часто проблема возникает с луками причем иногда локи бывают в систем на системном уровне еще раньше чем разработчик что что-нибудь с этим сделаем например в парусах лог мог мог произойти при образчик при dense лизации сессии потому что сессии в режиме при конкретно доступе она блокирует все остальные потоки как я думаю что вы тоже часто сталкивались с луками но это никак не был освещено соответственно как вы решали проблемы log off или это все вы считаете видно будет профилировщика это один вопрос чаще всего это были видны профилировщика если profil если есть я запускал профилировщика сервера jetbrains а и и смотрел что там как происходит можно посмотреть в этом вин gdb он также помогает но если логина на базе данных можно посмотреть локи в базе данных снимай практике почему-то я чаще сталкивался с луками на базе данных может специфика отражение видимо да локи джуди билетами к что хардкор какая-то уже галерею из гораздо проще мне кажется способы как это ну я во первых поставлял мне пришлось разработать все-таки свою логику логирование которое в том числе я влез в ядро из ее снял информацию в том числе его внутри несистемный поэтому по всем пока у меня есть информация внутри приложения которое дальше может быть использован достаточно эффективно задать собственные разработка получается каждый раз комфорт нет но могу поделиться какими-то знаками может быть превратиться в какой-то open source можно кабинета данными второй вопрос если все практически на виду я заметил практически везде и где написано почему не performance counters самое первое простое решение посмотреть в них а потому что очень просто потому что по умолчанию спасибо за доклад скажите если у вас опыт эксплуатации подвинуться он скоро иначе на папорова листа эти проблемы у меня он есть на небольшой то есть есть несколько лет в которым которых мы сейчас переводим на linux пока что работает полет нормальный из того что видели это например проблема с затем картинок то есть до течки раньше не поддерживают тебя . ты показывал не раньше не поддерживали тут нет корр то есть там приходилось свои писать свои обертки вот как то так то есть особых проблем пока не заметил спасибо и вот человек еще который тут спрашивал про винт об игре не надо его бояться ничего сложного нету я тоже вопрос да ростки у меня такой вопрос когда создаешь новый проект от корды то майкрософтом везде вставляет асинхронные свои вставки даже на внутренние генерацию паршков то есть а вот вы говорите что вроде как бы не сабато нужно этим пользоваться то есть как кто прав я говорю со своим собственным опытом как я понимаю microsoft они очень сильно пытается продвигать самой схроны программирование особенно это связано с тем что меня зовут ливен на арте платформу то есть там получилось на каждую операцию должно болтается по мне больше 30 миллисекунд из трех секунд вот и это можно было сделать в принципе только если у вас все синхронно ну не знаю то есть я напоролся на проблема когда сделай асинхронный код потом пытались там die for считать и у них она не работала и второй вопрос сразу внутри у нее сейчас строя новый контейнер свой вы как-то я вообще тестировали проверяли скорость его работы или вы все-таки взяли какой-то другой сбоку или мы используя их стандартный контейнер и тестов особо не проводили но и направление ни одной натолкнулись вот а для классического мы использовали inject он не особо стэну не нравится интерфейс здравствуйте мы сейчас тоже активно переходим на dot net core и это происходит через переход на типа нет корр но с полным фреймворком по ряду причин мы их сейчас кастим его так что у нас вы и запускается из видите находится kestrel и пестрели уже выполняется нужный код мы натыкались на проблемы что когда код внутри нашего пестрела допустим по 3 дан там падал то если вы не перезагружал каким-то причинам вы какие-то наблюдали проблемы с запуском kestrel азии со и вообще сколько это плохо или хорошо я не использовал castrol zeeco то есть я костра использовал на линуксе вот и она работала нормально то есть можно его оптимизировать подвинулся случае с видосом когда мы приводим с приложением и запускаемых на на виндоусе вот на винда steam или зуб контраст как с обычным со я сам то есть мы мы не делали flow один выстрел что я замечал если у вас какой-нибудь девелоперский сервер и если вы пытаетесь использовать костре в этом случае то есть он очень медленно стартует то есть у вас много предложений запущены на одном одном серваке безответственно уважать вас память потому что они там для разработки такое используются периодически то прям на первый старт иногда бывает тратится прямо по несколько секунд до того что за мечом спасибо еще вопрос такой вот знаю под из когда пишешь много есть нюансов которые нужно учитывать там какие то да конечно например заголовки там особым образом можно обрабатывать там выходные не всегда там работают там есть соответственно всякие приколы с классической и значит классическим покойном и новым вот среди того что развелось много разных серверов уже вот овен катана как один из первых там участке стрел какие то есть подводные камни вообще ну так я говорю наш проектом использовать тройки стрел и он пока работает с коробки то есть пока мы не встретили но начнем мало у нас правда в продакшен то есть практически нету он только встречи ники готовится и террорист надеюсь стоящий месяца пойдет и в принципе писали документацию него они сделают по моему максимально простым то есть он как бы подключается вашим сша проекте и там 54 настройки который можно подкрутить просто вот wavenet а вам я помню там все там не дал верху и там все славки а в случае с тестом их то есть а если тут над курсом по себе он запускается поверх теста то есть у них все свои то есть у них свое видео то есть все заново написали оркестру говоря просто только может запускать он запускает market and core изыска этому предложению в контейнер так все 85 корт также металла своей и то есть разница нет что на если хочет еще нет"
}