{
  "video_id": "-UHe8hvTgRQ",
  "channel": "HighLoadChannel",
  "title": "Red&Blue AD — как подготовить и защитить свой Attack-Defence за 30 минут / Лев Хакимов (Wildberries)",
  "views": 127,
  "duration": 2799,
  "published": "2025-01-17T02:29:19-08:00",
  "text": "так Ну что поехали а сам я начинал свою карьеру девопсом Мы хоть сейчас я не совсем девопс но это всё ещё часть а моей жизни Это очень важная вещь Потому что девопсом нельзя прекратить быть devops - это не что-то о состояние души А сейчас я техлит в команде инфраструктуры иб мы занимаемся сопровождением критичных сервисов таких как корпоративный ВПН или корпоративный пам собственный на базе Телепорт Я преподаю преподаю в ИТМО читал лекции в МФТИ в Воронежском госуниверситете Так что я хороший преподаватель как говорят мои студенты но лучше не попадаться ко мне на передаче Я играю вчасно недавних пор Если вы что-то слышали про кубок CF там или какие-то CF в других городах такие как ом CF или Летняя школа ctf в этом году мы полностью самостоятельно с нуля запустили новый центр сети в Воронеже Ну в общем там есть я мои ребята и мы делаем сетиф просвещает студентов приобщает информационной безопасности к тому что быть взломщиком и быть защитником - это весело А мой хендл во всех соцсетях можно меня по нему найти и задать мне вопросы Ну что переходим непосредственно к докладу о чём сегодня поговорим для начала что вообще такое что такое ctf Как работает Attack defens как работает этот вид соревнований Как писать для него задачи чтобы они работали были интересными и сразу не сломались Как подготовить всю инфраструктуру для Атак дефенса Какие уже существуют решения Как подготовить площадку для Атак дефенса И от меня будет и от нашей команды личный подарок это собственная платформа для Атак дефенса которая была разработана с учётом недостатков тех платформ которые уже существуют на рынке она микросервисная написана на го легко подходит для запуска в кубе где угодно и в общем мы её используем И никаких проблем у нас нет про неё Расскажу чуть подробно дальше начнём с того А что вообще такое СИ Ну когда слово хакер то обычно людей представляют как-то Примерно вот так иногда хакер может выглядеть И вот так наше телевидение хакеров видит примерно так которые пингом взламывают сайты ну а С недавних пор в отчётах различных организаций хакеры выглядят ещё и вот так так что если кого-то увидите из этого списка на конференции можно смело поздравлять их см включения вкн список вобще соревнований в it то он достаточно разнообразен есть спортивное программирование которое нам всем знакомо ещё со школьной Университетской см для любителей продуктовой разработки есть хакатоны если вы разрабатываете игры то для вас есть Game jem это в общем то же самое что H котон только про разработку компьютерных игрушек для специалистов инфобез есть свои соревнования они называются ctf или capture The Flag и нет это не режим в третьем к вейке это именно соревнования по захвату флага что вообще такое флаг поговорим дальше вообще если говорить про форматы ctf они бывают двух видов первый формат Называется жерди он же таско вый в нём много-много задач как на Олимпиаде таски разбиты на категории и задача решить таск найти в нём специальную строку которая символизирует какие-то приватные спрятанные данные которые называется флагом собственно быстрее сдал задач тот соответственно и выиграл если говорить про то Какие категории там есть то это веб уязвимости это реверс когда вам нужно публичные источники он графия Когда вам Необходимо извлечь какие-то данные из те контейнеров изображений с котиком например Ну и всё что не попадает в эту категорию обычно летит в мий есть ещё категория форензи где надо копаться в дампа и искать информации например с битых жёстких дисков или образов там операционной системы наме как деть мето повелось что Питерский всегда я рассказываю что-то про Сити есть короткая ссылка можно будет потом посмотреть этот доклад если говорить про форматы CF то помимо рди есть конечно же Attack defens А вот как работает он мы об этом сейчас и поговорим Ну вообще зачем нам это надо Сиф есть внутренние и внешние если мы говорим про компании внутрен хороши тем что это хороши способ повысить осведомленность сотрудников информационной безопасности при этом не скучными лекциями или презентациями на корпоративном портале а непосредственно дать им попробовать позаимствовать себя хакером это очень здорово и многие это любят А если говорить про ctf как внешнее мероприятие это повод например за относительно небольшие деньги сделать очень классный Пир самих себя в в среде например профильных специалистов поскольку ребята студенты очень активно играют в тифы они любят это они ходят по ним и хорошее соревнование всегда формирует положительный образ компании и хороший стиф зачастую позволяет там например самой компании среди этих студентов набирать себе новых специалистов Так что это выгодно и студентам и компаниям Как работает att Def У нас есть несколько команд в команде в среднем по семь человек каждая команда получает свой свою виртуальную машину это может быть образ это может быть уже готовая развёрнутая виртуальная машина На ней запущено определённое количество сервисов там 2 3 4 5 главное что у всех команд они совершенно одинаковые и в каждом этом сервисе В каждом веб приложении есть набор уязвимостей минимум одна но в реальности их может быть и больше А и В определённое время при старте соревнований этот сервер становится доступен по сети и другие команды могут к вам подключаться и вас атаковать на языке Сифа такой образ называется ВН боксом такая виртуальная машинка ну этот термин будем использовать и дальше само приложение самб приложение Ну называют просто сервисом что это может быть это какой-то приложение которое которому можно обратиться через например по tcp через http TPS jpc В общем любой протокол для этого подойдёт Главное чтобы можно было по сети Достучаться на борту есть уязвимости и в результате эксплуатации уязвимости злоумышленник должен получить возможность из вашего приложения читать какие-то приватные данные эти приватные данные как раз и будут флаги Но в отличие от таск бейда где флаг в задании один флаги в Атак дефенсе они динамические поскольку соревнование идёт с течением времени флаги Там постоянно об добавляются новые А старые пропадают Как это работает ВС соревнование поделено на раунды и в каждом раунде проверяющая система будет класть в ваш сервис Ну например это сервис заметок будем рассказывать на нём она будет класть туда каждый раунд какую-нибудь новую заметов эти заметки каким-то образом достать вот Первый раунд положила проверяющая система флаг во втором раунде проверяющая система кладёт уже новый флаг новую заметку А старый протух ет и так с течением времени то есть флаги которые лежат в сервисе они имеют свойство протух и проверяющий системой не принимаются сделано Это для того чтобы когда злоумышленник соседняя команда взломает этот сервис она не смогла сдать старые флаги и получить за них очки того что мы знаем Про Сервис вся игра разбита на раунды у раундов есть длительность и каждый раунд кладётся флаг формат которого вы видите на экране то есть там простая регулярка из три одного символа и пробел на конце у флагов есть ТТ и соответственно если он протух то его больше не сдать что вообще делает система жюри система жюри - это внешнее приложение которое выполняет несколько задачек собственно показывает скорборд соревнования кто Сколько очков набил кто сколько у кого флагов своровал и какой итоговый рейтинг А и она запускает такую с такую систему а скриптов которые называются чекера то есть чеке как раз-таки занимаются чем они про делают Смоук тест вашего сервиса и э раскладывают в него флаги То есть фактически они мули пользователей Ну и также журека принимает команды от команд флаги для сдачи и опционально она может подавать подсказки Где искать флаги То есть если например журека Может подсказать например что у пользователей с такими-то айдини ками флаги свежие и этим можно пользоваться собственно немножко поподробнее о чеке чекерс в основном либо на пайтоне так уж принято в основном что все журе работают именно с ним либо на го Который эмулировать То есть он делает смок для сервиса выставляет сервису по результату этого смока оценку работоспособности и размещает в сервисе новый флаг если говорить про оценку работоспособности она может быть следующих видов то есть либо с сервисом всё нормально Либо сервис немножко не работает то есть например в случае с сервисом заметок пользователь лишается возможности отмечать там понравившиеся заметки звёздочками это не критическая функциональность но сам сервис всё ещё работает Если а такая такую вещь команда сделала Например Она считает что через отметки ЗМИ работоспособности сервиса злоумышленники ломают уязвимость но она не смогла запа она просто отключила выставляется сервис статус мал Если же ломается вся функциональность то выставляется статус заметки добавлять нар читать нельзя и если например сервис вообще недоступен по сети то выставляется статус да для сервиса все считается все понимат прон работоспособности Серви в случае то как долго сервис Какое количество раундов сервис пробыл в состоянии Ок а также для каждого сервиса ведётся расчёт флаг поинтов флаг поинты - это аналог Ну например денег на этом сервисе или какого-то количества очков они символизирует количество украденных флагов изначально у всех команд Это количество одинаковое и оно уменьшается если у вас флаги крадут и увеличиваются Если вы на этом сервисе флаги Крад у других а то есть механизм достаточно простой он тоже используется в подсчёте очков поскольку количество очков на сервисе обычно всегда рассчитывается по формуле flp умноженной на sla подведём итоги что мы поняли сейчас у нас есть запущенные сервисы сервисы запущены на волн боксах в сервисах есть уязвимости и там хранятся секретная информация которую постоянно кладут виртуальные пользователи это собственно и есть флаги а для каждого сервиса критически важен sla Потому что если он падает вы теряете очки и флаг поинты если у вас их воруют Вы тоже теряете очки а если вы флаги крадёт флаг поинты у вас растут чеке это как раз-таки и есть те самые виртуальные пользователи Ну и в общем-то всё как Уже на этом этапе можно понять как сбалансировать игру Если вы собираетесь делать CF первое количество команд чем команд больше тем играть интереснее оптимально на самом деле команд 10 Потому что разме разме вашего Сифа зависит исключительно от ваших возможностей сколько команд вы сможете физически к себе подключить насколько вам хватит ресурсов там и навыков это замене если если игроков мало то достаточно быстро все могут защититься и игра закончится слишком быстро количество сервисов тут есть несколько подходов либо сделать небольшое количество сервисов например два или но набить их уязвимостями под завязку либо сделать много сервисов но при этом положить в каждом из них по одной уязвимости в таком случае если вы делаете там по много сервисов то команде состоящих из семи человек обычно проблемно посмотреть каждый из них то есть надо понимать что команде на этапе подготовки к соревнованию нужно не только сами сервисы Изучить и найти в них уязвимости но ещё и развернуть всю подходящую для этого инфраструктуру количество уязвимости в каждом обычно применяют ход например сервисы в нём две-три уязвимости либо когда много сервисов там одна уязвимость надо понимать что писать сервисы затратно поэтому обычно делают там две-три уязвимости этого хватает при этом одна из них посложнее а остальные полегче Ну и собственно количество и время раундов это в общем сама длительность вашей игры а и также нам важен Т флага то есть то насколько вы разрешаете насколько критически важно когда ваш сервис взлома и стартовое количество флаг поинтов Оно обычно всегда постоянно и там договариваются назначении 2500 Также можно модифицировать формулу подсчёта очков например все журе которые есть сейчас современные у них достаточно несправедливая формула по счёта очков так как она очень не прощает команды которые например вовремя не закрыли простую уязвимость у них сразу украли все флаг поинты и в общем если команда в начале тифа улетела на самый низ то зачастую ей практически невозможно оттуда подняться слишком уж большой разрыв получается между первым и последним местом Ну и если например какая-то команда делает First Blood и начинает зарабатывать на сервисе дополнительные очки то до того как все остальные команды тоже нашли эту уязвимость то обычно бывает проблемно а потом эту команду подвинуть поскольку разрыв по флаг поинтам и их стоимость всегда одинаково как писать задание для Атак дефенса Ну вообще для любого CF в первую очередь важна тема соревнования А хотя бы казалось Ну можно же просто в дать задачки написать различные сервисы типа сервиса заметок или электронной почты но всё-таки стараются придумать какую-то общую тему например не знаю э морское царство например и в таком случае вы уже придумываете не просто какой-то абстрактный сервис А например сервис показа рыбов для котов это и звучит веселее И фантазия делает Так что всё-таки все фы становятся непохожими на других а необходимо сбалансировать сложность А это количество задач и количество уязвимостей я про это уже говорил а также и сложность самих уязвимостей оценить что проще А что сложнее а взломать это вещь конечно для всех эфемерная но дальше я покажу Какие всё-таки уязвимости относятся к какому уровню А и также стоит оценить потенциальный уровень участников если вы делаете ctf для там новичков то всё-таки лучше выбирать медиум и простые уязвимости ровно Потому что если у вас уровень команд будет слишком разный то опытный опытным игрокам будет просто не интересно в это играть они достаточно быстро поломаю сервисы А новички просто не успеют даже разыграться и это может отбить вообще желание играть на всю дальнейшее время А на какие категории стоит у стоит ориентироваться у нас был Вот такой список но в реальности асин стеганография миск выпадают и в реальности те категории которые активно используются это собственно веб уязвимости реверсные таски бывают но как показывает практика большинству игроков сейчас очень проблемно патчи бинарные сервисы без исходников там плюсы зачастую вызывают у ребят сложности и бинарные сервисы стоит давать только если вы чётко понимаете что опт команды которые это умеют делать потому что те кто не запали на этом сервисе скорее всего не выйдут даже из низа турнирной таблицы тоже считается категорией достаточно сложной для решения так что зачастую веб и криптография правят баллом крипту потому что там есть самые разные варианты Как сбалансировать крипту и от Там просто неправильно выбранных констант для алгоритмов до понимания того как тически работают например кастомные электронные подписи это сейчас достаточно популярная тема как и уже сказал В основном у нас будет такой на примере заметок потому что все понимают Как это работает Где можно посмотреть источники вдохновения для этих самых задачек Ну во-первых можно открыть списки популярных цвек и посмотреть там зачастую к некоторым есть ты к некоторым нет но можно посмотреть идею как поломать и Или например использовать уязвимые версии старых старых старых компонентов или языков программирования там посмотреть уязвимости в старых версиях Go и так далее криптографические уязвимости в алгоритмах шифрования различные байпас или SQL инъекции Это жизненно актуально и при этом это небольшая сложность Ну и различные нарушения бизнес логики то есть ели там какой-то обход авторизации либо доступ к недоступным страницам Ну и на свой страх и иск риск можно давать цш Почему на свой страх и риск потому что сервисы у которых есть возможность цш э залезть в контейнер то там зачастую как только Ребята это находят начинаются бесконечные укладывания сервисов остальных команд например от которых бывает сложно защититься А если вы например не позаботились о харден инфраструктуры своей и у вас ребята зло ребята команды сбежали в вашу то потенциально они могут всю инфраструктуру положить или например вытягивать флаги из журе Поэтому такие вещи надо подходить строго понимая что вы в состоянии защититься от внештатных ситуаций Собственно как писать задачки выбрать интересную тему найти набор уязвимостей сделать Сначала рыбу сервиса даже Пусть без самой уязвимости и добавить её туда протестировать посмотреть что это работает написать для этого сло то есть что ваша УМО действительно выть А это не просто догадка и написать к программе Чер Ну что же сервис готов и кажется можно попробовать Подготовить инфраструктуру с инфраструктурой всё относительно весело Есть несколько вариантов самый простой это взять один VPN сервер например openvpn и подцепить к нему всё и журе и вон боксы и игроков но При таком подходе может случиться Неприятный момент в частности Когда у вас количество команд переваливает уже за 20 openvpn сервер может Например если вы делаете на базе он ВП он может начать например дропать пакеты а поэтому тут уже начинают А видоизменять инфраструктуру и например разделять это на несколько маленьких ВПН серверов к отдельному цепляются игроки к отдельному цепляются вон боксы все они цепляются к одному большому Но это всё ещё тоже инфраструктура так себе поэтому такой оптимальный Стандартный вариант - это один Центральный VPN к котором цепляются динамически маленькие ВП команд на каждом ВП команды висят непосредственно все игроки и вбок и их количество может динамически увеличиваться в процессе игры Таким образом мы не ограничены размером заранее определённым размером команд и мы можем динамически добавлять новые команды прямо в ходе соревнования это особенно хорошо Если вы например выкладываете их на какую-то например площадку типа ctf и говорите ребята дите к нам регистрируйтесь и можете играть таким образом вы можете переварить Ну практически безграничное количество команд которая будет упираться только в ваши лимиты в Облаке А есть такой вариант который в шутку называется смерть инженера ровно Почему Потому что вместо впв тут ВПН используются только как входной шлюз А дальше Всё решается средствами облаков Но есть одна проблема поскольку AP у всех облаков разная потом переезжать с например Digital она на avs там Google Cloud или Яндек Cloud обычно всегда бывает проблематично и такие платформы которые сделаны непосредственно под завязку под конкретное облако очень проблемно потом мигрируют Ну что же кажется что для того чтобы играть atf У нас есть всё задача мы понимаем как это сделать осталось найти платформу и всё что будет помогать нам играть Какие же они есть Ну сае наверное ста сама известная платформа - Это журека от хакер дома она в общем-то стабильная надёжная и если кто-то там играл в РУФ они наверняка помнят эту журе она проверена временем ей там 15 если не больше либо не 20 лет а она надёжная написано на перле Ну в неё мало кто уже там вносит изменения фактически это такое Вот оно существует в таком виде и ладно Никто не знает как оно работает на самом деле Кроме тех людей её писал имеет два дашборди страшненький конечно времён там нулевых но тем не менее они есть они могут выводить лого команд и как оказалось не все журе это умеют А и разворачивать её всегда было проблематично поскольку ничего больше кроме самой журе там не было И один из участников команды Hacker domom сделал такую надстройку которая называется ctf Cloud которая как раз-таки реализует вот этот вот вариант инфраструктуры с множеством впх одному с ним всё неплохо Кроме того что никто кроме этого человека не знает как эту платформу развернуть То есть это такая Визан Анси блов где-то скриптов где-то надо заходить что-то менять руками где-то Надо просто знать как это как это сделать И даже если вы всё развернёт что это у вас будет работать и малейший сбой во времени во время соревнования может привести к тому что платформу короче проще откатить и накатить заново чем искать уязвимости в ней чем искать ить проблемы в ней такое уже бывало Поэтому с ней надо обращаться очень осторожно А ещё к ней нет инструкций и она как раз пошла по пути привязки к конкретному облаку она сильно привязана к ctf Cloud привязана к Digital oan и есть версия под Яндекс Cloud но она не развивалась уже лет пять и периодически когда у Яндекса менялось AP э журека это не учитывает она ещ требует большое количество белых адресов а кто работает с облаками тот знает что получить белые адреса это далеко не всегда простая задача приходится иметь общение с поддержкой И на самом деле очень неудобно если у вас в процессе соревнования выяснится что вам не хватило адресов Ну в общем скорее всего платформа остановится Ну и Да это проблема то есть это прям вязанка лейбу вязанка скриптов которые предназначены ровно для того чтобы один человек умел разворачивать и настраивать для других это не расчитано форма скажем так сильно популярная она современная это с ней знакомы те кто играют там на кубки либо в ряде российских C ивентов В общем она тоже неплоха но с определённого момента ребята решили что на Сиф неплохо продавать и как бы ну сложно их в этом обвинять Ну в общем лет 6 платформа не обновляется и все е обновления в закрытых репозитория Вот можете к ним при купить ФКУ но сделать самим на этой платформе у вас будет старая версия в которой много чего нет Она проста в запуске у неё есть документация это Плюс потому что Как Мы уже поняли у хакер дома например документации Нет вообще она относительно микросервисная относительно отказоустойчивые но фактически вся её отказоустойчивость основана наце Так что на самом деле с отказоустойчивость там тоже есть большие проблемы не всё что заявлено на гитхабе сейчас работает то есть ряд функциональности там сломан в частности там ряд сервисных дашбордов но все играют без них и что приятно есть набор C теплей которые можно положить на git класть туда задачки и они у вас будут там в gitlab C либо в github workflow проверяться на там то что они у вас запускаются работают флаги туда кладутся чекера отрабатывают а е есть один маленький момент у этой рейки нет никакой инфраструктуры и Если вы захотите развернуть это всё где-то всю инфраструктуру вам придётся поднимать самим Ну и собственно наша платформа которую мы сделали когда поработали с обоими журека это Cu AD Так мы её назвали потому что у нас ребята очень много работают с кубом Нам нравится эта экосистема и мы писали такую жу рейку чтобы её было классно удобно запускать в кубе мы писали её на гон по функциональности она в принципе сейчас не уступает фарка то есть в ней наверно Нет сейчас каких-то супер фич кроме отображения ладов и иконок команд во всём остальном она похожа накат но этого достаточно она тоже микросервисная она отказ устойчива она существует в версии кубернетес оператора все запуски чекеров базируются на базе НЖ и у нас есть тоже набор темпле для проверки задачек и в отличие от всех мы не планируем её закрывать она опенсорс ная она развивается и в конце я дам ссылку на неё чтобы вы тоже могли ей пользоваться она рассчитана одновременно на 100 команд Мы проверяли что 100 команд где-то примерно 700 человек может одновременно играть и проблем с производительностью не возникает и она поставляется самыми различными схемами развёртывания от прок максов и барл до облаков э там по крайней мере поддержка Яндекс Cloud у нас есть и есть поддержка а Google Cloud остальные в процессе Но это не обязательно То есть Вам достаточно хоть заказать в уэске где-нибудь или какие-то виртуальные машины и она в принципе на неё встанет А ну и также библиотека чекеров написана не только на пайтоне Но и на Go и на Java поскольку у нас ребята пишут на этих языках и платформа рассчитана на запуски чекеров в этих системах А теперь немного о самой инфраструктуре Какие они бывают есть вариант S hosted когда у вас всё железо своё можно взять какие-то ВПС но я вам это Не рекомендую поскольку лучше всё-таки использовать конечно специальное какое-нибудь облако типа Яндекс клауда ну ровно потому что всё-таки ВПС у всех публичные айпишник это ну как минимум не очень красиво и это как правило неудобно в клауде можно выстроить нормально инфраструктуру а по предоставляемым ВН боксом Есть несколько вариантов подходов популярный подход массовых а так Дефенс фов это дать только журе поскольку команд может быть много и чтобы не тратить расходы свои на поддержание ВН боксов команд предлагается ВН боксы развернуть у себя локально То есть Вам команде отдаётся образ н бокса и настройки ВП тут всё на самом деле неплохо и в целом это достаточно имеет место на жизнь но как показывает практика примерно половина команд не может настроить себе структуру Поэтому если вы подняли нбо то Вы даже можете попасть в топ игроков это прямо реально не шутки а можно выдавать командам статические вон боксы в Облаке в таким образом вы можете во-первых контролировать сами вон боксы их размер например сильно усложнить жизнь командам дав очень маленькие образы в которых ничего кроме сервисов не запустить А и но статические волн боксы они рассчитаны под заранее определённое количество команд и например рассчитаны инфраструктура на 10 команд и всё больше вы не получите динамические вон боксы могут выпускать их по запросу вот собственно что какие платформы поддерживают haer поддерживает Digital oex Cloud поддерживает в целом всё что угодно Если вы напишете под это инфру Но её нет из коробки там есть только генератор VPN конфигов Ну и qp в принципе в коробом формате Может быть развёрнуто как на промах так и в и вообще в принципе и в Google клауде Ну и в принципе если вы допишите там например свой провайдер под qbd Вы можете запустить её в принципе где угодно главное реализовать парочку несложных интерфейсов собственно почему возникло про потому что в например некоторых закрытых организациях типа там например различных военных академий интернета нет И доступа в облако там тоже нет Поэтому если вы хотите сделать ФКУ там то В общем железная инфраструктура вам в помощь а также в инфраструктуре существует ещё такая штука как ферма Она позволяет вам сдавать флаги запуская эксплойты команд А и сдавать их в журе ику под разные форматы мы адаптировали ферму под формат нашего qbd А и главная особенность фермы она защищает от А того когда команда например ламану сервис с другой команды и поменяла там все флаги они теперь журека и не примутся но будет проблема журека может Вас заблокировать посчитав что вы пытаетесь её дудо Ну то есть вы привы лимит и платформа ферма умеет с этим бороться что касается анализатора трафика то наш платформа поставляется своим анализатором он помогает игрокам смотреть какие то есть это такой маленький аналог сока который позволяет вам смотреть какие запросы идут к вашим приложениям и вовремя понять как вас Ну имеет возможность там настроить фильтры чтобы и арты чтобы Вы могли увидеть какие-то интересные для вас паттерны если говорить про такой вариант C для новичков то мы например пришли к такой формуле что если играют совсем-совсем новички которые ничего не знают про Def то лучше поставить ферму и анализатор им сразу чтобы они даже не мучились этими вопросами А сосредоточились на игре и ввести несколько специальных правил в формате обучения То есть если например какая-то из команд ломает сервис то через 30 минут в общий чат выкидывается Подсказка как этот сервис был взломан А если например сервис взломали через там пол полтора часа прошло там или там 2 часа после того как сервис был заф Блажен в общий чат выкладывается Вообще полное решение этого сервиса как это зать сложность в том что уязвимости должно быть много но зато это делает игру динамичнее и защищает от проблемы когда какая-нибудь опытная команда ворует флаги у новичков которые не смогли закрыть там банальную SQL инъекцию например ну и немножко о том как подготовить площадку для проведения очного Сифа как минимум вам стоит заботиться о том чтобы у вас было два провайдера А и размер площадки был таким чтобы Вы могли рассадить команду на расстоянии там хотя бы 2 С5 м друг от дружки опытных ближе но новичков лучше Дальше они нервничают что у них кто-то что-то посмотрит соревнования идут примерно 6 часов Это оптимально если больше то там уже никакой динамики не будет а если меньше то скорее всего они не успеют нормально разыграться Ну и стоит не полениться сделать регламент соревнований поскольку Если вы например возникнет Спорная ситуация то очень много команд будут Потом ходить доказывать вам что у вас всё неправильно соревнование всё покупное всё всех всех всех купили И вообще ребята не играйте в этот ctf CF сообщество местами может пере такси поэтому студенческое поэтому тут Лучше быть с ребятами аккуратным немножко о сетевой архитектуре на площадке в целом я не открою ни для кого там какой-то секретной информацие как это лучше сделать всё-таки стоит там на площадке поскольку Вы не знаете как там у них с свободными пишними лучше притащить свой нормальный маршрутизатор там мы ставим кротик можно тащить сску а и несколько несколько коммутаторов отдельно развести коммутаторы на столы под каждого игрока под каждую команду и всех их свести в один игровой коммутатор и в отдельные коммутаторы вывести там с поешь в вай-фае точки раскидать их по территории но с вай-фаем Надо быть аккуратнее ну и плюс отдельно мы выносим а отдельно мы выносим коммутатор под железную инфраструктуру если играют там ребята с инфраструктуры не в Облаке а там у нас там на виртуальных машинах с проми либо ещ каким-то либо образом например был вариант с там сервисами на малинках такое тоже бывает И периодически можно и такое сделать собственно по сетевой безопасности лучше каждую команду отсадить свой Лан чтобы она видела только то что могла и только доступ в интернет и свою инфраструктуру и не могла Достучаться до ноутбуков соседних команд дабы не было соб кани веселье стоит о заботиться о защите от дудо в случае с циска есть механизм Black фитн я покажу как его настроить дальше А в случае с ротиком мы можем В случае обнаружения там повышенного количества запросов к одному ресурсу отправлять его в цепочку дудос цепочку и дать отдохнуть там это тоже покажем как это сделать Ну и собственно Если у вас есть wi-fi точки то вс-таки стоит заводить все ноутбуки исключительно по кабелю и давать доступ к wi-fi только тем кто не заботился там переходника а у него нету r45 ноутбуке собственно изер Невского Потому что если у вас будут все сидеть на вай-фае достаточно найдётся тот самый хитромудрий человек который изучил и начнёт делать неприятно но такое бывает Поэтому лучше этим не увлекаться Если вы делаете например Attack Defense там локально на своей инфраструктуре и не закрылись всё это там https то трафик будет гулять в свободном виде что в общем тоже неприятно А ну и надо иметь скрипты для того чтобы банить игроков в случае СДО с Протек то как раз-таки есть схема хол Когда вы можем при помощи bgp направить мутировать трафик туда где он будет просто дропа есть э скрипты которые как раз-таки позволяют это сделать включить хол на циска а Можно ими воспользоваться Если вы обнаруживаете OS то можете просто по шестьдесят шестому тегу отправлять пользователей отдохнуть аэ отдохнуть и не давать им доступа к инфраструктуре а в случае с кротим то тут всё сильно проще можно просто добавить а фаерволе правило которое в случае превышения количества запроса внесёт это там в цепочку DDoS attackers и все приходящие запросы будут отдыхать там собственно Это ссылка на нашу платформу которой можно будет пользоваться на неё доступ будет презентации я репозиторий открою сейчас сразу после доклада и можно будет там посмотреть воспользоваться этими штуками настроить сетиф и радоваться жизни я очень ра вашему ф комментарии это помогает становиться докладом лучше Всем спасибо за внимание Лев Большое спасибо Аплодисменты что-то слабые были только что Source презентовали вы что ребята такая платформа замечательно вопросы у нас два приза один от вайберис от льва а другой от онтика от организаторов быстренько Кто хочет вот сзади раз раз спасибо большое за доклад Вот ты рассказал Вот про дедос про то что вот могут ломать чужие там ноутбуки А можешь ли ты Привести примеры ещё вот различных Атак на получается которые могут производить пользо хакеры потому что Ну вот как я понимаю они могут взять там просто вырубить машину либо перенаправить трафик на неё куда-нибудь либо вообще взять отрубить всем доступы кроме как чекеров и тогда Вроде как сервис поднят А никто до него до сечас не могут то есть можешь ли привести пример таких Атак и как от них защищаться Спасибо А если мы хотим заставить игроков играть по правилам то конечно никто не мешает игрокам включить IP tables на своих н боксах и настроить там фильтрацию но у нас например сделаны проверки во-первых самый простой способ который есть в этой платформе - Это например защититься Там просто по IP - это не включить это включить э над радин Это нормальный вариант и в принципе уже как минимум просто по IP настроить фильтрацию будет сложновато чеке зачастую делают как опытные команды Например любят маскировать свой трафик под чекера например А и например подменять э в основном чекера пользуются своим юзера агентом например и это позволяет там например Они часто свои запросы к командам подменяют под US AG чеке чтобы не попасть под некоторые правила фильтрации Да спасибо сзади Спасибо за доклад Вот ты рассказывал разные параметры с которыми можно играться Вот и я хотел бы глубже про изменение формулы Потому что ты рассказал о проблеме Что может быть команда которая сделала First blad она украла у всех остальных и она впереди вот как в итоге меняется формула для того чтобы не было у нас платформе форму можно настроить фактически это просто переопределить функцию которая е считает и там написать какую угодно логику А какой её ставят по да По моим ощущениям мы снижаем оценку фбд То есть пока сервис находится в статусе фст Блада количество флаг поинтов ценность флаг поинта примерно в половину ниже чем когда сервис ломает большинство Это для новичков просто даёт им право на ошибку Да это не совсем честно Спасибо нет баланс важен как в центре вот вопрос ещё ещё кто хочет да Привет Спасибо большое за доклад меня Никита зовут Я из команды спбф У меня вопрос такой пара животрепещущий во-первых наверное вот там несколько последних тфв вот наших отечественных была такая проблема что там все как по щелчку резко вот этот факат весь красный становится там журека Бах всё ничего не работает вот вопрос я вроде ниде не видел никаких решений зна по может кому-нибудь лингу журе там децентрализации сети вот такого ничего не планируется сделать а вот здесь это и есть как раз то есть у фарда там есть Лери движок в котором запускаются все чеке и Да если например Неправильно там на самом деле рка тоже можно слить но там это делается через внутренние скрипты и честно я например практически никогда на форка этим не пользовался потому чтот я делал только для маленьких сетиф и там хватало стандартных настроек Да на больших она ведёт себя сложновато и иногда местами непредсказуемо А поэтому у нас например в нашей платформе все чекера - это крон джобы которые запускаются и проставляют статусы в тцд в каждый раунд а а журека когда поднимается Она заходит Независимо смотрит на эти статусы и отображает просто результаты из базы данных то есть таким образом запуск чекеров никак не привязан к самой платформе Угу угу О'кей понял Спасибо И второй вопрос А вот это уже ближе наверное по общему качеству контенту цтф вот у нас ну как в последнее время золотым стандартом вроде как считается там около тыр тире Там шести сервисов Да вот и в частности некоторые цтф Которые рассчитаны на более опытных игроков Бывает такое что там грубо возьмём четыре и три из четырёх - это гробы Да И вот по факту что вот у нас там цтф восем грубо часов идёт и се часов 30 минут происходит то что все команды просто тупа работают на одном и том же сервисе то есть динамики у нас Никой не происходит новых багов нету И только вот Последние полчаса там если может кто-то повезёт что-то успеет там на прога зас то и эта команда автоматически резко подлетает на первое место вот вопрос наверное здесь с таким больше знаешь менеджмент ский подход что нам допустим нужно делать в случае в случае если такая ситуация произошла как быть с хинта как бы вдруг какая-то команда у нас где-то близко к решению А мы дали хинт ей обломали всё Ну то есть такой как бы дизмораль ловит из это игра нормально это на самом деле проблема потому что я вот как раз был одним из организаторов такого хардкорного CF но я больше площадкой занимался Да там это была та же самая проблема То есть первый флаг сдали часа в три за 3 часа 3 часа до конца пому за 2 часа до конца это на самом деле проблема можно менять сами параметры формулы опять Жеки снижая стоимость открытий потому что там буквально последних минутах команда просто сдала один флаг и вырвалась там один Новый сервис и вырвалась вперёд При этом по-моему они флаги там чуть ли не руками заслали а да есть такое это проблема Как раз-таки стандартных журек Ну мне кажется тут пробовать только играться с формулой и Ну блин с хардкорными Вот это всегда проблема вот что с лёгкими стефка что с хардкорными там сложно от баланси нормально сложность поэтому мне кажется тут можно просто пробовать снижать стоимость флаг поинтов и смотреть на то как это получится Но честно вот пока такого опыта написания таких севок не было Я видел со стороны как это происходит Ну да как бы это не очень приятно я Мне кажется сжать флаг поинты хорошо да спасибо спасибо давай вручим призы А если коротко коротко Спасибо за доклад Лев Меня зовут Александр у меня такой общий вопрос не было ли таких идей или может быть Практик что использовать реальный продукт и давать его на взлом да то есть установить где-то копию условно попробовать взломать за 6 часов и второе нет ли программ вознаграждения ба что Найдите уязвимость получите миллион и нет ли у этой программы вообще подводных камней тут сидит лбе вопрос прямо актуальный Да тут есть программа вознаграждения это можно подробнее посмотреть на площадках я тут особенно подскажу но есть и Баунти приносит очень интересные баги которые мы закрываем Так что это есть а Конкретно фов вот недавно Кстати если кто-то смотрит ВБ на связи был выпуск о том как ребята бак Баунти пришли исследовать безопасности вбш замка на ПВЗ например то есть они пришли сели изучали Как это работает ломали нашли уязвимость и ломали замок то есть ре можно было так прийти на ПВЗ и ломать замок например они сделали так чтобы так сделать было нельзя огонь призы значит первый Давай куда так давай вопрос ни Никите из спбф так тебе вот от и давай вопрос про баба последний последнему вопросу в который ворвался там книжка И супрематическая матрёшка Ну тебе традиционные призы от онтика от организаторов Спасибо тебе большое за Open sce и в целом за доклад Угу да"
}