{
  "video_id": "796-dC41Doc",
  "channel": "HighLoadChannel",
  "title": "Типографика в iOS / Ирина Дягилева (RAMBLER&Co)",
  "views": 1804,
  "duration": 1867,
  "published": "2017-05-16T13:00:03-07:00",
  "text": "сейчас ира дягилева из rambler нтку выступит и расскажет про то как вообще волос работать с типографикой вот у вас допустим были случаи когда сидите вы с утра работаете вдруг прибегает дизайнер такой парень давай со шрифтами поиграем вот ну в общем игра расскажет как это правильно играть со шрифтами волос чтобы дизайнеры были очень очень очень рады всем привет да зовут меня ирина дягилевой я занимаюсь а я с разработкой в компании rambler н.к. так или иначе большинство информации в приложении передается посредством текста и поэтому верстать его нам приходится много и незнание всей механики рендеринга влечет за собой различные проблемы например простая задача добавить выделение текста в существующее приложение что мы делаем заменяем юлы был на ее textview и вдруг у нас едут все отступ и текст выглядит совершенно по-другому или вообще не влазит на экран почему это происходит какие настройки лучше использовать в том или ином случае про все это я сегодня расскажу доклад будет состоять из двух частей с начала мы поговорим про основные термины типографики про шрифты их метрики и наиболее часто используемые символы и атрибуты а во второй части мы подробно поговорим про фреймворк текст кит и отличие рендеринга ей textview и и ей лейбл основным терминам типографики конечно является шрифт шрифт это набор символов у которых схожи рисунок и у них фиксированные три составляющие это гарнитура насыщенность гарнитура начертание и размер гарнитура это целая группа шрифтов то есть некоторые шрифты проектировались таким образом чтобы они гармонично смотрелись друг с другом у них схожая форма рисунка и шрифты в пределах этой группы имеют различные начертания начертание свою очередь тоже делится на три характеристики мы различаем символы по ширине полосы гости и по наклону и по наклону часто путают 2 начертания курсивного и наклонная это совершенно разные начертание потому что курсе вно и должно изначально содержаться файле шрифта и она лишь схожи с нормальным наклонной это программное синтезированное искажение символов из прямого начертания ну и наконец третья составляющая это размер или по-другому кегль то есть каждому символу на печатной странице отводится определенное место и вот этот прямоугольник называется кабельной площадкой высота его от нижнего края до верхнего называется кегль или размер шрифта система умеет возвращает нам прямоугольный который отвозится символ на печатной странице но так я наверно забежал раньше но на самом деле высота его не равно кедру называется он боуден рэп и состоит он из следующих величин это некоторый межстрочный зазор лизинг и высота строки высота строки тоже в общем случае не равна кеглю если мы посмотрим на все символы то они как будто лежат на одной прямой эта прямая называется линия шрифта или bass line параллельно ей проходит средняя линия шрифта или мин line а расстояние между ними называется x хайд и характеризует высоту строчных букв за это он взят символ экспо отсюда и название метрики x hyip также мы можем получить высоту заглавных букв хип-хоп и последние две метрики это остенде ради стенде все то что у нас выходит выше bass line до наивысшей точки верхних выносных элементов это стенде idis center то что у нас уходит вниз соответственно он отрицательный теперь давайте рассмотрим пару строк расстояние от базовой линии одной строки до базовой линии другой строки называется интерлиньяж или лизинг любимый дизайнерами параметр на самом деле и редактировать мы можем его несколькими способами во первых мы можем выставить line spacing задается он в абсолютных величинах и посмотрите что увеличивается лишь расстояние между строками отступ первой строки остается неизменным следующая настройка это line хайд multiple это уже относительный здесь в относительных величинах это некоторое значение на которое до множится каждая строка текста и мы видим что у первой строки также добавился какое-то отступ это на самом деле очень важно понимать потому что могут поехать другие отступ и например у самого текстовый элемент а следующие две два атрибута это минимум line hyip и максимум line хайд они задают ограничения строки например для данного кегли данного шрифта высота строки равна 200 антентом если мы начнем выстрелы минимум line хайд 170 то ничего не изменится потому что мы удовлетворяем этим условиям но как только мы превысим значения 200 пунктов мы увидим что стройке начали увеличиваться и также обратите внимание что первой строки тоже появляется некоторые отступ аналогично и maxim online хайд увеличиваем ничего не меняется удовлетворяем как только уменьшаем строки начинают сближаться и какой выбрать из этих настроек какую именно использовать необходимость с дизайнером и посмотреть что именно выставил он в своем графическом редакторе какие именно атрибуты наиболее соответствуют тому что выдает графический редактор и на а потом будут проблемы с вот как раз сыграв с выравниванием текстовых элементов и последний атрибут который я привела на слайде он зрительно также отдалить строки друг от друга но предназначен он немного для другого а именно для для верхних и нижних индексов например x квадрат или логарифм по основанию то есть мы уменьшаем размер шрифта и сдвигаем на какую-то определенную на определенное значение относительно bass line теперь давайте подвигаем целые параграфы здесь на самом деле все довольно просто никаких сюрпризов мы можем увеличивать значение после параграфа это line параграф spacing также можем задавать параграф spacing be for тогда перед по графам всегда будет добавляться какая-то какое-то значение и заметьте что первого параграфа также первый параграф остался на своем месте потому что на перед ним параграфа нет и средство очень добавился логично можем мы избегать первую первую строку и также задавать отступ для всех остальных строк как слева так и справа при этом ты лындин задается отрицательные тогда у нас будет отступ от правой границы и положительный задает отступ от левой границы идём дальше если мы будем складывать символы друг за другом то получится не очень красивая картина потому что под силу специфики самих символов вот допустим символы ты его они очень отдалены друг от друга и хочется сблизить а р н наоборот слились и хочется долить для этого придумали два понятия кернинг и трекинг идут они всегда вместе потому что характеризует одну величину меж символьные пробел и кернинг задается для конкретной пары символов и прописывается файле шрифта есть целая таблица кёрлинга на третьем задается для диапазон а символов или для всего документа без привязки к конкретным символом то есть если мы включим кернинг по молчанию он включен то увидим что символы они стали выглядеть стали лоя лоя учиться по-другому мы можем это значение как увеличивать так уменьшать то есть в ios мы можем задавать только tracking и как-то модифицировать то значение которое прописано файле шрифта те кто когда-либо работал с текстом уже знают что есть какие-то 7 какие-то методы которые переводят диапазоны символов диапазоны глифов и наоборот что это такое и почему их количество может не совпадать например ну давайте для начала скажу стоит такой это символ это прежде всего тематическая единиц языка это буква цифра математическая операция а глиф это и и визуальное представление и количество их может не совпадать например при использовании лигатур полет по умолчанию в ios включены обязательные лигатуры и мы видим что два подряд идущих символа эль вдруг превратились в один глиф дабл или и здесь уже было 5 символов осталось четыре глиф а также мы можем включить все лигатуры которые прописаны файле шрифта и тогда мы получим ещё больше красивых элементов вы давайте подведем некоторый промежуточный итог первой части мы с вами узнали что такое шрифт познакомились его метриками научились редактировать интерлиньяж кернинг tracking отступ и параграфов ну и наконец узнали что такое символы и глифы и лигатура теперь давайте разбираться с фреймворком текст кит который появился в ios 7 он предоставляет нам очень широкие возможности по редактированию текста он состоит из какого какого-то набора классов протоколов для работы с текстом основные его элементы приведены на экране это layout manager текста rich textview и текст контейнер чтобы понять за что каждый из них отвечает часто проводят аналогию с парадигмой м виси текст контейнеры текста речь эта модель данные layout manager это контроллер и textview соответственно в теперь чуть чуть подробнее про каждый из них текстуры это хранилище он содержит информацию о символах и атрибутах следить за тем чтобы данный были консистентные и оповещает каждый раз layout manager о том что произошли какие-то изменения в данных текст контейнер это та же модель потому что он поставляет layout менеджеру фрагменты строк в которых необходимо отрисовать текст также с помощью него задаются области исключения который текст будет обтекать поэтому еще поговорим подробнее и наконец слоя от менеджер как и положено контроллера вам вести отвечает за очень много функций ну во-первых он следит за текст сторожем и текст контейнером генерирует глифы из символов переводят диапазоны одни в другие и занимаются непосредственной отрисовкой глифов а что же необходимо сделать чтобы этот текст кит стек проинициализировать во первых нужно создать текста речь и pro инициализировать его какой-то атрибут ный строкой после этого создаем layout manager и добавляем его в текста речь и добавлять мы можем столько я от менеджеров сколько нам хочется например когда для одного представления для но для них и тех же данных существует несколько представлений после этого создаем текст контейнер и добавляем его way out менеджер по аналогии тоже можем добавлять столько сколько нам нужную например для много колоночный верстки наконец последний шаг это textview которым которому мы передаем текст контейнер это вообще опциональный шаг мы можем рисовать глифы напрямую через layout manager все стандартные элементы и и textview которые отвечают за отрисовку тексты и textview и был уже имеют в себе проинициализирован эй текст кит стек но выглядят и rendered текст они совершенно по-разному здесь никаких дополнительных настроек кроме шрифта не указаны мы видим что текст выглядит совершенно по-другому давайте разбираться почему во первых у нас текст начинается видим не с самого левого края за это отвечает настройка онлайн фрагмент впадинку текст контейнера и она задает отступ фрагмента строки слева и справа то есть если мы его выключим текст у нас подвинулся секса мама левому краю дальше это отступ и сверху и снизу потому что мы видим что они тоже есть и по умолчанию они равны 8 фунтов сверху и снизу если мы их выключим то увидим что текст прям вот поднялся наверх ну и последнее что больше всего бросается в глаза это как раз меж междустрочный интервал и или лизинг и тексту по умолчанию этот лизинг использует выполнит отсюда и такая разница то есть мы от менеджера можем эту настройку выключить и получим ровно такое же отображение какое-либо многие не любят использовать of the layout и рассчитывают высоту текста фреймами и используют для этого метод боуден актрисой скорее всего и сколько я уже негатива слышала в адрес этого метода что вот вам вообще забагован и считает неправильно но на самом деле нужно в него просто передать правильные параметры то есть во первых нужно передать says и указать правильную ширину с учетом всех отступов то есть если мы считаем высоту текста для textview то мы должны от ширины textview не забыть вычесть от ступы у фрагмента строки этот la ligne фрагмент pudding а также отнять отступ и у тех от текст контейнера и только эту ширину уже передать в этот метод атрибут на я строка она не может знать где вы будете ее отображать елы-палы или в textview поэтому нужно передать ей какую-то дополнительную информацию а именно какие-то опции которые она будет использовать при подсчете высоты текста нас интересуют две опции это uses line фрагмент origin мы ее передаем когда нам необходимо посчитать текст многострочный и 2 настройка нужно ли использовать при подсчете стандартный лизинг шрифта то есть вот для лейбла мы можем не должны передавать эту настройку для textview из layout manager это опция включена то мы должны не забыть ее передать тогда у нас этот метод вернет правильную высоту так а наверное вы задались вопросом для чего нам целых две настройки да у нас есть line фрагмент padding который задает отступ и там слева и справа есть текст контейнер insert который тоже можем задавать отступы слева и справа зачем же был придумала целых две настройки и вот на этом слайде я покажу почему допустим мы с вами верстаем электронную книгу и хотим в центре расположить статичную картинку которую текст будет обтекать задается кстати это тоже очень простой текст контейнера есть массив юар безопас областей исключение мы просто берем фрейм этой картинке переводим в фрейм текст контейнера и отдаем отдаем текст контейнеры чтобы уловить эту область optical вот но мы видим что текст прямо прилегают в плотном картинки от не очень красиво для этого как раз нам поможет line фрагмент padding вот я сейчас подсвечу фрагменты спорт и backgroundcolor у textview чтобы было виднее то смотрите если мы будем редактировать так сначала текст контейнер in set и то вот у нас эти инцет и добавились по всему периметру текста а если мы будем редактировать line фрагмент padding то у каждого фрагмента строки слева и справа добавится этот это значение которое мы указали то есть текст выглядит уже совершенно по-другому и он не не прилегает в плотном картинки именно для этого в н фрагмент полинг придуман особо наблюдательны заметили переносы по слогам на предыдущем слайде это не случайно потому что это следующая фича текст кита которая позволяет нам делать переносы просто в одну строчку те кто когда-либо работал спорт текстом они знают какая то боль что-то целое дело сначала нужно определить язык расставить возможные точки переносов потом еще вставить дефис нужное место все это посчитать это просто просто правда боль сейчас мы можем задавать хайфе nations фактор это сделала и задаем мы его от менеджера тогда у нас переноса добавится всего текста либо можем задать объект tns параграф стал тогда эти переносы добавятся только для нужного параграфа и значение это варьируется от нуля до единицы то есть это не просто включили выключили для чего 0 означает что переносов не будет вообще один что мы добавляем всегда когда те текст полностью не заполнять строку значение какое-то промежуточное например 07 означает что если текст заполнен меньше чем на ноль на 70 процентов то тогда мы пытаемся вставить переносы в противном случае переноса не добавляются очень удобно так не уже посмотрели как у нас сдаются обтекание в области в тексте а что если нам нужно добавить картинку прямо в текста есть картинка это часть текста например вот ampersand в rambler нкю я учиться эта картинка должна тоже с текстом делается тоже очень просто мы создаем текст attachment добавляем в него картинку необходимую забор заворачиваем все этого атрибута на строку и все больше работаем уже как с обычно это будет string и как с обычным символом все очень просто здесь есть нюансы мы не можем задать какой-то желаемый размер этой картинке то есть величина символа достаточно там она будет как раз равна ширине и высоте самого изображения и чтобы это поменять или как-то сдвинуть эту картинку пусть она здесь выравнивается по базовой линии и чтобы добавить какой-то отступ надо от наследоваться от нас текст attachment опередите переопределить один метод и уже там добавить какие-то свои отступы если мы хотим расширить функциональность какую-то мы наследуем ся один из текстур же тех с контейнер этом или layout менеджера и если с последними двумя все просто то с текста реджем тут приходится немножко повозиться потому что текста речь на самом деле это класс кластер то есть создавая экземпляр текста реджи мы на самом деле не знаем экземпляры какого класса нам вернется и это накладывает какие-то дополнительные ограничения на наследования во-первых мы должны обеспечить свое хранилище данных это может быть какая-то атрибут на я строка а также переопределить два метода по чтению и модификации символов и атрибутов в этой строке для чего это может быть нужно например мы с вами делаем кота чатик и хотим наполним напомнить всем докладчиком о том что у них сегодня вечером состоится халявный фуршет и чтобы никто не пропустил мы хотим всему каналу отправить нотификацию пишем тучи ну и у нас это автоматически подсвечивается и прям все происходит на лету так как это реализовать в текстуры же есть такой метод процесс editing система вызывает его самостоятельно когда мы оповестили layout manager and о том что произошли изменения в какой-то момент вызовется этот метод что здесь происходит нам нужно найти с планшетом допустим регулярно выражения все вхождения каких-то определенных символов и добавить какие-то свои атрибуты или наоборот удалить контейнер чтобы добавить какую-то кастомные область отрисовки тут тоже придется немножко повозиться из коробки это сделать нельзя мы наследуем ся от объекта и нас текст контейнер и когда у я вот менеджер поставляет нам фрагменты строк мы с помощью какой вот алгоритма начинаем определять области к в каких именно фрагментах текст должен быть отрисован в данном случае это довольно сложная безопас я и создаю из свд картинки и просто перебором и все вхождение пересечения мои моей исходный и мои исходные фрагменты строки с моим ей бездне паз и возвращала я вот менеджер только нужный кусочек а все что осталось дальше записывая времени на rect который мне придет на следующей итерации ну вот фрагмент из рук я показываю так давайте разберем подведем итог да что мы с вами узнали во первых с помощью текст кита можно добавлять динамическое форматирование текста задавать какие-то произвольные области отрисовки области обтекания добавились у нас текст attachment и и переносы по слогам в одну строчку и вообще это честно говоря не все фичи тех скита также мы не рассмотрели тайны миг type и это когда пользователь задает какие-то свои предпочтения по размеру текста в настройках девайса а мы соответствии с этими настройками как-то подстраиваем свой текст ну и наконец с помощью него очень просто делать различные 3 анимации наподобие той также я привела ссылки эту презенташку вы сможете посмотреть у меня на гитхабе вот она первая ссылочка указано typography у нас также есть другой проект в котором есть все атрибуты символьные потому что рассмотреть все мы разумеется не смогли и какие то еще полезные ссылки которые стоит почитать если вам интересно как типографика так и какие-то особенности вывез здесь мои контакты у меня все я буду рада ответить на ваши вопросы у меня к тебе вопрос там вот у тебя был слайд с редактором где ты писала от channel у тебя все это красиво подсвечивалась и все такое можешь вернуться на него я думаю никто не просто не вернуться на слайд катером водная пушка сверх может попробовать написать это в общем не будет интересно что случится если ты поставишь курсор вот посередине и удалишь собаку подсветка останется подсветка удалить потому что смотри вот в этом методе я сначала удаляю текущая текущей цвет экран мор и после этого заново пробегаясь по измененному ranger еще вхождения хоккей смотри вот я над ощущения вот ребята у нас перевели редактора в же и у них была сходной а фича там в редакторе ты можешь заменить любого пользователя точно так же собака username и вот когда ты ставишь пробел собака преобразуется в текст attachment с картинкой там какой-то юзер хит такой ну там человечек нарисован в общем в чем была проблема когда ты начинаешь стирать ты ими пользователя ты стерла все буквы а картинка остается то есть как вот можно решить такую проблему что текст attachment обязательно будет убираться когда ты стерла вот весь тот эфирным без каких-то костылей есть где так но вопрос вообще просто написать алгоритм не можешь тут хороший ну так сходу я тебе не скажу но 1 проц вспомнилось вот такая задача это на самом деле просто техническое посмотреть ну тоже анализировать возможно не только измененные рейнджа захватывать там вниз по радаров и проверять за на здесь скорее меня интересовало можно ли несколько таких символов и текст attachment объединить в один какой-то таким который ты объявляешь что типа есть это удаляешь тут его целиком то есть backspace работает не для символа вот для этого условного taken и нет из коробки такого не только если ты вот ты определишь текста рич и какую-то свою логику реализую что потому можно все что минуток итоге стрелы вдруг есть нет спасибо и расскажи как работать с тапами например у нас есть там какая-то view шичко с текстом там не знаю лейбл тексты и неважно и вот там внизу кнопочка подробнее например который раскрывает этот текст вот можно как-то использовать что-то из да да можно есть даже проекту я пол такой кастом translation называется и там тоже довольно таки полотна года но сделай ты же все что угодно то есть по умолчанию можно задать транзишен в конце translation в середине там как-то а вот это свою логику уже тоже переопределяет дело что год хорошо спасибо есть у кого еще образ привет спасибо за доклад меня зовут если почему раза vita скажи пожалуйста как лучше всего реализовать списочек как раз вот кнопочка и стран гейши на в конце и кнопочкой развернуть потом свернуть обратно так мы такое делали да ну я делала отдельный прям вот у меня был textview и отдельным элементам я задавала другой там ли был или textview уже не помню и просто область обтекания делала то есть вот у меня есть большой textview с каким-то текстом снизу я ему прилепила другой textview и сказала что большой textview обтекай маленькие тикси это было самое быстрое решение она просто там за пару часов реализовалась и все вот но там были проблемы у нас производительности что это не очень быстро работала мы хотели к этому вернуться на пока руки не дошли но так можно за два часа там за час реализовать так и у меня еще один вопрос что нужно сделать ей textview чтобы можно было использовать на списках не лагал выключить backgroundcolor наверное да что ты туда это конечно базовые вещи для всех и лейбл чтобы там не было clear color там всех моментов ну вообще я не замечала чтобы тексту работал как-то намного дольше чем я и лейбл нет или в чем дольше работает можно дело не в textview этому каких-то фталатах но я на самом деле прям не могу утверждать железная сам не проверял просто много где слышал что не любит использовать текст у нас песках но я не знаю почему они любят по идее все это основано да у textview больше настроек но все равно она в итоге что текст you что я лейбл построена на текст детей у них там один механизм рендеринга просто textview больше настроек лейбл текст кит наружу вообще не торчит тексты хорошо спасибо я просто дополнить я делал чатик я делать чатик на textview там типа нам было по две тысячи человек одновременно в чате все спамят в принципе нормально работает то есть это в 30 полагает о самом тексте он наверх это какого-то не дает можно юзать это кабы миф скорей что он страшный лагучий и стремный все нормально и раз спасибо массива"
}