{
  "video_id": "ali_OKrGgDM",
  "channel": "HighLoadChannel",
  "title": "Linux kernel TLS и HTTPS / Александр Крижановский (Tempesta Technologies)",
  "views": 730,
  "duration": 2779,
  "published": "2018-08-16T04:04:09-07:00",
  "text": "собственно сейчас добыл это всем меня зовут александр я сегодня хочу сказать по https и телец в ядре linux собственно будем рассказывать ну будем и потери от в отдельности говорите по https в частности вообще хочется начать проблем htp с вообще говоря на мой взгляд htpc от некоторых такой недооцененный по таков том плане что в целом он никогда не рассматриваться как такая под и патоку для операционных систем в целом сейчас практически любой компьютеру он уходит в интернет и в интернете у нас со мной по такого этаж tps если мы у нас в основном передается кровь папе давид эти педали hdpe стать основной график в скопье живет уж теперь в интернете последнее время сильно развивается интернету хенкс это и мобильные девайсы и разная прибуду к специальные девайсы счас социальные сети с которым мы смотрим видео узнаю новости так далее и соответственно вообще хотелось бы чтобы этот по такого бота побыстрее и получше то есть вообще говоря хочется чтобы этапа таков был некоторым основным сервисом который предоставляет операционная система следующая проблема это атаки безопасность и adidas таки в частности и в батаки в другой страны дедус наш типи ву не это вообще самый интересный adidas который есть to his и полосу пореза достаточно коста с футами бороться паства то на уровне htp начинается самое все интересно здесь у нас есть асимметричные атаки это компрессия это те лес асимметрично атаки заключается в том что сервер тратит больше ресурсов чем клиент это телец хан шейки и компрессии если вы например полете большой post запросы пастись его компенсируйте леди компрессировать следующая проблема она становится более актуально вот мигает может быть такая одна из первых ласточек собственно adidas который выполняется интернету сфинкс 400 тысяч ботов было насколько помню соответственно в целом интернету хенкс нам позволяет иметь сотни тысяч или в дальнейшем миллионы ботов соответственно получаем достаточно тяжелый не даст компания что у нас будет очень много ботов каждый будет сувать понемножку это могут быть достаточно валидные запросы их тяжело будет почитать и отрезать соответственно такого типа adidas в час используется машин обучаем который тоже есть свои проблемы дальше я немножко еще тоже расскажу поэта но основная проблема в том что кроме я сложность сами хуга ритмов проблем еще заключается в том что у нас есть некоторые uac то есть как только у нас начинается деваться-то к нам нужно повернуть классификатор то есть от каждого борта обработать несколько клиентов до запаса для того чтобы понять кто является потом кто является дитем на запросам и в это небольшое окно у нас проседать систему то есть в целом для нормальных систем это может быть минут или несколько минут вот такого пасе дания соответственно если у нас достаточно легкий трафик то есть каждый год он шлет редко запас это у нас так но еще больше растягивается давайте посмотрим например вот нижний строку это ссылка на доклад клауд в и там они приводить достаточно простой пример данном примере вот сеть словам запасы с хвостом у кота в конце 80 под указано то есть нормальный htp клиент никогда не указывать 80 под он по дефолту казалось бы это достаточно простой паттерн о папе давать его достаточно тяжело если мы подумаем как его можно за фильтровать то что приходит на ум и и самая быстрая то есть , босс которые работают то в цепи стеки и вплоть до ситуации на сетевом адаптере но все адаптеры строки нам не разберет но тем не менее мы можем на нем фильтровать а адрес отцом это ситуация на низкого в него очень быстро поэтому еху в один пункт добавим проблема этих подходов достаточно общее в том что наша сигнатура скотом может пересекать границу пакетом соответственно если пересекли границу пакета то ни одна из этих тут утилит не ни один из этих механизмов не может отследить сигнатуру настоящая проблема в том что где нам искать то есть перед х 100 мм у нас может быть длинный никто не запрещает нам ход поместить после длинного cookies и так далее то есть все мы можем молотить достаточно большое количество данных перед тем как мы наткнемся на сигнатуру либо ее отсутствие следующее что приходит в голову это за фильтровать на web акселераторе в боксе регаты уже имеет представления буш типе он повысит заголовки но он не подходит для ситуаций чуть позже расскажу почему что действительно хорошо здесь работает это одессы и а без такие как суриката сурикат это чудесный инструмент который имеет фильтр на всех уровнях то есть вы можете сказать что пожар , мне трафика такого-то и пи адреса содержащий такой таш тебе заголовок или такой сигнатур таком таш тебе заголовки проблема у офисов и одисов следующие она не является communications and point то есть она непосредственно не участвует не ваш типе нефти цепи обмене трафиком это значит что она просто подсушивает трафик и не собирают они как есть достаточно большой объем висячего даже где-то 20 летней давности о том как обходить одеться в принципе там все достаточно общее поскольку отец работает на своей системы своим представление как собирается цепи и трафика каботаж т.п. эти писарей могут отличаться от целевой системы на который собирается т.п. вот простой пример 20 сегмента прикрывающийся и какой сегмент мы возьмем данные с какого возьмем из первого лица 2 следую что обязательно нам нужен нужна двойная обработка данных то есть у нас есть конечная система web-сервер который бла бла кишти пейте мини-отель так далее и у нас отец должен делать то все тоже самое ну соответствие получается двойная обработка данных в кластере в целом это не очень здорово следующая проблема в том что когда мы говорим по adidas мы не говорим о прекращении даст мы говорим о смягчении мы тягаешь adidas ты знаете что так или иначе мы всегда предусматриваем что какая то часть нелегитимного трафика доходит до конечной системы соответственно вообще хотелось бы больше производительности вот на нашего классе обрабатывающего в предельном случае видос он сводится к flash caught когда к вам приходит большой объем легитимного трафик например вы провели хорошую рекламную кампанию и к вам пришел много посетителей и хороший дед с отцом до него задача такая что он не должен быть отличим от этих ситуациях соответственно мы приходим к тому что хотелось бы построить систему со следующими характеристиками беха она должна быть коммуникаций напоен то есть она должна на себе темноте вас понимать и степи и так далее должна очень быстро работаете должен быть очень быстрый быстрый подсистема сетевое сетевой обработки очень быстро тебе паста для того чтобы она хорошо переваривал разные фуды следующие должны быть в конечную систему который непосредственно делать полезную работу должны быть устроены механизмы ситуации причем достаточно гибкий чтобы мы могли бороться достаточно со сложенными diedas атаками следующий неочевидный момент это должен быть мощные быстрый webcache как раз это следствие того что у нас есть в момент атаки который может начинаться нас очень плавный и вот момент старта может быть довольно долгим у нас есть пасе дании по классификации машинного обучения соответственно в этот момент нам хорошо иметь достаточно большой запас ресурсов для того чтобы мы могли как-то обрабатывать запросы и отвечают даже не на нелегитимны и ну и соответственно даже когда мы уже построили все наши классы машин обучения нам все равно нужно учитывать что какие-то запасы будут проходить через систему соответственно все она система будет работать под повышенной нагрузкой нам нужно отдавать из кэша даже на нелегитимны и ответы вообще говоря система которая агрегировать себе и доставку контента и фильтрацию то прикажи delivery контроллер большинство прикажи delivery контролеров они в себе ну по сути это вот все что вы можете придумать все туда пихается это некая железка или приложение который может вообще делать абсолютно все что вам понадобится от веб-сервиса мы концентрируемся вот на веб каши adidas защите и балансировки нагрузки при том что обычно при хождении контроллеры имеют себе компоненты web security так называемого при конечно файлов мы не пытаемся в стеке в стек из пяти венок составить полную обработку всех вы оба так а как зрелость только на наиболее легких которых можно оценить достаточно быстро простыми сигнатурами соответственно мы говорим по го фокси регаты то есть с у вас ну как случае с в боксе ребятам если у вас есть ферма в в apple конечно файлов то можно поставить ем пиццу перед ними и она будет создавать трафик и соответственно встать перед фильтрацией у для бафов давайте посмотрим немного глубже на современные в боксе ребят и чем они не хороши для фильтрации трафика ну во первых вот на слайде показана всем хорошо известны в боксе rotary что они в принципе должны и умеет хорошо делать они очень хорошо отрабатывают контент будет евка нагрузку делают делать очень всякий шум сложный штуковин саш типе таффи camry v light глазные geode серии так далее очень много всего частности они делают и ситуацию тем не менее все эти в бак сироты они проектировались лет 15-20 назад то есть тогда была проблема 10000 полезных соединений по которым они проектировались сейчас уже 1 немного изменились во-первых ситуацию они делать не очень хорошо ситуацию делать не очень хорошо в частности в производительность потому что пасуешь типе food их положит имеет смысл говорить еще атаки теона и de dos атаки то есть с и приходит не постойте dass die das который просто есть вот уже существующие вот на эту пасту отдают вашей вере вот как бы он его долбит есть таргетированный недостаток когда и хороший de dos атака она подбирает специально под целевой рисую соответственно если вы не справляетесь например с динамикой дадут много запросов на динамику на базу данных если состоянии переварить большое количество маленьких пакет вам дадут большое количество маленьких пакета то есть вообще говоря хорош adidas это всегда о краевых случаях если вашей системы проектировать с тем что в основном мы обрабатывать какие-то запасы мы их обрабатываем быстро то вам дадут те запросы на которых вы работаете медленно соответственно мы должны думать если мы строим систему защиту мы должны думать и от таких кривых случаях следующее что в чем не работает в проблема 10 тысяч соединений это vs цели то есть клиент в принципе может дать вам просто много соединений обычных либо много из цельных соединений соответственно нас становится все не очень здорово в истории известны попытки сделать в боксе ребята внутри ядра linux этот акт так httpd они все уже не существуют сама не спортивные примерно так же как и ее за space axe ребята это тоже socket это потоки только ядерная соответственно у нас нету копирований и как только у нас появился интерфейс and файл который нам бегают большое количество копирования и появились дешевый контекст свечи благодаря ленивому tb то отпала необходимость в этих как соответственно их от них отказались но вообще говоря они снова снова возникает необходимость них для обработки ешьте псы для защиты от вида сам во первых чем почему современная же тебе активаторы работают медленно чем они не удовлетворяют я сейчас смотрю подробно только то что относится не последовать htp с по презентации вот все пункты их можно найти в моей презентации на на деве если кратко то первая проблема это не не быстрый интерфейс ввода-вывода сетевого все мы видели что если запустить пев на рабочий вообще или то мы часто видим спину лог ядерный есть проблема того что плохо работают htp цепью каши из за того что у нас большие очереди есть копирование системных вызовов как опирания немного больше скажу psl но и любой системный вызов это тоже некоторые копирование и интересно следствия в том что если померить сколько тратит hd poxy ребята на блокировку нелегитимного запаса и обработку нормального то иногда мы можем увидеть что блокировать запросу это дороже чем его отдать из кэша это вообще вообще неправильно следствие который говорит о том что ж теперь все это не предназначен для фильтрации большого объема трафика подробнее page типе вот слева показана диаграмма как вообще обычно погонять с htp стоит машина она имеет достаточно много циклов имеет неправильную переменную состояния ну так обычно благами состоит машины так пока место просто их писать справа более правильная стоит машина которая делает прямые jump и так построен года генератор лагерь но к сожалению ноги нельзя использовать для htp стоит машин потому что аж тебе не является регулярным языком соответственно что поучить достать мышцы ht припасы нужно погонять другой стоит машину следующая проблема что большинство htp axe готов использовать обычные липси вызову но это в хорошем случае плохом случае они до обработки строк использую такие же самописных fsm который медленно и проблема с обработка жить и песок в том что они очень специфичны они сильно отличаются от сестер у них нет то темнеющего 0 у них термина ты могут 1 байт нами быть причем глаза на это могут быть зависимости от контекста перевод каретки это может быть ; либо : но может быть и 2 bad на терминация соответственно когда мы оба ван наш теперь сроки нам нужны другие алгоритмы такие как находится в lipsy последнее что липси все-таки не достаточно быстро зарабатывать при том что у нас есть в x2 в современных процессорах там до сих пор она не используется здесь показано на слайде результат для того что можно сделать быстрее во-первых если взять после обычной htp стоит машина переписать и порно можно получить подарок раза больше в производительности если использовать правильный алгоритм для парсинга htp структуру можно вот в пять раз быстрее отрабатывай строки и тем более если у нас мы заботимся о кривых случаях если мы заботимся больших луки о больших юрий который не такая редкость современных в приложениях то мы можем получить еще больше прирост производительности следующие приятное следствие из-за уга ритмов новых специфичных для шкип для обработки срок это ситуация ситуация символов в этих строках то есть ваш тебе есть грамматика которая разрешаю только определенный набор символов и соответственно мы можем их за погонять и при обработке при сканировании песок можем отслеживать не допустим массивы соответственно намного тяжелее в такой hd poxy регаты придать какой-то атаку инъекции первое что нет ни пива вообще сейчас популярны подходы к перестроение уж теперь активистов переносу их на кино байпас подходы то есть мы знаем нет мы ппф ринг где это модные слова которые позволяют нам очень быстро превратить трафик из посмотреть презентацию на нет map он позволяет молотить 10 гигабит на одном ядре это действительно хорошие результаты но работают такие такую производительность можно получить такую только на очень простых приложений то есть если вам нужно очень быстро перемать этапе есть прямо тить и типе это хорошо работает если вам нужно собирать себе стрим делать прикладную работа-то ботаник конечно всем перемещается что наш теперь в сторону работы с сокетами чуть позже я покажу две проблемы из работы с сокетами и с htp который приводит к как-то к тому что я на байпас работает не лучше чем еду следующие проблема в принципе союза спасти 5 стеками в том что ты себе api стек это достаточно сложная система до которые нужны очень гибкий механизм и синхронизации и быстрой аллокация памяти то что хорошо сделано в ядре и что есть в том что в контексте да у вас есть контроль за вытеснением задач в успей сегодня соответственно вы можете получить пыльный рид копия апдейт механизм и за спейси есть плитка ape апдейт но работает он на порядок медленнее далее если мы выносим usa space 5 стек визу space to иногда мы используем обычные потребные примитивы потребные примитивы самой легкой синхронизации это спиной к спинке сделано при все плохо там нету паузы и алгоритм там достаточно по стоит на обычном in the вам счетчики которые к тому же много десятилетий в ядре используется более прогрессивно механизмом ses который учитывает конкурентность между многоядерность между многими я драме следующее что теперь как работает со страницами с большими а локациями памяти соответственно него есть доступ непосредственно к бодя ваката в операционной системы если вы делаете приложение нам use space теперь стыке вам нужен быстро лакота страничный то есть вообще как буквальная use space 5 сек должен провоцировать большой объем памяти на сайте в операционной системы и дальше самостоятельно добавить на странице то есть придавать радиолокатор по тел с двс нам внес новые проблемы если раньше у нас был сын фототипа у нас не работает чтобы у нас за крипто водяных которым мы отправляем соки нам надо сначала взять файл с копейки в use space там за криптовалюты снова копию не в другую в другой буфер и потом этот буфер скопидом таким образом у нас получается много копирование с инфа у нас больше не работает который нам диска отправлял сразу буфер формировал отправлял в цепи а пистик без любовь вообще вмешательства use space а соответственно эту проблему адресу сейчас вот три работы to facebook здесь в те ссылки на них mellanox если подход и facebook декремента же самое что сделанный от flex 2 free bsd но в линуксе mellanox немного в другую сторону работает ну прежде чем перейти к рассмотрению этих случаев давайте посмотрим немного на историю у нас история знают как минимум две системы 1 кассель как видно здесь из версии linux и в конце лета очень стар и самый проект он тоже уже не работающий но что в нем очень интересно то это противно open цель виду а linux и патч партию не занимает очень большой объем соответственно поактивнее библиотеки едва достаточно простое у solaris уже очень давно и даже не нашел начиная с какой версии имеется с фокси этой один реализации цели которые вам дает и с этими нато в ядре операционной системы но как говорят инженеры solaris это все сделано в основном для старых себе архитектуру в ядре linux начиная с от нашей текущей версии 413 появился один это собственно и тут работа facebook и red hat который вниз и едва она выключена по умолчанию соответственно при компилировать и двое из и нужна эта поддержка ядерный tvs не имеет хан шейков то есть он может охладить только стрим пример утилиты ну как бы тесты утилит посмотреть как это работает везде space можно teeth по ссылке с 3 будет и если кратко то у нас красным цветом выделены и новые компоненты из которые вот появляются в нашем новом приложении во-первых мы создаем крипто контекст специально структурка новое далее мы устанавливаем соединение по соки то устанавливаем но в данном примере это гнутая высота пачино версия ответ хата которые у нас уже есть через гнут л.с. мы создаем новый контекст устанавливаем крипто соединений то есть пока все как обычно идет дальше мы видим четыре вызова мем себя это копирование установленного крипто контекста внутрь с в нашу новую структуру cu ceai далее мы делаем две вещи мы пиво переводим наш socket в состоянии трелиз оговорим что теперь мы теперь на нем есть стресс и все что через него проходит оно должно шифроваться и последней строкой мы во-первых передаем сиай а в виду чтобы еда перехватил крипто контекст 1 ну ты веса и выставляем факт stx которых обозначает что любая запись и звезды space а уже будет будет шифроваться перед отправкой a-nox использовать тоже и тот же интерфейс тоже вот коте лес подробнее почитать по то что делается в карточках mellanox можно вот на их презентации цена на деве и здесь показана схема того проблема к с которым мы сталкиваемся на те лес шифрования в ядре дело в том что с он нас рек от ориентированные здесь показана дворе когда которые которые содержатся в 5 пакетах причем первые 2 река это не конец первого века до начала второго ряда содержится в третьем пакете это вот средний вот эти квадратики проблема проблем начинаются если у нас например в четвертом пакете начиная с 11 лет мы теряем если этот пакет то мы должны его снова период править но проблема в том что поскольку у нас в третьем пакете пересекаются два тела с река датам 2к контекста то мы должны удерживать 1 рек от тельца не освобождать его даже если он уже успешно доставлен для того чтобы установить контекст в третьем пакете и перри шифровать его соответственно в драйвере мило ногтя и в 1500 есть под полка на освобождение пакетов мы их освобожденным только тогда когда сместиться окно и текущие пакеты текущего века до не зависит от предыдущего что ну нам на наш взгляд не очень здорово сделано в данной реализации дело в том что поскольку в разработке в основной основной участие принял facebook то они решали свои задачи фейсбук вполне понятное и skates как принципе у большинства ресурсов мы открываем во вкладке facebook потом иногда на него возвращаемся соответственно у нас есть уже установленный крипто контекст и мы должны выполнить только быстрый быстрый раньше ихтиоз соответственно их не очень интересует хан шейки новых пользователей им важно чтобы они свой контент уже пацаном соединениям отдавали быстро в нашем же случае если мы хотим защищаться adidas для нас хозяйки становятся очень важны в оковах тел с 13 сильно оптимизирует хан шейки сейчас это секс цена за 1 т т есть задел на то чтобы он установиться без и т.п. но тем ни менее нам еще очень долго жить с 12 мы в целом вот я не знаю сколько сейчас пользователи windows xp но видос пережил очень долго может быть он и сейчас до сих пор живы живет то есть где то имеете ввиду старая система the legacy клиентов нам обрабатывайте еще очень долго то есть мы не можем просто так сказать что мы не обрабатывайте в с 12 и все соответственно любой момент нам может прийти бот нит который прикинет со старыми клиентами мы в принципе должны как установить и таких on шейки следующее что у нас есть л.с. ренегаты вечно который рекомендуется отключать но суть в том что клиент принципе может всегда попросить сделать ли негатив на фейсбук это не очень интересует потому что клиент у него в основном валидные видосы вот тоже не сильно беспокоит по этому самому хан шейках они не думают для нас хан шейки важны мы хотим иметь устойчивость к различным видам diedas соответственно мы потеряли мбит тесто достаточно легкая библиотека в ядро это за него всего один человек а месяц пока он в целом у копирование между буферами у нас нету но сама библиотека внутри себя имеет копье не мы сейчас работаем над тем чтобы их выкручивать оттуда htp с выглядит как продолжение с 5 стека то есть обрабатывается также как и себе api пакеты встроены очень быстро аж теперь посыл котором я рассказывал раньше и очень быстрый webcache добавляется сейчас еще в процессе работы это карте все вальс режущий видос ботов и специальный язык для ситуации а так это то как выглядит архитектуру то есть у нас есть open the happy дальше htp абсолютно также аж теперь страсть как и в цепи поверх api также на call back ах а первое это пакет приходящие походит уровень ситуации до штаба tcp нато теперь работает карте вовсе вас который принимает решение не придушить и нам клиентам дальше попадают вашти припасов и зашить и припасы либо мы походим в модуле фланг ситуацию и павел ситуацию сразу попадают автоматически на уровень айпи то есть дальше мы не будем а баба-то штепа да ну клиента bumbo кети а новые не айпи либо облагаться из веб каша либо отправляется в up stream кольца всего собственно работает на измерение того сколько нам шлёт клиент запасов и сколько на данный запрос приходят ответы то есть если мы понимаем что сервер не справляется с запасами этого клиента из клиент просто отпали за после не интересуются ответами то мы его при душевая придушить мы можем по изменению конце цепи и вплоть до блокировки по айпи это собственно проблемы о которых я говорю в начале что обычные htp акселераторы принесенные на кино байпас подход на ios 5 песок не получают достаточно в производительности здесь показан пример обработки данных h теперь себя там он принципе такой же как даэдра так и для use space а суть в том что клиентский socket на котором мы получаем график от клиенты и серверы по которым мы отправляем данные севу они могут работать у нас на разных ядах и обычно это так и случается соответственно нас есть это теперь контур бог для каждого из этих сокетов это достаточно объемной структуры данных первое что мы делаем на первом ядре получаем эти данные и переносим в usa space дальше виза space мы всегда должны переписать аж теперь заголовки ну как пару так случается что нам нужно это делать при портировании соответственно мы опять копируем данные в новой буфер для с уже модифицированы и потом снова мы это все копируем в ведро для того чтобы отпасть на другой socket хуже того что здесь мы должны еще и по блокировать жакеты и там где у нас бабос htp трафик и за спейси либо мы лучшем случае мы висим на ядре клиентского сокета в худшем случае мы вообще на каком-то третьем в ядре висим которые с которым мы путь также получить доступ к обоим бокам проблема с блокировками во 1 общее говоря у нас ваш т.п. дуплексное соединение то есть пока мы отдаем отдаем запросы от клиента сервисе она может отвечать нам предыдущие запросы особенно актуально если в обще используют степи pipeline большинство фокси их не используют мы его используем ешьте пипой панда увеличивает производительность я немного дальше покажу это на картинке соответственно нас возникает проблема сроками но простейший случай до двух что если мы во время обработки и клиентского пакета должны заучить северный socket для того чтобы рисовать через него данные но и при обработке ответы должны сначала чем семь высоких потом клиент сквозняк российский до долг самому конечно кагами сможет решить но вообще ходить к двум о ком из разных хотя это не очень долго и не очень быстро следующие что делается в нашем тебя писаки поскольку мы работаем на call back окна у нас по сути соки то они есть как а все акции на очень легкой мы убегаем большое количество уроков убираем весь уровень файлы дескрипторов убиваем очереди соки то соответственно очень сильно облегчаем сама обработку пепе в ядре для решения звуков улучшения работы с цепью я дам мы вводим быстрый транспорт интервью по сути на каждом ядре у нас есть бог frank буфера в которых кладется задачи если мы хотим отправить например запрос от клиентского сокета припаять его через северные socket мы добавляем специально работу с этим запросам вариант буфер северного едва и зовем там обработку прерываний и когда будет возможность то 2 2 а твой ту же самом эти данные соответственно нас меньше данных передается между ядрами и у нас нет блокировок соответственно система может работать более половина на большом количестве приятно кроме производить здесь приятно особенно в том что у нас меньшего это сиесты если нужно нас of the real time to это позволяет работать быстрее следующая проблема с которой сталкивается все равно любое штепенко siri вату это копирование на модификаций htp заголовку вот давайте посмотрим что нам нужно мы по активам запасы нам нужно вы кого дафа добавить свой айпишник это где-то посередине скобы это дескриптор сокета в ядре linux он ссылается на пейдж фрагмент это то для чего нам нужны собственно бодя ваката use space мы работаем с пестиком и собственно обычно это решается тем что мог оставаться вам новую область памяти copy он туда данные пишем новые соответственно у нас делается следующие вещи поскольку у нас уже есть интерфейс скб в ядре который предал предусматривать фрагмент ас мы используем фрагментацию мы в том месте где нам нужно добавить новый api шнек мы режем из одного фрагмента делаем 2 и между этими двумя фрагменты вставляем третий фрагмент непосредственно уже с контентом нового печника как бы технически это переписывание 3 point of это операция очень быстро намного быстрее чем копировать весь а степей заголовок тем более если он может содержать там килобайт на ее теле и cookies хочется еще поговорить ближе к концу о бож типе 2 и как новых потоковых во первых здесь на картинке показано проблемах и дав while making это то что есть даже если вы используете аж типе папой то есть хороший pipeline мы можем сразу бросать много запасов не ждать предыдущие получить пачку ответов но если первый запрос медленный то мы должны ждать ответа на него сначала для того чтобы выставить очередности 52 позволяет нам избежать этой проблемы у него есть компрессия это тоже хорошо но все же ником весе не очень здоровская который этот алгоритм он позволяет компульсивным данным превосходить по размеру оригинальные данные соответственно нам нужно копить мы не можем сделать компенсирован place соответственно ваш теперь два некоторые техники оптимизации они недоступны то как ваш тп-1 и в целом navi наверное он больше имеет смысл для обработки на стране клиентов но внутри костика там где у нас быстрее быстро сеть короткая сеть нам весь смысл работы htp 11 он у нас еще нет гривен то есть у нас реализовано проходит как а стадию оптимизации копирования и сколько тоже появится quick это интересный патоку из hd2 оптимизировать непосредственно уж тебе так века оптимизирует цепи обработку выглядит он как use space библиотека у него есть ряд оптимизация это быстро хан шейки это дубликаты которые вызываются всегда для того чтобы смягчить возможной потери но у него есть особенность он работает поверх египет это пытаться собственный по минимуму использовать с 5 стек операционной системы поэтому работает cdp проблем среди пи в том что квик данные htp это достаточно большие данные их много течет но для вас как администратор это выглядит как большой объем эдипе трафика совершенно непрозрачную то есть у него вообще минимальной заголовки вы не можете обнаружить что это за египет то есть если вы поднимаете производительность все если может быть снимайте видос htp diedas то вы получаете очень хороший вектор атаки иди прихода больше вы не можете на машине на то там жабо или каком другом железным решение фильтровать и дипе food потому что вас собственного ваших степи трафик легитимно выглядит как видите фут с другой стороны есть pifast upon который позволяет вместо одного тайного хан шейка теперь делать одинарный есть с 13 который в принципе вместе они решают проблему хан шейков вот насколько имеет смысл переходить на идите с тем что это появляется вектор атаки с тем что у нас есть оптимизация шейков непонятно хочется упомянуть еще отдельного все достаточно свежие там это по сути перечисление всех когда-либо известных атак на уровень tls там хочется выделить сейчас проблем в ренне детей же который рекомендуется отключать и собственно симметричный diedas связанных с шейками ну там еще достаточно большое количество других а так описано большинство из них уже не актуально потому что относится к с целью которой сейчас рекомендуется отключать поддержку в ds1 3 появляется у нас квант пазл с это специальные расширения встроен в тело с хорошей которые нам дает несколько опций мы можем попросить клиента ответить нам простым их это видимо вот какие то некоторые отладочное расширении либо попросить его много раз вычислить хэш сша либо решить проблему задача дней рождением ну сейчас это все находится еще в состоянии драфта последние 2 тонны июлем датируются ну пока еще не стандарт на стороне tempesta мы реализуем ряд гайд лимитов которые позволяют как раз хитрого adidas у нас сейчас есть задача по телу исхан шейком в работе обычные ты соединяешь тебе соединяем и тоже режем по ряду лимитов есть имеет и по количеству чанков htp по частоте подключение так далее по с так таком мне не очень глубокому но тем менее полезному полезные опции ситуации в оба так у нас есть ряд элементов ограничивающие йогой cookies есть проверка на инъекции поверг алфавитов так далее из полезных еще для при конечно вы adidas fitch есть стики cookies соответственно сам себе bph теперь стек может выдавать кукле челленджи заставляя клиентов их решать и сейчас процессе работы есть еще java script челлендж следующая задача над которым мы работаем the multi-way файла для того чтобы могли также как нас увлекать указывать правило на уровне как аж типе такой api и еще что нам позволяет будучи в пекин нам удобно интегрируется с api той вас надфиль там то есть с и вы пишете правило на 5 bus вы можете в какие-то пакеты например с определенным адресам добавить маг и этот маг будет известен тем песни анапа собственно продолжит обработка начато в api трибус это собственно то как можно интегрировать опять я пил уровень и аж типе уровень мог производительность и вот у нас есть измерение производительность каша но доступно у нас на вики это дороге измерения конфигурации почте чтобы можно было это все установить на самым дешевым процессор четырехъядерной мы достигли 18 миллиона запросов в секунду там мы сравнивали это с индексом то есть сам оптимизированная дженкс ну тpocaми в нашем конфигураций который указан на вики с выключенным акция с логом это 600 тысяч пальцев на том же железе то есть вы получаете это в 3 раза быстрее жены коса в среднем по идее мы должны быть намного быстрее чем дженкс в условиях ситуации дедус поскольку мы опускаем по winapi уровень сразу но как бы вас позитиве даст нас фобий не получат потому что нужно очень большое количество адресов интересное следствие из того что мы получили померили это как бы не настоящие все бенчмарки то после некоторое такое ты не сравнительные биг мак это просто для того чтобы иметь какое-то чувство того что чувства технологии и возможности соответственно если сравнить этот меч макс мяч маком seas то на 4 ядах то это вот у них по участке это 132 миллиона запросов в секунду и в центр получаться htp с 5 стек он не уступает взываете за space стеком собственно при том что все а стала очень простое теперь api а тем не менее основной ботаник этаж типе и соответственно то то это лимитирующий фактор хорошо в таком стеки то что мы совместимы с развитием утилитами linux таким как touchpad бпф и так далее если вы работаете с запись о ком-то вы теряете возможность работа с этими утилитами собственно сейчас у нас около тридцати тысяч строк расширения linux это меньше чем любая фао система мы не пытаемся вынести абсолютно все фичи в и 2 вместо этого мы там держим только то что критичен для обработки htp и для защиты adidas все фичи такие как машины обучения как компрессия как и динамика все выносится визу space до этого нам нужен сделать копию транспорта за два визу space обратно сейчас он еще не сделан есть только дизайн этого по с помощью транспорта можно будет расширять функциональность такого серого ну всем спасибо я закончил вопрос каким станислав мегагруп вопрос такой я насколько понимаю это фокси и входная . всего веб-трафика если решение с резервированием этой в общем то точки то есть там остается 2 таких прокси до что будет при отказе одной комнате не такие архитектурные вопрос да у нас на вики есть сценарии hail берите соответственно решение такой же как и всегда две ноты на нем на тяге к пуарт и они рис tattooed но у нас сейчас сайт он работает потерпев ты там на одной машине две винтовки между ними тепла fd если что-то происходит отказ какой-то то 3 пытается одна машина другая подхватывает трафик либо sn2 либо актив активностью то есть можно этой другой делать не каст не ко сну то мы тоже все на веках работы виртуальных ip-адресов то есть берете там несколько виртуальных адресов они там не греют между нодами это тоже как бы через колготки это к нам не имеет отношения то есть мой приказ работаем с обычным своих там спасибо всего вопроса ну окей ты да спасибо"
}