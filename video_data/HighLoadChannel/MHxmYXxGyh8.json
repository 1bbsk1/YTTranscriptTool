{
  "video_id": "MHxmYXxGyh8",
  "channel": "HighLoadChannel",
  "title": "5 лет в А.Д.у - Расчет цепочки поставок / Артём Цурков (Сеть Связной)",
  "views": 557,
  "duration": 2872,
  "published": "2020-04-14T11:09:55-07:00",
  "text": "сразу начнутся спойлера чтобы вы понимали о чем я буду рассказывать и что следует ожидать итак мой рассказ это путешествие а путешествие всегда начинается с цели цель это ли вы посетить новую страну город локацию в нашем случае мы рассмотрим нашу предметную область и проблема с которой мы с ней в ней сталкиваемся далее в каждом путешествии это подготовка к нему собираем вещи тренируем себя бегом по вечерам особо сильный бегает по утрам что в нашем случае это мы пройдем с вами низко шагов которые позволят в дальнейшем сделки через любовь более плавным спокойным и и вернуться то вы оттуда живыми и здоровыми следующий шаг путешествие эта прокладка маршрута здесь мы немножко с вами познакомимся с теорией далее не одном путешествии не обходится без транспорта в нашем тучи транспорт это сервера баз данных приложения front end and jynx и так далее все вот это нужно выбирать с толком и не делать не брать ракету когда вам нужно соседний магазин и последнее путешествие всегда заканчивается и успешным возвращением домой надеюсь после моего доклада вы сделаете некоторые выводы тем кто только в начале пути или делает первые шаги в разработке на основе предметной области убедятся в том что они движутся в нужном направлении чего не будет в докладе не будет трагедия размером с титаник да пару шли по kombat топим но с кем не бывает не будет нескоро не оптимизация питона не будет сложно струю структур данных для быстрого поиска не будет миллиарда запросов день поехали проект логистический цель его быстро гибко управлять доставками в разрезе каждый из витрин если что такое доставки вам уже до этого рассказали вы представляете то витринах из старых чуть более подробнее компания связной это больше 5000 магазинов по всей россии разбросанных по тысяче городам соответственно у бизнеса есть идея что в каждый каждый магазин это отдельная витрина на которой свои доставки свои оплаты свои возможности но это не все есть еще несколько продающих интернет магазинов которые также предоставили возможность выбора города региона и соответствии с этим у нас происходит еще большая персонализация что крайне неудачным образом сказывается как на нагрузке так и на сложность самого проекта основной проблемы с которой мы сталкиваемся производительность системы у нас десятки миллионов запросов в сутки и скорость просчет одного запроса составляет порядка секунды большое количество ошибок они связаны как со сложностью предметной области так и часто меняющимся направлениями и желаниями бизнеса и последнее проблемой это скорость разработки давать им стану остановитесь на них поподробнее производительность как я уже озвучил у нас сейчас данные изъяты на октября 23 миллиона запросов день средне время ответа восемь десятых секунды и ближайшие месяцы бизнес уже хочет чтобы мы выросли до 100 миллионов запросов день и время сократить до 3 десятых секунды на 99 и 9 периоде процентов запросов амбициозная задача вторая проблема сложность предметного гостя основные факторы расположения товаров у нас 40 своих складов сотни поставщиков тысячи магазинов и если клиент находится на дальнем востоке и заказывает телефон себе то можно ходить на складе под санкт-петербургом у какого-то из пучков и путь которым да и пройдет до клиента он большой далее ограничение в правилах перевозки ну вот здесь у данте просто там жидкой в игру газообразная взрывчатая мы не вой мы не возьмем обычным транспортом a8 специальным самолетом тоже нельзя проводить даже газонокосилки рентабельность опять же есть высоко маржинальные товары которые выгодно возить а есть холодильник который самолетом не на водишься график работы в праздничные дни в часы пик мы предоставляем возможность нашим клиентам выбирать только те заказы который мы точно исполним и чтобы не получил старков возвращается с работы домой сзади в наш магазин он не стоял еще полчаса я в очереди до мы предоставляем клиентам возможность поставить покупки только на следующий день но и частично теряем на этом но зато остальных лет остается более даем довольны еще у нас очень много факторов которые влияют который находится наши приметной области влияют на сложных расчетов на самом деле вот это пример того как бывает если выбрали неправильная поставщика третья проблема это проблема со скоростью внедрения нового функционала скорость разработки на первых шагах она достигает 1000 строк в день спустя уже пару месяцев это сваливается td300 в три раза меньше еще через год полтора это уже 50 строк кода в день вы представляете то в 20 раз медленнее и меньше представьте выйти на работу сейчас час времени а будете ехать 20 часов вы просто даже не успеете вернуться съездить вернуться с работы следующий этап цели мы озвучили следующий будет подготовка представьте что вас черный ящик я думаю с высокой внутренней внешней связанность я думаю любой из вас это сможет легко представить но с чего начать что делать с ним надо узнать где болит у кого спросить у бизнеса спросить у разработчиков поговорили с бизнесом поговорили с разработчиками поняли что нам озвучили какие-то цифры как новых проверить смотреть влоги на что делать у вас черный ящик что делать из логов нет начать логировать первый подход нативный поговорили с бизнесом основная проблема была в том что топы не любит ждать как когда кладут в корзину товар и формочка оплаты появляются через две секунды вот им нужно быстрее хорошо за лаги или за лаги равале время ответа но она ничего не показывает у нас еще десятки у нас обращение в базу обращение другим сервисам хорошо лагером время ответа из коля следующий этап лагерь на обращение к внешним api и внутренним но опять же один запрос перед десятки иногда и сотни то нет но 20 запросов точно генерит как понять какой из них какому основном отрос внедряем приседе что еще нужно агрегировать основные показатели в нашем случае интересный показатель был это варианты заказов в дальнейшем узнаете как он появился но мы видим это вообще весь трафик можно лакировать это поможет нам отвечать на возникшие вопросы проблемы и брюшка решать их в более быстро сделать его не части предметной области что ведут приведу пример допустим нас есть склад на котором у нас систему с онлайн остатками в нем есть склады продукты 10 айфонов красных 10 зеленых 50 желтых они начинают вымываться со склада десять девять восемь так далее 0 в какой-то момент у нас получается овербукинг и мы должны предоставить такую ситуацию но можно ли же после заказ оформила клиент недоволен как разобраться и понять чем дело ну хорошо мы начали логировать мы записали в логе в грелок примеру кстати как вы пишете как общайтесь трепетом по тисе пи или пдп ладно пусть он чуть позже хорошо записали в логе нашли этот лог на что он дает мы смогли только понять почему сейчас проблема произошла мы не можем откатиться и восстановить всю всю цепочку давайте сделаем этой частью предметной области вспоминаем что у нас есть такое понятие как иван сортинг мы берем и сохраняем события то есть у нас пришел к определенный груз ушел пришел товар ушел списали списали списали таким образом мы сможем устранить полную цепочку на любой момент времени вы можете возразить что данных много у нас там 5000 складов 20 миллионов позиций они постоянно мигрируют и за день это 1000 той миллион операции верно внедрите такое понятие как инвентаризация ее можно проводить хоть раз день у вас будет срез который вот фиксируется ночной и потом сзади накапливаться так много данных которые с которой справится любая машина дальше за на дерево или посмотрели у нас систем массового обслуживания притом запросы в ней отличаются в 1000 раз сложно представить что-то похожее в реальном мире допустим это воробьёвы горы эверест этот различие в сто раз они в тысячу вот мы живем в таких условиях у нас график нагрузки циклу на одной из расчетных машин у нас в течение пяти минут может колебаться нагрузка от 80 85 процентов до двух-трех это связано со сложностью опять же предметной области и сложностью расчетов для разного регионов разных городов и так далее что еще можно лакировать приведем один из дашбордов а вернее его срезы левый столбец начинаем с лева направо 1 эта память 2 это нагрузкам cybus 3 время ответа 4 количество запросов здесь разрез выбран 6 часов мы видим что пик означает у нас большие worker и весть по 2 giga ii когда мы рестарте мся у нас память освобождается но потом быстро забирается системой и вводится в эксплуатацию есть либо виде небольшой рост как у нас наполняются каши с мой второй график это нагрузка на циpкa она растет примерно так же как и нагрузка по количество запросов день и как вы видите график по времени ответа он колеблется но не сара не соответствует нагрузке дневной скорее с ответом и что к нам приходит боты нас скачивают второй график то тот же самый график но в другом разрезе уже 10 дней здесь мы видим небольшой прирост памяти по потреблению памяти нагрузка поцелуй не изменяется это пила показывает лишь дневной ведь начинаю колебания опять же время ответа стандартная и кольцо запросов тоже не меняется следующий график это три месяца здесь мы видим сильный рост по памяти что это значит мы выкатили какой-то функционал и он начинает либо потреблять больше памяти либо у нас приехали новые данные с которым начинаем работать и мы это видим на графике в 3 часовом даже десятидневным мы этого не увидели надо смотреть всегда в разных разрезах и логировать больше больше мониторить больше чувствуйте жить своей системой второй график по нагрузке на циpкa это мы видим такое ступеньку вниз и та же самая ступенька видно на количестве запросов нам дали просто больше машин у нас нагрузку пола и нам стало полегче что в цифрах 55 сейчас проект живет на 55 и virtual koch это 600 leader tiro поэт терабайт оперативной памяти каждый worker весит 2 giga время подъема почти 200 секунд питон 2 и 7 и 47 процентов code coverage средний по больнице опять же 23 миллион запросы в день 8 целых восемь десятых секунды вот как раз начинаются интересные показатели сорок три варианта заказа до просчета кто читал эванс она великолепно помнить у него есть такое понятие как задание на доставку плохо читали вот это показатель который человек заходит на сайт ему предлагается разные варианты вы можете купить в этом магазине и оплатить наличными купить в том но оплатить только банковской картой вот этот показатель до просчета нам еще не знаем что можем и доставить заказ или не можем следующий показатель 161 это количество ошибок мы попытались привести к вот эти заказывал мы наткнулись такое количество раз на невозможность проехать дальше сдвинуться и так далее и финальный вариант это 21 заказ вариант заказа которым уже предоставляем пользователям которые на сайте уже могут заку оформить заказ которыми точно выполним для москвы совсем другие данные это порядка 300 тысяч запросов в день среднее время ответа уже выросла она составляет 2,4 секунды количество вариантов до проезда составляет 800 выросла в 20 раз количество ошибок уже 3000 также выросла значительно и количество вариантов предоставляемых клиенту он тоже вырос финальных выросла опять же в 20 раз до почти 400 видим различия подумали посмотрели где тормозим что тормозим двигаемся начинаем профилировать профилируют надо всегда все и не задумываясь потому что бывают так вот последний момент с которыми случайно обнаружили это у нас было порядка миллиона операций сравнения по профилирующим нашли кусок где вместо сета используется список использовать просто изменив по одну строчку из начав использовать set мы вообще не проиграли по скорости выиграли по скорости и уменьшили количество операций сравнении с полутора миллионов до 500 тысяч одна строчка маленькая профилируйте на что обращать внимание на скорость на время выполнения и на количество запросов на коне запросов и можно подняться выше посмотреть можно их уменьшить тестирование ттд это хорошо но что что делать если нет тестов совсем нет хорошо поднимаем двойные нас в черной коробке начинаем послать запрос сначала 1 потом на другой и сравнивать ответы возможны два варианта либо у нас ответы расходятся потому что мы внедрили новый функционал либо мы по коробке поломали старый просто нативно но не забываем тестостерона писать надо и чем больше тем лучше кате не собираешься у нас все просто битла плюс докер вот сидит наша команда если хотите обращайтесь к нему они уже купер найтись настраивает все остальное правда не в нашей компании у нас высокая внешней внутренняя связанность доходило до того что мы не только читали из чужих баз данных написали туда что-то меняли понижаем связанность максимально облегчить жизнь и вам и соседям точки входа опять же был очень много точек входа с хлопнули в одно внедрили хилди нам это помогло тем кому не помогает граф коль скоро здесь будет доклад не помню в какой аудитория не забывайте когда пишете методы вспомните приду потребности коммутативности то поможет дальнейшему избежать большого количества проблем хорошо мы проделали подготовительную работу прошли некоторые шаги уже имеем никакой пацаны системы и и нагрузки что же отправляемся путь мы погрузили вещи в багаж садимся в кресло и что мы делаем самолете смотрите мы читаем и перестать я который нам попалась эта статья лингвиста фредерик и сосюра о основы семян семиология не помню на простите что мы из него вынесли то что фредрик занимался разбором текстов и информация хранить хранящейся в ней это что информация передается между нами образами и чем чем понятнее чем у образ и нам известнее тем мы становимся во время коммуникации и дальнейшее общение более активными и производительными есть еще некоторые моментах которые хотел бы дополнить эту тему давайте проведем небольшой эксперимент сейчас на экране будут вопросы у нас тут клуб анонимных разработчиков так что с места громко называете ничего не бойтесь можно даже покричать на каждый вопрос дается по пять секунд они легкие почти все вам этого хватит готовы поехали верно следующий вопрос верно следующий вопрос верно следующий вопрос формулы хороший вариант ответа дающий 5 секунд в сложная форма хорошо да это статическое дифференциальное уравнение потеребить осталось чуть-чуть сколько будет верно сколько будет 29 верно о чем нам это говорит о том что нам легко том что мы знаем и помним и сложно того что мы возможно знали интеграл большинство еще решали в институте возвышение такие но точно решали но мы забыли для суда становится сложным и второе даже цепочкой небольших и простых операций для нас уже у нас уже вызывает сложность хочется вспомнить словам а канала который говорит следующее что основным техническим противным основным техническим братьям разработки программного изучения является управление сложностью вот эти два простых правила вот прям от совсем простых они помогут начинающим в разработке и сделать их код более чище чтобы человек большое прошедшие после них на проект не вспоминал их плохим словом мы на школе продолжается и следующий татьяна которую мы наткнулись это почти тканые плотины ну tranzaxis принц transaction скрипт всем знакам у нас 1point написали функционал все хорошо привет сторон подпишем еще один функционал но вроде тоже неплохо 10 in point of fun полученная пересекаться изменения которые хочет бизнес затрагивать тоже 5-7 а то и все эти in point и тяжело сложно долго дорого хорошо прочли пранк транзак скрипт дальше следующий статья это домой drops design эванс придумал подход основанный на едином языке это одна из основных концепций данного подхода о чем нам говорит то что это гис общий язык между экспертами и разработчиками это меня единый язык и the next язык экспертов и не язык отдельно разработчиков единой следующей концепции это ограниченный контекст этот тот контекст котором живет этот язык если здесь есть разработчик 1с и сапата в 1с у нас есть склады а в сапе есть склады но складываете всего лишь часть завода и на самом деле соотношение чуть другое и название другие и понятия и общение и работы с этим вещами становится другой предметная область это то в чем работаем то что мы моделируем объекты сущность объекта значения эти концепции упрощают нам работу работу он также в интернет такое понятие как сервисные спецификации агрегаты интересный момент многие из агрегатов делают такие большие сущности хотя задумывался он скорее как грани границы транзакционные границы чтобы вот именно вот такое состояние систем она была вот консистентными вот вздумайте когда проектировать агрегат думайте об инцидентности системы вернемся к единому языку вот пример как приходит задача от логиста к двум программистом 2 задача 1 задача выходит иному программисту у него в ходе получается один диалект вторая задача приходят к другому программисты у него получается другой диалект и даже задачи пришедший одного человека в коде будет выглядеть абсолютно по разному что нам позволяет ddd ddd делает следующее он объединяет язык и диалект он мучается совмещенный диалект программисты и логиста что ещё хотел сказать ddd это то что делал эванс но устанавливать структуру структуру программном обеспечении а что такое структура структуры это набор правил в нашем случае ограничений и когда мы сейчас одну минутку структура это набор ограничений и если вы попробуйте сами придумать ограничения и посмотреть какую красоту kuduro из этого получится это будет очень плохим ментальным упражнением здоровье вас теории закончилась наш самолет приземлился и мы приходим к новой части как в самом путешествии попробуем на низких пример посмотреть как нашем ограниченном контексте появлялись образовывались некой абстракции и как велась разработка немножко напомню проекте проект у нас логистический и одним из потребителей его является сайте снова ставит выглядеть примерно так какой функционал реализует данный проект на сайте вот он отвечает за отрисовкой кнопки кнопки купить показывает сроки доставки возможным и агрегированном формацию на следующей странице он показывает какой магазин в какое время когда доступен резерв или доставка опять же отрез возможно возможно и купить эту вещь на следующем чекайте он показывает опять же срок доставки тип доставки более подробную информацию о сроках доставки интервалах все хорошо но начинаются проблемы бизнес настроил за внес настройки прибегает и говорит что у нас ничего не работает ничего не меняется что делать окей мы спрашиваем что сделали на что должно повлиять понимаю что это один из блоков на сайте и то как мы работаем с этом это вот такой протокол это вот прям простыня из разных значений ну хорошо пошли к сайту узнали как это как что напиться какие значения что отображают поняли в чем проблема примерно возвращаемся к логике разработки смотрим а у нас оказывается менеджеры для того чтобы проверить доставку использовали специальный продукт продукт а де у кого есть такой вот прям специальный для проверки есть да не у многих на поздравляю всех остальных у вас еще все впереди и поняли что это вообще отдельный вид это что если они проверяют этот продукт доставка основной корзин вообще может быть невозможно мы продукт один едет вся москва не отгружается окей начали менять подумали что это значит для бизнеса это значит то что они предоставляют должны проверять что-то мы предложили вызвать найдите какой-то стандартный продукт на котором вы будете это проверять они нашли оказалось кнопочной нокии которая распространена на какой на которой на каких ограничений и все они были рады но следующий момент был на этот intent уже завязался сайт и он показывал агрегируются мацию где-то в блоке посмотрели подумали на предыдущих шагах мы начали тестировать у нас появились некоторые мог объекты в один из таких это был объект который моделирует онлайн остатки и андреева очень просто возвращается достатке в нужных точках сто сто штук мы подумали что подключим как объект nokia продукт nokia и этот этот класс и объект для работы с этим and point у нас получилось что небольшими изменениями мы решили две проблемы и в бачу очень сильно почистили код это лишь вступление следующая у нас была проблема с арендует равном 1 но это другая история вовлеклись поправили посмотрели начали понимать что такое предметной области как не работать следующий пример у нас были проблемы со скоростью ну как мы движемся в сторону ddd и посмотрели почитали есть плотин репозитории хорошо посмотрели что у нас базы данных тормозит создали объект взяли объект и готовы у нас django кстати взяли готовые объекты джунгли запихнули их в репозитории смотрим у нас worker вырос до 4 гигов и не останавливается блин что делать подумали вспомни опять что джанкойские объекты тут же но решение принцип единственной ответственности создали свои объекты запихнули их в опять же в репозитории посмотрели выяснили что кейм укладывается 2 гигабайта и django объекты оказывается в весит 3 раза больше чем обычные питоновские переписали орган репозитории на нашу область позволяет потому что изменение у нас не так часто происходит и мы можем просто наметить репозитория следующий пример нужно было менять но в новый функционал по ограничению доставки от разных поставщиков окей ну и посмотреть заодно как все работает открываем наш and punch и заметили следующую картину что у нас информация по датам дублируется притом дублируется неоднократно 11 раз она дублируется в одном inpointer хорошо посмотрели дальше у нас еще информация по оплатам дублируется и притом в эта структура была сделана скорее для верстальщиков чтобы удобно было отображать информацию на сайте но на эту структуру потом завязались и контрагенты и поставщике очень тяжело начали здоров вопросы думали сначала как и изменить структуру а потом чуть чуть поднялись повыше и спросили у бизнеса а куда дальше идет эта информация что с ней происходит выяснилось что на основе неё формируется заказ и вот она бинга фактически это прорыв был по эвансу но когда задача обрела смысл она стала из набор разрозненных данных которые здесь получаем время здесь получаем оплаты здесь еще что то мы получили обувь финальный образ это вариант заказа который мы можем исполнить который клиент может создать окей переделали получилось намного более простая структура список из вариантов заказов начали полезли в код все хорошо но реальность нас вернула на место у нас вот тут кай поплыл простыня она не заканчивается полторы тысячи строк 1 метр вот все в таком духе как можно визуально это выразить визуально это выглядело примерно так берем одну структуру перегоняем данные в другую потом формируем еще пара структур перегоняем еще какие данные делаем какие-то процедуры вы в одном монтэйн в одном выходе мы получаем время в другом элементы в третьем интервалы и так далее но у нас задача доставки хорошо задача доставки это построить маршрут выделили отдельный блок постройки маршрута сделали разные виды транспорта разной политики движения затем ввели такую конструкцию как билеты все же летают на самолетах и все puma когда выбирают перелет открывают какой in skyscanner еще что-то и выбирают он нужно себе билет вот мы в одном лишь такая абстракция она поможет любому другому разработчику который будет погружаться наш проект быстрее вникнуть быстрее понять что делать следующее что мы сделали это ограничение мы говорим что вот этими билетами летаю только люди этими холодильнике и этим еще кто-то ok но задача была в итоге получилось угловатый почему мы обрадовались и увидели что вот наши предыдущей задаче это вот как раз задач авансцена с заданием на доставку и с грузами мы делали но вот здесь что то было не так здесь угловато здесь какой-то хак применили ну и как бы до нас дошло что это не наша задача нас на что задач другая у авансы на груз отправляется с одного склада на друга и у него была одна . направления 1 . прибытия а у нас-то склады нам нужно выбирать товар сразу и складов и предоставлять еще разную информацию с этих складов и мы выделили отдельную задачу пошли бизнесу поговорили с ними услышали такие конструкции как точка сборки . снабжения пообщаешься дальше мы поняли и выделили отдельно блок который отвечает за снабжение и выбирает нужные склады отдельно блок доставки который очищает перемещение отдельно блок выдачи товаров клиента потому что это тоже получился отдельный блок как это выглядело в коде наше задание на заставку оно расширится квантами параметрами это точки доноре точки снабжения и точки выдачи все стало хорошо кот стал более структурированным более понятным у нас выделен очень выделяться задачи но время ответа сильно выросла что делать у нас большой блок мега юнит но у нас есть разные разные задания на доставку им подумать над их как-то распилить но у нас гил питон надо по процессорам поняли что на одной машине не не уместимся и решили раскидывать по сети написали небольшой прокси выделили юниты и начали задействуй попробуй через прокси все хорошо но посчитали посмотрели выполнялся раньше 10 секунд запрос сейчас выполняется 20 секунд но суммарно вспомнили что каждый юнит оказывается у нас входит еще и в онлайн истоки окей а почему а почему бы нам не ходить в прокси в онлайн стойки и подменять остатки и добавлять остатки запрос юнитам чтобы они уже сами не ходили и не так не делали применили к итогам мы сохранили время работы снизить нагрузку с онлайн столько в 5 раз и и что-то еще следующим этапом мы у нас было время вы равнялась но возникали иногда пики и у нас 15 секунд 10 секунд ответ выл от сервиса посмотрели тому были следующие причины гил простите сборщик мусора он оказывается на хиппи в других до отработает две-три секунды далее у нас варки стартует 120 секунд каждый из юнитов при перезагрузке при обновлении данных он стартует сто девяносто секунд сетевые лаги когда один прокси распиливать на 30 запросов на 50 под запросов и потом собирает этот когда какой-то из-за один из маркеров он точно не отвечает и мы попадаем вот на этой тайм-аут и хорошо мы внедрили политику retrieve 1 политика была простой если ответ не пришел через две секунды через секунду делаем еще повтор если через три секунды то еще повтор все бы хорошо но в пиковые моменты у нас игры момент мы положили систему таким образом минут на 20 25 что произошло у нас нагрузка выросла у нас все варки лепи сталью успевать отвечать a proxy там быстрые лёгкие стартует быстрее запросы управляет быстро у нас нагрузка просто скакнул в три раза плохо что делать добавили в ретро им еще политику перри запросов но не всех а там сначала пачечку в два запроса по три потом еще один если через три секунды не успели прийти сейчас финальная система наш выглядит примерно так на 99 процентов показатели 1 и 3 секунды выявлен на основе логов и статистике посмотрели сколько запросов укладывается в определенное время и соответственных выставили каким можем делать выводы ddd позволил нам вести такие ограничения в соответствии с которыми наша предметная область и сложность ее и понимание и она сократилась стало проще стало легче расширять у нас появилась мы даже сами стали предлагать бизнесу что мы можем сделать вот так вот можем выбрать более дешевый склад в этом запросе либо выбрать более быструю доставку и так далее спасибо эвансу ну за это обязательно смотрите на всю картину целиком если мы не смогли бы подняться чуть выше и не посмотреть на проект с точки зрения вот когда мы разработали прокси и раскидали нагрузку мы бы долго бы пилили бы наращивали мощности у нас бы вряд ли что-то произошло внятно и используйте только знакомые абстракции конструкции это упростит вам жизнь и вашим коллегам не забывайте что лишь 95 процентов времени мы пишем код или читаем код и лишь пять процентов опишем и и как говорит moccona у пишите на языке с используем языка понял эту фразу вот знаю ее но вот сейчас вылетела не поверить бизнес-процессы погружайтесь них интересуетесь это принесет вам большую пользу и облегчить проекты вашу жизнь да и конечно т.д. обязательно тесты обязательно много юнит изолированный интеграционный все это позволит менять модель в те моменты когда вам это удобно они когда надо вам вы сможете спокойно спать но чего у вас выход к будет тесты прошли все хорошо вас vista верстальщик сможет выкатить проект не еще не случится настоящее время уложился чуть быстрее небольшой блог про матрицы мы хотим переношу перемножать моя матрица больших размеров зачем нам это надо любую систему можно представить как вектор состояния и мы у нас есть идея что мы можем изменять это виктор состояния простыми предложениями чем мы хотим добиться мы хотим добиться того чтобы вы нашли с кем работал быстро и шестистах ядрах онлайн на 10 на 20 и нам кажется что матрица нам в этом помогут к примеру здесь приведён пример о том что у нас есть допустим тип доставки и тип оплаты мы делаем матрицу решений что при пересечении прилавки предоставил к плоту нас будет один при отсутствии разрешения там будет 0 и взяв несколько ребер и эти матрицы на каждому из ребер и помещения складывая их мы можем сразу ответить что да вот здесь у нас такая возможность проезда разрешено а такая нет но возникает вопрос а что делать с расписаниями здесь более сложный момент мы создаем постоянно создаём бег разрешающий вектора создаем матрицу перемещения который изменяет состояние этого этого века позволит изменить состояние этого вектора и в дальнейшем получить финальный результат но эта работа еще не доделана это не вроде и если кто-то из вас решит этим заняться мы будем только рады какие у нас планы мы наши прямые руки и питон с гилом не дают ту производились который бы нам хотели мы хотим голову проект растет компания растет это вот сто сорок семь процентов и нам нужно тоже расти думаю перемножать матрицы это вот та что была предыдущая иногда думай себе тони но времени на это нету поэтому очень мало думаем хотим 99 процентов покрытие кода тестами это позволит нам спать спокойно жить долго и счастливо возможно когда станем ума зонам и все предыдущие шаги нам в этом помогут а возможно убером но убером непростым а для грузовиков со сложной бизнес-логики со сложным предметной областью и так далее хочу спасать хочу сказать спасибо нашей команде которая принимала участие и оставив каждый из них оставил кусочек себя в этом проекте часть из них сидят здесь ребят спасибо но это не конец у меня к вам последний вопрос вы любите путешествовать вот и я тоже очень люблю и для меня путешествие это я люблю посещать новые страны города общаться с другими людьми ужас в другую культуру возможно пробовать другую еду ddd и вот весь такой подход он способствует тому чтобы наши пути мы путешествовали чаще мы изучали новые области наш мир он огромен и мы с учетом этого не будем скучать и притом возвращается с каждых учись в путешествие не на щите о со щитом и но путешествует лучше всегда ни одного в хорошей компании так что если есть желающие приглашаю к нам вы теперь всё спасибо с раз ура а теперь у вас есть возможность задать какие-либо вопросы а я уже вижу поднятой руки подождите пожалуйста пока я дойду до вас и до мой микрофон руки поделитесь раз пожалуйста добрый день меня зовут юлия у меня такой вопрос вот вы дели внедряли ddd на основе уже существующего проекта и собственно говоря переписывали просто кот выделяя в нем контекст и юниты это у вас контекст и так я поняла нет unitaid у нас рабочая сервера рабочей станции которую чем из доклада не очень понятно было но я думаю что вы контексте там все равно выделяли какие-то у нас один контекстом вот проект это один коллекторе контекста для контекста не выделяли вот это проект это как раз является одним ограниченным контекстом хорошо вот возникает другой вопрос просто когда переписываешь систему на ддт выделяешь контекст и остается очень сильная связанность по данным то есть у нас вот например одна большая база данных и у нас сейчас нет времени чтобы как-то разделить ее про мигрировать данные в другие базы да как-то ну то есть получается код он такой более-менее независимые друг от друга стал а связанность по данным она осталась и могут пока не знаем как что с этим делать я понимаю вас монолит да у нас монолит который мы немножко реструктуризировать и в соответствии с д д д то есть мы выделили контекст и вели event гривен архитектуру чуть-чуть secure с ну в общем то так все что-то по верхам вот а проблема с разделением именно данных мы пока не можем решить а почему для вас проблемы у вас наконец-то не все же согласованность вам наоборот хорошо если у вас нет нагрузки никакой лишней используйте пользуйтесь этим возможно да просто хотелось услышать другие решения у нас отдельная база под каждый проект вот у нас есть такой проект бы у него своя база у нас мы используем москве в репликации мастер слышь ну просто это вносит определенную зависимость если допустим человек работает над одним контекстном на 1 фичей он дорогие ту же самую базу данных что и другой человек в это время может спасибо можем чуть подробнее поговорить дверями раз привет меня зовут стас у меня такой вопрос контекст домен на власть вас выглядит достаточно сложной вы вот в этом проекте на сколько долго ддт внедряли я на проекте чуть меньше пяти лет и мы продолжаем внедрять но не только на этом проекте ищем других смысле от все пять лет вы внедрили растет она мы и я понимаю я имею ввиду что когда вы пришли там уже было ddd или вот с момента к его начали внедрять до какого-то момента к все вы кристаллизовалась его у вас уже сколько времени хорошо и есть какое-то представление ну давай так сам подход ddd нам говорит о том что мы развиваемся вместе с проектом костюме с проектом это не не ограничены то есть сам поток говорит нам что такого онлайн или рамок нет основные концепции у нас появились такая как вариант заказа вариант заказа появился спустя три месяца спецификации на заказ у нас появились в первом приближении через шесть-семь месяцев финальная ну вот так где-то и еще вопрос в принципе ddd для тех людей кто с ним не сталкивался на мой взгляд это но достаточно высокий порог вхождения не сталкивались ли вы с проблемой внедрение вот в эту систему новых людей когда там человек приходит видит что вы ddd вот это вот все агрегаты проще бритвы что ты ерунду какую-то напридумали и если сталкивались то как вы с этим боролись сам подход говорит о том нам что это наворот проще когда ты видишь структуру ли метод x y z и когда ты видишь метод получения списания остатков с одного склада или переместить этот склад товар со склада на другой тебе проще входить я понял вопрос да наверно есть особенно вот как раз понятие с агрегатами очень сложно внедрять очень сложно понимать традиционную целостность сложно разработана да есть есть сложности как мы с этим боремся за димы бизнес разработчики садимся перед доской картинки кстати настоящее и рисуем рисуем обсуждаем рисуем обсуждаем и вот дальше уже уходим первое с чем лучше начать пускай но в разработчики начнет писать тест он напишет тест он бы вы поймете что в нужном направлении движется и смотрите за ним смотрите куда движутся по себе review и сейчас у нас осталось время на последний вопрос все желающие с вопросами смогут после подойти в дискуссионных зоне так привет меня зовут denis спасибо за доклад интересно послушать в принципе вопрос очень похож на предыдущий коллега который задавал я много раз столкнулся с тем что даже не то чтобы сложно найти людей там ввести в курс дела достаточно сложно порой договориться командире в командах разработчиков о каких-то единых терминологии их уже в имитации снова д-д-д-да что все прекрасно понимали слоям все это раскладывать и так далее то есть если можно например договориться с бизнесом понять какую-то единую модель то есть попробовать донести ее там до кода это как бы ну складывается там вот как бы заставить всех разработчиков мыслить в одном направлении так как это имплементировать именно вот есть какие-то советы вы говорите больше говорите вот загнали за это мы говорим о все равно то есть ты смотришь поможет поговорить рассказать и говорят все понятно классно смотришь paulig вас какой-нибудь там человек как-то по-своему все это представлять как синхронизировать как найти . синхронизации вот уже ошибка когда это смотришь pull request ты смотришь финальную задачу начните с теста он напишет тест вот просто вот без кода без все просто тест он и вы уже поймете так не так уже сигнатуре метров будут известны вот анапе пункта квест уже поздно это уже вот последний этап когда вы смотрим либо жопы любишь как есть простить спасибо а теперь у меня для вас небольшая задача этим вы словам были заданы три вопроса и у ваша задача выбрать тот вопрос котором больше понравился ну вопрос наверное не очень но мне всегда жалко жалко людей с большим монолитом так что вот соответственно поздравляю у нас традиция на конференциях каждый доклад лучше вопрос получать небольшой презент"
}