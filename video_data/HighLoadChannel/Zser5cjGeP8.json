{
  "video_id": "Zser5cjGeP8",
  "channel": "HighLoadChannel",
  "title": "Успешный кейс использования React Native в продакшне / Евгений Федоров (LOOKBUCK)",
  "views": 1221,
  "duration": 1627,
  "published": "2017-06-02T00:40:23-07:00",
  "text": "там привет меня зовут евгений фёдоров я расскажу вам про успешный опыт использования рек не тиф продакшене пара слов себе я технический директор в лоб баг это маленькая компания стартап где в общем агрегатор одежды marketplace одежды мода и все такого познакомимся с рик мотив сравним экраны нас типичный констебль view нам же идти в сен-мари отметив по реализации реализуют часть приложения на примере нашего приложения губок расскажу про поддержку приложение при дебаггинга протезы которые там есть про тестирование про возможности rect на ограничение его и про портирование на android там все тоже хорошо когда вы поняли что нужно делать говорят приложения у нас было несколько вариантов но как у всех это нативные приложения писать нам жикси свифт и java для android условно нативные to react нити в заморин заморин это на технологиях dot net with узких framework рубим а уж на это на ruby или бью но это совсем все там плохо во первых тормозят приложения до 60 фпс не дотягивают в общем все плохо нам react не те кто не пробовал общей отметив в зале понятно ну практически никто не поля не пользовался то есть пять процентов и оказалось ну вообщем рик не typhoon work которая позволяет делать нативные приложения для android для ios с помощью скрипта react философия такая что нужно изучить технологию единожды и писать на всех платформах даже время примерно все так же так как люди не очень знакомы тогда расскажу то что нужно для начала что про чтобы начать на реакции все это писать на рек нити потребуется но до рик нити fly как это командная утилитка которая позволит генерировать проект xcode это для запуска симулятора на ios android studio для android так dpd каиды это разработчики сделали сторонние разработчики сделали такую прикольную indien для реактора в общем похоже немного на их скот только вместо реборда из компонентов можно кидать прямо в год компоненты все прекрасно работает когда мы запускаем реактив ну точнее чтобы запустить рик на этих и начать на нем работать нужно генерировать приложение у нас получится вот такая структура два файла индекс android же с это 2 можно сказать в точке входа для приложения ios и android соответственно и из командной строки нужно просто запустить эту команду запустится вместе например если мы запускаем бранное os x код запустится храм с вкладкой для дебаггинга автоматом для дебаггинга анджея skoda и в принципе все и можно будет сразу же писать приложения мы выбирали между двумя технологиями то писать полностью нативное приложение или все-таки наряд не tiff ну попробуй просто для теста написать типичный кран приложение которое получает жетон данные рэнд spinner пока джейсон в плен денги и render wk получили тот же сон но такое предложение примерно примитивная попробуйте написать на одном языке и нарек на этих в общем на джеки все было для нас сложно потому что мы же сам знакомы объекте для нас новый язык и он очень получилось объемные много лишнего кода ну потому что лишь не в плане того что можно был дефолт на этом вещи использовать науки в общем наглядно сразу видно что что рик найти это все делается проще это функция вещь которая этом и скрипт 2015 получается джейсона синхронно с релизе релизе руется джейсон и записывается стоит компонента это render render спиннера или индикатор загрузки тоже на мужик в силу много лишнего кода получается were quite намного все проще и еще смысл этого всего то что вы отметили это все будет работать и на android и на ios и android эссе он такой же большой и только для ios а ну то есть объемный код много возможностям не ошибиться и все такое и отметив есть джейс x это похоже язык html но расширенный xml джейсон xml общем смешаны это он позволяет декларативно описывать юлай его плюс это в наглядности то есть можно сразу окинуть взглядом код понять и что где какой компоненты где находится все в принципе понятно в волосин там все импорте императивно и в коде нужно глубоко копаться чтобы понять ну то есть нужно точно запускать чтоб понять счетом вообще будет так дальше мы разработаем сейчас вот первый экран список товаров и я расскажу поподробнее про реализацию как это все работает так вначале мы сделаем табор это самый главный можно навигационный компонентом поясе стандартный то есть мы в яндекса yes просто пишем в конструкторе устанавливаем дефолтное значение таба то есть у нас будет одежда там первое это fit где могут отображаться и в рендере просто объявляем декларативно табор это встроенный компонент варяг нити в общем в нем-то мы назначаем цвет 3 таба и в каждом тоби внутрь вставляем еще компонент который будет отображать но активный этап здесь например tsp три теста джесс текстом одежда дальше реализуемый шин бо ры то вверху стандартный компонент ойоса тоже которые отвечают за свайп назад и занимая но содержится анимацию и проще короче вещи так в таборе в вот на предыдущем сладить товара этом мы теперь записываем с тесты странице фильм fps и фитнес пишем в рендере используем этот навигатор в навигатор сейчас отображает fit php сейчас пустой поэтому белый экран там в опции передается параметр на заголовок и можно передать всю левую кнопку правую в общем кастомизировать и по-разному scrollable tips это такое не стандартные компоненты которые много сейчас где используется и в инстаграме повсюду в общем это когда сциллой по можно переключаться потом и кликовые этапом по нему это тоже делается просто но это сторонник оппонент которая изредка бы берется и в общем он просто импортируется тоже легко реализуется в рендере вставляется и указывается дв в уфе но не 2 можно 34 делать в качестве контента этих тапов а сами-то бы можно тоже кастомизировать можно менять анимацию можно цвета менять как угодно в общем то же в принципе все несложные просто получается так дальше реализуем список товаров это здесь в три шага расскажу то есть сначала нужно получить джейсон но это тоже мы уже видели ничего сложно получаем зависимость от табака популярный jison но популярный товар новинки записываем их стоит компонента в этом с впрочем все дальше рендерим объявляем рендер и зависимость от заказ окружена не загружена показываем spinner если загружено the grid view которая собственными там с нужными в общем рисует этот grid view так ну можно еще рассказать про он скролла там в scroll иван throttle это для того это функция для pagination снова используется чтобы инфинитив скролла реализовать все такое так рэнда райтом там был это сейчас вот реализации этого рендер здесь тоже все просто ты че было посетит at&t который позволяет навесить слушателя на толщина типы насвай потом вот здесь обработает стаб который будет детали показывать этого товара так вот в принципе эта функция шева этом detail которая по в навигатор пробрасываем видюху которое отображает ты рисуем детали этого товара принципе все просто получилось там за 10 минут буквально получился такой экран так выглядит объявление анимации то ты к ним и это там и мышью там как угодно можно использовать и где указывается начальное состояние этого компонента и потом в коде уже пока не выйти можно на любую на любое действие можно навешивать эту анимацию можно привязывать ее это анимация которая ну точнее функций interpolate которая позволяет принимать на вход одни значения интерполируются в другие для анимации они также будут плавно плавно изменяться и вот здесь лев например вот этой полоски пробрасывать в стиле потом и она там плавно переключается так инструменты холст ик атон в общем если вы ошиблись где-то из там любая ошибка возникает в runtime это в симуляторе в android ios показывает сразу сокол стек по которым можно в любом в любое место пнуть и попасть но откроется ваш редактор с с этим местом предпримет доступны через chrome devtools этот chrome devtools открывается автоматом когда мы запускаем приложение и можно указывать ну сторибрук point и смотреть что там происходит где ошибки там ну и все такое в общем как и везде вот такие инструменты есть так performance monitor от а вот такой топ с данными о в системе сколько приложения потреблять оперативной памяти сколько джесси также с java script core сколько java скриптов потребляет и в ухе это первое число это видимое в ухе и сколько всего за грош наверх делает fps такси пил профайлер это можно делать profile любых ваших действий например посмотрим там на scroll то есть если у вас есть какие-то сложные участки кода их можно повесить посмотреть свою что сколько потребляет и и увидеть все данные по нему сколько процентов отжирает это все дело и сколько времени занимает выполнение эти функции инспектор это тоже маленькая туда для для взаимодействия с дизайнерами например дизайнер хочет именно 8 пикселей поединка на карточке мы проверяем все нормально все хорошо там или какие-то ошибки можно показать что все нормально или брелок тоже маленькая такая штука которая позволяет при редактировании кода автоматом его перезагружать и показывать актуальные на данный момент но точный результат так тестирование ну как везде юнит-тесты доступно но можно тестировать и не тестами традиционные тесты snapshot тесты in тестирования через жесты рекомендуют фейсбук тоже и звучная либо которое содержится ну позволяет локоть assert короче как видите в общем интеграционное тестирование то на cucumber и колбас можно делать также интеграционной стерн доступна в xcode начиная 7 версии для ios a snapshot то же самое в celine это андрогинной оси может делать и микс коде через встроенный и и услуг сходе говорит нити в классные сообщество очень много людей сейчас там все это комитеты поддерживают он добавлять новые компоненты например вот и окна этих give me messenger это полностью готова компонент которым нативно реализует там чат и все такое то есть как как массажер боюсь а так и ограничение это минимальный требник как операционной системой ios начинается седьмой android 4 1 ук оппонентов есть свойство специфичные тоже не иногда неудобно например вот для ios есть у ему лежал ангер обработчик вот для android это недоступно пока что также есть целые компоненты которые только работают в одной системы например в нашем примере был навигатор район который работает только в навигаторе но кстати есть навигатор кроссплатформенное его можно использовать только там анимация боюсь быть немного немного наверно заторможено но это не так будет видно я думаю так и 4 минус это то что если в вас будет в приложении какой-то супер кастомный компонент и он нужен будет эвандро детей для nes нужно будет писать им бы решить самому а это там на самом деле очень не тривиальный код но хотя можно это все делать в принципе бонус это когда вы написали из приложения rip мотиве то как ми 8 процентов кода для android уже будет ваза готова например в нашем приложении получилось что нужно было заменить только там barausse которому использовали на там born для android не продвигает я уже говорил то что есть принципе компонент кроссплатформенных которым можем ваза использовать и тогда не нужно было бы снять так с ним и остальное остается без изменения то есть вот этот компонент которая фильм fps вложенными верхами он абсолютно работает и томатом так это мелкие штуки которые он импорта то если можно сделать несколько индекс поджав и они будут загружаться для android там с одним файлом на есть другим это специфично платформа код чтобы можно было тоже написать в одном файле использовать модуль платформу и определять на какой сейчас год за к платформе запущен там навесили на андроиде также для android актуальная цена ti версия приложения потому что очень много версии там для них нужно одно что-то написать для дорогим другое тоже доступно условия где можно проверить какая версия сейчас андроиде запущены где запущено приложение можно использовать общие джаза библиотеки frontend разработчиков на мир момент же с это для форматирования даты очень популярная библиотека андерс к ворота для использования всяких операторов в функциональных для использования мы при дисфункции и реджис это для работы с много трехкомпонентных работы с рунами и так в итоге мы используя рик мотив получили готовы нативное приложение за одну неделю за 2 недели уже был доступно в appstore и сэкономили много рублей на то чтобы поддерживать и платить зарплату программистом вот спасибо за внимание спасибо за доклад от архитектурно когда вы писали приложения это был какой-то висели в там флаг среда x который популярен мог стать мы писали вообще очень на скорую руку и будем делать все таки на флаг со всем дела сейчас использовали архитектурно то есть через диспетчера ну может сказать костыль ным способом самом деле мы будем делать на флексе автора вопроса там получается же когда приложения реакции на эти танки это фиксы можно мимо пс ну то есть без проверки appstore кита кидай давайте пользуясь не понял нет ну да это так же можно просто jason hawkes новый конце сексом кинуть там снова разметка или еще что-нибудь но к совету я не не пробовал делать но и в принципе у нас только джейсон и и apes киноман даю только данные только из их менять но это я понял то что можно в джейсоне получается прямо отдавать для рендера какие-то прям компоненты что лежат отдать ну я до такого не додумался спасибо спасибо очень интересно хотел спросить а за неделю это сколько разработчиков один огун да спасибо за интересный доклад а вот у вас там что-то типа таблиц или коллекция view был которые но скроется я хотел спросить там вьюки они перри используются или просто инициализируется подряд и хранятся в дети вниз скролить но infinite scroll он использует те же видите то есть мы распределили написали рынды райтом и он будет использовать их как внутри это все реализовано это можно посмотреть доклад есть отдельно там на час чувак вот из фейсбука реактор рассказывает как они сделали так чтобы там переиспользовать но это именно уже такой прям архитектурные то вещи рассказывает как они там как вот этот gsx который теги обозначают как они их там переводит для нативных компонентов все такое ну то есть из другого этой ячейки не теперь и используется но скорее сюда понятно я просто глубоко так сильно прямо в реализацию нарёк нити в каком там все делает не углублялся к сожалению а там у вас приложение много товаров была на одной странице 72 вообще в прилла в приложении товаров полтора миллиона это только в наличии а там три миллиона примерно хранятся они проводят там прокрутить до 1000 товаров как тоже нормально работать но кстати нормально работает вот есть проблема такая сейчас только установил фабрик чтобы крыши отслеживать потому что реально где-то на на странице но не знаю там на страницах но где-то уже на 20 страниц пример уже падают иногда приложение 20 страниц и это я буду только сейчас справляет вселило ни одна спасибо спасибо за доклад я так понимаю вопрос был опере использование в плане памяти то есть перри используется ли старый инстанция старых ячеек и у меня похожий вопрос там на одном из слайдов была указана потребление памяти 330 метров вот с чем-то рам для простой для простого экрана вот коллекции такой это выглядит очень очень много на самом деле и насоса вопрос с чем это связано и можно ли это как то лечить то есть является ли это недостатком каких-то скажем так ваших разработок или это какой-то недостаток самоваре обновления ну скорее всего это связано с тем что у нас картинки очень не оптимизирована они сейчас где-то шириной 500 пикселей примерных мире солистов 200 и в общем там одна картинка получать что-то около двух мегабайт весит получается когда мы загружаем сразу дофига картинка то есть 72 там две страницы на где 300 мегабайт потреблять то есть там уже одни картинки выжрать нормально памяти то есть там большая часть это вот именно за картинок но в любом случае это можно тоже во-первых про чего как торопим направят на этих рассказывает он говорит что мой это они управляют если есть картинка где-то в невидимом месте находится они там пытаются как-то из памяти выбрать и они тоже постоянно работают над этим то есть они говорили что 2016 году они будут нацелены на оптимизацию на вот таких вещей по памяти и для android еще будут решать проблемы все расти спасибо за доклад есть вопрос касательно специфичных до платформы вещей то есть работа с блютусом с камерой с покупками совсем таким насчет покупок не знаю но можно кстати посмотреть у них в доках там есть все перечисленные пешки то есть с камерой с geass к силе 1 акселерометром все это все есть уже и но в принципе все основные фишки уже поддерживаются и причем давно уже спасибо за доклад такой вопрос от вас много товаров рассматривали такую необходимость как работать в режиме оффлайн и с локальным хранилищем тип потом цикла light и можем это сделать free отметив и если вы знаете то как в рекам этих есть тоже там singstar экшене компонент который в котором можно складывать вот эти к для кэша вещи есть такое в принципе это можно делать но мы этого не реализовывали покажет необходимости не видим привет спасибо за доклад у меня вопрос и так понял ее на теле компонента то есть нанси нам языке не писали для свои приложения мост не делали a'most нет не делали но кстати там есть тоже статья офигенная который рассказывает прямо от начала до конца на примере компонента как сделать нативный компонентом для ios и для android в принципе там не очень на самом деле сложно но нужно и на джиг и писать и мост на java script то есть там описку нужно будет соблюсти их связать и все спасибо и еще вопросик я зашел google play market не нашел приложение для android да потому что мы только начали это все портировать как нас пригласили на конференции у меня все застряла вот и нам вроде сейчас вот буквально через дня три уже будем отправлять спасибо тоже спасибо за доклад буквально вчера мы общались контент разработчикам тоже из rambler поводу того как работает реактив он вот очень сильно жаловался на параллельной анимация то есть вот что если мы запускаем две анимации параллельно и не очень параллельны как с этим жить но задержка объекты движутся относительно друг друга то есть ряд медь и в на самом деле есть функция диане мы там секвенции можно делать заниматься и параллельно анимация мне кажется это именно об этом речь идет когда анимейт параллел там и пошел собственно нативно в приложениях работы с таблицами очень классные то можете ячейки удалять и использовать то что при использовании не работает на самом деле найти вот и все плохо то что касается навигатора переходы между экранами если их будет много так и таскал там картинки мы картинок то эти переходы начинают лагать и это неприятно когда ты разработаешь на смерть этом что ты делаешь экранчике накидываешь да и простейшие запросы на серы получать данные от рисовать в табличках хоть не за 10 экраном сделай бегая между ними все классно здесь не совсем все так но на самом деле а когда-то пробовал этот именно вот эта работа с таблицей с навигатором когда эту тем было опыт но я понял дать месяц назад все изменилось все знала гораздо уже наверное не гораздо лучше там есть проблемы но другие потому что сейчас они точно не тормозят но когда ты например вот с большим списком картинок перемещаешься назад то они получаются фоне перестают рендере ну точнее как сказать в общем исчезают и потом появляются обратный это видишь как они моргают и это неприятно но от armani не не в этом дело не моргания исчезания картины там же все кешируется экраны эти когда ты идешь вперед у тебя появляется новый уходишь назад у тебя предыдущие остается экран мы в общем когда назад нажимаешь вот здесь иногда они просто исчезают но никаких тормозов нету то есть я не понимаю в каком плане можно даже посмотреть на нашем приложении тормозов точно нет но вот именно моргающий картинки они иногда бывают но здесь причем так не но ok ok нарик найти можно писать вообще любые приложения все круто есть кого-нибудь еще вопрос или я задам про каширование уже спрашивали но вот у меня чуть более конкретный вопрос если какие-то обертки непосредственно для работы скоро даты на ios ну пока что я кстати не знаю я только про старше знаю что них а singstar же тут есть и в него все все записываю там какое то есть ограничение по памяти на объекты ну я им толком не пользовался то не могу точно ответить он спасибо всем спасибо"
}