{
  "video_id": "X_T3UgFUsw4",
  "channel": "HighLoadChannel",
  "title": "Честные модули внутри монолита, или Когда Composer не подходит / Александр Кирсанов (ВКонтакте, VK)",
  "views": 902,
  "duration": 2315,
  "published": "2023-10-06T07:19:27-07:00",
  "text": "Я человек простой Я люблю программировать и меня бесит когда мне программировать мешают бесит когда ставят всякие созвоны встречи там синки какие-нибудь да отстаньте вы от меня программирую бесит когда они падают там статика не собираются Почему блин детешники не могут настроить так чтобы просто мой код доезжал до продакшена Но это ладно телефон можно отключить dt-шников можно пнуть или уволить страшнее следующее вот объясню на примере Представьте вы купили дом такой вот маленький домик где-нибудь в лесу воздух свежий там солнце видно из окна на закате веревку веревку бельеву можно повесить между сосенками и вот как-то вы засыпаете просыпайтесь с утра а вокруг Мурена и вроде как вроде как дом дом-то по-прежнему ваш но вот что-то уже не то и воздух уже какой-то не такой свежий как раньше и грядочки уже не переносишь потому что теплотрассу проложили и из окна уже не видно солнце на закате только маршрутки какие-то ходят дети еще по ночам тут как это выглядит в программирование я к примеру пишу какой-то модуль для базы данных я пишу какие-то конечно я считаю что это моё и никто вот не должен туда лезть никто не должен строить многоэтажки вокруг моего кода допустим я говорю что вот у меня есть Используйте его всё остальное моё не лезть туда и вот я как-нибудь просыпаюсь там или в отпуск ухожу ладно Я не ухожу ладно в общем смотрю и смотрю что кто-то Понадобился блин Хотя вроде как постулировал что не нужно это делать А главное Почему в чём проблема в том что я теперь не могу это дело заново изменять на меня уже кто-то положился уже если я что-то там поменяю я нарушу кому-то Продакшен у кого-то что-то отвалится Я не хочу чтобы так было По факту я хочу сделать так чтобы никто не лез Вот мой кот который я считаю своим Никто там не копал грядочки не прокладывал теплотрассу там под моим кодом в реальности у нас в любом большом проекте там как вы каком В принципе в любом большом проекте все значительно хуже вот этих моих колледаптеров и прочего клубок Гигантское количество оно вот так вот всё связано комматичность бесконечности стремится вот так вот всё связано с совокупно нельзя взять какую-то часть ковырять унести куда-то А главное что язык не препятствует тому чтобы мы это дело чтобы наводить порядок короче можно лезть из одной точки кода в другую Ну PHP Просто так устроен поэтому так и получается я по факту что хочу я хочу чтобы у нас в языке были интернет-классы и что-нибудь такое чтобы я мог своей своим движке для базы данных оградить Новый год сказать что сюда не лезть есть только публичный интерфейс по факту Я хочу на самом деле модули Я хочу примерно модули как в других языках они есть много где в гошке в расти много где есть они нужны для изоляции кода модуль Это что такое Это есть какая-то мое пространство я наружу что-то отдаю а внутри делаю что хочу внутри внутренности недоступны даже есть модули Почему фронтендеров есть модули и они могут использовать их в реакте там в своем А вот у нас PHP вот или нет кстати знаете где еще нет модулей вот здесь внезапно вот то что все плюс 20 называется Model это на самом деле не про модульность не про изоляцию кода это про юниты компиляции Чтобы меньше там аж файлов подключать и так далее В общем не про то кстати Раз уж Мы оказались на этом слайде Вы же наверное знаете что у нас ВКонтакте вот так что у нас мы пишем на PHP У нас есть собственный компилятор перегоняет этим компилятором этим языком занимаюсь я лично и моя команда А что это значит Это значит что если я хочу модули я могу подумать так как я бы их сделал так как я их вижу в PHP как бы они были могли бы выглядеть сделать придумать реализовать реализовать компиляторе сказать что у нас появляются модули они есть в кпхп об внедрить к нам заставить наших их использовать обкатать а потом сказать что КПП тут вроде как и ни при чем Потому что теперь Мы готовы представить что в обычном PHP на самом деле есть честные модули модели мы так назвали штуку которая внедряет в PHP модуля смотрите это Шторм обычный какой-то код что там происходит но если посмотреть внимательней в дереве файлов написаны какие-то там собачка что-то явно намекающее на модульность возле функции возле классов там экспорт From что-нибудь ошибки какие-то что ты не можешь использовать класс и так далее модели это технология которая внедряет модульность везде я расскажу как она это делает как у нас появляется Internal всякие классы и праведные экспрессии в еде на гитхуках восстание на бэкенде в том озере и понятное дело как это можно будет использовать у вас поехали Internal представим что над проектом работают Месси и Адам вместе пишет мессенджер Адам пишет адоминку И вот вместе в мессенджере есть каналы папки там все как полагается короче нотификации про вступление в канал про Выход из канала и так далее Вот и Адам свои адоминки пишет добавление юзера в канал посмотрим что он делает Вот он там оставляет что-то в базу создает нотификацию что вас добавили отправляют ее вместе такой смотрит на это типа блин то что за фигня нельзя так делать код работает он действительно работает но нельзя так делать нельзя брать создавать нотификации отправлять их потому что внешний кот он не знает про разные девайсы прослуд контроля про какие-то настройки и так далее нельзя даже в админке создавать носификации это все должно идти как-то по-другому Что делает Месси Он берет нажимает кнопочку говорит создать из моей папки с каналами модуль Месси channels кликая что notifications у него теперь приватная и Адам теперь в адаминке своей видят что joinotification я создать не могу потому что это Internal вместе channels если посмотреть вот там в дерево файлов мы увидим что действительно даже в дереве файлов видно что есть чем с которой теперь модуль Internal класса и так далее Все нативно а что произошло на самом деле когда Месси вызвал это окошечко и создал модуль на самом деле в папке с каналами появился Файлик модулайт яму который очень простой говорит то что вот есть модуль с таким тоном спейсом то что он экспортирует класс все остальное не экспортирует значит оно интернал и все остальное работает уже по умолчанию экспорт это то что мы из модуля гоним наружу но одновременно модульность позволяет как бы фиксировать состояние того что у нас есть вот представим что к Месси пришел Джун Месси ему говорит Окей Ты вот сейчас у меня в мессенджере сделай функцию которая проверяет подписан ли юзер на канал джун такой Окей Ну как надо эту функцию сделать по идее взять такое типа айдишник юзера взять все его каналы проверить там на вхождение айтишника Он берет получает текущего пользователя там достает его каналы смотрят только видит ошибку что функция current User она не добавлена в эквайер Типа она не используется Значит надо добавить он говорит типа OK добавлю ошибки нет но это привело к тому что когда джун отправляет код на review вместе такой вид Опачки появилась новая зависимость раньше ее не было раньше Карен юзер в мессенджере вообще не использовался а тут вдруг начал использоваться надо значит подумать почему в данном случае это ошибка в данном случае новая зависимость означает то что не надо так делать не надо тебе доставать текущего пользователя и брать его айтишник должен приходить откуда-то снаружи может быть если бы Джунгли зовут что-то другое и добавил бы новую зависимость это было бы Окей в данном случае Месси не примет кот на ревью отправить переписывать но в любом случае Когда появляются новая зависимость это не пройдет незамеченным А если пройдет то останется в гите останется в файлике потому что иначе это не сможет работать то есть модуль это просто папка с PHP кодом с одной стороны Одна она определяет доступ наружу что доступно снаружи через экспорт а с другой стороны то что мы сами можем использовать через requires как это в принципе предполагается использовать в монолите И зачем вообще это нужно вот смотрите у нас же клубок вот такой клубок связанного кода который со временем становится все время хуже и мы хотим мы хотим сделать так чтобы этот клубок хуже не становился Мы хотим зафиксировать текущее состояние иметь инструмент который запретит ему становится хуже запретит возрастание тропии по факту в языке существующем коде поскольку все совсем связано мы не можем взять и выделить что-то в composer пакет мы не можем мы так сделать просто напросто потому что пока мы какой-то участок года не автономен он наружу Не вытаскивается а модульность она позволяет по факту не вынося это в пакет изолировать отдельные участки кода отдельно в монолите писать под них правила и чтобы эти участки кода подчинялись правилам которые определяются владельцами этого участка то есть вот допустим сейчас все плохо но мы зафиксировали какой-то участок кода и можем постепенно его рефакторить постепенно приводить к тому что у него сизали зависимости чтобы туда никто не лез не было исключений и так далее и когда-нибудь потом когда мы от зависимости избавимся уже вынести это в пакет за счет того что модульность есть у нас есть гарантия того что новые связи появляться не будут И кстати когда вот у нас все станет хорошо А надо ли вообще говоря выносить этот пакет а на самом деле нет потому что зачем откуда вообще идет концепция Давайте вынесем что-то в composer пакет потому что есть принципе такая ассоциация пакет Это хорошо это изоляция это модульность Но если модульность обеспечивается другим инструментом предназначенным для этого только для этого уже не нужен для расшаривания кода понятное дело а просто для изоляции уже получается и нет в общем того что мы хотим мы аналогов не нашли поэтому мы сделали модулей Мы скрестили наш опыт выдает чтобы это было удобным опыт в разработке чтобы это было правильным и опыт в компиляторах чтобы это было быстрым трейды как теперь Шторм выглядит с учетом модульности до дольше мы уже видели что из любой папки можно создать модуль окошечко чекнуть всякие символы Когда у нас Мы наригируемся по коду Возле каждого класса там где Файна константы и Да я Нам пишет что это символ внутренней или символ экспортированной Мы это можем там хоть Кеме intensional менять или контекстное меню это можно менять Например если у нас символ какой-то публичный и мы хотим его сделать внутренним но он уже где-то используется если мы просто сделаем его внутренним то текущий код который это использует он станет не валидным понятное дело Но если мы плагин умеет делать Так что он находит все текущие места он их добавляет в исключения и текущий код продолжает работать Просто он навешивает исключение на те места которые сейчас есть а новых мест уже не появится то есть мы зафиксировали состояние и хуже оно становится не будет Можно даже там если класс у тебя экспортирован куда-то является публичным можно скрыть у него даже конкретные публичные члены сказать Вот этот метод недоступен Хотя класс сам доступен Спрашивается зачем так делать Но мы же помним что мы имеем дело с текущим кодом который сейчас у нас есть и Наша задача сделать так чтобы он не становился хуже а следовательно нужны какие-то инструменты для этого в общем там опять-таки это все описывается когда мы пишем любой код новые существующий и две всегда проверяют что все символы которые мы используем они добавлены в зависимости это Global это всякие функции другие классы и так далее Следовательно в любой момент времени у нас есть список зависимостей и Да я это все проверяет он генерирует автоматически Понятное дело что когда в проекте модулей вообще нет И ты создаешь модуль из какой-то папки у нее становится куча зависимости на другой код уже существующих но по мере того как этот другой код тоже превращается в модуле то зависимости становится только между модулями например вот тут зависимости от всяких kernel от этого методов А потом когда Месси сделает из кернела модуль вот из этого это будет просто-напросто зависимости от модуля и можно использовать любые символы Несмотря на то что это вроде как Ян файл строки и это все подсвечивает есть всякие там подсказки юзаджи rename Это все находится прям встроена нативно модули можно вкладывать друг друга к примеру вот месте Там посидит сделает модуль там из каналов из папок из своего ядра каждый модуль что-то экспортирует имеет какое-то публичное интерфейс Но это все равно мало потому что внешний кот он может использовать папки Вы можете использовать там каналы он может использовать ядро а на самом деле он может выразить свои мысли вообще вот так создать внешний модуль миссия А вот ядро сделать внутренним это тоже все видно выдает тоже все делается когда вот он создает модуль из внешней папки он видит уже там под модули наравне с другими символами Может чекнуть он чекнуть и так далее даже если кто-то потом захочет из внешнего кода сейчас до ядра схватит ошибку прям выдает вообще две пачки прикольные придумали какие-то фишки реализовывать это тоже прикольно к примеру часто же возникает такая ситуация что ты лазишь по коду вот лазишь изучаешь какой-то код смотришь там вызов функции например вызывается у тебя и ты такой думаешь Ну блин не очень конечно что она вызывается вообще сколько раз если там раз два Окей если сто раз но уже плохо на любой функции можно кликнуть и сказать Покажи мне юзажи только внутри моего модуля не вообще вы везде по всему проекту а только ограничена там где Я сейчас смотрю это максимально удобно Или когда вот мы смотрим на чужой модуль мы знаем что используем его символы какие-то можно сказать Покажи мне зависимости все от чужого модуля он там напишет такой списочек от этого символа ты не зависишь не зависишь от этого Окей и покажет В общем в этой гемы внедряемся везде где только можно раскрываем кликаем как будто бы это все максимально нативно как будто она тут и было и Понятное дело что надо понимать что в этой мы внедряемся и плагин в целом для еды это клевый это охренительный юай над конфигом над конфигом который как раз хранится под гитом и который как раз собственно рендерится визуализируется плагином конфиг Это явно файлик там понятное дело вот есть такие меймы экспорты и прочее есть исключения он в принципе простой то стоит только проговорить про то как делаются исключения и как они в целом должны делаться в реальном проекте вот примеру все-таки отдам свои аддоминки хочет использовать вот Надо ему какой-то Database Понятное дело что он сам не может прорубить туда канал не может сделать себе исключение типа я хочу вот это использовать нет как это должно происходить как это происходит Адам идет комиссия я объясняет ему ситуацию в принципе что он хочет сделать а там уже возможны варианты может быть Адам просто не знает про публичный интерфейс вместе ему скажет Используй Вот это Окей может быть Месси действительно не предусмотрел какой-то Юз кейс он реализует сделает публичный интерфейс а там будет его использовать может быть интерфейс на самом деле есть просто никто его не использовал и он не за экспортирован вместе значит за экспортировать и он будет ее использовать и только если действительно почему-то нужно исключение тогда Месси тогда вот он лично конкретно адаму для конкретного функции конкретным символом может сказать что вот здесь можно обращаться тогда Адам из этой функции сможет сделать то что ему нужно эти исключения останутся мозолей глаза Месси и когда от них избавиться потому что без них если их удалить просто сломается вот В общем есть я вам файлик которым который визуализирует и Да я и за счет того что есть ем Файлик на самом деле все проверки они могут работать не только выде но в целом при анализе кода PHP Стан мы сделали плагин для PHP странно чтобы можно было использовать модульность в реальном проекте при анализе кода плагин умеет читать Ян файлики ризовые там все символы находить по нужным правилам точно так же как и да е подсвечивает все ошибки в общем он клёвый он работает Единственное что там не удалось победить пахославский кэш потому что бы не анализировать весь проект целиком он работает примерно так что те файлы которые ты про изменил он на них прогоняет те файлы которые ты не трогал их он не прогоняет ободленность Она же такая глобальная типа изменения в ямниках они могут привести к появлению истязанию ошибок из ПП файлов которые не менялись реально Поэтому иногда он тупит Вот если кажется носить все работает Если конечно сносить Но типа неприятно конечно но если сообщество скажем так зайдет это можно будет решить Я не знаю разработчиками как-то внедриться в него в общем вещь главное что работает все остальное и работает точно так же и выводит ошибки абсолютно похожем виде совершенно нативном для PHP стран виде потому что это обычные ошибки анализа кода только на основании явликов Понятное дело что в КПП это тоже У нас есть И вообще изначально реализацию или КПП делал Я когда это все придумал там как раз написано эталонная версия на плюсах как это должно работать плохо без танков по факту мы взяли такие вот просто плюсовый код имплементацию скопировали на PHP перевели вокруг этого станские обвязки рефлексию и поэтому она там работает можно быть в этом уверенным Ну и у нас нет проблем с кэшем потому что проанализирует весь проект целиком и тоже выводит ошибки в таком же видел покрасивее чуть-чуть то есть где есть модульность куда она добавлена в КПП она есть в PHP стане она есть в наш линтернал verifi мы ее не добавляли потому что зачем на Sei на github она есть потому что там используется ПХП стран либо КПП шторме она есть в виде плагина А в других еды ее нет потому что ну вообще я говоря не понимаю как писать большие проекты Сидя в виме или в ноутпаде хотя есть такие И даже это еще не все вот мы рассматривали монолит что модульность это прикольно для Монолита но ее можно на самом деле использовать и просто при разработке обычных Композиторов пакетов потому что потому что они ничем не отличаются им удалось с композитором прекрасно дружат Вот например есть Герасим поскольку он не мой он пишет пакет для преобразования речи в текст и понятное дело у него там в пакете есть какие-то файлики классики и он тоже может использовать модульность например объединить там какие-то внутренние имплементации вынести отдельно сказать что это модуль Intel И точно также выдает видеть что он находится в модуле imple что там что-то экспорт Композит пакет вообще не отличается ничем от обычного проекта с точки зрения разработчика потом когда Месси пишет распознавание аудиосообщений использует пакет Герасима для образования речи в текст тогда он по факту для того чтобы использовать он добавляет зависимость только зависимость не на какой-то модуле не на какой-то там класс а на зависимость на этот пакет как будто бы это модуль Но на самом деле не как будто бы композитор пакет по факту для внешнего наблюдателя это и есть неявный модуль просто не на собачку начинается она решеточку чтобы их отличать тот самый Intel который был Герасима он превратился в текст Intel это удобно это понятно И это избегает коллизий имён когда Intel есть в одном пакете в другом и так далее даже самом аналитии просто при фиксировании еще и понятная потому что допустим если Месси попробует К какому внутреннему классу Достучаться он сваивает ошибка что это Internal там ВК В из текста Intel и это в принципе настолько все нативно что даже не пришлось делать ничего особо для этого и более того мы можем сделать даже то что в обычном композере нет и не будет и не планируется потому что никак ведь композитор Это что такое Это по факту способ автолога 2 конкретных классов там и функций и все и поэтому в композитор пакете в обычном любые файлы любые классы любые символы они точно также доступны точно также внешний код может залезть куда угодно особенно если файлы лежат в корне вот к примеру там есть Герасима класс транслитераейшен лежит в корне Адам может его использовать без проблем но герасин например хочет считать что этот класс внутренний он не хочет чтобы кто-то использовал Да он может запихнуть его куда-то в Intel А может даже не запихивать может рядышком с Композит он положить Файлик где сказать что вот я из своего пакета экспортирую конкретные классы конкретные символы и все он это будет видеть точно также при разработке вот транслируешь на него становится Internal Internal в композируйте и Адам больше не может туда подлезть потому что модульность В общем с точки зрения модулейта композитор пакет Ничем не отличается от обычного проекта а когда мы пакет подключаем монолит это просто становится модулем Кстати да почему я могла назвал именно так Если честно я не люблю слово модуль вот просто мне не нравится слово модуль Оно слишком много скажем коллизий имен вызывает модули есть одни вторые третьи если это просто будет модулем вот этот наш модуль он будет путаться по названию со всеми остальными поэтому хотелось что-то связать модуль и Монолит то что это вот модуль внутри Монолита на самом деле то есть модулит модулит это модуль внутри Монолита это по-английски и одновременно это просто модуль плюс Light Вот такая этимология То есть если обобщать все вообще весь доклад он внедряет в PHP честные модули только не вмешиваясь синтаксис ПХП а удобно Находясь рядом его можно использовать как для новых проектов так и чтобы фиксировать состояние Монолита И постепенно развязывать его не давая энтропия увеличивается и конечно же как это использовать у вас github.com В каком году Light запомнить теперь легко Почему модулей И кстати там есть большой лэндос и кто туда зайдет после этого доклада сильно удивиться потому что на самом деле весь этот доклад Я просто скролил лэндос на скриншотил его и получился доклад забыл представиться в начале Александр Кирсанов руководитель команды КПП ВКонтакте все так спасибо Так давайте-ка пройдемся по вопросам не знаю в курсе ты или нет но тут такая традиция то что у тебя спрашивают вопросы ты потом выбираешь того кто задал тебе лучшие вопросы он получает подарок поэтому Старайтесь запоминать вопросы которые тебе понравились чтобы потом выбрать лучший вопрос Итак микрофон и вот есть моды модуль который немножечко похож на этот Почему бы не смотрели в сторону из него как-то что-то ходить Ну он не похож сделать Почему именно своё Витая фантазирую я вижу и Ну типа я не вижу в них ничего похожего на самом деле вообще изначально когда Почему я придумал именно в таком виде прежде всего самый главный критерий Чтобы было чтобы была стыковка с и de Потому что если есть стыковка с IDE если мы вот прям выдея их видим нативно то тогда можно развивать дальнейшее если этого нет это будет обычный инструмент который Ну где-то там конфиги хранит и прочее Следовательно формат конфигов и формат того как это должно быть он прежде всего должен отталкиваться от того чтобы не было чтобы для того чтобы вычислить написать какие-то символы не нужно было знать никакой калграф мне нужно было знать ничего сложного можно было подлезть в индексы можно было скажем так за от единички обладает двумя вызовами понять можно или нельзя а Если нельзя то по какой причине вот Ну и к тому же до Следовательно и формат существует и нам надо фиксировать состояние существующего Монолита не просто новые делать А вот у нас есть уже что-то Мы хотим это зафиксировать прорубить дырки оттуда вот где они сейчас есть а потом начать это дело затягивать чтобы хуже не становилось понял спасибо большое и маленький вопросик Почему не публиковали в marketplace IDE а только через github пакетом по-моему скачивается потому что jetbrains до сих пор нет моделировали наш плагин Они вообще сейчас с Россией плохо дружат скажем так но Мы попытаемся это продавить спасибо большое Привет Спасибо за доклад Спасибо за ползу Теперь когда мне завтра спросят чем же мне делать чем же делать то что я по что я буду рассказывать я скажу вот Саши персонал сделал надувает потому что в принципе да про интернал я про их важность Я буду рассказывать как заставить использовать команду это все Хороший вопрос я-то знаю как заставить использовать это у нас обычно как я заставляю Обычно я вношу какие-нибудь изменения в компилятор что кот перестает компилироваться и никак ты это не обойдешь вообще никак в данном случае если будут неактивно использовать Я придумаю способы как это сделать так чтобы выхода не было вообще должна это нормально ситуация понятное дело Это должно быть intention нам самих продуктовых разработчиков потому что изолировать свой код Это должно быть их желание прежде всего Да это становится сложнее да приходится думать думать люди не любят вообще не любят как казалось обидно но не любят поэтому я немножко еще понадеюсь а потом что-нибудь придумаю Саш спасибо за доклад большое реально интересно я уверен что вот я тоже принесу это к себе А скажи пожалуйста пробовал ли ты вот такой подход уже на Живую у себя использовать во-первых и во-вторых мне тоже захотелось это как-то визуализировать какие-то Граф строить как на какую-то картинку смотреть взаимосвязь между модулей количество считать уже есть поделишься Ну на самом деле типа вот модули это что штука более высокоуровневая чем классы и функции да то есть да На самом деле я считаю абсолютно точно когда в проекте у тебя реальные папочки реально функциональность собьется на модуле это можно будет красиво визуализировать когда их но несколько десятков к примеру накопится в реальном коде поскольку я эту штуку только записал только я зарядили и только начинаем использовать в реализации КПП я точно уверен там точно все нормально Вот и я думаю что со временем через какое-то время у нас действительно получится такие красивые картинки на которые уже можно будет наложить цвета про которые я рассказывал год назад Спасибо за кот на PHP есть расширение extention не Планируется ли какой-то экшен написать чтобы он тоже мог Ну смотреть на модулей Да и выдавать какие-то ошибки Ну слушай я бы сказал что нет я вообще считаю что PHP пошел по неправильному пути когда начал внедрять ты проверяемые они должны быть непроверяемые они должны существовать только для стата анализа как и вот эта штука существует для стад анализа так и на самом деле любые проверки в PHP они должны были быть сделаны изначально фундаментальном языке только для стата анализа и поэтому я считаю что проверять не нужно вообще не нужно никак с одной стороны домой Пойнт такой Понятное дело что когда мы используем цитата анализа мы можем проверять только то что мы можем проанализировать если ты там запиши имя класса или функцию в переменную потом это вызовешь Это понятное дело пройдет Сквозь все проверки потому что это нельзя задетоксить Но в КПП ХП это не проедет сквозь компиляцию поэтому у нас не прокатит такая штука Ну значит получается ограничить уже принудительно это гитхуйте не запушишь Да у нас не заглушишь в обычном PHP заглушишь Ну точнее заглушишь обманув статические анализатор обманываться любой статический анализатор на самом деле легко не только по хпшный любой в runtime Мне нужно ничего добавлять Ну точнее можно добавить но только нативные модули и чуть по-другому но не в таком виде конечно да Спасибо большое за доклад во время research подскажи пожалуйста Возможно ты сталкивался с пакетом hambook scooper он используется например в ректор он используется Ну довольно известный от автора хамбокс есть был такой пакет Чем он занимается там есть конфиг которым ты указываешь экспортные классы или что-нибудь другое А все остальное он изолирует прям внутри пакета методом физического переименования в основном он занимается нужен для того чтобы иметь несколько одновременно версии совершенно разных пакетов Ну чтобы не было конфликтов имен и каждый раз он добавляет например Случайный хэш для классов и прочего чисто теоретически можно было просто написать плагин Композитор который при установке пакета считывает и реально физически переименовывает классы эти при попадании вендор Это самый простой путь Мне кажется был нет и Возможно проблема какие-то были на самом деле это путь достаточно неплохой Когда у нас на продакшене условно говоря когда реально код работает не тот что написан в репозитории Вот как это в принципе делается для любых околоцветных языков и так далее в PHP мире я сам не то чтобы много на PHP пишу будем честными плюсах и всем вот этом вот Да я про такую штуку не знал я понял о чем ты это просто Другой путь когда мы не даем использовать наши символы путем того что их не существует потому что они заманганы на самом деле ну так тоже можно пойти Я не вижу я не думаю что это сравнимые моменты на самом деле Ну чисто теоретически можно добавить в пакет поддержку этого скупера для того чтобы он не только физически например на уровне ID подсказывал но еще потом еще мангл и ламинат как насчет такой идеи Ну это я думаю что достаточно близкий вопрос К тому Надо ли добавлять в runtime проверки вот что тут вот мы классы переименуем Ну и по факту если Мы попытаемся использовать мы наткнемся на runtime ошибку то же самое что если бы модули мы как-то сделали runtime в обычном PHP чтобы они чтобы прям нельзя было использовать Я считаю что условно говоря Если ты зачем-то хочешь обмануть вот прям не знаю для не тестирования какого-то для моков и так далее То что туда подлазишь это в принципе нормально Главное чтобы твой Продакшен код для него существовали для обычного продуктового кода утилиты которые выполняют твои задачи То есть я считаю что это излишне но это тоже хороший путь и так вроде бы все Отлично У тебя сложная задача А может быть не сложная выбрать того кого ты порадуешь подарком за лучший вопрос Ну давай про deeptrac вначале кого хорошо так пожалуйста вручите подарок Ваня а Держи я вручу тебе подарок от нас еще мне ладно подарок от нас к от организаторов Спасибо тебе большое за твой контент подавайся еще будем рады видеть тебя списки докладчиков У нас небольшой перерыв и мы скоро продолжим"
}