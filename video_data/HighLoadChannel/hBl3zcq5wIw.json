{
  "video_id": "hBl3zcq5wIw",
  "channel": "HighLoadChannel",
  "title": "Глубокое обучение в продуктовом ритейле: сложности, риски, допущения / Илья Иванченко (Магнит)",
  "views": 173,
  "duration": 2987,
  "published": "2023-10-06T07:25:45-07:00",
  "text": "Всем привет Меня зовут Иванченко Лия Я работаю На оформлении развития алгоритмов прогнозирования спроса компании Магнит Сегодня я расскажу вам о нашем опыте применения нейросетей продуктовом ритейле а именно о том зачем нам это понадобилось С чего мы начали Какие сложности были у нас на пути как мы их обходили чем это закончилось И стоило ли вообще немного о компании Магнит довольно крупная компания Ну или если точнее один из крупнейших ритейлеров в России торговые точки сети представлены 67 регионах и на данный момент их общее количество составляет более 25 тысяч магазины очень разные и в первую очередь это связано с форматами их у нас 6 больше всего представлены магазины у дома но также есть гипермаркеты магазинные косметики и другие помимо этого магазины очень сильно отличаются по ассортименту как по количеству так и по его составу это может быть связано с разными факторами с местоположением магазина с локальными предпочтениями жителей клиентов и прочее все это многообразие в совокупности дает более 150 тысяч уникальных товаров так или иначе это оказывает влияние на процессы планирования в ритейле и на постановку задач какую задачу мы решаем Мы бьемся за то чтобы покупатель приходя в магазин имел возможность купить свой товар То есть он не заканчивался при этом товара должно быть достаточно но не избыточно много потому что это замороженные деньги как минимум и потенциально в случае оценки это сниженная маржа А если это товары скоропорта то есть товары с низким сроком годности в этом случае это денежные потери Зачем нам нейросети наверное к думает тут здесь каждый и я думаю многие из вас знают что эту задачу можно решить более приземленными способами Дело в том что нашему продукту более двух лет и на данный момент мы проработали множество подходов У нас есть кастомные алгоритмы прогнозирования подходы на основании линейной регрессии и некоторые другие не то чтобы мы вышли на симптоту метриках но темпы улучшения метрик замедлились помимо этого в текущем подходе в текущих подходах можно отметить отсутствие возможности явно учитывать временные зависимости и наличие большого количества моделей для нас оптимальным оказалось использование десятков тысяч моделей для описания спроса наших клиентов А это десятки миллионов временных рядов в теории нейросети могут устранить эти недостатки и стать новой точкой роста пройдя этот большой путь мы не можем не отметить важность данных их роль по нашему опыту прорабатывая модель мы получаем эффекты кратно меньше чем когда прорабатываем данные и максимальный эффект достигается при использовании новых бизнес знаний при оцифровке и добавлении в модель тех данных которые раньше не использовались никакие данные не идеальны и наши не исключение с одной стороны большинство временных рядов имеют весьма волатильный спрос и противопоставить им можно временные ряды очень разреженные с большим количеством нулей то есть с отсутствием продаж здесь мы консолидировали многие другие особенности и из них можно выделить аномальный спрос Когда происходит ремонт дороги возле магазина и клиент физически не может подъехать подойти к войти в магазин Или просто хотя бы не может удобно припарковаться также Это виртуальные остатки это расхождение системы учета с фактической ситуацией когда магазина нет в магазине нет товара Но мы его видим базе данных или магазин даже может быть товар может быть в магазине Но его нет именно на полке все это так или иначе портит статистику и вносит свои искажения также в наших временных рядах очень много пропусков из основных можно отметить временное закрытие магазина на 2-3 недели на ремонт или редизайн и ротацию ассортимента Когда происходит вот одних товаров вывод других и тот который вывели Через несколько месяцев или через год может вернуться обратно Хотя это кажется один времена рядом и также это искаженный спрос из наиболее явного это каннибализация когда продажа одного товара перетекают на другой из-за например промотирование когда условия для покупки этого товара стали выгоднее и также это обнуление когда товар физически заканчивается в магазине и мы не знаем истинный уровень спроса возможно уже бы никто и не брал этот товар но возможно он бы стал намного больше и Давайте немного пробьем в нашем корпоративном хранилище данных около 700 терабайт в рамках нашего проекта мы используем около трети 200 ТБ в рамках этого подхода мы используем часть из них и по результатам перед обработки агрегации до модели доходит около 1 терабайта если перейти вот веса количество то это более 50 миллиардов наблюдений за один год количество используемых лет опционально теперь когда мы все более-менее погружены в контекст мы можем вернуться ближе к теме доклада если загуглить самые популярные нейросети большинство из них будет предназначено для Медиа для работы со звуком для обработки текста и особенно часто для работы с изображениями для временных рядов тоже есть архитектура топовых топовых мировых компаний Однако их намного меньше как следствие намного меньше общедоступной информации опыта по применению и экспертиза чтобы ответить на вопрос как вообще сделать так чтобы они заработали показали какой-то хороший результат помимо этого даже если взять одну из них из тех немногих которые есть они не факт что будут работать или даже я скажу что они будут работать это связано с особенностями каждого отдельно взятого бизнеса и со спецификой связаны характерные ритейл Что еще можно отметить из других сложностей первый барьер это же пью их стоимость это актуально везде но особенно актуально для той задачи которую можно решить более приземленными методами подготовки данных следует уделить больше времени и внимания тот же градиентный бустинг можно подать данные с аномалиями пропусками не думая масштабе данных и прочем экстраполяция это способность модели выходить за рамки тех значений которые она видела обучающие выборке это может быть как и преимуществом так и недостатком Однако чтобы это было преимуществом необходимо это как-то учитывать мы контролируем входные данные есть некоторые фичи у которых которым характерен определенный диапазон значений и например скидка 150 процентов вероятно что-то странное это не стоит в таком виде пропускать модель И помимо этого у нас есть другие интерпретируемые методы проверенные временем с которыми и их прогноз Мы можем сопоставлять с прогнозом данного подхода также стоит подготовиться к тому что черный ящик может стать особой отдельной проблемой поскольку Особенно для бизнес коллег это некая мистика и она их очень пугает как минимум бизнес заказчик хочет понимать логику вычисления прогнозов как максимум и обычно Так у нас это происходит он хочет его полностью контролировать Здесь нам помогло то что за 2 года создания продукта мы заслужили некое доверие и показывали стабильные метрики и результаты на репрезентативной выборке на широком периоде все же главной проблемой является получение прогноза высокого качества когда метрики можно сопоставить они готовы конкурировать с остальными подходами которые уже хорошо проработаны И в принципе чтобы не достигали желаемого уровня мы начали с простого здесь представлены пример базовых элементов для работы с последовательностью отвечают за последовательности если упрощенная это рекурентная нейросеть и Dance это плотные слои с некоторой надстройкой чтобы они тоже могли работать с трехмерными данными это физически работало выполняла свою функцию и даже давала неплохие метрики Но лишь как для безлайна это было далеко от желаемых метрик и еще дальше от тех которые у нас уже были к этому моменту мы начали разбираться смотреть в чем проблемы искать точки роста и первое что мы обнаружили что применяя классические методы заполнения значений мы зачастую приносили больше вреда чем пользы поскольку очень сильно и сказали искажали временные ряды напомню что у нас подобных пропусков данных очень много вместо этого Мы перешли к маскированию маскирование позволяет обозначить модели те наблюдения которые мы хотим игнорировать те наблюдения которые разметка которую мы формируем формируется нами экспертно на основании вычисляемых правил Однако здесь можно пойти дальше добавить алгоритм детекции аномалий или вычисление других наблюдений которые мне стоит доверять если вернуться к архитектуре которая сейчас появится у нас появляется новый элемент до поступления данных модель слой маскинг принимает наши уже сформированную разметку и обозначает модели что будет игнорироваться в качестве преимущества у нас все тот же цельный временной ряд но при этом у нас нет эфирных значений которые очень сильно искажали спрос это приподняло наши метрики и мы пошли дальше далее мы изменили подход к работе с неизвестными факторами продажи наш Таргет То есть то что мы хотим предсказывать будущее очевидно что мы не можем использовать это как фичу как минимум потому что мы не знаем эти значения на момент расчета Однако уровень продаж в прошлом является очень важным фактором и как-то хотелось бы учитывать работая с линейной регрессией или сетью прямого распространения когда одно Наблюдение это одна строка Это обычно достигается за счет добавления лаговых печей лаговых печей когда мы берем продажи из прошлого с определенным отступом который согласован с горизонтом прогнозированием усредняемых и подаем будущее как известно На данный момент хочу у этого подхода есть несколько минусов у меня кликер до сих пор так и не переключил у этого подхода есть несколько минусов допустим наш Таргет нашем случае продажи объясняется пятью признаками Но тогда и продажи из прошлого которые мы подаем как лаговую фичу тоже объясняется этими 5 признаками и мы не предоставляем модели право объяснить их даже если мы добавим для каждой из пяти фичей лаговую версию удвоих общий список вещей будет другая проблема скидка например будет известна и в будущем и в прошлом Однако это будут два независимых поля просто разные колонки Без явного учета связи работая же с последовательности мы автоматически решаем одну из проблем та же скидка ее значение из прошлого из будущего теперь имеют они находятся физически в одном поле и у них как явная связь в отличие от предыдущего подхода в данном случае здесь изображена таблица и она теперь является одним наблюдением когда Раньше у нас была одна строка одним наблюдением если вернуться к архитектуре у нас появляется два новых элемента во-первых Ярость мы разделяем данные на данные из прошлого и неизвестные факторы в будущее и направляем их в разные потоки у нас появляется энкодер который кодирует данные из прошлого и энкодер который принимает лишь неизвестные известные в будущем факторам за их связь отвечает отображение пространства одинаковой размерности и использование в качестве начальных состояний в декодери конечных состояний из энкодера так например можно использовать температуру которая может объяснить волатильность продаж в прошлом но при этом неизвестно в будущем это также приподняло наши метрики но они все еще не были конкурентными и мы пошли дальше в наших данных очень много статичных признаков это не зависящее от времени признаки то есть константы в рамках одного временного ряда например Это Торговая Площадь Она иногда конечно же тоже может меняться но в 99 процентов случаев это Константа сейчас они попадают в лстм наравне с временными признаками напомню что лстм используется для поиска зависимости во временных рядах последовательности очевидно что таких зависимостей нет у константы помимо этого эти признаки просто дублируются на весь временный ряд что тоже кажется не самым оптимальным методом вместо подачи их наравне с временными и дублированием Мы также отделяем статичные признаки в отдельный поток и подаем их в качестве начальных состояний уже существующий элемент энкодер помимо того что это также позволило нарастить наши метрики это снизило занимаемое пространство на диске а также увеличить уменьшило потребление памяти не могу сказать какой момент мы совершили Прорыв но следующим этапом была обработка категориальных признаков мы уже данные дважды разделили наши данные на известные неизвестные временные признаки и отдельно выделить статичные Но помимо этого у нас очень много категории категориальных данных Существует множество способов экзакодировать один из популярных способов это кодирование средний тут стоило Уточнить что у каждого способа есть свои минусы и как раз таки у кодирования среднем минус в том что два одинаковых бренда могут иметь один одно значение и у модели нет понимания как их разделить для нее они будут выглядеть одинаково другой популярный метод это горячее кодирование Ван Хот энкодер его минусом является получение довольно во-первых высокоразмерных фичей мы раздуваем размерность во-вторых эти такое кодирование довольно разреженное что тоже несет проблемы на производительность модели вместо этого мы применяем бэдинги которые позволяют получить компактные представления это плотное представление мы не раздуваем нашу размерность и особенно хорошо они себя проявили при работе свечами высокая кардинальности когда вашим Факторе 500 1000 2000 и более значений если вернуться к модели нас снова появляются два новых элемента здесь важно Уточнить что отдельный экземпляр используется для статичных свечей и выходящее значение из данного экземпляра мэдингов Также будут попадать в начальное состояние энкодера и отдельный экземпляр для временных фичей но здесь Также важно что это один и тот же экземпляр как для данных из прошлого а также и он же используется для известных данных в будущем данные элементы очень сильно помогают для описания как я уже говорил ранее временных рядов с абсолютно разными паттернами это когда много продаж и спрос очень волатильный и в противопоставление ним им разреженный временный разреженные времена временные ряды с большим количеством нулей Вот это уже очень хорошо работало но также стоит отметить важность следующих элементов едет линер Юнит это некий абстрактный фильтр фильтр у него в составе есть 7 до которая из которой которая позволяет получить значение от 0 до единицы и таким образом этот элемент может снижать важность одних признаков и повышать важность других признаков Он в свою очередь используется в следующем элементе грн или где этот ресивер Network в этом элементе есть остаточное соединение которое позволяет полностью пропустить фичу в том виде в котором она есть и с другой стороны и с другой стороны есть возможность все-таки ее проработать таким образом этот элемент добавляет модели гибкость позволяя применять нелинейную обработку только там где это необходимо этот элемент используется в следующем Аналогично предыдущему но его можно использовать и независимо он имеет отдельную собственную пользу Вари был selection Network позволяет модели адаптироваться под зашумленные данные и нивелировать их влияние нивелировать их влияние здесь подаваемые фичи сначала конкатенируются и подаются в ГРН это поступает софт Макс и выделяется наиболее важные признаки вот выход после текущего этапа можно использовать для определения важности фичей с другой стороны в другом потоке те же самые фичи отдельно каждая независимо от остальных сначала проходит через грн И лишь потом происходит континация всё это вместе по элементамножается и выход мы будем дальше использовать я покажу как на следующем слайде в комплексе эти элементы позволяют сканировать фичей определением наиболее важных а также с разной сложностью модели для разных входных данных если вернуться к архитектуре у нас появляется три новых элемента всм для статичных признаков для временных неизвестных известных будущем и известных в прошлом всех известных прошлом напомню что мы начали с двух элементов в правом края лстм и Дэнс затем мы добавили элементы маскирования чтобы не заполнять фичи пропуски фичах искажать их а использовать как есть мы разделили данные отделили их разные потоки энкодер и декодер для обработки категориальных печей мы добавили статичные признаки также отделили и Передаем начальное состояние энкодера на этой архитектуре мы и остановились Давайте посмотрим как это реализовано технически я пропущу те моменты когда мы разрабатывали на офисных ПК собирали маленькие модельки и использовали довольно маленькие данные в какой-то момент мы приобрели карточки Tesla V100 и у нас получился следующий незамысловатый paypeline мы брали данных цдх перекладывали на виртуалку где у нас происходило и подготовка данных и обучение модели модель перекладывали на аналогичную виртуалку другую там и осуществлялся прогноз С возвращением результатов то же самое точку нас это устраивало это работало Но лишь до тех пор пока мы не начали масштабировать используемые данные и не начали приближаться к роду самым узким местом у нас оказалась подготовка данных она занимала несколько раз больше времени чем сама обучение модели у нас был есть ходу кластер со спарком и перенос подготовки данных туда уже избавил избавил нас от этой проблемы с точки зрения обучения модели по времени оно тоже было большим и нам пришлось увеличивать ресурсы в итоге мы уже собрали два кластера с карточками Tesla a100 Итого у нас получилось Мы берем данные с двх обрабатываем их на Спарки уже в готовом виде перекладываем на один из серверов модельки оттуда также тепло это на другой сервер где осуществляется прогноз с обратным возвращением на целевую точку в качестве оркестратора у нас всегда использовался И теперь когда мы обсудили так сказать и математику и физику Можно перейти к результатам в качестве метрики мы используем точность Это связано с тем что бизнес-заказчик не очень сильно привык Но она очень легко вычисляется через ошибку Ошибку мы используем как Взвешенный mape где это взвешивается на продаже отдельный важный Метрика является баланс ошибки но не в рамках данного доклада Я лишь могу сказать что они были сопоставимы в ретро-тестах мы получили прирост 4-6 процентов 46 потому что заказчика важны разные уровни оценки Однако когда Мы перешли к предпроду обратились полностью к реальности наш Boost снизился до полутора пункта с чем это связано в первую очередь это связано с большим отступом и за потребности планировать сильно заранее оказалось что на момент расчета наши знания О следующих 20-460 днях зачастую очень сильно отличаются от того что на самом деле будет и как оно будет и Вторая причина это сам целевой период опять же из-за характерной специфики характерные ритейл специфики Бывает так что мы рассчитываем прогноз на одних параметрах а на самом деле они были со всеми другими например через 60 дней какой целевой период на котором прогнозировали был через 60 дней и мы делали расчет со скидкой 10 процентов или наоборот 0 процентов А по факту она была соответственно 0 и 10 Мы считали на дно получилось другое мы на это не влияем это не наша зона ответственности и вот это вот различие данных мы для себя выделяем как плановые данные и фактически данные первый прирост 46 показан для фактических данных когда мы не учитываем ограничение бизнеса используем то что те данные как оно было бы на самом деле несмотря на снижение эффекта существенное снижение эффекта с 4-6 пунктов до полутора это все равно хороший результат и большие деньги это связано с масштабами нашей компании у нас даже снижение ошибки на одну десятую пункта точности уже приносят миллионы рублей Поэтому если переходить к окупаемости а именно Показатель roi то за каждый вложенный рубль мы вернули более 12 рублей То есть все железо и оплата специалистов которые были в этом задействованы окупились менее чем через полгода и теперь предлагаю немножко отдохнуть уже техники цифр и перейти к более к чему-то простому Все вы вероятно слышали про знаменитые векторы король королева мужчина женщина мы сделали что-то подобное но в рамках своего контекста мы достали скрытое представление из сети для месяцев года что мы увидели в отдельный кластер у нас попадает лето как известно это период повышенного спроса наиболее типичное поведение в рамках года и еще два кластера это период до и после него здесь количество кластеров условно и мало Для большей наглядности Аналогично мы проделали и для дней недели опять же это видно по относительному уровню продаж в субботу воскресенье продажи очень сильно проседают И это отдельный кластер следующие два кластера Это середина будней и пограничные дни между выходными и буднями возможно кому-то покажется что это очевидно Но что очевидно для человека не обязательно очевидно для машины эту задачу можно решить по-разному кластеризовать экспертно разделить или вычислить коэффициент недельной динамики но сейчас суть состоит в поиске смысловой нагрузки скрытых представлениях Давайте посмотрим то же самое для сети Здесь вы впервые имеете возможность увидеть обширность нашей географии как я говорил это большое количество регионов здесь можно отметить что магазины абсолютно из разных частей России могут попадать в один кластер это одинаковый цвет на рисунке То есть у них у этих магазинов может быть абсолютно разный уровень продаж Но при этом у них есть некие схожие паттерны например это могут быть дачные магазины двух разных регионах но у них есть в одинаковой или похожее время года одинаковые изменения потребления из прочего Можно также отметить курортные регионы из наиболее явного это Краснодарский край здесь явно выделяются кластера на побережье которые больше не представлены в остальных частях региона важно отметить что магазин является сезонным лишь В некоторой мере может быть высокий спрос может быть Ультра высокий спрос и при этом Также важно что не каждый магазин на побережье является сезонным в зависимости от цели потребности и детальности кластеров можно выделить те или другие мы пересекали данные кластера с кластерами с разметкой магазинов от бизнес экспертов и они довольно тесно пересекаются также можем Взглянуть на более знакомые Всем уже понятные по товарам когда переключится кликер кластеризация актуальна для товаров Однако более наглядно будет показать ближайший товар Мы спросили сети что самое близкое среди векторов для товаров и психолога один литр И как вы видите она ответила что это coca-cola 09 литров получается что объем все-таки важнее чем бренд после этого приоритет возвращается к этому же бренду но других объемов здесь можно отметить что фасетное свойство объем явно не передавалась модель и другой пример если кто не знает охота крепкая отличается как не написано название своей крепости и очевидным конкурентом аналогом схожим товаром это Балтика Девятка также повышенной крепости как объем данная фассетное свойство модели ни в каком виде не подавалась все что было показано из скрытых представлений было сделано преимущественно ради интерпретации Однако и кластера и ближайшие векторы и даже свечи в исходном виде можно использовать других алгоритмов мы запустили этот процесс но пока что пока что это не принесло успеха и если подытожить то что хотелось бы сказать если уделить должное подготовки проработки данных развивать архитектуру и адаптироваться под вытекающие проблемы нейросети способны работать с временными рядами и даже конкурировать с устоявшимися другими методами это рентабельно но скорее всего так будет для только для крупного бизнеса Когда как и у нас малое снижение ошибки приносит уже большие деньги стоит отметить еще раз роль важность данных и здесь речь идет не только про подготовку данных фича Инжиниринг заполнение пропусков А про их исходное качество И самое главное наверное стоит отметить достаточность описательных признаков Если вы не можете объяснить модель на том уровне на котором вы хотите осуществлять прогноз в тех условиях которых вы хотите осуществлять прогноз то здесь Стоит задуматься Ну и разрабатывая этот подход мы использовали весь опыт который нам собрали за два года прорабатывая данные поэтому рекомендуем начать с простого иначе вы не сможете понять почему ваша сетка не работает с проблема в самой сетке или самих данных если вас заинтересовала заинтересовала данная тема вы можете ознакомиться более подробно в наших статьях на хабре где описаны больше где добавлено больше деталей и про задачу и про применяемые подходы Ну и собственно Вы можете оценить наш доклад По своему опыту потому что слышал могу сказать что я очень много деталей лишил вас очень многих деталей по рассказу Спасибо за внимание и ваши вопросы Я вижу первые руки в центре зала Добрый день Алексей меня зовут Алексей такой вопрос не услышал из доклада А что вы конкретно вы даете бизнесу То есть это автозаказ у поставщиков это страховой запас Это в каком виде то есть результат бизнеса в каком виде вы даете именно прогноз в штуках до до магазина товара на уровне дня если нужно до периода мы можем собрать вы уже даже не знаете нет мы знаем что они делают но это не в рамках зоны ответственности это используется для пополнения торговых точек формирования заказа Угу Хорошо спасибо Спасибо Следующий вопрос да спасибо за доклад Прошу прощения заранее может быть за непрофессиональная формулировку вопросов а вот какой-то анализ допустим кластеризация там по типам клиентов там пенсионера там сидеть с детьми влияние каких-то внешних факторов допустим там поменялось экономическая ситуация там не полетели там за границу все Поехали на дачу там взрывной спрос в магазинах вот сам был там очереди стоишь там полчаса или допустим обратная задача все эти факторы не учитывайте что вы видите что в модели что-то идет не так и ваши точность прогноза на самом деле говорит о том что появились это факторы которые влияют на поведение которое вы не можете учитывать надо срочно их искать спасибо это можно сделать но я изначально думал что вопрос относится именно к скрытым представлениям что Ну как бы да то есть поиск представления то есть ваше отклонение по сути как бы говорит о том что вы просто какие-то параметры не учитывает те которые появились дополнительно внешние которые не от вашего магазина зависит непосредственно от того что влияет на поведение клиентов Ну вот как-то кластеризованных там каким-то может быть признаком Спасибо за вопрос пока вы уточняли я пытался вспомнить что-то из похожего либо не до конца Понял Вопрос Либо мы ничего из такого не делали То есть если меняется окружение мы под Это адаптируемся потому что мы видим изменения качества прогноза но деградирует мы ищем проблему и мы ее устраняем вот в таком формате в таком формате мы подходим но поиск у вас это ручной процесс То есть вы видите отклонение начинаете пытаться разобраться почему оно происходит что-то в вашей модели не учитывается Ну да и мы не можем сделать это заранее как я уже говорил у нас большой отступ и Допустим мы сделали прогноз Сегодня ситуация изменилась через месяц Мы уже на Прогноз который мы отдали еще до событий не сможем повлиять А когда до этого прогноза дойдет вот тот момент когда ситуация изменилась она это уже произошло мы можем сделать это только постфактум спасибо если я не ответил мы можем это позже обсудить еще раз если еще будут вопросы ловить потом спикеров дискуссионной зоне вот у нас здесь уже человек стоит Меня зовут Иван У меня таких два вопроса Первый вопрос я не совсем уловил тот момент когда вы начали говорить про деньги собственно вы рассказывали про нейронная сеть которая выполняет задачу прогнозирования А как именно получается микловской моделью вертолет но как именно там Понятно дестриктивная гипотеза двухслойная нейросеть Как вы сейчас деньги э строить товар вы как-то это нейросети и получаете прогнозирующие либо отдельная модель строится это они встроены модель они обучаются одновременно с обучением модели То есть это условно говоря скорее не Верту век а какой-то F или Элма да получается какой-то из выходов самой прогнозирующей модели берете или нет если говорить как-то происходит технически У нас есть Вектор с какими-то категориальными значениями ему сопоставляется Матрица где ее количество строк Это количество значений в этом векторе а ширина это размерность наших мэдингов Я так понимаю у вас же получается прогнозируется спрос на каждый из товаров отдельно каждый из товаров отдельно как отдельное наблюдение Но это все одна модель и она видит все товары всю географию все дни а то есть она видит все товары соответственно взаимое влияние разных товаров как-то явным образом учитывается условно говоря все товары из одной конкурирующей группы приводили пример Балтика Девятка охота крепкая что он говоря спрос на охота крепкая может возрасти внезапно потому что закончилась Балтика Девятка люди покупают какой-то альтернативу в этот момент да учитывается но они здесь Потому что учётка неметализации в наших условиях Когда у нас как количество товаров категории динамическая но не постоянное это очень сильно усложняет этот процесс поэтому у нас есть отдельный алгоритм и подход для учёта они мобилизации которые используются уже после Далее для корректировки прогнозы на ситуацию когда Балтика Девятка как-либо промотируется А охота крепкая тех же условиях исходных здесь кандизация не учитывается Ясно ну я опять немножко вернусь к первому вопросу получается у вас товары кодируются на Первом слое это уже да на Первом слоем и они изменяется и вот вы уже их интерпретируете таким образом Да именно их мы достали с сети Ну и последний вопрос если позволите вы как-то учитываете скажем так объяснимость прогноза модели в том смысле ведь бывают разные ситуации сдвига данных когда что-то поменялось и модель начинает менее уверенно работать Вы как-то в явном виде пытаетесь промолировать не только учитывать не только прогноз модели А уверенность в самой модели чтобы это повлияло на решение бизнеса о том насколько стоит доверять в данном случае сама модель уверенность в меру уверенности в своем прогнозе не дает она выдает скалярное значение точку без понимания доверительного интервала А чтобы с чем-то сопоставлять У нас есть другой подход интерпретируемый как я говорил проверены временем мы смотрим относительно него если он от него сильно отличается то он не пойдет в рамках именно как индивидуально степень уверенности в прогнозе нет Хмм понятно И последнее на этот раз спасибо У нас есть люди которые очень хотят задать вопросы ловить и потом спикера Спасибо Очень интересный доклад Скажите пожалуйста в ходе прогнозирования анализа результатов модели А в разрезе аномалии Удалось ли установить какие-то объяснить ценные для бизнеса например отклонения Ну скажем так Вот пиво с огурцами покупает по средам Вау их надо ставить вместе там совместные продажи что-то такое интересное удалось накопать и объяснить и бизнесу передать для скажем так э реализации опять же Это не совсем наша зона ответственности У нас есть коллеги из другого направления В чьи обязанности сходят вот похожий функционал нас такого нет у вас только прогнозировали Да мы из того что мы Передаем коллег это тестировались кластера которые показывал Ну в частности те которые я показывал и в других алгоритмах мы тестировали сырые в исходном виде сырые представление как фичи что-то интересное модель выдавала И вам удавалось это объяснить с какой-то точки зрения или же с точки зрения какой уровень продаж она дала как прогноз Допустим всплеск или падение чем-то объясняли но раньше вы этого не знали и смотрите если она смогла увидеть где-то действительно спрос который был который вырос То вероятно мы предоставили такую информацию как среди Если же мы как раз таки что-то не добавим она его наверное не увидит поэтому поэтому ничего такого нет я думаю она скорее человеком интерпретируется видно что здесь из-за этого больше здесь из-за этого меньше Спасибо следующий вопрос да Еще раз спасибо за замечательный доклад Вопрос такой вы говорили про увеличение точности в абсолютных значениях А можно узнать вообще насколько точно отрабатывает эта модель и Как вы считаете дошли ли вы до 700 и до какой-то то есть очень много в любом случае в будущем факторов которые невозможно учесть каких-то скрытых влияний и если впереди потенциал для бурного развития этой модели ответ на первый вопрос очень простой я не могу это сказать либо Мне нужно прямо сейчас оффер потому что иначе не буду работать Далее по поводу второе Я думаю никто никогда не знает когда вы черпали максимальный потенциал идет третий год проработки этого продукта постоянно я бы сказал постоянно меняется бизнес постоянно меняется среда в которой это все работает и проработка данных иной раз помогает не просто адаптироваться под неё и убрать снижение метрик но иногда и добавить их помимо проработки модели если еще не отходить от данных Мы со своей стороны стимулируем бизнес каким-то изменением То есть если это допустимое сокращение горизонта прогнозирования или можно оцифровать то чего ранее не было мы прикладываем к этому активные усилия И как я говорил это дает очень большой рост уже с этой точки зрения потенциал кажется еще все таки большой если мы будем адаптированы стараться взаимо адаптироваться и бизнес и т с точки зрения модели Я тоже думаю это еще не предел как мы будем развивать это дальше вопрос открытый но я думаю это еще не придет Спасибо Спасибо вот у нас есть рука здесь спереди Да спасибо за доклад очень интересно и могли бы вы пояснить вот на вход модели вы говорите есть статические Да статичные статичные статичные параметры А вот динамичная вот учитывается допустим в разных регионах разные уровень дохода населения или Можете вы на фотомодели подать прогноз инфляции какой-нибудь который Ну какие-то экономические такие параметры которые ведут к увеличению или снижению продажи главного вашего таргета Спасибо И вот разделить динамический да Вот мне интересно вот вы говорили температура влияет да и Торговая площадь Да это как бы температура она Ну динамическая площадь вроде никогда не меняется можете пояснить Вот именно что на вход модели и примера некоторые привести спасибо по поводу разного уровня продаж в разных регионах это уже среди факторов как я уже говорил есть сам Target то есть продажи из прошлого и в нем уже заложен и средний уровень магазина количество клиентов которые в него ходят благосостояние окружения глобально как во всем городе так и локально в этом районе это уже все лежит в них и дополнительно это объяснять не следует с точки зрения инфляции У нас есть некоторые подходы я прям детально не могу их описать но в частности мы это нивелируем используем неких относительных показателей в которых этот эффект например рост регулярных цен это обычные цены когда нет никакого форматирования когда они растут от этого эффекта мы избавляемся не могу уточнить как И второй вопрос Торговая Площадь статичная как статичный признак было лишь Как пример это просто что такое статичные признаки это некий метаданных они относятся только к магазину только к товару например по магазину Это его площадь Угу возможно район в котором он находится можно использовать потенциал магазина рассчитанный заранее вот что-то из этого по товару это категория бренд Можно всю подать иерархию товаров его фассетные свойства можно подать вот здесь можете уточнить что именно здесь что именно Здесь вам осталось непонятным в плане как мы их разделяем или как мы их подаем или что Нет мне просто было интересно что относится вот к статическим то я что не изменяется во времени оно будет и завтра и сегодня послезавтра одинаково и через год Ну понятно Вот допустим температура от времени года зависит да и как бы каждый раз вот обновляете ну делаете там прогнозы вот с частотой там раз в месяц Да И отдаете бизнес вот как часто вот это прогноз осуществляется каждый день каждый день и у нас есть фактическая температура уже по прошедшим дням Если прогноз отдается сегодня то мы возьмем температуру известную на сегодня будем использовать но Аналогично будет в других днях помимо этого можно использовать не только температуру важным допустим фактором еще является остатки Это количество товаров в штуках на полке и в будущем его также неизвестно потому что это собственно зависит от таргета то есть от продаж его тоже можно использовать и он когда товар приближается к 0 к остатку к нулевому остатку спрос заниженный модель это видит если мы этот фактор используем и может нивелировать этот эффект вместо восстановления продаж к некоторому уровню что-то подобное Спасибо Ну что ж наше время неспешно подходит концу Я думаю что настало пора выбирать лучшие вопросы Сегодня у нас участвует много сегодня нам нужно выбрать много лучших вопросов а у нас разве не три человека было да нет у нас три подарка человек у нас было больше так Ну последний вопрос Мне понравилось что вы пытались все максимально осмыслить и задавали уточняющие детали это Мите руку чтобы хелпиру смогли вас найти повыше желательно кейс номер один можете поднять руки кто еще задавал вопрос действительно было много людей я специально следил чтобы не получилось так так что не получится съехать придется выбирать а можно к ним подойду я дам им подарки я просто сейчас забыл я не вспомню сейчас мне бомбардировка сто процентов просто два молодых человека сидят рядом Я боялся ошибиться поднимите Вашу руку вас тоже найдут здесь молодой человек тоже задавал вопрос я думаю можно отдать ему подарок продолжайте держать руку иначе вас не найдут никогда вот там в той части зала где софит Ну что ж Спасибо за ваше внимание Спасибо за ваши вопросы Давайте поблагодарим спикера за его доклад можем ему тоже что-то передадим передадим что-то спикеру мы Спасибо еще раз Всем вам спасибо за то что вы с нами вам спасибо за ваше внимание за ваши вопросы спикером Спасибо за их прекрасные темы и мы уходим на перерыв и впереди нас ждет последний доклад Спасибо"
}