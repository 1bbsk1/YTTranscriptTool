{
  "video_id": "Tah1ubys3ss",
  "channel": "HighLoadChannel",
  "title": "Zabbix и миллионы метрик наилучший опыт масштабного мониторинга / Алексей Владышев (Zabbix)",
  "views": 29266,
  "duration": 2755,
  "published": "2017-04-07T15:13:30-07:00",
  "text": "Скажите пожалуйста а кто из сидящих сейчас в зале был на рут конфе в мае интересно Здорово Ну в общем это сегодняшние вот 2 дня В этом зале будут продолжением руд конфа Майского многие доклады будут прям логическим продолжением то есть там была завязка здесь будет конец поэтому Ну не могу коне предложить бы в ма на что было там в докладах потому что их очень мало Я думаю что вы зате просто этих людей но в целом всё будет логическим продолжением того что было тогда и как в мае первом докладом был доклад про закс Кстати кто пользуется заксом о лес рук просто как в мае был первый доклад прок в первый день так и сегодня будет первый доклад про эту замечательную систему мониторинга от создателя этой системы Алексея Влады поприветствуем Да спасибо большое это был мой вопрос кто использует закс но хорошо Да сегодня я буду говорить о том как использовать закс для мониторинга действительно больших инфраструктур да и доклад называется зак миллионы трик посмотрим Будут ли там миллионы метрик может быть даже десятки миллионов метрик А да Позвольте представиться А меня так Пытаюсь переключиться Да Позвольте представиться Меня зовут Алексей Влады в Я являюсь автором забе и работаю над забе сом уже с девяносто седьмого или девяносто восьмого года но в данный момент отвечаю за архитектуру за бекса за самые основные решения в архитектуре и отвечаю за roadmap за те фичи которые появятся А в новых релиза Ну и вообще Давайте немножко подумаем как система мониторинга обычно появляется в компании а существует наверное три пути да первый путь - это когда сами системные администраторы решают что Ну наверное так жить нельзя нужна какая-то система мониторинга нужен помощник который будет следить за теми системами за которые там Я отвечаю второй путь Такой путь сверху это когда в компании происходит допустим какая-то катастрофа с сервисами сервисы не работают и тут скажем начальство приходит и говорит Эй ребята нам нужна система мониторинга Ну опять же так жить нельзя должна быть система которая нам будет говорить о том есть проблемы у нас или нет И предупреждать об этих проблемах заранее и третий путь который сто мы видим в больших особенно компаниях это когда компания приходит к нам и говорит допустим вот на данный момент у нас 70 систем мониторинга Да и 70 - это абсолютно не предел Вот у нас 70 систем мониторинга от разных вендоров Ну это такой скажем там большой энтерпрайз там от одного вендора от второго от третьего от четвёртого но нам нужна некая универсальная система мониторинга для того чтобы ну как-то была как-то единая единая точка Да очень сложно очень сложно работать там се или с пя системами мониторинга Ну вот такие такие три способа обычно происходят вот когда такими способами внедряется систему монитори мониторинга в компании давайте поговорим немножко о заксе может быть для тех кто не знает что такое зак я быстро поясню Как зак работает ну зак чем занимается он занимается сбором данных данные собираются абсолютно различными способами с помощью различных протоколов snmp там ipm GX для приложени сбор данных происходит постоянно то есть данные собираются собираются собираются Дальше они попадают в забег сервер забег сервер является мозгом системы забег Сервер - это Тот процесс который говорит о том есть у нас проблема или нет Он занимается анализом да То есть постоянно анализирует и происходит это в режиме реального времени то есть приходит Метрика тут жем скажет или нет И и соответственно если мы видим что есть проблема тут же тут же система как-то реагирует отправляет оповещение Или например пытается тут скажем решить эту проблему в автоматическом режиме Да ну и вся информация накапливается в истории А часто возникает такой вопрос вот внедряется закс возникает такой вопрос использовать ли закс Агента или нет ну здесь есть плюсы здесь есть минусы зак Агент - это такой маленький процесс который устанавливается операционную систему Windows Linux I hpx Solaris Ну мы поддержим практически все операционные системы Ну минусом конечно является то что всё-таки за агентом Агента нужно устанавливать и за агентом Нужно следить Да в общем-то В этом заключается страх если у нас речь идёт о 10.000 серверов которые мы хотим мониторить Это значит что мы должны поставить 10.000 агентов Ну как будто бы это страшно с другой стороны у нас есть масса преимуществ преимущества такие что Агент сам по себе это маленький бинарник там 300 Кб бинарник без каких-либо зависимости мы разрабатываем критичные части закса на языке си да то есть это мы у нас очень очень эффективна Агент Агента легко расширить с помощью плагинов его расширить легко с помощью скриптов если Агент не поддерживает мониторинг каких-то метрик его достаточно легко расширить также Агента Но это самое главное преимущество мы получаем доступ к любым Метрика доступной операционной системе это там процесс метрики связанные с памятью с утилизацией там дисков с утилизацией сети и вот я попросил своих коллег посмотреть на наших клиентов и сказать мне какой процент пользователей забе тех пользователей которые мы знаем используют за Бекс Агента Ну оказывается что где-то порядка 95% оставшиеся 5% - это в основном snmp мониторинг Ну те кто вообще отказывается от зак Агента это мониторинг с помощью snmp в основном сетевое оборудование и мониторинг сервисов когда действительно компания решает что я не хочу ставить никакие агенты я буду мониторить только инфраструктуру с точки зрения юзера да то есть с точки зрения мониторинга сервисов и тогда может быть принято такое решение что агенты не использовать но в общем-то мы видим подавляющее большинство использует за Бекс Агента это наверное не так страшно и для того чтобы были понятны цифры о которых я поговорю немножко попозже я тут Введу два несколько понятий Это метрики что такое метрики в забеге они называются айтемы Да элементы данных Ну я их буду называть метрики метрики - это скажем Загрузка процессора это свободное место на диске это состояние каких-то сервисов всё это метрики это какие-то такие численные данные ну здесь могут в основном такие цифровые данные и дальше Вот как работает у нас есть условия проблем допустим там Загрузка процессора там больше пяти предположим мы считаем что система перегружено или там свободного места на диске меньше 10% мы считаем что Заканчивается свободное место на диске Ну я умышленно привёл очень простые примеры можно коне внутри ч метрики с различных узлов сети можно использовать различные условия для входа в состояние проблем и выхода из состояния проблемы можно использовать функциональность связанную с обнаружением аномалий версии 3 у нас появляется возможность предвидеть проблемы да то есть мы сможем предвидеть проблемы Но что здесь важно важно что у нас есть триггеры Триггер по сути это условие проблемы метрики и триггеры ну и там мы внедряем закс мониторим скажем там 100 хостов узлов сети через какое-то время может быть 500 там тысячу Какие тут возникают проблемы ну проблемы могут возникнуть уже на уровне скажем сотни хостов или там 200 хостов Ну наверное проблема номер один может быть многие из вас с этим сталкивались и встаёт такой вопрос как же управлять конфигурацией задача если у нас скажем 10 устройств за который мы наблюдаем Ну всё можно делать вручную там 20 устройств тоже можно делать вручную там 100 устройств если четыре руки можно тоже делать вручную да А так Каким образом же управлять конфигурацией в заксе есть такое понятие как шаблон шаблон - это набор параметров для мониторинга набор метрик и набор соответствующих триггеров предположим хотим мониторить Linux сервер мы готовим шаблон для мониторинга Linux сервера там template Linux там идёт прямо из коробки тут же мы начинаем мониторить процессор диски а сеть там ну всё что угодно нам нужно мониторить приложение например mysql опять же мы используем шаблон mysql и мониторим соответственно mysql количество транзакций в секунду там не знаю состояние репликации может быть размер различных Table Спей сов Ну всё что угодно всё что относится мою ске Казалось бы здесь всё всё хорошо но опять же мы говорим о таком большом мониторинге в большом мониторинге очень частая проблема Когда у нас есть как будто бы одинаковые устройства Ну вот три Linux Linux серверы первый второй третий их три штуки с одной стороны они одинаковые с другой стороны если мы присмотримся к ним более внимательно Мы увидим что всё-таки они отличаются Да на одном есть там три файловых систем на втором там сколько два две файловые системы дальше там четыре файловые системы Казалось бы всё это Linux Да и можно использовать там шаблон Linux а с другой стороны Ну может быть не совсем можно его использовать Потому что всё-таки эти устройства разные разное количество файловых систем разное количество сетевых интерфейсов там скажем CPU Core ядер процессорных и мы хотим мониторить там утилизацию по ядрам процессора да что с этим делать Ну такое решение в лоб мы просто готовим разные шаблоны вот для таких разных классов устройств у нас появляется там шаблон для мониторинга линуса номер один там номер два номер ри нуно это Никаким образом не скели да то есть ну можно тут запутаться очень быстро в заксе есть решение которое называется низкоуровневое обнаружение или lld там Low level Discovery Да если вы смотрите официальную документацию на английском языке Это называется L а низкоуровневое обнаружения Что это Что это такое Это обнаружение объектов обнаружения ресурсов на уровне устройства если это сетевое устройство там скажем это может быть сетевые там порты да если это операционная система то это могут быть диски файловые системы пользователи процессы сервисы приложения всё что угодно и в случае если мы используем низкоуровневое обнаружения у нас может быть всего лишь один да один шаблон с одним правилом обнаружения и вот это правило обнаружения она оно найдёт автоматически оно поймёт что у нас есть там три файловые системы на Первом сервере Там две файловые системы на втором сервере и четыре на третьем сервере и поэтому действительно вот если иуе слышали Что такое низко уровне обнаружение пожалуйста потратьте своё время Изучите этот вопрос действительно эта функциональность очень сильно помогает в управлении конфигурации в упрощении в упрощении конфигурации закса низко уровне обнаружения или lld соответственно опять же у нас очень большой парк серверов опять же они как бы одинаковые но чуть-чуть разные мы используем всего лишь один шаблон вместо может быть десятка или сотен шаблонов дальше вопрос второй масштабирование 10 узлов сети а там 500 1000 там 5.000 в какой-то момент мы упр в определённые лимиты и здесь я уже начну может быть приводить примеры компания liel networks Да это один из крупнейших синов в мире ну конкурентов конкурентом networks является допустим да Вы знаете эту компанию и в общем-то инфраструктура очень распределённая больше 80 точек доступа во всём мире раздают больше оного рабита в секунду трафика наружу Да это не весь трафик который там генерируется внутри Это только выдача выдача наружу Network использует и онр всего своего оборудования это сетевое оборудование и и серверы 25000 хостов Да 25000 хостов опять же я уже говорю что они разнотипных приложений каких-то критичных метрик и как это расшифровывается Ну 25000 хостов у них конкретно 6 млн метрик различных метрик и 3 л триггеров 3 мл триггеров то есть по сути один забег сервер он в режиме реального времени способен обнаруживать 3 млн различных проблем Ну достаточно достаточно неплохо Да и производительность закса порядка 7500 проверок в секунду напомню что производительность закса Ну мы Мерим наверное не количеством узлов сети потому что мы можем мониторить не знаю Там миллион узлов сети на каждая одна Метрика и мы эту метрику проверяем не знаю там скажем раз в год да то есть как бы миллион узлов сети тут нам не даёт никакой информации А вот количество проверок в секунду проверок производительности доступности в секунду - это некий показатель скажем Как быстро работает закс как быстро на обрабатывает информацию 7500 проверок проверок в секунду да и это распределённый большой распределённый мониторинг с использованием 90 прокси ну скажем 45 прокси в Live и 45 в standby режиме то есть на самом деле в лаве всегда 45 45 прокси 45 таких Кейв за которыми мы следим распределённой мониторинге Я поговорю немножко попозже на другом примере и что такое прокси я поясню это тоже попозже размер базы данных опять же с этой проблемой мы все сталкиваемся база данных растёт она начинает тормозить что с этим делать Ну сначала наверное стоит посчитать то есть посчитать А какого размера у нас будет Да И вот одна проверка результат одной проверки занимает порядка 50 байт то есть 50 байт результат одной проверки в случае в случае этой компании Ну они собирают примерно 26 ГБ информации в день Это 26 ГБ информации в день и на данный момент хранят порядка 2 траб истории скажем э конкретная компания не использует историческую информацию для каких-то долгосрочных отчётов история хранится вот тенденции Да агрегированная информация хранится не дольше не больше скажем 6 месяцев насколько я помню и история как она есть хранится не не более дву месяцев Да поэтому у нас получается примерно 2 траб исторической Информации а дальше что выбрать и тут часто часто такой случай когда когда у нас начинает что-то тормозить мы смотрим по сторонам если у нас был mysql мы читали что скажем постгрес он работает быстрее а давайте-ка может быть смиг на постгрес и это будет решение проблемы или наоборот Мы сейчас сидим на постгрес у нас начинает что-то подтормаживает вот совсем недавно там Oracle сказал что myq 57 в три раза быстрее чем 56 А давайте-ка смиг на mysql да во-первых какие backend жины можно использовать это My это pog Oracle db2 и в основном конечно битва здесь между маслом и постгрес что же выбрать My или pog ну должен сказать что выбор по скорости Ну он не самый важный на самом деле вот ну 2 года назад это возможно немножко устаревшая информация но 2 года назад мы действительно всё хорошо протестировали Оказалось что в случае применения закса с базой данных разница с порядка где-то там 5% была я не знаю как на данный момент но порядок примерно 5% соответственно при выборе базы данных Ну наверное мой совет такой нужно смотреть на то что мы лучше что мы лучше знаем да где наша экспертиза если мы знаем лучше myq мы знаем как готовить My Как делать там иу работать с постгрес сом используем постгрес это не стратегический вопрос Это не вопрос Новика всегда Можно перейти с одного энна на другой и мы на самом деле участвовали во многих проектах когда не знаю клиент заказчик просил нас а давайте-ка с мала мигрирует нас просит с постгрес на myq либо с Мала на orac либо с окла на My Да всегда можно эти данные сконвертируйте ческое решение Скорее это больше такое тактическое решение вот опять же я попросил коллег посмотреть на наших больших пользователей у которых как минимум миллион метрик как минимум терабайт истории и задать и посмотреть какой базой данных они пользуются Ну на третьем месте очевидно это поря 5% если у нас сейчас нету допустим or db2 Ну сложно наверно ну сложно людям объяснить что мы должны платить там большие деньги для того чтобы у нас был и Oracle db2 плюс Ну это требует квалифицированного персонала А дальше как вы думаете кто на первом месте Кто на втором вот на первом месте Кто думает что на первом месте Ну например пос Да а кто думает что на первом месте myq да Ну на самом деле действительно на первом месте My esale Да My 80% пользователей у которых больше одного 1 милна метрик и больше терабайта используют mysql Ну я должен сказать это не означает что mysql лучше чем постс Абсолютно нет да Это скорее просто отражение Ну ситуации на рынке в какой-то степени Да потому что myos Scale он более распространён постгрес менее распространён Так что на эти цифры можно смотреть Но с другой стороны если вы действительно хотите использовать пог пожалуйста Используйте То есть тут проблем никаких нет дальше проблема управления данными Да мы тут уже говорили ну скажем там не знаю 2 ТБ данных Ну достаточно много Конечно же для этого нужно использовать наверное более-менее такое хорошее железо для того чтобы база справлялась ра и основная проблема заключается в том тут что таблицы исторически растут они вырастают до Ну терабайтов они вырастают до терабайтов уже как-то не плохо кэшируется памяти у нас там меньше на сервере базы данных соответственно всё начинает как-то там очень сильно подтормаживает партиционирование держать всю историю в какой-то одной большой таблице мы делим эту таблицу на на партиции да храним историю сентябрьское в сентябрьской партиции куске базы данных Да Октябрьскую в Октябрьском куске Ну и ноябрь где-то В отдельной партиции Ну вот сегодня 2 ноября Да если у нас есть патинированная таблица Это означает что в ноябрьской партиции данные только д да там 1-2 ноября соответственно эта партия очень маленькая размер размер её полностью влазит в память работа с ней очень быстра этот B3 индекс который не так быстро работает Если он он не полностью в памяти да такой ситуации уже нет соответственно Вот партиционирование - это отличное решение партиционирование у нас есть и партиционирование оно нам приносит А таких два больших плюса во-первых производительность производительность увеличивается на порядке да А и второй плюс этими данными очень легко управлять этими терабайта может быть десятками терабайта очень легко управлять если нам не нужны старые данные мы просто удаляем партиции эта операция занимает Ну буквально там не знаю несколько секунд дальше а что если хостов ещё больше да то есть мы посмотрели пример 25.000 хостов как бы вроде бы всё хорошо что если хостов больше и приведу другой пример Кто знает что такое компания ан Да но Многие знают нун - это та компания которая по сути управляет инфраструктурой интернета вот если там не знаю Большие дяди придут и скажут давайте-ка Выключите интернет вот в компанию Ian Ian выключит интернет ican управляет DNS DNS серверами DNS - это Secure DNS она отвечает за выдачу доменных имён То есть по сути управляет этим процессом и работает с регистрами Да регистра - это те компании которые регистрируют уже ну там домены там под там ru.com и так далее соответственно для Акана очень-очень важно как насколько э предлагаются насколько хорошо ВС это работает и качественно работает от этого зависит работать с этой компанией в этой стране с этим регистрам или не работать компания также использует зак один зак сервер мониторинг 60.000 хостов 6 хов расши и 20 мил триггеров здесь интересное соотношение количества метрик и триггеров достаточно необычное то есть одна Метрика порядка де де триггеров с чем это связано Это связано с тем что каждая Метрика в основном это такие бизнес метрики да В основном это бизнесмены с тем скажем Насколько быстро допустим домен который мы зарегистрировали у регистра появляется в акане Да Насколько быстро он появляется в DNS серверах ан опять же отвечает за Root DNS сервера если с R DNS сервером что-то происходит Ну Будьте уверены что на самом деле закс об этом уже знает да но в любом случае и 10 триггеров на одну метрику соответственно каждая Метрика анализируется с каждых сторон вот этих условий анализа очень-очень много это 20 миллионов триггеров 6Б 40 прокси на самом деле система уже в продакшене 2 года объём растёт и когда вообще полностью вся инфраструктура будет монитори заксом то объём будет порядка 12 сся хостов да мы находимся примерно примерно сейчас в середине процесса Ну и производительность закса в этом случае опять же это средняя производительность да средня то есть мым вычисляем средне за средняя производительность закса 21.000 проверок в секунду дальше автоматизация Да liel networks I как они могут жить вот с таким большим количеством не знаю агентов с таким большим количеством хостов Но это фактически Нереально без определённого уровня автоматизации да И тут я напомню какие методы автоматизации существуют в заксе это такой достаточно простой сетевое обнаружение когда мы сканируем сеть находим сервисы и начинаем мониторить эти сервисы Да можно его использовать смело сетевое обнаружение дальше авторегистрация - это немножко другой способ когда Новый объект мониторинга говорит о том что вот я появился А давайте-ка меня мониторить да то есть зак Агент первый раз на новом снова устройства подключается к зак серверу и говорит Вот я новый зак Агент и Вот мои метаданные то есть мы можем передавать любые метаданные и с помощью этих метод данных забег сервер понимает а что это за Агент что это за устройство что я должен мониторить Каким шаблоном я должен привязать вот этот вот Новый объект допустим в моём случае это там Linux mysql и тут же мы понимаем О это Linux привязываем к шаблону линуса там бежит myq отлично мониторим My там бы ещ eng привязываем к шаблону NG X всё это начинается автоматически монитори конечно же лучший способ - это когда у нас в компании есть Ну некий регистр Да в котором прописана вся конфигурация И что это может быть Ну тут решений очень много configuration Management сист их полно да появляются постоянно новые становятся они менее популярными более популярными там CF Engine Кто у нас ещ конечно же и configuration систе они нам значительно упрощают жизнь да но это просто ма это нужно нужно иметь что они нам позволяют делать во-первых они автоматизирует деплоймент агентов для того чтобы задеплоить там 10.000 агентов Ну это делается Элементарно если мы используем conf систему это раз управление конфигурации тоже самое появляется у нас новое устройство configuration система понимает что это за устройство и соответственно мы понимаем Какие шаблоны для мониторинга нужно использовать Да в общем-то тут всё просто мы автоматически с помощью AP то есть configuration система с интегрирована с с помощью AP говорит у меня появилось новое устройство там не знаю там пожалуйста Используй вот такие-то шаблоны всё да то есть автоматизация должна быть без этого достаточно сложно справляться с таким крупномасштабным мониторингом дальше распределённый мониторинг я уже говорил такие слова Как скажем там зак прокси распределённый мониторинг Теперь может быть Посмотрим на другом примере Как это сделано Ну розничная сеть Магнит да Вы наверное знаете эти магазины заулыбалась вот урочная сеть Магнит да по дороге аэропорт отель я увидел наверное три или четыре таких магазина а используется несколько забив для мониторинга гипермаркетов э один закс - это порядка 350 гипермаркетов мониторит всё оборудование М это порядка по-моему 30 или 35.000 узлов сети но я поговорю о другом заксе о том заксе который будет использоваться для мониторинга универсамов их намного больше наверное в районе 10.000 может быть больше это 200000 200.000 узлов сети Да 200.000 узлов сети это А что такое узел то есть 200.000 Да 200000 хостов и в общем-то тут будет исполь 11.000 прокси по количеству по количеству магазинов 5 млн метрик 2 млн триггеров истории будет Ну как минимум 5 ТБ то есть на данный момент это система Ну тут я не могу какие-то все детали рассказывать да что я могу сказать Что На данный момент система в пре продакшн состоянии она Скоро пойдёт в прокш буквально Ну очень-очень скоро да соответственно производительность закса Ну ориентировочная производительность закса будет порядка 20.000 проверок в секунду и теперь давайте поговорим как раз о распределённой мониторинге Как решается эта проблема И вот просто на примере магнита вот скажем появляется новый магазин А что в магазине мы следим за состоянием там не знаю сети допустим за состоянием устройств за состоянием кассовых аппаратов там пов каких-то какого-то оборудования Ну если мы вернёмся назад мы увидим Да что у нас 200.000 хостов и 5 млн метрик то есть на один хост приходится Ну в районе наверное 20Д метрик Судя по всему это такие Ну достаточно небольшие достаточно небольшие устройства Да появляется новый магазин Да существует некий такой реестр Да регистр Где хранится вся конфигурация процесс Ну полностью автоматизирован появляется новый магазин он он он прописан в реестре что дальше происходит автоматически устанавливаются прокси Что такое прокси прокси - это такой процесс который занимается удалённым мониторингом да то есть мы устанавливаем прокси в удалённой сети и прокси соответст мониторит собирает данные из этой удалённой сети и передаёт их на главный забег сервер для анализа да Вот соответственно мониторинг магазинов организован следующим образом один магазин один прокси прокси отвечает за конкретный магазин занимается вот этим вот мониторингом и вся эта информация в заксе появляется автоматически у нас есть вот этот вот реестр как только мы знаем что ну При таком количестве магазинов 11.000 наверное магазины открываются чуть ли не каждый день да может быть даже по несколько магазинов соответственно появляется магазин с помощью зак меняется конфигурация закса устанавливается устанавливается прокси и и и и в общем-то заби тоже начинает мониторить этот магазин дальше опять же я не знаю там сотни тысяч устроить там десятки тысяч устроить А как же перейти на новую версию Z При таком масштабном мониторинге Казалось бы это является такой большой проблемой но оказывается это не очень не очень большая проблема Почему Потому что ну прежде всего мы поддерживаем обратную совместимость агентов то есть вот вы Установите предположим забе 2.2 или 24 или 3.0 Когда выйдет 3.0 и он будет работать с теми агентами которые были задеплоил назад от закса 1.0 мы поддержим обратную совместимость с агентами то есть имея там 10.000 или 100.000 агентов Вам их в общем-то их не нужно трогать при апгрейде Если вы хотите конечно можете сделать апгрейды Ну получить например какую-то новую функциональность Ну в общем-то это не обязательно делать Или вы можете растянуть этот процесс по времени дальше закс при апгрейде производит автоматическое обновление структуры базы соответственно в общем-то как только мы устанавливаем новую версию збек тут же Ну мы меняем какие-то таблички добавляем поля закс понимает что Руту структура старая и он делает автоматическое обновление базы исторические таблицы мы не трогаем поэтому терабайты они остаются терабайта там никакой конверсии долго не происходит обычно апгрейды там занимает там 5-10 может быть 15 минут Ну и мы не ломаем а то есть вся та интеграция которая у вас есть а она продолжает работать конечно время от времени мы делаем там какие-то de функции какие-то depr помечать и следить Ну и может быть Сводная таблица liel networks метрики 6 млн метрик не проблема для закса скажем IC там 20 млн триггеров не проблема количество хостов и I вырастет та скажем до 160.000 узлов сети Да магнит пока не в продакшене но намечается 200 200.000 узлов сети в случае магнита Ну и какой итог здесь можно подвести Ну наверное Первое - это то что не надо бояться Да не нужно бояться этих цифр если знать как э готовить за Бекс А можно можно мониторить действительно очень большие распределённые среды также не забываем об автоматизации и высокой доступности Ну это Об этом я может быть подробно не поговорил То есть я поговорил о автоматизации высокой доступности они поговорил она у больших клиентов делается по-разному делается и ddb в основном и и на уровне базы данных и матер мае репликация в My и репликация с помощью там GT ID Global transaction ID то здесь существуют разные способы иногда используется скажем G cler тут есть различные способы Да со свои мину то есть мы тут должны выбирать Ну с помощью Linux Cor делается также и не забываем Вот это важный момент О выборе правильного железа закса при таком объёме мониторинга не стоит наверное как-то надеяться на чудо на то что вот у нас есть какой-то слабенький сервер и он вытянет весь все эти данные поток данных и терабайты вс-таки нужно понимать что е у на такой обф мы должны использовать достаточно мощное железо Ну спасибо спасибо большое за внимание и у нас на лоде наш стенд Пожалуйста приходите раздаём различные призы Спасибо большое а теперь вопросы ро сейчас Здравствуйте А вот вы говорите SQL там поре А почему не рассматриваете базы данных которые как раз для временных рядов сделаны там та Ser датабаза как раз которые должны быть для Рик более удобный реляционный это как бы не то немножко Вам приходится у вас как раз разбухают данные приходится удалять а Series базы данных то есть всё это из коробки делает типа виспера какого-нибудь А да это это та функциональность которая у нас появится мы на самом деле всё всё её обещаем Да и обещали версии 3.0 но всё-таки решили версию 3.0 не включать Судя по всему в 32 у нас уже будет а инфраструктура такая плагин инфраструктура для подключения своих дата Бей ннов и тогда конечно же там я не знаю используем вы сказали там visper или используем не знаю например там какой-нибудь inflex db да с этим проблем не будет конечно это идёт пока этого нет это будет с другой стороны такие базы данных Я может быть очень быстро скажу всё-таки реляционная база данных если она тянет почему бы её не использовать всё-таки есть достаточно большие преимущества использования а реляционной базы данных а в плане да конечно же мы там получаем возможно горизонтальное масштабирование в какой-то степени но тоже есть свои лимиты в случае реляционной базе данных у нас все данные по сути в одном месте да И когда мы работаем над процессами в своей компании Ну там Back или там резервное копирование Ну зачастую проще просто использовать реляционную базу данных Да ещё один Да тут ещё вопрос А вот вы рассказывали про партиционирование А это функция доступна из коробки Потому что раньше такого не было да да я может быть не сказал Да я сечас скажу Дело в том что партиционирование Это не функция это это то что мы делаем на на уровне базы данных соответственно существуют скрипты там можно зайти на zabor на Вики и скачать эти скрипты для партиционирование из крон таба они запускаются и по сути что они делают они создают новые партиции в будущем и удаляют старые партиции что касается из коробки начиная с версии 3.0 мы будем предоставлять официальные скрипты поддерживаемые записом для партиционирование хорошо Здравствуйте спасибо за доклад вопрос Следующий часто приходит Ну в заксе весь мониторинг построен от того что всё идёт от Хоста скажем так да нижней сущностью является но сейчас больше чаще чаще встаёт вопрос мониторинга так скажем так ну апликейшн которое может состоять из множества компонент там база данных кши какие-то очереди и так далее Все эти компоненты Дуброва там Скажем их десятки могут быть хостов иче удобно описывать какие-то зависимости между хостами или там ну как-то вот описать более высокоуровневый связь компоненты и строить триггеры в духе у нас отказало три сервера очереди это там ворнинг А у нас отказало там 10 серверов очередей это всё ну это плохо или какой-то там отказ отдельного сервера Ну отдельного определённого компонента это как бы совсем критично вот Существуют ли заксе подходы или какие-то у вас возможно планируются решения вот чтобы более высокоуровневые мониторить именно сервисы скажем так да есть функциональность которая уже сейчас существует это так называемая it сервисы То есть это мониторинг Я не знаю смотрели Вы или нет не смотрели или не понравилось Ну они не очень удобны скажем так да Дада Вот я как раз на это и хотел обратить внимание Да есть функциональность it сервисов когда мы описываем высокоуровневые сервисы некие такие виртуальные сущности Да и зависимости между этими сущностями которые в итоге привязываются к триггерам к проблемам проблема возникает и соответственно возникают проблемы на уровне сервисов они неудобны вот я действительно согласен что особенно для какого-то крупного мониторинга они неудобны в поддержке Я думаю что наше направление будет заключаться в том чтобы их сделать удобными Да чтобы минимизировать количество труда нужного для того чтобы вот справляться с it сервисами то есть скорее всего мы подм либо в этом направлении это одно из возможных направлений второе направление это скажем если триггеры сейчас привязаны к айтем и триггеры - это низкоуровневая сущность Возможно мы введём некие сущности похожие на триггеры Но более высокого уровня об этом сейчас може быть чуть-чуть рано говорить я могу пояснить Ну вот если вы придёте на стенд мы можем об этом пообщаться да то есть существует в голове несколько решений по какому пути мы пойдём ещё непонятно а есть ещё там там Добрый день спасибо за доклад А вопрос Следующий сейчас во многом идёт рассвет контейнеров в частности контейнеризации докер неважно и вопрос здесь следующий в том что мониторе хост на котором развёрнуты контейнеры мы не получаем информацию об изолированных самих средах внутри которых бегут сами приложения и вопрос здесь следующий то есть в каждый докер в каждый контейнер в принципе запихивать по Агенту Это тоже не очень удобно То есть их там может быть множество совершенно и с другой стороны у самого Агента нет функционала а каким-то образом общаться с самой системой управления контейнеризации вообще планируется какая-то вот система мониторинга возможна имплементация в зак агент или же это всё-таки нужно реализовывать самим спасибо ну на на самом Да спасибо за вопрос такой функциональности в род мапе 3.0 нету да то есть 3.0 допустим этой функциональности не будет А как это Что делают люди сейчас ну в основном Действительно это решение когда мы устанавливаем агента на каждый контейнер то есть вот у нас есть один докер мы устанавливаем туда Агента а что касается какой-то более плотной э связи для поддержки контейнеризации Ну наверное надо думать Да если пония от польва как-то улучшить вот эту функциональность двигаться в этом направлении мы будем двигаться в этом направлени Да здравствуйте Спасибо за доклад вопрос мой касается прокси в частности как обеспечивать прокси То есть если падает прося то переключение агента на другую нужно производить скорее всего руками и второе это Планируется ли перенос на проксиме костных триггеров которым не Обязательно знание тренда или Ну предыдущих значений для разгрузки непосредственно основного сервера спасибо а отвечу на второй вопрос пока не планируется Да ну есть разные мысли но пока пока не планируется Да второй вопрос был по поводу скажем переноса функциональности триггеров на сторону прокси а что касается А Напомните первый вопрос забыл failover Pro Да failover Proxy обычно как делается Ну вот я привёл пример скажем Li Light Network 45 Proxy 45 и плю 45 НБА тут просто используется по сути виртуальный IP IP остаётся тем же самым то есть один прокси падает переключение резко на на второй прокси прокси тут же подкачивает конфигурацию или мы прокси тут же можем поднимать потому что это простой бинарник мы запускаем бинарник он подключается к и оттуда берёт конфигурацию Напоминаю что конфигурация хранится на стороне забег сервера и всё если у нас IP не меняется то ничего нам не нужно переконлива и последний вопрос тут уже Ладно всё не будет последних вопросов Спасибо Алексей да спасибо большое Приходите на стенд Спасибо"
}