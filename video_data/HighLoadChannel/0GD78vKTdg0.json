{
  "video_id": "0GD78vKTdg0",
  "channel": "HighLoadChannel",
  "title": "Как мы сделали игру для HL++ с воксельной графикой / Александр Хаеров (Ingram Micro)",
  "views": 1976,
  "duration": 3358,
  "published": "2018-07-19T04:56:22-07:00",
  "text": "название доклада она уже видна на экране и самое интересное что я вас всех приглашаю обязательно зайти посмотреть на наш стенд игра майкро внизу на первом этаже как это выглядит и как это работает эта штука будет работать целых два дня и у вас будет возможность как своего лаптопа перейти так соответственно нас на стенде we are посмотреть а сегодня я собственно расскажу о том как мы и делали компьютерную игру и наверное надеюсь что у вас появится дополнительный интерес самим в этой отрасли что-то сделать попробовать или хотя бы узнать как она работает и так поехали на самом деле сложность доклада она низкая на мой взгляд то есть это фановый доклад поэтому здесь вы расслабитесь посмотрите получите удовольствие поэтому будем считать что это выглядит вот так на самом деле хотелось бы мне начать вот с какой мысли я очень часто разбирая почту смотрю заголовки новостных лент и там вот разные разные новости мелькает один раз я видела такой заголовок собственно кто такие инди-разработчики и почему-то у меня зацепил я решил почитать эту статью открыл и там было очень много цифр буков и статистики ну тем кто не знаком с понятием индии и инди-разработчиков фактически это люди которые не имеют специального бюджета у них нет издателей и они творят игра как правило они не обременены рамками сценария не обременены соответственно какими-то шаблонами поэтому у них получается довольно интересные игры фильмы и прочее так вот что я заметил за этой статистики запомнил вот решил добавить презентацию что 97 процентов этих людей таких мифических инди-разработчиков от мужчины 60 из них нет на самом деле не одиночке они делают игры игры в одиночку ну и наконец среднем чтобы сделать инди-игру требуется от 1 до 3 месяцев вот мне показались факты забавными потому что мы так получилось что дети стали делать игру и сейчас я представлюсь австрия зовут александр хаиров я руковожу отделом разработки в компании игра майкро вас есть классный стенд приходите мы расскажем чем занимается компания и мне в этом помогала классная команда ребята который тоже работают наши компании я собственно не буду сейчас называть но вот так вот они выглядят еще эти ребята они не считают себя крупный и классной командой инженеров они называют себя вот так вот ну как бы вполне я думаю заслуженно я наверно хочу начать с того почему в принципе начали делать игру и откуда все это появилось тут ну очевидно что побуждающим главным мотивом было создание стенда на холод очень хотелось различия аудиторию вас ваших друзей коллег соответственно и сделать что-то новое и интересное когда вы мне поступило такое предложение поучаствовать от компании в хайло audi да ну я с радостью согласился и собственно вот возникла такая мысль но наверное привет перед этим меня всегда нравились игры от собственный сервис и реддит я думаю вы с ним знакомы такое большое сообщество идут я хочу немножко детальнее остановиться на нем дело в том что выйдет он каждый год создает социальный эксперимент они так это называют хотя на самом деле различные игры для сообщества в этом году они тоже сделали определенные социальные эксперименты проходил он как всегда в начале апреля или на день дурака как еще называют суть игры было достаточно интересная разработчики реддит сделали такой канву скажем такой такую картину из 1000 на 1000 пикселей и каждому зарегистрированному пользователю на рейде то их большое количество несколько миллионов предлагалось закрасить один пиксель этой канавы каким-нибудь цветом из палитры палитра достаточно широкая было и это можно было делать раз в пять минут соответственно у вас раз пять минут появлялась возможность нарисовать одну точку на экране и соответственно это мероприятие продолжилось 72 часа и вот так вот собственно происходила эта игра это ускоренная соответственно демонстрация люди создавали различные картинки боролись между собой перекрашивали различные пикселы некоторые страны объединялись некоторые сообщества объединялись люди договаривались и делали совместную работу в конечном итоге вот такой получилось интересное по но и люди даже из него сделали пазл кто-то shell носки с таким вот орнаментом там подобное но все самое интересное то внутри для технаря потому что игра она привлекла огромное количество людей и в первую очередь интересно технически нам потому что в ней по участвовало более миллиона человек это 1000000 зарегистрированных может быть уникальных пользователей а с другой стороны до 90 тысяч человек одновременно закрашивая пиксели ежесекундно ребята на реддит и подробно рассказали как они делали технически эту игру и мне очень понравилась сама идея что можно вовлекать в такие массовые онлайн игры людей пускаюсь простым геймплеем и это наверное было главным вдохновлением почему бы нам не сделать именно онлайн игру это было именно второй фактор ну и вообще я считаю что игры они полны веселья и я уверен что вы либо давно либо даже сейчас я уверен играйте в разные игры от приносит вам удовольствие ну и наконец я занимаюсь разработкой веб-сервисов и различных м т м сервисов когда сервер и общаются серверами это на самом деле очень важно ответственно но порой немножко скучно поэтому новый девелоперский опыт он всегда был бы интересен я думаю и вам и нам в том числе я сейчас с ним как раз поделюсь забегая вперед скажу что мы действительно узнали очень много нового и интересного ну скажем так про геймдев не имея при этом никакого опыта изначально и так немножко об игре мы с ребятами собрались и решили набросать но какой-то скелет идеи о чем можно сделать игру сначала мы решили идти из козырей решили давайте напишем классный фьючерс какие-нибудь однозначно была и хотелось сделать мультиплеер но когда мы говорим о мультиплеере сразу стоит понимать что ведь если вы включаете любимую приставку и ваш экран телевизора делится на две части где есть плеер wan ip лишь ту это значит что это тоже мультиплеерная игра мы решили что пускай она будет сетевая и еще и массовое а вторым фактором мы выбирали графику сначала вообще хотела сделать 2 до игру потому что мне показалось не имея опыта это заметно проще вы просто рисуете делайте простую физику и тому подобное но на меня давил команды она сказала ok давайте будет 3d графика ну и наконец мы понимали что без какой-нибудь переоцененный перейдут и технологии ну невозможно сделать успешную игру поэтому мы решили нам нужно взять хайпа вую технологию ему окей пускай будет виртуальная реальность вот вот так у нас образовался фичи сет без какого-то геймплея идеи мы просто решили будем делать обязательно вот эти штуки ну подумав примерно недельку мы решили что нужно как-то ограничить свой свои собственные хотелки и решили что давайте сделаем небольшой компромисс и ну нам не хотелось писать на самом деле отдельного клиента и мы решили что игра будет браузер на тем более мы слышали что браузеры стали но очень современными очень мощными позволяет делать 3d графику вторым важным фактором явилось то что мы являясь инженерами конечно же стремимся к прекрасному но графике мы имеем посредстве на и отношения поэтому идея использовать маленькие voxel и или такие блоки для того чтобы создавать весь мир и конструкцию нам показалось собственно некой панацеей вообще что такое voxel нужно понимать воксель фактически это пиксель но в трехмерном мире то есть наверное вас всплывает в голове собственно много всяких разных идей и мыслей относительно например игры майнкравт диммер приставленного к силами мы решили что пойдем примерно по такой же стратегии ну и наконец мы решили что мир он не будет у нас бесконечной хотя я уверен что вселенная бесконечна и и решили ограничиться размерами мира тысячи на 1200 вокселей тем самым немножко упростить для себя техническую особенность игры на этом мы разошлись на некоторое время и в дальнейшем мы уже решили разговаривать по делу в частности обсудить геймплей и правила кажется что геймплей это очень простая вещь но вы быстро представляете как играть в starcraft или в игру doom или quake когда вы создаете свою игру у вас огромное количество идей эти мысли разлетаются в разные стороны и очень сложно особенно в команде договориться о том как игра будет выглядеть и что там будет происходить этот процесс нас не был линейном мы не смогли сразу определить тем не менее для вас есть финальная версия наших правил а выглядит она достаточно просто вам нужно найти spot на этом спать и будет флаг с потом выступает какое-то здание именно поэтому игра называется urban то есть городская дальше вам нужно этот флаг захватить ну и в конце концов у вас будут идти баллы за то что вы захватили флаг по результатам вы сможете получить приз то есть кто больше очков набрал тот соответственно и получит приз как приз на вас очень классный приходите и узнаете что за приз игроки могут свободно перемещаться по общему миру и перри захватывать свои флаги это такая вариация крепче за флаг вот ну на этом мы определились со всеми менеджер скими функциями решили делать архитектуру так как мы сдаем enterprise продукты мы решили начать с enterprise архитектуры нашей игры мы подумали так ну у нас будут однозначно игроки еще у нас будет специальный стенд для того чтобы поиграть в шлеме виртуальной реальности и так как мы решили что это браузерная игра у нас будет браузер и все эти люди будут приходить и получать оттуда данные ну и так как игра у нас многопользовательской посети нам нужно где-то хранить данные разных игроках поэтому нам нужно кормить хранил к соответственно объединив браузер и хранил q мы сделаем игру но это была изначальная схема архитектуры достаточно наивно и вот теперь попробуем разобраться как должна это хранил к общаться с браузером где собственно работает игра вот тут наверное начинается интересные моменты я бы хотел вас отвезти в более знакомую для нас и я думаю что для вас от область вообще проблема распределенных систем и репликации она достаточно хорошо изучена и ежедневно используется в нашей отрасли но игра она любая игра особенно сетевая она представляет собой такое типичную не типовую ситуацию репликации когда вам нужно обеспечить репликацию только лишь потому чтобы игра случилось то есть если у вас нет действительно репликации распределенной системы и связанности согласованности между игроками то игру можно завершать да потому что она просто в нее невозможно будет поиграть вот и мир он на самом деле придумал как минимум или выделил два вида репликации это соответственно активная репликация когда вы непосредственно берете от одного клиента и передаете данные всем остальным игрокам например рассылаете информация о том что этот игрок захватил флаг а на других клиентах у вас происходит точно такая же анимация те же самые события тому подобное с другой стороны есть альтернативный вариант он называется пассивной репликации в данном случае игрок отправляет данные на некий сервер в моем случае от некой шестеренки и уже этот сервер обеспечивает пересылку данных соответственно всем остальным игрокам попробуем разобраться в чем здесь соль что лучше хуже вообще есть ли разница между активной и пассивной репликации в активной репликации я думаю все очень просто и понятно берем отправляем всем другим игрокам получаем от всех других игроков информацию просто интуитивно понятно вторым важным моментом кажется что это система достаточно эффективным действительно вам нам не нужно никакое дополнительное устройство в виде сервера который будет принимать данные наверное обрабатывать их передавать другим игрокам и тому подобное но здесь есть огромный минус дело в том что система построена на активной репликации очень хрупкие достаточно появлению некоторых сетевых проблем потерь задержек или проблем с клиентами у нас получается полностью несогласованная система той синхронизация ломается и происходит абсолютно разное а наша задача иметь одинаковый общий мир и на самом деле выйти из ситуации со сломанной синхронизации достаточно непросто для этого существует различные протоколы тампакс с например или еще что то но все незаметно усложняют простую схему активной репликации и соответственно требует времени вычислительных ресурсов для примера могу сказать что игра starcraft классическое построен на активной репликации один из явных примеров использования простой но достаточно хрупкой модели именно поэтому когда появляются определенные проблемы в синхронизации тогда игру как правило приходится завершать и начинать заново в отличие от этого пассивная репликация она на самом деле очень стойко десинхронизации то есть если что-то произойдет не так у нас есть специальное устройство сервер которая может выступить третейским судьей и соответственно привести систему в конце asus норму вторым моментом и низ и наверное на мой взгляд даже очень не недооцененным и важным является безопасность игр не знаю слышали ли вы но недавно появилась игра это кстати говоря принципе прямой аналог игры place at рэддит который назывался вики пиксель там тоже можно было разрисовывать доску и вот эту игру взломали в ч нескольких часов и зачастую в играх безопасности очень сильно недооценена и вообще обеспечения безопасности вот в пассивные модели безопасность игры заметно легче обеспечить по той причине что опять таки у вас есть сервер где вы можете достаточно много всего контролировать ну и наконец не бывает одних плюсов без минусов с появлением вот этого сервера устройство которое принимает отправляет данные нас возникает классическое как бы . отказа если мы не применяем каких-нибудь специальных средств например для того чтобы его как сортировать разделить на какие то соответственно но ты-то мы можем потерять всю игру путём выхода из строя сервера мы не долго думали и как и все современные игры выбрали пассивный способ репликации а на самом деле сейчас но быта вля ющие большинство игр про к 99 процентов те которые вы знаете и которые наверное не слышали и не играли они используют пассивную репликацию поэтому на нашей мощный enterprise архитектуре появился еще один компонент и мы его назвали game бэкенд который будет на себя собственно брать задача синхронизации а теперь немножко поговорим о хранил ки дело в том что к выбору хранилищем и достаточно относились скажем так без должного внимания как это принято в некоторых кругах для того чтобы понять в чем нам хранить данные нужно понять как эти данные представлять потому что наверное это наиболее важный вопрос который определяет те или иные критерии давайте посмотрим структура данных которое возможно в нашем в нашей игре в которой очень много вокселей и ограниченный мир но мы можем взять всю информацию о кубиках voxel ах и хранить в обычном пустом таком линейном большом массиве это очень простой и понятный я думаю тоже способ его основным преимуществом является константной а запись и чтение соответственно в ячейку да то есть мы можем спокойненько получить информацию о воксели это потребует константное время в действительности очень много современных игр в том числе майнкравт стартовал именно такой модели она себя показал достаточно успешно минусом здесь является большое потребление памяти дело в том что наш мир соответственно растет в трёх измерениях поэтому количество необходимой для хранения этих данных она заметно возрастает нелинейная соответственно координатам мира и эту проблему можно решить например помощью кто деревьев мы не будем сейчас вдаваться что это за штука такая акты деревья предлагаю для понимания просто посмотреть на эту картинку вот у нас есть некий трехмерный мир представим ее виде большого куба этот куб например можно разделить на четыре части окна и эту каждую часть также можно делить на 4 секции и благодаря этому механизму мы соответственно можем очень сильно экономить области в которых у нас отсутствуют данные тем самым мы можем сильно сэкономить на соответственно хранение нашей структуры здесь явно есть плюс да это более скажем так выгодно с точки зрения хранения структура и минус он не очень очевиден изначально но быстрая вылезает из практики дело в том что нам нужно использовать различные каши и как правило все кто пробует использовать акта деревьев том числе например в играх типа майнкравт они часто жалуются что это заметно работает медленнее чем обычные массива ну и наконец есть третий вариант я бы его назвал компромисс нам мы можем взять такой же обычный линейный массив и разделить его на чанки на некоторые области равномерные и это нам даст определенные преимущества вы например сможем в отличие от обычного массива подгружать отдельные блоки нам не нужно загружать целый целый мир одному пользователю мы можем загружать только ближайшие от него блоки но у него есть определенные минусы то конечно же усложняет в принципе все модель обычного массива потому что нам нужно хранить какие-то ссылки на эти чанки оперировать этими танками добавлять эту логику в наш frontend игры и тому подобное мы решили что последний вариантом наиболее оптимальна для нашей игры и выбрали соответственно его вот после чего выбор хранилище он для нас прошел как-то незаметно мы решили киевской ты будет манга я бы сейчас не хотел разводить крытых холивар там или что то еще да на эту тему я уверен что в на многих прекрасных других базах данных это тоже можно реализовать однако мы имеем небольшой опыт с ней и решили остановиться для экспериментов продолжая тему важным моментом стало протокол взаимодействие между frontend им ибо kindom у нас есть некая структура у нас есть клиенты наверное у нас появится какой-нибудь браузер в котором это будет отображаться но как передавать данные между хранилищем и соответственно игрой тут стоит поговорить немножко протоколе как мы уже знаем наш мир он представлен в виде такой такого квадрата скажем тогда 1000 на 1000 сторон и высотой 200 можно проигнорировать высоту и всегда использовать максимальную высоту выгрузки это сильно упрощает собственное создание игры в свою очередь каждый такой вот квадрат мы его разбили на чанки как соответствии с нашим стандартам и каждый чанг из себя представляет 32 voxel внутри вот по как мы уже выяснили мы решили использовать мангу в манге мы храним voxel и достаточно просто мы используем для этого обычные документы внутри документ выглядит примерно так это соответственно служебное поле айди координаты название цвета игрока паштет также может быть выбран это некое служебное название дат когда соответственно этот блок появился теперь у нас собственно появилось 2 как минимум задачи вот мы направляем куда нибудь игрока например рождается в мире вот в этой точке для этого мы определяем ближайшие чанки который он может видеть формируем ну но мы называем это радиус на самом деле не совсем корректное название мы формируем понимание расстояние понимаем как какое количество чанков собственно это затрагивает и делаем запрос get в котором мы говорим текущую координату игрока и соответственно некий range мы еще называем радиус квадратный радиус соответственно к базе данных и делаем такой запрос вторым действием мы можем сделать сет это создать блог или кубик на соответственно карте здесь достаточно просто отправить координаты кубика который мы хотим установить этот это такие прямые запросы в наше хранилище в обратную сторону мы можем наблюдать запросы об обновлении прочих кубиков в данном случае речь идет о том что находясь в мире и получив некоего изначальное состояние вы же хотите наблюдать новые кубики которые создают другие пользователи для этого мы подписываемся на событий и соответственно получаем сообщения типа ап дэй в котором мы просто присылаем все кубики которые появляются в игре ну и наконец мы хотели добавить немножко интерактивности в игру и поэтому добавили специальное сообщение об активности пользователей когда кто-нибудь зашел в игру или вышел или перехватил тот самый флаг который позволяет нам получать очки вот так у нас сформировался примерно протокол взаимодействия у нас не было очень много выбора тем как мы можем общаться между бы kindom и фронтэнда на выбор у нас было еще теперь протокол на могли использовать websocket или each step 2 вырежьте решили остановиться на websocket их по понятным причинам для того чтобы интуитивно уменьшить задержки потенциальной которые нас возможны также мы подумали что было бы неплохо получить какие-то результаты об игре например стались кто вошел в игру какие там очки для этого мы сделали отдельную вьюшку которые прикрутили к фронтэнда и соответственно решили использовать для нее еще типе чтобы не делать авторизацию не усложнять весь этот процесс и так у нас сформировался такое определенные уже стек в архитектуре и как бы скажем ключевой точкой взаимодействие в нем стал выпсуке вот а теперь поговорим про backend бэкенд ну наверное его как минимум можно назвать сердце нашей системы и так как мы имеем определенные опыт в разработке мы решили не использовать их то новых технологий для нас неизвестных мы остановились на python мы использовали python 3 6 и использовали а я уж цепи то есть это полностью получился синхронный сервер к нему мы использовали измененный клуб соответственно это и вилок который позволяет еще быстрее работать так как мы используем мангу и определились этим достаточно быстро нам нужен был какой-то синхронный клиент для этого мы использовали мотор который прекрасно соответственно позволяет общаться с мангой в синхронном режиме ну и наконец для того чтобы ставить наш сервер наружу мы использовали джею не корт который я думаю тоже извесен который разрабатывает на тайтоне у нас такой получился вполне традиционный стык который позволяет обмениваться по нашему обозначенному протокол а теперь наверное самое интересное то изюминка это собственно frontend да это как игра начинает жить и существовать у нас первую очередь стал вопрос каким образом мы можем написать игровой движок вообще как делать игры и как это все работает после недолгого изучения материала было понятно что существует библиотека в цель которая позволяет очень многое она работает библиотека пейджер который уже в свою очередь работает с оборудованием с драйверами видеокарты и тому подобное поэтому была первая мысль использовать обычный нативный java script посмотреть какой и 5 предоставляет в цель начать делать игру эту идею мы достаточно быстро отмели потому что по своему опыту web-разработки мы понимаем что разрабатывать самому веб-сервер кажется очень странный и долгой затеи тем более у нас не было так много времени и после недолгих поисков мы нашли джейс библиотеку который называется воксель джесс это был на самом деле для нас грааль потому что он пистолет очень много инструментов библиотека существует уже более трех лет и фактически как заявляет автор она является ким talkie там для создания современных браузерных игр причем wog сильных браузерных игр в ней присутствует все что необходимо в ней присутствует понятие мира в котором есть оси и координаты в ней соответственно можно создавать блоки voxel и которые также понимают концепцию чанков там есть все необходимые штуки связанные с видеоиграми например можно создавать ограничивающие многогранники для того чтобы понимать столкновение нахождение рядом работу соответственно с объектами тому подобное вот этот пример того собственно как выглядит ограничивающий не многогранник там соответственно есть ray casting эта вещь которая позволяет из 3d объектов создавать на наших мониторах 2 дейвид что в принципе используется во всех игровых движках там есть текстуры и есть самое главное понять и игрока его управления фактически мы получили уже почти готовую игру и конечно же там есть все необходимые event это каждый цикл создания например амира этот цикл установки блока на все это можно подписаться и производить свои действия немножко поговорим о том как выглядит весь стек вот мы пишем свой код используя библиотеку воксель джесс да это наша специальная логика в свою очередь воксель джея сообщается с библиотек который называется 3g s на ней я немножко остановлюсь потому что она здесь является таким краеугольным и важным камнем во всей этой схеме очередь 3 3g с уже общается с веб jel который фактически встроен может сказать в браузер использует его и пей а в jel уже работает с настоящим оборудованием сопли jel драйверов который рисует картинку на вашем мониторе вот на самом деле сцену с использованием 3ds ну и в частности voxel джейс который использует произвести на свет не так уж просто ну кажется здесь нет ничего словно сложным ровным счетом посмотрим вот на этот простой код но не будем пугаться потому что чтобы создать классные 3d картинка в браузере нужно всего на самом деле три но пускай четыре вещи в первую очередь вам нужно сцена как и в обычном мире на этой сцене должна быть камера поэтому мы создаем объект камер в котором соответственно обозначаем размеры и и расстояние максимальное и минимальное который мы видим после того как у нас есть ценные камера нам нужно устройство которое будет рендерить то есть создавать нам для камеры и на сцене то что мы хотим видеть этого мы создадим рендер в данном случае как раз используется в джелли технологии наше видео карта будет трудиться для того чтобы создать мир в принципе у нас есть все для того чтобы игра работала единственно не хватает каких-то объектов для этого мы можем создать простые объекты для того чтобы создать объект нам нужно геометрия это в принципе то как он будет выглядеть в пространстве например если это куб то у него должны быть вершины и грани и соответственно нужно какой-нибудь материал для того чтобы его раскрасить самым простым вариантом можно использовать цвет по заливке и соединив и геометрию материала мы получим так называемый мышь на сленге 0 и можно сказать что это некая сетка объекта и после того как мы это добавим на сцену на наш соответственно то мы сможем увидеть этот объект после этого вызывается простая функция не made которые сродни сыт интервал в браузере каждый раз от рисует вам новый фрейм под тем самым получается анимация вот фактически этот механизм а он используется в обычных 3d играх и также доступен на в браузере теперь я хотел бы поговорить немножко о we are как я уже говорил вам хотелось и польскую тихой полую перейдут и технологии для того чтобы привлечь внимание и мы решили использовать we are это было случайно абсолютно спонтанной выбор но изучив немножко тему мы поняли что вера это нечто новый не очень hop off хайповая технология потому что вот эта картинка которая датировано фотография можно сказать датирована началом 20 века это верно 20 века собственно вы могли спокойненько использовать шлем ну скажем так этот шлем мог вылить вот так вот для того чтобы рассматривать настоящие 3d объекты единственное что в статике вот тут есть хороший пример например курортов сочи можно было часами наблюдать на пляж или на море или на театр мы решили использовать статическую картинку все-таки создать графику с видео поэтому наш выбор пал на oculus rift опять-таки выбор был достаточно интуитивный span спонтанной потому что лично я слышал что около сито вроде бы международный известный бренд который появился очень рано он появился на кикстартере вообще очень классный вот здесь нет ничего особенного около шрифтом представлена себя вот такими тремя устройствами как минимум базы но в первую очередь это шлем я думаю знакома и в принципе вам устройство а слева мы видим специальный бассейн справа мы видим специальное устройство для того чтобы понимать tracking то есть движение головы она носит помогать нехарактерные конец это какой-то game controller источник команд да он может быть представлен разными устройством данном случае у нас обычный геймпад немножко oculus rift и вообще наши впечатления о том как он работает потому что никто из нас до этого сфер технологиями и со шлемом около с не имел дела с начала о плюсах от действительно we are картинка она настоящая вполне мне можно смотреть и правда эта штука позволяет обманывать наш мозг и понимать как будто мы находимся в 3d мире второй важный момент у него действительно неплохое расширение разрешение соответственно экраны очень приличная скорость обновления картинки то есть я не лично не наблюдал каких-то заметных ухудшение до своего самочувствия когда наблюдал там картинку в отличие от каких-то первых старых попыток шлемов виртуальной реальности ну и наконец-то действительно очень удобное устройство и она очень хорошо сделано прекрасно лежит руки и в принципе его можно назвать что это отлично носится на голове и можно сказать что действительно потребительское устройство вот но есть определенные недостатки в первую очередь когда вот я думала we are я первую картинку почему-то себе в голове наблюдал потому что можно деть шлем какие-то девайсы да и будет очень классно на самом деле это огромное количество проводов фактически каждому устройству сейчас необходим кабеля твой 2 2 наверное важный для меня момент и легкое разочарование я ожидал что я возьму свой обычный лаптоп и смогу там программировать да там сидя на диване оказалось так что есть серьезное ограничение то есть можно использовать сейчас только windows в частности для oculus и есть детей недоступен больше для mac os и linux возможность стратегия компании возможная какая-то особенность операционной системы мне сейчас сказать достаточно сложно ну и наконец я не смог запустить даже простого видео или какой-то простой игры we are не и соответственно подключая достаточно приличную видеокарту я не являюсь таким яром геймерам до современных 3d игр и поэтому мне приходилось искать ее для того чтобы начать разработку вот я думаю что если вас не стесняют вот эти вот минус это смело можно пробовать современной шлемы виртуальной реальности продолжая тему очень хотелось бы рассказать кратко о том как делать игры для we are вот для нас эта тема была абсолютно закрыта и непонятные мы думали что мужик с специальной магия возможно устройство возможно ученая степень на самом деле нет сейчас не так много инструментов которые позволяют делать we are игры еще и в браузере наверное сразу что вы можете найти в интернете это будет framework of rain и он является наверное основным лидером и вообще pound доминирующим фреймворком для создания дополненной виртуальной реальности что здорово он работает с огромным количеством устройств включая oculus rift и даже обычный экран монитора то есть он позволяет работать в режиме совместимости когда у вас нет шлема это очень удобно для разработки а самое наверное здоровская если вы являетесь веб-разработчикам вам он очень будет близок потому что он использует парадигму концепцию html то есть вам не нужно 100 мб компилировать код вам не нужно специальной программы вам достаточно использовать свой браузер и свой обычный блокнот для того чтобы написать первую 3d we are сцену в браузере я сейчас покажу как это будет выглядеть у нас опять таки есть кот и видите он уже выглядит совсем как обычный html страница опять-таки его не стоит пугаться вспоминая предыдущий мой рассказ о сцене и рендере мы здесь можем увидеть примерно то же самое у нас есть соответственно сцена и на этой сцене созданы разные объекты в данном случае рендеры камера не заданы по умолчанию их можно переопределить если вы возьмете скопируйте такой блок кода то вы в своем браузере видите вот такую вот картинку где с помощью мыши или клавиш на клавиатуре вы можете перемещаться и увидеть полностью 3d объекты у вас будут тени и тому подобное дальше можно очень здорово развиваться увеличивать эту идею в тем самым мы начали соответственно делать версию для we are и самое главное вы спросите где здесь we are over здесь на самом деле находится в правом нижнем углу на мои картинки этого нет там появляется очень маленький значок очков виртуальной реальности при нажатии на эту кнопку у вас появляется we are картинка это выглядит абсолютной магии потому что вы не делаете ничего специально для того чтобы у вас появилась виртуальная реальность это делать за вас framework если посмотреть немножко детально то здесь нет ничего сложного для этого вам достаточно создать изображения для двух глаз и правильно его расположить и это уже позволит генерировать правильную картинку ну и наконец возвращаясь к нашей enterprise архитектуре мы финально пришли к тому что у нас будет два клиента 1 будет для обычной игры с использованием технологии и фреймворка воксель джесс а другой с использованием библиотеки of rain который мы сейчас с вами говорили ну и наконец мы решили добавить авторизацию игру что вы могли знать свои имена и на своих друзей для этого мы решили использовать firebase потому что достаточно простой инструмент и мы не хотели изобретать аутентификацию и авторизацию самостоятельно подключили его к нашему game серверу по обычному арестован ещё тебе запросов и соответственно люди перед тем как попасть в игру они делают идентификацию с помощью firebase и наверное напоследок я бы хотел рассказать немножко об оптимизации вообще очень много разных историй приключалось пока мы делали игру наверное 3 мне бы хотелось очень сильно отметить вещи которые сильно могут упростить вам жизни вообще довольно любопытные в первую очередь для того чтобы создать мир мы использовали как я уже говорил в акселя для того чтобы создать мир мы использовали программу для рисования воксель наподобие power point который только позволяет делать в 3d и конечно же те объекты которые мы создавали они состояли из огромного количества полных кубиков и когда этот мир загружался наша картинка достаточно медленно работала и требовал много данных потому что очень много voxel эй и первом что нам пришло на ум а почему бы нам не сделать объекты полами то есть внутри соответственно не создавать эти самые кубики ведь полюсе лях не увидит и мы написали очень простой алгоритм который собственно позволяет исключать из нашего мира которые мы создали в отдельном редакторе воксели который находится внутри это просто колоссальное количество снизило количество передаваемых данных примерно на на 78 процентов увеличила уменьшило количество вокселей в мире и было очень здорово вторым важным моментом является рекомендацией использовать мэр дело в том что создавая игру с воксельной графикой и мы конечно же в голове себя представляем отдельные кубики но в действительности мир как и в майнкравт том числе устроен немножко по-другому мы используем обычной полигональные модели и поэтому имеет большой смысл все отдельные voxel и соединять вместе в ту самую как раз таки сеть или мышь как называется для этого используется специальный инструмент который называется меж р-он колоссально увеличивает производительность потому что уменьшает количество вершин количество граней и ребер и поэтому для того чтобы просчитать например падение свет или какую-то физику вам нужно меньше вычислительных ресурсов вас будет меньше полигонов и тому подобного в некоторых кстати говоря framework он включен по умолчанию например если мы говорим про voxel жестом он используется по умолчанию мы получить достаточно приличный fps изначально во фрейме такого нет и мы использовали машину уже дополнительно ну и наконец оптимизацией из мира web-разработки websocket отличная технология но насколько вы наверное знаете по умолчанию она не производит никаких манипуляций с теми сообщениями которые передаются помощью него дело в том что классический из степи наверное хорошо использовать jezik для того чтобы делать компрессию в нашем случае мы передавали достаточно большое количество текста в данном случае джейсон данных между клиентом и сервером эти данные они были очень похожие друг на друга и поэтому нас возникла идея почему бы нам не сжать эти данные вот единственный загвоздкой было наличие в псаки то они классического и все типе как оказалось открытием для нас и возможно это будет также приятным открытием для кого-то из вас существует специальный россии который появился не сказать чтобы очень давно не у порядка наверное двух лет который описывает как можно делать компрессию с помощью внутрь его пакетов там есть несколько технологий это основано на использование специальных плагинов и фактически включения такой технологии на сервере в нашем случае позволило заметно понизить трафик ну буквально с 5 мегабайт передаваемых данных до 1 8 что приятно что современные браузеры таки это как chrome firefox и сафари они поддерживают компрессию стороны клиента и вам достаточно правильно включить компрессию на сервере или реализовать ее и у вас будет все прекрасно работать единственно важным моментом является то что во всех отладочных инструментах браузера информация по компрессии не отображается и вам будет показывать информацию уже раскрытых данных поэтому мне стоит переживать компрессии скорее всего у вас работа это данные которые показаны они уже активные после соответствия на всех процедур вот ну и под конец мы моего рассказа я хочу вам сказать что обязательно пробуйте что-то новое и получать это удовольствие наверное можно спокойненько зайти на urban по dnd в и посмотреть как выглядит игра потому что я постарался не сделать ни одного скриншота никакого геймплея в моей презентации ну и тем ребятам любопытным которым хочется посмотреть кодовую базу мы и естественно сделали открытую можете пронаблюдать как мы разрабатывали игру что на себя представляет и даже запустить свой свой экземпляр игры без каких-либо проблем включая сервер и две версии для we are и для просто для браузера вот на этом у меня все я с радостью готов ответить на ваш вопрос спасибо ах да я прорекламировал я дарю за самый классный вопрос очень очень здоровский термос он прям очень классный меня он здесь с собой специально так что это микро мотиватор да да она не микрофону что давайте владимиров а вот видите уже если на одном квадрате появилось несколько пользователей да это хороший вопрос дело в том что по умолчанию если зайти на сайт игры вы будете попадать в одну и ту и ту одну и ту же точку все игроки ну у нас такая условная координаты респауна мы называем ее 500 500 вот в этом нет ни чего плохого дело в том что у нас есть физика игроки будут вставать друг на друга и можно просто спрыгнуть с него по правилам игры создавать блоки voxel и на одной точке может только один игрок соответственно работает технология очень простая кто первый занял того и блок после этого вам просто невозможно построить блог именно на основе этого в принципе работает вся механика вы можете создавать блоки не можете занимать чужие блоки не можете удалять блоки такая вот простая скажем так концепция нет я бы мы просто бережем ваше электроэнергию мы попробовали и к сожалению пока технологии наши точно не доросли ли то что на мобильном устройстве запустить спасибо за доклад очень классно что highload превращается в геймдев конференцию потиху я стараюсь я хотел внести долю геймдева файлов это всегда классно 3d voxel и наше все надо было еще две части тов использовать или его сколько используется у нас но полностью палитра который есть но там исключены системные цвета для зданий вопрос такой когда разрабатывайте такие вещи всегда возникают разного рода глюки glitchy и начинаю творится вакханалия в игровом мире опишите самые забавные которые были ну я думаю они еще будут я надеюсь и вы приложите надеюсь к этому там свою руку и клавиатуру в действительности есть проблемы с мэром они до сих пор мне кажется до конца нами не устранены иногда наши мыши выглядит очень странно почему-то мишер начинает думать что это объект не выглядит так он начинает быть полом и наоборот это самый простой как бы самая простая проблема в целом на самом деле скажу честно например если говорим про we are the связка около с детей на windows современный браузер firefox nightly build очень нестабильно друг с другом работает и периодические управления от соответственно укуса не передается в браузер для we are a и происходит нужно делать определенную магию мы научились там набор всяких разных действий про и чтобы это возвращала камеру соответственно к жизни очки наверное вопросов на самом деле очень много потому что насколько я понял я новичок в геймдеве да это такая огромная не знаю для кого то может быть пещера для кого то может быть скала на который нужно забираться и с каждым новым новом уровне тебя появляется новые вопросы например физика прыжка это очень сложная штука на самом деле при нее наверное можно отдельную конференцию дело до как делать физику прыжка но сейчас очень странный прыжок мы там изучали траекторию параболы вспомни школьные учебники ну вот насколько смогли вот своего опыта смогу добавить то что прыжки да это такая вещи гравитация которая в реальной жизни она в играх очень скучно но у нас простите за у нас например гравитация падающий лист сейчас то есть такой человек как сносит вот слегка вопросы или я могу palms вот вы когда архитектуру продумывали самом начале она уже вот она осталась такой же какой вы ее самом начале придумали или же процессе разработки что-то менялось и соответственно вот например такие вещи как 5 мегабайт тоже интересно это за цифры в секунду в минуту за да я с радостью до пояснил смотрите что касается архитектура и перфомансы но на самом деле мы занимаемся опускал enterprise настоящий enterprise разработкой по основного места работы это фана и проект по этому очень серьезно относились к архитектуре вообще к тому насколько это может быть устойчиво и всегда думали может быть нам мангу потом в кластер превратить может там нам с букетом что-то сделать особенно и вот что мы сделали во первых архитектура на практически получилось сразу той которой есть 100 лишь разницей что стрелочек между разными компонентами было много мы там firebase ходили по разному от клиента к серверу от сервера клиенту и наоборот и решили это упростить что касается перфоманса в целом мы написали бота который создает до 100 игроков одновременно начинает создавать блоки дело в том что у нас технология бродкаст соответственно наше явное ограничение на вообще нормальный performs между клиентом и сервером она и узкое место это количество игроков чем больше игроков тем больше нам нужно делать бродкаст между ними соответственно если у нас будет тысяч игроков на наверное будет тяжеловато обходить бродкасты потому что это итерации что касается 5 мегабайт это средняя стоимость загрузки мира в центральной точке . датчик игрок появляется ему нужно отобразить ближайшие несколько чанков чтобы их отобразить нам нужно соответственно загрузить все данные мы называем это вот и не шел такой загрузкой вот раньше объем объем данных которые нужно было передать разово был крайне 5 мегабайт это вот тот мир который мы сейчас есть такой надпись хай-лоу такой замок нарисован вот это именно в объем в мегабайтах скажем так секунду звук не даете на клиент сколько клиент возьмет здесь михайловке очень медленно ну я незнаю 10 мегабит в секунду мы легко отдаем клиента тогда он дома белок еще очень далеко не нам очень далеко дома вино вы бы стараться вопрос на самом деле был не совсем про это вот про то вы на самом начале придумали вот будет так это еще и исходил из того что из ваших каких-то догадок что если мы сделаем например именно матрицу а не будем разбивать начинки то все будет плохо там или вы сначала сделали матрица посмотрели все было плохо потом сделала личинки то мы постарались выглядеть как бы как как гении практически учиться на чужих ошибках я могу порекомендовать очень классный блог 0 и vps dot net это вообще прекрасный блок человек который нам научно занимается играми и очень много информации оттуда почерпнули вот те выкладки относить на какую модель использовать передачи данных или как пример настроить протокол мы на самом деле взяли оттуда как бы украв определенный опыт сэкономив время что касается вообще общей архитектуры но мы занимаемся построением довольно сложных главных сервисов поэтому исходя из вашего богатого опыта мы вот посчитали что архитектура стоит строить в таком направлении вот по секрету другим дев от когда на коленке напилили посмотрели и потом начали уже но увидели оптимизировать но за то что вы из уедем делу и перешли в геймдев он конечно большой респект спасибо спасибо за доклад очень интересно два вопроса первые как то вы устанавливаете сессию сетевую и игровую сессию общей если режим восстановления и второй вопрос какой компьютеру сетевые задержки компенсируете ли вообще или кто последний тот и папы и как вообще да это так хороший отличный тоже вопрос что касается взаимодействие клиент и сервер как я уже сказал это в пакет это наверное ну на мой взгляд если вы знаете лучше расскажите это лучшее что можно сейчас получить мне кажется в браузере да но если мы не говорим какие-то пир toupper соединение то между браузерами как раз активную репликацию поэтому в данном случае действительно кто-кто соответственно относительно кто первый ли кто последний тот и прав если тот и папа это правда сейчас у нас что касается предсказание нас нет никаких предсказаний в игре важна интересный момент что появляющиеся блоки в том числе и блок созданный непосредственно тобой играющим он появляется как результат бродкаст а от сервера то есть мы не рисуем front-end и сразу ваш блог мы соответственно ждем подтверждения блока поможет уже блокчейн конференции мы ждем подтверждения блока от бэкенда вот соответственно cтолько бродкаст он прилетает к нам то что вот там создал какой-то игрок плохо на самом деле там и мы его рисуем сейчас это подозрительно быстро даже на 100 игроках это правда подозрительно быстро ваших силах сделать это медленно и рассказать почему это лагает ну а мы поймем вот я горю очень большая проблема возникает имя когда игроков больше сотни ближе к тысяче тогда нам нужно итеративно обходить все бродкасты это замедляет общий цикл атака сервер синхронный спасибо и так понимаю это тоже используется при по или не игрока в мире то есть не будет такой ситуации что я построил кубик все решил что в этом месте появится игрок люкс у нас игрок купить в доме для для этого мы реализовали классную идею выпада и вы падаете с неба то есть мы поняли что можно игроки могут застраивать спад и мы просто бросаем игрока с неба отличное решение для просто еще не добрался до вашего стенда что что одна попробовать я думаю что вы можете оставить в текстуре кстати говоря это возможно хороший баков спасибо спасибо вопрос меня по поводу рассказки кубиков если количество цветов rgb то не будет ли огромной конечно друг голос при отрисовке мира гореть и каждый материал нужен собственный вызов друг голый это это одна из тоже потенциальных проблем когда коли у нас каждым игроком значится автоматический цвет при там есть небольшая хитрость мы исключаем служебные цвета потому что постройки они технически вы в игре устроен как другие игроки скажем так да то есть вы созданный мир вот и начинается сам геймдев все постройки это это другие игроки скажем так системные эти цвета мы исключаем чтобы новому игроку нет не дался системой цвет и он там не мог пошалить вот назначение цвета происходит автоматизированно firebase в виде такой лямда функции скажем как вы добрались и до используется клауд фанкшн который генерирует свет она использует не буду рекламировать какую-нибудь джейс библиотечку которая берёт обычный rgb цвет правда выбирает наиболее там скажем веселые и грустные цвета поэтому чисто технически создав тысячу две-три игроков эта проблема скорее всего возникнет от и о том как мы к которой вы говорите но вот на нашу масштабе она выглядит в принципе вполне неплохо вообще для нас до материал кубики блоки до соответственно вот ну тут кто плохо различает это будет проблема да потому что вам будет писаться извините здесь другой игрок вы не может создавать мы постарались сделать яркие цвета и я надеюсь с авось случае нам поможет их не делать совсем похожими мы думали продавать нельзя продавать цвета но это следующий этап это уже монетизация у инди-игры вы знаете да а ну вот видите можно же продавать цвета все верно можно вопрос задам спасибо за доклад я хотел спросить по моему мобильные люди больше играть мобильные игры чем браузерные почему вы не сделали мобильном и не мобильные разработчики я думаю следующий наш этап мобильная разработка вот сыр наверное сделаем ну чтобы hyip его тоже было как-то мы посчитали что нам перепрыгнуть с обычные веб-разработки в просто в браузерную для компьютера будет чуть-чуть попроще только из-за этого это колоссальная разница если у вас до если у вас лаптопа или какой-нибудь компьютер с интегрированной графикой там да это будет медленнее заметно с хорошей видеокарты и вас будет все очень здорово и классно носа стенде приличная видеокарта там еще we are правда и там но fps стабильно 60 то что браузер ограничивает по рендер фрейма соответственно ну на некоторых компьютерах она медленно работает от правда нам на мобильниках очень плохо вопрос касательно интернета если слабый канал интернет мы старались всячески собственно одна из причин почему мы занимаемся оптимизацией тех самых в вокселей которых не видны компрессии чтобы сделать меньше трафика соответственно да дорогая и не шел загрузка первоначально дальше в рамках того сколько блоков появляется ну если речь идет сейчас то это наверное 2 мегабайта библиотеки от них мы никак не можем избавить это бог ситжес еще что то это порядка 4 5 мегабайт в крайнем случае в мире ну и плюс какой-то небольшой трафик допустим когда интернет прерывается у нас в псаки тон при подключается мы соответственно делаем заново и не шил загрузку потому что мы теряем бродкасты соответственно мы не получаем рад касты наш мир нужно заново синхронизировать поэтому выключаем все и от сервера получаем мир и мин тот пример пассивный репликации сотни который нам помогает легко это сделать попова 200 воз таймаут на переподключение какой вообще но мы максимально быстро стараемся подключаться там вообще то есть мы просто убиваем сервер реконнекта my какой-то пин код клиента есть да у нас есть обязательно pink мы ну это кстати говоря отдельная тема как мы старались защищаться у нас есть разные проверки на пилот в пример вы не сможете точнее вы сможете но мы ограничим вас засунуть какой-то большой джейсон например да для того что убить наш сервер и мы соответственно делаем пинг с клиентом для того чтобы разрывать с нашей страны в аптеке чтобы делать бродкасты например вот мы всегда прошиваем соответственно живость клиент если он не отвечает мы живем с ним соединения редактор какой-то для мира у вас есть у да да у нас есть редактор он очень нет и очень известного инструмента называет он называется соответственно магика воксель это очень в мире вокселей очень известны инструменту есть для mac os для windows для прочих инструментов там можно создавать соответственно как в paint скажем так вокселей и рисовать мир вот рекомендую попробовать классные гейм-дизайнеры а надеюсь вы заценили в самом начале была шутка из рекламы эдвард они очень здоровские картинки в соответственно voxel дизайне рисует у нас все заметно попроще поэтому если есть возможности и желание магика воксель используйте а по поводу заяц хотел сказать muse увидел вашу картинку там на самом деле начальники можно запустить поработать это да но мы хотели хайпануть на тему я обязательно без нее никак здрасте по поводу учительства она разрешена официально все что не запрещено все разрешил клиент на джейси достаточно легко riverside как-то борется с этим или нет ну смотрите вы можете попробовать во первых мы не будем завершать игру как минимум два дня вы можете написать обычный высоких клиент скажем так есть определенные моменты когда конечно преимущество бота написанного кодом он будет заметно как бы заметна разница с обычным клиентом до который играет в браузере в остальном правил устроен так что вам нужно чтобы добраться до спота до одного флага вам нужно проделать дорожку из своих вокселей соответственно здесь нет некоторые горячей например вы не можете сделать в минуту более 60 блоков одновременно такая серверная проверка и для того чтобы клиент бот не сделал очень очень много блоков в остальном наверно каких-то особенных проверок у нас нет хотя это тоже открытый вопрос по идее нужно думать над тем как можно улучшить логику и защиты от ботов ну мы еще например не поддерживаем более 1 выпуске сведений мы разрываем с клиентом если вы сделали аутентификацию например через какой-нибудь и google facebook и вы делаете 2 например сессию мы первые закрываем поэтому от всегда открыта и 1 в аптеке сессии давайте на финальный вопрос тут уже вы можете посмотреть по комментам но это фановые проект мы делали его вечером вот у нас есть вся история я еще раз по рекламирую в конце у нас есть вот такой вот гидропроект и вы соответственно можете пойти пощёлкаем быстро можете зайти и посмотреть соответственно в рбк слова urban вот приходите делать и паре квесты можно что не прикольно придумать вместе"
}