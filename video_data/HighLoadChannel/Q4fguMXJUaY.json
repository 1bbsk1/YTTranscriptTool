{
  "video_id": "Q4fguMXJUaY",
  "channel": "HighLoadChannel",
  "title": "TechTalk с Ecommpay IT / Владимир Федорков",
  "views": 247,
  "duration": 751,
  "published": "2021-10-04T02:45:36-07:00",
  "text": "здравствуйте я артём я бывший доктор хабра сейчас веду подкаст мы обречены раз познакомиться очень приятно меня зовут владимир я занимаюсь базам данных компаний омбре расскажите про свой работу чем занимаетесь я занимаюсь в основном стабильностью я делаю так чтобы система была быстрый стабильный я настраиваю коммуникации и процессы по работе с базой данных в разных командах и моя задача как задача хороший уборщиц чтобы все было чисто чтобы все блестело чтобы было красиво ну и чтобы про работу и как вообще устроен это но вы работать над каждой мелочами или ищите какие-то такие изящные решения вот пару изящных решений все работает хорошо или такая постоянная работа это постоянная работа я продолжил аналогию с уборщицей дело в том что если вы постоянно занимаетесь каким-то делом то у вас есть результат если вы отвлекаетесь и вы не можете например воскресенье все убрать i buy чистое потом на месяц это все оставить и если вы если месяц никто не будет убирать очевидно будет грязь поэтому любая работа связана именно с процессами оптимизация системы это процесс постоянный ежедневный это много повторяющихся простых действий и важно чтобы эти повторяющиеся простые действия были регулярными и был было постояно обратная связь дело в том что само по себе производительность если мы говорим о базах данных прежде всего это скорость запросов и скорость запросов от дыба по большому счету не зависит она зависит от того насколько хорошо команды понимают что они делают насколько хорошо команды осознают как и код работает в продакшене на железе или в облаках не важно но в бою и каким именно образом задачи которые они решают транслируются в вызовы процедур функции запрос работаем таким кодом у которой который должен быть производительным это наверное наказать большие требования тестирование производительности безусловно у нас очень высокие нагрузки поэтому мы и крайне внимательно относимся к тому как мы пишем код как мы его запускаем в прозе и как это в принципе работает год проходит несколько статей проверки в том числе на скорость запросов поэтому это целая но это целый конвейер который нужно пройти и и все равно безусловно какой бы этот конвейер не был адекватный и глины все равно да продай иногда доезжает то что по-хорошему нужно править но это это опять же это это постоянный этот постоянный обратный обратная связь когда мы смотрим что происходит в проди мы ищем длинных фраз ты тяжелые хвосты мы смотрим девицы мы находим их и мы разговариваем с разработкой по поводу того как эти девицы и убрать это касается и баз данных это касается любых компонент ну и как трудно ли туда носить до всех разработчиков чтобы они писали такой код который будет начать его не им слушать он у нас мне очень повезло у нас шикарная команда и до них не просто не нужно доносить они сами понимают что они делают и в тот момент когда у них есть вопросы они сами приходят то есть вот это это та самая часть конвейера которую даже даже конвейером не назовешь когда у людей есть задача и они пытаются ее и они только думают о том как они будут и и преобразовывать в код они приходят и задают вопросы а вот если мы сделаем вот так это будет быстрее чем вот так или и или надо сделать как-то по-другому и мы решаем большую часть вопросов и еще до того как код будет написан я считаю что это огромная огромная победа но все нужно часто бывает такое что приходится переписывать что-то чтобы улучшить безусловно дело в том что данные сами по себе меняются и когда кот выкатывается у нас ситуация 1 нагрузка 1 а потом со временем количество данных растет нагрузка изменяется тип нагрузки изменяется новые фичи выкатываются выкатываются новые компоненты которые взаимодействуют уже выкачан ими и безусловно процесс рефакторинга он такой же постоянный как и отслеживание производительности как стороны базы данных так как со стороны фронтов ну и вот что-то да что труднее находить какие-то решения уже на во время когда вы пишете с нуля или во время рефакторинга безусловно переписывать код который уже в продакшене тяжелее и дороже поэтому чем быстрее чем раньше найдется мы сможем дать вид идентифицировать потенциальную проблему с производительностью тем раньше и быстрее и дешевле ее починит и тем лучше будет и для пользователей и для компаний мне частенько говорят что для того чтобы писать прямо очень производительный кот очень признательна решение это обычно делает кот очень трудно читаемым то есть часто такой понятный код он это скорее за счет за счет того что он будет не слишком производительным здесь и дай нет дело в том что когда мы говорим о производительности о действительно высоких нагрузках иногда обычная логика не работает ну то есть если мы возьмем возьмем простой пример вот у нас есть например миллион записей нам нужно их все обновить с точки зрения скорости обновления безусловно нужно взять один запрос и одним запросом обновить миллион записей но с точки зрения высоконагруженных систем и когда у нас очень серьезная параллельная обработка такой запрос остановит базу данных то есть он заставит базу данных работать только на этот запрос и и остальные потоки остальные запросы могут начать ждать то есть мы нарушим конкурентность и в этом смысле вас к наружные системы требуют отдельного к себе отношения и требует писать иногда вещи не совсем логичные для обывателя который только начинает только погружается в высокие нагрузки или только про погружаются программирование но это ни в коем случае не требует делать код менее читаемым но за как быть нескольких ситуации в когда ты выбираешь например какой-то способ и заранее закладываешь на какую-то нагрузку который может и не быть стоит ли это делать раньше времени такой преждевременной оптимизацию вот если бы можно было найти ответ на этот вопрос однозначный наверное очень много проблем снялась бы этот вопрос о серебряной пули всегда нужен взвешенный разумный аккуратный адекватный подход когда мы говорим о планировании нагрузки мы выбираем между с одной стороны скоростью разработки и с другой стороны потом стоимостью изменений ну наверное не имеет смысла писать новый сервис который для которого непонятно нагрузка как новый сервис google как например новый youtube или например как новую поисковую систему но тем ни менее какие то оценки внутри компании безусловно даются перед тем как мы перед тем как сервис проектируется безусловно нужно понимать сколько какая нагрузка ожидается и под эту ожидаемую нагрузку уже проектировать сервис обычно обычный стриме 3 1 метрика это сколько у нас будет пользователей самого начала 2 метрика это сколько пользователей сколько транзакций или запросов к сервису будет в пике и последнее метрика это сколько мы ожидаем какой рост мы ожидаем через 6 или через двенадцать может вспомнить из практики это такие ситуации но когда вы пытались улучшить performance но просто заходили в тупик ну то есть не с проблемой случай где либо вообще был надо переписывать все либо оставлять но как есть так есть ну безусловно да когда мы в любом в любом случае когда мы говорим о оптимизации производительности у нас есть несколько вариантов первый вариант это и и он очень часто самый дешевый просто давали железо зари деньгами это отличный вариант но он не всегда работает то есть дело что каждый следующий шаг он по экспоненте будет стоимость каждого следующего шага по экспоненте растет и в какой-то момент дешевле просто все жечь напалмом и переписать заново второй вариант и он такой средний между сжигания напалмом сжиганием напалмом и добавлением железо это попытаться найти какие-то логические другие варианты реализации той же самой функциональности очень часто такое можно найти и очень часто это все очень и очень часто очень хорошо работает но это опять же зависит от квалификации разработки и я еще раз говорю у меня здесь мне очень повезло ну что очень часто все вопросы решаются быстро просто и и понятным время снова да да безусловно я могу со своей стороны как теперь сделать определенные оценки по сделать анализ запросов сделать анализ схемы добавить каких-то индексов или прости господи сделать какие-то оптимизации на стороне конфигурации майский которые мы понимаем да что конфигурация не решает никаких проблем и серебряных маски вообще с точки зрения производительности если мы хотим чтобы у нас было презрительно база это хороший брокер у меня встречный вопрос к вам скажите просто молоток это хорошо или плохо для чего то что для чего за плохо вы ответили на свой вопрос маски для чего-то хорошо для чего то плохо а если мы говорим о запросов по первичному ключу если мы говорим запах о запросах по индексам если мы говорим о коротких транзакциях томас гель очень быстро если мы говорим о olap аналитики безусловно майский это не самое лучшее решение ну то есть забивать гвозди микроскопом безусловно можно но молоток для этого предназначен в гораздо большей степени ну ладно владимир спасибо вроде пробежать по вопросам спасибо вам"
}