{
  "video_id": "aR74NE7t8Ww",
  "channel": "HighLoadChannel",
  "title": "Автоматизация сетевой инфраструктуры ЦОД / Анна Кошк (Ростелеком ЦОД)",
  "views": 387,
  "duration": 3137,
  "published": "2025-01-17T02:25:04-08:00",
  "text": "Привет я действительно из ростком цот я там тилит направления devnet моя команда - это маленькое направление автоматизации внутри департамента эксплуатации и поддержки сетевой инфраструктуры сетевики строят сеть для предоставления услуг клиентам А мы занимаемся разработкой пнм скрипту всё что нужно скрипто и всячески стараемся упростить жизнь сетевиков а для того чтобы понять что-то в автоматизации сети нужно для начала разобраться с самой сетью поэтому Скажите мне пожалуйста есть ли сетевики в зале Ну в принципе э вас не так много поэтому для остальных будет вводная часть А где я на пальцах на вот минимальном уровне понимания буду рассказывать что это вообще как это э работает и для чего оно нам нужно так компания Ростелеком цот предоставляет полный Спектр дата центровых услуг у нас есть colocation то есть размещение прямо в стойках в залах а хранение данных есть виртуальная инфраструктура много-много много всего другого у нас 22 дата-центра больше 20.000 стоек совершенно какие-то запредельные значения по мощности в глазах простых смертных и все эти цифры нам в общем-то ничего не говорят Кроме того что мы греем воздух в промышленных масштабах на самом деле эти цифры и говоря должны сказать нам только одно что инфраструктура большая даже очень но хорошая новость заключается в том что сегодня я буду говорить в основном в контексте только двух наших площадок именно эти площадки интересны тем что были одними из первых например лае рост открылся для клиентов в 2009 году То есть лет назад соответственно они строились во времена когда ещ мало кто думал об автоматизации и методология devops только-только начинала своё зарождение соответственно они развивались тогда когда никто не закладывал то что кто-то будет это всё автоматизировать И сейчас сеть современного дата-центра в идеальном случае в идеальном для автомати конечно же выглядит примерно так супер упрощённая как и все последующие схемы Но главное что нам Тут нужно увидеть это что здесь две ээ роли девайсов они соединены по принципу каждый с каждым очень линейно Понятно Э даже детям в принципе Ну разумеется коммутаторы ради коммутаторов в Маш залах не стоят поэтому на этом слайде есть ещё и облачка а облачка подключаются к лифа лифы по принципу каждый с каждым соединяются со спай нами и вот так оно всё и работает а в случае если нам нужно добавить новое Облачко на эту схему то мы просто добавляем пару лифов подключаем туда облачко лифы дотягивает быть возникнут проблемы Если надо будет добавить новую площадку но тут на схему выходит супер спайн он как супермен но супер спайн к нему уже по тому же принципу подключаются обычные спай и так можно продолжать до бесконечности И ограничивать вас может только бюджет компании здравый смысл но если бы всё было так просто То во-первых было бы слишком скучно а во-вторых скорее всего где-то тут рядом бегали бы розовые единороги конечно же всё несколько сложнее все эти 15 лет сеть непрерывно менялась развивалась Но какие-то из принятых 15 лет назад решений остаются с нами по сей день по разным причинам но сеть не меняется просто так сеть всегда меняется в зависимости от потребностей наших клиентов а потребности клиентов вырастают из изменений в окружающем мире например за эти 15 лет Мы все перешли массово смел на виртуализацию и если сейчас нашим клиентам больше всего актуально поставить свои сервисы в облако или менеджер дата какой-нибудь и канал между ними то раньше сам интересным былой просторнее и интернет-канал до этого всего счастья и вот чтобы предоставить интернет до стойки с оборудованием нам могли понадобятся примерно следующие железки А здесь у нас есть ядро сети есть провайдер ED которые подключаются к ядрам я их дальше для собственного удобства буду называть пешками Так просто быстрее и выговаривать проще а к пешка уже подключаются сты сты соединяются между собой и к диста Они же свичи дистрибьюции подключаются клиенты но допустим отдел продаж работает хорошо и на одной паре дисто мы уже не помещаем добавляем ещё одну в принципе схема не сильно усложнилась всё ещё достаточно Понятно э наверное тоже разберутся даже дети Но если нам нужно добавить ещё одну площадку потому что ну отдел продаж работает хорошо Они получают свои премии клиентов много добавляем в принципе реализуем всю Ту же самую схему но На некотором расстоянии от предыдущей площадки Соединяем между собой ядра в квадрат может показаться что это трапеция но всё-таки доверьтесь мне это квадрат и заодно ещё крест-накрест тоже Соединяем их схема уже несколько усложняется Мы видим что здесь достаточно много ролей девайсов достаточно много различных механизмов подключениях между собой а но всё ещё здесь нет вот этого облачка с Интернетом А мы хотели дотянуть интернет до стойки для того чтобы это сделать понадобится ещё одна роль оборудования это борде они ставятся на границе с интернетом и через них собственно заходит трафик в ЦД ещё стоит пожалуй заметить что все эти линки наверное правильно было бы рисовать вот всё что вертикальное более жирным потому что в такой схеме очень много трафика ходит из Интернета до сервера Там стоят железки они не общаются практически между собой они общаются в основном с клиентами которые в интернете и на самом деле это ещё одно важное изменение за последние 15 лет которое повлияла на сети мы все начали писать микросервисы если опытный разработчик говорит что никогда не писал микросервис и никогда к ним не прикасался то скорее всего Он врёт а и если раньше весь трафик ходил по вертикали и соответственно Мы нуждались в том чтобы наиболее сильные линки были там то теперь трафик По большей части ходит по горизонтали это внутри содовое взаимодействие и сервисы общаются между собой и пожалуй последнее важное изменение за эти 15 лет это то что вырос спрос на it в целом мы сейчас все свои задачи начали решать с помощью информационных технологий Ну хотя бы пытаться если раньше нам нужно было вызвать такси мы поднимали руку и ждали Сейчас Слава Яндекс мы просто нажимаем пару кнопок в приложении вызов врача А запись куда-то на приём в любое ведомство а заявление на отпуск мы всё это как правило делаем так или иначе с применением информационных технологий и с точки зрения инфраструктуры дата-центров это потребность в быстром и дешёвом масштабировании и вот поэтому в том числе сейчас мы приходим к ф spine топологии но а сеть конечно же меняется но мало что уходит от нас навсегда потому что всё ещё есть множество клиентов которым наиболее актуально всё-таки поставить своё оборудование в стойку но и виртуальные ресурсы тоже всем нужны и бывает даже такое Что это один и тот же клиент и ставит Свои микросервисы у нас в Облаке которые хотят общаться между собой и заодно эти микросервисы хотят общаться с чем-то железным что у него стоит в колоне поэтому на самом деле сеть цдо сильно сложнее чем я могу изобразить на этих схемах если мы полезем ещё ковыряться в технологиях которые там используются И в чем они отличаются то выйдем с вами Т Это не тот срий который нам нужен просто сделаем Вывод что есть два основных кейса с которыми Мы работаем есть облачная инфраструктура есть colocation они разные там внутри тоже всё разное А с этим вроде бы Понятно сетевые услуги - это ну вот дотянуть интернет до стойки либо канал между физикой и облаком А какие там могут быть вообще проблемы Ну вот зачем мы это всё автоматизируем потому что если нет никаких проблем в ручном труе то зачем его автоматизировать с точки зрения инженера в прикладном смысле сетевая услуга - Это некоторый набор действий типа Делай раз делай два а они могут отличаться но базово нужно заказать кассиров сгенерировать ID услуги найти ВН и сеть Ну ещё какие-то другие ресурсы могут быть Не суть важно найти свободный порт на оборудовании почти для всех услуг не нужны ввести Некоторое количество строк конфига на некоторое количество устройств это каждый раз по-разному зависит очень сильно от услуги и самое сложное - это проверить работоспособность для этого всего нам понадобятся некоторые вводные это расположение клиента в какой стойке или в каком стенде он находится это параметры физической среды размер сети пропускная способность И на самом деле ещё куча всяких факторов тут уже больше диапазон того что нас может интересовать Какие же всё-таки проблемы Что может пойти не так если это делает человеческий инженер Ну кроме того что Всё может пойти не так Первое - это человеческий фактор это та проблема которая доставляет очень много боли инженер это живой человек ему свойственно уставать он может терять свою внимательность и концентрацию он может ввести конфиг не на то оборудование он может опечатать он может забыть какую-то команду клиенты по Кроме того он потратит время на поиск с свободных ресурсов то самое время которое он мог потратить на нечто более интересное и полезное в том числе для него найти свободный порт на оборудование - это ещё полбеды но найти свободный ВН или не дай Бог сеть это квест Ну думаю через неделю инженер бы к нам вернулся это же самое время это длительность ожидания для клиентов клиенты тоже Живые люди Живые люди Они так устроены что у них достаточно ограниченный Time to life поэтому они не любят ждать в принципе К тому же им тоже нужно решать задачи своего бизнеса поэтому они будут недовольны если это будет слишком долго происходить и последняя проблема которая пожалуй наиболее важно для непосредственно моей команды - это текучка кадров просто потому что люди не любят делать одни и те же тупые действия каждый день Ну есть кто-то кто любит Но как правило они вки не идут в it Мы наших инженеров очень любим и ценим Мы хотим чтобы они занимались действительно интересными задачами а не рутиной поэтому мы хотели это всё автоматизировать есть некоторая программа минимум это просто чтобы не происходили аварии на ровном месте чтобы не путались железки хотелось бы чтобы не забывали команды и чтобы не путались какие-то ресурсы ну и желательно ещё чтобы инженер не тратил своё время на то чтобы вводить config на большое количество устройств для того чтобы эту программу минимум выполнить отлично подходят абло плейбук достаточно простая по своей сути штука которой можно просто сказать Делай раз делай два у пбв есть очевидные плюсы во-первых они работают это уже полдела сделано Я считаю также у них нет проблем с вниманием а никогда не забудет какую-то команду если ей сказали что нужно её вводить и они могут быстро раскатить конфиг без разницы На какое количество устройств особенно в наших масштабах Ну от д до ше Да даже если 10 в таких масштабах незаметно даже но есть и минусы например они не могут найти свободный ВН потому чтобы какой-то свободный ресу Какие ресурсы заняты АБ ничего этого не знает они не знают ID клиентов То есть даже если они будут конфигурацией связи И вообще как это подписать также они не понимают бизнес логику Да и вообще логику будем честны Можно конечно научить плейбук понимать даже самые сложные бизнес правила Но это всё ял программирование я его немножко поца но тем не менее часть наших проблем они решают иначе бы мы их не разворачивали они закрывают какую-то нашу боль и приближают к глобальной цели автоматизации то есть автоматизировать всё что может быть автоматизировано а для оценки приближения к нашей цели мы придумали специальную очень гибкую шкалу которая позволяет оценить степень автоматизации практически любой большой инфраструктуры выглядит она вот так слева ничего не автоматизировано справа Всё автоматизировано мы находимся здесь Как видите пока что в красной зоне хотелось бы попасть в зелёную и если главная проблема ПБУ ков была в том чтобы они знали что с Конфи и могли Конфи можеть в зависимости от этого понимали логику знали что-то про клиентов то нужна система которая справится со всем этим Ну или хотя бы в которую можно для начала положить всю информацию У нас есть то что мы знаем о сети и тут мы далеко ходить не стали и развернули широко известный в узких кругах набо это DCI система он специально разработан для того чтобы инвентари Зро дата центровое оборудование и вести учёт IP адресных пространств но мы здесь ведём почти все справочники которые касаются сетевой автоматизации если для этого не нашлось какого-то другого справо раньше чем мы развернули набо Ну наиболее интересны Наверное нам будут IP адреса префиксы о ниже сети и девайсы Ну в целом масштабы довольно заметные Но это ещё не всё даже стоит отметить что netbox сам по себе ничего не добавляет он не умеет ходить по железка он никуда ни в какие внешней системы не смотрит он представляет из себя по сути просто хранил с графическим интерфейсом и небольшой ошко логики соответственно под капотом у него особо нету нужно всё самим заполнять вручную но вручную это не путь автоматизации Поэтому нужно как-то это всё дело парсить в автоматическом режиме и тут мы переходим к следующей головной боли это то что сеть то у нас Ну достаточно неоднородная и железа разного много И вот это разного это ключевое слово я собрала топ операционных систем которые используются есть помимо перечисленных Там первые четыре пункта - это циска Последний пункт - это джунипер есть Huawei есть Фама полный комплект в общем Казалось бы первые четыре пункта циска отлично это же один вендер наверное они не могут отличаться это же почти одно и тоже Ну хотелось бы но розовых единорогов я здесь не наблюдаю они отличаются отличаются довольно сильно Ну хороо ладно Можно же вот взять у вас нексусы на первом месте наверное их больше всего Почему бы не поставить остальные тоже все меняем на нексусы проблема решена все железки одинаковые но мы не можем выбирать э железо исходя из наших хотелок и чисто нашего удобства Мы выбираем оборудование исходя из задач э и исходя из возможностей это поставить конкретно на нужную роль поэтому мы никогда не уйдём из зоопарка и дедушка Летов не мог бы нами гордиться отличаются в операционных системах в первую очередь вот перечисленные штуки расположение секции - это очень простая вещь просто где-то у вас на оборудовании будут сначала идти маршруты где-то будут в Ланы потом интерфейсы где-то оно всё перемешать Ну в целом не беда может отличаться порядок токенов что не очень удобно при парсинге но тоже в принципе сойдёт одно и тоже может одними и теми же словами Но в разном порядке могут отличаться сами токены одно и тоже будет Конфи разными словами и возможно в разном порядке бывает Есть ещё отличие в функционале что какая-то железка не будет уметь того же самого Что умеет другая и практическая применимость То есть даже если железка что-то и умеет то не факт что мы её поставим это делать Просто потому что есть какие-то традиции исторические устои тактико-технические характеристики что-то из обязательно нам помешает поставить железку туда куда очень хотелось бы для того чтобы с этим бороться нужна какая-то штука которая сможет всё это распарсить готовые парсеры Ну если честно приводит к тому что ты просто пытаешься обмазать их обвязать вокруг твоих конфигов и они не хотят это парсить им это слишком сложно ты пишешь костыли поэтому проще написать свой Нетворк колектор который окажется максимально простым и даже применение готовых парсеров просто потому что он возьмёт текущую конфигурацию устройства ему будет без разницы на самом деле что это за устройство хоть джунипер хоть циска любая причём из ЦИК он просто возьмёт из бэкапов там уже об этом подумали оно уже бка Дальше он это разобьёт на отдельные секции и распарсить их уже зная о том что там за платформы и какой парр под не взять сагит пое данные выт какие-то взаимосвязи между сущностями например что этот IP адрес висит на вот этом интерфейсе и в этом прекрасном объединённом виде отправит всё это в netbox и теперь netbox вроде как накормлен информацией о том что у нас есть в сети постоянно эта информация обновляется коллектор не перестаёт работать вроде как проблема лейбу решена Теперь у нас есть система которая всё знает о том что есть в сети Можно же идти и Конфи получается но специфика нашей работы такова что нам абсолютно без разницы что это за интерфейс и как он настроен нам без разницы и какой IP адрес на нём висит просто потому что у нас этих IP адресов Ну десятки тысяч замучаешься каждый считать но нам очень важно знать что это за услуга и для какого клиента выделен этот IP адрес и этот интерфейс распознать на оборудовании что это за услуга можно пос лимит символов Поэтому туда пишется сокращенная версия это какие-то айдини в специальном унифицированной формате то есть посмотреть что это всё-таки за услуга получить вот эту всю простыню информации можно только в справочнике и в какой-то момент мы поняли что у нас нет такого справочника Ну точнее как формально он как бы есть ного ведут люди работа инженера по автоматизации сильно напоминает работу врача в этом смысле потому что людям перестаёшь верить так же быстро Поэтому нам Срочно нужен был справочник который люди не ведут и в котором соответственно люди не могут допустить ошибку опечатать и так далее netbox очень хорош тем что позволяет его дописывать буквально Как тебе угодно у него есть нативная поддержка плагинов Так что знай себе Пиши на Джанг и форточки отрисовывать не то чтобы мы большие эксперты в рисовании картинок Но самая простая услуга в этом справочнике выглядит так и не знаю восхищает ли это кого-то также как меня но он хранит ссылки на конкретные сущности в сети не на абстрактный интерфейс который мы сдали в аренду А на конкретный интерфейс и мы точно знаем что клиент оо Рога и копыта арендовал не какой-то там порт в каком-то машзал а прямо конкретно isnet 1225 на оди 1 и Это нам очень сильно помогает собственно о том как мы всё ещё ничего не услышали про Вот эту вот настоящую автоматизацию нажал на кнопочку всё поехало как-то без нашего участия пока что только собирали информацию о сети складывали её по табличкам но какой-то Профит тут наверняка должен быть потому что мы не могли работать долгое время и не говорить бизнесу Какие Мы молодцы собственно это схема сервисов которые на данном этапе используются в направлении devnet про настоящую Вот эту вот автоматизацию нажать на кнопочку и всё полетело тут нету практически ничего Разве что только avx в котором живут то у нас есть вся информация обо всех изменениях потому что хранит НЛО мы можем увидеть когда что-то изменилось уже более пристально смотреть влоги К тому же ещё и выстроить какие-то взаимосвязи К тому же на этом можно натравить автоматику и тогда закс например будет сам уведомлять уже с конкретным клиентом и дальше ещё и быстро уведомить можно гарантия уведомления о работах или авариях приятная на самом деле штука потому что пока мы не вели нормальный справочник мы хотели например обновить коммутатор инженер заходил на оборудование смотрел какие там есть Клиенты составлял список Вот у него получилось 60 клиентов менеджеры всех уведомили инженер провёл работы оказалось что там был 61 клиент а не 60 которых уведомили ситуация крайне неловкая крайне неприятная но наличие такого справочника который хранит связи с конкретными объектами очень помогает в этой ситуации потому что теперь мы можем просто провалиться в девайс на оборудовании ой в девайс в нетбокс и посмотреть какие услуги с ним связаны ещё полезная плюшка - это детекция аномалий в конфигах оборудования У нас есть коллектор который постоянно ходит и смотрит в эти конфиги постоянно разбирает их на составляющие и он знает примерно как должно быть сконфигурировано если он видит что-то Неожиданное он составляет репорт и этот репорт улетает на первую линию поддержки со словами ребята разберитесь пожалуйста это так не должно быть плюшка которая не то чтобы очень полезно для сетевиков но приятно для бизнеса это интеграция с биллинговая ситуации когда клиент за что-то заплатил некоторое время этим пользовался потом попросил расформировать Но в договоре это не отразили если мы нашли что в договоре это есть то есть в биллинге это присутствует а факту на оборудовании это не предоставляется то нужно срочно идти к клиенту и выяснять как это произошло и как это решать Ну и в обратную сторону тоже бывают такие ситуации что мы что-то предоставили а денег за это взять забыли Так что бизнес радуется Ну и просто бонус - это скорость поиска информации если инженеру что-то нужно узнать то он может пойти в нетбокс и посмотреть это удобно быстро и красиво но всё ещё ничего про настоящую автоматизацию ничего про конфигурацию сети надо как-то переходить в эту сторону и начинать составлять конфиги для того чтобы составлять конфиги сетевого оборудования нужна какая-то система которая знает всё про услуги знает всё про клиентов знает главное из чего эти услуги составляются и как они выглядят на оборудовании и обязательно Эта система должна знать что уже есть в сети чтобы не устроить никаких конфликтов и кажется такая система у нас есть Осталось только дорисовать туда кнопочку собственно справочник услуг отлично преобразуется в визор для генерации конфигов потому что он всё знает у него есть вся необходимая информация и более того он внутри нетбокс поэтому всё что не касается услуг он берёт оттуда и в таком случае инженер должен просто выбрать услугу которую мы хотим предоставить выбрать какие-то опциональные параметры необходимые для конфигурации этой услуги дальше автоматически в нетбокс выделится сеть ВН зарезервирован задание на кроссировка и улетит в отдел СКС сгенерирует ID и дескрипшн которыми Потом можно будет подписать в конфиге эту услугу чтобы когда ты читаешь конфиг На железке было сразу понятно О чём речь и сгенерирует конфиг для всех задействованных устройств и на этом этапе мы отдадим конфиг в руки инженеру мы не будем его никуда автоматически раскатывать мы просто скажем вот тебе железки на эту железку вводи этот конфиг на эту железку вводи другой конфиг на третью железку вводи этот Постарайся не ошибиться как сделаешь расскажешь У нас был менеджер справочника менеджер справочника - это такая штука которая смотрела что привёз коллектор в netbox и распознавал в этом всём услуги Ну вот самый простой пример - это аренда интерфейса э Просто если на интерфейсе что-то сконфигурировать это в справочнике но сейчас как будто бы это не актуально потому что у нас исходящей точкой для услуги становится справочник и э ты нажимаешь на кнопочку в нетбокс уже всё есть и уже эта услуга есть в справочнике значит менеджер справочнику получается не нужен но не тут-то было всегда в компании бывают гиперактивные джуны Я их так называю это человек который не то чтобы очень опытный он пришёл он ещё не очень знает как тут всё устроено и он решил что он сконфигурировать что-то самостоятельно не будет ни в какие справочники заходить никакие визард нажимать Он просто пойдёт инфит И вот он залил конфиг на оборудование и получается что на оборудовании услуга есть а на а в справочнике нету но тут нам поможет переквалификация менеджера справочника в детектор гиперактивного Джуна детектор увидит точно так же что приехало что-то с оборудования чего нету в справочнике но теперь вместо того чтобы создавать эту услугу в справочнике он пойдёт к старшему инженеру и спросит а точно это надо так мы действительно продали Вот это нам ну реально это надо добавить в справочник если инженер подтверждает что Да действительно такая услуга предоставляется и всё как положено то эта услуга добавится в справочник и скорее всего произойдёт серьёзный разговор с гиперактивным джуном А если оценивать Прогресс На этом этапе то мы победили плейбук они не могли найти ВН они не знали ничего про клиентов они не понимали логику наш прокачанный откормленный на стероидах всё это знает Он может выделить порт ВН сеть Да и любые свободные ресурсы какие там учитываются он знает всё про клиентов потому что интеграция с мастер справочником творит чудеса и он понимает любую логику если её понял разработчик просто нанять более сообразительных разработчиков и дело в шляпе если вернуться к нашей гибкой шкале оценки степени автоматизации инфраструктуры то мы находимся здесь это уже Зелёная зона в зелёную зону нас переместилось оттуда что в начале когда мы оценивали масштаб проблем Мы просто сели подумали что именно Мы хотим решить выделили вот эти четыре проблемы расписали их в джире и просто по степени выполнения этих эпиков можно ориентироваться в этой шкале соответственно не то чтобы много нам осталось Мы решили три из четырёх проблем которые нас больше всего волновали инженер больше не тратит время на поиск свободных ресурсов потому что это всё делает нетбокс он уже знает что занято и он легко находит среди этого свободное то же самое время не тратит и клиент на ожидание К тому же инженеру больше не нужно самостоятельно рожать конфиг ни в какой из ситуаций с популярными услугами поэтому тоже на этом этапе происходит некоторое ускорение Ну и текучка кадров сильно снизилась потому что время заниматься более интересными задачами которые способствуют их развитию Единственное что отделяет нас от попадание в абсолютно зелёную зону это человеческий фактор всё ещё у нас есть в цепочке поставки услуг человек живой инженер который должен донести сгенерированный конфиг до оборудования Значит нужно как-то деплоить Прим автома ис чтобы ничего не рассыпалось есть очень много способов деплоя конфига на оборудование есть avx который у нас уже развёрнуты а есть варианты ходить через AP или ncf есть вариант ломиться напрямую по SS или даже через telnet Прости Господи а есть питонов ские либы способов много Но несмотря на то что почти каждый из них обладает своими неоспоримыми преимуществами есть и один общий минус у всех это всё нужно интегрировать а чтобы интегрировать нужно протестить причём во всех нюансах Потому что критичность тут достаточно высокая А вот эту вот огромную махину в которой одновременно живёт несколько сетевых топологий которая 15 лет развивалась без автоматизации и её Конфи можели живые человеческие инженеры которые всё ещё ошибаются и все эти 15 лет Они то и дело ошибались иногда ошибались по мелочи это соотвественно даже могло быть незамеченным Вот это всё не получится воспроизвести в тестовых средах Ну вот никак только если за очень много денег но построить ещё один такой же цот и просто залить бэкапы мы не сможем никогда поэтому получается что до тех пор пока мы не причеши сеть не избавимся от легоси не избавимся от просто хлама мы не сможем нормально тестировать А если мы не сможем это нормально тестировать то рано или поздно что-то упадёт причём скорее всего Однажды что-то упадёт Так что мы проснёмся безработными вывод надо просто не деплоить потому что ещё К тому же мы начнём деплоить что-то автоматически там же куча софта будет там будут всякие статусные модели чтобы это отслеживать нужно кучу разработчиков нанимать нужно учить менеджеров работать с разработчиками нужно учить разработчиков работать с сетевика нужно учить сетевиков работать с разработчиками и с менеджерами которые умеют работать с разработчиками ситуация сложная это разворот процессов Ну примерно на 180° причём по половине компании а Народная китайская мудрость гласит не дёргай руль на большой скорости вот вообще никогда особенно если ты несёшься На огромном пассажирском автобусе ком в принципе является наш цот у нас было три главных шага это сбор информации в NB это разработка справочника в котором всегда всё самое актуальное и привязано к конкретным сетевым сущностям а не что-то абстрактное и разработка визар через который можно сгенерировать конфиг для устройства и вот эти три главных шага которые мы сделали которые решили нам большую часть проблем которые у нас больше всего волновали делают четвёртый шаг не таким уж важным и ценным вот эта вот настоящая автоматизация где ты нажал на кнопку всё полетело это меньше из тех проблем которые мы хотели решать Ну точнее как мы по сути не решили её только наполовину потому что инженер остался не полностью в этой цепочке мы сильно сократили ему количество мест где он может ошибиться а риски если интегрировать автоматический деплой очень большие и Ну если мы проснёмся безработными потому что нас уволят это не страшно страшно если мы просм безработными потому что компания закончится это произойдёт если положить вед на несколько дней ситуаци Я бы этого очень не хотела но если мы продолжим прокачиваться на вот этих трёх шагах и соберём абсолютно всю информацию вбок сможем распознавать автоматически любые услуги даже с самыми сложными параметрами самые нестандартные сможем их автоматически конфигурировать то это подстелить нам соломку и поможет затормозить вот этот огромный несущийся автобус и после этого мы сможем плавно руль компании поэтому получается что сначала нужно подстелить соломки И уж потом когда-то мы всё автоматизируем обязательно до конца Но сейчас Это не так важно на этом У меня всё Обязательно оставляйте оценки доклада перейдя по QR коду спасибо спасибо фраза нажимаю на кнопку и всё полетело мне нравится Итак Напоминаю что за лучший вопрос наша фирменная кастомная матрёшка Она крутая есть за что побороться Здравствуйте Здравствуйте Меня Максим зовут и банк ВТБ я понял ваш посыл что не нужно автоматизировать конфигурацию но меня больше всего заинтересовал момент где вы собираете информацию и не научились её собирать потому что вы парси вы же Чуть подальше упоминали про такой протокол как netconf Угу Почему бы не пользоваться им и собирать информацию с помощью него и в netbox сохранять Угу не всё оборудование поддерживает netconf К сожалению нам хотелось максимально стандартизированы всё iOS шестнадцатой версии по-моему это поддерживает не Вся сеть переехала на современное оборудование есть доста все поддерживают Если у вас есть какие-то импортозамещающей современные средства и ещё один маленький момент вы сказали там что абл не может собирать информацию на самом деле Может в АНБ есть факты и модуль который работает с современными железками даже со старыми которым нужно ходить поса инетом он может собирать оттуда информацию просто не научились Наверное мы рассматривали этот вариант но я не помню точно всех подробности принятия нашего решения но не получилось это сложить в систему которой дальше было бы удобно пользоваться Наверно у вас мало разработчиков это кстати очень хороший повод на открыть ноутбук и забу Вики чтобы посмотреть в ЧМ там было дело иногда это не вопрос квалификации А вопрос большой компании большого бизнеса и большого количества разных железок Здравствуйте спасибо за доклад Меня зовут Дмитрий вопрос Следующий вы сказали что у вас есть некий модуль который генерить конфиг который уже в дальнейшем сетевые инженеры раскатывают руками на железку вопро вас есть вы обкатывать все эти конфиги и если стейджи есть как вы выходите из ситуации что в разных версиях сетевого по синтаксис может быть разный У вас что весь зоопарк этих стейджи существует и следом в догонку второй вопрос возникали ли у вас ситуации когда конфиг сгенерированный данным модулем не подходил на устройство ввиду того что там вчера инфраструктурная команда накатила новую версию по или установил какой-то критический патч синтаксис поменялся и там 100 инженеров которые должны были условно на следующий день раскатать конфиги и не могут их раскатать Угу А так первый вопрос Да это общий вопрос вопрос по тестированию То есть как вы тестирует или Бывает ли ситуация когда потестить оно всё равно конфликт случилось кстати лучшей Вопрос вот Я рекомендую трекать тут лежит Ага листочек на котором можно записывать А по поводу тестирования собственно я сказала в докладе что мы не можем воспроизвести все нюансы поэтому мы полагаемся на информацию которую мы знали по сути наша система не умнее инженера первой линии то есть инженер первой линии тоже не пойдёт нигде ничего тестировать перед тем как вводить конфиг он просто соберёт конфиг как он знает что надо И отдаст его проверять кому-то более экспертному вот тут работает примерно та же самая ситуация когда мы отдаём в руки инженеру мы перекладываем ответственность на него а для того чтобы собрать нормальное тестовое окружение нужно сначала причёсывать сеть приводить её к современному идеальному виду в процессе можно Напомнить какой второй был а были ли какие-то проблемы у нас не происходит таких резких изменений То есть если у нас собирается какое-то большое изменение например что-то меняется в синтаксисе Хотя я не очень помню Было ли конкретно так наверное только с новым совсем оборудованием импортом там вот там часто Да такое происходит но в любом случае мы сначала смотрим Что должно измениться и адаптируем уже систему под это чтобы к моменту когда инженер захочет что-то на где-то нажать на кнопочку и получить конфиг уже мы знали о том что нужно по-другому делать подробности Обсудим в ларах Анна не забывай записывать помечать вопросы чтобы потом выбрать лучший это будет сложно наш Следующий вопрос центр зала Спасибо за доклад Меня зовут Денис группа А у меня осталось двоякое впечатление сго доклада вы сделали так много и у вас остался как будто бы один маленький шажок для того чтобы ну настоящая автоматизация появилась чтобы прям делает запрос клиент на услугу и он её получает а при этом я видел что у вас есть такие вещи как avx например внедряемые вы построили опрашивает оборудование и узнаёт была ли заказана услуга на ну на конфиг который появился и выглядит это всё так что достаточно буквально добавить какой-то этап согласования старших инженеров прежде чем применять какую-то конфигурацию на оборудовании Ну о чём я говорю не все операции затрагивают ядро какие-то операции они гораздо ниже и ну условно если автоматически что-то там сломается без работы завтра все не останутся но при этом таких операций наверняка гораздо больше чем операций опасных и вот эти операции можно автоматизировать было бы вообще без согласования а опасные операции поставить на согласование для старших инженеров чтобы они смотрели что будет сходить и либо пропускали либо нет и это уже Ну практически Ну идеальная система была почему бы так вам не сделать а на самом деле понятие о опасных ситуациях тут сильно шире потому что А даже маленькая ошибка например мы случайно переконливо который уже выделен другому интерфейсу ой другому клиенту это может привести Ну к достаточно плачевным последствиям на много миллионов в том числе зависит от того что за большой клиент там сидит Следующий вопрос в правой части зала Да спасибо большое за доклад вот предыдущий слушатель уже отчасти спросил то что я хотел Вот хотелось бы добавить что э вот у вас есть справочник но вы не хотите автоматически выкатывать потому что страшно Но Казалось бы ну человек там может перепутать там терминалы и не в том терминале не то сконфигурировать почему бы не сделать так что он будет через автоматику просто прожимать ну автоматика будет генерировать конфиг сама раскатывать Но каждый шаг будет происходить под контролем Ну инженера наверное тут просто потому что инженеры - это Живые люди и они немножко переоценивают автоматику у нас есть avx и мы достаточно регулярно наблюдаем ситуацию что как только у инженеров какая-то запара они перестают проверять что всё прошло хорошо и потом мы приходим видим что в логах много ошибок спрашиваем А почему говорит ну обычно всё хорошо И вот Чтобы избежать таких ситуаций в более критичных моментах мы пока что не решаем вот буквально 30 секунд позволю себе небольшое лирическое отступление мне как человеку который массово помогает делать конференции очень нравится конференции именно тем что мы можем собраться и обсудить какие-то вещи как вот мы реально делаем на практике не идеальный не какой-то sales spe от производителя софта и серии доставьте наш софт выкатывается всё офигительно будет полная автоматизация вот от людей которые реально в больших компаниях это всё раскатывают и потом в кулуарах обсудить детальки Понятное дело что не все детальки можно будет обсудить здесь под запись со сцен но мы стараемся Мы ведь стараемся стараемся Следующий вопрос и не забудь записывать Спасибо за доклад сейчас мне не даёт покоя й со всеми технологиями и в целом архитектурой Мы же вроде работаем с прямо с железом А откуда там arg CD а arg CD депт то что мы на автоматизировали то есть мы пишем какие-то сервисы для автоматизации и arg CD просто плот То есть я на схеме отразила вот вообще всё что есть у нас в дите Ну за исключением каких-то мелочей типа мониторинга и прочего то есть там очевидно что они есть Вот то есть Ар просто плот то что потом помогает нам в автоматизации Окей то есть прям к самой теме он в принципе вообще никак не относится то есть О спасибо Так наш Следующий вопрос снова центр зала Спасибо за доклат Вот ты много раз сказал про человеческий фактор а потом сказала что вы записываете в дескрипшн маленький и всем остальным и у меня такой узкий вопрос Вот когда запустили свой коллектор в первый раз Какой процент ошибок заполнения смотри первый раз мы запустили его уже после того как мы заставили инженеров пройтись по оборудованию ручками и исправить свои ошибки поэтому процент был Я думаю в районе тридцати где-то так вот 30% ошибок в основном это были мелкие ошибки там на один символ но были и где просто пропустили или подумали что и так сойдёт или ещё как-то так следующий вопрос задняя часть зала чуть левее прошу Да Привет Меня зовут Павел Вопрос такой опять чисто такой технический с самого начала что есть инженеры которые криворукие Да ну я просто про себя говорю что вот невнимательность - Это первый фактор Как вы когда переходили убрали ВС это невнимательность Вы же ручками всё это дело вносили в нетбокс как вы это дело Отвали убрали Эти ошибки они бы критичными и насколько они критичны сейчас просто вы когда говорите что вот вы выдаёте конфиг этот конфиг должен раскатать инженер Но он же тоже может ошибиться самого инженера кто-то потом проверяет касаемо того как это всё вносили я так понимаю этот вопрос стоит разделить на две части вносили вручную минимальное количество информации поможет Это дальше Всё разобрать То есть это название оборудования Собственно как зовут железку это менеджмент IP adress как на неё ходить расположение в стойке какая там платформа какие-то такие базовые достаточно штуки дальше мы на это всё натравлю коллектор и коллектор уже создаёт интерфейсы создаёт адреса которые там есть единственное что нужно сделать - это правильно создать шаблон железки потому что в зависимости от модели Там могут быть абсолютно разные интерфейсы в абсолютно разных комбинациях и так далее вот за шаблонами надо следить но шаблоны просто создавали медленно вдумчиво и по-моему даже заметная часть была просто взята из он сорса детали про дабл тест Обсудим в кулары следующий вопрос из чата внимательный слушатель заметил что на скриншоте в статистики нет B было указан VLAN 5.000 какой-то но у V в основном ограничение на 4.096 вот что там было там показываются количество сколько у нас Вла нав Вла нав действительно больше 5.000 по-моему со времён как был сделан этот скриншот уже даже и побольше А дело в том что Вла могут запросто дублировать в непересекающихся сегментах сети у нас здесь РСО ВН здесь РСО ВН сегменты сети никак между собой не пересекаются поэтому это по факту оказываются разные Вла их нужно завести в нетбокс два раза три раза или Сколько ещё они встретятся автоматика For The Win Следующий вопрос Дальняя часть зала слева Спасибо за доклад У меня вопрос по поводу тридцать пятого кажется слайда ты предлагала использовать UN для автоматизации А скажи пожалуйста почему выбор пал именно на unib а не допустим на со ведь он почти такой же как но Т попул стратегии из коробки что позволяет избежать допустим дрифта конфигураций или также это помогает ещё более автоматизировать систему потому что тогда не нужно даже кнопку нажимать всё будет автоматически раскатывать Угу А тут есть важный момент что у меня команда преимущественно из сетевиков То есть те кто занимаются автоматизацией Это буквально полтора землекопа Ну чуть-чуть побольше и мы вынуждены выбирать самые простые доступные решения и иногда выбор может быть обусловлен только этим что просто абла её знают все любого Джуна спроси он хотя бы слышал Для нас это важно Следующий вопрос средняя часть зала слева прошу А спасибо за доклад Вопрос такой насколько ваша система готова для ipv6 И вообще насколько вы к ipv6 готовы насчёт того насколько Мы в целом готовы к ap6 не смогу ответить наша система готова так себе потому что у нас достаточно немного его внутри и достаточно немного клиентов которые хотят арендовать например адрес шестой версии с ним Мы практически не работаем И давайте завершающий вопрос этой сессии средняя часть зала снова слева прошу Добрый день Николай сбермаркет Скажите в нетбокс вносятся железки они кем также человеком вносятся вот новые железки появляются их также вносит человек то есть это ещё один момент где автоматизации никакой нет и там человек может ошибиться опять это человеческий фактор а полностью избавиться от человеков не получится Не знаю к счастью или к сожалению Тут уж Каждый решает сам а но Ну ладно в теории если так уж прямо задуматься Да можно интегрировать складские системы с нетбокс но нейминг оборудования э его адресация просто где его с Конфи изначально всё равно человек так или иначе понадобится и вот минимальную информацию Да внесёт человек и информацию о том какие физические интерфейсы человек как минимум подтвердит исходя из того какой шаблон у него уже есть Спасибо раунд аплодисментов нашей спикеру и сейчас будет самая сложная задача вот знаешь теперь из более чем из дети вопросов нужно выбрать один автору которого будет подарена наша супрематическая матрёшка Кто этот счастливчик А мне запомнились два вопроса на тему Они были очень похожи из примерно одной области зала на тему того Почему ещё не всё автоматизировано если мы так близко Вот кто первый задал по-моему ты да выходи на сцену выходи так несите подарки го конференции за лучший вопрос Спасибо и нашему спикеру Спасибо за участие Спасибо"
}