{
  "video_id": "4PNRokR22Jw",
  "channel": "HighLoadChannel",
  "title": "eBPF в production-условиях / Дмитрий Евдокимов, Александр Трухин (Luntry)",
  "views": 1533,
  "duration": 2325,
  "published": "2023-01-19T05:55:17-08:00",
  "text": "рада всех приветствовать спасибо что пришли на доклад мы надеемся что вы знакомы с бегом и давайте для начала устроим вопрос кто вообще слышал и знает что такое бифф поднимите руки круто а кто что-нибудь пишет реально но юбилеев но разработчика использовав разработки понятно вот ну ладно будем иметь ввиду что касается название нашего доклада то мы подразумеваем что с эби пифом вы работаете не так просто взял на своей локальной машинки запустилась чем-то поигрался мы будем рассказывать тех условиях когда вас из гигантский парк каких-то разнородных машин виртуальных машин кластеров кубер notice of и так далее на которых подано реальная большая нагрузка не просто отрастить какую программку а реально с какими-то большими нагрузками давайте начнем еще раз представимся меня зовут дмитрий таким вот я являюсь основателем и техническим директором компании ландри и со мной мой коллега александр и звонки разработчик походную баню и вообще как вы наверно поняли целевая аудитория наш этой компании которые либо уже используют либо планирует использовать решение на основе технологии без либо разработчики которые пишут сейчас что-то на технологии использовать их налоги где-либо планируют использовать ее непосредственно у себя в разработке небольшой дисклеймер мы в своем решении алан при которой у нас предназначена для обсе рабби лети security сами используем технологию лонг и бпф и поэтому весь наш доклад базируется на нашем опыте на том что мы видели у клиентов различных окружениях различных облачных провайдеров различных версий я der и тому подобных вещей и мы очень любим это очень крутая технология но в процессе доклада может сложиться впечатление что мы его очень критикуем показываем недостатки и вообще его может не надо использовать просто очень много есть классных доклада привет но его только там хвалят и говорят какой он классный перспективные используйте все да а докладов которые показывают определенные сложности недостатки текущих ограничений вы практически не найдете она вообще пока текущий момент еще мало компании который где ну продукты дела и мы хотим поделиться нашим непосредственно опытом и развеять некоторые мифы легенды и подсветить какие-то определенные проблемы если вы начнёте эту технологию себя использоваться в данном слайде представлена и джеда нашего доклада это основные разделы которые обычно нас спрашивают клиент интересующие непосредственно ландри про безопасность про паркеру и масть про надежность про непосредственно производительность данных решений и вот эти самые часто задаваемые вопросы мы хотели бы вот в рамки одного доклада непосредственно обвинить и рассказать давайте непосредственно немножко введение в тему сам лебедев эта технология которое нам позволяет запускать кавычках произвольный под пользователя в рамках ядра тем самым можно делать такой программируемое ядро операционной системы и добавлять туда быстро логику которую раньше нужно было там добавлять очень сложно муторно те же те же а модули ядра вообще и бпф расшифровываться как extended беркли пакет фильтр но как вы увидите дальше от вот этого она как бы это развитие беркли пакет фильтра от этого акроним а в принципе ничего кроме бук мне осталось это что там пакет фильтр на сегодняшний день не имеет особого смысла это просто одна из его возможности и умеет как вы видите гораздо больше всего при этом следующий момент важно который стоит учитывать это непосредственно в andre van система то есть она начинает работать при определенных событий когда вы получили пакет когда произошел какой-то например системный вызов либо какое-то другое событие другое время она не работает сейчас и бпф очень сильно развивается за ним стоит уже целое большое сообщество ebay подышим даже есть где вот есть различные highload мастодонты которые все определенно знает первым вопросом который вы можете задаться чем типа части удовлетворяет непосредственно модули ядра да вот они же есть там можно делать вообще что угодно и мы сделали сразу же водную табличку которая показывает непосредственно состоянии вот по наши и jedi по тем или иным вопросам чем модули ядра отличаются непосредственно технологии baby dan модулях ядра вы можете сделать все даже больше чем на египете но у них есть определенные проблемы как раз в пользу которых и делают выбор и те же не знаю operations инфраструктурные команды например у нас в lan 3 раньше было две версии реализации виде модуля ядра и виде непосредственно и без программы когда мы это говорили непосредственно инфраструктурным командам ни одна инфраструктурная команда не согласилась запустить наш модуль ядра они сказали нет как бы ну понятно почему если модули ядра ошибка падает все но да все контейнеры которые там были все складывается асию билет программа не смотрят абсолютно позитивно на этот момент и разрешает непосредственно это все запускать стоит отметить что и без очень активно развивается он появился 2013 но такую особую популярность непосредственно получил наверно последних года 45 до и он непрерывно развивается в каждой версии ядра что-то новое добавляются улучшаются но в общем это непрерывно развивающая вещь это что есть его может понравиться в одной версии возможно это очень ранняя версия у вас с вами в текущей версии то что использует продакшене нет при этом мы сосредоточимся именно на операционной системе linux хотя лебедев уже начала проникать в другие операционные системы вот в 1021 начали например также к microsoft для windows это делать но стоит сразу же понимать что в linux это как бы ее родная подсистема ядра да и все пытаются каким-то образом забрать другие но это не значит что все что можно в linux vi веке вы тоже самое можете сделать и в той же windows на текущий момент виндоусе можно ну только очень ограниченные возможности там с пакетами поработать и все все остальное там нельзя так что это не равнозначная поддержка в других операционных системах такая же не равнозначность есть и непосредственно с точки зрения архитектуры процессора до есть множество непосредственно поддерживаемых архитектур но самая родная для нее это непосредственно x86 в итоге имея ввиду том что у нас есть огромный выигрыш с точки зрения стабильности и надежности работы и baby программ которые всех непосредственно платформенной команды а спокойно смотрят на их запуск но при этом также нужно учитывать что чем новее у вас будет ядро использовать тем больше непосредственно вы получите преимущество от этого что касается возможности где вы сейчас можете увидеть применение и бпф технологий да это у нас непосредственно сетевые решения и решения связанные с ибп сервами лети решение связанные security в общем везде где требуется некоторых интернет секцию происходящее instrumentation происходящего вашей системе да вот эта технология себя уже зарекомендовала обращает внимание что тут не только сетевые решения а потому что часто вот этот пакет фильтр да ну как бы фильтрация пакетов нет а эта технология уже за это непосредственно вышла при этом и бпф он скрывается различные типы программ на сегодняшний день юханнус для последних версий ядерном около 50 их условно можно разделить как раз вот на эти три категории там на сетевые на об серванте на безопасность непосредственно это очень условная да потому что можно и другими не знаете метро и split into my например решать задачи связанные сетью поэтому очень не равнозначно и такое здесь у них распределение и бебето вы можете в принципе дотянуться до любой части там либо файловые под системы либо сетевой подсистемы да и решать с помощью вот этих точек внедрения те или иные свои задачи вот например у нас в антрим и вообще не используем вот такие папа типы программ как traffic control и xd беда которые работают сети сетевым пакетам но умеем например строить сетевую карту потому что мы просто через три из plant и собираем систему информацию системных вызовов которые там но отправка данных получение там сифри стенд и так далее и можем строить взаимоотношения сам трафик мы не лезем и например независимо от размера трафика который у вас вообще там ходит а естественно когда мы говорим о больших нагрузках компании сейчас активно используют различные системы контейнеризации оркестра тары типа uber нацистов и так далее всегда появляется вопрос а какую бебето стоит ситуация непосредственно с контейнерами и bf отлично дружит со всеми нативными непосредственно под системами самого linux ядра и классические контейнеры и мы поднимем подражая те которые построены на базе control groups in space of он прекрасно видит и понимает их контекста может сказать что в каждом контейнере работает тоже такой то процесс таки это трафик туда ходит какие-то события там происходит но если дело касается непосредственно различных сын баксов микро выемок просто в мак он не понимает этот потому что эти сущности работают под отдельными своими ядрами они на has to go by dre и он не понимает контекст да если у вас микро венки что-то происходит он не вам не создаст контекст и не объяснит в том же вот например микро выемки фар gates were квестах есть запрос чтобы сделали поддержку там где бпф а и в рамках этой микро выемки можно было бы запускать лебедев программу тогда можно будет понять что там происходит иначе нет вот таким образом получаем что для разработчиков есть огромные возможности всего реализовать не только связанные сети это вот такой устоявшийся миф то что а и b pf вот все сразу только для сети делаем нет можем делать ее security решение можно делать и всегда билете решения при этом стоит учитывать что уефа очень плохая документация сожалению большинство информации вы будете получать либо из исходников ядра либо из рассылок либо из каких-то уже готовых примеров больших решений сожалению это так ситуация теперь переходим непосредственно к разработке тут я слова передаю александру под которой как никто знает каково это немножко поговорим про разработку ну начнем с того что любое решение двух частей пользовательский части изъедены гибель пивку откупаются в контексте ядра поэтому он составляет единую часть это было несложно что ж у нас включается пользовательскую часть ну как минимум нам нужно как-то загрузить один вход в ядро за это как раз должна отвечать пользовательская часть кроме того нам нужно еще как-то осуществлять взаимодействие между пользовательской части ядерной части для какой-нибудь динамической смены настроек для того чтобы передавать изъеденной части события пользовательскую часть где мы смогли бы потом осуществить какую-нибудь обработку этих событий и загрузки кодов ядром обычно используется какая-то библиотека в принципе можете сделать это вручную но на самом деле там очень много разных операций то есть кроме непосредственно загрузки нужно еще провести релокации кода нужно загрузить настройки инициализировать кучу вспомогательных структур короче говоря в лесу это делать лучше не надо вручную имеется ввиду общаясь с ядром через системные вызовы лучше использовать библиотеку например лебедев библиотек с названием недвусмысленно указывают чем она занимается за что отвечает она кстати разрабатывается синхронно с ядром пусть она в том же репозитории содержится что ведром есть другие библиотеки вот вернемся к ядерной часть ядерную часть обычно пишут носить это неудивительно геометрию части этой беде вход потому что это неудивительно потому что сам код ядра тоже написано на семь и мы можем перенести какие-то готовые конструкции структуры из ядерные практики в битве вот обычно используется для компиляции м как это выглядит у нас сначала наш секунд с помощью лэнга превращается в конечно начинай представление о в н а дальше с помощью бэг-энда лмм бэг-энда я gpf это промежуточное представление превращается уже лебедев байт-код непосредственно которые можно загружать в ядром вот в принципе вы можете использовать какие другие языки программирования неси если есть соответствующий например frontend отдела в.н. то есть вы можете разрабатывать на си плюс плюс нарасти не знаю много вариантов то может быть даже если кому-то нравится фортран или дельте вот таких особенностей users палестинец там можно использовать практически любой язык программирования при вам больше нравится ну самый популярный отель на си плюс плюс и голову на них много крупных популярных проектов мы в своей практике раз используем ну почему тайны история для отдельного разговора вот вернёмся теперь опять таки 1-ый части к его входу поговорим про ограничения которые накладываются при разработке на этот код я привел туда достаточно неплохой список этих ограничений он далеко не полный я не буду подробно на этом останавливаться но вот скажем возьмем невозможности использования циклов вот вообще представляете какую нибудь разработку на каком языке если у вас нет возможности использовать циклы это довольно непросто потому что если вы захотите обработать какие структуры типа связанных списков или деревьев у вас начнут возникать трудности вы сможете обрабатывать только такие структуры фиксер но размера вот почему вообще такие ограничения и припев имеются они имеются из-за каких-то заявленных особенностей wiped ну то есть то что ели пев должен выполняться за конечное время то есть этот код не может где-то зависнуть в ядре ну например в тех же самых циклах и viper вход должен ограниченным образом влиять на систему то есть он например не может переписать какую-то произвольную памятью и дриада по какому-нибудь указателю как осуществляются эти ограничения темам при загрузке как уже было сказано можно найти предыдущих слайдах срабатывает very fair который проверяет на корректность программу и biped программу в том стрел он проверяет соответствие всем вот этим требованиям большинство этих требований вот тут важный момент что это происходит именно в момент загрузки программы то есть вы можете сколько угодно долго писать ваш ход ohc компилируется вам покажется что все нормально но при загрузке у вас начнут возникать проблему не загрузится и вам ядро выдастся какую-то ошибку и честно говоря с этой ошибки не всегда будет понятно в чем собственно дело да и какой вот этих ограничений вы нарушили то ну вот могу сказать по личному опыту что бороться с этими со всеми ограничениями довольно сложным ну можно в принципе найти общий язык с грифером как-то побороть это все про паркеру имость как вы наверно уже догадались растут есть такой раздел наверное не все так хорошо и спарте ровностью мы упомянем две проблемы которые возникали в том числе у нас осанки довольно распространенным первая проблема это нестабильность интерфейсов ядерных вообще сам и репьев код по себе он прекрасно квартиру им проблемы возникают только когда вы работаете со структурами ли объектами ядра вот самая распространенная проблема это с ядерными структурами с обращением по полям этой структуры вот тут можете видеть пример такой какой-то произвольным скажем структуры вас интересует определенное поле в этой структуре но в новой версии ядра допустим эта структура была расширена в нее добавилось новое поле поэтому конкретно интересующая вас поля она сместилась то есть она будет доступна по другому ops эту вот это важно при компиляции компилятор должен знать ну почему вообще обращаться то есть какое-то поле вот мы подробнее поговорим про то какие существуют решение этой проблемы дальше но еще упомянул чуть менее распространенные проблемы которые возникают с нестабильностью интерфейсов это когда речь заходит о том что вы привязываетесь каким-то функциям ядре какой-то функциональности которая на самом деле в определенной версии ядра доступно уже в более новых версий хитро может сильно видоизмениться или вообще отсутствовать тут как бы какого-то одного решения нету то есть вам нужно с каждой ситуации разбираться отдельно искать какие-то альтернативные варианты то есть воздух и какой-то план б вот как я обещал мы поговорим сейчас про вот проблему с нестабильностью структур и обращение по полям поговорим про различные решение этой проблемы на самом деле эта проблема уже много обсуждать с обществом поэтому мы как бы тут со мной не открываем никакой америку первое это стабильный интерфейс это вообще не решение этой проблемы просто любопытный момент что вы не всегда можете столкнуться с этой проблемой например если вы разрабатываете какой-то сетевое решение там вам могут не понадобятся никакие обращения к именно структурам hydra там у вас будут только стабильный интерфейс вот например большая часть кода силе ума она вот именно так устроена там нет работы с какими-то внутренними структурами и драм дальше скажем наиболее надежный метод который всегда работает это заголовки ядра вы наверное можете быть с ними знакомы если собирали драйвер для видеокарты под какой-нибудь дистрибутив те же самые заголовки ядра которые используются для сборки модули ядра они же подходят и на самом деле для сборки bpf программа вот их соответственно можно доставить на целевую систему различными образами если вы их используете то вам нужно каждый раз для каждой вашей системы то есть для каждого дистрибутива для каждой версии ядра отдельно собирать лебедев программу вы это можете делать либо при запуске либо как бы заранее то есть иметь какие-то pride собранный вариант ваших программ вот есть еще один такой и сатирический метод мы вот так чисто и привели потому что он попытки вот он используется например of port на linux смена от sysinternals для windows а изначально вот назвали его так условно отгадывания в секс на самом деле там с помощью каких-то эвристик определяются эмпирическим методом офсетной полей вот надо сказать что метод не очень надежно и далеко не всегда вообще применимо просто любопытный метод заодно упомянули sism он довольно интересный проект может посмотреть вот альтернативой заголовком гидра является так называемая концепция компании van стран и времен по сути вся эта концепция сводится к одной штуке которая называется бтф это такой формат данных он во многом напоминает формат для отладочных символов например dwarf он гораздо компактнее ведь его основное преимущество но в целом примерно то же самое вот как он упрощает задачу сборки то есть на этапе компиляции компилятор генерирует таблицу релокации для вашего кода и потом уже при загрузке загрузчик ну например лебедев он смотрит на эту таблицу и релаксирует ваш код так чтобы он смог запуститься именно на конкретные данные системе то есть комп иван сраный пример вот основная проблема здесь это доступность вот этой информации до бтф данных с версии 52 эту информацию может содержаться уже в самом ядре так надо встроенный и оттуда легко забрать ну в принципе существуют и другие варианты я упомяну позже об этом вот тут можно условно наблюдать как выглядит процесс при использовании заголовков ядра и при использовании птф есть принципиальная разница как я уже говорил заключается в том что вот видите в левой части да вот сверху у нас сборка происходит при запуске то есть цена целевой машине при использовании pdf у нас сборка происходит в машине разработчика скажем так то есть один раз да если в ядре по какой-то причине допустим она старая и там выключена опция недоступна бтф то есть появился недавно проект называется бтф хоп где содержится вот эту птф информация для большого количества игр причем проект сейчас довольно активно развивается пополняются новыми ядрами и я бы сказал что уже можно реально применять да вот я тут говорю про разные версии я dirt что что-то работает в одной версии ядра штаты не работает но на самом деле в реальности никто конечно не запускает ничего на голых играх мы имеем дело с какими-то дистрибутивами с какими-то облачными решениями вот мы вообще вот наше решение запускали у многих облачных провайдеров то есть яндекс и mail.ru amazon и google наверное ничего не забыл вот и везде мы это делали достаточно успешно иногда требовалось некоторые дополнительно работа но в том это можно делать то есть с этим проблемы у вас как правило не возникнет вот еще хочу упомянуть про то что есть модифицированные ядра ну например red hat enterprise linux да кстати поддержка там есть 7 версии уже даже 7 версии она туда они и бак парк 0 и с поля новых версий там она довольно ограничена эта поддержка на темени она есть и в общем штука в том что эти ядра немного отличаются от main line ядер и поэтому скорее всего если вы собираетесь их поддерживать вам придётся модифицировать дополнительно ваш код надо иметь ввиду да и говорил что расскажу про две проблемы вторая проблема это прохождение kernel very fair который уже упоминался по сути проблемы в чем в том что кинель very fair может выдавать фолз позитивом то есть что это значит ваш код реально соответствует каким-то требованиям например то что у вас никогда не происходит разыменование нулевых указателей потому что вы где то там в каком то месте в ходе все это проверяйте все хорошо но на самом деле грифер он основан на некотором количестве эвристик поэтому он может это не понять то есть кот нормальный новый refires этого не понимает и вот это вот логика она немножко меняется от одной версии ядра к другой поэтому могут возникать проблемы они еще усугубляются тем что если вы будете обновлять компилятор на разных версиях компилятора разные оптимизации они могут вмешиваться в этот процесс создавать дополнительные сложности вот эта проблема никак не решается ни при помощи заголовков ядра естественно или бдх то есть это параллельная тема вам просто нужно каждый отдельный случай отдельно решать добавлять какие-то свои барды ваш код при необходимости мы все тестировать на всех играх все компиляторы которые вы использовавшего просто зафиксировать и не менять его вообще вот я могу сказать что мы сейчас используем заголовки и драм потому что нам нужно поддерживать достаточно старые системы то есть это я бра 418 и выше поэтому астана вечно заголовках и драмы в принципе смотрим сторону бтф а когда мы начали разработку не было бы tf хаба поэтому мы не знали как это сможет в нашем случае работать со стороны сейчас уже появляются какие-то пути немного расскажу ещё про производительность вообще производительность для и bpf вот это довольно сложная штука она не такая простая как производительность для какого из пользовательского кода ну потому что у вас грубо говоря две компоненты это пользовательский код и или пев ядерные кода для пользовательского кода все более менее понятно для ядерные части же что надо сказать нагрузка она распределяется по системе то есть вашей обе пев программа она работает в контексте ядра в контексте всех приложений она может вашему код может срабатывать в контексте всех приложений которые запущены на системе поэтому она как был распределяется по системе это довольно сложно учесть кроме того нагрузка может быть очень разные зависимости от того что у вас за решение допустим если это какое-то сетевое решение то ситуация относительно простая то что вы можете измерять как вы там справляйтесь с diedas атаками дропа и пакеты классифицируя их как-то в 9 f поле или вы там подменяете какие-то пакеты это можно легко замерить ну на уровне за количество обработанных пакетов или задержки какой-то обработки вот если у вас как у нас об сервами лети решение то все значительно сложнее потому что вы не знаете какая у вас вообще будет на нагрузка вас могут ждать сюрпризы вот наши в нашей практике был один такой сюрприз мы добавляли поддержку пан shift наблюдали такой любопытный феномен что там в контексте какого-то системного контейнера периодически запускалась и лысов не знаете програмы на линуксе она позволяет определить какие процессы используют тот или иной файл системе нам вот это довольно старый вот я не знаю почему там было выбрано такое решение но перед каждым запуском у весов он пытается закрыть все первые сколько-то in сокетов максимальное количество сокетов если раньше там какие-то дремучие времена это было где-то 1100 тафта вот в контейнерах используются повышенные лимиты то есть это миллионы выше и получается что вот этот вот слов в самом начале при запуске он генерирует нагрузку где-то миллион си сколов при чем запускается он достаточно большой периодичностью на многих водах и ну если мы говорим про какой-то классно вот это вызвало нашем случае довольно большую нагрузку потому что потому что у нас было нетривиальная обработка файловых дескрипторов последствии мы от нее отказались это просто про то что вы даже можете не знать и не представлять вообще где у вас возникнут проблемы с производительности вот у нас часто спрашивают когда мы с кем-то работаем что у нас с производители как у нас обстоят дела мы пытаемся у кончила уходить от этого вопроса ну как правило отвечаю что то вроде того что это сильно зависит от того что вы будете запускать на чем вы будете запускать да вот наше решение сейчас дима расскажет еще он правил безопасности ну да спасибо саша и заключающая и раздела это непосредственно про безопасность и вбив ну естественно носил очень очень актуальная тема чтобы понимать может ли это навредит вашей системе до или можно бара дать вам некоторые определенные преимущества при использовании данной технологии во первых здесь стоит разделить всю эту безопасность на два таких раздела как сесть и и security принципе саша просто идти рассказывал про саму непосредственно надежность то что она обеспечивается в эйфорию и определенными ограничениями которые накладываются на возможность то что будет выполняться в и выпивку одину не возможность писать там по произвольному адресу дернула керну спейси да тогда это то что вам не сломает систему и почему любят его адрес напираешь не команды то что можно спать спокойно его в какой-то момент как в отличие от того же модули ядра который способен всю воду затушить всю машину там виртуалку неважно да и бильярд такого в принципе сделать не может и второй аспект это безопасность как самой технологии да и и она зависит от качества кода от архитектуры и момент еще непосредственно как использовать и без для повышения уровня безопасности что касается повышение уровня безопасности то с версии ядра 5.7 появилась такой тип программы как бы пфл с.м. да я думаю если вы знаете такие решения как об armor и linux да это они выполнены как модель ядра и они завязываются на linux security моду скуки и в определенных моментах смотрят разрешено эта операция или нет то есть только с версии 5.7 лебедев позволяет запрещать тот или иной систем в системный вызов до этой версии вы никаким образом не можете запретить тот или иной систему системный вызов то есть до версии 5 7 на и wi-fi можно сделать detection решению да только которая будет смотреть все что вас происходит но с версии 5 7 и вот используя bb fc вы теперь можете делать непосредственно решение на базе превенция надо вообще этот патч ведро сделала команда google и по той информации которая не рассказывали на этом типе программе бы псм они делают свой непосредственно гипс host and ружин при вершин систем чтобы у них на каждой машине в их непосредственно про структуре они могли гибко подгружать динамически менять эти политики ну например в какой-то момент они могут раскатать лебедев программу которая там запретить запуск всех башни либо запуск какой-то версии java да и все если там будут систем на вызовы которая не порождает до точнее правильно вот это будет запрещена до версии 57 никакие запреты и без сделать у нас не может не посредством что касается безопасности самого непосредственно технологии pdf то в принципе как и в любом коде в нем конечно же содержится уязвимости эти узи масти можно использовать для повышения привилегий в контейнер ных средах и тюзе масти можно использовать для побега из контейнеров то же самое можно делать в принципе через модуль ядра здесь в этом плане особых каких-то отличий нет баги находится в основном very фаре какие-то логические уязвимости связаны с ним есть очень забавную живность 2017 года когда very fair можно было обмануть в начале байт-кода выстроить специальную конструкцию которая резко делала выход и very fair проверял грубо говоря первые три строчки байт-кода а потом просто доверял вам но типа и дальше не проверял и там вы могли писать что угодно вот такие были обходы в общем уязвимости там находится что касается использование ebay в вредоносных целях да как вы поняли здесь есть я ряд преимуществ связанных с портированием с надежностью и так далее естественно на это смотрят и security исследователей различные злоумышленники чтобы теперь писать различные бэкдоры руткиты для linux до которых не текущем иметь не так ты распространи за этих проблем можно сказать что здесь и бпф открывает для них новые возможности как раз благодаря вот этим своим непосредственно свои свойства и уже одну несколько лет исследователи смотрят непосредственно то как и wiped можно удобно делать различные атакующие вещи ну его даже последние два примера которые представлены на слайде это реальный вредоносный код от двух подразделений государственных сша и китая которые уже были обнаружены антивирусными компаниями и для своей работы они уже используют технологию непосредственно you baby что касается непосредственно как можно немножко улучшить всю ситуацию во первых версии 5.8 для ограничения кто может вас есть gps программами работать выделили отдельную capability под названием kbps до версии 58 необходим cup сисадмин в общем если у пользователя есть capsis админка побелить он типа ну рут может всё делать но есть проблема что для большинство логики и программ вам скорее всего все равно понравится cup сисадмин и работа под рутом этой программы но имейте сразу виду то что в принципе любые решения которые синий есть на базе без они будут требовать рутой работать под рутом в общем нужно очень широкие привилегии полномочий скажем так как мы можем ответить вредоносному коду вот для тех же модули ядра есть непосредственно возможность подписывать эти модули ядра и при загрузке проверять доверяем эти модули ядра или нет к сожалению для и бпф программ возможности их подписи виду специфики непосредственно байт-кода джек компиляции такой возможности нет но сообщества в это направление сейчас активно смотрит и возможно когда-то это появится но сейчас любой в принципе пользователь с возможности загрузки и dpf программ сможет загрузить что угодно ну даже тоже вредоносную стоишь вредоносный функциональность они пример вот может появиться идеи если вы не заточена и бег он вам не нужен да и вы видите его только какой-то вред вашей системе может появиться идеи его вообще полностью отключить вот естественно вы можете в ядре при сборке ядра отключить соответствующий флаг и он будет тогда полностью ну исключать возможность поддержки а и бпф а но это так себе решение и вот в итоге что мы имеем ну во первых что необходимо следовать принципу наименьших привилегии до чтобы себе входом у вас могли работать только те кто не обходить необходимо работать да и никто более вот и естественно контролировать что этот лебедев код вообще непосредственно делать есть некоторые эстетически анализаторы которые при подаче исполняемых файлов легко до могут рассказать хотя бы на какие бпф программы они используют какие-то мэпс и они использую так далее у вас может сложиться хотя бы впечатление на что завязано та или иная лебедев программа вот но к сожалению с подписью сейчас там дела обстоят ну никак по сути да и когда оно появится неизвестно таким образом мы подошли к заключению что можно сказать да и beef это определенно очень крутая технология и с каждым днем в том же центре фидом складно эти фонды не появляется все больше проектов базирующиеся на технологии a-gps но самое и использование еще не настолько идеально и я надеюсь мы смогли в рамках нас нашей презентации показать есть еще много сложностей проблем которые обычно все решаются а поставьте более свежие ядро да у нас на практике есть клиенты который наверно халси ядром 310 хорошо что хоть что-то борту или на 310 у нас например сейчас разрыв от клиентов поддержки от 3.10 заканчивая там 510 примерно до естественно компании не так быстро обновляются вот и вот использовать более новые версии ядер где меньше ограничений больше возможностей не так-то гибко получается иногда очень везет если клиент живёт где-нибудь в облачном провайдере облачный провайдер следит за активным обновлением я твердо там вот тогда хорошо там можно использовать какие-то перед вы для этого подхода при этом когда вы будете непосредственно например для своей компании либо свои решение делать на базе технологии bf вы должны будете вот действительно хорошо ориентироваться во всех типов и бпф программ потому что одну и ту же задачу можно там решить вот реально несколькими способами можно использовать сетевые любви программы как traffic control xdk можно не использовать можно просто завязаться натра из point у вас тогда вы не будете влияет на трафик вот мы например так делаем и нас клиенты спрашивают а вот у нас там трафик 10 гигабит секунд игры да хоть 100 гигабит в секунду мы просто посмотрим количество информацию непосредственно о системных вызовов там recipe and и все и построим вам сетевую карту как бы на объем трафика нам не важен как бы есть одно преимущество а кто-то хочет не знаю больше пакет или езда тогда это вот уже надо и степи непосредственное traffic control типы программ использовать да поэтому от задачи задачи то что вы будете использовать может очень сильно варьироваться и нужно ориентироваться в в этом всем непосредственно ну и честно скажем что в рамках этого доклада мы не смогли рассказать все тонкости и нюансы и проблемы которые вы можете встретить при использовании и разработки и без программ потому что там есть и проблемы связанные с так называемым time to check the end убью с проблемами счас различные печь быть холстами и так далее в общем если вы окунетесь в эти в этот удивительный мир лебедев вы для себя еще много чего впоследствии открывается но мы хотя бы постарались в рамках этого доклада подсветить основные моменты с которым вот вы стопроцентно встретитесь непосредственно естественно в процессе доклада мы использовали и сторонний материалы и рекомендуем те кто только начинает в эту сферу погружаться вот почитай данный материал и они будут очень полезны на этом у нас все большое спасибо за внимание надеюсь это было интересно и познавательно олег бунин вступительном слове и на следующий день вы для себя сразу что-то начнете делать на и би-би-си это использовать активно вот мы будем всегда рады ответить на вопросы так что пишите если вдруг будет"
}