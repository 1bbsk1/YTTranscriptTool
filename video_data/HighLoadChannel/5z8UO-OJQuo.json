{
  "video_id": "5z8UO-OJQuo",
  "channel": "HighLoadChannel",
  "title": "TDI: высокочувствительная метрика для A/B экспериментов с поиском / Роман Поборчий",
  "views": 698,
  "duration": 2525,
  "published": "2018-01-16T13:09:14-08:00",
  "text": "господа я очень рад вас всех здесь видеть меня зовут роман побор чей и выступая сегодня один но готовили мы накладываем с моим коллегой никитой в общем когда-то давно несколько лет назад мы с ним вместе поработали в яндексе и собственно там мы вот эту штуку и эксплуатировали большую часть времени и значительная часть тех знаний которые я вам сейчас передам она в процессе этой эксплуатации было получено но потом как выяснилось в других местах в других фирмах люди тоже до этого додумались и очень много из этого сейчас и в каких-то публичных статьях конечно же есть не за многие из вас не знают что я последние два года уже занимаюсь презентациями а вовсе даже не технической работой откуда взялся мой мотив вот об этом поговорить о том что я часто работаю с докладчиками которые рассказывают что-то про свои интернет-магазины про свои работные сайты вот про какие такие вещи и они там часто проводят какие-то бы эксперименты бывает я у них всех спрашиваю не буду именно перечислять но со многими я поговорил раз уж попались да и игры вот вы про эту штуку знаете они горят не не знаем а чуть такое и я понял что как-то за пределы поисковиков это знание не выбралась хотя изначально статья была опубликована в 2008 году от которой собственно вся эта штука идет я потому что надо людям все таки рассказать мало ли кому то пригодится верно то что вот этот алгоритм работает только для экспериментов связанных с ранжированием каких-то объектов на это может быть поиск чего-нибудь это может быть поиск в магазине это может быть поиск вакансий это может быть не знаю если вы например будущий facebook а ну миллиарда пользователей например у вас еще нет а лента новостей уже есть а и вы возможно проводите эксперименты потому как ранжировать в ленте события чтобы чтобы чак посильнее залипал и вот это вот эта штука тогда тоже годится вполне еще одна вещь которая похожа на поиск а если что-то где-то ищет или что-то делает ему потом можно выдать рекомендации по рекомендации от на самом деле тоже список и любой эксперимент связанные с ранжированием списков если вы хотите сделать рекомендации или бы такие либо сети и посмотреть какие лучше но вполне покатят еще одна вещь с которой многие кто вот про такой поиск бы разговариваю часто сталкиваются этого такое сопротивление от людей допустим из магазина какого-нибудь которые говорят но что ну я поставил себе что там я поставил сфинкс поставил до или не знаю вы слушали я не занят и не ходил как будто николай самохвалов олег болтунова вчера я ну может быть они рассказывали про то что в подписи уже есть хороший полнотекстовый поиск может быть подскажете себя вообще после шоу меня стоит я буду прямо под грифом искать все нормально никто не ходит через поиск все ходят через каталог моем магазине все еще да зачем это я издалека захожу дату меня такой далекий заход поймете я к делу перейду не переживайте хочу показать что на самом деле вот в этом утверждении телегой лошадь поменяны местами например вот ищем мы что-то такое я постарался стилистические элементы магазина отрезать чтобы было непонятно какое то ищет ищем удлинитель на 4 розетки тут все вроде нормально нашлось 5 товаров но на смущает диапазон цен немножко нас что это такое откуда взялся давайте посмотрим что там внизу внизу там вот на как она туда попала спросим мы ну понятно как попало мы зайдем внутрь по читаем описание этого пароочиститель видим что там есть удлинитель мы и трубки а вот так так так и работает поиск на самом деле на многих магазинах а и мне кажется именно в связи с этим люди поиском и не пользоваться и попробуйте на досуге поискать какие-нибудь сапоги 39 размера например где-нибудь увидите все что стоит 3900 рублей там сразу же или 392 как-то так она все устроено поэтому повторюсь вот это утверждение мне кажется неверным прямо в радикально неверным вот она вот как то так должно звучать сам здесь ну и вообще говоря это напоминает не знаю мастодонты есть среди нас есть такие люди которые пользовались интернетом дугу гуар до искали дополните чем altavista искали на весну она слова искала ватные кислого скажешь она таки ищет но и пыталась большую базу иметь уатта google пришел и все снес рынка на потому что google искал ни слова а то что-то это что ты ищешь да вот и что ты ищешь анкет находят вот если сейчас зайти на адрес altavista если кто помнит вы в altavista digital комнат тут то там ничего нет а digital ком домен вообще на продажу его там hewlett купил и кажется и теперь продаёт потому что ну зачем и тогда да тогда вот еще до гугла заметим люди как делали если вот по теме какой-то новый сайт надо было найти они что делали они вы искали через каталог сайтов если я вот всю били что ещё есть на эту тему мне кажется что это похоже чем то в миниатюре просто но так и вот в этом месте да я должен был бы сказать то вот есть за счет чудесный поиск по ну ничего такого у меня нет не могу ничего предложить мне кажется что та область которая еще случится так вот стали мы все-таки улучшать свой поиск на взяли и стали улучшать ничего-то на улучшали и решили провести оба тест ну какой то такой значит провели тест абэ и не знаю что здесь например средний чек или конверсии но неважно и могут некоторое время так и радуемся а потом приходит препрег приходит кто-то и рассказывает нам про то что надо считать что значимость или доверительные интервалы там приходят к это негодяй и рушит нам всю малину и мы высчитаем доверительные интервалы и они какие-то такие да и они прям все значительные перекрывают ту разницу которая есть у нас между нашими любимыми а и b версиями мы такие уймы катили полгода какую-то ерунду в продакшен обидно а почему так происходит сейчас я попробую должен на пальцах сначала рассказать как то все получается конечно так все происходит потому что у нас внутри вот этого а и внутри б внутри каждой из этих систем данные очень неоднородная а то есть там очень большой разброс поэтому папа ну условно говоря не очень большому объему которая у нас есть мы можем посчитать среднее можем только с очень-очень большой погрешностью прикинуть как выглядит настоящее стены и средняя для всей планеты если бы она вдруг пришла на наш сайт почему так происходит на представим себе что у нас магазина я буду в примерах перескакивать иногда там представим себе что у нас магазин представим себе шоу нас facebook представим себе что еще что-то часто допустим магазин у нас и допустим у нас вот есть какая-то такая клиентка которая нам приходит вот у нее вроде бы все нормально там внутри винтажной машине есть этот стиль на все море город там на заднем плане не очень видно тут но но они там есть вот и если она что-то у нас покупает то она покупает ну вот как то тогда она попала в а допустим допустим что версия бы лучше попал его купит вот столько попала в бы купить там побольше а теперь представим себе что у нас есть еще одна клиентка ведь она вот последнее евро из заначки достала и хочет их нести в обменник ей ну явно не так хорошо и она тоже может быть что-то у нас купят в нашем интернет-магазине же дешевле наверное чем в офлайне вот но она упадет в a и b версию даже если бы версии лучше она купит у нас вот так что здесь важно важно что вот эта богатая тетя она даже если попадет в плохую версию она купит все равно значительно больше чем у нас купят бедная тети которая попала в хорошую версию просто внутри вот этих вот данных есть очень большой разброс различие между пользователями свойства пользователя его привычки а то что он в какую бы версию не попал в первую очередь он похож сам на себя не только в самую самую далёкую вторую очередь что-то определяется разница между мне б но это ладно это свойственно любому оба эксперименту это с этим надо жить эта проблема но не проблема ну как люди чет с этим делают но в поисковых экспериментах в ранжировании каких-то объектов по запросу есть еще вторая проблема представим себе на секунду что мы ранжируем не ранджы рама проводим эксперимент с цветом кнопки и у нас есть красная кнопка есть синяя кнопка так это выглядит примерно на мой взгляд и да ну примерно так могло быть лучше но допустим и что здесь важно что все люди которые попали в а они видят одинаковую красную кнопку по крайней мере вот все люди которые попали в одну половинку нашего эксперимента они все получают один и тот же стимул одно и то же воздействие у нас ну и все люди которые попали в бы они соответственно видят синюю кнопку и это хорошо потому что хотя бы такого внутреннего разброса нет в поиске же все совсем не так а вот пришли люди допустим и люди в а версию пришли они задают киты запросы да и что такое не что такое что-то ищут такое такое такое такое да вот такой ищут видите да это все люди которые попали в а каждый из них получил на самом деле свою родную страницу а вовсе не одну и ту же красную кнопку который мы хотим измерять ну а люди которые попали в бы они ну соответственно что-то еще такое ищут ну париж этого много пальцы какие-то тысячи она где-то усредняется но что она нормально усреднил ась надо естественно больше данных потому что дисперсия там есть еще одна степень свободы в общем из-за которой все это колбасится ну и например да у нас игрушка пожарная машина просто может в базе нашей быть хорошо представлена они 1 ранца май литл понни вас может не быть вовсе и ранжирование которое мы измеряем она в этом не виноват а мы измеряем наше качество ранжирования ответов по этому вопросу и она вообще ни капли не виноваты в том что ну что у нас вот нет такого товара в метрику она естественно попадет вот и так вторая причина почему так происходит запросы у каждого пользователя свои в результате именно в поисковых экспериментах нам очень трудно добиться значимость очень трудно часто стабильно получать результат который говорит что одна система победила другую это опасно вообще-то сейчас расскажу чем это реально такая штука которой если задуматься и все задачи знаете про эти известная задача протест на редкую болезнь на допустим училка есть редкая болезнь он делает тест на нее ну и получает положительный результат теста ошибается допустим в одном проценте случаев болезни это у там 1 1000 процентов человечества есть несмотря на то что тест вроде бы ошибается редко на самом деле его в такой ситуации надо делать несколько раз потому что с первой попытки почти наверное вы попали в fools позитив на вы попали в ошибочный результат вот и вот тут ситуация такая же допустим у нас есть какие-то реально хорошие эксперименты которые нам хотелось бы выкатить они представлены зеленым цветом здесь есть реально плохие ну которые не надо катись в том случае если мы но это истинные значения до который мы пытаемся установить но они нам не известно допустим они такие и ну чё происходит естественно у нас огромное количество фаз негатива вот большая часть из этих реальных зеленых экспериментов у нас получаются как нейтральная или может быть отрицательно поскольку у нас низкая чувствительность мы просто не видим этого маленькую какую-то часть мы таки видим ура а если мы с пяти процентной значимости работаем то у нас еще есть какое-то количество экспериментов которые случайно сработали вот таких ну правда же есть и имеют право все честно у одной и какие то мы действительно честно отметаем и вот если посмотреть то при как жизнь устроена когда мы начинаем только экспериментируют мы там все низко висящие фрукты собираем очень быстро а все что легко можно улучшить мы быстро улучшаем выкатываем а потом уже становится трудно на потому что все простые вещи мы сделали и мы пытаемся пытаемся пытаемся пытаемся еще что-то достать пытаемся придумать и она все не проходит через x переменную не получается вот и да в какой то момент когда у нас реально положительных экспериментов становится мало мы начинаем катить в продакшен примерно половину какой-то рандомных хреней ну реально вот мы вот сколько так осин половина из этого рандомный рандомная чушь а другая половина я таки это реальная нормальные эксперименты и это обидно нам еще если у нас ну вот как сверху картинка допустим было бы мы бы много катили хорошего ну и чуть чуть рандомные чушь его кейну с этим можно жить на когда у нас фифти-фифти с этим жить нельзя то есть вот и основная проблема на вот тут вот находится вот в этой вот штуке и с ней надо что то делать хотел хотелось бы вот что с этим делать в идеале нам бы хотелось что делать нам бы хотелось вот этот разброс между пользователями как-то убрать и кроме разброс между пользователями убрать разброс между запросами и вот в рамках каждого пользователя каждого запроса искать разницу а и потом и и усреднять вот это было бы круто да потому что тогда у нас там в богатые тетеньки мы бы увидели разницу внизу бедные техники мы бы увидели тоже разницу вниз и мы бы их просто усреднения было бы нам счастье ну как это примерно тогда мы хотим делать на считать пользователю поработать в одной системе а потом стереть пользователю память условно вот дать поработать также в другой системе в такой же задачи и потом зафиксировать разницу ура так вот это можно сделать и учиться мы будем вот этих ребят которые во дворе град ну не во дворе в данном случае но в принципе во дворе тоже играют футбол сейчас сейчас я на примере этих ребят покажу алгоритм а потом уже покажу его нам примере поиска на самом деле до важно это это это реально возможно можно так сделать вот смотрите допустим и как вы сидите в игру в какую то игра да они делятся на две команды выбираю двух капитанов и капитан потом начинает набирать себя игроков как-то так это устроено и вот допустим что у нас во дворе встретились две команды выдали капитанов 1 режим а алёша другого назовем bb буря и допустим что есть еще вот такие ребята ну нормально там есть еще наташа в конце он бывает да что в принципе девочка с ребятами футбол тоже играет вот такая такая группа людей и они начинают выбирать у каждого из капитанов примерно свой порядок предпочтений а еще они наверное понимают кто там самый сильный футболист кто нет но они могут расходиться в этом мнении чуть-чуть и порядок выбора у них может быть чуть-чуть разные даже если им это предоставит свободно и вот допустим что у алеши порядок выбора вот такой да а уборе порядок выбора такой изначальный список мы уберем чтоб он не мешался его как-то так они хотят разбираться им надо выбрать каждому себе по три игрока естественно то логично что они сначала делают они кидают монетку правильно да первым может нам камень ножницы бумага не выживаем случае монетка давайте вместе с чтобы было четко что мы следим за происходящим на счет вот допустим монетку вывел алёшин кого он выбирает сначала во сюда из вас туда вот дальше следующий выбор у барри барри видимо наташин раз просто так скорее всего вот и ну и он наташ выбирает логичным не all баре при при при представлении такое это это хороший прикол да это это вот это интересная мысль но вот до этого мы еще не дошли хотя об этом можно подумать да дальше дальше я предлагаю модификацию в этот алгоритм раньше они один раз просто кидали монетку но реальные дети во дворе ладно я предлагаю для справедливости после каждой пары монетку кидать заново так мне кажется будет честнее и рандомные вот и допустим они кидают монетку ну я опять опять алёша соответственно выиграл и он выбирает наконец антона до моря выбирает митю шикарно дальше они опять кидает монетку в эту раз монетку выиграл буря он выбирает диму а соответственно лишь достается denis что мы здесь видим мы видим что ну конкуренция идет за вашу основная но при этом насчет вторые антон всегда достанется алёша в такой ситуации баре всегда достанется наташа и что важно вот этих вот людей в середине можно представлять себе как ранжированный список на вот этих вот этого пула ранжированный список который при этом еще размечен на команды один приписан к одному другой приписано другому и вот на ровно этой штуки да почему собственно алгоритм называется team драфт интер living а потому что вот это называется team драфт на то чем они занимаются по английски алгоритму придумал филе продлен ский который тогда еще по-моему не работал bengi потом его туда взяли я опубликовал статью вот ровно вот эту оригинальную в 2008 году алгоритмами построен ровно потому же принцип он состоит в том чтобы взять ранжирование взять ранжирования б у себя где-то его смешать хитрым образом на про атрибутировать какие-то элементы в а какие то в.б. а пользователю наверх показать смешанное а пользователь будет кликать или что-то делать он будет что-то покупать может быть какие то акции совершать каждое его действие это волос либо во либо в.б. пользователь один заметим он он задает свой один запрос получает одну выдачу которая состоит из двух смешанных просто он этого не понимает и это один человек а то есть мы одному человеку его голову засунули сразу две выдачи и составили выбирать а вот в этом в этом и состоит смысл давайте немножко потренируемся как она работает на вот полный список почти всегда больше будем будем себя представлять что вот величина списка это то что пользователь убить на первой странице а то есть можно смешивать топ-10 если у нас десятки можно смешивать топ-20 если у нас двадцатки зависит от того что пользователь видит сразу ну еще это зависит от того как часто в вашем сервисе пользователь ходят на вторую страницу потому что в принципе и в поиске пользователь на вторую страницу ходят редко и ею можно пренебречь вы просто можно смешивать только первую очень все так делают кто делает и вроде бы это нормально работает вот соответственно 6 просто чтобы удобного выкрали зала но тут может быть их сколько угодно может быть больше может быть меньше так вот обычно эти списки пересекаются но не совпадают полностью и собственно есть такие игроки в команде б которых капитана никогда себе не выберет потому что они у него где-то очень далеко это нормально ну и так это работает вот допустим бросили монетку выбираемого товарищ убирает б бросили монетку допустим опять выиграли це ж теперь вы играли здесь на естественно d и е а если монетку выбросить по-другому допустим он по-другому решили раскидать допустим этот товарищ выиграл сначала б.а. что выберет давайте со мной c отлично да те же ну и дальше понятно радость смешанная выдача может получиться разная в зависимости от того как у нас монетки летают и сразу сразу же и если вы этим заниматься то тут есть целая куча оптимизации которые можно проделать в частности есть такая штука как общий tube и и еще брадзинский то же самое 1 статьи упоминал что наверное так что делать и действительно это работает лишь и если у нас есть одинаковые элементы наверху за которые собственные конкуренция на там и ну как там кидаем монетки неважно как мы кидаем в смешанном топе они все равно будут такие же да и кроме того клики в них не несут никакой пользу никакого сигнала а потому что не важно как они приписаны ручек и так и так в это место кликает вот а при этом если их реально раскрашивать и приписывать той или иной команде то они нам увеличивают дисперсию да потому что там то то в одну то в другую и зачем это надо чтобы этого не делать предлагается действовать вот так то есть мы их нормально смешиваем но потом не учитываем в расчете клики в те элементы которые одинаковы для левой и правой системы вот и в общем это работает вполне нормально но там есть конечно ряд трудностей о которых мы сейчас поговорим в 1 часть трудности это организационные трудности как это ни странно этим сейчас мы опять через через простую секцию пройдем а потом махинация хардкор да извините вот организационная трудность первая такая что скажет эксплуатация клевая штука давайте внедрять что скажет эксплуатации мы через это проходили действительно она это говорит но надо просто с ней бороться в этом месте эксплуатация скажет вот что-то вроде того ну вот она реально скажет двойная нагрузка на бэк что за хрень ты действительно есть есть такая проблема что нам надо для одного запроса задать два запроса на бэк а вместо одного потому что нам надо 2 выдачи получить ну что делать очень надо просто с этим как-то жить но в общем это нормально вот она я понимаю в чем проблема тут некоторые смеются у вас может быть просто поиск не так ну не такая большая доля собственно того что я сервер в яндексе поиск это это все что там есть ну там практически да и соответственно двойная нагрузка на поиск ну это тяжело потому что и потому что там реально много этой нагрузки в ситуации когда у вас немного увеличит ее в два раза трудно это правда но в ситуации когда мало ну конечно легко вот вторая неожиданная проблема которая тут возникает это уж надо про мировой а если вот эту штуку и и сзади в общей this каких-то готовых компонентов трудно потому что и нету нефига этих компонентов программировать казалось бы вот я давайте тут есть несколько минут я историю расскажу казалось бы чё там программирования написали про случку она принимает запрос сюда спрашивают туда спрашивает получают результаты собирает их ну это все gebo тривиальная задача дают надо влоги записать чтобы знать кто откуда пришел и потом вот это собранная отдать обратно верстку чтобы она это все завер стало так же как она бы каждую из половину кристалл казалось бы ну взял сделал тем не менее еще когда я обработал ли она честному наши кроме большого поиска есть еще много всяких ну специфических узко узко специализированных вертикальных поисков они там сами чуть-чуть работают но мы конечно общаемся и вот правда приходит ко мне пьем из какого-нибудь из этих поисков и говорит ровно ту же метриками занимаешься давить метрику нам запилим клёвую in вот смотри штука такая вообще давай запилим уходит думать где-то через год от этого же сервиса ко мне приходит уже другой пьем потому что ты куда-то делся вот вид рома занимаешься метриками давай запилим какой-то метрику нам негру штука а причем треть и ладно бы это смешно было если бы они через год с одного сервиса приходили и же много то есть они ходят там регулярный и ни один не сделал и кроме большого поиска и бы вот ну может быть уже сделали не знаю с тех пор но в общем нет в общем надо программировать это на самом деле удивительно проблема но тут вот нашлась библиотечка вот такая которая чего-то для этого делает она на питоне правда написана и она из академии то есть это какой-то университетский чувак я написал но ничего про нее не знаю у меня нет production опыта использования библиотеки а вот она просто нашлась ну не могу ее не рекомендовать не не рекомендовать ну просто вот она есть но кейт и дальше технические трудности в эксплуатации этого алгоритма есть подводные камни первый подводный камень не знаю сталкивались нет и из поиска нам просто это сразу понятно может быть вы это тоже видели у людей есть такой паттерн поведения и он не запоминает себе какой то документ на а он его ищет поисковике причем он знаешь вот такой вот то что мне надо то куда я регулярно хожу она в яндексе на третьем месте не сталкивались с людьми которые так делают не заходят и вот он знает вот я задам запросы на третьем месте вот будет вот эта страница я туда хожу нет не только итану бабушки еще всякие в от дедушки и когда алгоритм меняется вдруг и вот эта штука уплывает куда-то тоу чика прямо трагедия потому что он реальный он не помнит этого сайта он не знает как на него иначе попасть а вот была привычка такая он ходил вот эту привычку не надо ломать потому что пользователи очень бесится когда она ломается а поэтому нам нужно консистентной это важно что если пользователь задал нам кто-то забрал когда мы ищем товар например магазине муж тоже там что-то поискали посмотрели потом поискали что-то другое посмотрели потом нам оно не понравилось мы вернулись к первому ну я на самом деле когда отчета покупаю выбираю я время от времени perry задаю запросы которые я уже делал это нормально так так часто бывает у меня будет обидно если она будет колбасится наш ум она не колбасило важно что вот это вот монетка которая у нас есть она как-то завязано да ну не равно завязано должна быть на хэш от юзера и запроса на то есть очень важно чтобы у нас один и тот же юзер если он задает тот же самый запрос а чтобы в этом случае монетка выкидывало с теми же самыми способами чтобы у него выдачи получалось строго та же самая не прыгала туда сюда туда сюда вот это это важно очень соответственно кроме консистентной sti вот связанные с нею когда мы делаем к систем то есть мы усугубляем вторую проблему с которой надо бороться но вас это может не касаться потому что я ничего не знаю про мало знаю про магазин лишь и в магазине штамм конверсия там же не любой клик хороший да в поиске нету конверсии как таковой а поэтому там ну там есть dual time скучает провел на странице но это сложная тема зависит от запроса очень сложно при покупках там же человек либо купил либо не купил это более сильный сигнал на мой взгляд если мы считаем только покупки но если вы этим занимаетесь то вы наверное лучше чем я это знаете короче покупка это сильные сигналы может быть от того что мы чего-то человеку там подсунули на первую позицию вместо 2 это не не так сильно сместит его желание купить но надо пробовать но тем не менее на конечно же первая позиция получает преимущество а если мы выкидываем а не надо следить за тем как часто у нас а и b получают монетку для первой позиции потому что кажется что если много то фифти-фифти она монетка это как она называется то распределение но короче блин с монетка но похоже на нормально нанако бы таким же колокольчиком на самом деле и почти всегда она вот в этом колокольчики близко к центру но при этом имеет право сколь угодно далеко уходить от центра время от времени есть такое у него свойства что можно кинуть то монетку 30000 раз и получить ну не знаю условно 15500 одних и 14500 других а и для поиска вот такого уровня смещения уже портит нам весь эксперимент потому что первая позиция получают больше внимания на это вот надо за этим следить то есть в случае каждой конкретной задачи каждого конкретного сервиса может быть от надо как-то нормировать ну и а отсекать те ситуации когда у нас получилось неудачно и первая позиция вывел их слишком часто вот ищет еще одна штука которая тут есть эта зависимость данных внутри одного пользователя зависимы запросов пользователей за если кто-то год назад мой рассказ видео про грабли оба экспериментов там я тоже рассказывал про зависимости ожидая действия пользователя на самом деле зависят друг от друга ну во первых потому что это один и тот же пользователь на поэтому у него есть привычки какие-то общие поэтому он в принципе в одних и тех же запросах ведет себя сходным образом а кроме того действия зависит от того какие результаты он получил в прошлый раз я рассказывал на примере измерения цвета глаз не знаю видели не видели но не суть в общем смысл в том что действия пользователя зависят друг от друга и поэтому нельзя просто взять все клики ну вот как то так взять все клики которые мы получили там в одну и другую систему и просто вот этот массив тех и других ликов засунуть куда идти тест но вот прям взять и засунуть и тасс нельзя потому что те тест предполагает что все измерения которые есть внутри масел и независимо друг от друга и это важно то есть он реально ломается он реально будет чаще чем надо выдавать вам положительный результат эта зараза такая вот и на самом деле все на это наступают тоже кому не придешь никто об этом не задумывается все засовывают все эти тесты у них получается например даже на контрольных экспериментах самое яркое что я видел я видел вместо пяти процентов насчитали пятипроцентной значимости вода еще взяли большой группы контрольных экспонентов из них 30 процентов далее результат что вот у нас до тех пор пока они этого не делали они не знали она потом буду знали сделали и ужаснулись и стали делать лучше живут просто братья засовывать это в титейс нельзя начина до либо как-то свести это к одной цифре на пользователя то есть сначала у средней всего внутри пользователя брать число от пользователя либо есть другой способ который хочу вам предложить звучат будет хардкор я не уверен что этот хардкор у меня хорошо получится но я постараюсь значит есть такая штука значит она называется bootstrap статистически mene ne bootstrap фронтэнда вы и framework на а bootstrap статистический метод эти поднимите руку кто вообще и как бы в курсе что это за штука такая да круто но значит значит давайте пойдем вместе еще смотрите вот допустим у нас есть кое-то множество элементов и мы по нему хотим посчитать статистику пусть это наши пользователи например или наши клики неважно пользователя допустим мы хотим посчитать по нему доверительный интервал для какой-то статистике то мы берем вот каждого из этих товарищей ищут с ними делаем что мы делаем мы вот из этого большого сэмпла делаем еще много таких же а выбирая элементы из него чтобы sample получился того же размера но с повторами надо есть например вот как-то так это может выглядеть смотреть 1 да вот вот из того самого получился вот этот потому что мы какие-то элементы взяли какие-то не взяли ну случайным образом или или так может быть совершенно совершенно другой вода получается вот какая то такая штука и потом мы берем их много да и по каждому из них тоже считаем ту же самую статистику мы можем там там учетом средне или там не знаю средний чек на юзера и вот по каждому жыть можем усреднить средний чек на юзера а если мы возьмем не 2 итерации а 10000 например на возьмем 10 тысяч надо чувствовать и получим вот по значению для каждой потом запишем их массив массив от сортируем от сортируем а и возьмем не знаю 205 первую позицию и 9750 важно что это ровно девяносто пять процентов длины массива до 10000 от 9 планет еще нас получается то вот эти вот элементы x и y они как раз будут границами доверительного интервала на 95 процентов для этой статистики ведь сметчик вести реально реально очень трудно в голове у себя уложить почему эта хрень работает действительно но она работает вот и она удобна когда нам не сделать когда нам не свести всё к одному числу на пользователя или мы не знаем как это правильно сделать какое-то трудно вот тогда такую штуку можно применять то есть в нашем случае мы на самом деле как считаем мы считаем что по кликам на усредняем клики обут стропил мы юзеров здесь мы вот у нас есть множество в данном случае из допустим 7 юзеров мы из него создаем еще 10000 множество 7 юзеров при этом мы из каждого юзера тащим все его действия надпись мы не можем там один клик взять другой не взяли дамы вот если берем юзеры то мы берем все что он притащил нам все его события а и и после этого вот из получившегося уже папу по событиям по кликам можем считать какую-то статистику а и вот так мы это делаем и это реально работает и это нас спасает от зависимости то пишет это это учитывает весь и мазь внутри действенного пользователя на мы вместе с пользователем тащим все что он наделал вот и так это работает до тыс так это можно сделать в общем про bootstrap при случае посмотрите если вдруг вам статистике надо считать он bootstrap он не mapreduce френдли единственно что если у вас реально большие данные если у вас не знаю вот в этом массиве не 30 тысяч кликов а несколько миллионов он зараза вообще не лезет в один компьютер да я весь разложен по mapreduce у вас где-нибудь да to boot с трапом его трудно считать потому что прям сделать случайную выборку и из такого массива тяжело вот а 10000 раз совсем тяжело но если она в один компьютер лезет то она вполне нормально работает ну да я я сталкивался ситуации когда bootstrap был у него придет френдли это была проблема действительно но это действительно случае редкий ну и там часто можно все таки как то данные низ агрегировать а упростить то есть там часто бывают записи в которых нам нужно не все иногда нам нужно как-то ужать и тогда они начинают вязать вот в общем важно что внутри и действия одного пользователя независимости ну как то как то надо ее учитывать в остальном в остальном соответственно мы просто считаем мы можем считать либо клики в одну позицию в другую нова и бы либо покупки is a и b либо сумму потраченных денег is a и b ну в общем зависимости от того что нам интересно но мы в любом случае можем это делать и она будет у соединяться внутри одного юзера в руки одного запроса точнее мы разницу будем получать за счет этого мы вот этот разброс можем уничтожить пройдем драфт интерн левин кораблинский написал еще много статей а то есть если вы прочтете первую потом поймете что дальше искать там есть там есть совсем безумия уже на 10 в развитии этого метода общем там интересно там там большой мир за этим всем прячется но я пока вот только вводную часть дал надеюсь что все равно будет интересно в общем если вы не знаю ранжиру эти товары ранжиру эти вакансии если вы ранжиру эти рекомендации или если у вас есть лента новостей на то это может быть вам полезно и с вами был роман по порчей и душой никита буров спасибо вам спасибо было очень интересно слушай а скажи пожалуйста что делать если не только а и б там c и d до то есть дочь надо будет ждать этот значимости нет то есть вот зверь какой какая-то магия а смешивать смешивать 3 я не научился скажу честно но я их умею по олимпийской системе да там а смешивая sbc смешивать вот то есть но но не так надо abcd не так надо abcd на самом деле смешиваешь а у тя есть продакшен а это у тебя соответствие получается три эксперимента а смешанный с б а смешанный 100 смешаны до но нельзя выбирать из них лучшего про каждую из них таким образом можно проверить лучше она чем а или нет она выбрать из них лучшего по результатам этого эксперимента нельзя потому что ну короче нельзя джип философский вопрос друзья 1 там даст больше другая меньше вроде как но на самом деле эти числа нельзя между собой равно 1 по-любому может выигрывать любом случае по всем пока по всем метрикам который ты сравниваешь почему я решаюсь для is a b и c и b выиграл у нас каким-то счетом 42 значит c тоже выиграл у вас каким-то счетом 47 это не значит это не значит что c лучше чем б их все равно надо сравнить между собой бывали случаи когда когда над нетранзитивным короче нас насколько много времени нужно потратить чтобы четыре вариации пробуйте и сок из опыта на 30 тысячах кликов ты получая значимость девяносто девять и девять это очень круто на самом ну на мой взгляд на 30 1000 кликов ты получаешь значимых 99 и 9 не 95-99 европу из говорит короче это очень круто на самом деле нужно если метрика транзите в наследника негативно ну то есть ну то есть если если б выиграла с одним счетом отсевы иглу а с другим счетом то этой это не на это не про транзитивность экспериментов да да не метрика а результаты эксперимента не составляют кабы как сказать-то упорядоченную последовательность таким образом до вопрос если математика не ту мне трудно это сказать в этой ситуации да потому что нет ну я об этом никогда не думал короче ну то есть далеко не очевидно что он транзитивной и но не зря я я повелся да и я я же говорю я пытаюсь тут ничего не невыясненной олимпийскую систему то есть по факту использовали транзитивность нет в этом месте все нормально то есть вот в этом месте все хорошо если а выиграл у b до c выиграл у а нато c и b да это правда надо проверять согласен согласен надо проверять здравствуйте спасибо за доклад я не совсем понял почему мы не можем такую же штуку провернуть с тремя вариантами то есть казалось бы просто подкидываем трехстороннюю монетку и делаем пример то же самое у нас будет чуть хуже значимость нам надо будет дольше это делать но почему это не сработает может быть и сработает у меня просто нет на эту тему никаких никакого практического опыта я я просто не пробовал это делать но так вот чисто теоретически вы меня не видите попробовали это ломает осмотра бывать можно до хотя нет стойте знаете история про выборы их много но про выборы до история сейчас ну история про то что если у меня есть три кандидата но на самом деле я могу но и люди голосуют а то я могу определить кто лучший но не могу отсортировать 2 и 3 между что вот там что-то такое чтобы не знаком и же и хотим определить лучше мы хотим передать но если очень хочется то можно попробовать просто это надо еще программировать спасибо"
}