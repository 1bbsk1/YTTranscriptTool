{
  "video_id": "J5SMaIqgzUI",
  "channel": "HighLoadChannel",
  "title": "Как собрать контейнер и не вооружить хакера / Антон Жаболенко,  Алексей Федулаев (Wildberries)",
  "views": 1563,
  "duration": 2908,
  "published": "2024-10-29T02:37:53-07:00",
  "text": "я с большой радостью приглашаю на эту сцену Антона ленко и Алексея дулаева из компании поприветствуем раз раз раз вроде слышно так А меня слы Всем доброе утро Доброе утро с Сегодня поговорим те контейнер и не вооружить хакера как уже сказал Дима меня зовут Антон Жиленко я отвечаю в валбери за направление безопасности занимаюсь безопасностью больше 10 лет несколько раз строил информационную безопасность с нуля в качестве увлечения преподаю студентам безопасность облачных технологий в МГУ и здесь сегодня со мной Мой коллега Алесей лаев Да всем привет Так Яки из нас выиграли битву с автопати смогли прийти на первый доклад собственно я занимаюсь албес безопасной разработкой тоже преподаю несу знания в свет и мы с Антоном Стараемся сделать мир лучше и безопаснее активно пытаемся Да а и прежде чем переходить к нашей основной теме Как собрать контейнер и не вооружить хакера Давайте поговорим немножечко вообще о том какие проблемы с контейнерами бывают на самом деле Всем вам известно что с контейнерами бывает огромное количество разнообразных проблем и в том числе это проблемы связанные с информационной безопасностью самые типичные проблемы связанные с информационной безопасностью - это Например уязвимые компоненты Когда вы деплоить и собираете какой-то контейнер в котором есть разнообразные уязвимые компоненты то есть известные компоненты с известными уязвимостями а второй тип проблем - Это разнообразные ошибки конфигурация когда либо в среде выполнения контейнеров либо в самих контейнерах допущены какие-то ошибки при конфигурирования и злоумышленник как-то этим может воспользоваться и третья проблема которую мы даже отдельно выделили это наличие OT пользователя в контейнере на самом деле проблема звучит может быть немножко детской Но на самом деле это там бич многих вообще компаний пото что у них запускаются продукты в от привилегированного пользователя внутри контейнеров А собственно Давайте чуть-чуть Разогрей есть вопросики к вам да есть вопросик А кто собственно говоря запускает свои приложения в контейнере под рутом Поднимите руки один честный человек Нашёлся мы думаем что остальные просто решили не сознаваться то сейчас Ага вот он но А даже если вы так делаете и не говорите Сейчас мы расскажем Почему так однозначно не стоит делать Да ну собственно говоря для всех этих проблем существует довольно-таки большое количество решений Ну да собственно это различные Линт докер файлов которые могут вам подсветить о наличии Рута или ещё о каких-то проблемах В контейнере для того чтобы не словить уязвимость У нас есть различные инструменты для поиска уязвимости в образах а тут уже история понятна Мне кажется миллион был докладов и статей на эту тему помимо этого есть специальные средства которые позволяют выискивать мис конфигурации в ваших контейнерах но но как всегда есть один здоровенный нюанс Да а представим такую ситуацию что у нас есть целевая система туда каким-то образом попадает злоумышленник он не доставляет никакие элементы эксплойта он берёт се а я думаю многие из вас знакомы с этой программой пользовались И постепенно перекладывают всё что находится на файловой системе в архивы запароленный пароль конечно же он пользователю этой системы не говорит а потом сносит всю открытую информацию что у нас получается такой некий шифровальщик то есть мы Повали всю систему пользователь не может установить сказать Ну это какой-то сюр там пример в вакууме Но на самом деле нету Существует такой шифровальщик ker он как раз атаковал сетевые хранилища данных qap и в своём составе использовал 7zip для шифрования где-то около года назад как раз упа были проблемы когда их в продолжительное время через когда пользователей этих насо в продолжительное время через там находившиеся зде кошмарили Ну либо когда патч реверси выпускали explo вот собственно подробнее можно будет ознакомиться с отчётом от blin компьютер по ссылочки ниже А Мы двигаемся дальше Ну на самом деле получается то что все те инструменты про которые рассказал Лёша несколько минут назад Они не смогли бы помочь обнаружить деятельность такого шифровальщика потому что се Zip - это абсолютно легитимный утилиты И что же у нас В итоге получается получается что у нас есть куча сканеров Но для целого класса Атак они совершенно ничем не могут помочь Ну да и никак не детектива Почему Потому что есть такой класс Атак как Living of the Land атаки или lal - это атаки при которых злоумышленник использует разнообразные легитимные программы как в том примере про который рассказал Лёша для того чтобы выполнять различные вредоносные действия в царевой системе и понятно что раз злоумышленники используют спасибо понятно что злоумышленники когда они используют легитимные компоненты какие-то легитимные утилиты сканером или каким-то инструментом безопасности такие атаки выявлять довольно-таки Тяжело Ну да более того такой инструмент может быть легитимной частью Я имею в виду работающей системы А значит мы считаем что его взаимодействие оно ну как бы корректное и собственно а продолжая то есть Living of Land в переводе с английского означает питаться под ножным кормом Ну то есть по факту тем что как бы можно добыть на местности оно валяется у вас под ногами И тем самым оператора lal Attack они добывают свои инструменты на местности для достижения своих целей так собственно Если вы думаете что это какие-то там узкоспециализированные примеры мы сейчас на слайдах будут приведены как раз некоторые вредоносные компании например вымогатель н группировка битера нацеленный на энергетический сектор в Азии собственно они в своих вредоносных компаниях используют ло атаки можно познакомиться с отчётами потом скачать презентацию и разобрать подробнее это останавливаться и на самом деле в 2023 году даже некоторые виды мух освоили Лол атаки к примеру на слайде можно было видеть муху вида гидрача Надеюсь я правильно Прочитал её название это род мух береговушка из-под семейства с каким-то страшным названием которые тоже давно освоили Лол атаки Ну на самом деле понятно что это шутка и гидрозо АПТ группировки которая использует в своих атаках исключительно атаки и можно про это почитать например в отте синтека но гидро - это не единственная группировка есть и другие а всё так опять же То есть сейчас на слайде приведены группировки про Некоторые из них вы могли слышать то есть это ити группировка нрд Панда это вымогатели Black и Evil corp группировка ор и группировка длн Лёша не знаю Ты знаком с людьми которые придумывают название всем этим группировкам Наверно это такие творческие люди с богатым внутренним миром согласен собственно говоря про атаки если брать статистику самые популярные инструменты - это по это это атаки через уязвимый легитимный компоненты и также например атаки через лом Windows Defender так так так погоди Лёш Какой ещё Ден Какие какие тобон говорили контейнеры Я не знаю пользуется ли ими кто-то вообще но они существуют А да ты прав но так как растёт число пользователей Линекса растёт количество инфраструктуры на линуксе соответственно всё чаще и чаще злоумышленники свой взор Да направляют именно на Linux систему Мы видим что в принципе растёт количество Атак на OS этого семейства и Например если мы возьмём прошлогодний отчёт positive Technologies мы увидим что произошло увели а на о семейство с 12% до 30 А что это значит так Как растёт количество Атак на Linux то растёт и количество lal Атак на Linux естественный вывод то есть на самом деле Лол атаки исторически всегда атрибутировать именно С атаками на Windows инфраструктуру но последнее время они появляются и под Linux инфраструктуру в том числе в деятельности различных хакерских группировок и в целом Лол атаки в применении КС инфраструктуре не являются чем чем-то таким эзотерики на самом деле в линуксе многие атаки по умолчанию являются Лол атаками и в линуксе для того чтобы проводить разнообразные вредоносные действия и делать Лол атаки существует огромное количество инструментов от всеми любимого нами вима до Докера Сепа как в примере у Лёши и других инструментов на самом деле даже существует отдельный термин это легитимные программы которые могут быть использова раз обхода для обхода разнообразных настроек безопасности в на некорректно сконфигурированный ник системах вот на слайде приведена ссылочка на сайт тфо beans это сайт на котором приведены примеры того как с помощью разнообразных легитимных инструментов можно либо повысить привилегии в Linux либо сделать что-то Что может быть полезно злоумышленнику в рамках развития атаки к примеру там можно почитать о том как с помощью util S повысить привилегии м да соответственно вам желательно ознакомиться с этим ну скажем так сайтом и с этими утилитами при проектировании своих систем чтобы не допустить таких ошибок но если всё-таки вы пользователь Windows И откуда мы начали а быстренько проговори есть livin of ln binaries and scripts lol Bass Project это как раз касается виды и также есть lol drivers когда А можно проводить атаку эксплуатируемый драйвер официальный но сильно на этом не будем задерживать на самом деле если мы говорим про gtfo beans то хорошей практикой в работе современного Security Operation центра является написание алертов на почти все подозрительные действия которые можно предпринимать с легитимными программами которые перечислены хотя бы вот на сайте gtf beans Если проектирует сок пишете алерты обратите на это внимание всё так а Давайте с вами разберём разберёмся с таксономии ла так все техники можно поделить Ну на такие грубы на шесть типов Это побег из ограниченного шела это повышение привилегий в системе это сохранение повышенных привилегий в таку е мой системе Это передача файлов как в систему так и из неё да то есть так называемая экфрасис простых примеров того как разнообразные Linux легитимный утилити можно использовать как составные кубики при развитии какой-то более более сложной атаки а давайте начнём с примера Когда у нас есть некоторые ограниченный Shell Что такое ограниченный Shell а администраторы разработчики псы часто Когда разворачивают какое-то приложение любят попытаться зарезать этому приложению права и например ограничить э список утилит которые доступны пользователю под которым запущено приложение Давайте предположим что у нас есть такой ограниченный Shell в котором разрешено запускать только одну утилиту а дальше мы посмотрим Как с помощью этой утилиты можно сделать что-нибудь плохое и вот здесь на слайде видно то что например у нас hemi и hostname не не работают из-за пермин денай в нашем ограниченном Шеле и Давайте начнём а рассматривать наши примеры с простого примера э с Гита если у нас есть возможность использовать Только git в нашем ограниченном Шеле это уже позволяет нам на самом деле выйти из ограниченного шела и получить э полноценное выполнение кода в контексте там той системы на которой мы запускаем делается это с помощью пейджера здесь можно видеть то что злоумышленник вводит простую команду с гитом и получает полноценный Shell и hostname H начинают у него работать да соответственно получив интерактивный шел злоумышленник уже будет гораздо проще взаимодействовать с целевой системой и пытаться в дальнейшем проводить атаки но гитом едины собственно возьмём например популярный ныне npm также с помощью легко можем поднять интерактивный л и начать воспроизводить какие-то команды на системе что ещё можно сделать поинтересней Понятно иногда возникает желание написать у разработчиков у администраторов какую-то такую свою упрощённую систему оркестрация контейнеров например на основе докеров в особенности Раньше такое было популярно периодически встречалось И на самом деле если у вас есть пользователь которому разрешено только выполнять докер то этот пользователь уже может поднять привилегии в системе до Рута То есть вы создали какого-то пользователя ему только можно выполнять докер и он уже на самом деле этот пользователь может на самом деле стать на системе рутом как это сделать очень легко он может запустить контейнер в который он примонтировать в эту корневую директорию и сможет работать со всеми файлами внутри этой директории с привилегиями Рута таким образом докер можно использовать для повышение привилегий причём Обратите внимание здесь достаточно чтобы пользователь всего лишь был в группе Докера Ну и докер демон работал от Рута например а он по умолчанию всегда работает от Рута Да собственно Так мы получаем рут на хостой ус Давайте двигаться дальше А поговорим про ревер Shell или обратный Shell зачастую у нас может быть такая ситуация что мы не можем установить напрямую там и соединение до атакует Link да то есть обратный Shell который техника нам позволит установить удалённость подключения на наш хост с атакует Давайте представим себе такую картину вот у нас у злоумышленника есть некий сервер с помощью программы netcat он начинает прослушивать порт в данном случае 1 2 3 4 5 Что происходит на атакует хост куда хотим подключиться и порт и далее просто с помощью программы Баш Мы перенаправляет в D tcp и что мы получаем веве Shell Да мы получаем ревер Shell то есть мы видим что у нас подрубил Back Connect и мы можем исполнять уже интерактивно команды на атакует это гораздо удобнее для злоумышленника на примере какой-то очень модный злоумышленник с макбуком всё так ну сеча сейчас же модно там мобильные псы стопки Из Mac mini Да вот взламываем их А понятно что кроме различных способов для получения интерактивного выполнения команд в системе существуют способы для получения интерактивного существуют не интерактивные способы выполнять интерактивные команды в системе и например для этого можно использовать такую команду как стат которая показывает статистику потребления ресурсов системы запущенным процессом и понятно что если у злоумышленника есть возможность выполнять такую команду он сможет с помощью неё выполнить любую команду в системе Если вы хотите в вашем каком-то тоже ограниченном Шеле дать возможность пользователю только Като про на самом деле он сможет выполнять ВС что угодно это довольно-таки логично и вот похожей техникой скажем так выхода из ограниченного шела или В некоторых случаях повышени привилегии является техника с применением у которая позволяет делать примерно тоже самое ещё один пример не интерактивного выполнения команд например наш любимый НТА мину соответственно если мы заходим в и видим например некую строчку что у на при перезагрузке запускается крипт Так мы сможем закрепляться в системе оставаться незамеченными То есть просто после каждой перезагрузки машины у нас будет например заново подниматься ревер Shell хотел бы ещё рассказать про интересную атаку она называется крон R атака три пер февраля А в чём заключался её смысл собственно вредоносная нагрузка она сохранялась в кроне Вот с таким интересным крон выражением которое как раз было на стояло на 31 февраля что это что это это позволяло обойти многие вендорс системы защиты потому что ну 31 февраля не существует А значит при попытке выполнения Ну в смысле при попытке выполнения такого кода у нас бы произошла ошибка но так как 31 февраля никогда не наступает эта ошибка никогда не наступает соответственно Так мы в кроне могли прятать арованы код который в дальнейшем если взять уже декодер проверялось у нас крон выражени у нас 64 ованный код он разархивирование в Баш причём кстати заметьте после срабатывание и выполнени вредоносного Кода да эп злоумышленники за собой ещё почистили крон в отличие от некоторых разработчиков Всё верно вот на самом деле Зачем так делать Зачем вообще нужна такая техника может возникнуть вопрос часто Когда вы пытаетесь про эксплуатировать на какой-то системе как-то распространить атаку вам просто нужно где-то незаметно хранить ваш вредоносный код и вот эта вот Атака кронт Она позволяет вам хранить ваш вредоносный код в крон табе и не сохранять его где-то на диске где его найдёт какой-нибудь средства для обнаружения АТАК Да продолжим А понятно то что с помощью легитимных утилит без каких-то там супер дополнительных привилегий или чего-то Такого можно например выкачивать данные из конечных серверов к примеру с помощью ssh Да можно также делать чтение данных допустим у нас есть файл 13 MD мы можем его прочитать соответственно не имея там какого каких-то инструментов для чтения мы можем чисто с помощью Баша И эхо прочитать любые файлы на атакует опять же то что если у Вас например запрещены какие-то утилиты стандартные для записи в файл но есть к примеру в Get Вы можете записать что-то в файл это тоже в рамках атаки бывает полезно Ну и конечно же загрузка файлов То есть когда lal ака - это может быть частью более большей гибридной атаки и она предшествует загрузке некого пайда в систему собственно это тоже всё позволяет нам сделать А следующий Такой тип скажем так Атак Когда у вас есть в доступе только например какой-то инструмент к примеру для установки пакетов такой как пип что можно в данном случае сделать можно создать Файлик setup.py э добавить строчки которые на слайде приведены и вы таким образом при вызове пип сможете выполнить произвольный код на системе где вам доступен только пип код свой Нужно разместить в лисо то есть для лёгким движением руки Мы выполняем произвольный код на системе То есть у вас может быть например какая-то учётка робота который доступен для выполнения только пип для того чтобы она например что-то обновлялась если у неё есть возможность писать файлы и запускать пип это уже позволяет выполнить произвольный код на системе Да ну допустим администратор у нас прошаренный он не даёт пользователю или там он не даёт пользователю никаких привилегий но например он выдаёт субит на программу Python чтобы Так а кто знает что такое SU бит поднимите ти прошаренный Так давайте тогда поясню это вот например в данном случае примере у на установлен трута он это позволяет Запусти любому пользователю программу от имени Рута конкретно эту что мы имеем мы имеем обычного пользователя в системе у нас на пайне стоит SU Bit и при запуске приведённого скрипта на слайде мы получим что мы Root на системе мы получим интерактивный Shell и най системе сбит нужен например для того чтобы у вас работали многие стандартные утилиты в линуксе например по СВД То есть это бит который позволяет запускать исполняемый файл с правами владельца этого файла и sbit в общем очень часто используется в реальных атаках для повышения привилегий в особенности неаккуратно выставленный да А понятно Вот мы рассказывали до этого пример с докеров добавлен в группу докер для того чтобы управлять какими-то контейнерами либо какая-то автоматизация была добавлена в группу docker для того чтобы управлять контейнерами но часто нерадивые администраторы которые не разобрались либо с группой docker либо там пошли на к Overflow взяли первый ответ и пошли настраивать свою систему добавляют на исполняемый файл Докера тоже сбит который позволяет запускать докер с правами Рута и это очевидно тоже приводит к аналогичному повышению привилегий как вот То которое мы рассказывали до этого как в том анекдоте джун Откуда ты взял код сок Overflow из вопроса или из ответа также может у нас быть эксплуатация через судо собственно когда мы например возьмём наш любимый ВИМ мы разрешили пользователю запускать отсюда и больше не разрешив Ничего мы с лёгкостью можем также повысить на системе привилегий Рута тоже самое на самом деле можно делать с утилитой которая просто позволяет читать файлы она точно также Если вы е добавили в судо позволяет повысить привилегии потому что она позволяет заспавнить Да следующий пример касается неаккуратно выданных ка а кто знает что такое ато это расширение стандартной модели управления доступом в линуксе которые позволяют выдавать обычному пользовательскому процессу кусочки привилегии Рута То есть например вы хотите дать процессу возможность слушать привилегированные порты но не хотите Давать ему Рута Вы можете это сделать с помощью capabilities и вот capabilities тоже администраторы которые не знают о том что это такое часто выдают достаточно неаккуратно и в нашем примере а бинарник Python 3 выдано capabilities на Set ID это capability которая позволяет изменять userid пользователя у процесса который выполняется и понятно то что мы опять же с помощью такой если у нас есть такой Python можем получить повышение привилегии и выполнение произвольных команд и трута вот с помощью команды которая приведена на слайде мы просто выставляем себе 0 Рута и запускаем Баш Ну или Shell какой-то Угу У Лёши бы это был zs да А давайте тогда подведём некоторые основные особенности таких Атак Первое - это легитимные утилиты двойного назначения все они реально используются там разработчиками псами и часто их можно встретить на системах это усложнённые обнаружение атаки мы это уже проговариваем почему это ещё усложнённые атрибуция А так то есть если другой группировке нужно залить какой-то эксплоит у них есть определённый почерк кода что-то ещё то здесь это уже граница размывается и так называемые фа или бефа атаки Антон Что такое бефа атаки да В чём здесь фишка Почему вообще акцентируем внимание на Files потому что многие классические инструменты детектирования которые используют безопасники в своей работе Они опираются на сигнатуры файлов они ожидают увидеть на системе какой-то файл с определённой сигнатурок атрибути ется как какой-то вредоносный Но нет файла Нет сигнатур на самом деле и зачастую у Атак которые построены на на lal есть только так называемые индикаторы атаки То есть вы можете понять что на вас идт атака только по какой-то определенной последовательности действий которая типично для той или иной атаки а индикаторы компрометации аоки они появляются на самом деле у вас за счёт того что нету файлов только когда началось уже взаимодействие с вредоносным сервером или с каким-то управляющим сервером то есть на самом деле Айки индикаторы компрометации появляются слишком поздно когда у вас злоумышленник уже выносит данные из инфраструктуры куда-нибудь к себе получается что вроде бы да я знаю на КС нет вирусов тем временем вирусы получается хакеры опять всех переиграли да но на самом деле Нам тоже есть что им ответить и Давайте об этом чуть позже поговорим Как вообще отлаживать и тестировать такие контейнеры подскажешь Антон Ну получается что никак Ну на самом деле безусловно это шутка и вс-таки тестировать их можно но возможно некоторым из вас это не понравится собственно Да мы знаем что все вот эти любимые утилиты там РЛ для того чтобы проверить поднялся сервис или нет И всё остальное А любят использовать тестировщики любят использовать разработчики для отладки собственно У вас должны быть раздельные среды может быть раздельные базовые имиджи либо раздельные докер файлы что происходит весь тот инструментарий который нам необходим для отладки и может быть использован в атаки он никак не должен попадать на прод мы собираем одни контейнеры которые со всем этим окружением тести сно в на продакшн же едут другие контейнеры без этих инструментов А можно ли как-то ещё засти от таких Атак безусловно можно и на самом деле когда мы разделили наши среды выполнения там отделили де от прода от ло довольно-таки хорошо помогают классические техники харден давайте рассмотрим Некоторые из них на примере Докера Почему на примере Докера потому что на самом деле все эти техники харден переносятся легко и на другие системы контейнеризации контейнеров Ну первое на что нужно обратить внимание - это то что опять же не запускаем приложение под рутом под привилегированным пользователем В контейнере это ну звучит как такая немножко может быть детская простая мера Но на самом деле в контексте lal Attack она отбивает очень большое количество техника потому что злоумышленник просто не сможет их выполнить из-за недостатка привилегий во-вторых а нужно аккуратно ограничивать набор доступных кобили которые доступны вашим контейнерам потому что опять же это тоже понижает Спектр доступных привилегий для злоумышленника и усложняет атаку а третий пункт Ну immutable infrastructure наше всё Понятное дело что не везде и не всегда это можно на практике применять Но если у вас есть какие-то контейнеры там критичные для вас то хорошо бы стремиться к использованию редон для файловой системы в них если это возможно потому что это тоже усложняет на самом деле жизнь злоумышленника внутри такого контейнера достаточно сильно А и ещё две техники такие уже более продвинутые это использование стандартных механизмов безопасности Linux таких как мандатное управление мандатная система управление доступом ARM или SE Linux которые позволяют задавать для контейнеров либо вообще для процессов профили безопасности которые определяют вообще куда процесс Может сходить что может посмотреть они тоже могут усложнить жизнь злоумышленника Ну и sec - это механизм который позволяет ограничить набор доступных процессов системных вызовов тоже может если у Вас если Вы хорошо понимаете что делает ваш тенера Вы тоже можете с помощью него усложнить жизнь злоумышленнику на самом деле понятно то что все техники харден про которые сказал я про которые будет говорить Лёша их невозможно использовать одновременно вместе в проде речь идёт про то что можно их как-то комбинировать здраво и это уже усложнит жизнь злоумышленнику согласен а продолжим дальше а помним про то что допустим по дефолту в докере все контейнеры попадают в дефолт ную сеть Докера и они все имеют между собой сетевую доступность А значит нужно отключить контейнер да или там мекон взаимодействие для того чтобы у нас как раз не было горизонтального продвижения ограничение просто использования сети то есть те контейнеры которые не должны лазить во внешнюю сеть они не должны там никак никуда попадать использование режима для контейнеров То есть когда у Вас например до Demon работает Не от Рута собственно это также то есть при побеге у вас не получится Так что злоумышленник окажется м Си Ну использование То есть когда у нас происходит манг шников и пользователь в контейнере не равняется пользователю рута на хостой для тех для кого эти термины там незнакомы мы везде оставили ссылочки на самом деле Да ну и вот пример того как можно в докере дропнуть Я думаю многие это ну как бы этот пример видели мы можем использовать лак для того чтобы при запуске контейнера отобрать нужные наборы Каби выдать точечно в зависимости от того какие калити нужны ну и не обязательно это сделать в докере это также можно сделать в кубе и так далее А ещё отдельно Хотелось бы поговорить про парр это достаточно крутая интересная штука Мы можем написать свой профиль где например мы сможем поза всё то что не должно там выполняться то есть Вот пример такого Ар профа видим что мы получим в конечном итоге мы получим то что злоумышленник даже попав внутрь ничего не сможет выполнить но тут есть интересное Антон А писал ли ты об парр профайлы я писал это довольно-таки больно А кстати кто-нибудь писал о армер профиле ещё вот даже кто кто-то кто-то писал несколько несколько безопасни ков подняли руки А да это достаточно тяжёлый труд и поэтому А наверное тоже важный момент чтобы не не запрещать всё что мы не используем А давайте мы в принципе вообще не будем это класть в и мы переходим к осознанным сборкам то есть используем внутри только то что необходимо а выбираем инструменты с умом то есть получив сегодняшние знания вы уже понимаете что есть определённый набор утилит которые могут вам больше во вред сыграть чем в пользу и соответственно делаем это на этапе планирования ещё когда мы только проектируем нашу систему мы уже сразу закладываем Какие инструменты не стоит использовать потому что они могут быть использованы в Атаке Ну и минималистичные образы ди образы Понятное дело тоже помогают защититься от Лол Атак потому что в них просто как бы нету чего-то что можно было бы за использовать для развития атаки Да если Вы посмотрите на диаграмму там Не очень видно подписи но например Alpine Linux - это вот самое-самое маленькое на этой диаграмме что у нас получается меньше образ Меньше проблем меньше образ - это меньше кода меньше ошибок в этом коде меньше меньше поверхность атаки меньше шансов что что-то там смогут найти как-то это воспользоваться против вас этим Ну и напоследок хочется сказать про то что отл помогают в том числе различные инструменты поведенческого анализа если их можно так назвать применимые к контейнерным инфраструктура например фалька или вот проприетарная система лант которые смотрят на то что контейнер делаются и разнообразными способами либо там по заранее расписан профилем либо с помощью машинного обучения как-то пытаются обнаруживать в том как ведёт себя контейнер какие-то аномалии и против л Атак в принципе такие инструменты могут быть эффективные Потому что если у вас даже контейнер неожиданно начал делать как там с помощью легитимной утилиты какой-нибудь там Эхо что-нибудь ицп СВД инструмент поведенческого анализа такое обнаружить скорее всего сможет Дима привет порек свяжется с тобой попозже по поводу оплаты А и собственно Давайте перейдём с вами к выводам всё-таки А мы сегодня увидели что злоумышленникам зачастую не нужны какие-то хитроумные эксплойты А и какие-то хакерские инструменты на ваших системах уже и так всё есть и это позволяет проводить широкий спектр Атак на ваши системы такие инструменты не детект со сканерами и также на них обращается ещё недостаточное внимание потому что ну это же инструмент которым я пользуюсь что с ним может не так быть Ну и в заключени Давайте ещё раз Скажем про то А что делать для того чтобы такие атаки усложнять Ну во-первых разделять образы для прода и для дела внимательнее относиться к харден ваших контейнеров вообще пытаться его делать потому что многие просто как бы этот пункт игнорируют возможно использовать какие-то системы поведенческого анализа ну и желательно всё вообще-то как бы начинать об этом всём думать на этапе проектирования вашего приложения собственно на этом всё Спасибо друзья голосуйте оставляйте обратную связь Это очень важно чтобы делать для вас доклады только Лучше давайте перейдём к вопросам Да супер Большое спасибо спасибо что так бодро и живо рассказали Я уверен весь зал проснулся уже видим сколько появилось рук хотел и ожидал в вашем докладе видеть ещё одну штуку так как у нас много про контейнеризации кубернетес мало на самом Кто знает Но если у вас доступ к улитке Cub ZL с флагом можно использовать как в Get и как Кул поэтому они даже не нужны Если у вас есть куб T вот а тут Давайте тогда уже перейдём к вопросам Можно пожалуйста вот вопрос На первом ряду сюда передайте у нас отняли один микрофон поэтому мы будем шарить Спасибо большое ребят очень очень отличный отличный доклад очень интересно было послушать Зовут меня Антон и хотелось бы если вы не против два вопроса Первый ваше мнение вы говорили про использование парси компа и есть например насколько я помню докер слитка она делает образ тоньше и на выходе как раз формирует секом точно армер не помню вот был ли у вас опыт Можете ли что-нибудь сказать хорошее плохое и Стоит ли её использовать А с утилит кой опыта не было был опыт написания арра sec ком профилей для обычных бинарных приложений а но в то время на самом деле этих утилита скорее всего и не было когда я это делал а и это достаточно было на самом деле хардкорно то есть такие профили написать можно но поддерживать их Потом довольно-таки сложно но с другой стороны их можно использовать в режиме логирования то есть и поддерживает режим логирования и вы можете на самом деле сделать такой хитрый СБО для вашего приложения который в случае нарушения приложением этого снкса будет алеть например в сок если он у вас есть если вы как бы Боитесь в ince режиме всё это запускать и Боитесь то что у вас в проде упадёт приложение спасибо большое и второ пово е отвечу по поводу вот утилиты для обучения профилей на у сильно будет зависеть от того на насколько сложное приложение для которого вы пишете профиль потому что на самом деле написание качественного профиля зависит от того насколько вы в ран тайме смогли пройти по всем веткам выполнения вашего приложения в общем всё будет зависеть от этого если это какое-то приложение то автоматизированные утилиты могут эффективно профиль сделать если приложение сложное Вот я например писал профиль для кему там у не поможет СБО болье это про минималистичные образы да ди от Гугла Если я правильно помню А Вольф пробовали или нет Какой Вольф Если не ошибаюсь так называется это не вспомню от кого такой да спасибо нет не пробовал так можно вот ещё вопрос есть с первого ряда Как страшно жить ребята оказывается в контейнерах слушайте ваши рекомендации были такие типа как алкоголику сказать что типа не пей да то есть Дели средой там в общем всё такое Используй харден А вот что вы посоветуете Ну обычному разработчику или там обычному человеку который Ну не может он всё сразу это выполнить А вот какой-то простой способ чтобы хотя бы минимум мини морм вот этой безопасности достичь вот я для себя как супер не очень квалифицированный девопс я бы для себя выделил два момента это минимальные образы довольно просто их использовать и калити про которые я так понял что я среди большинства который про них не знал до вашего доклада Ну рут убирать в контейнерах однозначно это самое главное что нужно в остальном наверное тут поможем мы безопасность для этого мы и есть есть и некоторые скажем так автоматизированные решения которые позволяют детектив разные там в тот же самый руд Ну и помнить про вот те бинари которые мы предоставили и по возможности их не использовать дополнил Да согласен с Лёшей Ну и на самом деле согласен Вот с вопрошающий а потому что на самом деле capability действительно можно достаточно легко сократить и это то что что как бы в силах там девопса или разработчика который делает контейнер и минималистичные образы тоже очень эффективно помогают защищаться от лот так поэтому на самом деле как бы в вашем вопросе содержался достаточно корректный ответ и И не только L и не только lal А да так вот ещё вопрос последний ряд да спасибо прекрасный доклад по-моему самый огонь вы знаете про такую штуку astr Linux конечно Там просто тоже есть такие вещи Как наш аналог все компа армора только они не опн Сорсо Как вы считаете имеет смысл их применять для ваших задач тут надо ответить на вопрос а имеет ли смысл применять астро Linux для ваших задач Если вы его применяете то у вас наверное выбора-то не так уж и много осталось как бы придётся применять вот эти инструменты про которые вы говорите делаем А ну значит Да сечас можно а дополню по астро Линекс когда ты работал лаборатории по сертификации много чего поел с астрей А если это будет заявлено как функционал и не только на отсутствие недекларированных возможностей А что он выполняет целевой функцию тогда стоит делать во всём остальном потом в лаборатории Ой этот Экспертная организация скажет так а тут не заявлено что она это может Поэтому ВСС это профанация на самом деле круто то что такие инструменты в астралис поддерживаются хоть и с закрытым кодом так вот ещё вопрос пожалуйста можно девушки микрофон Здравствуйте спасибо за доклад у меня вот такой вопрос Вы рассказали про очень много способов Атак А как происходит изучение Атак на основании каких-то кейсов или у вас есть какой-то отдел там или Люди которые занимаются также Ну как бы выполняют хакерскую работу и как бы генерируют новые или вы только по опыту как бы уже существующих Атак может ну собрали эту выборку да Вопрос понятен на самом деле существует большое количество способов как как бы наполнять свою базу знаний о различных атаках первый способ заключается в том чтобы изучать как работают реальные хакерские группировки И для этого различные вендоры информационной безопасности выпускают огромное количество отчётов и в том числе расписывают различные вот мы говорили индикаторы компрометации индикаторы Атак которые помогут вам на своей стороне обнаружить у себя деятельность там например той или иной вредоносной программы или группировки это первое во-вторых опираясь на опыт собственных экспертов которые работают у тебя которые либо делали когда-либо когда-либо делали например аудиты безопасности либо защищались от аудитов либо реальных Атак во-вторых можно проводить приглашать компании просить их тебя взломать они тебя взламывают это называется пинте 100м и потом разбирать А как тебя взломали и тоже как бы улучшать свою базу знаний в-третьих можно делать различные внутренние активности направленные на Аудит защищённости И тоже как бы то есть нанимать к себе людей которые умеют взламывать и потом опираться на то как они это делают для того чтобы пополнять свою базу знаний и последний наверное пункт существует огромное количество соревнований по информационной безопасности тфв и в целом в них бывает довольно-таки полезно участвовать потому что там можно на практике тоже различные хакерские техники изучить может быть Лёша хочет дополнить Да я чуть-чуть дополню в презентации там было много ссылок на отчёты там в некоторых отчётах как раз очень круто расписан Чейн и как вообще происходит атака от нуля до конца то есть на фишинге жертва что-то загрузила либо что-то ещ произошло я имею вообще от в целом есть и там прямо показано по файлу или там куда В какую систему внесено изменение Что произошло Да вот ещё у нас есть вопрос в той стороне зала раз-раз Меня зовут Никита Спасибо большое за доклад очень интересно вот подскажите во всех Best prac и в вашем докладе не запускать изд Рута вот к тому же возвращаемся А вот что вы скажете насчёт того что если р не привилегированный а группа привилегированная так можно это опасно или нет В некоторых случаях опасно В некоторых нет но лучше чтобы группы как бы юзер были не привилегированными Конечно Потому что для гранулярной привилегиями существует например Каби и очень часто про которые мы рассказывали и очень часто вашему приложению все привилегии почти всегда приложени все привилегии Рута не нужны а достаточно нескольких каких-то Каби которой вы можете гранулярной часть вопросов Если вы умеете с этим работать Спасибо И ещё под вопросик а не являются ли Серебряной пулей механизмы кубера там sec контек которые переопределять юзера и группу при запуске контейнера в каком плане это может лять но тут чаще все это разобьётся а то что когда вам действительно нужен контейнер с каким-то таким функционалом или с рутом Ну про секти контекст просто отдельный слайд Мы в конечном итоге его конечно убрали Но это точно также всё относится к этому Да там Но на самом деле в безопасности серебряных пуль не существует так ещё пожалуйста Вопрос Да спасибо огромное за доклад как человек с опытом в в соревнованиях было интересно послушать и в целом узнать что-то новое даже про доке про повышение привилегий через него Но вопрос больше продуктовый что если существуют какие-то программы скрипты которые компилируется сразу в контейнере с продуктовой средой и работают там оно нужно для продуктовая среда нужна для их использования там какие-то cli разработчики тогда distro образы вряд ли получится использовать Есть ли какие-то механизмы защиты это кроме разграничения привилегий ну вместе с вашими компилируется вредоносный код если пролом на самом деле туда ещё нужно изначально попасть То есть если в вашем софте нет никаких ошибок и вы там Всё вычислили то и что-то туда залететь не должно а так в основном да плюс ещё можно Ну смотря что там внутри происходит Какие данные можно сделать так чтобы Побег оттуда либо был не то что невоз Дава нельзя было сбежать Вот как раз было проли файловые системы например вопрос уже в другой стороне зала Здравствуйте спасибо за доклад очень интересно вопрос на основе реального кейса на продакшене есть контейнер с базой порт из которого торчит наружу и при этом закрыт впм корпоративным насколько с вашей точки зрения это безопасно и можно ли е что-нибудь предпринять для того чтобы улучшить защиту Ну наверное немного не относя всегда клады вопрос вобще в принципе по безопасности безопас А ты ты же программист Как переставить Да как как пропаща из кде началось а всё всё что у вас торчит наружу рано или поздно Не я понял VPN Я имею в виду всё что торчит наружу рано или поздно будет забрано другими руками по поводу VPN в пне У вас есть пользователи Давайте теперь представим пользователь на такую машину ловит малварь пользователь теряет ноутбук в метро не зашифрованный не запароленный а нужно подчеркнуть что мы получаем до свидания база ну типа это просто вопрос времени на самом деле много сейчас таких Атак когда взламывают именно конечное пользовательское устройство а потом например ищут внутри сети базы с дефолтным креда вопрос был про то что можно улучшить тут можно долго на пару часов уйти в фантазии Например можно улучшить если он ещё у вас не улучшенный VPN и сделать так чтобы доступ до вот этого порта был Только у тех пользователей которые реально работают с базой можно улучшать аутентификацию в базе и например прикрутить к ней какую-нибудь систему которая позволит для доступа к базе антифитнес например Телепорт можно для этого Использовать можно всячески рть контейнер как мы сегодня для того чтобы если базу вс-таки пролом не могли сбежать на хост Если вы этот хост хотите защищать вот можно всячески харде неть саму базу Там Дона срава какие-нибудь для неё там короче политики пользователей поставить какую-нибудь систему которая анализирует Какие запросы вообще идут к базе то есть фантазировать можно долго Всё зависит от того что это за база насколько она для вас ценная Что будет если её украдут то есть нужно от модели угроз отталкиваться Да спасибо Антон так вот вопрос На первом ряду Подскажите А если всё-таки нам приходится использовать какой-либо инструмент который потенциально может бахнуть как от этого защититься Ну зависит от того что это за инструмент и как он может бахнуть во-первых полезно было бы понимать что вы такой инструмент используете и то что он может бахнуть это уже часть часть успеха потому что обычно как раз проблема-то происходит из-за того что люди не понимают что инструмент может бахнуть Вот а если вы понимаете как этот инструмент можно проэк то его обычно как-то можно дополнительно уже и ограничить например с помощью того же А профиля Вы можете сделать так чтобы этот там инструмент можно было применять только каким-то конкретным например файлика ну грубо говоря опять же тут такой абстрактный вопрос поэтому я фантазирую То есть можно всячески попытаться захарни тоже спасибо ребят большое за отве Всем спасибо за вопрос я даже не успел в сказа ши вопро Вот Но вы были в курсе вы подготовлены докладчики поэтому просьба для начала выбрать Два лучших вопроса чтобы могли подарить подарок можешь начать ты Пускай вон там молодой человек спрашивал будет а я выбираю вопрос про As Linux Спасибо L"
}