{
  "video_id": "VlL3d6zAygs",
  "channel": "HighLoadChannel",
  "title": "Автоназначение курьеров в Delivery Club / Денис Горев (Delivery Club)",
  "views": 1582,
  "duration": 2746,
  "published": "2020-04-14T10:47:45-07:00",
  "text": "меня зовут tennis горем я издали mri club и свазиленде и последнее время мы шли месяцев шесть я занимаюсь optimization of the назначения то есть поиска курьеров для ваших заказов автоматическом режиме мой доклад состоит из трех важных частей первая расскажет вообще в принципе такое авто назначение что подразумевается под автоматическая система поиска курьеров расскажу как мы проводим эксперименты над нашими пользователями и 3 расскажу как мы тут мир из потолок синхронно модели и переходим реактивную модели строим сервис реакций нашей платформе я не курьеров неожиданно кто заказывает или в рекламе хотя бы хоть раз отлично не так шоу тогда вот эти три миллиона заказывать сентябрь это наверное ваши 2015 год потому что за весь 2018 год мы сделали 4 миллиона заказов а только за сентябрь 2015 мы сделали уже три миллиона заказов как мы смогли пережить такой большой рост одна из частей моего доклада вся история начинается в марте 2015 года когда к нам приходят менеджеры и говорят ребята что у нас плохо автоматически еще за курьер на заказ мы таки а насколько плохо мы не знаем первым делом мы построили такой график это какой-то случайный день в марте по оси y количество заказов по оси x время в этом дне и тут хорошо видно два пика первый пик это обеденный когда к себе на обед основном на работу и не шины из второй пик это когда все заказы себе домой и синие это колесо заказов и видно что количество авто назначенных это то насколько мы нашли курьер автоматически маленькая то есть не то что маленькие на столе 30 процентов и что самое плохое вся эта история то что мы плохо находим курьеров как раз тогда когда они больше всего нужны пике потребление вроде повстанцы очень 30 процентов но куда девается стали 70 процентов вот тут есть такая страшная история что на самом деле есть отдел операторов которым попадаете все из процентов заказов это реальные люди они смотрят на вашу на ваш заказ глазами глазами счет курьеров кликают на курьера клику на ваш заказ вам он назначен как бы в принципе для бизнес этого кия особенно на старте что какой то конечно заказ обрабатывается вручную но никто не ожидал что когда-то поставим 7 процентов заказа мы решаем задачу по подходу ботаном обычно такой подход используется когда есть цель например как наша цель нужно поднять процентов назначения но как это сделать не понятно бизнес не знает о программисты не знает какие уже есть подходы мы в такие моменты проводим сначала стадии исследований когда смотрю что в принципе можно сделать едем к оператору спрашивал как они назначают следим за курьерами как и не ходят а затем мы предлагаем какие-то решения для бизнеса есть решение прямо сейчас давайте сделаем вот так будет хорошо но через три месяца проблем опять появится и разрабатывать эту стратегию как решить эту проблему в принципе приоритизировать и задачи приходит бизнес приоритизировать решение приходит бизнес и говорим вот так итак с чего начинаем что в принципе устраивает бизнес после этого приступаем к разработке такой подход он с одной стороны хорошие потому что для разработчиков он развязывает руки вы погружаетесь в проблему сами придумываете решение но с другой стороны и все ответственны за эти решения ложится на вас в принципе к такому готовы и того у бизнеса были какие-то ожидания о том как будет расти бизнес до рассекали все заказы и при текущей системе если мы не решаем q это кардинально не решаем эту проблему то в сентябре логистики становится очень плохо капитальном плохо и того у нас есть какое-то такое дедлайн начиная с марта когда пятна я поставил задачу и заканчивая сентябрем о чем сентября когда нужно точно что-то решить была договоренность что внутри этих срок мы можем действовать как хотим у нас есть это свобода забот того что моим лимитировать сейчас что компьютеры потом сколько мы отводим времени на исследования и вот на все эти разговор об окружении прошу весь март осталось пять месяцев никакого прогресса в решении в назначении еще нет но все-таки ok конечно 1 1 1 1 1 1 1 март апрель май июнь июль август сентябрь отлично 1 2 лучше супер этого мы погрузились в исследовании у нас было три основных стратегии о том как понять в чем проблема первая проблема логистики то есть вдруг нас просто банально не достаточно курьером для того чтобы их назначен бывает да и в этом проблема то нам не нужно ничего программировать супер обожаю такое может быть проблема в производительности то есть у нас система она работает нормально но она не справляется потоком заказов ну так это просто решить давайте по масштабируемся туда-сюда супер или проблема в угаре to me и тогда становится значительно сложнее потому что у горит нужно разработать нужно понять почему этот плохой мы начали с логистики и то и дело но поняли что проблема не в ней потому что курьеров сами оператор вручную находит то есть проблема действительно либо в производительности либо в алгоритме то чтобы там понять что за производительность вот так вы система авто назначения это delivery club 10 лет неожиданно я сам не знал и на самом деле вся логистика это такой большой монолитно php классикой энтерпрайза 2009 года авто назначение занимает от него какую-то такую маленькую часть который на самом деле не понятно зачем она в принципе находится внутри кластера логистики ведь на вход она принимать только заказ что-то внутри проворачивает а на выходе даёт курьер выглядит как микро сервис такие окей давайте углубимся в нее погрузимся в этот enterprise и проблем оказалось много и одна из них это было то что там половина баз данных у нас называется на испанском ты такой 4 8 enterprise карт enterprise к такому был не готов но мы погружались большие оказалось что на самом деле вся весь этот системах назначение в таких маленьких бутылок которые там можно как-то полегче сейчас можно полечить фундаментально но был у всех этих маленьких вот у них мы выделили три большие проблемы первое мало экспертиза кода то есть никто на самом деле в компании особо уже не помнит как работает of назначает уселись которые вы писали они таки не знаю давно писали никто никогда на вики конечно есть но она ну как обычно давите ведутся а над конечно обновляется но не всегда нет замер производительности никто никогда не верил сколько в принципе то система выдерживает сколько в нее можно загрузить заказа для того чтобы она там стало способность не упала и третьим оказалось фундаментально что архитектура вот этого всего монолитные части оно не предназначено таки нагрузка есть мы провели игнорируете что никак с этим не справится тем более что мы там не особо хоп и разработчики вот какое быстро решение давайте закидаем просто железом да ну почему бы и нет там два месяца мы еще продержимся в нашей системе а потом нужно будет решить что-то фундаментально и того проходит два месяца мы придумали где-то оптимизировали немножко запросы где-то действительно закидали железом ok апрель-май мы вышли на порог 50 процентов а что дальше то есть все проблемы с производительностью мы там более-менее решили пришло время погружаться в алгоритмов назначение из чего он состоит это такая синхронная синхронный жадный алгоритм вам приходит заказ system of назначения и мы выбираем к этапу курьеров от их тут 4 затем проходит жесткий стадии фильтрации например мы не рассматриваем вера в который находится в десяти километров на нормальная тема или вы не рассматриваем курьеров и если ваш заказ по карте оплата на месте а у курьера нет косово аппарата то есть нам в принципе зачем вокруг вероятно ваш заказ он просто не сможет вы принять такие фильтров у нас некоторое количество фильтруют последовательно один за другим и потом то когда мы выбрали за к когда мы выбрали к этапу курьеров нам нужно решить о каком уже курьеру в итоге отдаем ваш заказ и проводим проходит скоринг вскоре тоже стоит из нескольких частей и вот конкретно один из них это два оставшихся курьера мы строим до них до от этого курьера до ресторанов с которого нужно забрать еду маршрут смотрим что он десять минут у другого 30 минут отлично минуты как бы а следующий скоро гиней в минутах наверняка нужна какая-то балльно-рейтинговая система тем более что называется ско ринге поэтому переводим наши система фку наши минуты какие-то баллы спасибо делал бей который всё это придумал и сделал и затем суммируем эти бал для всех школьников и выбираем курьера с максимальным скором алгоритм простой то есть вот он такой супер линейный находится фильтр и проходится скоренко выбирается лучший супер проблема мы хотим улучшить алгоритма как понять какой лучше то есть как понять что этот алгоритм праха плохой этот хороший у нас есть разные города где какой нужен 2 фундаментальная проблема невозможно конфигурировать алгоритм то есть сегодня у нас ситуация такая что там снег на дорогах и наверняка нужны какие-то другие параметры фильтрации завтра на солнечной погоды нужно 3 все этой системы есть лишняя связь монолитом то есть не понятно зачем все эти php5 зачем все сервис монолите он синхронный хотя казалось бы фильтровать можно синхронно скорость можно синхронно и асинхронно это отдельная тема и тут у вас может возникнуть вопрос зачем вообще к эта модель типа там 2019 год не россетти машины обучения может вам просто все это за гранью куда-нибудь и смотреть как получится но на самом деле бизнес решил что нужна прозрачность то есть они хотят действительно видите хотят говорить клиенту о том почему когда перспектив конечно почему не смогли найти курьер на это заказ или что такое моментально проблем конфигурируем оси и параметризация из нее мы начали мы переписали код к классикам на начали писать код на деньги потому что нас во всем ради бывают экспертиза только угол венге это был кот один и тот же есть какой-то джейсон конфиг который либо включает и выключает какие-то фильтрации ско ринге и также параметры рисует их и на выходе из кода одинакова для всех и джейсона которые одинаково разные для получается отдельно алгоритм это правда проблема того что нас нет параметризации точно встала когда мы посмотрели на саратов где этом курьер ездят на лошадях отлично вы как вообще там настроить алгоритм из вас курьер с наивысшей я наверное не как и этого мы разработали новую архитектуру оставили классной логистики где он есть вытащили и или перед всей платформы авто значения поставили прокси сервис это единая точка входа которых у этого кисти к создали конфликт провайдер это сервис который следит за всеми конфигурациями управляет для разных зон и непосредственно сам алгоритм инкрементирование в коде супер цели мы все еще не достигаем то есть там классические классические идея вы таки придумали классно архитектуру пересечь или кипит и кто будет поднимать мы решаем что ставить перед командой бизнес-целей это хорошо потому что когда команда на погружается в задачу и очень часто когда перед ней стоит конкретный теперь она придумывает многом разных решений там сама по себе без менеджер как разболтано подход здесь очень сыграл потому что эти подходы с параметризации они как бы для бизнеса сейчас не важны и бизнеса нужен там продержаться два месяца там что-нибудь еще придумаем разберемся вот это об исследовании на который мы получили время позволил нам как разработать тактику то есть давайте закидаем железом давайте оптимизируем какие-то параметры сейчас но в то же самое время мы разрабатываем решение о том как это в принципе полечить так чтобы у бизнеса больше никогда не было проблем с авто назначения в этом нам помогает эксперименты но вернемся к той май-июнь идет уже заканчивается никакого роста китая нет все начинает немножко напрягаться потому что там осталось два месяца 4 прошло что дальше грамм в принципе все двигаемся а тут мы сталкиваемся с другой проблемой мы конечно все это придумали разработали а как на просто это завести дата остывшие расскать или докера у нас нет хотим на него переехать как раз как вообще заехать новым сервисом на продакшен когда вы группы рэнди особенно есть такие проблемы как сож и тестировать алгоритм он модульный конфигурируемый юнит с ты покрываешь всевозможной конфигурации и количество в этом за сотни переваливает за тысячу все эти тесты написать просто нет времени особенно такие сжатые сроки вот ну что мы отвечаем тестируем напротив отлично лучше тестовая среда актуальные данные реальные пользователи реальные кейсы все как-то супер да но таки мы придумали как сравнивать отлично к этому моменту мы уже вынесли php алгоритм поддельный сервис это была не просто но там параллельно с разработка архитектуры и того на система вот как-то вы видите вот так есть логистика прокси конфиг просчет рассказал и отдельно есть micro сервис он еще написано php его то нам как раз нужно заменить так давайте возьмем и по сравниваем два алгоритма поставим вместе у нас есть прокси сервис мы можем за дублировать нагрузку говорим что давайте относить один заказ 2 заказ давайте эти бросим заказы в одну платформу пока по алгоритмам в гол горит и сравним а как они в принципе работает мы выбираем чтобы и celine нам главное было не уронить доставку прямо сейчас то есть все эти заказы они там на боевую они есть поэтому мы выбрали за вызывать алгоритм и нам нужно было сначала сравняться нам нужно будет доказать что галка ритм он такой же как php а потом что-то уже конфигурировать этого мы смогли за сплитить трафик то есть это тот же самый заказ он падает в два сервиса на выходе на вход подается один тот же заказ на выходе мы получаем курьеров для того чтобы сильно не травмировать просто можем сходить на десять процентов пятьдесят сто супер тестируем а как тестировать да вот пришел один курьер номер один на php алгоритме она говорит нам о курьер номер 2 и iq тест супер давайте сравним горит внутри давайте посмотрим что после каждого из фильтров и после каждого спаррингов у нас совпадает принципы у курьеров и совпадают скоро для этих курьеров вот например на первом фильтре угол алгоритму пхб алгоритма все одинаково на втором фильтре что-то не совпадает отлично мы запускаем быстрые итерации чек fix приглашен тест на продакшен катет к богу там катить мы можем очень быстро тот раз мы указать это 12 раз за день и так в течение недели вот было весело зато за неделю мы смогли довести один призван то другого мы быть про довезли кода продакшна но мы все еще не достигли никаких мы все еще не внесли ничего нового не внесли ничего в теперь наши киллер фичей конечно были эксперименты собственно ради которых нас все это и ждали что такое эксперименты для конкретной зоны или например для города мы можем выкатить свой собственный конфиг например кажется что убили реклам в сентябре в 30 городах уже даст или даже больше и мы можем тестировать одновременно 30 разных алгоритмов прямо сейчас а на самом деле там если мы хотим рассматривать москву то можем еще внутри москвы ещё сколько-то тестировать как это делается это делать то что также сервис конфликт факты об и тестирование только там алгоритмов того как мы находим курьеров на заказ есть зона у нее поведение приходит заказ заказ для заказа выбирается конфиг либо из эксперимента либо из эксперимента б они обладают одинаковый в одинаковый сервис из конфигов этот сервис собирает алгоритм выбирает выбирает курьера дальше мы можем конкретно смотреть насколько где лучше то есть для одной и той же зоны марины и у нас как бы не особо достаточный экспертизы для того чтобы проводить такие эксперименты то есть мы собрать за платформа увидели что то можно параметризовать отлично а там что параметризовать ну не знаю вот мы пришли воде убей пришли войди аналитики и говорим ребята мы дали вам классный инструмент рассказали про него они говорят супер и стали делать свое машины обучение как to configure алгоритмы и типа вот этому пространству для того чтобы достичь наилучшего чтобы сказать лучшего курьер в итоге мы перенести ответственны за эксперименты в отдел аналитики это было здорово потому что там мы разработка вот и нам там хочется разрабатывать дальше мы можем параметризовать алгоритм без перезагрузки то есть hots попал горит это позволит нам например если у вас и если вы хотите протестировать новый алгоритм не нужно катить новый код вы подкладываете новый конфиг он провалил свою систему и что самое важно для разных зон новые параметры какая ценность в принципе для бизнеса во всем этом в том что мы сделали 1 есть в чертову то есть мы можем включать кита фильтры включается ско ринге да прямо на пройти прямо в реал тайме без каких-то сложностей но что самое важное для бизнеса это то что мы им сделали какой-то ортогональный инструмент для того чтобы в принципе решать проблему поиска курьеров и дальше то есть мы не просто лечили и сейчас чтобы столкнуться этой проблемы через 5 месяцев еще раз и опять закапываться мы дали им инструменты того чтобы они сами решали ее в будущем интересно побочным эффектом стало то что бизнес стал тестировать не только поиск курьеров для конкретного заказа например может активировать лояльность курьер например давайте каком-то городе будем выбирать курьера которым уйти 10 километров вдруг там есть какие-то вот например те самые ребята на конях то есть мы дали бизнесу инструмент для того чтобы не только экспортировать экспериментирует на пользователях как до клиентов вас так и на курьеров то есть на других пользователях точно также своей системы но это подхода есть и там две большие проблемы сложности за всеми экспериментами вот если вы там будете делать так сразу делать веб-интерфейс и сразу делаете историю иначе все очень плох никто просто через 2 дня уже не помните там эксперименты никто не знает как за них вылью какой у них белью как за ними следить ничего не понятно и там со стороны разработки есть большая проблема вы не знаете что она production то есть вы знаете что вас есть такой вот код а как на самом деле робота горит и когда что-то сломалось там ок ну то есть конечно можно разобраться но это вносит определённый определенной сложности этого у нас есть август мы до эксперименты с нашей помощью иногда без нашей помощи дают большой рост мы в принципе достигаем 95 процентов на которых договаривались бизнесом и вот так выглядел наши стадии разработки мы первое время шли анализ потом применяли ad-hoc решения которые срабатываем сейчас разрабатывались нашу платформу параллельно успокаивая бизнес и когда эксперименты выпустились то сразу произошел большой рот of назначение и там кажется что он не должен больше никогда упасть наверное вот очень здорово мы во время этого мы стали задумываться о метре хотя как в принципе померить что говорит работает хорошо или что мы там надо нормально назначаем сейчас курьеров я считаю что продуктовые технически метрики они должны быть там в одном дашборде и аналитики менеджеры должны смотреть на технические метрики но особенно программист даже смотреть на продуктовые метрики потому что когда вы что-то сделали и вы видите как это работает напротив по конкретным китая бизнеса у вас рождается inside вы понимаете где можно улучшить вы понимаете почему это в принципе так работает в этом там для разработчиков будет очень классно если вы всегда будет смотреть на бизнеса в метрике потому что самое важное они гарантируют что код работает в принципе правильно потому что технически метрики могут быть все зеленый а на самом деле на продакшне у вас не понятно что самая важная ценность такого единого даже барда как я считаю это знаешь такое ddd domain-driven design отлично big выше следующий или единый язык в этой парадигме ok если в двух словах то когда приходит когда приходит разработ который не разбирается в доменной модели есть бизнес который уже говорит на своем языке обычно бизнес нанимает 3 аналитиков которые на два месяца за зарываются в доме на область генерирует какой-то словарь приходит к разработчикам и говорит когда бизнес имеет когда бизнес говорит это он на самом деле имеет ввиду вот это и приходит бизнес и говорит когда вы говорите и то вы на самом деле имеете виду вот это такой единый даже борт разработчиков и менеджеров позволяет не вот так вот искусственно вносить этот язык а позволяет его растить прямо из конкретных кипя из конкретных метрик цифр которые у вас есть дашборде я считаю что это не знаю супер это такая очень классная и ортогональная фича взаимодействуем в разработке которая нам очень помогает потому что цель продукта ясно менеджер приходит и говорит ребята нам нужно вот этот график поднять 10 процентов до 30 такой офис чего он строится ты закапываешься и понимаешь это ее там для тебя цель понятна для меньшего цель понятна и что для меня как разработчика важно я хочу видеть как мой кот в принципе влияет на про то как он работает на продакшн и очень удобно когда я что-то разработал выкатил а потом посмотрел на методе увидел что отлично здесь немножко подросла и как-то на сердит на сердечке тепло знать вроде все хорошо мы с август-сентябрь проживаем но в сентябре мы видим вот такую картину то есть на самом деле мы начинаем колебаться около 100 процентов от 80100 и что это за колебание как вообще непонятно то есть алгоритм он тянется сегодня-завтра откуда вообще это происходит вот есть фундаментальная проблема такого алгоритма который называется что он там синхронный жадный и у него есть потолок вот то есть из чего в принципе состоит такой сервис как delivery club у него есть 3 компонента это клиенты курьеры и рестораны и внутри вот этого пространства там удовлетворенности ожиданий мы как-то можем двигаться и как бы эта система из трех компонент которая полна неожиданностей потому что там неделю назад был дождь в москве и какая проблема ты сидишь в офисе и не хочешь да выходить потому что дождь не думаю чтобы заказать заказываешь а курьер сидит и такой блин у дождь что я пойду я не очень хочу идти и появляется такой большой разрыв между собой между спросом и предложением курьер не хотят выходить а люди хотят больше есть или например проблема что торговый центр закрылся за аварии и где-то вокруг него были курьеры и все они в принципе там не нужны нужны как-то попробовать разместить вокруг вывести их других там в разные стороны и есть акции от маркетинга который поверх обычного мне говорят вот они тоже очень неожиданные бывают ну вот я говорю про сервис реакции говорю что да в принципе вообще можно посмотреть для того чтобы понять что что-то пошло не так вот на что реагировать а там первым делом можно настроить автоматический анализ логов ну такое наверное там логе обычно у всех я ли живут вот а тут еще автоматически начинает парсить как-то анализировать странно может быть делать синхронные события рисовать например сервис на при курьер доставил заказ давайте куда целились в том что курьер доставил заказ ходить поищите при или герпесе тоже странно в том что тащить эту библиотеку везде там решение которое обычно там по классике даже книжку нам сегодня подарили да там event равен что-то кафка even вас отлично но там у него есть боли и они как бы большие первое с чего начать и этот самая большая боль вообще во всей разработки очень часто ну с чего начать-то вот у меня нет потребителей данных и нет данных я хочу на куда смотреть но я не знаю куда я хочу что-то писать а кто будет слушать я как бы тоже не знаю 1 идут 2 большая модель автора большая проблема это сложно дибашки вот когда у вас там очки приходят отлично теста в окружении а когда небольшую синхронно model party может произойти там что угодно и винты синхронны синхронной транзакция относительно предыдущем докладе вышел такой груженый и третья проблема сложно переносить синхронную бизнес войку которую вас уже написано как ты синхронно на асинхронное выполнение внутри delivery club мы сделали придумали такой маленькой европе в таких случаях как бы с чего начать и она называется сигнал bass вот что такое сигнал бас мы искусственно наивен бас накладываем ограничение давайте вот у нас есть уже ушел обычный синхронный поток заказа и на самом деле никто из сервисов синхронном потоки никогда не читает и сигнал база то есть все туда только пишут окей это довольно просто сделать потому что там писать в кафку продуктовые логе там почему бы нет это про следующая строчка где была гяру я еще лучше если там прям встроена в моду с vogue раване им это никак не затрагивает там фол да но при этом на весь вот эту шину с реакциями то сигналами слушает сервис реакций и вот уже сервис реакции вы в него зашиваете то как как в принципе реагировать на какие-то события сейчас там приведу пример почему следует начать сигнал баз и потому что это параллель функционал вы можете его разрабатывать не затрагивая стальную разработку то есть не затрагивают до ваши уже существующие legacy это как такой маленьким пеппе для even bass то есть с него можно начать а потом уже дальше у вас вы уже понимаете что вы пишете вы понимаете в каком то формате можно попробовать уже дальше построить на этом иван бас это уже позволяет реагировать на какие то события которые происходят то есть да я уже могу с этим что-то сделать и уже надо же с чего-то начать то есть сколько уже можно говорить про winbo свод давайте попробуем построить себе сигнал баз в нашей системе сигналами являются например курьер доставил заказ а значит там все идет неплохо или заказ отменился значит на этого курю определяем набор событий которые происходят вот нас такой курьер доставит заказ или заказ отменился и что можем с этим сделать например если курьер освободился мы подбираем новый заказ для этого курьера а если у курьера форс-мажор то можно попробовать найти нового курьера для этого заказа вот это все важно понимать что а вот этом всем знает только сервис реакций и на самом деле он уже дергает конкретные ручки в других сервисах то есть мы никакой логики в уже существующий сервисы дополнительно стараемся не писать начали в чем ценность такого это корта параллельно функционал у которого его легко начать его легко дебошир настраивать но при этом его легко выключить что самое важное если вдруг что-то идет не так и ваши реакции какие-то не асимметричные она при этом качество сервиса растет вы начинаете реагировать на события но как я вижу истину ценность такого сервис реакций в том что вы можете реагировать на аккумулированы серию событий например все эти случаи когда пошел дождь и мы можем попробовать сигнализировать курьер потом а выйдите пожалуйста даже если у них нет смен или например если где-то начинают не мы начинаем не находить курьеров на конкретные заказы то мы находим 1 210 то в принципе можно уже как на это среагировать то же самое позвонить в операторской просигнализировать им как минимум то есть это не обязательно влияние на текущему канал это может быть как alerts делать и наверняка альтинг там в параметре вот это альтернативный способ сделать альтинг который в принципе еще будет как-то фиксить вашу логику не через людей и что там до что интересна функция состояние системы в момент времени которая может балансировать спрос и предложение то есть нас могут быть как реакция на то что у нас много заказов так и реакция на то когда у нас мало заказов то есть мы можем управлять этим балансом спроса и предложения и того сейчас несколько выводов капитанских основном там вот она подход он нам очень нравится особенно исследовательских задачах то есть ставьте там прошли вывод для основа для менеджеров ставьте перед разработкой продуктовые цели и вы там неожиданно увидите что разработка генерит очень много классных идей которых там сложно сложно придумать только из аналитики такой вывод для разработчиков когда вы решаете какую-то проблему и если у вас есть время по этому делу то придумайте как решить эту проблему в принципе то есть как все как класс как сделать так чтобы авто назначение больше никогда не ломалась и желательно чтобы его больше никогда не чинили и никогда к нему не приходите вот у меня все нагрузки вы имеете в виду синхронная модель которая в самом начале было или которая которая в конце а в начале ну там про пиковые нагрузки я ничего не могу сказать но могу сказать сейчас это 3 миллиона заказывал за сентябрь то есть по сто тысяч заказов в день вот этот как то так сори до вопрос про то насколько большой команды нас всего сейчас шесть человек а было на этот момент трое до второй вопрос там интересный можем поговорить потом дам кларк а все я понять да изначально была проблема то что когда проектировали вот эту систему разработчики не и менеджеры основном не ставили требования там сто процентов авто назначения вот они говорили давайте как-то вот сделал у вас есть месяц придумайте систему мы ее быстро там закатим все равно у нас есть отдел операционистов которые если что у вас там утилизирует то есть вот две фундаментальные проблемы первое не проворность архитектур для масштабируемости и вторая проблема не прогнозируемость того что спрос настолько вырастет от менеджеров вот того они наложились друг на друга невозможно было адски лить горизонтально алгоритм сам потому что он был написан плохого качества и невозможно было приз менеджер не знаю о том что в принципе станет столько заказ а я понял да этот алгоритм жадный и синхронный поэтому если у нас там в то время там в марте был заказ и мы на него не нашли в течение трех минут курьера то все группе мы отправим операционку и больше никогда про этот заказ не пытаемся назначать вот это было тогда отдавать добрый день и спасибо за доклад мне два вопроса первый насколько сократили отдел операционистов поставили ли вообще как как fall back если система перестанет работать и второй вопрос задумывались ли вы в веб-интерфейсе для системы с алгоритмами вы сказали что там проблемы с тем чтобы понять для разработчика что там происходит думали ли вы сделать какой-то интерфейс чтобы понимать что это выключен это включен там весовой коэффициент вот этого все да спасибо за вопрос насчет второго дамы задумывались на к сожалению там сейчас delivery club там растет и на самом деле на тот момент не было ресурсов frontend для того чтобы все это написать а мы там а то что мне пох об это еще не front and wine двойная проблема в индии вот и по первым вопросом насколько сократили там я не могу сказать вот но могу сказать что этих людей там перевели на боль насущную проблему например там ваше обращение в службу поддержки вот это скорость реакции увеличивать of a box просто за день спасибо за доклад тоже два вопроса а первые когда вывод тестировали на пользователях свой алгоритм и это по сути был как бы reverse engineering вашего смысле старого php алгоритм то есть ну то есть вы же приносили просто по сути ту же саму лаги куда а второй опросу по поводу сервиса реакции да вы сказали про агрегируются события то есть в этом к это окно есть вот вы это уже сами проектировать опять же и с бизнесом или вот отделку то аналитиков да сейчас вот прям эта задача сейчас мы над ним работаем до одновременно там наши задачи сделать этот инструмент а выбрать окно это вот как вы правильно сказали мы вот им с бизнесом с аналитикой с бизнесом дальнейшем сам которые мы хотим сделать так чтобы так много настраиваем то есть та же ручка будет конечно да будет ручка с конфигурация давайте вот здесь такое окно а что если мы окно увеличим то есть все вот эти штуки мы стараемся сделать так что вот мы их сделали конфигурации сделали и отдали тем людям которые там действительно этим занимается спасибо здравствуйте а я вот здесь вопрос по поводу фича table нга сплит тестирования на продаже не то что ну классно все на раме к этому приходят рано или поздно как вы решаете проблему на изолированности экспериментов между собой например у вас на алгоритм на которые там шло 50 процентов трафика начал там жадно забирать заказа курьер и увидели что им тут не выгодно их тебя этом деньги падают до они ушли в яндексе иду через в течение двух месяцев например на авось эксперимент закончился там три недели назад как вы такие side effect и разруливаете да когда вроде бы эксперимент выключим но один эксперимент даже там на части трафика может перекосить всю систему в целом да хороший вопрос вот такие сайты эффект который вы описали то вы их реально очень сложно эти я не пристаю автоматики системы которая бы смогла это сделать вот в основном это аналитики это оффлайн аналитика то есть есть отдел бей которые берут слепы к данных за день и смотрят а как прошел эксперимент есть какие-то реал тайме который позволяет нам сейчас на них смотреть вот и side effect например можно там катить я тут вы хотите сильно изолировать эксперимент давайте каждый город это отдельный эксперимент вот то есть мы контролируем это на уровне людей people driven эксперимент вот но здесь вопрос ответ такой что автоматически не как люди аналитики контролируют сами ну про город собственно единственный вариант который логично в процесс возник спасибо спасибо за доклад по традиции два вопроса первый вопрос из доклада я не очень понял сто процентов чего вы достигли то есть 30 процентов как отвечал старый или процент вы достигли авто-ответа всех заказов отдам и в сто процентов достигли совпадение дат совпадения с ппш но мы достигли в июне когда там провели все фиксы когда заменили паха пышный нагорный сервис вот и там достаточно не дошли вот эти 95 до которых там сзади вот их мы достигли это вообще число вид доклада и вообще записаться к хорошо и второй вопрос вы сказали то что вы отдали свой инструмент аналитиком и они в принципе для meter уют алгоритмы да и управляют конфигурации вопрос сколько но такие истории обычно не живут без девелоперов то есть соответственно аналитик думаю то что вот блин да здесь ваш какой здесь объем да вот и кладет базу там например да там или еще что то вот вот какой support от девелоперов требуется для аналитиков и or и это вообще решаете да там это тоже там большая тема вот давайте поговорим потом вот эту интересное просто спасибо за доклад такой вопрос а вы говорите получается в mcl рита мы отдали аналитиком аиса начале когда вы озвучивали идеи и планировка вы говорили что одна из одно из требований это частота и понятность происходящего а такой вопрос а почему мы отдавать конфигурацию не аналитиком они psy с нейронной сети просто будет видно что собственно сконфигурировал а но если она найдется не очевидно на более эффективное решение чем аналитики да это требования бизнеса то есть я вот как технарь там тиан скрип поддерживаешь почему бы нет очень классный ронг решают алгоритм но там со стороны бизнеса я тоже их могу понять потому что очень часто вот эти комменты на какие то какие то параметры а не говорим курьером что ребята мне придётся далеко ехать вот и не факт что нерон к там тебе настоящим эксперименте не выходить что курьер придётся далеко ехать вот тут получается вот эта красота канальной системой с 3 там заказы рестораны и курьеры и неизвестно где это найдется общем да а ну тут вопрос на не в том что алгоритм нейронный а именно сама конфигурация то есть получается мы используем тот же алгоритм слышу конфигурации но конфигурацию подбирает нейронная сеть ну получается будем видеть что она подобрала все я понял да кажется что отдела аналитики что-то похожее делать вот то есть у них то наверняка какой-то имея ниже business on the license вот карта что они как-то этому учиться спасибо почему авто назначение происходит не на 100 процентов заказов что вот эти за пять процентов таких заказов которые жрал матричного есть форс-мажор вот форс-мажор у курьера вот или например действительно там мало курьер бывает что вот эта проблема с дождем то есть вот именно когда дождь мы действительно не находим курьером невозможно кажется нет такого количества курьеров в москве чтобы обслужить всех людей которые хотят покушать в обед оператор такой ситуации ту же все равно ничего не сделали до часто он тоже ничего не делать но там мы говорим что вот это ответственный человек если даже в человек не справился то все спаси большой можно счета к вопросу вы сказали что у вас не собственно лечился процентов то назначений а как вы смотрите за качеством авто назначение то есть если кайт аммиака для sli смотрите как синхронизируйтесь сравниваете с операторами дак это хороший хороший вопрос как у все вот такие так сказать вот такой анализ уже offline то есть возможно проводить онлайн of an проводит одел аналитики я там на самом деле это не знаю как они с ним справляются с что они что не делают я там разработал инструмент доливаем вот как они дальше с ним как-то балансирует я на самом деле не знаю с оператором и сравнивались там самом начале для того чтобы понять а в принципе как человек назначает что человек отвечает от машины вот до больше не сравнимся потому что на самом деле сложно подписать там машине то сложно вот это сколько надо операторов для того чтобы они смогли там все заказы посмотреть 10100 1000 заказов за один не знаю у нас еще есть время на 12 вопросы если и желающие всего можете просто про абсолютной цифры немного рассказать сколько на самом деле в один типичный дождливый день заказов средний сколько вам доступных курьеров про это к сожалению могу сказать так denis теперь у меня для вас задача вопросов было много но вам нужно по традиций нашей конференции выбрать лучший вопрос который вам больше всего понравилась не понравился да мне попадется вот здесь был человек под ником что вы пожелали мне вопрос нет вот которых значит на уже ушел проблема да а кто задал вопрос может просто руки поднять я у вас может все уже ушли до а какой был вопрос почему муж в белом да мне кажется что особых на операторов да ну раз я вас запомнил решила спросить знаешь наверно ваш хорошо также можно вас поздравить по традиции лучше вопрос получает символический приз в данном случае это будет книжка-игрушка от нашего партнера wargaming и также прошу от аудитория путис-мен то для дениса он тоже не уйдет без награды"
}