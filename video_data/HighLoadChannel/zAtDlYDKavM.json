{
  "video_id": "zAtDlYDKavM",
  "channel": "HighLoadChannel",
  "title": "Сочетание несочетаемого в Kubernetes: удобство, производительность, безопасность/ Дмитрий Евдокимов",
  "views": 583,
  "duration": 2901,
  "published": "2023-10-06T07:21:23-07:00",
  "text": "рад всех приветствовать И сейчас мы с вами поговорим про cubernetis непосредственно про безопасность и некоторые конфликт между it и B давайте для начала представлюсь Меня зовут Дмитрий Евдокимов Я являюсь основателем техническим директором компании lantry и мы делаем решение непосредственно для cubernations и в рамках этого доклада я поделюсь некоторыми нашими наблюдениями которые есть в наших клиентах на пилотах и так далее с которыми сталкиваются it и непосредственно и Б департаменты когда занимаются усилением информационной безопасности кластеров cubernatis вот такой примерный наш будет план который мы сегодня с Вами рассмотрим и Для начала я хотел сделать небольшой опрос сколько здесь из присутствующих которые связаны с информационной безопасностью много таких людей есть Да отлично но он будет как вы видите дальше полезен не только и Б Но непосредственно it потому что между ними есть определенный конфликт Я думаю видели многие вот такую вот картинку что есть безопасность есть непосредственно удобство использования и всегда это конфликтует мы либо делаем Это безопасным либо это становится Удобно или либо туда либо туда и вот сегодня непосредственно хотелось бы показать как по крайней мере в рамках губернатиса эти департаменты Ну и по крайней мере департамент который отвечает за инфраструктурную безопасность может хорошо Дружить помогать и взаимодействовать с департаментом it Да как обычно выглядит работай что хочет у нас департамент информационной безопасности Да чтобы соблюдался конфиденциальность целостность доступность информации Да максимально снизить риски угрозы количество уязвимостей которые у вас есть непосредственно там внутри контейнеров на периметров с точки зрения настроек окружения Да и одним из таких пунктов дополнительных является конечно это увеличение цены атаки Да чтобы атакующему просто было уже не выгодно либо чрезвычайно дорого атаковать вашу инфраструктуру И тем самым отметать определенные модели нарушителя которые там как бы можно сказать такие некоторые залетные Вот и как они это привыкли обычно обеспечивать ну есть какие-то бенчмарки требования контроля которые выставляются уже перед it-департамента и вот они просто должны соблюдать К сожалению в этой картине часто так как у бернайте система у нас новая она очень специфичная она всё-таки декларативная Да она очень сильно отличается от просто обеспечения безопасности там Linux сетей Windows сетей Да и часто специалисты по безопасности просто имея свой предыдущий опыт обеспечения безопасности а транслирует его сразу же Ну как бы вот на куберете не учитывая его специфику и вот в рамках доклада Я бы хотел показать как кто учитывает эту специфику можно а дружно жить вместо сойти и когда мы не учитываем эту специфику получается так что it которая хочет у нас непосредственно быстро эффективную надёжную экономичную систему эксплуатировать Да а просто закрываются какие-то определенные рамки и в рамках этих Ну появляется множество конфликтов не состыковок удлиняется непосредственно цикл релизов доставки нового value до клиентов что естественно не хорошо сказывается на бизнес в целом в рамках этого конфликта часто бывает что на эти требования ИП либо забивают либо Ну ищут пути их обхода чтобы непосредственно как-то соответствовать хочется Это непосредственно поправить вот непосредственно ряд примеров одна из чем сейчас все большинство борются те кто начали заниматься таким вопросом когда все копс это сканирование у нас окружении образа в операционных систем на известную уязвимости по нашему опыту клиентов даже барды просто краснючие и спокойная там цифры в духе 150.000 уязвимости в контейнерах сейчас продакшн окружении естественно и ИБС сотрудники не очень хотят разгребать А что там действительно ну настоящее что действует что не действую Да и также самим разработчикам которым эти задачи ставят не особо-то хочется этим заниматься Ну потому что у них есть определенные свои метрики требования свой непосредственно там backlog которому они хотят а тут их начинает отвлекать поправь мне это Исправь мне это необходимо Вот внеочередной какой-то фиг сделать и так далее естественно это требует дополнительных трудозатрат отвлечений нарушений собственных каких-то kpi Да вот никто не хочет возиться с уязвимостями а особенно когда ты ещё не понимаешь что это за уязвимость аффектита она тебе не аффектит кто-то тебе сверху что-то спускает да А следующий момент Это непосредственно когда куча различных контролей Ты должен чему-то там соответствовать это усложняет процедуры там получение доступа непосредственно у меня выкатывание приложений и опять же Это в негативно влияет на скорость доставки нового Valley и как уже все многие привыкли если мы приносим какой-то навесное решение Да на систему это естественно дополнительное потребление ресурсов ухудшение непосредственно производительности и тому подобные вытекающие естественно сейчас особенно да Когда у нас железо вычислительные ресурсы становятся дороже хотелось бы на этом как-то экономить и непосредственно извлекать пользу только чему Мы будем с вами непосредственно стремиться Это непосредственно чтобы эти бы не тратили время друг друга не перекладывали друг другу задачи это давайте Вы посмотрите Нет это Фолз пользователь я тебе говорю это не falls-пости всё-таки ты её закрой Давай да и все занимались своими делами и мы непосредственно могли А чтобы скорость выкатки новых наших релизов новых фич было непосредственно точнее обеспечение безопасности вот этих вот скорости выгодки соответственно скорости а выкидки то есть у нас есть там Континенте integration день в Delivery и у нас должна быть Continuous cecurity которая полностью с ними выровнена в скорости и в процессах и начнем мы непосредственно с кластеров как сейчас в основном в компаниях Ну я видел порядка там я не знаю в различных компаниях Ну наверное за сотню различных кластеров Да в различных компаниях и у нас часто под каждую команду делают один кластер Да вот тем самым добивается конечно высокого уровня изоляции Потому что если команда Сама что-то там напортачит с ресурсами с лимитами там с памятью и тому подобными вещами пострадает Только эта команда и она Никаким образом не эффекты в соседние команды Да но при этом мы получаем очень высокую цену такую архитектуры потому что на каждую команду отдельные мастерноды отдельные контр-плейн да и это достаточно тяжело при этом бывает в компании потому что каждая команда под себя сама поднимает кластер Да и мы получаем в зоне обслуживания просто ну десятки разных кластеров я встречал в компании где там вроде бы вы считаете кубер на эти Да когда начинаешь по факту смотреть здесь Вани выберетесь здесь ранчер здесь укд здесь openshift здесь еще какая-то там платформа была поднята Да здесь кулер А тут вообще где-нибудь в облачного провайдера менеджмент кубернетис использует когда такой зоопарк Это непосредственно инженерам там инфраструктурной команды там среды вопс тяжело потому что не просто теряется в количестве таких окружений оно каждое для них уникальное и когда там нужно что-то отработал шутить да понять причину сбоя Ты сначала понимаешь что у них тут вообще затвориться и что они тут наворотили как бы да вот и связи с этим как бы сейчас последние годы можно сказать такой бум платформенных команд и всё больше в больших компаниях появляется платформенная команда Да которая сама делает на базе губернатиса так сказать дистрибутив да и этот дистрибутив уже распространяется между департаментами и он получается некоторый унифицированный Да и если они приходят помогать э-э какой-то из-за команд то они понимают что это из окружения из чего Она состоит какие там стоят компоненты версии и так далее намного проще обслуживать единообразное окружение с точки зрения специалиста по безопасности зоопарк это тоже геморрой они также не понимают если случится какая-то комплиментация случится инцидент нужно понимать а где там логия в каком они формате система подключена не подключена Да какие средства защиты Там стоят не стоят Да а версия последняя не последняя какие там вообще библиотеки и уязвимые свежие CV тоже Для них этот зоопарка Но это гигантский геморрой и сейчас как я уже сказал все непосредственно в индустрии движутся к платформам да Такое губернатицу у нас как многие говорят это ядро линукса 21 века мы говорим всех губернатис но по факту в компаниях уже делают свои собственные платформы Да и наши специалисты и там и вопс и разработчики уже работают с платформами а не с голым губернатиз не с этими пресловутыми Там пять бинарниками Да как говорят вот следующий важный момент для экономии ресурсов Да тут а важно отметить что сам по себе куберетесь не является мультитеменной антиокружением да Там его ну нельзя взять из коробки распределить между множеством команд сам по себе на мспейс а он это логическое отделение для ресурсов не более никакой точки зрения ограничений безопасности он не несёт мы спокойно можем наши микросервисом из одного нспейса обратиться в другой name Space там с тестовыми спейсов продаем Space продавцам данных и так далее Вот и сейчас активно В том же непосредственно cubernetic сообществе Да в cncy тема мультитаностей развивается она бывает на различных уровнях на уровне кластеров Да например Это проект кластер API когда создается управляющий кластер этот управляющий кластер просто из шаблонов способен создавать новые управляемые кластера то есть полностью декларативное управление всеми вашими кластерами и за один из одного интерфейса декларативно мы можем создавать одинаковые копии кластеров под Каждую из команды поигрались попробовали убили кластер нужно воспроизвести воспроизвести тот же самый Да И вот класс терапия активно сейчас уже начинается внедряться и даже и в российских компаниях Да а более распространённым представлением мультитенонси когда мы хотим экономить ресурсы является как нумпейс режиссервис когда мы можем непосредственно вокруг классического nps а накрутить более защищённый и закрытый изолированный импс кто работал с Open шифтом у них например есть такая концепция как Project его в классическом кубинате Да вот Project наверное можно представить как нем спейс из resers есть еще более экзотические способы типа Control plain и за сервисов дополнительный подход как not Basic они не так интересны Да и мы непосредственно используя самый распространенное там вот я знаю в компаниях мы встречаем например проект капсул Да который и сетевую изоляцию дает изоляцию на уровне там ресурсов реквестов лимитов и тому подобных вещей позволяет командам спокойно жить в своём спейсе они там непосредственно делают что хотят и при этом не могут навредить Ну как бы намного меньше шансов навредить соседним командам помимо того что нам нужно создать кластер Да за которым удобно следить и контролировать и будет единообразно в тех же шаблонах службы безопасности один раз как бы просканирован доведен до всех требований безопасности нужно смотреть как он будет у нас жить и развиваться в губернации есть специализированные механизм как адмишин контроллеры Да на базе Их есть класс решения под названием policy Engine Ну в качестве примера самая популярная думаю Вы встречали ки верно либо пей Гитлер это на самом деле инструмент небезопасник Да потому что вы с помощью полиса инженеров можете проверять любой Ямал ресурс любой его поле выставили правильный среди нас проб да если нет Можем его развернуть Непосредственно да а просто ну заблокировать А можем просто выслать предупреждение например staging либо тестовом окружении что типа так делать нельзя в проданном окружении это у нас не пройдёт как бы сейчас можешь дальше не получится либо например мы можем не заблокировать а просто предупреждение и например тот же умеет даже мутировать если разработчик забыл в ресурсах указать что-то из требуемых описаний Ну например Security контекст привол Edge false чтобы привилегированные контейнеры у нас не запускали мы можем сами мутировать и добавлять это в ресурс да то есть у нас все микросервисы которые будут в процессе жизненного цикла кластера появляться они будут чётко соответствовать этим политикам и все кластера будут всегда находиться как бы ну в Едином состоянии с точки зрения там требований ваших внутренних без практики тому подобных вещей следующий важный Аспект это операционные системы на хостах сейчас Когда приходишь в компанию смотришь на чем у них развернуты кластера кубернетиса там это обычно у бунту деббин и центосии федоры такие классические операционные системы Да и при их использовании мы получаем как бы достаточно большой А так Surface Там есть много лишнего что вообще для кластера кубернетиса не используется там много компонентов там много уязвимости если вы возьмете классическую бунту просканируете вы увидите море всего и при этом так как-то море всего атакующий в той или иной модели нарушителя который туда проникнет у него есть огромное количество способов там скрыто закрепиться там почистить свои следы и где-то непосредственно оставить различные свои закладки и бэкдоры Вот это проблема операционных общего назначения если мы даже вот задумаемся и Может кто-то знает почему в кубернетесе отказались от Докера Да потому что докер сам по себе это был разработан для человека для регистратора он был избыточен там было много того что ему не надо современные контейнеры антаймы работают по крин интерфейсу и они порядка всего лишь там семи вызовов используют и всё в докере их было за 50 это как бы кубернетису было избыточное они его убрали да и почему мы непосредственно хотим прийти и как бы уже А всё сообщество идёт это использование специализированных операционных систем для контейнеров они просто заточены на то чтобы запускать контейнеры всё остальное у них вырезано благодаря этому мы получаем и более маленький размер Да ну как бы экономия памяти непосредственно при этом уменьшение поверхности атаки это у нас и то что атакующий если каким-то чудом выберется из контейнера на ноду ему там закрепи тяжело найти чья-то дополнительный инструмент для развития атаки на соседние системы их просто нет они вырезаны Да вот они как правило там не знаю имеют три Дон ли операционную систему Да и из-за того что там нет ничего лишнего опять же сканируем там известными сканерами на известную уязвимости Там просто меньше срабатываний чем меньше срабатывание Чем меньше этих меньше работы Как найти так и на eba Да разработчики не отвлекаются на то что Ну они вообще Никаким образом это не используются что в качестве примера сейчас можно встретить вообще в индустрии э этих образов появляется всё И больше я тут Наверное выписал самые популярные наверное отдельно сейчас скажу про то что у стройки ведущих плавных операторов сейчас есть собственные специализированные образы Ну например у амазона это Battle Rocket у Гугла это коз и вот недавно компания Microsoft купила компанию которая разрабатывает flacar Я думаю это как бы не случайно Flat Car либо в таком виде непосредственно ляжет как основной образ для контейнерных систем вэйджеры либо на базе него что это будет сделано вот поэтому все идут туда чтобы максимально с минимизировать эту возможность непосредственно и уменьшить А так Surface И как вы понимаете Чем меньше операционка тем быстрее при скалировании и так далее Она будет разворачиваться и меньше там с тобой что-то нести отдельно отмечу операционную систему которая все чаще также начинают наши клиенты тестировать и даже использовать это операционная система Талас она даже позиционируется как cubernation систем а-а помимо того что она как бы специально заточена под запуск только контейнеров Да она как бы э-э полностью и мутабельная у неё редон ли файловая система да и у неё например что очень классно у неё вообще нету шла туда вообще специалист даже зайти не может благодаря этому мы можем определённые модели нарушителя с точки зрения информационной безопасности из нашей там матрицы угроз выкинуть при этом так как она операционная система обычно специалисты по безопасности любят предъявлять требования к операционнкам духе там наличие антивирусов проверка контрольные ценности определённых файлов какой смысл это проверять на и ему табельной операционной системе а не просто там не появятся Да и мы экономим CPU память на вот эти вот расчеты которые обычно привыкли делать на операционных системах общего назначения когда атакующий там вываливается из контейнера либо скомпрометированный разработчик да либо инженер туда может зайти а здесь нет доступа здесь редон для операционная система смысла нет При этом когда я общаюсь с инженерами которые уже начали использовать они говорят нам дешевле быстрее поднять ноду из чистого образа этой операционной системы чем поставить задачу инженера иди посмотри что там случилось не так что у нас будет смотреть на рентабельном образе нам дешевле и быстрее Ему просто сделать если там что-то произошло Да мы её можем вывести там из парка машин и отдать службе безопасности для расследования инцидента если они уже так хотят Да вот но тут инженеру не нужен прямой доступ если мы хотим внести изменения Да там можно пересобрать Новый образ перевыключить его и так далее Также что классно операционная система - это уже например получается с той же а фишкой кластер API Вы можете декларативно в класс терапия определить шаблон кластера шаблон хостовой операционной системы и так далее Я на вас просто будет по фишке это создаваться дальше базовые образы контейнеров с ними ситуация печальная когда мы берем классические операционной системы в качестве базовых образов там у нас есть нижележащий слой базовой операционной системы там различные runtime зависимости сторонние библиотеки только дальше идёт наш код по последним данным каждый микросервис примерно всего лишь на 30-40 процентов состоит из самописного кода всё остальное это сторонний код который Ну не писали не наши разработчики И если мы начинаем сканировать подобные образы на уязвимости мы просто улетаем куда-то там никуда непосредственно При этом стоит учитывать проблемы всех этих сканеров они базируются чисто на версиях да И когда мы например собираем базовый образ для нашего контейнера на какой-нибудь ubunty там лежит куча всего да Опять же это куча лишних компонентов это лишние размеры увеличения поверхности атаки возможность там шела опять же атакующий каким-то образом либо встраиванием вредоносного кода либо непосредственно там эксплуатация какого-нибудь уязвимости попадает внутрь контейнера у него есть Shell он спокойно докачивает новые инструменты либо вообще берёте инструменты которые уже лежат в образе и сканируют сеть развивают атаку закрепляется пытается сбежать на ногу Вот и проблема в самих сканерах Да их сейчас ну популярных штук четыре пять примерно Да и самое Забавно было несколько исследований брали самые последние версии операционных систем вот там не знаю берём дебень федораслей Да даже мы возьмём их просканим самые последние версии вы получите за сотни известных уязвимостей То есть вы ещё ничего не начали делать из своего не накатывать А у вас уже работа появилась потому что там есть незакрытую уязвимость Да ну как-то не очень хочется Заниматься тем что реально может вас вообще Никаким образом аффектить это как бы огромная большая тема но с этим приходится сталкиваться что и нужно непосредственно делать опять же необходимо минимизировать Да заниматься минимизацией того что мы реально используем в этом направлении также есть определённые технологии решения Ну есть как некий тонкие образы типа того же дебина да есть дебиан Слим есть маленький образом на базе альпано да И к чему я больше хотел но их специфика заключается в том что там например тот же Shell есть опять же атакующий если про эксплуатируют уязвимость у него будет окружение и возможность закрепиться сделать разведку в вашем окружении какие-то инструменты наоборот докачать и развивать свою атаку Да сделать такой плацдарм для дальнейших действий но а есть другой класс Это непосредственно э например Скретч образы Да это вообще пустой он подойдёт далеко не всем а потому что это только статический слинкованные бинари Да если какие-нибудь жаворотаймой питон runtime ну как бы это не пойдёт Но это самый минимальный образ это там для всяких не знаю сишек кошек специально собранных отлично подойдет дальше компания Google придумала дистролесообразы в которых она вырезала операционную систему я оставила только Ну некоторые минимальный набор для работы приложения и совсем недавно появился отличный проект который еще чуть дальше поговорю дальше images это целый набор который Вам позволяет достаточно просто декларативно создавать свои собственные дистролес образы и третий подход который существует это использование минификаторов одним из представителей таких минификатор является проект докерслим он в виде сенсора запускается в образе который у вас обычные на лбу на федоре и на чём-то ещё в процессе своей работы он смотрит Что делает приложение Какие библиотеки использует куда ходит и делает итоговый образ в котором есть только то что она видела что реально использовалась Ну как вы понимаете Всё зависит от покрытия тестом если там есть операция которая происходит там раз в неделю раз в сутки там раз в месяц он это не видел то у вас будет нерабочий выброс Поэтому с такими штуками как минификаторами нужно быть очень аккуратным при этом сами дистролесообразы которая придумала компания Google они бывают разные они бывают там стейк Base CC срантаймами Да как бы от более тонкому у нас на слайде к более толстым они представлены и у них есть свои там недостатки например на статическом образе отсутствует различные там директории сертификаты которые как правило нужны приложениям и ну на статике Вообще редко Кто делает И вот на бейсе они например уже начинают у нас появляться там Open ssl жили пси либо ssl библиотеки поэтому Когда вы для своих приложений выбираете dest-образ А вам нужно правильно подойти к какой дистролес образ для вас выбрать Тут правда разработчики могут возмутиться вы конечно горит Молодцы убрали А так Surface а как нам эти приложения отлаживать-то Там же полюбо есть какие-то баги ошибки а как мы будем там пингом пользоваться докладчики запускать и так далее Вот и в кубернетесе С недавних пор там с версией 1.18 в альфы появились специализированные контейнеры называемые эфемерный контейнеры да Раньше у нас были только и нет контейнеры и основные контейнеры Вот теперь есть третья категория которая как раз нам позволяет через команду купцы тельдибаг присоединять уже запущенному контейнеру Новый образ тем самым мы можем использовать дистрибус образ дело у вас только приложение которое написал разработчик и больше ничего нет Да а с помощью вот дополнительного образа Вот например есть проект Cook Kids они собрались специальные образы где куча отладочных инструментов оплачики профайлеры трейсеры и тому подобные вещи да то есть если у нас случается проблема разработчик может запущенному контейнеру образ отладочными инструментами и его отладить отладив это он отсоединяет этот контейнер и все Да опять же атакующий если проникнет у нас в рамок в рамке дестролеск образа он ничего не сможет сделать вот Представьте в атакующего есть там рсе уязвимость и он может производить выполнить любой код а там ничего нету да как бы очень неудобно но например стоит не забывать что не все дистрелеса образа одинаковые как я уже говорил И вот в одном из недавних исследований было представлено Как можно выполнить произвольные любую команду писать файлы читать файлы выполнять любые команды на дистролесобразах класса Base от компании Google там есть клиент openssl по сути можно обратиться просто клапан с целью и дальше через его Клин интерфейс писать файлы читать файлы выполнять команды и так далее И тут становится вопрос например что вам здесь подходил Ну вот вам не нужен Если вы хотите выкинуть Да и я например знаю уже определенные компании Они из финансовой сферы они уже начали готовить свои собственные дистролесообразы Например у них может быть дистрелесообраз здесь только инжинкс есть только постгрыз либо еще какая-нибудь утилитка больше ничего нет они просто под конкретный сервис делают специализированный образ где только это может работать и ничего другое и вот как раз ребята из ченуард сделали набор инструментов в качестве у них есть волосы операционная система который Вам позволяет декларативными э-э с помощью декларативного подхода собирать свои собственные образы у них на гитхабе лежит большое количество уже заготовленных всяких питонов дотнетов и тому подобных вещей инжинсов апачей хапрокси инвоев отдельных Да где кроме них ничего нету И вы также можете под себя делать свои Дисней образы с учётом вашей бизнес специфики и тому подобных вещей на самом деле из дистролесобразными от гуглавы это можете делать но у них используется своя собственная сборочная система базы и с ней как бы надо повозиться это как бы вопрос наверное там ни одной его дня ни одной недели а у них это декларативника ямниками всё подход и намного проще это делать И вот сейчас те компании которые я знаю начали уже под себя дистролес образа скажем так готовить они в основном используются Данный проект И тем самым сужает Атак сюрприз Да и там мало чего лишнего Какую можно вообще не непосредственно пользу из этого извлечь А мы получаем как например it определённое время на закрытие уязвимости Да она выходит какая-нибудь критичная уязвимость и там все срочно надо пачить ночью и так далее да но э как бы если уязвимость уже известная имейте в виду уже через пару часов точно выйдет Explay да вот а в таком случае даже если она вас не заплачено ещё приложение атакующий не сможет Ну серьёзные вред нанести потому что он проинспортирует приложение а дальше что ему делать в обра ничего нету это намного усложняет саму атаку и поднимает как бы цену атаки уже любой скриптиде который скачает в интернете эксплоит ну не сможет нормально развить атаку я сделал такую небольшую сравнительную табличку чтобы показать размеры количество уязвимостей Я одним из сканеров взял просканировал когда я говорил про сканеры что они даже в последних версиях находят известную уязвимости я также был отметить что взяв любой из этих сканеров и просканировав образы одни и те же вы получите разные результаты это тоже Забавно одни сканеры ведут себя на одних таргетах лучше другие на других и любят спрашивать А какой сканер вы хотите посоветовать не могу ни один посоветовать потому что они в разных ситуациях ведут себя по-разному ну на всякий Хай критиков и медиа хуязвимость они в принципе все ведут себя одинаково отличие у них на всяких lol там не знаю чем их уязвимостях только Начинает появляться Ну на критичных они все как правило ведут себя одинаково Идем дальше сеть куда же в микросервисах без сети Какие проблемы мы сейчас видим в компаниях Ну первый момент чаще всего компании вообще не понимает что у них в сети творится Да сеть kubernetics у нас плоская и по факту любой подвиг с любым подиком может общаться нет никаких ограничений Вот и конечно есть классные доклады Как подойти формально к обеспечению безопасности микросервисов Но как правило сначала сделали mvp проекта типа это имбирь фишка да давайте её потестим вот это впроты уходит естественно никто формально не подходил никакие схемы не писал и никто не знает да там этот с этим сервисом общается Оказывается он ещё телеметрии отправляется оказывается у нас Трейси логики ещё куда-то уходят А ещё мы сервис мышь взяли это ещё взаимодействие с Control plain нам в другом нам спейсе А ещё мы там интеграцию написали и никто не знает как это действительности ходят и проблема а в большинстве компаний что у них вообще сеть никак не ограничена Да в губернете есть специализированные механизм под названием netforce это такая родной межсетевой экран cubernetis агдади по принципу вайтлиста описывается сервис А общается сервисом б по такому-то порту сервис b-сервисом цен по такому-то порту и все сервис а сервисом C вообще не может общаться да сервисом B только по определенному порту и по другим портам он вообще не может общаться естественно не зная полной картины применительной циркполисе Это примерно себе выстрелить в ногу и отрубить э взаимодействие с другими частями поэтому сейчас на проектах мы вообще мало встречаем Network policy да Но наверное только из финансового сектора а компании к этому жёстче подходят в остальных компаниях с этим намного всё действительно хуже и поэтому если у вас нет нормального мультитансиокружения а так даже ваши разработчик при отладке в тестовом спейсе и это в одном классе рис продленным спейсом находится он просто берёт делает там Shell и лезет продуктовую базу данных Да как бы сливает оттуда что угодно обращается к продуктовый микросервис поэтому подобные вещи вот а да При этом непосредственно очень многие еще думают что как любой контроль также Network policy очень сильно негативно скажется на производительности Да если вы смотрели доклады про истину про замеры и так далее если брать всякие it скажем фишечки есть а там ещё очень сносно Но если вы на истину включите э авторизин по лесу либо непосредственно Там mitchelta tails просто оверхед будет в x5 x 10 на этом трафике да И когда люди думают он это паркуемся они думают мы сейчас времени У нас сеть вообще просядет но есть забавный факт Ну по крайней мере он на таком известном синае как сириум отражается что с применением сетевых политик сеть работает быстрее это очень Забавно Вроде бы мы добавили дополнительные контроля а сеть начал у нас быстрее работать если мы обратимся к исходному коду сильвиума то мы увидим порядок применения сетевых политик и по умолчанию как я сказал сеть плоская и нет никаких ограничений это четвертый пункт полисе по умолчанию то есть по умолчанию он будет всегда до 4 пункта доходить применив networkpolis он уже на первом ифе разойдется и отработает можно или нельзя помимо того что вот так сетевые политики могут ускорить отдельно бы отметил что Сина и нового поколения который базируется на технологии bpf А да можно их там делить которые все работают которые на юбилей Да и bpf позволяет обходить классическую скажем маршрутизацию в ядре Linux Да и определённые моменты очень сильно упрощать и сеть там ещё быстрее начинает работать чем мы будем классически на самом деле когда я рассказывал про вот операционные системы заточены под контейнеры они очень как правило Дружелюбный технологии bpf современно Вот этим Клауд на этих подходу это тоже Плюс потому что с каким-нибудь центасями с еби ппф вам нужно еще по геморроя будет Вот И тем самым применив Network policy Мы можем по крайней мере и в некоторых моментах даже ускорить сеть но не замедлив ее Да при этом сделать хорошую микросегментацию нашей сети Да подойти к концепции которой Ну многие сейчас хотят идти это за ратраз Да нулевого доверия сказали этот сервис общается с этим сервисом И всё да При этом это декларативный подход это проще инвентаризируется Да и очень прозрачно для всех команд разработки когда это делается каким-то навесным средством э безопасности то только безопасники где-то галочку включили только там видно что этот сервис например туда не может ходить а так мы можем э-э как разработчики как epiration команды посмотреть просто Файлик на фарпосе это можно это можно вот это нельзя да просто из уже декларативного описания понятно что надо делать тут либо разработчик просто декларативно меняет куда он хочет идти либо просто делается запрос службе безопасности что нужно каким-то образом её подредактировать Ну и в качестве непосредственно заключения это мини-чек-лист который мы сегодня с вами прошли это мультитаносное окружение поле синджайн в процессе жизни самого кластера Да специализированная операционная система для Хоста очень тонкие образы только с минимальным необходимым для базовых образов самих образов для тех приложений и конечно сетевая политика и отдельно отмечу что это не является Серебряной пулей и не все аспекты безопасности кластера кубернетиса есть ещё и непосредственно идентификация авторизация есть непосредственно runtime Security логирование комплайнс и многие другие темы Да мы их сегодня Ну в рамках доклада не берём А я постарался рассмотреть то что на стыке it-b может непосредственно друг друга дополнять и помогать И как бы дружить их между собой Ну вот и мой опыт показывает Так как мне приходится и Сойти с собой общаться И да и слушать точки зрения одних и вторых на самом деле они хотят все хотят одно и то же просто это у всех в разными терминами называют Да мы хотим не знаю с точки зрения it получить там само селфилинг селфи-контролинг систему Да а безопасники хотят непосредственно чтобы у нас инциденты определённые а Мисс конфигурации автоматически разбирались у них это специализированный класс решения как Суар Секьюрити стрейшин а-а системы называются Да они тоже хотят чтобы автоматом без их ручного труда эти кейсы отрабатывались Да а it хочет декларативно всё описывать чтобы было понятно и система сама приводила а-а себя в нужное состояние Да безопасники тоже хотят чтобы это было всё понятно И прозрачно чтобы любой специалист это мог непосредственно поправить одни хотят чтобы была нормальная сегментация эффект одно из зоны не приводил непосредственно к сбои там а всего приложения Да безопаснее кафе то там Zero Trust непосредственно нулевое Доверие что только эти компоненты между собой общаются Да по сути из каждых этих моментов можно поставить знак равно и из-за того что часто и it eBay этого не понимает и возникает различные варумы конфликты и тому подобные вещи но на самом деле Вот по крайней мере опять же повторюсь губернетесе благодаря его уникальности модели эти моменты решить Ну намного проще Вот и сейчас э уже пару лет назад есть такая интересная идея которая хотел поделиться К сожалению я её придумал вот а обычно в информационной безопасности у нас всегда есть конфиденциальность целостности доступность Да вот постулаты уже сколько лет и а-а было предложено что они именно смену придёт непосредственно распределённость ему табельности мерность да то есть система не должна быть а доступная она должна быть распределённой в любой момент она может просто быть доступной откуда-то ещё мы она должна быть информация не целостной А ему табельная ну зачем за неё смотреть если она просто неизменяемая да и непосредственно не информация там различных секретах губернете с ключиках не должна быть конфиденциальной а м а должна быть ифемерная потому что так или иначе у нас инцидент случится нельзя жить в смысле в том что инцидента никогда не будет он по любой будет Да она у нас должна быть и эфемерная мы в любой момент по щелчку палец должны уметь менять тот или иной секрет у микросервис и всё и атакующего вроде он сейчас скомпрометировал что-то получил но через одну минуту это уже будет ему не нужно и бессмысленно Да И вот постепенно Я надеюсь что по крайней мере в контейнерных окружениях там в куберетесь и мы сможем прийти Вот к такой вот парадигме вот с точки зрения опять же на стыке it и B Да у нас удаватся есть непосредственно такое catal nps на домашние животные скот Да есть системы которые мы очень любим и трепетно ними заботимся не дай Бог что с ними случится Да как домашние животные есть система как Скотт легче Её убить застрелить перезагрузить чем разбираться что там с ней пошло не так да вот это как бы с точки зрения вот автора той концепции это вот когда у нас конфиденциальность целостности доступность Да но если мы переходим в концепцию распределённости ему табельности эфемерности да то вот эту же редон ли а операционную систему на кластерапи нам проще взять убить создать нового Да даже на самом деле есть западные гигантские компании которые вводят такую практику как они периодически перезагружают долго работающие ноды долго работающие микросервис с точки зрения безопасности там есть такое направление как Хаус Инжиниринг а нет называют Security House engineering То есть если атакующий даже каким-то образом проник внутрь контейнера внутрь ноды Они видят что нода работает либо контейнер дольше дня но не просто его тушат перезапускают с нуля клиент ничего не видят атакующий будет выкинут атакующий если даже это знает да он будет мельтешить он будет торопиться он будет непосредственно делать лишние движения и может ошибиться что сработает на security-решениях А нам этого ничего не стоит у нас что было 10 реплик что 11 репли кто девять то 10 без разницы да получаем что мы атакующего загоняем в динамически А такое развивающееся окружение где Ему тяжело просто закрепиться и я знаю компании Правда иногда шутят в том что у нас релизов день больше чем там несколько раз в день происходит и любой атакующий если туда и проникнуть него Всего пару часов там подержаться все равно разработчики об тестирование начнут делать кенере диплоинманты его выкинет в этом тоже есть интересная Правда при работе с контейнерами то что динамическое окружение атакующий привыкли работая с Linux и Windows сетями что это статические окружения они их могут просканировать получить информацию подготовиться к атаке сделать эту атаку да А когда они приходят к контейнеры в куберетесь где у тебя айпишник ничего не значит всё меняется этот сервис был на одном IP через минуту Уже на другом айтишники тут был версия образа одна он тут его кто-то обновил тут кто-то решил ноду просто убить потому что она больше дня живёт и так далее естественно в динамическом окружении атакующему производить свою атаку распространение намного тяжелее вот ну и в качестве заключения основные мысли которые бы хотел донести Это непосредственно что минимализм снова в моде Да используем только то что нам действительно нужно в окружении что у нас снижает непосредственно саму поверхность атаки уменьшает шумы различных сканеров да и просто ужимает нас по ресурсам и размерам Да если у нас там раньше требовалось много что мониторить смотреть за целостностью файлов компрессов и так далее мы берём уже один предзаготовленный там явлик файла описание конфигурации которые прочекало безопасность везде его раскатываем какой смысл смотреть поменялся этот параметр если нет Если там всё на редон или доступны нет смысла Да дальше Всё идёт непосредственно к унификации чем у вас более однородные окружения тем проще их найти и B поддерживать Да не нужно каждый иметь какую-то особую знание вот Естественно С архитектурной точки зрения нужно идти к максимальному упрощению известный в области безопасности специалист брюшная как-то сказал что сложность является злейшим врагом безопасность сложность является злейшим врагом снасти потому что наша система это дня ко дню становится все более сложными но также есть теории управления мы знаем что чем больше механизме движущихся тем больше вероятность что что-то выйдет из строя поэтому тем более проще ваша система Да чем меньше там лишних компонентов частей элементов библиотек Ну тем меньше вероятность самого этого непосредственно с боя Ну и в концепции вот этих всяких реферальности распределённости Да а также безопасники сейчас старается идти непосредственно к Self protection системам Да как бы есть селфилинг селфи-контролинг система Почему бы не сделал protection система Да it старается идти к антихрубким системам когда от сбоев Да это подход который там netflix Das их Security House engineering продвигает когда не через бой становится все более устойчивыми и надежными непосредственно и будущее непосредственно не за контролем и Б зайти а за непосредственно к операции когда они работают совместно Я думаю постепенно те же функции B будут уже возлагаться на инфраструктурных инженерах и непосредственно самих инженеров которые отвечают за эксплуатацию тех систем за которые они отвечают на этом У меня все спасибо за внимание Дима Спасибо большое великолепно открываем вопросы в чатике там уже прилетело Итак номер один Еремин Денис кто должен составлять Network policy разработчики безопасники архитекторы аналитики зачастую Никто не знает всех запросов которые фоне происходит часто бывает что вроде все описал запускаешь а система не работает и разбираться Кто виноват разработчик его доступы сеть превращается в квест Да это абсолютно правда вопрос кто должен составлять Не только это естественно должна быть и командная работа потому что тоже например разработчик может и вообще не знать что у него напроде будет какая-нибудь сервис mash которая только Ну конечно выкупом внедрить дополнительный сайт контейнер поэтому сам раз может снять только часть бизнес-логики Да вот команда которая навешивает мониторинговый трейсинговые решения которые также в яме конвертируются разработчик про них тоже может не знать он может быть конечным пользователем этих данных но не тем человеком который у него там Локи прометеос Кто там еще есть он может этого не знать да то есть разработчик непосредственно может писать собственную часть дальше эту политику берёт на себя там не знаю платформенная команда дописывает свою часть и бэшная часть например в некоторых правилах там может блокировать доступы исходящие сети какие-нибудь запрещённые страны регионы на определённые айпишники иоки Да поэтому это Ну всегда комплексная работа нету отдельного департамента и обычно политика вот так вот идёт через департаменты в одной из компаний я встречал что если а какой-нибудь Команда А хочет взаимодействовать с сервисом б сначала разработчик создаёт заявку на тимлида команда а он её проведет дальше Она идёт на тимлида команды б к которому хотели Коннект быть и потом это заявка уже идет на команду Security которая правит что она действительно дает там взаимодействие между этими сервисами Поэтому в разных компаниях по-разному но всегда это взаимодействие Но это вспоминается песня Бориса Борисовича Гребенщикова Мама я не могу больше пить потому что все чтобы со всеми договорились нужно долго разговаривать вот Кирилл гашков отвечает на предыдущий вопрос так архитектор должен проектировать связи с другими архитектор Как можно запускать и эксплуатировать по о котором не знаешь Это здорово правильно но суровая реальность Такова Но есть один момент Друзья давайте зададим вопросы вот в центре есть и Спасибо большое за доклад доклад офигенный очень много интересного очень много интересных инструментов особенно в части про дистрелес контейнеры оси Я вообще разработчик но я работаю в обычные компании поэтому я вопрос как будто я и больше что-нибудь из этого сертифицировано на родине нашей скажи мне как безопасник безопасности У тебя есть сертификат К сожалению нет И то что я вижу сейчас сертифицируются это операционная система общего назначения И нацеленных на кантонизацию К сожалению ничего нет комментарий из зала нам до этого еще как до Луны но до Луны кстати недалеко можно если дистролес образ стоит подразумевает что операционной системы нет а если нет то нечего сертифицировать операционная система же нет Дим Спасибо за доклад ты сказал про дистролес и тут интересно когда разработчик берет на себя создание такого образа он еще и должен взять на себя тогда вопросы цепочки поставки С оплачейн Правильно Потому что когда я использую операционную систему общего назначения я полагаюсь на майнтейнеров этой системы что они там из правильных источников взяли все пакеты все это заинтегрировали подписали Эти пакеты там и если я сделал цепочку доверенной загрузки У меня все хорошо здесь релез там тоже какие-то сбом или что там Ну вот как раз когда я говорил Почему Chain Guard Image сейчас очень популярно у них все образы которые они сами делают они формируют для них сболом для тех кто не знает это со в твоей биллов материям это полная инвентаризация сторонних библиотек которые используются в данном образе и плюс они и также ещё с помощью утилиткин подписывают данный образ у них например это как бы из коробки доступно Это правильный подход и хорошая тема поднял Круто Спасибо это наш следующий спикер к слову можно сюда микрофон пожалуйста и пока комментарии конечно дополнение в контейнерных ОС на редонли только корень А многие пойнты смонтированы отдельно например War и TC и доступны для записи да это правда Ну просто обычно всякие утилитки которые смотрят целостность определенных файлов Они как раз на корень ты и смотрят что там файлы операционной системы не меняли чтобы атакующий не мог закрепиться Да Дмитрий Спасибо за доклад такой вопрос немножко выходящий за рамки cubernet Я работаю в компании который кластер заточен исключительно под мониторинг то есть по сути у нас мониторинговая система инженерной системы и вы как безопасник скажите пожалуйста ваше мнение не будет ли чрезмерным политика безопасности и на низком уровне и на уровне Спасибо железо напрямую то есть допустим какие-то источники данных которые работают условно на базе на промышленных протоколах связи безопасность эта вещь комплексная вот поэтому конечно нужно использовать все и я считаю что мониторинговой системе это Также важно если вы вспомните инцидент прошлого позапрошлого года когда известную мониторинговую компанию взломали и вы его поставки внедрили вредоносный код а потом по клиентам мониторинговая система разъехалась и они попали в федчин 500 Да поэтому вы также можете взять прометеос не из того образа Да раскатить его себе а там окажется вредоносный код поэтому любую Часть системы естественно нужно ограничивать Один известный специалист компании Google сказал что обеспечение Безопасность это ограничение сложности системы за которой мы следим то есть чем там проще и ограничение тем Будет нам проще обеспечить безопасность Спасибо кому подарим игрушечку за лучший вопрос Хмм за лучший вопрос я думаю спикеры следующим будет не комильфо дарить Но такое Да мне про операционной системы и больно было и приятно обмахните рукой А вот молодой человек про операционной системы да а это будет вторая игрушка За сегодня отлично Ну что Да отлично тебе тоже памятный призы от конференции Спасибо большое за доклад Спасибо"
}