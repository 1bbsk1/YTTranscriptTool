{
  "video_id": "7owmOSg-mHA",
  "channel": "HighLoadChannel",
  "title": "Безопасность CI/CD / Алексей Федулаев (Bimeister),   Андрей Моисеев (ИнфоТеКС)",
  "views": 785,
  "duration": 2877,
  "published": "2024-04-17T01:09:35-07:00",
  "text": "собственно Всем привет Спасибо что вы пришли и давайте начнем давайте для начала познакомимся Меня зовут Андрей и я пять лет работаю в безопасности и последнее время работа в компании инфотек занимаюсь внедрением Практик безопасной разработки собственно передаю слово тебе Меня зовут Алексей я депсиков с компании be Master я делаю наши продукты безопаснее и мир лучше Вот собственно сегодня мы поговорим о такой интересной теме как безопасность трудно себе представить высоко нагруженный продукт без Ну и расскажем мы по большей части про наш опыт и попробуем зама пить его на недавно вышедшую стандарт безопасности в левом нижнем углу будут ссылки на категории соответствующие этому стандарту собственно сейс идеи это как кровеносная система она окутывает и окутывает Да весь наш продукт и также как кровеносная система она может быть использована для доставки это может быть доставка как чего-то полезного Ну так и чего-то не очень полезного Собственно отсюда и вытекают все наши дальнейшие проблемы о которых мы сегодня хотели бы поговорить и вообще в принципе если заметить очень много внимания как раз уделяется различным там инструментам с астом даст Там постоянно это видите это в вашем поле зрения А вот именно безопасность и себя внимание не уделяется хотя это очень ключевой компонент для такой для вашего продукта Ну и Мы также подготовили слайд Бинго с некими антипатерными безопасности которые Ну я думаю знакомы многим из вас и если кто-то видит что-то знакомое то этот презентация явно поможет если кто-то узнал что-то Из своего опыта Поднимите руки начнем мы пожалуй основную часть фразы если кот собрался работать Значит все хорошо ничего делать не надо значит всё готово это база собственно и живет такой разработчик Да по заветам ддд но только давай давай диплой когда должно быть Вчера когда нужно срочно без проверок и все такое И вот мы имеем такого разработчика А еще этот разработчик считает что он пишет лучше кот и мы с этим не спорим это действительно лучше но какие-то там безопасники тестировщики приходят накручивают какие-то проверки заставляют исправлять и без того идеально работающий код Ну допустим Человек видит что я могу взять без проверок либо не включать проверки Ну зачем мой кота так идеальный и всё работает собственно это меньше что может произойти И даже если не произошло сейчас когда ты это произойдёт а допустим он ещё может подумать А почему бы не добавить консумерам по небольшому майнеру в инфру Ну им не жалко и мне будет полезно вот собственно очевидно Это не все что может быть плохо и наиболее такие распространенные проблемы это авторазвертывания билда Например без каких-либо проверок либо наличие ручного триггера который позволяет обойти и забайпасить все проверки которые у нас есть соответственно без контрольной пушку от библиотеки которые мы используем на проводе наша собственная библиотеки которым туда заливаем загрузка артефактов наша локальное хранилище наш репозитории без проверки без валидации подписи например и наличие доступа к роду разработчиков что зачастую приводит к дебагу напротив Я думаю это довольно-таки плохо да я вам по глазам вижу некоторые отлаживает на прозе вот собственно вообще в принципе С чего Нам начать какую-то безопасность ac/d как-то начать двигаться в эту сторону и понятно что в первую очередь нужно разобраться в Source Код менеджере да то есть это выделить каких-то кодовнеров разделить там возможно отдельные репозитории сделать гид сам модули исключить вообще все вариации Пуша Мейн э сделать невозможным селфорувин То есть должен быть обязательно построен процесс код ревью а код должен ревьюиться а пруф должен происходить с несколькими лицами и здесь Наверное важно отметить тот факт что Лиза должно быть несколько Почему Потому что Например какое-то одно лицо он может там заболеть он может быть там быть в кранчей и сильно заняты топ-пров не глядя его можно подкупить Ну конечно скажется так можно сделать из несколькими лицами будете правы Но это будет сделать гораздо сложнее и вероятность какого-то нехорошего события будет меньше собственно двигаемся дальше а у меня кода на слайде бросаем такой типовой пример репозитория и здесь важно отметить как раз важную вещь что конфигурация и содержимое некоторых файлов оно аффектит в принципе на безопасность приложения То есть например в Security gitlabsio яма у Вас могут быть там какие-то Security тесты которые человек может попытаться там отключить изменить условия как-то обойти там неправильной конфигурация пакетного менеджера может привести к различным атакам которые будут происходить через пакетный менеджер там неправильно сконфигурированный хинчард тоже а будет эффект безопасности вашего продукта и здесь важно как раз чтобы ухода были овры и там тот же самый человек с командой безопасности он э согласовывал и обрувил изменений в этих файлах собственно Вот так вот Ну да и важно ещё всё-таки контролировать всё что происходит И для этого может помочь настройка сборки только из Main релиз веток и блокировка сборки из фича и каких-нибудь девток соответственно ревью кода который мы пишем который инфраструктурный код отсутствие в штатных механизмов обхода пророк чтобы нельзя было забайпасить какие-то контроли которые мы используем ну и соответственно ACD как кот Его хранения верификации и ревью всего этого года как обычного кода нашего продукта собственно и здесь Наверное отдельным вниманием стоит обратить внимание на использование подхода эврифин исход То есть когда у вас pipeline хранятся кокот там какие-то конфигурации там того же самого пакетного менеджера что там политики Я не знаю там инфраструктура как кот это все должно контролироваться и версия то есть мы должны максимально исключить такую возможность Что у нас там что-то подсбил разработчик у себя на компьютере Да там добавил это в общую сборку где-то там какие-то у него отдельные части потом он сам собрал сам куда-то запушил соответственно Когда у нас всё как кот мы понимаем конкретный Flow прохождение этого всего мы его контролируем мы контролируем этот код также через код ревью также там через А провод то есть мы понимаем как все изменения что происходит соответственно если что-то идёт не так Мы это можем увидеть и соответственно исправить Ну и в результате секадин у нас завершается следующими выводами все данные хранятся как код проводятся ревью соответственно этого кода можно выкатить Билл только из нужной нам ветки и запретить выкатку билда из рабочих веток тестовых веток автоматизирован Весь процесс и весь процесс также контролируется людьми Чтобы избежать ошибок которые могли быть допущены в процессе автоматизации ну и соответственно у нас есть эталонная модель с которой мы можем всегда восстановиться в базовое состояние которое нам нужно хорошо Допустим мы это все внедрили и разработчик вроде бы такой не может намерены что-то сделать вот он например заходит и видит что он администраторы Что такое человек сможет сделать он может добавить себя в апреле он может убрать вообще необходимость он может что угодно делать с этим кодом из репозиторием соответственно без каких-то следующих этапов все что мы до этого сделали оно бесполезно можно так сказать по сути Ну да нам все-таки стоит задумываться о том чтобы у нас были минимальные привилегии у людей Ну и доступ который был у сотрудников он был нужен только им и невозможно было расширить собственно матрицу доступа плохо когда есть общий аккаунты например админ может поделиться своим аккаунтом чтобы там помочь другу быстро сделать какую-то фичу нельзя выдавать избыточные привилегии это приводит к тому что у нас увеличивается поверхность возможности у непривилегированных сотрудников например что пагубно влияет в целом на процессы связанные с доступом и наличие неотозванных доступов Когда у нас сотрудники покинули компанию либо сменили проект тоже довольно-таки плохо потому что этот аккаунт Может заюзать после того как доступ к необходимость вот собственно нам необходим контроль выдаваемых привилегий Да мы должны понимать Кому мы выдаем какие-то доступы там привилегии и внутри этого доступа области куда можно взаимодействовать мы должны проводить периодически аудит что вот мы год назад целый год набирали сотрудники моим что-то что-то выдавали они там куда-то увольнялись переходили еще что-то естественно мы должны периодически делать аудиты смотреть там Ага например Вася больше не на этом проекте наверное ему не стоит оставлять права на этот проект и естественно это должны быть процедуры отзывы привели да то есть когда человек перешёл на другой проект там в дочернюю компанию просто уволился на не должно быть такой ситуации что человек уже с вами э человек не работает сейчас с вами а доступ у него всё ещё остался естественно нужно внимательно быть с доступом на время да то есть частная ситуация бывает у какой-то команды запара приходят в соседней команде помогите нам Ребята готовы помочь им выдают несколько специалистов естественно выдает доступы ребята что-то там помогли И вернулись обратно а доступ остался вот ну про шаринг аккаунтов Да уже звучало И как мы ранее говорили должно быть несколько админов я прововеров и тут хотелось бы остановиться Да на басфакторе вас не должно все замыкаться на одного человека это же касается Я не знаю например администратор gitlab А Мало ли что завтра может произойти человек заболел человека там я не знаю сбила машина что-то ещё и как бы один админ хорошо а два админ лучше когда второй всегда приглядывает за первым Ну и правильно всё настраивая и дополняем Можно выделить следующие выводы нашим плане не будет избыточных прав у нас не будет лишних доступов у сотрудников которым это не надо вся выдача прав все процессы связанные с этим будут проконтролированы в том числе человеком пользователи не смогут назначать права сами себе или своим друзьям например и доступы уволенных или сменивших проектах сотрудников будут отзываться своевременно собственно я добавил еще в некоторых местах ссылочки там можно будет гораздо поподробнее погрузиться в тему и прочитать мы сейчас прям сильно на всем застрять не будем а то никакого доклада не хватит тайминга на этом хорошо поговорим допустим Все мы сконфигурировали правильно getlab у человека нет никаких доступов Да и весь Flow наших пайплайнов сконфигурированным Так что нельзя их как-то обойти нарушить Но что еще может попытаться сделать с такой разработчик он может попробовать использовать злоупотребление всякими зависимостями злоупотребление зависимости Может там как-то попробовать их подменить он может попробовать поделать различные инъекции либо например там попробовать уязвимости confusion Когда в глобальном там npm или каком-то пакетном менеджере создаётся пакет с более старшей версией И за счёт неправильной конфигурации пакетного менеджера она будет затянута в нашу продукцию А вот что в этой зависимости будет это же вопрос собственно я здесь тоже оставил ссылочку на статью про это можно будет про эту уязвимость поподробнее почитать ну и соответственно чтобы не допускать таких проблем нужно проверять все источники которые мы используем валидировать их проверять там контрольные суммы а-а цифровые подписи соответственно проверять это нужно не только на тех которые заканчивается наше хранилище А ещё на генерированных на генерируемых нами артефактах которые потом используются другим билдами и в результате мы получим что у нас продукте у нас на байплайне на сборке не окажется вредоносных вредоносного по которое могло как-то пагубно повлиять и соответственно отдельные сборки они не будут влиять на соседние на следующие за этими сборками и у нас не будет такого скажем продвижения по сети по инфраструктуре нашего нашей компании хорошо допустим такой разработчик он слышал пройден да то есть отравление пайплайна и он хочет попытаться провернуть какие-то атаки за счет логики работы опять же в своей например фичи ветке он всегда может по своему усмотрению менять этот пайплайн соответственно может туда Дописать какой-то код код может что угодно делать устанавливать какие-то перемены может попытаться вытащить эти перемены из времени может попытаться обращаться каким-то внутренним ресурсом не обязательно даже менять при этом код pyline То есть он может попробовать поменять какие-то Ну типа даже там Shell скрипты для сборки моих файлы это всё может ответить на безопасность вашего продукта и здесь как раз очень важный момент это исключение именно такого воздействия То есть как можно ранее говорили да то есть это отдельные репозитории где вот например храните шаблоны подключаете естественно то есть все межре квесты репозитории вы ревьюете а проводите проверяется или в этом кудондерс гид саб-модуль использовать соответственно очень важно использовать протектор бранчи потому что например в своей там фиче ветке это если не про Так этот бронранча он там пускай развлекается как хочет разработчик соответственно при билдах которые потом впоследствии пойдут на пруд должны уже использовать естественно протектор бронхи и сегментированная инфраструктура для DFM Pro и здесь а это не столько даже про то что вот у вас там есть отдельный разделённые дев и прод отдельно разделённый сколько про им до сборочную среду То есть вы на одной инфраструктуре делаете дев-сборке абсолютно другой инфраструктуре вы делаете Production сборки Ну и настраивайся правильно получаем что для файлов у нас однозначно ответственные которые контролирует все взаимодействия с данными нужными файл нужными файлами инфраструктура сегментирована в том числе там однозначно какие-то виртуальные машины которые делают то что запланировано и нет влияния на соседей сборки Ну опять же это отсутствие горизонтального продвижения по нашему сборщичному окружению теперь поговорим про ошибки доступа в принципе для какого-то для построения вектора атаки могут использоваться именно как раз ошибки доступ То есть когда у нас есть из например пайплайна доступ к информации соседнего pipeline доступ каким-то глобальным переменным возможно каким-то сервисом компании особенно когда там pipline может зайти и там аутентифицироваться например в каком-то сервисе и что-то сделать да то есть это нужно строго ограничивать и сегментировать плюс у нас не должно быть доступа там к соседям следующим сборкам или репозиториям нам нужно исключить возможность влияния на другие сборки при этом побеги из контейнера на хостовую с Ну естественно то есть если это не необходимо упадлайна не должно быть доступа в интернет собственно если парламент спокойно спокойно можете спокойно выйти в интернет пожалуйста вот вам лёгкий механизм X фильтрации данных из вашей инфраструктуры Ну соответственно надо доступ разграничивать и тут надо понимать что различные секреты для дефеток для про ответов надо использовать чтобы не было возможности секретами SD в залогиниться там сборка попасть на пруд разделение также сегментация про которую уже не раз упоминали сборка должна всегда возвращаться в эталонная чистое состояние чтобы даже если какие-то артефакты после сборки остались они не могли навредить следующим сборкам ну и соответственно доступ только туда куда надо и блокировать на самом деле лучше блокировать доступ в интернет а использовать какой-то свой локальный хранилище и оттуда уже потягивать Мы можем использовать там прокси жестко какие-то настроены правилами куда можно и еще раз повторюсь сборочная инфраструктура для дев и сборы должна быть раздельной что-то у вас пошло Придя в сборках не так что-то там не то добавило даже если через все ваши проверки и контроля что-то получилось про тянуть и там что-то бахнуло это никак не повлияет на продуктовую сборку и выкупку Production того что у вас в продукте ну и соответственно выполняя все эти рекомендации получаем что разработчик работает только в той среде которая ему доступна все более там важные части в том числе про то доступа они доступа у него изъят соответственно данные не сохраняются после сборки и все всегда возвращается в базовое состояние базовая безопасная чистое состояние Ну что не приводит к компрометации по сети Да просто уже много раз вспоминали Давайте Немного поговорим о секретных мы чуть-чуть затрагивали как раз эту тему ранее То есть например мы можем добавить переменные например вот здесь у нас есть Nexus стоки на боец стоки они добавлены в переменные гитлаба и собственно пример Как можно попробовать эти токены вывести в консоль Что может сделать такой разработчик Я понятно что может получить какие-то доступы к внутренней инфраструктуре что-то там попробовать развернуть своего опыта был например Был случай когда человек развернул майнеры в инфраструктуре он посчитал что ему интереснее чем работать на работе это могут быть какие-то там доступы к продакшнему к Продакшен каким-то еще сервером который могут аффектить собственно двигаемся Секреты могут быть не только там в переменных гитлаба нас могут быть и в коде секрет они могут быть и там фильм чартах нас могут быть в слоях контейнеры секретом блогах и этом все может привести к утечке секретов также ещё к этому привозят небезопасная передача секретов да либо там вот учётных данных консоль в открытом виде и когда эти данные там кто-то может подсмотреть или перехватить Ну да на самом деле вот много повторяющейся информации но стоит отметить что это все на самом деле разная вектора Атак и тут все стоит применять комплексно на самом деле это очень важный подход потому что любая дыра безопасности это уже как бы небезопасно Ну и Подводя итог собственно управлять секретами необходимо важно нужно настроить грамотный процесс нужно проводить периодический поиск секретов в коде чтобы даже если там что-то хранится мы это смогли вовремя задетектить и убрать используем протект бренча чтобы разграничивать доступ правильно хранилище секретов если это необходимо Где хранятся все нужные нам ключи все там ключи для наших билдов там подобное и доступ соответственно к секретам нужно убирать и сами секреты удалять когда они уже не нужны когда мы уже например они работаем в этой ветке или не используем какие-то сервисы которые внутри были Ну да и в результате получаем что у нас нет секретов репозитории вообще в принципе отсутствует как бы даже в кодовых файлах нельзя дропнуть креды разработчик не может написать какую-то команду чтобы вывести что-то себе из репозитории которую мы контролим доступ к секретам по умолчанию имеет узкий круг лиц только админы которым этот доступ реально необходим ну и соответственно мы всё удаляем всё Чистим всё контролируем в результате получаем что у нас вектора атаки через утечку кредов Ну если он не исчезает то хотя бы вероятность такой атаки намного сильно снижена и расскажу небольшой случай жизни Значит один раз я подкрутил там как раз сканера поиска секретов и нахожу что в комете пятилетней давности есть какой-то ключ iderasa Я такой Ну ладно интересно подумал что за 5 лет наверное может где-то только когда в самом начале было у ребят там в спешке развертывались откатывались на тот коммит вытаскивают ID раз нахожу Файлик диплоид Shell такой нахожу Тачку на какую депоились и аккаунт беру этот ключик аккаунт был тестер и подключаюсь значит тестер на эту тачку и что я вижу а это демон стенд фирмы там висит там сотни контейнеров всё такое А я подумал Ну типа А что как надо попробовать повысить привилегия э Я использовал пароль стейстер и он подошёл Единственное что этот учётка тестера она не была в судорос то есть Прямо получить Root права без каких-то дополнительных шаманств я не сумел Но для удобства отладки это тестер был добавлен в группу докер А там я уже мог делать всё что захочу хорошо продолжим дальше уже нашу историю значит такой разработчик может попробовать использовать различные ошибки конфигурации данный из вашего плана будут утекать тут стоит что отметить что не все тузы которые вы используете они вот прям из коробки безопасно то есть где-то требуется какие-то дополнительные там я не знаю То же самое Тейл с настроить где ты какие-то ещё настройки выстроить как-то захарденеть соответственно А все используемые тулзы они могут быть небезопасны по умолчанию вот по опять же здесь могут быть какие-то атаки там типа Defense и confusion про них чуть-чуть ранее говорили про гигиены секреты Мы тоже поговорили а очень важно отсутствие патчи безопасности никто не будет искать в вашем коде там какие-то зирады там долбить его и что-то ещё когда у вас этот год развёрнут на дырявый инфраструктуре и достаточно просто там каким-то банально льдшем сканером найти какое-то яшку у вас зайти найти на гитхабе пруфы в конце эксплуатирующие этот целый яшку и просто бахнуть самую там инфраструктуру никто не будет прямо вот именно ваш код ковырять поэтому очень важно э и устанавливать патчи безопасности для всех там тусов инфраструктуры и всё что вы используете Ну естественно это какая-нибудь ограниченная возможность доступа к внутренним сервисам компании Ну да и как бы это не Было очевидно нужно опять-таки все это контролировать проводить аудит настроек безопасности контролировать те настройки которые у нас автоматически применяются проводите ревью безопасности этих настроек review файлов иак и всех конфигурационных файлов в том числе открыт или закрыты нужные порты и все тому подобное соответственно тут стоит отметить важный принцип это securityfold когда мы все что у нас потом будет использовано уже изначально проверили и все что автоматически раскатывается но по умолчанию уже безопасно от reviewing и отрубнуто там админом безопасности например соответственно накатаем релевантные патчи незабываем об этом своевременное исправление ошибок это очень важно когда дыра появляется это очень плохо и минимально необходимость его и доступ уже вот несколько раз упоминалось важно все-таки сегментировать на уровне подсетей и сеть чтобы даже если какие-то ошибки были было некое такое шелонированное воздействие шаланированная защита была Ну соответственно Подводя вот выводы данному пункту мы получаем что настрою все правильно и применив все рекомендации у нас конфигурация по умолчанию безопасно любые изменения конфигурации они отслеживаются контролируются проверяются всем секрете патчи накатывается в рантами всё хорошо и компрометация какой-то отдельный надо отдельного билда или отдельный там машины не приведёт к продвижению дальнейшему по сети потому что мы всё заизолировали засегментировали а теперь интеграция собственно Давайте поговорим о различных возможных интеграциях да Мы все знаем что разработчики любят Да и мы сами любим Когда там к вашему менеджеру подключены различные там удобные боты которые тебе там в тележке это различные приложения которые упрощает там ботики для с лака там автомерджи всё такое собственно здесь стоят новые определённая опасность мы можем забыть про интеграции Да соответственно Мы можем потерять вообще в принципе контроль над интеграциями Да когда мы не знаем вообще что подключено что подцеплено как это управляется В каком вообще состоянии у нас нет контроля Да вот на эти раздаваемые токены доступа у нас может произойти отзыв прав без отзывы интеграции То есть когда человек например уволен его аккаунтом менеджере заблочен Ну осталось какое-то его приложение А что если у него вообще стырили ноутбук а там в ботике торчит это токен они вытащили этот токен и пожалуйста вся вся весь ваш кот Ну типа украдут это печально А что если ещё допишут что что-то Ну чтобы такого не происходило надо всё-таки давать минимальные привилегии тем сотрудникам и тем э-э сервисам которые мы используем соответственно чтобы это выполнять нужно грамотно и полномасштабная реализовать все процессы выдачи контроля аудита отзывы прав чтобы не было вот ситуации когда ключи например остаются а учёт например лучше всего посадить актёр из тетрадочкой которые каждый входящий исходящую интеграцию будет регистрировать ну и соответственно доступа которые у интеграции есть они минимальны необходимы это вот наверно базовый принцип который стоит придерживаться всегда когда мы работаем с доступами с токенами всякими соответственно все контролируется и происходит отзыв Когда уже это необходимо убрать и важно отметить что Отзыв должен не только четкий но еще и саму интеграцию которую мы используем чтобы все токи на которые использовали все затирались все так немножко коснёмся сплочей Я знаю что эту тему можно вообще прям на отдельный доклад вносить все такое Но что если то есть наша сборочная инфраструктура Да какие-то наш билды бил процесса они могут в них возможно какие-то инъекции добавление вредоносного кода причем тут могут быть несколько разные события например мы можем разрабатывать библиотеки которые сами же потом используем продукте и здесь очень важно помнить я такой тоже один раз встречал жизни что ребята очень контролировали весь Исходный код Что попадает в их продукт А вот где они сами же собирали библиотеки Какой код пушился в эту библиотеке на него вообще типа вот библиотека все хорошо вот собственно через библиотеку можно было пролезть либо например вы можете быть поставщиком каких-то вот решений или библиотек вместе такой библиотека вредоносный код попадёт в продукты других компаний впоследствии там возможно к их ну и соответственно чтобы таких проблем не было Ну или хотя бы снизить вероятность с оплачейном можно просто реализовать некоторые такие простые базовые методы это проверка целостности артефактов которые мы загружаем это подпись кода подписи артефактов соответственно проверка его своевременная проверка подписи чтобы невозможно было подменить например ее в процессе соответственно подписях сторонних артефактов в нашем локальном хранилище которое используется как проектирующий репозиторий например чтобы даже туда если загрузили что-то вредоносное сразу это можно было отследить и оттуда уже убрать чтобы не было больше распространения по нашим проектам соответственно реализовав эти шаги мы получим что у нас контролируется все артефакты все зависимости которые мы используем Push разрешен доверенным лицам Ну и мы все-таки отметим что контроллер артефактов которые вот раздел sect 3 также стоит применять и здесь много одинаковых скажем так положений но они немного по сути отличаются теперь поговорим про ошибки логирования у нас могут быть такие ситуации когда например отсутствуется алертинг по каким-то критически важным событиям и мы могли бы среагировать на это что-то сделать остановить какой-то либо внутреннее продвижение либо еще что-то но не сделали вообще ничего потому что оно отсутствует также очень важно это отсутствие карты инструментов что мы используем и отсутствие анализа событий и оповещения здесь особое внимание Я хотел бы уделить там например вот к примеру карты инструментов Да создание плана то есть мы вся CD используем множество различных инструментов там для проверок безопасности для каких-то тестирований а для сборок ещё чего-то скорее всего есть инструменты тоже имеют какие-то свои выдачи нам нужно понимать что вообще у нас находится внутри pipeline что-то торчит Когда мы это понимаем мы уже смотрим Что вообще можно собирать с этих инструментов И как-то это куда-то затаскивать ну например Ну и да правильно что мы должны мониторить все что у нас происходит И для этого возможно использовать ем Но даже если его нет можно сделать какой-то там собственный аналог для мониторинга всех логов которые у нас есть соответственно логируем мониторим анализируем если есть какие-то аномалии вызываем нам на помощь админы помогаторы которые все это исправит ну и соответственно если какие-то инциденты реально происходят реально какая-то непонятная активность то уже вплоть до блокирования идем первично сначала все-таки надо рассмотреть что происходит а потом уже обрубать связи соответственно состояние всех систем состояние всех сервисов действий пользователей которые работают с этими сервисами это все отслеживается контролируется и анализируется в том числе и автоматизированные админом которые потом отдельно инциденты разбирает и соответственно мы можем использовать те данные которые у нас получены в результате сбора логов для кастомизации наших процессов для отслеживания тех событий которые мы упустили что они рассмотрели может забыли какие-то учетки пофиксить которые там до этого проверяли и тому подобное вообще логи это важная штука которая направлена то чтобы Даже если мы что-то забыли Это всё найти Да и собственно в совокупности всей эти методы они не исчерпывающие но они позволяют уже обеспечить какой-то приемлемый уровень безопасности нашего ся и сиди собственно Спасибо за внимание там по QR коду можно проголосовать за наш доклад обязательно голосуйте это Стимул готовить новые выступления для вас справа внизу Наш канал обязательно Подписывайтесь там выкладываем выступление там опубликуем какие-то интересные важные моменты ссылка на нашу презентацию где всю информацию можно посмотреть и все ссылки приведены вот ну собственно непосредственно наши телеграммы также еще хочу отметить за лучший вопрос у нас будет Аж три подарка так что ждём много вопросов Спасибо Спасибо Добрый день спасибо за доград меня зовут Василий я Сергей инженер У меня два вопроса Первый это что в концепции Zero Trust делать с людьми которые по умолчанию имеют в Минске доступ везде то есть людьми которые это строили Хороший вопрос как я уже сказал таких человек должен таких людей должно быть несколько хорошо что их несколько как их контролировать Например я там в компании в которой работаешь являюсь человеком который имеет доступ ко всему Продакшен ко всем базам и так далее Потому что я их администрирую непосредственно и получается что да у нас есть безопасность которая отдельный отдел который там собирает опять же логи там cm вот это всё это всё здорово Хорошо но мне в принципе ничего особо не мешает пойти куда-нибудь на продакшн и что-нибудь перенаправить и соответственно там покрасить например базу согласен тут есть несколько таких моментов первое где-то если это позволяет там Рыбак система гранулировать доступ Ну то есть человек может до каких-то своих Я не знаю там настроек там доступа добраться до остальных не может Вот это первый вариант второй вариант опять же нужно второй момент нужно понимать что сам например создатель всей этой системы то есть с какого-то вашего себя CD там гидла бы овнер да то есть кто умеет доступ к инфраструктуре Это должен быть некий скажем так доверенный человек либо должны быть установлены какие-то контроли которые позволяют проверить что делал он все правильно обычно это выглядит так когда есть несколько администраторов один такой смотрит Так что это там второй где-то палкой там сзади нашего продукта ковыряется что-то пристраивает наверное что-то пошло не так ну то есть отталкиваемся просто от того что есть несколько людей которые друг за другом должны приглядывать Но это у нас не страхует от того что они могут говорить Да однозначно у нас всегда есть точка отказа она абсолютно всегда есть хорошо Спасибо за ответ и второй вопрос не было ничего про то есть ddr приложений влоги собственно логи мы все собираем и все показываем разработчикам и разработчики иногда по ошибке иногда умышленно могут например залогировать переменное окружение продакшена которые мне доступны в рамках pipline Вот это не то чтобы вопрос скорее дополнения заблокировать перемен на окружение Production в рамках пайплайна да Но мы же доставляем логи которые это и стыдаут контейнера там летит например stdr мы их куда-то вставляем власти клоки неважно И соответственно понятно что есть уровень защиты в виде удобнее которые следят за тем чтобы не логировалось ничего лишнего но тем не менее там тоже бывают ошибки И влоги периодически могут провисать например пароли согласен просто в рамках данного доклада не рассматривалось и как мне кажется это не самый честная проблема вообще мне кажется прологе можно сделать Там отдельный большой доклад и все что может туда лететь тут Наверное уже ковыряться с логами нужно У вас должны быть некие контрольные налоги что у вас влоги не утекают там те же самые персональные данные а такой бывает у вас влоги не утекают какие-то там используемые секреты в том числе логик корректно взаимодействует с системой Ну друзья Мне кажется это отличная тема для следующего года будем ждать доклад либо от вас либо попрощаюсь Да спасибо за доклад вопрос второй предположим что я devops который работает компании где безопасников нет и пайплайны сиди живут по принципу дикого Запада с чего начать потому что все эти мероприятия которые вы перечислили их имплементация может занять на самом деле пару лет с чего все-таки мне начать не всегда пару лет как говорил самое первое С чего нужно начать это разобраться как раз в этом Гете то есть понять Вообще у кого какие доступы есть какие права доступа к репозитории Какие права Вот однозначно начинается с этого всё не имеет значения Когда у вас вот помойка грубо говоря а нет спасибо Да привет Спасибо за доклад Вопрос такой как понять Какие меры нужны какие не нужны чтобы разработка не встала Чтобы мы по 2 недели не катили каждое изменение наоборот на самом деле нужно всё просто последовательно это делать Может мы не ловим и Джой это всё слишком дорого но долга же какая-то Метрика быть или мы даже в стартап который делает статистику с котиками внедряем вообще всё что можно за миллионы рублей Давай я немножко накину А тут нужно исходить из того что мы строили наш доклад на концепции что у нас существует внутренний нарушитель то есть вот такой какой-то нерадивый разработчик который будет осуществлять атаки допустим вы дружные стартап там из четырех человек вы можете Ну там быстро дойти до друга и того три штуки которые вот из того что вы описали надо внедрять асапа Остальное Чуть позже я понял минимальное привилегии - это однозначно контроль самих потоков исполнения настройки по умолчанию настройки по умолчанию Спасибо у нас пока идет следующего вопрос Я всем напоминаю Не забывайте голосовать про доклад чтобы ребят была мотивация QR на стене и Следующий вопрос да ребят Спасибо за доклад чудесно на самом деле мне кажется полезной несмотря на такой немного развлекательный контент очень системный Хочу задать Следующий вопрос Вы много говорили про выстраивание процессов настройку разграничения прав доступа понижение привилегий Ну и так далее В основном про настройку собственно систему А вот такой вопрос используете ли вы какие-то специализированные решения и конкретно Какие для сканирования например собираемых образов на разных этапах-плайнах на конфигурационные файлов и собственно самой контейнер runtime-системы для выявления потенциальных уязвимостей Да каких-то секретов низ конфигурации и так далее и Если да то какие Спасибо Да конечно используем Ну наверное если брать там если мы берем с контейнерами три докли однозначно будет если брать анализ библиотек Black такси чек гимназия можно вообще кастомный парсер написать который будет под своей базе смотреть и на все ваши образы которые есть выдавать собственный результат такие-то уязвимости такие такие патчи есть тут я немножко это именно безопасность самого себя не отменяет остальные проверки это не означает что мы можем выкинуть там все сканеры какие-то там процесс тестирования боится То есть это чисто как обеспечить вот консистентность самого вашего процесса сборки и доставки Да я понимаю и больше как бы звучит так что много каких-то различных в том числе Open Source улов используется а вот есть коммерческие решения Ну я назову как бы несколько иностранных они все равно фактически с рынка ушли типа ква-клаусе curity не вектор и так далее которые позволяют как раз комплексно защитить Например я не знаю проверить регистратор под управлением губернатис и проверить образы на этапе сессии пайп line в общем всё это всё это вместе то есть на практике у себя не сталкивались друзьями это классная тема для дискуссии за детей Спасибо и у нас вопрос Да я тут за доклад хочу немножко порядке очереди хочу просто небольшой добавочку сделать много говорилось в разных пунктах контролях доступах и мы вот например Себя в компании решили что мы как минимум в гитлабе у нас гитаб используется сделаем такую штуку как доступ и только групповые то есть нет никаких личных доступов есть доступа только в группах А в группах уже минимальные права урезания там привилегии все такое доступы к коду имеют только определенные группы соответственно когда людей добавляют удаляют из группы там все автоматически это дело происходит то же самое можно делать сразу один момент допустим у нас есть группа разработчики вы пишете код занимаетесь вам нужно добавить туда или куда деваться чтобы он помог вам собрать пайплайн или посмотрел что-то временно добавляется Да временно точку доступа одна тот кто управляет доступами в группу он управляется соответственно Неважно как сделать опять же тут та же самая проблема говорит вы добавили на время вы должны через время человека убрать тоже это позволяет сделать он тоже дает время там с steamate Да нет Да я понимаю я просто имею ввиду что мы здесь хотели обратить внимание на то что не нужно ставить бессрочно если даже и по каким-то ситуациям в спешке поставили пожалуйста проводите периодически аудит чтобы посмотреть небольшая штука которая чуть-чуть удобства добавляет нам именно групповой доступ второй момент говорилось о том что есть некоторые побеги на хостевой системы То есть когда мы развернули что-то в проде у нас Я знаю один способ как минимум это когда в докер-контейнере мы можем срут правами указательств пользователя Ну там что-то запустить этот же пользователь будет иметь Root права и на хвостовые машине может быть ещё какие-то есть способы там на самом деле есть некий это наверное лучше ссылками отдам объёмная Тема тут стоит на самом деле либо пообщаться отдельно либо просто отдельно доклад про Спасибо коллеги у нас вопрос ли вы эти классные штуки вернуть обратно нет ничего такого нет интервью сели но наверное мы задумаемся об этом после самого на следующий вопрос Да я тут левее интересно Давайте в сторону тогда Святослав Спасибо большое за доклад очень интересная разработчик в общем-то с точки зрения вот распределения прав всего такого все понятно и на мой взгляд все очень сильно упирается Вот как раз в ту штуку про которую говорили исключение шаринга аккаунтов как будто бы в принципе все распределение об это немножко разбивается есть вообще какие-то не знаю технические способы кроме вот реально административных мол ой-ой-ой нельзя так делать способы управлять тем чтобы исключать непосредственно шаринг не давать пароль конкретному лицу а использовать какие-то хранилище пароли когда он может залогиниться под своей учеткой и скопировать нужный пароль соответственно будет две точки ему нужно будет отдать либо свой либо залогиниться самому и скопировать И отправить А это уже можно будет обнаружить еще момент вы можете такие вещи например вот как у ЦСКА и Коннект был что Принт определённых Я имею состояние внутренней системы Вы можете подключиться естественно это могут быть какие-то там не экспортируемые сертификаты вашей системе по которому вас будет происходить есть там такие приколюхи типа привязки к железу вот когда соединение создаёте у вас там есть вот да и у вас там ну типа излишних желез там на самом деле Саш В итоге можно поставить чтобы вот жестко было задано на этом вот все ваши процессы скоро фирме умрут потому что никто не сможет никуда коннектиться но эта штука есть собственно если Корректно это вот мониторить можно Что с этим придумать на самом деле понял Спасибо И у нас последний вопрос Спасибо за доклад Все было очень интересно но вы все рассказывали только Как не надо делать а что же делать если все-таки все сломали украли пароли залезли там с компрометировали данные Что же делать переписывать откатывать кометы менять все пароли если это уже массово произошло сначала надо локализовать где произошла у тебя какие-нибудь инструменты как обнаружить что поздно узнали случайно узнали допустим как обычно бывает я понял смотреть тут есть несколько моментов Если ваши фирме есть квалифицированные специалисты которые могут заняться респондзом данного инцидента привлекаются они собственно нескольких таких инцидентов которые происходили привлекали меня мы смотрели даже когда там какие-то Забытый доступ в Гид что-то еще есть специализированные фирмы которые в принципе занимаются расследованием таких вещей Ну я их не буду перечислять но вы можете загуглить Там как бы без рекламы Там те же самые игроки на рынке что и всегда собственно можете привлечь такого специалиста далее Тут нужно уже отталкиваться от того что произошло э первое То есть даже вот взять какие-то моменты с протестварию Да когда протестуэр там заливает какой-то пакет это же быстро обнаруживается что там не предшествовал коммит или с какого коммита была собрана Эта библиотека либо этот продукт А тут вам нужно оценить вам что-то дописали или у вас чисто забрали данные естественно там сменить все ключи там по максимуму сбросить все доступы и выдать там чтобы все поменяли пароли либо там сменить серты То есть зависит от того сколько и Что вообще они вас сделали внутри в инфраструктуре тут какого-то универсального Ответа нет то есть Серебряной пули Нет но я наверное про меня рассылаю всем письмами что всё плохо да Ну а как вы хотели тут уже как бы всё я Ну это опять же моё мнение То есть если бы по такое бы произошло у меня естественно я бы всех бы уведовал чтобы дальше не скалируется ситуация а как сейчас себя управлять Спасибо за вопрос и теперь наверное к вам самый интересный выберите три лучших вопроса Два подарка от спикеровка раз человек будет так один первый второй последний выбирается второй нас кто второй вопрос задал я на самом деле не запомнил так ярко светит да Ну возможно просто здесь он уже всё да второй и третий последний последний всем Спасибо Оставайтесь с нами у нас будет следующий"
}