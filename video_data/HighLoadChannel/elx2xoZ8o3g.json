{
  "video_id": "elx2xoZ8o3g",
  "channel": "HighLoadChannel",
  "title": "Используй Силу, Люк: Single Pane of Glass в мире SRE / Кирилл Борисов (VK, VK Реклама)",
  "views": 214,
  "duration": 2860,
  "published": "2024-10-29T03:07:37-07:00",
  "text": "и Я хочу пригласить на сцену нашего следующего спикера Это Кирилл Борисов из ВК реклама совершенно с невероятной Темой Да вот это не буду читать я хочу послушать как это будет реализовано Итак прошу Всем привет давайте нанм сразу вообще приходя в любой проект любую компанию кой ра Да я иногда сталкивался иногда сам создавал проблему огромного количества дашбордов вот Попробуйте ответить на вопрос Вообще вспомните пробовать ситуацию Когда вы там в фане пытаетесь что-то искать какой-нибудь дашборд пишете например какой-нибудь кликхаус да И вам выпадает там огромный список дашбордов которые кто-то там за вас на создавал это может быть какие-то там кастомные дашборды для кого-то кто-то для себя делал для кого-то инцидента это могут быть борды которые создавались какими-то другими специалистами и часто бывает что в целом на этих дашборда Либо они там половина нерабочие либо там нет на них чего-то полезного Вот и как правило вот такое количество дашбордов оно создаёт ряд проблем во-первых Это какую-то информационную перегрузку потерю фокуса сложность восприятия А самое главное что затруднение э каких-то исследований инцидентов А и Попробуйте себе честно ответить на вопрос вообще по смотря на ваш дашборд вы можете понять работает ваша система или нет Если нет то вы выбрали правильный доклад Я надеюсь что вам расскажу как с делать этот процесс более более удобным и не таким больным В общем давайте пока перелистывается слайд Давайте познакомимся Меня зовут Борисов Кирилл Я работаю в компании ВК и в проекте ВК реклама Я пришёл сегодня не один со мной моих три друга один из них орущий пингвин который кричит когда что-то ломается на проде а и вообще я начинал Достаточно давно в it в целом там весь свой наверное профессиональный путь Я работаю в it я занимался там был просто инженером строил был инженером по ведению потом это стало девопсом потом это стало сре каким-то образом да то есть прошёл Такой путь немножко работали дом группы сопровождения и в целом Я плюс-минус как это знаю как больно чинить что-то на проде ночью когда тебя будет в 2 часа и как важно делать правильные инструменты для того чтобы анализировать такие проблемы Вот ну и немножко преподаю в компании слёрм постараюсь ввести какое-то образование в массы и так далее А вообще за всё время работы Накопилось огромное количество интересных сообщений в чате они могут выглядеть вообще по-разному это могут быть какие-то вопросы например А есть ли проблема это может быть вопрос там а ели сегодня с проблемой с серве Или например какие-то предсказания вообще приходит кто-то в чатике вырывается предсказанием А И вообще я думаю что сервис X работает сегодня Медленно или я думаю что у сервиса X вообще в последнее время возникли какие-то проблемы Вот как мы можем ответить на эти вопросы Ну вот в моменте Да чаще всего мы идём на какие-то дашборды в фане Да смотрим графики смотрим тренды и там пытаемся найти ответ на свой вопрос вообще А Как появляются дашборды станда наверно для многих опять же Это мой стандартный Фло был изначально мы берм какой-нибудь дабор с g.com это может быть дашборд инфраструктурный дашборд каких-то сервисов мы его там допили под себя удаляем лишние графики Возможно там с какими-то инцидентами мы его там обогащаем да то есть он становится огромным и в целом с точки зрения там мониторинга какого-то маленького компонента нашей инфраструктуры или наших сервисов это вполне себе ой потому что в целом мы покрываем там 7 80% тех запросов которые нам нужны да от мониторинга Но что вообще плохого в таком подходе по моему мнению Ну во-первых это техническо Ну то есть на таких дашборда чаще всего мы видим какую-то техническую составляющую а не пользовательский опыт То есть это стандартно там типа реквесты ленси там не знаю топики в кавка там лаги и так далее И вот такие дашборды достаточно трудно воспринимаются человеком который не погружён в проект Наш и тут вы можете меня спросить вообще зачем человеку не погружённого в проект с на наши дашборды на самом деле ответ очень простой мы все живём в мире Где наши сервисы они не живут в каком-то вакууме да наши сервисы взаимодействуют с другими компонентами мы ходим каким-то другим сервисам и нам в какой-то момент важно понимать не отвалилась ли какая-то зависимость у нашего сервиса там когда мы зависим от сервиса другой команды и мы хотим тоже это как-то видеть и как-то понимать Да что там происходит и Давайте ещё попробуем сделать небольшой шаг назад и посмотрим вообще кто смотрит наши дашборды Ну очевидно что это команда эксплуатации L2 которая занимается поддержкой нашего продакшена которая там бдит либо бдит там в 247 либо как-то on demand реагируют наши проблемы То есть это люди которые менее погружены в проект чем команда разработки которая пилит Этот проект это первое второе - это команда разработки команд разработки как команды разработки текущего проекта так и внешние команды разработки от которых мы так или иначе зависим или которые зависят от нас менеджеры менеджеры очень любят смотреть красивые графики понимать вообще видеть там пытаться найти там какую-то проблему или не найти там какую-то проблему Вот и пользователи Здесь э опять же вы можете мне там смело возразить Какие пользователи вообще что я тут несу а на самом деле пользователи могут быть не только внешние но и внутренние пользователи опять же пользователи наших опишет пользователи каких-то внутренних наших сервисов И вообще а история с вот такой наблюдаемой когда люди могут посмотреть на то как наш проект вообще работает и мы мы открыты к людям и показываем такую статистику она очень классная мне кажется и поэтому пользователи тоже очень важны в этом плане Так чего же нам хочется вот что мы хотим вообще получить от дашбордов Ну чего мы хотим мы на самом деле хотим некий такой единый дашборд сервисов получить их здоровье он должен быть не только красивый Понятное дело что он должен быть ещё и понятный и понятный не только людям которые делают этот дашборд но и людям которые потребляют как каким-то образом наши сервисы и хотят узнать вообще работает наш проект или нет и перед тем как мы двинемся к какому-то там проектированию исследованию Я предлагаю вообще посмотреть не не стараться придумать велосипед а посмотреть на какие-то другие сферы нашей деятельности жизнедеятельности которые могут нам помочь э там в создании в проектировании такого дашборда А Попробуйте угадать Откуда эта картинка Я думаю не сложно догадаться что это самолёт Да огромное количество графиков э дашбордов Ничего непонятно но очень интересно люди учатся 5-6 лет вы мне можете сказать на самом деле моё внимание здесь Ну вообще это абус А320 это его бортовая панель я обратил своё внимание Вот на этот маленький прибор это называется основной пилотажный дисплей Давайте немножко посмотрим на него поближе я расскажу почему вообще я на него заострил внимание Почему мне интересен стал именно этот прибор посмотрим его поближе вот этот маленький прибор который находится фактически перед глазами пилота и этот прибор который показывает причём он показывает огромное количество информации он во-первых хорош компактностью очень много информации на нём расположено Они находятся в таком компактном виде что Пилот смотря только на один прибор фактически может принять решение там о том вообще как себя чувствует самолёт в воздухе какой у него угол крена какой тангаж у него какая высота какая скорость если например посмотреть вот на конкретный пример то вот эта вот полосочка показывает скорость но не просто скорость То есть во-первых это приборная скорость текущая Да она может показывать скорость которая будет через 10 секунд она может показывать максимально допустимую скорость минимальную допустимую скорость потом она может там показывать на индикаторах там вот там буковка F есть я не выделил К сожалению вот там там маленькая это вот когда скорость на которой можно убрать в принципе как бы шасси да то есть а то есть для понимания на этом приборе сосредоточено вообще огромное количество информации Она расположена очень компактно кроме скорости здесь ещё э здесь ещё высота там полная полная высота его и вот Центральный прибор - это там уровень крена тангажа сваливания Вот то всё что нужно в одном маленьком компактном месте запомним идею именно компактности не то что там прибор Понятное дело что это прибор очень очень сложно люди учатся долго на него налёт летают там на самолётах по 10 по 20.000 часов но в целом мы берём отсюда только идею компактности того как это всё расположено и прийдём ещё к одной схеме Понятное дело что вот этот такой основной пилотажный дисплей он не единственный и там ещё мы видели огромное количество различных графиков и вот как нам получить доступ к какой-то дополнительной информации вот к нашим вот к текущим графикам и здесь Я бы хотел обратить своё внимание обратил своё внимание на процесс того как мы вообще ходим в больницу Например у нас заболела левая пятка что мы делаем Ну мы идём к тера очевидно У нас какая-то есть боль мы её чувствуем Что мы делаем мы с вами идём к терапевту что нам делает терапевт Ну не знаю Подорожник приложил масть помазал там не знаю как-то попытался продиагностировать и Возможно проблема прошла возможно нам уже не так больно но если болит болеть продолжает нас нас терапевт направляет к какому-то специальному врачу Будь это хирург аллерголог дерматолог неважно там в зависимости от результата наши анализов То есть это некий второй уровень исследования нашей проблемы собственно запоминаем это и что у нас получается В итоге если мы попробуем сложить вот идею основного пилотажного дисплея компактности и вот этот процесс который здесь у нас есть по поводу там тестирования тех болей которые у нас есть в организме мы получаем некую еди единый дашборд Собственно как он может выглядеть как он выглядит у нас Верхне уровне у нас есть первый уровень первый уровень - это уровень сервисов на котором у нас нет ничего кроме Фора Окей или не окей с различными сервисами дальше если мы понимаем что есть проблема с каким-то сервисом D мы можем провалиться на уровень ниже на уровень ниже мы получаем уже более детальные графики нашего сервиса это может быть latency это может быть for Golden Signal это может быть use это может быть Red неважно в нашем случае там мы используем for Golden Signal lency Traffic Error saturation это могут быть какие-то кастомные метрики там зависимых компонентов этого сервиса и так далее если уже эти графики нам не помогают то есть мы вроде бы видим что что по графикам у нас всё более-менее ровно но проблема ещё существует мы можем обратиться на уровень ниже и посмотреть что у нас на уровне инфраструктуры происходит там посмотреть потребление рама цпу Нетворк диска возможно вообще в целом наши Хосты крутится на физических машинах либо там можем метрики Куба посмотреть и так далее То есть вот идея такого Проваливай в дашборды Для получения более точной диагностической информации Какие преимущества у такого подхода есть Ну очевидно это централизованный мониторинг собственно с помощью такой панели мы можем отследить работоспособность производителя наших компонентов Да доступность и также Вот такое централизованное представление оно улучшает вообще ускоряет устранение каких-то неполадок на наших сервисах благодаря вот такому объединению Ну улучшенная видимость - это вот опять же да мы объединяем огромное количество данных из источников и мы можем быстро выявлять какие-то закономерности Когда у нас что-то там не работает эффективное сотрудничество то на самом деле на чём должно держаться наше it - это коммуникация Да мы в целом должны уметь общаться с другими командами другими коллегами и делать это эффективно и вот как раз этот дашборд примерно про то и есть да то есть мы не даём командам внешним какие-то кучу каких-то непонятных графиков Возможно они красивые но в них ничего непонятно мы даём вот такой единый дашборд где они могут посмотреть состояние сервисов На текущий момент без там верхнеуровневый да там здоровы они или нездоровы вот и оптимизация поиска проблем но опять же да наличие вот такой всей необходимой информации в одном месте позволяет нам достаточно быстро находить там проблему с каким-то сервисом вот ну и опять же да оптимизирует наше время там устранения инцидентов собственно определились примерно с тем что мы хотим что нужно нужен план сказать не сделать нужно составить какой-то план собственно получились вот такие несколько пунктов И начнём мы с определения целей и показателей но как понять Вообще как понять что наш сервис работает Ну мы уже с вами ранее говорили да что наш сервисы не живут в вакууме и они как-то совместно общаются друг с другом Да и выполняю ту и вот достаточно ли например сказать что например наша главная страница открывается и на этом типа всё хорошо Конечно нет но как мы с вами поступим в этом плане собственно здесь идея в том что мы будем использовать с вами некое такое понятие которое называется критический пользовательский путь это поток или частичный поток который через который проходит наш клиент в нашем бизнесе в нашем продукте да и этот поток даёт наибольшую ценность для нашего бизнеса ценности Бывают там финансовые Там репутационные и так далее То есть мы не всегда только на финансовые ценности потому что чаще всего да И иногда скажем Да так чаще всего репутационные риски они превышают потому что там не знаю появление статье на какой-нибудь там РБК о том что какая какой-то проект лежит Я не думаю что кому-то мало приятно будет Вот соответственно если этот путь не работает то значит и пользователи значит и мы не доставляем ценность нашим пользователям чи соответственно нужно на эту проблему подсвечивать а Давайте попробуем разобраться на каком-нибудь простом примере с тем вообще как Как правильно определять такие Ну критические пользовательские пути на примере там не знаю интернет-магазина я думаю что мы всеми ими пользуемся и примерно представляем да Какие действия мы совершаем там в интернет-магазине чтобы там купить товар Да например мы можем выделить у такого интернет-магазина там критический пользовательский путь - это оформление заказов в магазине это добавление товаров в корзину и просмотр продуктов и здесь важно что все эти три критических пользовательских пути они имеют разную ценность они имеют разный вес Почему Потому что Например если вы как клиент пришли на какой-то там маркетплейс к примеру и не можете просматривать продукты Ну в целом Наверное вы просто пойдёте в следующий маркетплейс или вернётесь там чуть попозже страничку обновить или ещё что-то в этом роде Если у вас есть товары в корзине Э вы их можете по-прежнему покупать но при этом если у вас не работает там просмотр вообще в целых продуктов вас Ну как бы мало это волнует вы уже выбрали Что купить но вот если вы например хотите уже купить продукт он у вас лежит в корзине и вы его не можете купить то вот здесь как бы это вот тот тот пользователь путь который имеет самую важную критическую особенность потому что здесь на этом этапе мы уже перестаём как бы зарабатывать мы уже начинаем там терять да прибыль и этот критический путь он выделяется на фоне всех остальных вот немножко спустимся как это с теории на небольшую практику про наш пример собственно я как пользователь хочу видеть быструю статистику по своим запущенным компаниям вот такой мы сегодня с вами бизнес сценарий рассмотрим критический пользовательский путь для нашего мониторинга и что мы должны сделать первое что должны сделать это мы должны разбить вот этот вот наш пользовательский путь который мы описали на какие-то технические составляющие компоненты которые так или иначе участвуют в процессе вот показа статистики И здесь как бы да вот у нас есть пользователь он запрашивает стати Ну то есть он обращается из личного кабинета там открывает вкладок запрашивается статистика запрос уходит в сервис статистики дальше из сервиса статистики запрос уходит в кэш коллектор тот идёт в редис смотрит если там статистика Да если статистики нет он идёт в кликхаус А как данные попадает в кликхаус соответственно есть некий сервис продюсер который данные пишет в кафку А сервис коню он соответственно читает из Кафки и перекладывает в кликхаус статистику актуальную по компаниям соответственно получается что в целом как бы такая маленькая маленькое предложение про там Я хочу просматривать статистику по запущенным компаниям превращается Вот в такой набор компонентов и сервисов которые стоят за этим пользовательским путём соответственно мы их выделяем это продюсер кавка ещё раз просмотри и конюха redis ш колектор и наш сервис бы быстрой статистики после того как мы с вами определили вот эти вот компоненты технические компоненты которые так или иначе участвуют в нашем пользовательском пути необходимо принять измеримые решения вообще а Что необходимо для хорошего обслуживания клиентов да Или наше сло А как правило для продуктов которые ориентированы там на там запрос ответ да Но для описанных сервисов Имеются два известных подхода к измерению все про него знают количество доступных запросов которые можем обработать И на самом деле они ещ не все наверно здесь я хочу задать вопрос да Какие типы ещё вы знаете если не знаете то я вот вам даже дальше расскажу их на самом деле не два их там штук во получается Как вы думаете какие ещё есть Вот Всё правильно шми без ухудшения качества например 98% картинок мы должны обработать без сжатия дальше это Это количество корректно отображаемых валидный данных например 99% отправляемых запросов на нашу платёжную систему должны быть обработаны без ошибок потом это собственно количество обновлённых валидный данных ранее какого-то порога опять же например фн поле изменения потом это Это собственно скорость обработки данных например система должна обрабатывать не менее там сся запросов в секунду к примеру Cage это охват это там например 95% всех заявок на подписку должно быть успешно обработано Вот это полнота собственно процент времени в че которого 100% заявок обра Уно в зале Да это вероятность потери данных в хранилище например должна быть меньше там 0% Вот соответственно для себя Мы в нашем кейсе принимаем что мы будем измерять это всё viability latency и freshness дальше посмотрим Почему после того как мы определились с нашими техническими компонентами которые так или иначе участвуют в нашем процессе определились теми SL которые мы будем так или иначе накладывать мы переходим к следующему пункту это заполнение вот такой вот таблички соотвественно это табличка которая нам говорит о том какие компоненты мы измеряем и Какие типы SL и накладываем на эти продукты Ну тут для примера да сервис быстрой статистики И абилити что больше там 99 99 у нас запросов должно выполниться с кодом не меньше чем 500 либо вот с точки зрения там frh что задержка в получении свежих данных из Кафки не должна там составлять более 10 минут это то что мы принимаем для себя как доступный уровень обслуживания супер определились конкретными SL и конкретными сервисами что дальше А дальше на самом деле это может быть даже сделать шаг на шаг Ноль это проектирование дашборда вообще как Как подойти правильно к этому какие инструменты мы используем здесь на самом деле э для себя я недавно понял лайфхак что это как с презентацией вы знаете вот берёшь презентацию какую-нибудь делаешь открываешь Чистый лист и смотришь на него и не понимаешь что туда разместить и перед тем как вот начать проектирование чего-то в той же самой графа не например Хорошо бы нарисовать это где-то либо на бумажке либо в мира то есть поместить все свои там все свои не то чтобы знания А все свои желания на бумагу перенести их куда-то да А дальше уже из это собрать что-то актуальное и красивое собственно рисуем на бумаге мы мы делаем мы сделали это так соответственно дальше мы используем графана Ну наверное графана здесь один из таких дефакто стандартов визуализации Рик и там многие компании пользуются мы для себя используем несколько плагинов это Single Stat панель это статус панель плагин это статус overview плагин и что важно что на вот на такой дашборде мы распределяем наши критические пользователи пути по уровню критичности потому что опять же да как с идеей онлайн-магазина мы можем там у нас есть три пользовательских пути и они не все там в данный момент су Mission Critical потому что остальные можно посмотреть чуть попозже Вот и используем школы как SL но опять же чтобы подсвечивать делать Вот это вот Светофор на наших дашборда собственно Как выглядел наш наш дашборд в начале вот эта вся идея здесь она помещена из разряда там вот и про про перемещение для других соно мы вот немножко так расписали для себя дальше уже начали это как-то анализировать смотреть и пытаться переложить это всё на фану собственно после того как мы поняли как мы хотим отображать данные поняли Какие данные Мы в целом как бы хотим с вами видеть на наших дашборда собственно пришло время собрать технические метрики и показателе и здесь ну здесь мы должны здесь на самом деле работа больше Техническая здесь сильно как бы там размышлять о том как это всё сделать Не нужно это такая долгая работа по внедрению метрик по добавлению новых Да мы определяемся источниками Откуда мы будем эти метрики получать их сейчас огромное количество это там прометеус это графит это кликхаус мы в своём случае используем кликхаус иногда графит иногда проме То есть у нас плюс-минус всё по чуть-чуть есть да и дорабатываем наш сервисы Ну понятное дело что мы там явно заложили не не все те метрики которые так или иначе у нас там есть На текущий момент Да это тоже важный этап про него важно не забыть и важно про него проговорить А дальше А собственно определились с метриками метрики придумали теперь про пороговые значения но опять же чтобы наш наш дашборд выглядел как дашборд и мы могли понимать когда есть проблемы когда нет мы должны так или иначе подсветить эти проблемы на дашборде здесь важно что мы первое выделяем опять же это уровни критичности нашего пользовательского пути он может быть там тиха медиум В общем всё зависит от сценария от кейса и это сильно правда зависит от сценария того который вы рассматриваете здесь например единствен совет хотел дать что если вы в качестве Вот таких SL выбираете какие-то бизнес метрики например количество пользователей в текущий момент на сайте или количество транзакций Будьте готовы защищаться перед вашим бизнесом И маркетингом что не вы балбес а просто кто-то маркетинговую рассылку запустил или Сегодня пятница вечер Все пошли отдыхать в бар потому что ну это то на что мы повлиять по факту с точки зрения технической не можем то есть да если упали там не знаю там пользователи на сайте и вы видите проблему где-то ваших сервисах то да это проблема но если там показы упали например А вы на Метрика фиксируете всё зелёное это не значит что вы балбес это значит возможно маркетинг пришёл и что-то там натворил что-то запустил поэтому здесь как один из Советов Да Старайтесь закладывать какие-то технические метрики то на что вы можете повлиять потому что иначе это превратится там в пинание между двумя отделами и Никакой пользы от этого не будет никакого эффективного сотрудничества в целом быть не может ну и правильный выбор кана канала оповещений это тоже очень важно здесь Понятное дело что никто не будет смотреть на эти графики 100% времени и нужно Ну есть люди которым интересно получать вообще в целом оповещение по тем или иным проблемам и здесь важно выбрать правильный канал оповещения вот Виктор Попов у него был прошлый доклад до этого он рассказывал про Арт фатиг вообще про важность про важность выгорания от алертов здесь как совет Ну опять же мы распределяем наши оповещение в зависимости от уровня канала и уровня назойливости канала если например какой-то инцидент Mission Critical и когда там Всё горит нужно срочно решать то это может быть звонок на телефон это вот тот способ который так или иначе вас вырвет из какого-то вашего там вашей домашней среды из вашего Work Life баланса и помести вас в среду решения проблемы всё остальное уже там типа Хай проблемы или Low проблемы Ну можно куда-то там в рабочей чатик алер Да там ещё куда-то ещё кстати важно что мне кажется наверное Telegram стал таким нашим мессенджером который тоже уже нарушает наш Work Life Balance потому что мы там и на работе разговариваем и это лично да то есть возможно Арт в Telegram - это тоже алерта который нарушит ваш worklife Balance А собственно после того как мы придумали SL придумали там как как мы отображать будем как мы поступаем с алерта представьте себе ситуацию Когда у вас есть такой дашборд к вам приходит пользователь смотрит видит что какая-то какой-то сервис красный что он делает он начинает трубить в колокола кричать что у меня там проблема ничего не работает но по факту там ваша команда эксплуатации Или Вы уже заметили эту проблему и там минут 15 назад уже подняли инцидент и начинаете его решать вам не нужно чтобы кто-то там ещё пришёл к вам да и пытался там вот нарушить процесс решения инцидентов поэтому здесь важно ещё добавить на такой дашборд Ну такую вот информацию о текущих инцидентах чтобы пользователь который зашёл на ваш дашборд увидел что Да есть сервис D он красный к примеру пользовательский путь красный но есть инцидент открытый вашей команды эксплуатации там или вами и в рамках этого инцидента вы уже проводите какие-то работы что дополнительно как-то алерта уже об этом не нужно вот и здесь собственно мы просто добавляем список открытых инцидентов в наш дашборд это может выглядеть по-разному у нас это выглядит как алерты в фане то есть любой инцидент это алер фане и мы по нему отрабатываем либо это может быть там не знаю какой-нибудь фильтр Если вы заводите в жиру инциденты либо это может быть какое-нибудь ручное добавление Ну тут всё очень сильно зависит от кейса руками зайти добавить на графа там что есть такой-то инцидент с таким-то сервисом там команда такая-то занимается пос это с Нея просто взять и отдать вот такие наработки там в другие команды важно во-первых что сделать важно Ну протестировать и собрать обратную связь во-первых важно тестировать получаемые данные потому что я уверен что там процентов 90 ваших алертов они будут в начале давать какие-то фос пости в значени и вы будете лишний раз там подрыва будут подрыва те пользователи которым этот дашборд отдали поэтому важно на каком-то этапе провести именно такой тестирование там на недельку на две Когда вы просто проверяете работоспособность вашего дашборда вообще проверяете валидно тех данных которые вы предоставляете и проверяете что у вас нет fse Поти артов А обязательно Мы после этого собираем обратную связь с пользователей мы как люди которые разработали дашборд например да сделали его Мы всё понимаем на нём Нам всё понятно но вопрос понятно ли людям для кого мы эти дашборды делали поэтому отдаём и пробуем собрать обратную связь понять Вообще понятен ли этот дашборд то есть то ради чего мы его делали он вообще выполняет эту свою функцию или нет Вот Ну и как это продаём идею в другие подразделения когда команд много Вы можете сделать в рамках своего подразделения что-то но там надо как-то это ещё там показать другим Да рассказать им и здесь Советов совет на самом деле простой я тут буду капитаном Наверное мы просто делаем в одной команде делаем какой-то proof of Concept после этого приходим в другую команду показываем вообще как это работает вообще зачем это нужно пытаемся эту идею продать ну потому что плохо когда мы что-то делаем И никому не рассказываем да Опять же это коммуникации ну и соответственно рассказываем командам как они у себя могут применить такие дашборды И как мы можем им помочь такие дашборды собственно сделать Вот и в конечном итоге важно помнить что вот процесс вообще в целом создания такого дашборда Это не конечный процесс вообще в целом процесс мониторинга обсер били - это не конечный процесс и у нас добавляются новые метрики Да у нас появляются новые бизнес-процессы и важно что мы вот в каждой точке нашего там нашей итерации должны следить за тем во-первых за актуальность У нашего Даш Барда пому что метрики могут выпилить могут Добавить новый пользовательский путь может быть один пользовательский путь уйти там не знаю в разряд не критичных а другой перейти в разряд критичных за этим Конечно надо за всем следить И это тоже достаточно важно Для того чтобы организовать правильный вообще мониторинг правильную обсер вообще всего и Подводя итоги наверное хотел сказать что у нас вообще в начале было у нас было большое количество неактуальны дашбордов Ну вот реально их там было там 200 300 потому что каждый кто приходит пытается что-то создать для себя Потому что ему чего-то недостаточно на дашборде другой команды и получается огромный беспорядок Да вот в том кейсе как я приводил ищешь Хаус а там у тебя список там из дети разных дашбордов Хауса половина из которых в принципе уже не работает ну потому что Хаус начал метрики в другом формате отдавать где-то там оно вообще старое и там делалось только под какой-то конкретный инцидент и так далее Вот и долгий Процесс поиска проблем Это 10.000 вкладок открытых в фане когда ты пытаешься что-то найти где у тебя что-то сломалось где-то что-то не работает вот что мы получили А мы получили он Понятное дело что он не конечный этот процесс опять же о он дорабатывается всё время мы получили некий дашборд единый дашборд живости наших сервисов наших пользовательских путей мы повысили во-первых прозрачность работы нашего сервиса пользователи наши внутренние пользователи Да могут зайти и посмотреть на наши пользовательские пути на наши сервисы как они работают и как бы мы открыты перед ними мы не скрываем проблемы Вот и уменьшили время вот так спойлер был и уменьшили время поиска исследования вот проблем связанных с какими-то пользовательскими путями как это вышло сейчас у нас здесь скриншот с одного из дашбордов собственно здесь ничего не понятно здесь вс красненькое всё о но вот мы сюда обратим Внимание это вот тот кейс про который я вам рассказывал это отображение быстрой статистики после чего соответственно когда мы понимаем что проблема сервиса мы проваливает метрики там не знаю по sign на ошибки пяти сотки четырёх сотки если нам здесь стало непонятно что с сервисом не так да то проваливается ещё ниже на дашборд Ирой смотрим там ну сервис один из наших там в крутится мы смотрим метри ленси по памяти там рестарт подов и так далее То есть ещё дальше ещё больше проваливается и пытаемся анализировать проблему Что дальше на этом понятное дело процесс не останавливается мы продолжаем обогащать наш дашборд сценариями потому что мы покрыли ещё малую часть того что у нас в целом есть потому что вообще пользовательских сценариев в нашем продукте вообще огромное количество Вот и думаем над тем чтобы добавить синтетические транзакции Ну как бы классно мониторит такую штуку вот тем путём который я рассказал Но если у вас есть какая-то транзакция которая пройдёт весь ваш пользовательский путь от начала до конца выдаст вам финальный результат в конце это конечно ещё ценнее ещё лучше сделать вот в общем в эту сторону Мы двигаемся на этом У меня всё э будем ВКонтакте Спасибо большое за внимание Я готов ответить на ваши вопросы вот здесь будет ссылочка на QR код пожалуйста Поделитесь мнением о моём докладе В общем мне будет полезно пока будет полезно всем будет полезно Спасибо Спасибо огромное Я вижу очень много рук а большая просьба задаём по одному но самому интересному вопросу Ну что наверное тогда вот а у уже прошу Да я буду держать ди Здравствуйте меня зовут Алексей представляют две компании вкусвил и автомакон а видно да Дада просто мне вот он прям я могу так как-то скать не не всё нормально а ну интересный рассказ похоже Вот как это должно быть в идеальном мире вопрос Удалось ли сделать вот этот идеальный мир хотя бы с одной командой и второе Вот вы говорите про пользовательский путь и так далее нормальный пользователь путь там 200 команд работают условно говоря обычно всегда и там нет какой-то чёткой ответственности когда что-то сломалось Да и часто это должны быть прямо идеальные микросервисы где каждый знает кто кому что должен в идеальном мире такого не существует А ну соответственно вот если вы рассказали что сделали то как сделали потому что кажется что реально сделать невозможно У нас Ну во-первых про Команду Да в команде у нас команд много в одной команде у нас это получилось зрить Она более-менее автономная и там у нас нет таких зависимостей от других команд с точки зрения там многих команд это прямо прикольно классно и здесь Ну опять же вот такие вопросы они решаются на уровне коммуникации вот мы в it Мы чаще всего забываем что вообще коммуникация - это один из тех инструментов который наверное у нас должен быть на первом месте и здесь мы все должны понимать что мы в целом С вами все в одной лодке все команды они в одной лодке мы не можем жить отдельно мы все доставляем какую-то для бизнеса и как бы Деньги зарабатываем грубо говоря вместе да и поэтому здесь вот важно именно ходить коммуницировать пока у нас таких кейсов не было но в целом я уверен что вот вот коммуникация она спасёт мир в этом плане то есть никак иначе этот вопрос не решается там как-то директивно ещё как-то такое можно но оно долго не проживёт вопрос именно как мы будем договариваться С командами Спасибо Огромно прошу Спасибо большое за доклад Леонид зовут смотрите я правильно ведь понял что одно из целей того что вы сделали это было снижение когнитивной нагрузки на людей которые обслуживают системы и улучшение их опыта по обслуживанию системы вот есть ли какие-то применённые может быть психологические исследования может быть опыт Мы же должны балансировать между количеством разных Вот вот этих квадратиков на дашборде идеально вобще один квадратик зелёный это идеально но не показывает как работа система э вот где баланс Как вы его ищете и на какие грабли вы при этом наступает в поиске именно вот это Work Life Balance вот для себя как для себя я понял На самом деле супер вопрос Чем меньше квадратиков тем лучше это конечно Тут без этого никак но в целом У меня есть ощущение что вот вот опять же может быть это субъективное мнение Но вот больше там типа шестнадцати таких квадратов оно уже не воспринимается потому что вот если даже если вам нужно пролистать дашборд вот на 100% там Ну на 100 процентном Зуме на экране если вы его начинаете листать всё можно его выкидывать потому что никто туда дальше смотреть не будет типа нет вот всё что должно умещается не видно вот пока вот то что сейчас на скриншоте выглядит Ну опять же мне да может быть это субъективно Но вот пока тем чтобы я хотел видеть Возможно это поменяется там с внедрением там в другие команды и там с распространением этого там подхода на других но вот пока видится что это вот пока идеально Спасибо огромное тогда Следующий вопрос из этой части и потом у нас вот два вопроса там остальные руки видим Кирилл здесь Вижу вижу Да привет Спасибо за доклад Дмитрий синявский компания тех у меня вопрос такой вы в своём докладе указали что у вас есть сло Есть конкретные числа 99 там проце Да но а за какой это период измеряется И в какой момент вот эта квадратик становится красным и вы понимаете это вообще уже инцидент Или надо ещё просто посмотреть и всё не так плохо То есть как разобраться Я понял Ну вообще сразу мы не говорим ну то есть э когда мы видим что квадратик какой-то Давай я попробую с конца ответить сразу когда мы видим что квадрат покраснел никто не говорит что это инцидент Возможно это какие-то временные лаги там не знаю выкатили релиз но он там был каким-то не очень хорошим сразу же да и мы успели его откатить и поэтому как бы люди которые отвечают за сопровождение прода и команды разработки которые смотрят на эти дашборды то есть важно что на э дашборды не смотрят не только не команда разработки люди которые отвечает в целом за процесс разработки Тоже смотрят на них если мы видим что вот он покраснел то дальше сначала первый мы идём исследовать смотреть действительно ли есть проблема или Это какой-то временный лак там не знаю у кликхаус там время мы какой-то жирный запрос в кликхаус пришёл Да сервер статистики грустил там на какой-то там на трёхмиллионный стрию смотрим просто ищем запрос и там в рамках работы там в рамках просто задачки в джире всё это обрабатываем за Какой интервал на телеке у нас по-моему 30 минут висит интервал за 30 минут мы чекаем но иногда кажется что этого ну то есть хочется поменьше Ну вот типа 15 минут выставить Вот пока 30 вот хватает для Ну на время тестирования этого подхода 30 минут хватает для тестирования вот этого пилота супер Спасибо огромное Итак вот там вот я вижу две руки пожалуйста Достаточно давно я очень боюсь что мы не успеем ответить на все вопросы но Кири никуда не убежит и потом будет ответь ваши вопросы в дискуссионной зоне прошу Следующий вопрос бегу да Кирилл Добрый день Меня тоже зовут Кирилл Тиньков банк А слушай очень короткий вопрос по ночам какой звук тебя будет Когда произошёл инцидент детский плач отлично Следующий пожалуйста вот там Спасибо за доклад Павел зовут тоже Вех был вопрос уже А вопрос такой интернет-магазин три критических пути пользователя у каждого мы смотрим по два индикатора получается шесть индикаторов Как понять что сервис работает нормально Смотри Ну как бы понятно что у них разны вес но они все важны без без открытия каталога нет смысла работать да согласен смотри на самом дела эту проте То есть у нас есть у каждого Ну то есть когда ты когда ты пытаешься в фане построить какой-то вот avab мы можем в протеусе там либо Victoria Matrix Виктория Рикс есть ифы прямо вот ну из коробки прометеус это векторы и в зависимости от там значений там каких-то параметров мы просто добавляем там единичку грубо говоря к к общему весу А дальше уже просто пока пока вот Отвечая может быть на вопрос который у тебя сейчас будет пока весо весов у этих показателей Нет пока не очень понятно как их правильно посчитать в целом мы принимаем пока что мы для себя приняли что все вот эти вот сло они важны одинаково Но вообще идея разобраться как-то с Весами она есть но пока у меня нет готового решения то есть они мы Ну понятно в начале они все одинаковые при просадке мы говорим что сервис не работает мы проверяем Да вообще хорошо с ним или нет всё пока это Ну опять же это пилотный вариант хочется сделать именно Ну там такую весовую категорию когда мы сможем понимать там зависи от какого-то одного показателя хуже или лучше Ну например Здесь же опять же да если например мы будем отдавать чуть дольше данные там из там чуть дольше данные чем там за 200 миллисекунд то в целом наверное проблемы ещё особо нет да то есть сервис работает но медленнее и вот здесь надо как-то с Весами поиграться Но вот пока прям Сильвер бута У меня нет Если честно это что изначально село выглядит как Севе пуля А потом приходишь к бизнесу говоришь у меня восемь услуг 16 индикаторов Смотрите Они говорят Мне нужна одна вот да поэтому здесь важно учитывать вес вес каждого сло и вот честно говоря Пока ответа на этот вопрос У меня нет пока Спасибо огромное вот следующая рука там рядышком тоже была пожалуйста вот единственная большая просьба один короткий вопрос от каждого чтобы мы постарались по максимуму всех успеть Да спасибо большое за доклад А подскажите пожалуйста вы не думали интегрировать свои единые дашборды с такими системами как трассировка логирование чтобы можно было посмотреть ещё более подробно то есть ну метрики не всегда показывают точность Ну это в планах есть пока пока только метрики но в целом Да это в планах это есть я про это не говорил только такой небольшой вопрос Мы по сути Мы производим анализ метрик который у нас приходит нашу систему правильно Да а и да спасибо за доклад такой вопрос если допустим у нас есть допустим ночью у нас трафик небольшой и Когда ночь у нас естественно некоторые метрики могут выстреливать если у если у вас такой подход Когда вы подходите с точки зрения динамики да то есть есть разные методы это типа метод скользящего окна например да то есть когда в какой-то временной интервал у вас метрики такого тшл а в другой интервал другого как вы это реализуете и или вообще это не реализуете сейчас не реализуем но в целом тоже опять же в эту сторону смотрим Проблема в том что у нас ну такой трафик что он там очень трудно по нему построить вот вообще вот такую какую-то такое исследование у нас там от недели к неделю очень сильно трафик меняется и даже там текущая Неделя как прошлой неделя она может очень сильно не коррелировать поэтому вот Пока так про скользящее окно тоже смотрим думаем Ну вот чёткого прям ответа тоже нет но идём к этому Ну опять же система она такая она боле более новая то есть мы пока просто внедряем её потихонечку там собираем грабли Да вот пытаемся как-то доработать учитываем замечания и будем также делать Спасибо огромное Следующий вопрос пожалуйста Да привет как я понял из доклада у нас получается некая такая древовидная модель р и соответственно Мы спускаемся каждый раз вниз но по итогу когда мы доходим до самого последнего сервиса у нас всё равно получается огромный дашборд где мы смотрим на всё-всё-всё и у нас также при поиске в фане по запросу кликхаус вылезает куча всяких кликхаус как вот это вот решается В итоге смотри идея Короче дальше Просто Лимп ты оттуда уже не выходишь если коротко ответить на вопрос но вообще в целом идея же в том что ты проливаешь какой-то общий дашборд Клик Хауса А в дашборд который подходит к твоему сервису дашбордов будет немало но они будут чётко коррелировать с тем процессом который у тебя есть и то есть по факту ты можешь то есть это не какой-то супер общий дашборд кликхаус у тебя все вообще метрики есть это метрики кликхаус которые так или иначе относится к твоему бизнес бизнес Ну это пользовательскому пути иначе да иначе превратится Вот вот в огромный дашборд в котором ничего не понятно На ведь чистый дашборд Клик Хауса тоже нужен его можно оставить просто вот как как есть ну кто-то должен его просто саппортить и это вот всегда сложный вопрос то есть типа нет сейчас команды которая бы сказала всё я делаю дашборд Клик хауса и она он типа такой есть для всех Вот это это тоже надо выравнивать К сожалению Спасибо так прошу Следующий вопрос и потом вернём микрофон ещё сюда Привет я на первом ряду тут Меня Андрей зовут Спасибо за доклад вопрос э хочется уточнить Вот про дашборды ты говоришь про единый дашборд и одновременно про дашборд команды и продажу этого дашборда там разным командам В итоге их у вас один на компанию или каждая команда делает Ну проходит весь этот путь и делает себе свой дашборд и условно там 50 команд 50 дашбордов точнее 50 систем дашбордов и когда кликхаус меняет свои метрики 50 команд переделывают все свои графики про кликхаус Как у вас это происходит сейчас мы это Отвали на одной команде распростра в идеале хочется видеть Конечно один какой-то дашборд но мы понимаем что со всех команд пользовательские метрики пользовательские пути будет занимать столько что там не знаю и на стену вот этого доклада не влезет наверно да если не больше Тогда нужно будет наверное можно будет выделять ещё один уровень самый первый может быть это показываю чуть глупо но то что мне первое в голову приходит когда у тебя есть некие метрики там общие пути какие-то большие пря очень жирными мазками выделенные по всем командам на одном а дальше ты уже проваливаешься Ну опять же да то есть у тебя уровень исследования должен вниз идти Ты не должен петлять искать где-то там какие-то метрики у тебя всё должно там стекать вниз ты посмотрел один обычный путь он большой какой-то Да жирным мозком ему с ним какая-то проблема Ты проваливаешься ниже видишь ещё пути и вот дальше дальше всё это уходишь то есть хочется именно вот эту схему оставить Возможно да Там мы добавим ещё один какой-то супер Мета дашборд не знаю это будет не единый а супер единый дашборд Ну как-то так благодарю Спасибо Следующий вопрос здравствуйте Дмитрий Сбербанк Вот скажите Как вы боретесь с практикой когда приходит команда на мониторинг вы им делаете борт заводите алерты настраиваете автоматическое заведение алертов команда отхватить отключай нам заведение алертов вот как такая практика Так Так они же этим и должны заниматься Ну типа это же их работа а они говорят А у нас вот нам алерта статистику портит Ну хрен с ним что сервис работает так себе супер вопрос вообще просто на на пять с плюсами если не на 10 запоминай тебе лучше выбирать Блин я не знаю как с этим бороться Ну типа разговаривать с ними ходить бить их палкой Ну тут тут вопрос понимаешь как выстроено взаимодействие между командами и то как ну как мы с ними договорили с работы Если у нас есть чёткое соглашение с ними что они реагируют на все наши алерты Ну то есть они обрабатывают Как Первая линия все наши алерты то пожалуйста делайте свою работу иначе типа Ну а зачем тогда вы нам нужны А вы алерты автоматом заводите и автоматом в инциденты не заводятся Арт может быть во-первых по во-вторых он может ну типа не говорить о том что это большой инцидент возможно нужно его просто посмотреть там как-то проанализировать либо там Либо это будет фал совы Либо это будет маленькая просадка и дальше Просто дот Ну то есть всегда Давайте продолжим дискуссионной зоне кто-то должен посмотреть да А дальше уже понять инцидент это или нет чувствуется боль прям прошу вот сюда пожалуйста микрофон вообще всё что касается инцидентов это вообще Боль это понятно это у всех тут вообще Это вот моя боль Да очень вдохновляющий доклад Спасибо хотела спросить в плане распределения ответственности при масштабируемости как раз проекта Меня интересует Как планируете именно обрабатывать инциденты Да вот именно из W of dasb То есть выстраивать их в единую систему инцидентов или как-то ть по отдельному пу особенно критичные еди всех инцидентов потому что ИНН за инцидентом им цепляется и Может опять в одной роне выстрел инцидент а там дальше как-то пошло к другим Поэтому какой-то централизованный вот сервис там принятия такого решения он должен быть идея в этом как бы ну что у нас Дайте последний вопросик и всё остальное уже пойдём в дискуссионную зону хорошо прошу вы сказали про одну лодку про коммуникации но всё-таки лодка без капитана не поплывёт в итоге на ком ответственность на поддержке на разработки и либо Как заставить коллег девопсом у нас это завтра сделать у нас в компании подскажите пожалуйста сегодня луччи или вчера вообще ответственность Ну опять же я как devs я думаю что ответственность на командах разработки но в целом в целом Я думаю что Ну как бы разработка - это люди которые действительно знают Ну что происходит с сервисом Мы же какс типа вот я кот я доставил по-моему мы открыли врата Вад а предлагаю продолжить в дискуссионной зоне Спасибо огромное за классное доклад ребята Спасибо за супер класные води сейчас всё скажу не торопимся всё нормально да ребят Спасибо за классные вопросы вопросов очень много Давайте потом продолжим обязательно в дискуссионной зоне никуда не убегает пока не ответит на все вопросы предупреждаю вот а теперь самая главная задача нам надо выбрать а четыре лучших четыре лучших вопроса у нас три подарка от ВК рекламы и один подарок от Газпромнефть Итак давайте Сначала с ВК начнём три вопроса от ВК Вопросов много было Я что-то половину не запомнил если честно Но вот мне вопрос понравился Про как я реагирую ночью за детский плащ лайк супер Спасибо огромное Да так второй вопрос мне понравился вот так и третий вопрос Давайте вот Вот вам спасибо большое так и теперь ещё один всё и у меня три инцидента я сломался а вот там в конце был вопрос про пожалуйста вот Угу спасибо огромное СБО И тебе тоже спасибо тебе подарок антика приходи ещё обязательно ребят не забываем переходить по QR коду оценивать доклад писать свои комментарии А ещё раз спасибо огромное Кириллу Давайте по аплодирую"
}