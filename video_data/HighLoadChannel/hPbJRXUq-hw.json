{
  "video_id": "hPbJRXUq-hw",
  "channel": "HighLoadChannel",
  "title": "Тестируй это / Виктор Русакович (GP Solutions)",
  "views": 523,
  "duration": 3019,
  "published": "2018-01-16T13:31:52-08:00",
  "text": "всем добрый вечер я рад что все дошли и выбрали меня они вечеринку на улице кто-то уходит нет отлично сегодня вам немного расскажу о тестировании как таковом и хочу добавить ваш проект но для начала немного интерактива я знаю вас полно сил но давайте так поднимайте руки кто любит тесты ну как сущность понимаете я знаю все любят когда не надо писать кто любит писать эти тесты ну чуть меньше 3 человека кто любит запускать тесты а если они написаны вами не все любят кто любит запускать вручную каждый раз вообще никто не любит я тоже а кто любит ждать можно шкаф попить вот лично или кого менеджер не понимает зачем вам нужны тесты там вот есть робки руки у вас менеджер зале до остальных ну ладно это все очень печально и я думаю мы это исправим немного расскажу о нашем приложении которое было тогда если кто-то из питера тот возможно был в таллине и в то есть большая компания который занимается подобными перевозками и наша компания участвует в разработке сайта для этой собственно компании на ней вы можете зайти выбрать круиз выбрать машинку с собой в круиз заказать какое то питание себе в рейс все это сделано в том числе мы работа над этим проектом здесь важно заметить каждый блок каждый прямоугольничек это компонент о чем мы будем говорить дальнейшем вот такой здоровский сайт само наше приложение состоит из бэкон дык и фронт-энд а это не сюрприз фронт-энд мы начинали его пять лет назад и там нет никого flavor по просто джек вере в горе тимплей прыг с для связки всех компонентов если мы посмотрим в эффективность нас как командой сколько строчек кода мы пишем то фич мы написали например 55 тысяч строк тестов сорок с лишним ты то есть пропорция почти один к одному и это доказывает что мои тесты но не то что люби ну мы их пишем всего тестов значительное количество в приложений и по типам и по тому где они находятся в бэг-энде который написан ажа века помните тысяч июня тестов шесть сотен из тестов которые проверяют api собственно этого же бренда во фронте на данный момент на вчера 8306 план тысяч было год назад откуда этот слайд взял то есть тестом и не не пристаем писать но есть еще selenium test и так называемый онтент приемочные тесты их порядка 150 штук и мы их не очень любим стать но давайте запустим наши тесты и что мы увидим unit-тест но достаточно быстры кто запускал тут знает 30 секунд и все вся тысяча прошла тест с очень медленно потому что они зависят от вашего приложения то есть особенно она развернута в 9 января люди которые априори медленнее чем продавшим поэтому занимает 6600 тестов занимает значительное время мокко тесты и the front end of ski тесты запущенные локально то есть на машине разработчика будут идти порядка 15 минут если мы запустим их один за одним book t100 запущенные так же последовательно но на сервере континенты гришин буду идти в 2 раза медленнее ну потому что на сервере у нас виртуальной машины и там и тот же 5 процессор шарится между пятью какими-то виртуальными машинами но есть и selenium test ему придется подождать часик если вы захотите всех запустить наконец-то frontend разработчиков появилась легальная отмазка попить кофе в середине рабочего дня но менеджеры были недовольны и сказали ускоряйте что мы сделали выработана было два подхода это параллельный и компонентный подход если мы запускаем тесты на моей машине то можно посмотреть загрузку процессора вот я начал съемку скринкаста это 10 процентов циpкa и где ты сейчас запустились тесты это одно окно хрома в котором бесконечно бесконечна бегут эти тесты то есть это занимает момент 25 процентов у меня и 5 не то чтобы я хвастаюсь на 25 процентов на то чтобы запустить в одном потоке что это значит что если я не хочу ничего больше делать за своей машины я могу запустить четыре окна chrome браузера и они в принципе не будут конкурировать между собой и тесты пройдут 4 раза быстрее принципе так и получается если мы запускаем тест и последовательно и пытаемся загрузить полностью циpкa максимально то можно значительно ускорить все эти тесты локально ускорение порядка трех раз потому что если запускать больше трех-четырех браузеров то вообще ничего больше делать нельзя даже окно пуск не открыть на сервере гораздо легче ускориться потому что мы можем расшарить между различными машинами там уже нет ограничения по циклу нам ничего не стоит сделать 5 виртуальных con в котором в каждом будет бежать свой chrome и сидением тесты шарится таким же образом одна машина 1 то есть и все запускаем параллельно но тут есть небольшой такой нюанс что ваш backend если эти тесты используют реально а ты должен выдержать у нас иногда не выдерживает поэтому приходится немножко замедляться иначе вообще ничего не проходит если мы посмотрим такая вырезка и скриншот а вот эти вот пекин это те моменты когда мы в тестах загружаем приложение с нуля и что это говорит это говорит о том что вот этот процесс по перезагрузки приложения он достаточно затратный это подводит нас к идее компонентного подхода для чем но каждый разгрузить все приложение то есть мы проверили цвет кнопки теперь давайте проверим как работает эта кнопка например в английском языке там например другие цвета нам не нужно грузить все приложению давайте делать это компонент на раньше мы писали как о дупликация be for блоки и на каждый тест это про гонялась ну выглядит достаточно просто не нужно заниматься обработкой компонентных вещей то есть все приложение грузи с автоматически удобно но медленно если мы запустим вот в одном окошке то вы видите как примерно такая скорость выполнения теста то есть мне кажется некоторые люди могут быстрее практиковать эти состояния чем это делает с хотя здесь нигде нет ни с и таймаутов не интервалов то и все происходит молниеносно даже анимации отключены у нас есть один разработчик у которого очень мощный компьютер и он может себе позволить запустить 6 ок он одновременно но он может запустить но закрыть от процесс он уже не может потому что процессор загружен на сто шесть процентов я не знаю он как я когда просил его это снять начал съемку говорит я не могу ее установить вливая ждать пока все эти окна не умрут и вот вы здесь можете видеть что в каждом окне грузится какой-то кусок приложения и когда не остается тестов о ком меньше и меньше в этот момент он примерно остановил съемку два окна уже позволила ему есть принц можно локально запускать но все равно это очень удобно поэтому давайте не будем писать тесты которые перезагружают ваше приложение целиком для этого это только для нашего приложения я не знаю как вы его пишите но подход такой вы берете компоненты пытаетесь его загрузить в пустом окне браузера ну нам для этого потребовалось создать какую-то разметку в странице где этот компонент привык находиться например календарю на все время в той и секции висит мы отправляем туда эту ссылку на этот элемент вручную заставляем его отрисоваться и вручную запускаем рендеринг раньше этим занималось занимался слой внутри лот applications но так как мы не хотим все загружать мы делаем это вручную в этом суть этого helper а нашего майк компонент и в принципе это применимо к любому проекту я думаю если вы достаточно хорошо подошли к архитектуре то есть вот у нас есть разметка мы это все запускаем и рендерим что теперь теперь мы в before удаляем все наши лоты плетей шин и оставляем только моей компонент то есть принципе это грубо говоря эквивалентный то есть если вы если мы в предыдущем тоже проверяли календарь то здесь мы тоже проверим этот календарь и на точно такое же действие но это будет значительно быстрее вот примерно такая будет скорость выполнения компонентных тестов то есть если там за минуту я написал что не придет порядка 200 проверок здесь за 1 минуту пройдет три тысячи проверок и принципе новый тест мы старались писать в компонентом подходе чего я и вам советую но давайте поставим их рядом что вы точно мне поверили что справа быстрее я думаю вы поняли отлично мы поняли нужно запускать теста параллельно ну или хотя бы писать компонентному что выбрать виду много большое количество библиотек я думаю вы все эти картинки видели названием мог a test runner жасмин тоже test runner корма тоже test runner интерна какая-то новая библиотека мне посоветовали упомянуть я ещё не пробовал но она обещает огромный функционал она может заменить себе все что чем я бы дальше рассказывать можно использовать только интерн но по крайней мере они так декларирует можете попробовать чай библиотека для проверки для серферов и мужик туники это зенон же с мы дальнейшем будем говорить про вот эти три связку из этих и смока чай и зенона и в принципе жасмин многие хотели мне на это сейчас на рассказать может заменить мог и чай ну да может но нам больше нравится чай синтаксис вы увидите почему итак у вас есть какое-то приложение в нем нет тестов вы хотите их добавить используем о качай мужиков-то ники броневой я бы хотел пару слов сказать что он дает и зачем нужен в целом он нужен для подмены нам все время нужно в наших тестах подменять окружении мы не хотим делать настоящих а як запросов например мы не хотим вызывать какие-то внешние функции по настоящим поэтому у него очень много компонентов самый важный из них это шпионы который умеет следить за действиями стопы это функционал который позволяет вам создать какие-то методы с предопределенным поведением и вы ведь потом подменяете моки это что-то среднее между стабом и тестом то есть вы пишете поведение для какого-то компонента какой твой клипе например и в нем указываете что если этапе было вызвано не так как нужно сразу упадет вам не нужно писать отдельно проверку на это мы мойки не используем нужно мне нравится что мы не можем контролировать момент когда ты сломается то есть мы хотим явно писать эти проверки фариг таймер очень удобная вещь которую про который многие не знают но зенон позволяет подменять время и править его я править немного расскажу позже и в сексе чар и сервер если вы написали свой проект так что вы не можете просто подменить сервис саяк запросами и все равно не хотят куда-то уходить что конечно не желательно можно использовать их свеча ради но на вы создадите сервер который будет подменять и перехватывать все ajax запросы которые шлют а через x и чар и таким образом ну гораздо проще изолировать ваши тест от реальных запросов что же за тесты у зенона шпион извините в этом примере мы создадим шпиона который будет следить за кликами отправим его внутрь компонента то есть мы от рендеринг компоненты в качестве свойство onclick мы передадим ему не настоящую функцию которая там меняет цвет кнопки а вот нашего шпиона и потом в то есть мы просто проверяем причем обе очень как видите благодаря шут синтаксису очень читабельно я шпион должен быть вызван один раз и он должен быть вызвано с аргументом ивнинг тут могут быть еще раз разные такие методы ускорения то есть колд войска лт thrice оказывается есть такое слово ну а дальше нужно уже писать что годков каунт равно 34 и так далее нету сокращение к сожалению очень удобная вещь подмена времени почти у каждого в каждом приложении как бы мы не хотели следовать этим инструкциям как не стоит писать есть и тайм-аута eset интервалы и первое что вы хотите сделать когда пишете тест например у вас есть какая-то notification который показывается и через 4 секунды прячется первое что делает начинающий разработчик он прямо так в тесте пишет рендерю компонент и в то есть и пишется тайм-аут 4 секунды тест на типа конечно должен быть спрятан ну ладно один тест это хорошо а теперь у тебя сто кейсов и каждый кейс грузит это с нуля 100 на 44 100 секунд то есть вы только что практически 10 минут потратили на ожидание от этих таймаутов очень отстой поэтому воспользуйтесь фрики таймерами создаете клок вызываете зенон you speak таймер и вот такой такая подсказка для вас это очень мало где в документации встречается новый фактами рс может принимать себя в качестве аргумента строку которая говорит о том что именно вы хотите подменять если туда ничего не они отправить он подменяется time all set интервал другу и отключит все эти нативные поведение ну вот мы хотим нашем случае ток 100 ма вот подменить рендерим компонент и не мы не ждём 3 секунды мы говорим о теперь прошло три секунды и сразу наш тест пройдет после этого и длительность его исполнения будет ограничено производительностью браузерах где гоняется это тест не забудьте убрать за собой если вы не отмените вот это время не очистите у вас упадут все дальнейшие тесты я вам это гарантирую потому что ни один сет тайм-аут и либо сайт интервал не будет вызываться в в том в той сессии браузера которая в которой был применен fake таймер очень очень сложно отловить эти ошибки если вы где-то далеко и давно написали этот phreak the mercy забыли очистить очень важно ну ладно разобрались и но нам мы поняли что без него никуда открываем наш индекс html переименовываем его в яндекс html тест который мы запуска россии добавляем туда все что необходимо стиле для мог а потому что репортер у нас будет список ошибок прямо в браузере мог как же свеча и джесс добавляем потом нам нужно настроить мука и выбрать синтаксис написания тестов это либо бедете дебате диди то есть by having met либо test driven development и выбираем синтаксис шут чтобы нас у каждого объектов приложение появился метод шуты мы могли бы писать наши assertion и проверки и где не жалко расположите div сойди мог а куда мог раз может складывать свои результаты выполнения тестов ну давайте попробуем догадаться чем ти-диги-диги отличается применимо к тестам на мог и джесс давайте поднимем руки те кто считает что ти ди ди test driven development стиль справа например вы понимаете это правильно ответ ну вы не захотели мне подыграть но должно было быть так да действительно вы правы те теги справа и в принципе это чисто вопрос вкусовщины слева и справа написано абсолютно эквивалентные куски текста чтобы это доказать либо проверить все сам это не был до конца уверен я залез в мог и джесс на гитхабе и что и увидел что set up to be for each тверда он это авторы иисус этап и сюр дауна то before автор соответственно я не знаю зачем они это сделали кому нравятся синтаксис этап tear down и с you set up гораздо прикольнее когда прям написано before each авторы че так далее поэтому я советую вам использовать именно его легче объяснять и читать тесты отлично мы выбрали какой стиль написания тестов будет не забываем загрузить наше приложение допустимо но все лежит в этом файлики обвес загружаем тесты написаны допустим мне тоже в одном файлике и в момент когда приложение готово вызываем о коран в инструкция во всех как туториалах как подключить это просто написанному кран но это тоже такая такой нюанс что мог коран нужно вызывать лишь тогда когда у вас прогрузилось все ваше приложение хотя это как асинхронные скрипты и они следующий код не выполняется пока файлы не загрузились но если в вашем приложении есть какие-то тайм-аут и боях запрос еще что-либо там подгрузка какая-то синхронная если вы пытаетесь запустить макрон до того как ваш приложение готовы ну что-то отвалится очень сложно найти что именно поэтому место дал комментарий эти вполне возможно в вашем случае будет какой-то call back вашего компонента вашего приложения которое вызывается когда все готово и так ну такой мертвую это наше приложение с каким-то функционалом например этаж один элемент куда мог а будет складывать свои результаты и библиотекам о качая стиле настроили муку и запустили ее и вот например у нас есть такое приложение очень простое но очень интересная нажимается кнопка голову wynn пути появляется лучший город в мире идеально работает давайте запустим тест для него вот примерно так будет выглядеть отчет в мог а когда она скидывает это в вышитыми немного мелко но вверху справа она пишет либо добавляет такое float панель где показывается статус прохождения теста удобно когда тестов многое вы не знаете сколько осталось еще и самое важное для нас это непосредственно ошибка если это ошибка в сравнении срок то будет написано значно явно что ожидалось увидеть словом минск точнее ожидалось что минск будет равен таллина то есть тесте написано что input шут input в ильичу тыкву таллин а на самом деле минск то есть ошиблись городом где-то либо в тесте либо в функционале но дело не в этом неважно это было раньше и это очень круто писать тесты и запускать и потому в браузере это тебе нужно все время в браузер че-то лазить и смотреть держать его открытым 25 процентов сжигается не прикольно мы будем сейчас записать тесты через консоль мы запускаем npm тест и пошло я немного сокращают от вырезаю момент ожидая но через сорок секунд где-то запустится корма которую мы будем использовать и побежали тест вот видите каждая точка это прошедший тест вместо полного названия теста я использую . чтобы не за не мусорить в консоли и вот примерно за минуту прошло 1800 тестов компонентных и сравните это с восьми с половиной то есть больше в четыре раза конечно но занимала 15 минут то есть компонента гораздо лучше что это значит если это все идет так быстро то давайте мы вам запускать тесты каждый раз когда есть изменения в коде это очень удобно ты сделал не плохой мер ты про это не заметил а тесты прибежали и все сломалось нужно вызвать в консоли какую-то команду она может отличаться запустится опять же где-то фоне корма я уже здесь не показываю и прошли тесты супер это то что мы сейчас ведем видите консоль не закрылась и процесс не закрылся теперь мы меняем тру на фолс в компоненте и сразу после этого снова побегу тесты и они прошли это заняло причем 22 секунды и у нас появилась notification в причем это будет работать и вы будете и windows откат стандартная api всех операционных систем очень удобно что вы даже не думали про прохождение тестов уже знаете что они сломались как же написать такие тесты когда все это должно работать в консоли мы заменили в принципе только мог она корма потому что она более свежая ну и мы начинаем наш проект после того как долго поработали с ангулярным где конечно с кармой пришлось познакомиться например напишем тест на варнинг какой-то компонент с тремя атрибутами и что вообще стоит проверять компонентах если так вот немножко в сторону отойти всегда проверяйте видимость если у вас есть к эта логика что компонент прячется либо показывается какие-то определенные моменты либо при условиях это очень хорошо проверить это важно старайтесь проверять класс особенно если эти классы как-то влияют на отображение каких-то элементов либо на поведение то есть меняется цвет например кнопки некоторые разработчики пытаются залезть прям саму кнопку узнать какой у нее текст какой не цвет вместо этого можно просто проверить класс который задает этот цвет если у вас какое-то мультиязычные приложение либо даже если одна язычная но там есть токены очень важно их проверять потому что очень обидно в кнопочки у кейт получить talking on cell и все это пропустят нарушит какой-то далеких компонент перевода это очень важно set time out a set интервал но так как вы знакомый зенон джесс то эта проверка вам будет ничего не стоит и это очень важно чаще всего например сет интервал как мне кажется использует в обновлении каких-то сессий и этот функционал почти все пренебрегают проверка его и это очень опасно потому что его очень тяжело проверить на бою так скажем тест написать люди считают что сложно но при этом зеленом это гораздо гораздо проще ну и все остальное тоже проверьте ничего уж там и так прежде чем писать сами тесты давайте напишем небольшой helper который позволит нам загружать наши компоненты гораздо исполь используя намного меньше кода мы где-то вверху укажем список дефолтных параметров для компоненты которые как мы считаем удовлетворяют большинство случаев наших тест кейсов потом мы возьмем дефолтный параметры замершим туда новые параметры и от рисуем этот же компонент если здесь кто-то работал с react тестами поднимите руки кто писал react с то есть пару человек вам этот код должен быть знакомо кто еще не начал писать на реакции и начнет вы вспомните его зачем это нужно вот смотрите здесь два кода который и клевать 2 ковалентных тест тест 1 и тест 2 и в первом случае на первой строчке каждого тест кейса мы используем наш helper и кода к значительно меньше потому что мы не указываем дефолтные параметры ну может быть это покажется к это простой вещью и непонятно почему столько внимания этому уделяю но это позволяет значительно сократить количество кода и упростить дальнейшей рефакторинг ваших тестов когда у вас было в компоненте 3 property она завтра их стало четыре противном случае вам бы пришлось во всех be for блоках бегать и менять количество аргументов еще очень интересная вещь которую не знаю вряд ли сам найдёшь но если вы используете чай а вы скорее всего будете использовать его вы смотрите какие там есть плагины классные особенно нам понравился чай дом который значительно сокращает количество кода как значительнее в как не в разы но единицы символов но что больше что более интересно он улучшает читабельность кода вверху и внизу написаны 2 тыс кейса с одинаковым функционалом но верхней читается гораздо проще как то естественно хотя проверяют в конечном итоге ни одно и то же ну проверить класс там видимость это здорово но можно например проверить там qr-код ну можно у нас приложение а ну-ка r-код например генерируется с помощью с веджем рисуется вот мы написали проверку что размер элементы с qr-кодом стадион 6 скажите что за ерунда там проверил размера а сам код с этим были сложности мы не могли проверить функционал самой библиотеки при генерации то есть она была был взят какой-то чужой код мы внедрили в него сама не было тестов поэтому что мы сделали мы почитали спецификацию для qr-кода и что интересного qr-кодов есть различный тип вот это ацтек от типа ацтеки пирамида вид сверху да и у него в центре всегда черная . но так как это и свечи то есть доступ к информации о цветах мы просто залазим внутрь и теста в этот элемент сгенерированной и смотрим что все середине по центру точно черная . и один раз кстати эта библиотека на это тест на спас когда мы переходили с обычных кодов там где квадратики по углам на от стояка да то есть мы правда как спасла мы его записали и теперь уверены что ты всегда будет проходить но нет ничего невозможного я думаю на любой случай можно написать тест как же писать эти славные тесты так как мы выбрали биде хоть это вопрос вкус и название методов мы у себя пишем тесты как будто мы рассказываем историю самом верху мы пишем условие при котором генерируется наш компонент и в тестах мы не пишем шоу залитом это город класс или шоу следит батон мы прямо называем вещи своими именами то есть должен быть добавлен мобильный класс должна быть показано какая-то определенная кнопка и мы кстати проверим классы видимость это очень уговорил если мы запустим этот тест и я немножко успеваете заметить там . он ли появилась мокко дает такой метод ко всем ко всем искрой бам функциям describe it и это запускает только этот тест то что находится внутри если мы его запустим то в консоли появится примерно такое сообщение мы видим компонент которым эти тесты проходили мы видим сами тесты вот я такую выжимку сделал если мы отключим или бы сменим репортер из виде точек на вот такие тексты это позволяет понять что у нас за приложение иногда тесты когда мы возвращаемся к ним через год через wap услуг фунционал написан действительно позволяют меняется что почему именно этот код находится в компоненте то есть если благодаря тому что мы немного больше времени потратили на только придумывали условия как назвали эти тесты нам это сейчас отыгрывается во времени то есть мы понимаем что за приложение у нас если обобщить то теперь тест и мы пишем вот так вверху мы скидываемся импорт и но наверное сейчас java script все кидает импорт и туда потом у нас идет блок с описанием наших тестов причем мы все оборачиваем название компонента то есть у нас всегда есть один уровень общей которым пишем там компонент парник например или так далее затем идут все наши тесты и где-то внизу мы складываем все наши хелперы который мы пишем для конкретного файла если они шарятся между на файлы но мы делаем какой то мини библиотечку и но значит пойдет выбор ты тест написали control с где сохраняем сохраняйте всегда в папку с компонентом почему закружу так если вы начинали проект на реакцию них в документации написано скидывайте все по все тесты в папочку тест где-то в корне вас которой лежит это конечно здорово но если вы потом работаете с каким-то компонентом и хотите найти тест для него мы не нашли пока еще такой среды разработки которые позволяют быстро перескочить к тесту для этого компонента но не работает так и вы начинаете искать по названию файла внутри компонента а у вас есть название схожие вы ищете ищите это не круто а тут кликнули на название папки и сразу перескочили в нужный вам файл редко бывает много файлов папки с каким-то компонентом значительно упрощает работу в проекте как же добиться вот этих славных сообщений внизу справа когда ваши тесты сломать если бы прошли при собственной разработки есть плагин кармана тифа и репортёр вы его добавили и потом просто когда запускаете тест нужно корми указать какие именно репортеры и включить у него есть некоторые конфиг когда можно показывать сообщение когда нельзя про это есть в документации но подключение достаточно простое просто в плагины засунули все работает из коробки что называется ну здорово когда у тебя локально тесты могут проходить и сообщение но континенты грешен все-таки это намного лучше когда все могут видеть результат выполнения кода и если вы будете разворачивать consist играешь внутри компании то скорее всего вы будете выбирать между дженкинсом этот мужик официант а bamboo & ten city я думаю первый бесплатен 2 остальные хода платные решение но прежде чем выбрать непосредственно какой sure we can this ты грешен вы будете использовать вам нужно подготовиться к этому есть три необходимых условий для того чтобы ваши в кантине старейшина мог запустится вас должна быть команда по запуску этих тестов это команда должна давать код ошибки если тест упали либо не давать этого кода когда тесты прошли если вы хотите увидеть у себя в на сервере отчет и увидеть список ошибок то вам нужно чтоб строился какой-то отчет два формата существу форматов множеств но я выделил два этих отчетов это g-unit который представляет если обычный культ xml-файл но он очень большой это много люблю xml поэтому так протокол гораздо проще и в принципе если у вас нету под candies ты греешь вы можете просто выйти отчеты даже иногда залазить и посмотреть что там начали пишется просто количество файлов количество тестов и один тест одна строка окей тест прошел но такие то есть не прошел очень удобно если вы хотите создавать отчеты вручную не нужно париться с xml что нам ещё нужно нам теперь нужно избавиться от запуска наших тестов если мы говорим про мог а через яндекс html с тестами да мы воспользуемся моку фантом джесс такая библиотечка и создадим тест создадим скрипт например назовем его тест который будет запускать наш индекс html с кодом ока фантом же с вот такая такая вот библиотек который совмещаете фантом же с но этому все знакомые хотелось браузер и мокко и нам теперь нужно заменить нашему кран точнее обернуть его в некоторые условия мы больше не хотим иметь индекс html и яндекс тесты штаммы индекс тест . html мы хотим и все иметь в одно в одном файле поэтому нам нужно спрятать эти запуске мог мы будем запускать теперь только сибур не прописано как а это кодовое слово contest а чтобы запускались тесты в консоли для consist играешь и мы будем использовать маков о том же с объект который появляется теперь мы хотим уйти в облака потому что ну это скучно и дорого развивать инфраструктуру внутри компании а облачных решений очень много самая популярная думаю это трэвис он бесплатен но к сожалению только если ваш проект открыт скорее всего если вы работать по небольшой компании этого закрыты проекты но первых 100 сборок вы успеете создать если здесь есть кто-то кто пишет не на java скрипте а на чем другом то не переживайте трэвис поддерживает все о java скрипт php даже visual basic если кто видел тесты на вижуал бейсике подойдите ко мне после доклада вас ждет приз есть еще с на опции здоровский продукт я про него рассказывай уже на 2 года но в августе он исчезнет поэтому если вы писали тесты и использовать его для интеграции ну нужно успеть перейти на пример мы с интегрировали наш продукт наши тесты с трэвисом и вот у нас есть такой дашборд травись и который показывает что последняя сборка была успешно здорово и я думаю все вы видели эти замечательные квадратики прямоугольнички бил passing этого вселяет уверенность людей которые захотят пользуется вашей библиотекой давайте попробуем это сломать вот мы можем зайти например в пул request и для нашего проекта и вот видим какой-то пул request с каким-то крестиком очень интересно мы заходим в него и видим что кто-то создал этот pull request отправил к нам в бит хоп и трэвис автоматически смешивался с этим ну подвержен этот pull request of проекта и запустил тесты то есть теперь вы заходите ваши pull request и и вы видите можно его применять и либо нельзя ну например я не посмотрел на этот крестик и замер же pull request теперь я могу зайти в трэвис и влогах просто увидеть где именно была ошибка то есть помимо того что я вижу описание точно такое же кстати как мы видели в проводили до как теперь это в консоли в тезисе я еще вижу небольшой stack trace я знаю где это произошло если у вас есть лак и вaс интегрировались с ним вы можете все репорты получать прямо в ваш чат какой-то иконку можно выбрать свою но нам нравится такой помечать все поломанные билды ну и теперь у вас есть ответ кто все сломал то есть тот кого пометил снег более того я не знаю зачем но тон сразу автоматически шлет вам письмо к контейнеру вашего продукта ну не знаю я всегда после презентации эти письма удаляю конечно но может быть вы будете иметь q это дополнительно дефекацию на телефон что ваш билд сломан и если кто-то постарался и все-таки создал нормально пол request то он просто будет иметь нормальную галочку для вас это значит что вы можете безопасно подмешиваться также вы можете взять дашборд внутри этих проектов спросил этому трэвису любого любых других consist игры action service сервисов есть такой режим как дашборд когда большом экране можно расположить он показывает список всех ваших билдов и их статус ну вот здесь например мы на плазму вы видели там сколько 5 билдов наших любимых и вот два из них сломались ну это конечно здорово но не все смотрят на монитор так видео забрала фокусу такая фотография не я конечно автор но это снят в москве и скажите чего здесь не хватает ну еще больше нет как это все можно исправить ну конечно всему этому нужен светофор и у меня есть один для вас так стоящей светофор и блок управления вот например у вас нет денег на плазму чтобы поставить у вас в офисе у вас есть arduino у вас есть какая-то релюшка к ней и вы можете все это запаять и подключить это все к серверу ну допустим вот у вас билд к сожалению только один build можно здесь продемонстрировать но кто-то сломал ваш билд ну нет ничего проще чем послать ардуине сигнал и теперь все видел что что то не так в системе например у вас в команде есть упороты разработчики которые не следуют правилу не пушить в красный build ничего кроме фиксов ну конечно это печально но к сожалению к счастью китайцы создали здесь такую штуку 2 красных цветов нету но можно добавить звуковую нотификацию ну конечно лучше отключать через какое-то время иначе никто не будет фиксить всего бегут из комнаты например вы решили задать такой функционал что когда пришел куртками ты билд будет собираться узко желтый цвет моргает ну надо же как-то сообщать людям о том что происходит ну и конечно когда все починиться нужно помогать зеленым и зеленые на самом деле как то так и если вы действительно заморочить эссе создадите такую штуку и вам советую все-таки через какой то промежуток и и выключать иначе все будут просто пялиться на целый день и никто работать не будет это очень упрощает и улучшает дисциплину в команде особенно этот странный свисток я подготовился к докладу и создал несколько вывел несколько цифр которые позволят вам использовать conti из ты грешен и тест и вообще в принципе именно такое количество тестов должно проходить если вы собрались релизиться больше можно меньше нельзя это количество тестов допустим и сломать пятницу вечером уходя домой особенно если у вас есть разработчики кто работает по выходным и вот такой вот слайд помните вам обещал решить проблемы с менеджерами каждый раз когда мы пишем тест их количество увеличивается это доказывает наш график и такое эмпирическое правило что чем больше тестов тем больше уверенности у вас как у разработчиков в вашем проекте и я не знаю нет номер ничего лучше для менеджера чем уверены себе и в проекте разработчики но уверенность этого мало все мы любим рефакторинг и числа говорят что чем больше у вас тестов тем легче сделать рефакторинг проекта в будущем заменить что-то добавить изменить количество свойства и так далее тут большое количество возможностей то есть что из-за этого все следует ну что тесты необходимые с небольшим сигналом все будут их поддерживать зеленом состоянием спасибо может уход есть книги вопросы спасибо за шикарный доклад один из лучших вообще которая сегодня видел вопрос такой скажите а вот использовать или вы от n до воды ну скажи ты говорю обращайся в своей компании что ты используешь какую систему сборки то есть вы по актам или браузере файле что-то или случае реактору понятно это во первых во вторых при собственно прогоне unit тестов используется ли эта система вот так вопрос но как проекте который тесты реакции компонента мы используем там вы пока не знаю можно ли строить реакции с ним и папкам сейчас но это на самом деле не имеет большого значения потому что просто у нас есть вы паковский конфликт специально по теста это очень легко накорми прямо загуглите в покормлю вас сразу пример будет то есть никаких сложностей с этим нет особенных и какой 2 правду но это в общем был первый вопрос понятно и второй вопрос вот обвязка харнас да ну то есть вы показали там индекс html который все подключает в карме же что это не нужно в принципе он она сама создает index.htm али это показывает как бы доклад у меня две секции да это когда у нас есть приложение к которым нет тестов из туда проще всего работа через мокко и в index.htm или этом запускать макрон но если у вас классное приложение пусть и там не очень компонентная и у вас есть возможность создавать отдельный бил для него но можете там вручную вызвать мог раны не через и таксистом они работать а через папок то есть новый entry point какое то создайте просто и все спасибо и последняя часть вопроса собственно почему я все спрашивала ницы зависимости как вашим компонент на подходе и так понимаю даже до того как вы перешли потом у него перешли как что-то должна быть как вы решаете этот вопрос зависимость dependency injection по-русски а как мы решаем ну не знаю как то на саму решается то есть в реакции этиком с этим нет проблем то есть мы когда создаем компонент то он подгружает все импорт и которые были прописаны внутри этого компонента собственно но если вам нужен нереальный компоненты какой-то мог но тут вы может быть там проезд этот спрашиваете фейсбучный которые там нужно вручную указывать все зависимости но если нам нужно что-то подменить в компоненте и этого нет в api компонента то есть компонент не принимает в себя например сервис работа с аяксом да просто пользуется чем-то то к сожалению ничего с этим не сделаешь нужно писать так чтобы все зависимости которые мы хотим тест их подменять их можно было отправлять в компонент явно нужно было иначе невозможно и подменить это все-таки java script где залазить извне в компоненты что-то в нем там подменять это опасно не очень надежно спасибо ну как маленький комментарий мы вот как раз поэтому в пак просто подставляем вместо там одних компонентов друге спасибо много решил после все спасибо значит вопрос такой были там койке числа в конце доклада а можно более конкретные числа вот вас тестов там почти по столько сколько кода сколько ошибок допустим в релиз находят тесты которые реально помогают видео продукт лучше вот и вот это число наши менеджеры не позволяет менять никоим образом если мы делаем релиз и тесты красные то перед релизом мы обязаны исправить и тест это такое правило в нашем проекте но она как часто подают тесты скажем так ну если мы работаем как бы в кантине сент играешь на это как бы не только описание инфраструктуры это процесс разработки до любой момент времени на вот этом светофоре ничего не должно гореть особенно такого цвета если он горит то никто ничего не должен коммитить иначе будет вот этот вот сигнализация да почему это сделано то есть каждый момент времени ваш билл должен работать то есть когда ты добавляешь новый функционал ты сразу к нему пишешь тесты либо ты можешь там локально сначала теста и так далее плюс к чему это говорю у нас тоже там есть кое-какие тесты но основная фишка этих тестов то что если тесты ломаются чаще всего это просто проблема в самих тестах как часто они обнаруживают ошибки в коде только телах случаются не безусловно иногда так называемые рандомные ошибки там например по выходным у нас есть один тест который в шесть часов вечера если запустить проект он сломается ну вот один конкретный тест думает не фиксе мы с этим живем просто никто воскресенье в 6 вечера кто меня больше не запускает это сколько тесты находят ошибок мы не пускаем их специально перед релизом то есть каждом времени у нас стабильная сборка даже в деве мы у нас такой процесс мы делаем релиз фактически просто из дефолтного бранча в мастер держимся и готова то есть у нас разработку такая без веток скажем еще кому фишки нужно спасибо за доклад подскажите как какой у вас процент покрытие тестами и есть ли какая-то минимальная планка то есть пример я сделал компоненты обязан его там на 75 процентов покрыть тестами иначе но у нас нету мысах в карме есть возможность подключить репортер который умеет анализировать процент покрыть istanbul кажется он раньше назывался но у нас он просто для информации то есть похвастаться перед друзьями вот я вчера покрыл компонент на сто процентов мы у себя не делали кого-то жесткого правило что тесты на сто процент функционала во время code review разработчик который проверяет white твой компонентный код просто смотришь чтобы тесты были адекватные тому что ты какой баг исправил либо какую фичу добавил мы это не делаем потому что допускается в каких-то случаях ну не покрывать все тестем ну например не знаю прямо все все классы которые возможны и при различных условиях то есть комбинацию значительно множество но есть реальное использование компоненты мы знаем что никогда там одновременно не будет вызван мобайл true и там например русский язык потому что для русского market например мобильной версии не существует то есть если мы будем ориентироваться на покрытие тестов у нас все время будет висеть какая-то там красная строчка что и я здесь не сто процентов хотя мы знаем что там ну не нужны тесты то есть принципе это вопрос кадре view и адекватности мы все взрослые люди знаем что нужно покрыть тестами что нет раз маток"
}