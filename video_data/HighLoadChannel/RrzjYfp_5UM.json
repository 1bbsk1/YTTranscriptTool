{
  "video_id": "RrzjYfp_5UM",
  "channel": "HighLoadChannel",
  "title": "Модификации KVM для работы в кластере / Андрей Шетухин, Иван Повстен",
  "views": 183,
  "duration": 2346,
  "published": "2017-04-22T11:11:09-07:00",
  "text": "метод это решить эти задачи следующим образом во первых убрать покупаемый зоопарк серверов стандартизировать оборудование гибка автоматически перес принять доступные ресурсы обеспечить отказоустойчивость сервисов и соответственно простить процедура диплом обычные devops такие задачки а то есть вот такого вот ужаса сделать ну хотя бы вот такое очевидное решение это опять-таки купить одинаковые сервера виртуализировать сервисы и распределить виртуальные среды по серверам как но мы все просто примерно вот так однако как только мы пытаемся распределить эти самые сервера виртуальные по физическим машинам выясняется что нужно не только х раз прилетим руками куда-то бы просто так поставили что ну как бы да а нужно еще уметь их мигрировать более того надо распределять их с учетом ресурсов масса параметров например она хочет много циpкa другой обязательно нужен не знаю там 10 мегабит сетки 3 нужно все вместе за по чуть-чуть соответственно кроме упрощать нужно делать умеем делать быстро и независимо от времени суток вообще говоря это классическая комментарий комбинаторная задача под названием задачам укладки рюкзака то есть будем рюкзак бром энное количество предметов и сами собирали наиболее ценные в рюкзак и уходим с ними удалить к несчастью это задача не решается человеком особенно когда серверов много это очень большая печаль особенно когда у вас нету инструментария который бы позволил все это дело лампа помочь каким-то образом разбалансировать собственно есть в этом во всем хорошие новости в том что говорит решение есть плохо то что до сегодняшнего момента свободного софта особенностью не было ничего похожего чтобы она умела балансировать машины виртуальный и соответственно запускать их проверь проверять наличие свободных ресурсов делать какие-то выводы очень помогать облегчить жизнь devops поэтому мы написали собственный проект давайте я скажу и формальные требования были выгружались при разработке и соответственно это первое что нужно уметь делать это автоматически балансировать виртуальные машины по серверам кластером учитывая несколько разжевать на произвольное количество заранее заданных критериев измеримыми обеспечить like вибрацию то есть достаточно просто запустить систему ним необходимо еще сделать так что случае отказ железо физического сервера да там вертаки не потерялись а куда нибудь въехали вылетом перезапущен собственно попытаться обеспечить еще отказы устойчив 7 возможными способами и не самое главное все это надо делать не выключая кластер не перри конфигурируются соответственно добавили машину физически утащили включили выключили виртуалку она сама должна перед конфигурировать а без особо сильно участие человека собственно проект перед жонглер мы основали на двигателе good фактически мои сильно-сильно переписали еще не умеет он умеет задавать ники некое количество параметров балансировки изначально работают в кластере соответственно иначе будет бессмысленно этих самых алгоритм датировки поскольку на самом деле два ним соответственно вся штука пытаются бороться с ситуацией сплит брель запуском вдруг там мы выбрали экземпляров виртуальной машины в случае если власти связанности не 3 кластер разъехалась соответственно половина систем не знает что делает 2 соответственно там как бы все плохо и надо очень чтобы виртуалке запускались единственным цепляет значит какие возможные параметры милость и робкий есть очевидные до потребление цепную виртуальной машины сколько она проще сетевого трафика менее чем у меня что необходимо зачастую сделать так чтобы одна две или более виртуальных машин 1 класса например и затем мастер из базы данных или там два фронтэнда было сироп чеки никогда не жили на одном физическом сервере причина очень проста что fissure имеет особенность выключаться сам неподходящий момент вот это потеряется не мастер и своих баз данных как буддизм бегут от провал соответственно чтобы этого не было можно сделать специальный параметр вместе и не будут они баллотироваться на 1 тур машины параметрам любых то есть что что угодно измеримая на ваш вкус как мы всего системе от соответственно и к системе как у компонента есть компонент три штуки это хранилище образов собственно сами сервера составленным к вам у нас используется для инвизе 7 точнее ему близкий аналог и убунта проблем нету никаких можно использовать дугу минус вот собственно сама система балансировки в общем картинка и привлечение внимания что имеем хранилище подключенная пососу к насосу в принципе вы можете использовать нужно возможный подходящий евро подключенным физическим сервером на них живут виртуалке с мегу равную виртуалку выброс не трогали соответственно перетащили запустили все работает можно образцов достигать и соответственно держать его на физических сера выпуск долго так быстро 20 скульптор 20 40 гигабайт образом попади перетащи собственно хранит образы каждый сервер квартира подключил через а еще раз можно что это неважно можно использовать что угодно у нас садится на доступность обеспечит через multipad существует 4 а попробуй сломать систему балансировки ну она соответственно смогла бы серверами кластера распрямляет виртуалке между ними серверами обеспечивает white миграцию и перезапуск виртуальных машин по мере необходимости ночными ральф угол сироткина их 2 это максимально использовать ресурсы на одном сервере то есть идея какая что берутся виртуалке запихивается максимально плотному с учетом возможных ресурсов на серверах если там как нет 40 стоят уже загруженными этом на друг может не выключила не черт вариант нужен вам нужен код массовое быть провести там как-то сделать перетащили с одной половина машин что тогда там поменяли доставили оперативки планы она вся там у нас мигрировать а потом соответственно на чем их обратно перетащили а на передачу с там 2 клан серверов осталась свободной там можно выключать свободу но и максимально быстро сырой в классе маскарад который просто берем все эти виртуалке урон условием размазываем по физическим сервером в общем-то только свой больший ресурс тот молодец соответственно работа будет быстрее железки будут загружены по силе и а значит обработают вот это классная штука создается на каждой книжке service time по нашему вот этому жанру при старте ему чуть конфигурацию образуется не съешь конфигурации вообще на самом деле сегодня на лежит базе вот там четыре варианта искушает мозг вздор 40 собственно достаточно там на текстовый файл они не стали заморачиваться не нужно совсем значит сочетаем конфигурацию мы подключаемся друг другу видим все видят всех при помощи алгоритм делаем выбор мастера собственно мастер любят все сервера говорит нам соответственно делать систему производят процедуру говори балансировки говорит мне что запускали соответственно все остальные системы которые стоят относительно него от команды исполнена включить выключить там выключить традиционно или выключить shadow ну там не строим вот соответственно как the cut всеми всем соответственно как смотрится затем что она живет и ему хорошо кластеру каждый сервер следит за всеми своими соседями которым он подключен ставим периодической провели pink запросами и соответственно некий тайм-аут проходят ответа нету делается еще одна попытка классе с классическим и увеличение в два раза время если этого нету соответственно считаем что все плохо там какой-то сосед умер соответственно если выключает включается в.н. pure бункеровка всего класть расист не производится слушать не нужно ну то есть не включается новое выключили включили вот то что сейчас про ботало а затем пока вы там нет необходимости строгость и вот если но очевидно 6 отключается мастер уже оставшись серверах делают еще 1 раунд перевыборов выбирают мастера и соответственно а поскольку всех конфигураций одна и та же про проблем что новый мастер всех начнет передавать и перри балансировать нет как бы он схватил старую конфигурацию ему хорошо соответственно ситуация может быть следующий отличается ни один сервер не 2 много уж такой много-много в нашем представлении это ситуация 50 процентов плюс один серый если какой-либо сервер лечения перестает видеть коллег в количестве больше 50-ти процентов плюс один он считает что это не они умерли а он отключился по причине того что не за этом секты недоступна или еще или еще что им произошло ли там кто-нибудь наконец иски интерфейс неправильно положив а соответственно ждет некоторое время тайм-аут и начинает гасить виртуальные машины на себе соответственно остальные сервера которые видят что коллеги стал недоступен выжидают некий тайм-аут и он самый сервера которые да неужели и балансируют друг между другом и запускают это идея какая чуть-чуть нужен тайм-аут потому что когда у нас война on a plain кластер разъехалась со второй половиной мы не можем сказать точно что же происходит уж там часть недоступна соответственно мы выделяем некоего время которые гарантированно хватить на остолопов машины виртуальные у то есть для каждой детально прописан стоит при для какой-нибудь фронтон венге она ничего не умеет делать рука картировать быть удалён очевидно что интернет может быть одна секунда прибили мы подняли ничего страшного нему ничего не пролететь альбомом в этом очень правильно традиционно заступитесь это все задачи там может быть и на минут и соответственно прописываем какое-то количество времени самошина на виртуальное за это время суда разница все хорошо мысли нет она прогревается что делать не судьба значит и счет сдается для того чтобы при подъеме и той же самой копий виртуальной машины в другом окружении у нас в квартире не жила две машины там с одинаковым mac адресам айпи адресов с доступом дискусов попытке записи этом на не провис смонтированный об этом . понятно собственно о чем разговор все это построили все бы бессмысленно и неинтересно это не было цифру здесь сервера посередине количество виртуалок на нем вправо числа то есть скорость скорость при балансировке и соответственно принять решение за 10 серверов 50 виртуалок миллисекунда 10 серверов с торта привели секунды 20 серверов 200 винтовок одна сотая секунды понятно добавление виртуальных машин там не было сироп кучи мал сам все занимают вот на чём нам говорит график жрать выглядит страшно но на самом деле это экспонента это классическое решение и оно горит mail то есть это самое оптимальное решение задачи при полной задачи и балансировки то есть наполнение рюкзака как так ну то есть это для 20 физических серверов нам да есть виртуалка не видишь что-то где-то у кого-то 1 сотая секунды чтобы то что хотелось рассказать какие есть вопросы задавайте я сразу делаю вот так вот чтобы некоторые вопросы исчезли но вообще говоря от штука имеют интерфейс g47 то есть написать мне в морду сможет любой пока пышки принципе вообще не является проблемой у нас лучиком онлайн утилита связано это с тем что мы поставляем специфика работа такая что мы представляем необслуживаемые решение в том плане что через выполнить недоступной то есть от решения конкретной заказчики которые там нужен там стойку 2 там 35 поставить я и соответственно веб-интерфейса не особо необходимо написать эту песню проблеме на мой взгляд не является никакой хочется усложнить задачу которую говорили что два экземпляра виртуалок с одной ролью не оказывать на одном физическом сервере представим что серую равна с нею не табло и давай то есть корзина с байтами их несколько и хочется на самом между корзинами распределить чтобы скажем у меня три корзины да и 3 сервера с одинаковой роли я хочу что было по одному экземпляру на каждой корзину потому что там фазы электричество еще чего то это решаемо ли и то есть формализация задачи например так что нужно сервера в группу объединить группу на группу соответственно балансировку производить так ну этого нет джейке а какие перспективы мое желание понятно ну собственно да потому стойку целиком обслуживают понятно да сейчас такого нету но мы стараемся вообще на самом деле это вот первое первая версия которую нас завелась и общем проекту там совсем совсем немного времени работы ведутся добрый день спасибо за доклад меня андрей зовут вопрос у меня такой значит было сказано про хранение образов на распределенным хранилище при этом не было сказано про хранение самих дисков подразумевается что они тоже там хранятся и как несколько непонятно было сказано о распределении то есть одно дело образа да есть которых мы разворачиваем виртуальной машины другое дело их диски куда мы пишем они горячие данные как здесь это распределяется а это первая часть вопроса вторая часть вопроса мультипасс вы сказали что используйте избыточность 4 приходилось ли что-то допиливать чтобы это все работало или эдак . работа это хороший и я сразу несколько вопросов задам вот а потом может быть невозможность уже не предоставит дальше следующий вопрос вы сказали связь все ко всем в этой схеме всегда наступает момент когда мы уже не можем присоеденять дополнительные сервера потому что имеем проблему например с каналом или еще с чем-нибудь то есть когда сервис подразумевает связь все ко всем наступает такой момент когда вы это уже неэффективно просто общение слишком много оверхеды на общение между серверами просчитывали ли вы эту ситуацию и сколько разумно иметь реальных серверов и виртуальных серверов на них чтобы это все нормально работало окей смотрите системы следующие начнем с хранилища в текущем нашей поставки большой с полки счас просто экспортированное разделы вот и в кармане просто пробрасываю ца саше стандартным саше стандарты конфигурации проброс разделась материнской машины дорогой проброс идет всей полки сразу или для каждой виртуалки свой диск пробрасываем через мультипасс для каждой виртуалки по можно настроить проблем проброс собственного диска ну какой ей нужен и соответственно любого дополнительного раздела данность энергичных серверах естественно видны все эти разделах там очень много то есть у ты меня и не было времени нарисовать картинку с мониторинга но она была бы ужасной то есть каждый диск к консервы когда видит каждый раздел там реально много вот соответственно первый ответ и так понимаю далие что у нас было на помните да , приходилось приходилось увеличивать тайм-аут и буквально вот не шучу вчера у нас была демонстрация перед заказчиком всего этого дела и демонстрация отказоустойчивости очень быстро переросла в демонстрацию реализации плохая recovery после аварии мы это исправили эффект бывает до соответственно у нас до тюнинг поймал до 300 до 300 секунд ну соответственно понятно что за это на это время вся система залипнет да и возможно там через тридцать секунд она отлипнет если указанного включится к примеру так и что еще была на похода еще у меня возник один вопрос он тоже касается этой темы касательно дисков как вы решили проблему сплит brain of на уровне дисков имеется ввиду если у вас все сервера видят все диски каким образом избежать ситуации когда у нас потерялась сеть на какой-то виртуалке система считает ее может быть мертвый запускает другую в это время дисковые операции еще продолжаются мы пишем 2 виртуалок в один диск получается каша и смотрите собственная система машины арестом аутами она сделан для чего что мы не запустим виртуалку то есть с теми же самыми ресурсами да с диском например но тот момент пока не пройдет указанные тайм-аут сайт указанный тайм-аут она либо само по себе отключится либо будет и послан destroy она будет убита аварийно соответственно после этого по она поднимется и там понятно что она будет убита варин скорее что будет стимул смонтировано не важно важно то что все равно доступа из двух разных мест не будет а будет из одного нет ни делали здравствуйте меня зовут антон такой вопрос вы в начале презентации сказали что любви переписали а можно рассказать вкратце что и для чего мы не дописаны не переписали мы дописали собственно на основе либо сетевой сервис который ленку с библиотекой которая умеет соответственно точно его просто использовать ну да то есть это некая на этом глубокая настройка да ну пусть там были некоторые патчи потому что нам нужно было перетащить из грубо рейс какой версии не помню который с 14 ubuntu в 7 debian там были различия существенной папе на нужды учет делать вот седьмом доме не работает нормально не об этом речь да многие ко многим ситуации смотрите какая что конечно да это может быть проблемой но с другой стороны не имеет смысла делать квартир для миграции виртуальных машин больше чем не знаю там на несколько стоек реально тем более между двумя дата-центром потому что ну как тащить здоровенный образы чем задача не тривиальная и наверное не особо нужна и большинству скорее всего не нужно это задача решать ситуация когда у вас есть даже там не знаю 500 серого в 1000 серверов и все лишь на все матрица 1000 на 1000 есть у каждого клиента смысле у каждого сервер балансировщика там 1999 соединение со своими коллегами соответственно либо отлично работает там c25 к там c50 к проблем решает поэтому там даже 1000 соединяет не влез существенно сложностью нам наши рабочие решение которое мы сделали будем откровенны то соответственно 20 физиков и порядка 500 виртуалок мы представляем решение так случилось что у нас он был такой проект спасибо за доклад меня зовут сергей вопрос почему именно квн то есть к требования к системе я не увидел там какой-то дешевизны почему например не пролез клаус сторож который половину нужных вещей уже из коробки делают первый вопрос 2 достаточно ли пинка для определения живучесть и сервера потому что ну в общем запросто ситуация что сервер пингуется а кого им но не работает хороший вопрос я сотрите допрос третьей побольше как вы определяете что сервер забит то есть как вы определяете сколько потребляет одна виртуальная машина и сколько всего может потребить сервер значит за третье почему тогда начнем с просто с простого вопроса который на самом деле совсем не простой как выяснить что что ничего не умер у вообще говоря действительно большая проблема потому что сказать только на основе пинга ничего нельзя виртуалка может повиснуть или в ней может там не знаю не знаю форм бомбы запустится на сожрет все и все ресурсы при этом как бы тоже free bsd будет нагреваться до последнего ей в общем стерпеть системе будет не очень плохо от того что что-то не будет работать вообще можно чуть медленно это печать поэтому собственно что мы делаем на виртуальных машинах для linux мы сейчас готовим некий модуль ядра который будет отвечать по сети простейшими ответами что он живой и там ну да что он живой что у нее есть какой-то целую собственной системе запущенные процессы и списках совсем примитивные вещи которые не требуют амру китайца для изготовления там вполне себе пишется на себя в там месяц за месяц так точно вот соответственно дальнейшем будем это дело мониторить и бы уже смотреть на предмет того что там жила виртуалка или нет ни не только попытка ее пингануть а значит второй ответ про физический сервер и из история там то же самое да соответственно то что тот самый агентом будет точно также вести сидеть отвечать нам к порту про требуемые ресурсы сейчас это выглядит следующим образом что есть какое-то количество там чего-то измеримого ресурсы например из этом 4 замоченных там или там два замоченных интерфейса ethernet вот на них соответственно мы знаем сколько на них можно гонять там какой трафик по пакетам соответственно трафику в байтах да вот это измеряемая величина мы и прописываем как каждый сервер нас выглядит к книге продюсеру которой я n-нное количество предоставляемых ресурсов соответственно и ресурсы на описываем кладём на него конфигурацию он говорит о том что она у меня есть столько там чего-то из этом двадцать четыре ядра с таким количеством линуксоид попугаев к в которой он считает он производитель вот из них и virtual который потребляет все дела соответственно это концу мира их там больше существенное количество вот на всех вообще говорят базу муж tender сделать а потом попадать энписи запросы бампере configure вот там если вы конечно можете сказать то это будет естественно хвостом или ну понятно что это решение просто для демонстрации того что можно и и в общем без внешней базы работать вот тогда соответственно накажешь сервис вам придется прийти залить конфигурацию этой сделке действия при большом количестве of это не очень разумно так что назад чтобы а почему квн ну заказчик захотел так получилось потом выяснилось что идея вообще не плохая она и собственно самого интегратора прекрасно прижилась потому что он есть а громкость разработчиков приходит-уходит проекты за начинают закачивается каждому нельзя выделить все потому что всех много всего молода и вот соответственно нужно каким-то образом балансировать все дело если кто-то сейчас не работает то можно общем-то и отключить а потом запустим она никуда не пристроиться и будет работать человек не будет ждать в очереди там своих ресурсов у нас была такая задача вот так вышло но мы ничего не делали с сеном от нас была вот такая вот штука тем более что нам нужен был overhead по памяти ну возможность аверса его ресурсов соответствия как все ну вот не очень как вот еще вот вы боретесь например там например виртуалка с мускулом там или 40 ломали еще с какой-то базой как вы боретесь с тем что у вас может разрушиться база при миграции например у вас какие-то агенты для вас есть или что какого плевать миграция очень базы не разрушается то есть не было такого что разрушение мир скопится и понятно на некоторое время там донос топится синхронно они так что где-то уже запустилась а тут еще работает вот при собственно этот штатные штатные миграции осуществляется обычным штатным методами миграции давать миграцию если у нас произошла кто-то подошел катастрофа с выключением неожиданным то ну что тут поделать и как бы соответственно жизнь не удалась и нам нужно хоть как-то запустить эту самую машину где то в другом месте то есть обычный режим работает вообще на самом деле энное количество включенных серверов в которых если для их монтэйн из и нужно сменить там вы их выключить соответственно виртуалке мигрирует а потом перестреляете между живыми серверами и там до сих пор пока собственно кто кто-то не выключится говори на тогда соответственно но ждем это самый тайм-аут и приподнимаюсь то есть у вас дублирование или какого-то резервирования именно вот информации которая находится в памяти его нет то есть нет эта вся история ровно для того чтобы таскать за дешево виртуальной машины с к сену вы не не экспериментировали на нет ни экспериментировали я думаю что это вопрос никого будущего ну возможно не очень отдалённого можете поделиться опытом работы сети с кого вы используете ver 3 одр и сетевые драйвера так и как они стабильно работают с какие какие версии работают стабильно потому понятно понятно с моим опытом все очень плохо сетевые карты отваливаются либо multicast какой то теряется перестает ходить вот какие версии работают понятно общем смотрите какое дело у нас совсем недавно нас посетил а чудо вышла 14 ubuntu lts вот мы заорали ура и стали мигрировать на нее в общем если честно я ничего не работает вообще вот ну то есть я никогда не видел чтобы ничего работала вот но тут действительно без шуток все очень плохо соответственно мы взяли либерт с 14 этаж там api нормально было для миграции по сети и соответственно перетащили с патчами 7 такой короче визи и в 1204 какая-то версия можно посмотреть час не знаю наизусть и опять asus точность до версии не помню но штатное короче переделок нет вот там более-менее работает может быть 14 допилят но я читал списки рассылки и там вообще претензий существенные по ядру и и в общем то все тяжкое ужасно и нужно и как анкерного хакера вызвать спросить зачем они сделали такое ядро и спросите мой тренер футбол то зачем они взяли понятно там длинная с поддержкой но уж больно глючно дрозд такой вопрос скажите вы в liberty использовать дома настройки что шума нет his head space нет она не давала никакой производительности или просто как вот так олег олег олега косметики омске илья рассказывал про херш п джаз и прочее прочее с поясом вот что все это хорошо и здорово но у нас просто не было такой задачи вообще открою секрет что у нас сложнее мой сколь и там ничего не жило вот сам всем аскольд в таком режиме работы великолепные замечательно вот с миграциями проблем нету про возраста его либо в пишут хершко джаз я ничего сказать не могу спасибо а ну смотрите на самом деле на гитхабе сейчас про язык идет процесс выходки всего этого дела в то есть виде сборки виде на нормально у кого-то есть нормальных вменяемых пакетов они чего-то видя того что там кто-то что-то написал кое-как прикрутили потом соответственно гитхабе мы сделаем проект но и я не знаю там может быть будем поговорить о предмет того чтобы он сказал в рассылке об этом куб новость написав вот как бы сейчас действительно посмотреть вот прямо затихнуть на git хоп никуда это исправимо это в скором времени будет исправлено массивы заклад меня зовут сергей а вот как вашей системе сложно положительными срабатывания my перебалансировки то есть не бывает такого что случайно из-за ошибки вы начали перебалансирована мне за до того как сработал таймер то есть на сколько надо точно вот эти таймер и настраивать потому что это же перебалансировка всего на 3 конфигурация вычитывается из единого места вот и соответственно даже не так конфигурация до вычитается из единого места из базы мастер после этого говорит каждому слою что нужно как сделать соответственно такая ситуация возможна когда мы потеряли мастер сделали балансировку и в этот момент у нас карта распределения упала вообще это сложно такое представить да да честно у нас нет двойного комета сети поэтому теоретически во времена был бы перевыборов мастеру на начавшийся перебалансировка стала местом может там иметь какие-то проблем вот эта печаль не конечно да но вероятность это не очень велика не рассматривали возможность в общем-то централизованная система не когда все ко всем сервера может быть дублированного и обеспечения надежности доставки вот сетевыми средств ну там в резервные линки там я не знаю ну понял мы думали над этим но мы решили что будет идеологически более правильно написать распределенной системы с перевыборами и исправить эти ошибки да вот отсутствие двойной фиксации да там чтобы все четко было везде когерентные данные чем мы делать систему которая заведомо хуже даже с дублировали потому что как бы ситуация когда у вас происходит блокаут потом все падает и самый неприятный момент вы выясняете два мастера вы поднять не может тебя других у вас нету это вот неприемлем совсем они бывают такой ситуации когда в общем-то вас две половины одни один сервер 1 половины видит 50 процентов и вторая тоже не видит и как бы никто не может поднять дело все в том что 3 всегда выполняется требование 50 процентов плюс один то есть если у вас меньше трех машин делать наверное вам систему поднимать не стоит на три части не может разбиться жевательные sonar забьешь на три части то да это будет полная авария потому что все три части рискну рубля 3 сервера без и передним пылинки между ними все порушить там сетку выключить то да не про штаты за shadow нет виртуалке какие-то требования к сетевой инфраструктуре вот для того чтобы работал эта система нормально есть или камни у нас стоит обычные какие там linksys 500 не помню и не шо вот это cisco сколько очень бортовая вот и за байден и по 2 гигабит на интерфейс есть это обычно короче это обычная supermicro и обычная дешевая аллен сербская сверху cisco соответственно внизу у нас тут стандарт эта фигура ция это 40-ю не то вот это вот стойка до сверху cisco по 10 юнитов счастлив по действия для юных машин и мне у соответственно 3 полки но совсем вот этими делами будет в середине болтаются сад концентратора спасибо здрасте спасибо за доклад меня зовут станислав подскажите пожалуйста заинтересовал вопрос необычной скорее для оксаны к вам отдают live migration которая по сути и ну я не знаю сейчас решение для этого как примеру у нас есть база данных 80 гигов да нам нужно снять текущей state с процессоров да и память скопировать как это будет производиться это будет производиться через api ливер то вот производиться будет долго до докачка дельты а потом соответственно рестарта это просто мы сами чем дело и мы вызываем функцию api а то есть это уже готова то что это только ливер изо льда и ясно хорошо спасибо да конечно если у вас 8 гигабайт оперативки до спешно примерно искали сервера вы с объёмом оперативки там по 100 гигабайт на каждую машину вот их там на наших серверах нам по три штуки живет вот из мы хотим плуга что-то выключить то дамир там останавливается очень надолго и мы мигрируем как довольно большое время учитывая что как бы да и там есть 10 гигабит которых понятно к скорость максимальная до прокачки есть соответственно что мы тут имеем не знаю 80-ом 100 гигабайт оперативки очевидно что поделив одном другом получим большое время ну что делать так можно еще вопрос вы сказали что у вас решение с одним коммутатором интерфейсе в баден гера с одним коммутатором с двумя с двумя для резерва да но 4 то есть в стандартных супер микки которую ты нас это используется 5 интерфейсов один кого и пик в вот и 4 гигабитных соответственно там интерскол мне важно соответственно не обойдена по 2 и вот нет и разные физически как он коммутаторы у них там две штуки коммутаторов стоя отказоустойчивость на чем основаны то есть если один коммутатор а каждый каждому погасить его один коммутатор учетом ничего не будет ещё такой вопрос я знаю были про попытки написать фотограф решение на основе к в м они почему-то заглохли знаете какая там ситуация честно говоря не знаю вот не могу дать темы чат ведь потому что вообще говоря не чёрный хакер я архитектор проекта и занимался сильно архитектурой юзер space ape чтобы она не падала чтобы на линке поднимала у нас и специально обученный человек жаль что он сегодня прошли смог присутствовать которая действительно занимался допиливание мм liberta ну как бы если тема действительно будет интересно если олегу не но это понравится мы можем там незнакомки вебинаре больше рассказать чем мы делали как у пилили и какие патчи были именно в liberty скажу заранее был не очень много еще такой момент раз речь зашла о большое количестве большом количестве оперативной памяти на виртуальную машину и алгоритм автоматической life миграции то как мне кажется с большими объемами памяти гораздо безопаснее и проще и уж точно быстрее погасить виртуальные машины поднятию заново чем с мигрировать если там объём оперативной памяти на виртуальную машину начинает станут 8 может быть гигабайт и думали ли вы об этом вот смотрите есть рпц у нас обычный джейсон апельсин как сама летописей только попроще вот соответственно заходим посылаем за заявку чтобы выключить эту виртуалку соответственно не балансировать ее на этот хвост поставить флажок что там все ресурсы дополнительные чтобы машина заблокировать не сможет потом ребаланс соответствует поднимется с этим проблем нету мы просто этим не занимались то есть нет ушей не занимались конечно тестов занимались но вот у нас реально и боевое использование это медленно печальная миграция этих больших данных тоже как бы выключение происходит нечасто и как правило только maintenance то мне не очень важно вот если вы действительно хотите быстро зашагал них машину с очень большим потребляемым ресурсами туда и лучше гасить вот ну и кроме всего прочего понятно что тот же майской при таком количестве отданной памяти сбрасывается при гашении сбрасыванию буфера очень очень долго"
}