{
  "video_id": "ppI74hTuXO0",
  "channel": "HighLoadChannel",
  "title": "MySQL Replication — Advanced Features / Петр Зайцев (Percona)",
  "views": 2280,
  "duration": 2949,
  "published": "2018-08-16T04:02:26-07:00",
  "text": "на что мы с вами поговорим про майскую или репликацию кто-нибудь использует москаль здесь ух ты отлично значит народ не спит это просто великолепно то нас же некоторые же тут смотрю пообедали вкусно думаю сейчас пришли тут поспать немножко вот значит о чем поговорим значит я сделал такой небольшой introduction про вообще репликацию и высокую доступность потом мы немножко поговорим о том вообще истории рубрикации в морской ну и наконец самое главное самое интересное о том какие у нас есть продвинутые фичи вот ну вообще если мы говорим в общем про репликацию наверно всем понятно да репликация то что у нас есть несколько api данных которые собственно говоря автоматически подержится между ними синхронизации если мы модифицируем наши основные данные то реплики тоже модифицируются на самом деле репликации используются очень широко в приложением потому что нам позволяет обеспечить доступность производительность и масштабируемость вот но может оберемся это понятно да что мы можем обеспечить да то что у нас сервис наше приложение а она продолжает работать даже есть у нас какой-то компонент например сервер у нас ломается обычно у нас как достигается высокая доступность то что у нас есть какое-то дублирование в системе правильно же да то что у нас есть несколько ресурсов что каждый один из которых может перестать работать но при этом у нас до приложения систему не не страдает даже есть у нас система осталась ну например веб-сервера ту на самом деле вот этого 3 данность это всего что нам хватает да то есть если мы взяли подняли десяток веб-серверов перед ними лот балансер один из них сдох вообще никто ничего не заметил но к сожалению для вот наших любимых или не очень баз данных этого этого недостаточно потому что в базах данных есть этот гадкий state да собственно говоря с вами все эти данные в базе данных поэтому для баз данных нам нужен с одной стороны чтобы нас был был вот этот вот сам сервер дата мой кот был дублирован и с другой стороны что у нас были какие-то данные до тоже тоже реплицировали вот ну и на самом деле что еще очень интересно когда мы говорим про все эти наши наши сбои да то имеет смысл на самом деле смотреть на них в плане двух таких больших групп на там с одной стороны это то что у нас сбои который связан непосредственно с сервером или процессом да там и те которые у нас связаны с с боями сети да там которую тоже бывают много их их разные вот обычно на самом деле вот вторые до разные проблемы с сетью это то из чего очень часто вырастают много проблем потому что если у нас ну сервера умирают там все достаточно просто дата сбои в сети они бывают очень многих разных видов бывают скажем там асимметричное так далее вот мы говорили про масштабируемость до что у нас тут дает репликация но репликация нам сама по себе она очень хорошо позволяет снизить наши чтение но почему да потому что у нас тут есть несколько реплик значит мы можем чтение направить на на реплики но само по себе репликация записи съедет не очень хорошо потому что записи те же самые нужно применять ко всем репликам поэтому если мы хотим скерритт на мне точно это не только чтение но и запись тут обычно репликация используются в вместе с еще чем и каким-то распределением данных да то есть например в mais quel чаще всего наверное это используется два раза процесса да есть что достаточно простой можем взять данные разделить их на на не знаю на два сервера например мухи отдельно котлеты отдельно да там и хранить их таким образом но для больших систем все используют такую технологию как sharding да там где мы просто наши данные скажу так нарезаем по полю земли бы по-другому аккаунта ключу и храним а отдельно следующий момент по производительность да вот вопрос как репликация нам позволяет увеличить производительность но на самом деле есть несколько здесь та та же пара вещей важно во-первых репликация нам позволяет часто данные хранить ближе к пользователю но например я вот знаю что многие крупные ресурсы они делают репликацию между разными дата центрами соответственно а у нас мы можем сделать дата-центр которые находятся ближе к пользователю и оттуда данные читать и выдавать нам властью совершенно но значительно быстрее нежели чем с какого-то другого то центра но еще что важного а что репликация час она позволяет увеличить производительность просто потому что мы не перегружаем сервера да то есть мы можем вместо что с один сервер который сильно перегружен запросы мы их распределяем на несколько из-за этого производительность у нас понятное дело может расти но теперь про mais quel и значит истории репликации войска или скажем так вот в одном слайде то есть майской репликация появилась мой сколь очень давно с майской 323 кто-нибудь использовал морской 323 здесь ну что господа аплодисменты нашим героем которые используют mais quel с 323 это вообще можно сказать давно было начиналось вот там репликация появилась на как мы видим во многих со следующих версиях она улучшалась в майской 40 репликацию москаль было разделено на но житель на классические два потока который вы знаете один из которых скулит данные локально на серию другой их применяет до что получает и повысить производительность и позволяет нам уменьшить потери данных если у нас мастер ломается в москве 51 было добавлено ролл репликация к стандартной майского или statement репликация которая была давно и в майской 56 был добавлена поддержка джи ти ай ди и так же базовой такой параллельной репликации ну и в майскую 57 это последняя скажем так стабильная версия на текущий момент там было была улучшена параллельная репликация у нас появилась у нас есть мало десерт applications у нас есть такая технология групп люблю кейн там появилась в общем просто показать что технология активно развивается ну и на самом деле в особенно учитывая то что многие годы в маску или было только синхронная репликация да там со своими ограничениями еще за последние но наверное лет восемь было развивалась другая технология которая называется под названием галера которая но на самом деле близко к групп публикация да там это что-то вроде синхронно репликации который сейчас тоже доступно в мае скальпер конная и марии де беда-то новой сколь виде некоторых таких по очень то есть не в самом москаль комьюнити решим вот про беркана x-tribe кластере вообще говорить не буду поскольку это нужен отдельный большой разговор но если вам интересно репликации вы тоже можете вот технологию посмотреть вот репликация в мои деби до что про мари тебе часто слышно что это база данных которая так сильно совместима с майской следует качество репликация это та область которая она с моей сколь сильно несовместимо то есть грубо говоря начиная с версии 55 репликации мария тебе идет своим своим путем то есть например жить иди в марии тебе репликации совсем другая параллельно репликация сделано по-другому там instrumentation сделано по другому то есть например performance схем и таблиц нет таких и так далее это не значит что она там хуже но на самом деле многие фичи например как репликации из многих источников да там или параллельной репликации они появились мой спойлера в моей baby раньше да но просто они на текущем этапе там реализованы реализовано бы сильно сильно по другому то есть марии 2 мы в этой презентации покрывать не будем ok значит продвинутый фичи в майскую войска репликация но давайте сначала тогда определим что же все таки у нас будет это вот базовая репликация какие у нас критерии наиболее типичные майскую репликация тогда мы используем statement репликацию мы реплицирует полную базу данных используем для этого нельзя te odio наши стандартные простые мелок позиции у нас репликация простая да там в один поток то есть мастер и несколько сливов мы не используем параллельную репликацию используя нашу стандартную а синхронную репликацию пишем на только на мастер и соответственно еще пар критериев если вы что-нибудь из этого не делаете значит мы будем говорить что вас репликация несколько менее типичная это кажется что это много критериев и нам на самом деле я бы сказал что как минимум 90 процентов инсталляции и инсталляция морской они наверно его входит в эту категорию типа репликации мой скальп поддерживает за три типа репликации с точки зрения что ставок представляют ивенты который регулируется с вот эти вот самым белок формат есть statement который реплицирует собственно говоря сами стоит ну тогда как апдейт и так далее есть роу в которой собственно говоря реплицируются изменение строчек до что вот мы эту строчку в такой таблички заменяем на вот эту строчку и есть еще такой микс формат который говорит ну ты используя statement но для некоторых случаев когда statement не работа не позволяет реплицировать нормально тогда используя ролью репликацию кто не может прости пример в каком случае у нас репликации не может работать корректно statement формате а автоинкремент кстати работает но если авт инкремент лак и использовать простой там каскан корицы проблема да но неделями термины и функции там типа ее айди и так далее да там если мы сконфигурировали роль репликации то на перед нами встает следующий вопрос что мы хотим чтобы она сохранилась в этих самых строчках вот и по умолчанию репликация хранит полностью строчку до что очень хорошо у нас хранится то что называется be for image а вторым ожидать для каждого для для каждой строчки это очень классно у нас много информации там есть его можно там легко как синтетика пч использовать да там из него можно сделать стрим цен для кафки для чего угодно вот но при этом он получается большой толстый то есть мы можем гинер чем много вот этих вот on the event of особенно если у вас есть большие строчки в которых мы например и модифицируем всего лишь одну колонку на там конь контуры лишь в этом роде тогда 2 есть вариант мы можем хранить минимум формат минимум формат хранить только первичный ключ и колонку которая который меняется да в этом случае мы значительно можем сэкономить до сэкономить место но и третий вариант который у нас есть это но углом называется который нам позволяет хранить все строчки но кроме блобов главы предлагается что это то что у нас большое толстая и есть уж сокращать место которое мы храним то проще всего это делать не храня блогу если они не модифицированы одна из проблем у которой если людей сыров репликейт это ее trouble shooting да то есть вот я смотрю у меня на слове теперь показывается что вот блин у меня вместо того чтобы нам сказал что вот такой то запрос прошел не проходит нам тире какой-то момент с такой ошибкой честен делать в mais quel есть опция берлога актеры logevent в этом случае она будет также сохранять информацию в бинаре логе о непосредственно запросах котором эти binary logevent соответствует что опять-таки нам увеличивает место которое тратится в берлоге но она позволяет более удобно и вот рыба шутить по умолчанию эта штука выключена ну опять-таки следующий момент репликация всей базы данных до наиболее простое решение это когда мы реплицирует всю базу данных с одного мастера на несколько слоев и так далее но это необязательно mais quel делать мы можем отфильтровать и реплицировать только порции на на базе порцию до базы данных и второй вариант мы можем еще на сервера добавлять какие-нибудь дополнительные данные да то есть не то что вот у нас есть семена него ну никак к писать нельзя например а некоторые люди это используют как и и тел да там они берут слева чем писать пишут как бы там и прямо на него читают прямо него пишут у нас появляются дополнительные какие-нибудь данные а дальше с этого и тел славе мы можем это еще от реплицировать например дополнительно какие-то другие базы данных другие сервера что у нас касается с фильтра с фильтрации фильтрация у нас происходит двумя способами значит мы можем фильтровать что мы пишем в бинарный лоб дать им через белок дуди билибин ног и игнор тебе на самом деле это на мой взгляд плохая идея этом потому что binary лук у нас используется не только для репликации но он используется еще и для восстановление из бака по датам понятым recovery да там поэтому эти функции только имеет смысл если у вас есть какая-нибудь не знаю там временная база данных которую не только реплицировать не надо точно на ее никогда вам из баков и восстанавливать не потребуется иначе имеет смысл использовать фильтр фильтрацию на нас лайве где можем использовать похожие опции реплики иду себе репликейт игнор деби и вот эти две которые позволяют это делать на уровне на уровне таблиц да там задают regular expression ну типа regular успешно для таблиц вот а что следует сказать что этот репликейт у биби и и репликейт игнор деби дата они особенно лики достаточно гадки опции потому что они у них эффект разные для statement и statement формата и raw формата и в особенности для statement формата он особенно гадкий потому что он смотрит не на собственно ту таблицу которую модифицируете она текущую базы данных которые вы используете поэтому вот это вот опции на мой взгляд которые особенно statement ловил репликации они создают очень часто людям проблемы то там потому что настроили что вот реплицировать например только эту базу данных кто-нибудь сделал юз другую базу данных модифицировал таблички в этой базе данных изменение были от реплицировали так как у нас реплицируется позиция позицию на сможет реплицироваться по позиции в бинарном логе когда у нас есть просто лоб и позиция либо могут идентифицировать вот по такому страшному и ужасному детей де вот что же у нас такой вот этот же те иди и страшно и ужасно на самом деле дети ади представляет собой источник и транзакция беда там где просто аккаунта сколько у нас транзакции было вот source один это большому счету и и аде сервера когда вы создали запускаете майскую сервер он все создает сам и иди который хранится в директорию баз данных тор и уникальный и который не нужно устанавливать ручками как наш вот как сервер 1 вот что важно что вот этот вот транзакций найди он всегда с этой транзакции будет сохранена на всех словах то есть транзакции к ней всегда привязан люди которые никогда не меняются вот и это нам позволяет на на словах отслеживать транзакции которые у нас были выполнены каждый сервер он каждый слой точнее он сохраняет какие транзакции он уже выполнил вот такого таблички mais que je ti & decker плюс в обе ноги и это значит нам дает некоторые бенефиты / аки с точки зрения бенефиты мы можем автоматически указывать позицию то есть нам не нужно теперь помнить какие у нас были координаты можно сказать просто слушай найдет позицию с которой тебе нужно реплицировать это позволяет тоже сделать более простую sleeve промоушен да то есть у нас был слоев мастер умер мы хотим за проводит slave у него будет уже другие координаты в его бинарных логов да потому что ну а не с позиции файлах они не обязательно будут совпадать вот и также нам позволяет легко определить если какие-то транзакции были какой-то причине пропущены поскольку каждый каждый слой знает что он какие он транзакции выполнил если какой-то причине некоторые транзакции не были выполнены были потеряны дата может сложной топологии репликации то это будет сразу видно на самом деле при этом с ним тоже tribal шутим дело достаточно тяжело то есть например если кто-то чинил майскую репликацию через sql slave скидка under дата такой подход не работает жить ради да там там это все нужно делать куда более сложно пологи войсковой на самом деле поддерживает сейчас совершенно произвольной топологии да там то есть можем описать в грубо говоря любой граф с как бы с направленными ребрами да там построить репликацию где все совсем как то хитро реплицируются и что есть опять таки классно жить едем и даже если мы сделаем какую-нибудь такой очень сложный граф в котором есть множество путей мы всегда можем поскольку мы знаем уже какие транзакции мы выполнены мы можем легко скипать те транзакции которая нам приходит через два пути он перейти мы сделаем кольцо и еще в центре один сервис который реплицируются со всех серверов да там на него она не то что рекомендую такую топологию да но если мы это вдруг сделаем на него будет приходить кучу транзакции нос времени будет работать правильно потому что он будет применять одну транзакцию только только один раз вот значит что здесь важно если вы используете какие-то сложные топологии то нужно использовать такую опцию лог слева blades на этом чтобы slave он не только применял транзакция но и а сохранял их тоже локально что можно было с него реплицировать дамой сколь 8 эта опция выключена по умолчанию в моей сколь 8 она будет включена параллельная репликация значит майской многие многие годы было репликация в один поток и очень часто это было на самом деле ограничением производительности то есть мы могли написать на на мастер значительно больше данных да там чем мы могли реплицировать нормально нас life соответственно репликация теперь mais quel есть параллельно она делается либо параллельно на уровне разных баз данных случае 56 либо в москве 57 и на общие параллели application data что есть у нас есть одна таблица которая очень горячим не идет постоянно куча каких-то там модификации то это можно сделать будет параллельно как мы можем управлять параллельной репликации вот наиболее важные опции 1 до сих пор вел works который нам говорит сколько потоков нам использовать да там по умолчанию понятно один не параллельны репликация там 48 до там сколько нам нужно повелел слои впарил all type указывает какой тип параллельности использовать дайте bass это то что использовала 56 на там по умолчанию каждая база данных как бы реплицируется параллельно вот либо logic хлоп название такое как бы сложная но на самом деле это говорит просто что реплицирует новая в новом режиме в майскую 57 где на самом деле используется информация о группками то есть если транзакции на мастере были закончены в группками значит их можно использовать параллельно на сливе следующий момент это призер в коми ул при зернышками url это нам говорит нужно ли при параллельной репликации обязательно гарантировать commit транзакции в нужном порядке по умолчанию это выключено это значит то что в принципе могут быть некоторые периоды времени когда ваш slave находится в таком стоите когда в котором мастер никогда не был потому что нем какие-то транзакции были закончены за конечно раньше вот но это можно включить сливками тоже равно 1 тогда у нас такого не будет репликации в mais quel она у нас асинхронная да там по умолчанию причем нет никакой гарантии гарантируя насколько быстро будет репликация проходить на slave у нас можно сделать число и будет уставать на несколько миллисекунд секунд минут дней часов до там это уж как как вы сделать но при этом mais quel также имеет поддержку для 7 missing 1 рубль и кейша на которой поговорю и майское группы вeликaя над которой новая фича но вообще говоря про репликацию можно говорить двух видов дата нас есть синхронно репликации и асинхронной репликации две вот таких больших подхода в случае когда у нас синхронно репликация значит когда мы делаем запись на мастер у нас данные сразу же реплицируются на слои бы когда у нас операция успешно заканчиваться на мастере у нас дана уже на слои велено нескольких уже они туда от реплицировали это конечно классно но это дорого да там потому и особенность у нас слои где-то там далеко далеко находится и что там коем случае классно то что у нас во первых гарантируется что нету потерь никаких данных есть у нас мастер умер ну и если мы пишем на несколько серверов одновременно то случай синхронную репликацию нас конфликтов как бы и их легко избежать да там потому что данные у нас сразу реплицируется вот и там можно использовать стандартные блокировки и так далее вот следующего вот что сказать когда мы говорим про данные мы часто говорю ну ты там рассмотрим модели consistent насти мы говорим о такой вещи насколько как данный у нас сохраняется до то есть если я вот записал данные на мастер что с ними будет данном случае сбоев с точки зрения durability 1 а просто durability да это значит если я записал записал данные а что с ним будет второй вопрос это как как у нас происходит видимость вот этих вот данная которую нас появляется вот что означает сохранение данных но на самом деле здесь тоже можно посмотреть несколько разных моделей до одно это что у нас данные хранятся если не на сохраняются в памяти это значит что в случае если у нас пропадает это не дата у нас данные будут потеряны или 2 это на диске да они сохраняются какого-то райта hotlog да там типичное есть у нас даже тип питание пропала то она ничего страшного не произошло то есть интересного это как это играет с репликации потому что например для многих системы можем говорить как все на самом деле есть у нас есть кластер то нам не нужно сохранять данных мир локально на диске какая в sing потому что мы их уже куда-то от реплицировали например синхронной рубрикации да там и в этом случае если у нас наш наша но доу упал а то ничего страшного но тогда возникает проблем в мире если весь кластер потерял питание данные могут быть потеряны да то есть вот эти вот все модели persistent да они очень сильно их нужно рассматривать совокупности с теми какие вы рассматриваете да и какой в этом случае поведение вы хотите что у вас было что нас касается а синхронная репликация ну здесь все просто до что все что у нас не синхронно на самом деле относится классу асинхронной репликации здесь очень много разных вариантов ну например что у нас происходит в случае к к митино мастер с точки зрения персистенция и вы заберёте вот ну и здесь есть скажем так определенные варианты до который у нас есть точки зрения как persistent так и и и заберите я смотрю что много говорю у меня со слайдов много так что я то что не сильно важно и быстро прокручиваю а но что здесь важно что у нас есть mais quel да там если пропустить всю эту теорию в москве есть еще поддержка 7 и синтез рубрикация где мы можем поставить плагин который мы постоянно мастере и и слове которая нам будет давать такой вид репликации асинхронной репликации до которая называется всеми sin carne их что она грубо говоря дает она нам дает то что когда мы записываем данные на мастер то данные будут реплицировали на slave и там сохранены в relay лак это гарантируется но это не не гарантируется что они там сразу будут уже отобраны базы данных потому что это было бы синхронно уже рубрикация и что нам это дает это дает с тем то что теперь есть у нас мастер умер то мы можем подождать пока у нас slave все свои дела и логе догонит да там скорее всего пара секунд устает да вот и после этого на него можем сделать файлов без потери данных то есть то есть идея данном случае такая вот как как это у нас настраивается мы на мастере включаемся missing репликацию мы настраиваем тайм-аут здесь интересно что у морской особенность что мы часто ее настраиваем так что если у нас мы не не подтверждаем ни одного из сливов на там либо слои вы перегружены либо там они у нас все умерли то мы не хотим блокировать наше приложение вечно мы можем сказать окей тогда переходи в режимах в режим ну в режим асинхронной репликации для этого там изменяются соответственно статус вы рей был то есть мы можем можем такие ленты треков вот но он продолжит продолжить работать не будет заблокирован до там есть у нас все missing репликации какой то смысле быстро не отвечает следующая интересная штука да когда нам нужно собственно говоря ждать от цвета от слова ответ есть 2 опции это авто senki off to commit дата на самом деле разница в чем что в одном случае мы делаем ожидания до того как мой за комитете логично это логически транзакцию мы ждем ответа в другом после того как мы ее уже за засим коляда там вы надели транзак шалога и и так далее 1 на скажем так несколько быстрее на там есть такой тонкий момент что у нас могут быть данные быть от реплицировали нас life когда они еще не пирсе стыдно мастера и если мы и получается что если мастер упадет в какую-то вот конкретно тонкое время у нас могут быть данные которые нас слева от реплицировали даттама на мастере их нет ну то есть такая маленькая тонкость то есть вот так вот но и на сливе самое главное нужно просто 370 комплектацию включить если вы этим хотите используется следующий момент куда мы хотите хотим писать писать можно нас либо на один мастер либо на несколько в master of понятно да случае нас если мы пишем один мастер то у нас все как бы хорошо у нас рубрике шин стрим идет в одну сторону это все просто у нас нету конфликтов и так далее это как мы большинство mais quel используется другой вариант это если у нас используется как бы а актив пассив мать мастер до что это означает и мы говорим о кей мы на самом деле взяли два сервера мы их сконфигурировали чтобы они могли писать друг на другу то то есть формально у нас поток данных и это обе стороны но мы пишем только на один сервер другой при этом участие включаем в режим как бы там тоже там в редон лида чтобы на него случайно кто-нибудь не записала и даже супер readonly что доступно в современное в новых версиях вот ну и на самом деле если на правильность конфигурирование то же самое получается сингл мастера просто нам файлов значительно проще да то есть у нас directory критично идет то значит мы файла вы просто мы говорим что мы решили перенести на мастера от цвета выстирано этот нам сервера не кемпери конфигурировать не надо ну и опять-таки если это скан фигуру неправильно если у вас иногда приложение пишет на неправильный сервер то это может быть кучу проблем да там консистентной данных нарушается и потом разбираться почему у нас друг данные на разных серверах разные очень неприятно мы также можем писать нам на множество мастеров и это асинхронной репликации сложно потому что у нас есть вероятность вероятность конфликтов вот и это как бы проблемы но на самом деле если мы используем асинхронная ли 7 синхронную репликацию то это достаточно достаточно проблемный подход некоторых случаях люди ты все равно использует потому что это нужно по производительности причина еще каким то в этом случае нужно по очень правильно дизайне приложение например чтобы она описала не знаю во дни базы данных на одном сервере в другие базы данных на другом сервере да еще и в этом роде тогда это может заставить работать но часто потом у них не знаю там со временем давала применяются и перешел в этом роде да и приводит к каким-то проблемам ну либо если мы используемой сколь группы людей шин или пикси да там мальте мастера нормально потому что она используется другой режим репликации которые конфликт и предотвращает если все-таки хотите использовать на мальте мастер войска из охраной в репликации вам имеет смысл обратить внимание на сайте вот три опции auto increment of city of the crime инкремент на чтобы у нас не было конфликтов по а автоинкремент значениям ну и еще есть такая вот интересная штука славик зик mode эдем патент это означает что есть у нас произошли происходят какие-то конфликты по данным до чтобы оно могло не не давала ошибку говорить ай ёлка уже эти данные есть да уже кто-то этот эту строчку уже изменил а все-таки могла реплицировать как бы данные данные поверх опять-таки скажу что это вам не гарантирует что проблем с такой репликацию вас не будет это просто позволит таких проблем было меньше вот следующий момент такое что есть настройки разные где у нас будет храниться информация о позиции которая может храниться в масть у нас в табличке либо на файлах причем мы тоже можем еще сконфигурировать syncmaster инфо rising релог здесь я только одну вещь которая важно если вы хотите чтобы у вас был краж slave с а если да то есть если вы это питание слои вырубил потом включил обратно чтобы он восстановился и сам побежал дальше работать мастера вам нужно включить relay logo repository в табличку и relay лагай каверы вот эти вот две опции да там наиболее наиболее важно ну и тоже используете эти репликацию часто хорошо в этом случае там уж создает меньше проблем вот кроме майское репликации как я уже упоминал у нас есть еще рубрикация начиная с москвой по темну и для нее есть типы пиксель и галера репликации которая достаточно близко я альтернатива что у нас такая группа публикация на самом деле рубрикация появилась позже чем галеры вот и и ребята горок ли сделали потому что вы дели что людям очень нравится но для ряда приложений вот этот вот гомеровский подход да там более-менее синхронно репликации поэтому они сделали похожую на технологию она доступна как плагин в майскую 57 и сейчас она считается джей но на самом деле еще такой ранний джейда там то есть там еще много что нужно ценить что здесь интересно что в ней нету о к концепту мастер slave у нас есть просто группа и в этой группе данные реплицируются между всеми серверами да то есть кого такой концерт в принципе можно сконфигурировать что можно писать на любой сервер но по умолчанию она делать таком случае что у нас один сервер у нас он райтер на которой писать можно до остальные они как readonly слева вот ну и там есть тоже концепты концепт-кар ума да то в отличие от репликации которая может распадаться зам есть у нас нет связи между master in словам слоев будет жить счастливо совершенно просто на него данные не будут поступать новые здесь пользуется конце концепт кворума то есть если у вас был кластер из пяти нот например две из них отвалились да там потому что нет сетевой сетевой связи то эти ноты они скажут всё мои запись принимать там принимать не будет ну и и так далее да там а что еще есть интересно что здесь есть концепт flow control да то есть в отличие от репликации где мы можем реке черлак может быть сколько угодно здесь есть конце flow control то есть мы можем сказать что отставая пожалуйста не больше чем не знаю на 100000 транзакций или там или на 10 и если у нас будет а отставание слишком большое то тогда слайд как у скажет и ребят подождите не так быстро я не успеваю ну и идея тоже кластер такая что есть у нас но вот какой то определил что у него проблемы с консистентной он покидает покидает класс так вот по умолчанию искал группы или кейша нас все записи идут на на 10 но он может быть тоже сконфигурирован чтобы писать можно было где угодно вот у группы репликации на текущий момент есть достаточно много еще ограничений например это пролежит не встроен да то есть нам нужно каким-то образом не знаю там клонировать или установить из бака потом для того чтобы сюда 5 новых членов этой группы если ноды у нас сломались до баку этой причине их нужно устанавливать вручную для тоже это не не автоматизирована как пикси пока ну и есть ряд других ограничений другой термин который вы могли слышать это майскую ли на деви кластер который нам скажем так позволяет и он интегрирует майской группы вечно с некоторыми тут узами для для менеджмента да там и для трафик раутера большому счету все это базируется на та же самая технология крупы british встречи вопрос про репликация да то есть это как что мы делаем если у нас мастер падает или же как мы управляем трафику даже чтобы что нам послать на мастер что нам послать нас на след с точки зрения failover м и чай майский хеллоуин арки стрейкер это вот те я бы сказал три инструмента на который имеет смысл обратить внимание арки стрейкер наверное с точки зрения комьюнити там где вот сейчас наиболее такой интересный truction то что гид хоп использует они все достаточно много ресурсов вкладывают чтобы его работать это gui от оркестра и 30 в принципе для тех кто не любит не заставляет его использовать можно тоже самое работает скам онлайн или даже у них есть там счас ослабь интеграция до того что можно все через чатов сделать с точки зрения traffic management опять-таки нас тоже есть много разных архитектур что можем делать да там как управлять трафиком на она сервера ну вот мы вчера ты встречались говорили мы сейчас видим очень такой хороший truction у прокси sql вот с а типов два часа и в четыре часа сегодня будет презентация вот с точки зрения прокси вскоре мы тоже и и интегрируем с нашим берг он их среди кластером чтобы можно было легко их из их использовать вместе вот и наверное упомяну как у нас прокси сколь может интегрироваться вообще интересно с кластера опять-таки использовали вы это морской репликацию либо вы используете групп рынке шин или pixel но первый вариант да там что вы можете поставить праксис quelle и другую прокси solution как дикий вид дата вас есть какой-то узел через которую вас все ходят и она рауте трафик понятно что в этом случае один practice коллеони подойдет да там потому что это будет single point of view нужно делать какой-то для неё тоже там режим ходить и чтобы их было два либо вас там какой-нибудь не знаю умный кибер найти с которой если она умрет он ее новую новую поднимитe на что-нить в этом роде а второй вариант который часто очень классная то что мы можем эту самую праксис quelle разместить на на самих приложениях и в этом случае что интересно что у нас не только решается проблема синглов поинты фейдеры но и у нас нет еще добавление к не так леденцы потому что мы ходим к то есть наклейки у нас только один хоп да там здесь у нас требуется 2 а здесь у нас практическое локально соответственно native клиренсе практически не добавляется что очень классно мы в своей стороны активно поддерживаем прокси и скай в том числе у нас нашем фильме есть набор дашбордов до для прокси sky вот ну и тоже пара полезных слайдов если вам интересна тема es que el вот мы проводим конференцию беркана life в в апреле да даже не только морской мы в этом последние пару лет рао раскрылись расширили тему чтобы покрываем другие открытые баз данных то есть у нас есть презентации по многим другим базам данных и мы рады видеть от вас как возможно доклады приехать рассказать что-нибудь интересно так и если нет то по крайней мере посетить послушать вот но еще мне тут обязательно говорят тут нужно показывать слайд с одной стороны с другой стороны ребят с холодрыга варят если слайд покажите по крайней мере молчите поэтому я ничего говорить не буду а просто перейду к вопросам станислав компании мегагруп я правильно понимаю что даже в совокупности с морской или на db кластер маску группы все равно придется новые моды в группу вводить вручную и сами они не будут подсасывать данные до с кластером да то есть это вот как раз таки часа проблема которая полностью не не решена то есть как вот стоит трансфер который speccy такого группы людей шин пока нету добрый день и спасибо больше за доклад опять же по поводу группы аппликации на добьет дабы кластер вопрос столкнулся с тем что если ну самая стандартная задача нам необходимо перегрузить машину являющейся одной из членов кластера значит после этого машина в кластер не заходит автоматически то есть при этом убирается в конфликт с но речь идет о слове упирается на в конфликт в наличии дополнительных транзакций как правило в performance схема есть ли какие-то стандартные методы борьбы кроме как дропнуть базу данных залить ее полностью смазкой дампа и завести в кластер с нуля оао насколько давно вы это пробовали пиццы путра назад сентябре это было да то есть я бы сказал что здесь нужно нужно смотреть как я скалы она называется джей но достаточно ранний джей да то есть мы ее когда тестеры тоже находили такие таких вот на некоторых интересные особенности до в этом плане но и но надо сказать что оракал ребята и очень активно фиксе то есть если посмотреть на любой майскую 57 релиз то там будет я не знаю десятки наверно багов да там который фиксы для групп привыкаешь и по performance кем просто не очень понятно да то есть ваш счет приложения активно пишет performance кем почему с ней транзакции в том все и дело что нет то есть потом вот исходя из логов да я вижу что есть несколько параллельных недели не случайно baby baby а нет нет ничего не хочу сказать плохого про девин просто debian он любит делать пытаться самой сколь апгрейт а майскую ляп great он начинает он пишет локально то есть в этом плане нам важно что если вас что то перепускает май скорик great он должен быть отключен иначе он вам наплодить локальных травления там проблема была проблема совершенно точно не в этом то есть ручная перезагрузка машины после которой появились на сливе новые транзакции в какой-то системных таблиц ну собственно после этого не стартовала ну машина не заходила в кластер его на откуда появились молекуле что чаще всего и создает морской лев great нет не готов сказать но не из него точно самым апгрейда как такого не происходило никакого но я понимаю на просто морской лев грей даже если он ничего не делает он все равно может нас ради просто что-то хочет хорошо спасибо посмотрим эту сторону кто-нибудь ещё хочет вопрос такой вопрос насчет мастер мастер репликацией если не возиться с авто инкрементом а использовать нам что-то типа ю л т 4 или что-то такое такое пробовали это работает да нет она конечно работает но надо понимать что автоинкремент и да то есть они просто то что лежит на поверхности да то есть и люди часто говорят вот у нас была the master master обрекая печь на вот она нас сломалось софтом климента вот мы поставили авт increment of seed и все она у нас заработала но на самом деле если мы модифицируем одни и те же данные с двух разных сторон и они от реплицировали дата в разные сторону то данные могут получиться разное да в этом случае потому что до изменения были применены в разном порядке особенно то что касается statement ли репликации да это вот то есть в этом возникает проблема не в том что в том что не вылазит вот поэтому самое самое главное до 10 чтобы у нас не было конфликт новых обновлений а авт инкремент он часто их просто но маскирует больше чем спасибо я так понимаю вопрос в нет поясница нашим докладчиков"
}