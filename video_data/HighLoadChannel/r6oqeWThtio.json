{
  "video_id": "r6oqeWThtio",
  "channel": "HighLoadChannel",
  "title": "Погружение в виртуальную память и большие страницы / Константин Новаковский (Selectel)",
  "views": 3132,
  "duration": 2766,
  "published": "2018-01-16T13:38:16-08:00",
  "text": "добрый день рад вас всех здесь видеть спасибо что пришли на мой доклад меня зовут константин маковский я работаю в компании селектора систем на момент системным администратором проекта виски громче плохо слышно и манча тогда носом по хочу туда но если буду много пыхтеть то вы говорите руки поднимаете вот это вот все вот я системный администратор проекта виски виски это виртуальные серверы да тема моего сегодняшнего доклада это виртуальная память и больших странице собственно почему мы беспокоимся и думаем о памяти на слайде представлена общем то чем занимается select all да там есть виски я являюсь его системным администраторам и виски old и достаточно такой бюджетные виртуалке до примеру 512 мегабайт виртуалка это 200 рублей и нам бы хотелось чтобы с такими ценами утилизировать оборудованию по максимуму да и в том числе экономить как-то эту память собственно как мы разбирались с тем чтобы экономить чуть-чуть истории в 1985 году компания intel выпустила процессор 80 386 который полностью этот первый процессор который в современном понимании умел виртуальную память защищенный режим и имел встроенный memory же мент юнит до контроллеру управление памяти до этого программист нам нужно было работать в реальном режиме и заботиться о памяти и самим рассчитывать как ее использовать где выделять в каких кусках кстати кто не помню кто такой реальный режим работы процессора об их чем вот собственно что значит виртуальная память под виртуальной памяти понимается что приложение приложение выделяется когда она просит память выделяется некоторый какой-то диапазон памяти да и он с ней работает ему не нужно думать о том где на самом деле размещена в какой в какой части реальной памяти оперативный физический размещенный его код его данные не самом деле непрерывный кусок для программистов в виртуальной памяти может быть очень фрагментирован ему фрагментирован ее сильно разбросанным глазками по реальной физической памяти собственно за счет этого механизма виртуальной памяти можно делать различные какие-то интересные штуки общая память не знаю можно заниматься дедупликации памяти в том числе вот собственно как это происходит в процессе нет накарябал немножечко вот такую простую схемку да у нас есть процессор у нас есть мо мария менеджмент юнит процесс в процессоре есть какие-то инструкции данные команды им нужно обратиться в какую-то область памяти и у него есть виртуальный адрес виртуальной памяти делает запрос мы мы remind me менеджмент и юнит в этом замечательном булочки происходит некоторое преобразование взлете которого получается физический адрес и дальше мужа собираем эти данные из оперативной памяти у этого замечательного волшебного яблочка которые превращают виртуальную память физическую память на самом деле есть еще кэш и вспомогательные таблицы как преобразовывать из виртуальной памяти физическую память эти таблицы точно также находится в оперативной памяти то есть даже этому галочку для того чтобы выполнить преобразование периодически нужно сходить в оперативную память чтобы ему ходить в оперативную память меньше у него есть кэш tlb то буфера сосать ассоциативной памяти тра транс блин translate лука сайт буфер это очень очень и очень и очень предельно быстрая память она находится в процессе рена очень быстро и очень дорогая поэтому ее размер крайне небольшой да собственно туда сохраняется вот эти кусочки физическая память виртуальная память и физическая память забыл отметить что под виртуальной памяти для того чтобы перевернуть виртуальной памятью используются так называемые страницы памяти то есть вся память разделено на какие-то небольшие куски в зависимости от архитектуры размер страницы разной мы сегодня будем рассматривать 4 килобайта и большие странице как я уже сказал собственно вот это вот что в оперативной памяти есть большая страниц таблицы страниц которое содержит пары виртуальные страницы физическая страница но на самом деле ни одна то есть раньше когда-то она была одна но со временем с увеличением мощности разрядности процессорах эти таблички размер таблички росы немножко видоизменялся на рисунке я накарябал немножечко от руки примерно то как это происходит на текущий момент в линуксе да за ростом от этой разрядности в линуксе эта табличка ни одна увеличивалась их становилось несколько она как для обратной совместимости так и для будущей совместимости по умолчанию используются четыре таблички да это пейдж директ по их global директории пэйдж upper директорий прижми дал директорий директория и непосредственно table табличка пейдж лейбл entry это непосредственно та самая запись в которой хранится уже соответствие виртуальной памяти и физической памяти то есть чтобы нам добраться непосредственно до нужного момента до нужны вот пары чтобы преобразовать нам нужно пройти несколько табличек extended пэйдж тайбл я немножечко так сказать пометил пунктиром потому что это дополнительная таблица который используется в случае если мы используем виртуализацию gpt это интеловской обозначение а н д ну немножечко другой но суть остается той же то есть у нас появляется еще одна дополнительный уровень абстракции вот почти наши дни да у нас есть вот эта вот табличка преобразование почтили наши дни не так давно был нас значит сервер 12 гигабайт до 12 16 гигабайт оперативной памяти и табличка у нее вот это вот пейдж тайбл для преобразования в этого сервера при том что размер страничке 4 килобайта занимал 116 мегабайт 116 мегабайт теперь давайте прикинем у нас есть сервер 396 с 396 гигабайтами оперативной памяти и грубым подсчётам можно прикинуть что при 4 килобайтах при размере 4 килобайта страничке размер паисий был будет занимать 4 гигабайта да а у нас как бы виртуалка минимального тарифа 512 мегабайт ну как бы ну вместо в этих больших мест по html можно сколько там 456 еще несколько виртуалок запустить вот собственно наши дни тот самый сервер с 3 сами 96 гигабайтами оперативной памяти у него размер страничке размер по html на текущий момент занимает 221 мегабайт собственно как мы этим добились есть варианты ну да очевидно в докладе же написано большие страницы от младшего пейджер собственно мы можем использовать вместо четырех килобайт ных страничек использовать размер страницы в нашем случае для запуска виртуальных машин для памяти виртуальных машин большие странице размер больших страниц зависит от архитектуры да то есть это форматом могут быть там 16 килобайт на 16 мегабайт нее и 16 гигабайтной странице все зависит от практики the orchid от архитектуры процессора собственно какой плюс нам дает использование больших страничек 2 мегабайт на последней вот ph тайбл entry в поиске исчезает она уже не нужно то есть там размер страницы вот этого записи как раз подобно так что нам мы находим вот этот 2 мегабайт на кусок не доходя до payne 3 то есть мы уже fps middle директории уже находим нужный адрес и дальше уже это сообщение дается memory management юнит и memory management юнит обращается к память и процессор у т л б д л б translate лука сайт буфер он в данном случае получается не один их несколько для каждого размера страницы свой размер своя со свой tlb стоит отметить что да то есть там вот ли на слайде легкий глеб на самом деле tlb это по несколько tlb на каждое ядро процессора отлично как все это дело использовать эти большие страничке использовать достаточно просто есть два механизма есть так называемые не прозрачен и чист и большие страничке есть прозрачные большие страничке сначала разберем первые потом немножечко посмотрим на старые и посмотрим чем разница собственно как включить простые и чистые большие страничке несколько способов можно сделать это на ходу но лучше делать это при загрузке системы системы параметрам ядра допишем там не знаю там в конфиге гроба дополнительные параметры при старте системы система автоматически автоматически мои сказали выделит зарезервируй эт да стоит отметить отдельно внимание внимание зарезервируй от большие страничке то есть в системе они уже будут видится уже как занятое то есть там делаете the page top free и эти страниц странице никто не напишет что они будут это именно большие странице но память будет занято как будто кто-то ее использует собственно до первых чуть чуть дальше еще немножечко про большие страничке чтобы их использовать да вот чистые большие страничке ваше приложение должно явно умеете это делать то есть нужно либо использовать специальные вызовы специальными флагами мапо например дай мне большую страничку либо через второй метод так называемый файл backed мама remapping когда мы создаем файл и отображаем его на память но этот файл на самом деле создается в файловой системе виртуальный fingers her bf с до которой отображено как раз на эти самые зарезервированные большие страничке собственно небольшой вывод перф а кто-нибудь использовал пир в практике в своей кто-нибудь слышал об этом инструменте отлично собственно настоятельно рекомендую всем посмотреть в сторону первым почитать товарища брэндона грега да хоть бложик хоть и знаю лучше всего книжку его взять по мониторингу по измерению производительности до без больших страниц страничек а мы получаем вот такие вот результаты количество промахов в кэше процессоре стоит отметить что если в tlb нет нужные нам записей до то есть оно не запиши равана то этот весь процесс там достаточно длительный по меркам работы процессора до сходить в оперативную память сделать еще там что-то посчитать обратиться по и штейн был и потом загрузить то запись на чем меньше у нас промаха в темном лучше да то есть вот наглядно без окей мы посмотрели значит посчитали ладно чуть дальше об этом второй метод еще использования есть больших страниц он является legacy но его можно использовать если вам вдруг как-то приспичило это загрузка вашего приложения то есть сначала нужно выделить страницы при запуске и ядра потом при запуске приложения воспользовавшись был до прелат либо кучка т.р. утилиты запускаете ваше приложение и системные вызовы которые отвечают за операционной системой адару дай мне память они подменяются и выделяются большие страничке так да еще у нас есть прозрачные большой страничке как говорил блина я не вижу чё там написано ну ладно собственно прозрачной больших страничке что нам дают наше приложение ему без разницы она ничего не знает про большие страничке да но использовать много памяти или ещё как-то работать с памятью и мы хотим чтобы эти прозрачные большие страничке что что вы чтобы приложение использовал большие страничке поэтому в ведре 238 по моему появилась такая возможность как прозрачно предоставлять приложением использование больших страниц как на самом деле выглядит есть никто кой демон как hd который периодически сканируют адресное пространство до страничке видит что допустим этому приложению сожрала много памяти там больше 2 мегабайта наверное можно его запихать в одну страничку и собственно этим занимается через некоторые ну изначально реализация была так себе да она скорее на порядок тормозил и весь процесс нежели ускоряло но где-то в районе ядра 312 было отправлено несколько горных патчей который это дело ускорили да теперь приложение то есть действительно помогает приложением быстрее работать памятью носа с некоторыми оговорками которых чуть чуть позже стоит отметить про прозрачные большие страничке что например в грунте 1404 1604 в зависимости от объема оперативной памяти hasta прозрачные большие страничке могут включиться автоматически то есть если у вас больше восьми гигабайт оперативы это значит они включаются автоматически это вы можете не ожидать случайно как ими воспользоваться прозрачными большими страничками либо она автоматически уже самому включилась либо вы его включаете сами включить можно в два режима либо использовать постоянно да и крутить эти демон будет запущен постоянно либо и демон будет прикасаться и переносить в большие страничке память всех приложений все выделенную память приложениями либо можно использовать системы и вызов madlife который с помощью которого можем подсказать операционной системе ядру как поступать с этим регионом памяти на самом деле я не встречал почти не не встречал софт который использовал бы этот системный вызов ну один из минусов эту систему на вызовы что он является после к совместимым то есть во free bsd вы его не увидите там свои инструкции вот что еще про прозрачной большие страничке не все приложения корректно работают с прозрачными большими страничками не вижу чем у меня там на слайде да ну ладно часть приложений которые активно работают с памятью и тем более активно выделяют и освобождают память в прозрачные большие страничке могут только навредить да то есть пока значит тут мог бы быстро вы уделили память от мужа хотим не закрыть а там еще демон который пришел значит я скажу всем наши маленькие страничке в большую страничку потом мы пришли значит освобождаем он давай делать этот все обратно в общем время занимает то есть в случае там какого-нибудь может быть редиса манга много современных молодежных баз данных рекомендуют отключить прозрачные большие страничке потому что они негативно влияют на производительность этих приложений однако у демонов уж прежде есть некоторые ручки которых ну почему-то редко упоминают и можно настроить как часто он будет проходить по оперативной памяти по страничкам мы собирать их в кучку да и вытеснять в большие страничке как часто как много как быстро он будет делать это обратно причем с каждым новым релизом ядра количество ручек увеличивается до и также что он еще натворил можно посмотреть файловой системе виртуальной файловой системе парков с посмотрев новым станут легкий греб на ядре 44 в 410 411 там еще больше статистики она достаточно интересны вообще это настоятельно рекомендую всем обратить внимание вот на этот файл в м стоп тот в 44 там по моему больше ста двадцати различных параметров статистике что происходит в системе что происходит с виртуальной памятью системе там много нового можно узнать вообще своих холстах и сразу все будут быстро и шелковисто нет как я уже сказал не все приложение это умеют точнее часть приложения могут явно попросить демона ковкой phd том чтобы вытеснил страничке приложению большие странице есть ещё там альтернативные локаторы не только мало коджима лак до достаточно популярный у него и сижу с пятнадцатого года по моему следу о том что давайте мы тоже будем как-то вот уметь использовать эту возможность на данный момент ни какого патча там нет ты ешь и открыто и если кто то желает с прямыми руками волкам так до приложение но как я уже сказал включаем какие-то приложения готовы какие-то приложения не готовы собственно какие приложения готовые активно используют большие страниц это вот как правило это какие-то старые именитые приложения которые уже давно на рынке которые давно используются местами используется как приложение по умолчанию да этот атом под грифом на искье ли там системах виртуализации vm ware но мы используем тему квн на тему это умеет однако есть некоторые проблемы то есть когда мы начали использовать большие страницы у нас появился некоторые нюансы да мы запустили изначально мы считали какой-то там что вот столько тапах виртуалок можно разместить на кости виртуализации через некоторое время там посчитали там ну там при самом плохом случае что 512 виртуалок там на хост там с 200 56 и мегабайтами а потом она почему-то стала не вылезать не вылезать ты бы мне не понятно почему нельзя и почему-то процессы виртуалок что-то жрали очень много памяти включили на чем мы начали использовать первые варианты использования больших страниц это заранее мы резервируем да когда мы их резервируем то значит что вот та ну все уже принадлежит то есть точки зрения администрирования мы уже заранее сразу видели сколько памяти у нас выделено под рабочие машины да то что предоставляется клиентам это что остается в системе для каких-то управляющих процессов отлично то есть когда мы запускаем теперь и чтоб сразу понятно кто же лет больше памяти вне зависимости вот того что уходит клиенту то есть мы вдруг обнаружили что у нас тему квн до для виртуалке 512 мегабайт на минимальном тарифе сам процесс кую яму пожирает там он 300 до 400 мегабайт ну как-то ну вообще ну прям прям нужную плохо но очень плохо да то есть мы продаем получается не одну виртуалку как 2 по цене 1 начали разбираться почему так наверно какая-то учите к явно какая-то утечка памяти может быть не утечка но надо разбираться начали смотреть топ это по большому странице вообще никаких нет ну как бы сразу вообще не очевидно что мы даже тогда на тот момент мы не ожидали что у нас включены прозрачные большие страничке подумали подумали посмотрели поползали действительно включены большие прозрачные большие странички и большая часть памяти используется да где можно посмотреть какая память используется для процесса поскольку топать никаких топ like утилит для больших страничек нет да поэтому пришлось пойти руками в прок fs и смотреть что там вообще существует да и возможно там мы найдем ответ что зажигает память вот так вот выглядит в браков с регион поймите которые используются прозрачными большими страничками стоит отметить до что это отображается как 4 как странице 4 килобайта но на самом деле под капотом там 2 мегабайта до размер размер страницы вообще в файл из maps это такая очень безумная большая портянка да чем больше памяти приложения используют и чем меньше этих кусков точнее чем больше кусков памяти тем больше это патента для кстати также не обнаружил ни одной утилита которая бы смотрел с maps и выдавала какой то опять же статистику по большим страничкам так выглядит кусок регион памяти без большой с чистой большой страничке непрозрачный тут как бы сразу все понятно наглядно видно что до используются страничке так вот вернемся к нашей проблеме большущий выживание памяти оказалось что кому-то подтекает но на пути к это очень чуть-чуть да там выделил какой-то регион регион памяти чуть-чуть папочка как бы оставила демон кику как youth пэйдж блин простите как прежде до то он видел что он тут выделю память значит захватываю его себе и вытесняют большой странички в итоге процесс q яму которые в нормальном состоянии должен жрать нам 60-80 мегабайт оперативки за счет вытеснения большие страничке начал уважать триста-четыреста отключили для хоста все стало хорошо теперь мы можем записать на хвост еще больше виртуалок да и и она будет работать собственно да типа хотел бы немножечко время заканчивается подведем итоги память резервируется сразу при старте либо на ходу это можно сделать если большой страничке есть они никем не занята и свободной памяти это можно сделать на ходу но не обязательно все что вы скажете все будет выглядеть лучше делать при старте все это резервированный адсорбированная память не уходит своп быстрый приложи все все все хорошо работает быстро и приложением нужно из минусов явно знать о том что нужно это использовать дает таких приложений немного но они есть давайте немножечко еще подведем итог по прозрачным большим страничкам это удобно для части приложений это действительно может ускорить их работу для части приложения если приложение не готовы или как-то это активно выделяют освобождают память это может наоборот привести к diga diga крок к деградации производительности и со стороны может показаться что процесс течет и течет очень безбожно вот прозрачные большие страничке могут вытесняться во внешнюю память сводится то застигает достигается за счет того что он демон сначала собирает большой маленький странички в большую страничку а потом делит их на маленький вот остается интересный вопрос у нас настройка прозрачных больших страниц это настройка систем white то есть для всего инстанса дает до ядра linux для всей операционной системе тут возникает вопрос насколько это используемую в контейнерах когда мы будем пихать найден кот не знаю паритесь и еще какое-нибудь приложение когда одному приложению хорошо включенными большими страницами с прозрачными большими страниц с страницами а другому приложению наоборот нет или она вообще начинает выглядеть как под тикающая да то есть при использовании при попытке взять очень большой жирный хост да с большим количеством оперативной памяти и попробовать по максимуму его утилизировать нарезать все groups и возможно мы получим обратный эффект что можно почитать почитать есть отдельный целый сайт посвященный memory менеджменту в линуксе есть документация ядра там много чего интересного написан оправдают надо отметить что в документации ядре периодически может чуть-чуть отставать этап стрима есть еще замечательный книг книжка по-моему называется understanding линуксу она конечно достаточно старовата то есть достаточно по-моему на лет десять отстала от реалий однако базовые моменты как все происходит на самом деле которые не сильно поменялись только там наросли какими-то кусками там вполне неплохо все описано еще если кто кто-то хочет прямо пойти в то место где живут дракона да по другому я не могу сказать там можно просто утонуть в информации это взять документацию интела по их процессором и почитать как это работает на самом деле без абстракции там очень много нового можно для себя открытий и далее после чтения такой документацию вам будет очень больно смотреть на то как сайт на экспресс как бы генерирует страничку в течение 1 секунды вот что ж на этом все спасибо за внимание задавайте ваши вопросы для будут давать на них свои ответы рыбу добрый день спасибо большое за про клад меня зовут алиса вот у меня вопрос вы и где где вы есть да вы-то своих виртуальных машин используйте его честными . да как вы правильно почистить подсчитываете сколько оставить памяти для операционной системы то есть в условиях когда памяти очень дорогому не очень дорогая вы хотите максимально за использовать под виртуалке соответственно вам нужно оставить какое-то разумное число взойдем саммите под операционной системы простой расчет в итоге получаются хотя наверное он в будущем спасибо за вопрос в будущем он наверное этот расчет изменится наверно появится еще какие-то факторы которых мы который мы еще плод мало изучили не то есть у нас есть в зависимости размера hasta мы берем скажем так сколько минимально виртуалок минимального тарифа мы можем разместить на хост до в зависимости от оперативной памяти и вот это вот количество виртуалок который мы можем туда разместить принимаем что на управляющий процессу будет занято порядка 90 мегабайт но это как бы в том случае когда но что-то уже давно и начинает подтекать и прошло какое-то длительное время не спокойном состоянии без прозрачных больших страниц на процесс окаяма дай-ка ему занимает проект 60 80 может быть даже меньше да то есть если там подключиться через винись и консолька это виртуалке доп количество памяти используем управляющим процессом зарастет ну потому что там вынеси еще появляется еще что-то происходит и чем больше фишек используются для виртуалку я тем больше она потребляет поймете и ещё немножечко вставляем собственно демона который управляет этими делом виртуалке когда своего агента сам описанного своп не используем ну то есть упала значит упала то есть если вдруг кого-то прибывает и прибывает нашего агента в этот момент как в панели управления можно нажимать кнопку перезагрузить перезагружаться я маленькое уточнение то есть это все узнается грубо говоря опытным путем уложи наверняка на гипервизор и крутится там какой-то модуль файловая система sharing a pan в switch диски локальные у нас нет ширины внешне какого-то внешнего хранилища иначе это было бы дорого ну как бы ну цена посмотрите на 1 цент спасибо большое за доклад вы используете к smm или баллоне нг ксм а нету оболонь young нет нет нет не потому чтобы разоблачить вас просто было интересно как это спичками работает данный момент нет ну там как бы уже получается нетривиально но и с большими страницами это будет тот же самый ксм будет работать сложнее то есть нужно взять смерть 2 больших страницы . а то с одной стороны производительность другой стороны давайте там вот так вот значит как это моя утрамбуем просто баллоне нк по идее мог бы позволить вам еще больше памяти аллоцировать virtual com ну а потому что что когда когда виртуалка захочет ну реально и воспользоваться от статистикой да как-то вычисляется сколько можно ну и потом внутри виртуалке как правило у нас linux linux как бы всё равно рано или поздно со живет всю память под страничный кэш да для файлового а еще вопрос если никто не против ок ок чуть позже уживается сном архитектуры у вас зима когда мы выделяем страничке спасибо за вопрос очень интересный уточню вопрос вы используете какие-то алгоритмы или какие-то струмент и для распределения памяти виртуалок пан ума контейнером вот чтобы рука была в одном но мы контейнере а не растекалась по обоим сколько у вас ну мат или берут сам подкручивает это дело кто подкручивать любви ну то есть мы используем либер для запуска виртуалок он немножечко делает и рядом запущен еще но моди который тоже посматривать за процессами и смотрим но до в случае с кучкой джерс когда они выделяются по умолчанию но равномерно размазывает на разные ну ма ну собственно transparent hp джесс тоже об этом деле заботятся а ну мы то там есть отдельные функции и они тоже пытаются размазать страницы по ну мы но нам нужно то есть и все это дело но пытается как-то заботиться да просто размазывание размазывание памяти по num анодом приводит к тому что производительность наоборот ухудшается не но нам нужно чтобы процессы были в одной стороне там же где и их память вот собственно но и процесс у вас процесса виртуальных машин пенится на конкретные ядра нет они не пенится и принцип объявлен в виде нет если мы будем их винить тогда нужно будет еще смотреть не знаю там какая-то виртуальная машина начала жрать очень много памяти на этом уже ядре рядом стоит еще какая-то виртуальная машина надо просто перемещая это уже идет в раздел так сказать давайте подключим подкрутим скиду лирда и чтобы по балансировать я думаю это тема отдельной дискуссий и основной вопрос вопрос по теме еще маленький когда кличкой же выделяется эта память полностью выделяется как бы систем оно не доступно никому и в системе как бы остается вот та память которая осталась у смысле для регулярных процессов системы обычных там до для игра в том числе и большая система очень долго работает память очень сильно фрагментируется и это часто но как часто это может приводить к да может ему было разделить kernel panic да вы ловите такие ситуации кернел паник до кернел паник не доходило были ситуации на старых я так сразу отмечу на старых я дракона 319 была проблема о том что дай мне 6 16 или 32 килобайта памяти но не смогло но там есть отдельные условии что это был ядерный процесс который попросил эту память да и он попросил не просто память этом память 232 но это как бы отдельный это как бы совершенно другая глубокой отдельная тема это герц предлагаю обсудить это в горах да там был еще один вопрос добрый день спасибо за доклад у меня вопрос а как вам киллер данном случае работают мне просто не очень понятно это понимаю мы зарезервировали под чистых вещей g какой-то для памяти он вам томим может измениться или нет это количество зарезервированной памяти под кличкой же можно но мы можем попробовать ну можем их уменьшить это всегда можно мы можем попробовать их увеличить вот увеличить не всегда можно то есть мы можем попробовать увеличить но если памяти уже нет то увеличивать некуда и она как бы ну то есть она скажем так то есть там есть некоторый процесс который потихонечку там дефрагментирует точнее дефрагментирует doves упоминаем speed disc отображены на оперативную память и а немножечко что-то куда-то утрамбовывает до выделяясь страничке но как когда он упирается в то что он дальше утрамбовывать уже не может то счетчик можно в реальном времени наблюдать как он это делает то есть глеб ну в моем стад а допустим нас зеленая память кончилось у нас получается с trigger салам на это событие или нет или не триггере целом ну то есть вам придется поубивает процессы которые сажали всю память кличко и жена или он был считать что тебя все нормально а он да случае с прозрачными большими бытие на памятник когда я честно говорят не встречал такого следите чтобы тепло не кончался ну то есть у нас есть определенный лимит что там такой хост можно выделить такое количество памяти под виртуальная машина то есть управляющие про слой когда скиду мир виртуальных машин он знает что на этой ноте у нас такое количество памяти выделено под виртуальной машины все больше он туда не пытаясь ничего пихать а он просто не попытается вывели большие вам дам ему на то есть мы заранее прогнозируем это дело ее знаем что на текущий момент гарантированную виртуальную машину не прибьет изломы точно и понятно спасибо случае such a transparent чуть позже с там по моему есть специальный механизм если мне память не изменяет который в случае он но точно сначала она пытается как-то обратно в маленькие страничке перейти чтобы как то что то сделать если не получается тогда ум но это дело тоже можно подкрутить то есть если поглубже пойти в кафе phd то можно посмотреть и по моему настройки пранки ли и у вами по мы тоже там что то есть про это еще вопросы кажется а вот такого слышно а значит но понятно там я так понял один процент памяти вы просто экономить и мы экономим память ddr4 виртуальных машин вы замечали какой-то именно ускорение работу то есть то что там таблицы лишь не убирается при обращении к памяти и прочее то есть какое-то ускорение вы заметили ускорение не очень большое это зависит от приложений от самой нагрузки порядка там 5 процентов просто вот мы например заметили у нас стартует snapshot of virtual pet кого имя и под нагрузкой у нас была проблема медленного старта медленного до старта виртуалке да там в среднем но скажем там 10 секунд и snapshot а это много это в смысле внутри виртуалке она медленно стартовала или на гостей а стартует виртуалкой snapshot а вот обычно так из на нагрузке нет там две секунды она стартует если нагрузка то это 10 секунд когда мы присели фьючерс мы заметили что у нас стартует 3 раза быстрее под нагрузкой но память уже выделены не надо ничего там раздвигать никуда просто загрузить интересно это в случае с при запускай snapshot а да ну то есть snapshot когда уже вместе с оперативной памяти да а ну просто мы механизм сейчас не используем не предоставляем спасибо за информацию еще вопросом если нет вопросов тогда большое спасибо за внимание исследуйте свои системы смотрите на производительность переживайте о памяти и сильное отступление от темы не забудьте обновить корейская ключ на ваших рекурсивных dns рей курсор их потому что в сентябре он будет заменен спасибо"
}