{
  "video_id": "0eAdIxzR7G0",
  "channel": "HighLoadChannel",
  "title": "USE, RED и Golden Signals для анализа производительности и оптимизации / Петр Зайцев (Percona)",
  "views": 1126,
  "duration": 3061,
  "published": "2019-05-15T04:48:11-07:00",
  "text": "отлично мы с вами будем говорить про анализ производительности баз данных кто здесь любит базы данных окей значит остальные ненавидят и так понимаю да вот но на самом деле в каком-то смысле это и правильно потому что если вы любите производительность то базы данных это то что на самом деле часто нам создает проблемы очень часто когда я встречаюсь с клиентами у которых тормозит какое-то приложение с ней можно встретиться и спросить у них ну вот приложения тормозит а еще выдают их проблема не горит база данных а почему базы данных всегда это база данных то слышали оно такое ну вот мы на самом деле в этом есть определенные вполне разумной причины потому что во первых в отличие например от веб-приложений дата база данных с келли теней на достаточно тяжело да то есть если у вас есть приложение которое написано они очень эффективно например на ruby on rails дата вы можем вместо одного сервера да там поставить их веб сирот достаточно много и соске лица до с базами данных часто так не просто не получаются базы данных сами по себе они достаточно внутри тоже сложный и часто особенно если мы говорим о новом поколении разработчиков они не очень хорошо понимают базы данных как они работают как понять вот этот вот запрос который они выполняют он вообще хороший и или не очень что нам обычно приходится дела с точки зрения производительности с базами данных но это на самом деле много разных вещей да там нам приходится часто разбираться с проблемами когда вот база данных вчера работал а позавчера работало хорошо сегодня тормозит да надо разобраться почему тормозит почему сейчас до решить проблему второй вопрос который достаточно важен это то что называется к пасте плане да то есть у нас есть база данных сейчас может все работает хорошо но мы получили информацию от менеджмента что вот у нас будет рост пользователей в два раза там или в три раза сможет она работать или нет какие нам для этого потребуется изменения да там больше ресурсов и как это вот вопрос к пасте плане ну и следующий момент это вопрос конечно эффективности и цен и денег да там способность сейчас многие используют клауд кто миль кладезь используют облачные решения ну не так много надо сказать удивительно вот обычно там в штатах например рук значительно больше да вот кто использует облачное решение и в данном случае интересно какое место что если используется клауд a skate инфраструктура достаточно тяжело это не то что мы говорим вот нам нужно подать заявку да там и вот мы пока купим пока поставим через три месяца у вас сервера появится да там поэтому и увеличение размера инстансов и больше серверов она все делается это легко непринуждённо а потом в какой-то мент вас смотрит и он приходит счета там с большим числом нулей у кого в какой валюте и говорит блин а клауд а оказывается штука дорогая вот и в тот момент конечно сразу встает вопрос уже как вы нам теперь эту инструкцию структуру оптимизировать до что в вопрос не в том чтобы она работала быстрее но в том что она работала эффективнее ну и последний момент это то что я называю очень же менеджмент этом широком смысле потому что если вы занимаетесь обслуживанием базы данных обычно происходят две интересные вещи во-первых разработчики любят писать новый код добавлять там новые фишки создавать новые там таблички писать новые запросы да там и эти изменения часто бывают создают какие-то новые проблемы в данных да там ну или уж по крайней мере меняют паттерн запросов да там и нужно понимать как это влияет все параметры база данных до базы данных это и так далее и второй момент то что вы бы часто происходят какие-то изменения связаны может быть там железом с операционной системой при столь же самое с версии базы данных да то есть если кто вот делал там maker апгрейда там с mais quel одной версии другой версии да там или же в других базам данных знать что на самом деле хотя вендоры всегда говорят вот у нас есть классная новая версия она и быстрее и красивее все делают отлично на самом деле кто знает такую важную философскую мудрость никогда не верить маркетингу он знает что вещь это не совсем так да там что-то будет лучше если повезет но что-то обязательно будет и хуже но как значит можно подходить к химизации производительность в базе данных на самом деле есть такие две на мой взгляд точки зрения с одной стороны с точки зрения разработчика база данных это грубо говоря blac box да там а вот с точки зрения кто занимается обслуживанием базы данных это ну более-менее то что называется white box за то что можно посмотреть как она что работает что же нас такое blac box на самом деле ну если я девелопер который не задумываются о базах данных до сильно значит для меня все очень просто я посылаю запрос базе данных она мне на него отвечает а что там внутри происходит это как бы не не моя проблема очень часто есть такой идеологии да там среди developer их не все но некоторых или многих как повезет который считаю что чтобы могут на базу данных нет ни не бросили да там она должна все это переварить и нам отвечать на запросы чуть ли не мгновенно а если она этого не делает значит это значит дивей некомпетентный кто-нибудь сталкивался нет с таким образом мышления о сталкивались вот ну и что интересно что сейчас когда появляется сервиса дети писали service data вроде там amazon rds дать им сейчас смотрю здесь тоже яндекс mail.ru открывают такие решения да то получается что и многие вопросы там с operations базах данных да там они тоже становятся более к вы благ бокс как-то база данных должна нам обеспечивать надежность каким-то образом там вроде бы делаются бэкапы да но непосредственно мы в этом не ты не копаемся да там не разбираемся коммент работают что значит девелоперов у них какие критерии до на самом деле есть папа базами данных высказаны или нет ну во первых это доступность конечно да то есть если я не могу подключиться к моей базе данных твоему что-то говорить во втором девелопер обычно интересует как его запросы обслуживаются до скорость выполнения запросов его да там или для ты и после третий момент да там который интересен да но не всегда хорошо понимается в потому что вы обычно полагаемся что базы данных написано так что это всегда правда это что результаты запросов у нас на самом деле correct да если этого критерия нет это на самом деле оптимизировать любую базу данных очень просто как можем имитировать базу данных взять дропнуть нафиг все таблички и у нас запросы будут летать все любые даже там 25 join of на 10 терабайтов никаких проблем вот ну и понятно что часто вопросу эффективности и цен да там они тоже могут у нас волновать разработчиков в зависимости от того как это все в компании устроен с точки зрения людей которые занимаются первичен они часто кроме этих вещей смотрит что же там происходит внутри да там пока нас нагрузка как она меняется растет в течение не недели как у нас используется ресурс у нас процессор загружен или же диске или может быть вообще сеть они занимаются вопросами всяких там системных и железо чн их проблем да там которые могут вызывать проявляться как проблемы производительности ниже чем ну просто что перестает работать но и так далее вот ладно значит это как бы так общий overview что вам было понятно мира как я на это смотрю не к этому подхожу давайте теперь перейдем к собственным методом методом но скрыть и мне господа как вы думаете в большинстве компаний какой метод оптимизации производительности наиболее популярный кто не знает что страстно малость потом чиним ну наверно там я это могу вот так так называют да что мы просто идем в google или яндекс я уж кому как повезет да там дальше берем первый попавшийся ответ его вперед на продакшен молимся может быть случайно данные не потерялись да чтобы оптимизация производительности не было дропа ним табличек вот ну это конечно шутка наверно такого плохого совета найти сложно на самом деле иногда вот читаешь до что находится и люди делают какие-то советы которые они не совсем понимают да там какие с этим связаны ну какие то могут side effect и да ну вот мой опыт в основном больше всего связан с mais quel например есть такая часто оптимизация вот ребята давайте вы там там выключите и in adobe flash logo тирекс коммент вот если эту штучку поменять единицы на нолик все будет классно а там но если вам транзакцию потерять не жалко она все классно а если жалко то этому совету следовать не стоит вот какие назначит проблемы с этим типичным ответ вопрос ну во первых конечно не так просто быть уверенным в результате какие-то проблемы хорошие советы находится сразу каких-то нет каких-то могут решения и совершенно неправильных тоже достаточно тяжело тренировать людей да там если мы хотим растить кадры таскать 1 и найди это в google и то это но не очень хороший подход ну и третий момент что многие люди которые сейчас занимаются особенно большим инфраструктурами они хоть и хотят автоматизировать до что у нас инфраструктуру было то что называется с хелен чтобы как можно больше типичных проблем в нашей инфраструктуры они могли диагностироваться и решаться скажем так программами они не людьми в этом случае понятно да там сказать программки иди погугли что здесь делать но пока что не удается когда удастся я думаю что число людей в индустрии разработки существенно сократится окей значит какие у нас есть методы которых будем говорить сегодня но на самом деле я очень рад что за последний год несколько лет появилась определенное число методов для решения этих проблем которые были в популяризирован и вот в этой скажем так нашей среде да там потому что методы подхода к таким проблемам ли вы там в коммерческих базах данных данных мер для oracle метод or да там был достаточно популярна еще наверное леди для 10-15 назад на там или же с точки зрения академические подхода они существовали но как-то люди которые занимались этим проблеме на практиках ну это не использовали и так метод номер один это use my feet и узнав от был разработан изначально для того чтобы решать не проблемам баз данных а собственно говоря проблемы производителей систем серверов непосредственно и этот метод был разработан с фокусом на то чтобы он был прежде всего достаточно достаточно простого до чтобы мы могли используя не так много времени до там усилий разрешить большинство проблем видите дайте что мы решаем 80 процентов проблемы только за пять процентов усилий и то есть идея здесь в том что мы не говорим что любая проблема которую вас есть она может быть решена с помощью этого метода да там но для большинства вы найдете решение еще такая классная вещь и что для них у нас есть достаточно много чек-листов для операционных систем которым можно последовать да там и соответственно используя их для решения проблемы значит как можно отметить высказать в одном предложении вот вот так вот да то есть мы для каждого ресурса хотим проверить и there'sa и since a terrace и если там ошибки да очень просто но давайте разберем что же это простой предложение на самом деле значит что значит ресурс ресурс прежде всего означает все физические компоненты до которые у нас есть и когда мы говорим серверов там процессоры диски и так далее что значит у утилизация ну с точки зрения то методы мы говорим что окей у нас ресурс может быть либо он занят да он делает какую-то работу либо он айдол до соответственно он ничего не делают утилизации это про пропорция времени сколько этот ресурс был занят ну и вот хоть у женщин это показывает то что как было ли у нас еще какое-то очередь когда не ну или размер очереди что не только у нас ресурс был может быть занят сто процентов но я существенно разниться у нас он был один запрос в очереди до там или же там их было 500 штук ну и наконец ошибки с ними все понятно да то есть мы можем смотреть только с точки зрения типы и количество ошибок с точки зрения ресурсов вот но это все ресурсы которые у нас есть в системе соки насыпью король с точки зрения памяти обычным именем к мире производительность его не производительность да там объем памяти потому что если память ну скажем так заканчивается идет с fopen понятно ничего хорошего не происходит вот ну и и так далее что еще интересно что для дисков нам обычно имеет смысл смотреть на его к крису шайбы двух типов во-первых с точки зрения операции ввода-вывода да сколько но насколько он загружен да с точки зрения воды выводы да там или какой у нас там есть утиль женщин сатирой шин и второе это размер да сколько у нас есть свободное место на диске ну потому что во первых если кончается места на диске то ничего хорошего не произойдет с базы данных ну и во-вторых что если говорить про и современные файловые системы и про современные flash ssd диски то их производительность имеет обыкновение снижаться если мы если у нас совсем нету или совсем мало места значит если мы хотим использовать use of от нее не просто с для анализа сервера а анализа производительности программы обеспечения такого как база данных то понятно что все те же самые базовые ресурсы они тоже имеют смысл дата наш процессор и память низкого вот вывод но также дополнительные софтверные ресурсы надо рассматривать прежде всего что в базах данных важно это синхронизационные примитивы beautix или драть локи там семафоры да там кто что какая-то иметь там condition nasdaq то что может использовать потому что если эти объекты у нас нагружены у нас может быть и что и процессор селяне используется там и и диск не особенно да там а ничего хорошего не не происходит при чем на эти вот локи нужно смотреть как в базах данных особенно как с точки зрения назовем это как бы физического уровня да там которые используются внутри для для защиты разных структур базы данных так и логического как роли velox а то есть потому что если приложение уролог за там или they go locker бывают потому что если а какие такие блокировки были захвачены да там приложением то это может привести к тому что ничего вы нам все остального заблокирована из-за этого да вот так же есть другие есть ресурс на который имеет смысл обратить внимание такие например как диск mp3 файлов да опять таки если эти скрипты файлов кончатся как в рамках процессора так либо в рамках всей операционной системе базе данных это не понравится вот и connect и connect и здесь уже к базе данных да потому что очень часто вот мы сталкиваемся что разработчики начинают ругаться что вот у нас база данных упала до там не можем вот конектится на самом деле проблема в том что они просто использовали уже все connect и базы данных да там и они получают ошибку в рио пытки как приконнектиться какие у нас плюс этого метода ну опять-таки что у нас хороший проверенный метод он на самом деле имеет очень широкая область применения и есть хорошие чек-листы в чем его проблемы ну проблем на самом деле в том что он требует достаточно хорошего понимания архитектуру системы да то есть если вы новый фронтенда java script galloper то скорее всего вы этого не знаете да то что там есть какие-то core процессор и что они отличаются от френдс осокин это вообще что-то третье но вот со многими поговорить но не знают они этих вещей да вот так же нам требуется доступ к ресурсов нижнего уровня своя чтобы хорошо это все а анализировать до который в систему когда у нас использует эти бейся за сервис да там или же в вирту лицензированных средах он может быть вообще недоступен либо просто либо ограничен во клауд компьютинга еще интересно есть здесь аспекты то что инфраструктура с которой вы работаете она обладает двумя интересными особенностями до во-первых вы полностью и не понимаете да ну например приведу как пример amazon да потому что то знаю лучше лучше всего ту вас есть два как бы сервера в их разместили в одной авила билете zolan в одном регионе вам говорят что это типа вот должно быть все хорошо да там но непосредственно как они там подключены сколько между ними там свечей на сколько у них там между ними основные interconnect и нагружены да там из другого трафик который работает вы вы не знаете да и второе понятно что она тоже нас там архитектуру вас работают много разных клиентов кто кроме вас там еще кто то есть и несмотря на то что из года в год изоляция между разными клиентами она улучшается она все-таки ну до сих пор до сих пор не полная поэтому на вашу производительность могут влиять другие люди тоже следующий интересный момент и он касается понятия сатира и шиндо там и очередей кто не знает что вот это такое фрактал вот что на самом деле действительно это фракталы почему я здесь привожу его на этом слайде вот полу причине до что когда мы говорим про утилизацию сокращен до то мы говорим с одной стороне и просто вот ресурс занят или свободу или свободен до но на самом деле здесь все очень сильно зависит от того насколько сильно мы увеличиваем до там чем больше мы как с фракталом увеличиваем его дать им мы бои видим больше больше деталей то есть например о чем идет речь да но вот если мы посмотрели и сказали вот мы выполняем запрос да вот если мы посмотрим там в майскую есть понятие да там фред ранен или на нет то есть выполняем мы можем сказать что с точки зрения то потока у нас или занят моей сколь сервер или субботин да все очень просто но с другой стороны дальше можно смотреть или что есть куча разных вопросов то он может быть на самом говорить что он занят на самом деле он он ждет на лодке или дисковый вот вывод и так далее вопрос можно сказать ну ладно давайте считать что он как бы действительно зона занят они ожидают когда он использует процессор ну хорошо а отлично да но что означает он использует процессор когда у вас есть рано был процесс дата в операционной системе он может быть выполняться на процессоре а если доступных потоков нет он может сидеть в ранг хилл и ждать до опять-таки такое следующая интересная деталь но даже если вы говорите что процесс выполняется на процессоре да там он тоже может на самом деле не выполняться осушить вафли пока данные придут из оперативной памяти до то что может занимать тоже да там добрую сотню тактов а то и больше да и поэтому когда мы говорим про итиль женщин сатю женщин имеет смысл понимать да там о ресурсах какого уровня вы говорите да там и использовать правильную правильную методологию ну и сервисом и интересные моменты что особенно вклад происходит с диском да то есть мы можем говорить такие вот мы ждем на диски на самом деле диска и без а там у нас и сеть играет и там это распределенной инфраструктуры где куча куча разных своих очередей состояний и так далее и тому подобное так говорил что есть чек-листы хороший вот это вот пример такого самого чек-листа для linux вот сам полезно здесь это вот link внизу по которым можно пойти и скачать этот чек лист чек-лист полностью дальше хотелось рассказать о нашем туре который называется pure к нам unternehmen вот мы хотя не делаем это непосредственно для какого-то из этих методов но многие из вещей которые я упоминал нам хочется чтобы стилизовать инструмент можно было познать и понять ну первое это степенью солдатам использование процессора это наверное есть у всех абсолютно любых инструментах абсолютно тривиальна игра скажу две вещи до которые люди часто путают и нее не очень понимают первое это a white да там частот статьях или люди думаю что а имеет это вот используемого процессора это не так да то есть а его этот на самом деле тип idol до idol просто когда еще у нас есть на какой-то процесс да там который ждет ждет ввода вывода то есть это первое очень хорошо надо понимать 2 еще есть такая что у которой часто в современных клаудов случается это still do тамада тип процессора который stella и нужно смотреть и отображать почему да потому что если вас например х 1 за решил что вам нужно дать например только пятую часть вашей корки вас показываться сепию с 20 процентов да там сам систем классе узор вы думаете о этот процессор и дофига свободно а если при этом остальные 80 процентов это steel то значит что но не додали или может уплате за 100к тут разные могут быть причины просто на некоторых тузах которые более старые и они просят компоненту steel не знаю да там они могут выдавать странный результат следующий момент то что мы смотрим на сосюра еще до то что называется точки зрения женщин я считаю что очень полезно смотреть вот на на ранке состоянии сок у нас процессов в раны был стоять на при этом ее хорошо бы на нормализировать на число core особенно если у вас очень большой как бы зоопарк есть система где там к укоров там несколько десятков а если какие-нибудь маленькие сервера да там где всего там по porsche парочку до в этом плане потому что то показывает сколько у вас грубо говоря процессов конкурируют за 1 кор следующая вещь которую мы тоже рассмотрим это вот максимальная утилизация города потому что несмотря на то что сейчас про современные системы они имеют много корда которые могут выполняться параллельно не все программы написаны для того с расчетом на это и очень может быть несмотря что вас показывается что степенью и there'sa есин общей там маленький вас есть какая-то горячая корка и которую который по каким-то причинам ограничили но ограничить производительность следующий момент который имеет смысл смотреть это с точки зрения процессов как уже говорил имеется вы посмотрите у кузне chrono был также и сколько из них блок да там показывают наш скажем так очередь на диске вот здесь от нас что-то было с какой-то прошел кусочек а you want for cloud и на самом деле я вот это вот такой подход люблю куда больше чем линуксовые lot of reach да там потому что нло товарищ он смешивает мух от котлет да там и если нам сказать lot of reach 10 что это означает но саша не понять что это означает это может быть что у нас запущена 10 процессоров которые просто там чего-то считают на процессоре а может быть на самом деле у нас вообще процессор не используется у нас просто там диск используется активно и то и другое возможно с с таким образом это понять значительно лучше а память понятно что как уже мы говорили память нужно смотреть чтобы она не не кончилось особенно то что касается баз данных базы данных не должны свататься да то есть если вас база данных активно свапнуться значит нужно скорее всего изменить снятие кэш но второй момент который имеет смысл смотреть это виртуальная память для виртуальной памяти сами определяем как физическая память до + а + swap которой у нас есть с одной стороны да я говорю что база данных не должна сводиться но другой страны хорошо если swap у вас все-таки есть вот почему да потому что если вы сделали какую-то не знаю там ошибку ли у пришел ход запросов от от после которые требуют больше памяти чем вы ожидали и требуется памяти больше чем доступно до то скорее всего проснется такой злобный дядька oem киллер вот базу данных убьет даты после этого она будет медленно и грустно делать краше кадры вот обычно значительно лучше если вы просто видите а у нас пошел swapping у нас не знаю да там в худшем случае это пришли убили запрос дата вместо того чтобы делать к делать краше камеры с точки зрения свапа прежде всего имеет смысл смотреть не утилизацию бо svoboda а какой у нас происходит к свапу вот и или вывод да потому что в принципе в любой системе обычно есть какая-то кусочки памяти которые не нужны не используя на самом деле и ядро это виднее он их может выкинуть swap они там будут лежать вам будет больше доступно оперативной оперативной памяти вот вот этот вот здесь например пример да вот видно что какое тут происходит иногда там одна страничка там здесь это совершенно нормальная случае если вас происходит там мегабайт плюс да там качается туда-сюда да там в секунду то это обычно плохо с точки зрения диска теперь понятно в одесской есть у нас много метрик да мы часто можем смотреть диск rial intense да вот я рассказывал на моей предыдущей презентации сегодня почему имеет смысл смотреть распределение по disco disco light in se еще одна метрику которую мы часто смотрим которая касается здесь к ее city racing это нагрузка до который по грубо говоря показывают сколько у нас есть за совмещенных а юре квестов длина этот диск там здесь мы видим что вот что-то произошло да там и она здесь у нас не негативные с кейлин да то есть чем ниже тем больше на самом деле запрос в да мы видим что вот здесь у нас взлетела как число запросов на чтение зелененьких так число и на запись показаны жёлтеньких до вот и в итоге существенно увеличилась нагрузка на нагрузка на диск то там что много запросов одновременно дальше то что касается диска или tense на самом деле это может повлиять на нее дата может может влиять и не сильно в зависимостью от одесского подсистема до которую вы используйте сколько она запросов может выполнять параллельно и так далее с точки зрения аолой dense я предпочитаю делать любые две вещи во-первых смотреть на нарин rights отдельно и во-вторых сравнивать их с теми какая условно траверс да потому что что нормально для вашей дисковой подсистемы да ну это сложно сказать да там сложно сказать что вот наша система она обычно но должна делать там столько то миллисекунд или как-то очень зависит от диска но с точки зрения сети там все достаточно понятно следующий момент интересны это ошибки если мы говорим с сетевыми ошибками они очень интересные вот чем то есть у нас ошибки другого типа да например у нас диск не прочитался да то обычно нас при этом там возникает ошибка базы данных говорит все капут данные читать не могу или писать не могу с сетевыми ошибками они обычно влияют прежде всего на производительность да то есть они но не приводит к падению системы но она при этом поэтому они как раз-таки могут игнорироваться дольше с точки зрения сети имеет смысл смотреть на локальные сетевые ошибки до которые вы можете посмотреть на на своем интерфейсе и по большому счету хотел бы чтобы они были 0 до чтобы у вас не было пакетов которые пришли с неправильными чак целыми или же что переполнились очереди у вас дрогнули в пакетике вот то есть если вы что то вот такое со всеми нулями это хорошо более глобальная скажем тогда между да и в данном случае глобальная но для для сервера базы данных скорее всего это между внутри вашего дата-центра вот между серым базами данных и и клиентами то есть в этом случае хотелось бы видеть что вот таких тисе пейте ри transmit их было мало или не было вообще да почему потому что протокол теперь и устроен так что любой ри transmit это означает что было вставлено там достаточно существенная в данном масштабе времени задержка который хотелось бы чтобы не было mais quel с точки зрения mais quel имеет смысл хорошо смотреть на несколько параметров одно из них это число запросов до который обрабатывает система есть вот что интересно что число запросов она может быть когда она система показывает плохую производительность как взлетать так на самом деле и падать до почему ну например если вы используете такую систему каширования да там она у нас вдруг почему-то стала работать неправильно там случайно кайши за флаш или сюда у нас число запросов может залететь резко и база данных работает усердно усиленно обработают может быть их больше чем обычно должна но все равно тормозит просто потому что в ее прости делать 10 раз больше чем обычно это один вариант другой вариант когда у нас например съехал план у запроса у народа там из-за этого у нас получается что число запросов которые она переваривает падает а при этом загрузка база данных взлетает наверх у этого два таких случая которые очень хорошо понимать да потому что в них копать нужен совершенно разных направлениях в задаче момент кроме запросов я люблю смотреть на статистику на уровне rose да потому что это показывает реально работу которую делают базы данных да там вот можете это конечно тупая работу да там если она делает попытку не правильный план но это показывает нам какие-то часа другие параметры да то есть у нас база данных обычно переваривает не знаю там миллион строк в секунду да там вдруг у нас все это упало вопрос почему до в этом плане следующий интересно очень тоже метрика которая имеет смысл поговорить это вот как раз таки смотреть на то что он сосать у женщин на уровне майской сколько у нас frights которую сейчас выполняются так на текущий момент вот и конечно там лучше всего да там если у вас особенно workload цепью болланд в основном их число не должно быть больше сильно больше дать им чем ваших secu курс которая доступна что тоже здесь интересно что очень часто проблемы с производительностью они связаны с тем что у нас число этих вот активных френдов на уровне московия но а подскакивает до по крайней мере на какой-то небольшой период времени именно поэтому я предпочитаю смотреть эти два графика да там желтые то сколько среднее между каждую минуту до тома красненькой это какой был максим в это время да потому что часто мы смотрим что у нас начинаются быть такие локальные пике до что нас красники точки вскакивают а потом это переходит в скажем так тотальную перегрузку системы до когда у нас и a very что же резко подскакивает так окей следующий значит пройдемся по паре методов более быстро рыбные тот который рассчитан прежде всего на микро сервисы до архитектуры когда мы говорим что мы с нашими серверами работаем как со скотом а не как с домашними животными вот и в этом случае у нас ресурсы и сервисы они но связаны весьма динамично и часто использовать use метод получается достаточно тяжело вред методе мы говорим вот так удачно для каждого сервиса мы хотим проверить рейд запросов сколько у нас есть ошибок да там и распределение времени времени отклика что интересно то что вот эти вот параметры они очень сильно соответствующих раз таки тому что интересно разработчика как я говорил вначале при начале в начале презентации когда мы смотрим на red метод для баз данных то мы можем смотреть как на сервис уровень да там а так и на уровне индивидуальных на уровень непосредственно дтп серверов вот так же он может быть применен например к к разным на типом запросов да там или же кем-то ресурсу например а вот что у нас происходит с этой вот база данных которую на живет определенный клиент а ну и понятно что как я уже говорил одна из преимуществ этого методы что она очень хорошо соответственно соответствует тому что интересно разработчикам и он не требует такого понятия архитектуры да и глубокого как узнать проблема конечно в том что у нас нет таких еще большого набора инструментов и чек-лист для поддержки этого метода и на самом деле он больше у нас сфокусирована ответ что уже у нас не работает нежели чем почему в нашей тулси наиболее наверное что его хорошо поддерживает это наша система анализа запросах да где мы можем посмотреть вот мы здесь можно увидеть да там сколько у нас число запросов дайте нам показывает как раз таки то что можем начинать рейд с точки зрения late in se можем посмотреть как leithen сеток и она грубо говоря распределение распределения light in se то есть такое дело вот ну и еще есть такая функция спирко на сервере и сейчас много маску или восемь мы можем построить гистограмму времени отклика запросов который позволяет нам делать много разных визуализаций например если мы говорим о кей вот наши юзеры очень любят запросы которые там больше чем 10 секунд до то мы можем посмотреть на графики да если у нас вот эти вот а у сколько у нас происходит outlines которые слишком медленно и for signals time есть читал такую книжечка называется эстер и бук гугла ну вот хорошая певичка да и как раз kick off a golden сигнал они взяты из мониторинг дистрибуции steam секции этой этой книжечке что же это за фол golden signals latency трафик и и сатю раньше да вот это вот четыре четыре критерия вот как их можно применять к базам данных null и tense понятно да чтоб мой здесь часто имеет смысл смотреть на response time дистрибьюшен опять-таки buy дайджест потому что разные типы запросов они имеют очень часто совершенно разное распределение и допустим времени отклика трафик мы можем верить как число запросов опять-таки входящих разных вот этих вот типов запросов rs ошибки но понятно что как это разные московский р-н coat корректируется как ошибки вот неправильный за по ответ на запрос тоже ошибки на обычно то что очень тяжело поймать но из отираешься в данном случае это будет смотреться к использование физических ресурсов бат но еще тоже таких как коллекцию на эти так далее вот но плюсы какие здесь у нас что плюс этой методологии в том что оно хорошо было протестировано гуглом да там и сейчас уже многим другим и также хорошая есть книжечка по ней по не существует с точки зрения теперь у нас проблем да там с этим методом определенное что прежде всего это фреймов для мониторинга да там нет ниже чем для анализа что из-за чего же нас происходит проблеме и пока что у нас нет таких и чек-листов ра как для юз метода развитых вот какие у нас соответственно в заключении презентации что как я рассказал за последние годы мы видим что очень хороший падет инновация у нас в развиваются методы анализа базах данных да и что еще интересно что они все могут немножко по-разному смотрит примерно на одни и те же на одни и те же вещи что очень классно так еще такая есть у меня маленький анонсик если хотите искать наверное кто знает перк он и слышали что мы занимаемся mais quel кто даже слышал что мы занимаемся поддержки консалтингом и так далее для mongo db но какие же тут с многим поговорил на этой конференции многие не знают что мы теперь занимаем все еще и позже сам вот вот так что на и теперь цирконом готова помочь вот с со всеми наиболее популярными открытыми базам данных и на этом я готов ответить на ваши вопросы здравствуйте спасибо вопрос такой вы разрабатываете сервис для мониторинга баз данных да да решением для ментуру вот и известно что мониторинг точнее наблюдатель влияет на состояние наблюдаемого объекта далее конечно как вы минимизируете влияние вашего мониторинга на базу чтобы ну вопрос вопрос хороший да то есть со стороны да то есть когда мы смотрим что соблюдая что какие данные собираются каким но какой частотой до то мы все это смотрим в контексте производительности дата мы делаем много тестов добавляем какие-то даже эвристики чтобы минимизировать ну например в майской летом и здесь такая проблема да там все собирать данные о там таблицах то там из-за informations кима это может быть до долго да там и дает большой импакт на производительность date of the если таблиц но когда-то у нас система автоматически отключает эту сборку если смотришь у таблиц таблиц но вода там потому что ну как один из как у как у врачей дату мониторинг системе должны быть первое правило думал фарм да там или как сказать не не навреди а вот то есть мы это проблема понимаем да там и ей акции активно занимаемся очень добрый день генадий московской биржи в 3 методология которые ты упомянул только 1 подходит в общем-то для глубокого анализа две вторые то бишь прости вечер буквы забываются виктор и они сосредоточено по сути на мониторинге при этом первое на общем фокусируется вокруг ресурсов таких в сторону низкого уровня именно там ближе к железу к ресурсам с и так далее вот суть вопроса такая можешь посоветовать может быть какой-то общий подход или мысли просто вслух чем лучше анализировать а трудную ситуацию когда у нас виртуальная инфраструктура и мы не можем добраться до чего-то глубоко и не можем оценить все остальные скажем так событий все остальные приложения которые влияют на нашу производительность но при этом - по сути не skoda использовать не можем у нас не доступа вниз до на самом деле интересный момент да здесь но первых соседская да если мы говорим вот когда у нас про нет доступа чаще это всего касается как бы клаудин фраз roxy да вот и в этом случае часто имеет смысл просто выкинуть instance который себя ведет плохо и плохо сделать себе другой до на самом деле от помню и netflix рассказывала что они да у них есть они берут ин сон amazon дальше не и внутренне как бы сертифицирует да там прогоняют не какие-то бенчмарки потому что они бывают хорошего от плохие и даже они над flexi да там не поняли собственно говоря как почему и как но проверили если нравится берем не нравится отдали обратно вот с точки зрения баз данных конечно много очень еще вещей сфокусирована непосредственно баз данных о чем они говорили да понятно что у у нас есть много методик которые непосредственно связаны с запросами до непосредственно как нам оптимизировать запросы создать правильные яндексе да там и и так далее и так далее тому подобное очень часто как раз таки но в решении проблем базы данных могут быть связаны с этим здравствуйте у меня такой вопрос об по первым методики вот как вы думаете не нужно ли добавить еще такой график вот в на шесте мы его используем как часов select of или число inserto в секунду вот есть такие параметры команд серпом select вот мы собираем их за пикси своему тоже бывали такие ситуации когда все гайки ровным а вот этот график внезапно там 3 в 4 раза пик вот ну на самом деле это хороший очень вопрос да и на самом деле конечно вот эти insert select да там это инсультов да и да это важные метрики да там которые характеризуют загрузка на базах данных да там то есть данный метод он общей да там он не говорит о данные о непосредственно этими метриками вот еще здесь вот есть какой важный вопрос да что имеет смысл если у вас работы да если коррелирует с вашими проблемами отлично рисуйте и смотрите я видел люди рисуют вообще какие-то совершенно странные вещи да там чуть не фазы луны да там ноют если она у них коли коррелирует с проблемы так отлично почему"
}