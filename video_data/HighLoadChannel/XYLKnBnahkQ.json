{
  "video_id": "XYLKnBnahkQ",
  "channel": "HighLoadChannel",
  "title": "Протоколы уровня приложения в браузере / Илья Кутуков (Parallels)",
  "views": 111,
  "duration": 2630,
  "published": "2017-04-22T13:33:51-07:00",
  "text": "меня зовут илья я работаю в пар лес и занимаюсь всяким веб инжиниринга в основном фронтэнда и наша команда работает преимущество над такой штукой как access она не совсем такая известная как доступно того что мы недавно запустили это так я могу уже переключать д а почему этого не происходит о произошло эта штука которая позволяет вот у вас есть обычный десктопный компьютер у вас есть мобилка android iphone вы запускаете клиента машинке тоже что-то запускаете и получайте удаленный доступ при этом вы отходите от своей машинке доступ становится все удалений и все полезнее когда компьютер вне зоны досягаемости то есть первое на что ориентируется продукт это мобильная клиента нам показалось этого мало мы решили несколько расширить функциональность этой штуки и добавить поддержку доступа из браузера то есть веб-клиент при этом но это достаточно уже давно мы к этому шли и в принципе мы в своем роде анонсируем что у нас такая функциональная скоро появится задача была сделать это все через браузер ну с оговорками более-менее современный браузер остальное уже вопрос оптимизации отката это все сделать нативном очень быстрым быстро работающим и предоставляющим какой-то пользовательский experience который ну сопоставим с мобильным клиентам то и чтобы пользователи открывай ног привык привыкну к тому как продукт работать не открывали это и не пугались того что все как-то не так то мне достаточно быстро недостаточно отзывчиво либо не достаточно удобно для них сделаны я наверное но так как доклад первую очередь заявлен про транспорт и буду рассказывать как транспортную часть как она организована что это а куда теперь кликать нет этих еще рано вот отлично транспортную часть ну и немножко там может что-то расскажу за пределами не ешь но на самом деле вот основной вопрос к в которой упирается наше быстродействие качество работы ну как бы как отрисовывать там допустим with deep canvas или просто canvas или захватывать экран но у всего наверно можете представить так что это не самая интересная сторона в данный момент самая интересная сторона для нас казалось транспортная часть транс транспортная часть состоит из hasta то есть компьютера вашего обычного и на этом хостел установлена программка программка умеют подключаться вовне и программка имеет какое-то управление но внешне и подключениями всем остальным то есть это условно называем транспорт авто рэппер и то же самое ответная достаточно похожий на нее сторона существует браузере у нас есть свой браузера которая отвечает за там конечно по ул иван который отвечает за работу с сетью у нас есть уже мы переходим на уровень то что мы в принципе можем написать транспорта п abstraction layer и уже дальше логика приложение то есть как она с ним взаимодействует и как на воина на него реагирует в принципе мы будем говорить об изобретениях велосипеды велосипедов то есть что такие задачи решались много раз решались мы решали немного по-своему поэтому мы считаем что этот опыт чем-то интересен то есть велосипеда могут быть но вот прикольные яркие но чего-то не там колесо ну либо очень быстро и но иногда вот вроде быстрые но уточняют там стены дальше нету то что все можно сделать по-разному значит в чем нюанс основные нюанс если бы мы полностью контролировали клиентскую часть а клиентская часть это у нас весь зоопарк браузера боль имеем популярных это сафари это explorer это хром это опера это и я вот весь зоопарк браузеров он имеет некоторое общее количество ограничений связанных транспортной частью если вы пишите там берете на си плюс плюс или пишите там красиво работу сокетами вот про это надо забыть вас очень очень такое удобное вроде управление но очень хлипкая всей транспортной частью и что что там к кинется какой-то connection штука будет в итоге передано вы контролируете очень классно вы как бы изъявляете желание я хочу вообще то чет передать и оттуда ко мне чет пришло вот собственно это связано с некоторыми вещами браузер это одна большая песочница для разработчика плюс там есть отдельный сэндбокс часть сам бокса связанная со всякими типе не di pisa китами в первую очередь от для того чтобы браузер и не превратили в полный от в плане возможности даса значок небольшой inject на сайте люди зашли и внезапных браузера начинают обваливать каюта катастрофическую атаку на ничего не подозревающий сайт просто из-за того что на каком-то популярном сайте чет подпис 0 этого избегают из беды в принципе ну и заметно такие моменты что не очень создателей браузеров хотя что браузер вообще уже там работали они без серверов полностью децентрализованной сети какие-то образовывали нет все таки вот давайте мы будем общаться сервером у нас будет origin а вот вот как бы все таки давайте по старинке то что иначе но может с бизнесовые схема у всех сильно рухнуть это все конечно продвинутого разработчику мешает городить код свой огород связанные с работой китами всем остальным ну и как у нас много ограничений внутри это конечно шаттл но вот снаружи для конечного пользователя тут такой пепика где там кнопку поехали значит мы решили остановиться первую очередь нативных ловил возможностях браузеров потому что мы priority что у нас там клиенты те же майки часто использую они открывают все работает и мне надо какой-то какие-то штуки такие доставлять которые только с ними уже будет эта проблема delivery чем у нас больше проблемы при delivery то есть не просто ты загрузил наш веб-клиента еще там плагин устное учет отверстие несовместимость еще кто-то там господи редис трибьют оба вова пользователь забыл зачем вообще зашел это неприятно это всегда приводит каким-то отказом не у давай неудовлетворение пользователь так что акцент был в первую очередь на найти нативные возможности тут надо сразу понимать ну как бы я думаю это вам уже три штучки знакомая первое это точно знакомы http и он для наших задач почти не подходят то есть можно конечно гонять данные туда-сюда там сделать несколько же типе connection of что передавать данные от хоста клиенту ну он не очень подходит почему не подходит немножко расскажу что мы передаем мы передаем картинку ну точнее говоря мы передаем выжимку того что нам делать с has the kodak и мы передаем много всяких контрольных сигналов то есть как в одну сторону то в другую сторону это может быть пользовательские под пользователь пошевели у мыши что-то сбил на клавиатуре мы это доставили на хост и она там забега в соответствии с тем что я вел браузере всякие служебные контрольные канала + как бы ахаз те информации можно получать гораздо больше чем просто и краю картинку с него это пользователя важна картинка мы можем узнать больше мерзкий тип и для этого всего как тут немножко устарел первая версия устарела 2 ну как бы на конечно намного замечательной но все равно не для этого у нас есть наиболее близких к нашим целям что-то вроде тисе пи сокета начните себе соки ты над ним логическая берточка это websocket туда можно писать оттуда можно читать вроде все абсолютно тривиальна это вот обертка поверх тисе пи есть огромный монстр 2-port 7 сразу спойлер мы остановились по канаве пакетах объясню почему с вебер тисе все достаточно сложно ну допустим есть такой сайт веб арте середин и там можно посмотреть уровень готовности различных фич важно это там ну допустим мульти кормим когда мы можем несколько входящих на с нескольких адресов истекания входящие connection ее там прыгать между ними то там поддержка из цтп замечательная штука пришла из телекома не очень поддерживают вообще где-либо но очень хорошая вот прочие фичи вот у него метров какой-то общий ради индекс обобщено плюс постоянно то пользовательские отзывы и там что-то порядка 50 процентов на 50 процентов готова ты приносишь заказчику там проект у меня на 50 процентов готова и отлично конечно берем в работу нет нет на 50 процентов готовы это мало к сожалению плюс есть куча нюансов то связанных с браузерами возможно я успею затронуть его поведение вот так что мы как бы нам не хотелось и дпм где пи допустим для той же мышки потрясающая штука его в во всех играх использует эдвину мышку и у тебя там даже если часть провалилась этих пакетов а не долетели очень быстро тому каждая следующая позиция затирает предыдущие это то для чего эдипе идеален ну это мелкое преимущество на самом деле плюс есть еще вот такие штуки есть java есть flash я немножко рассказываю просто о том как мы подходим к выбору технологии java это я вообще-то они уже в 90-х прекрасно имели свое место быть и сейчас они имеют свое место быть но опять же не почему тот заявлено что у них impact по рынку там чуть ли не 99 процентов а мне все время говорят установите java разрешите я вы обновите его все хорошо с этой я бы вот только без этого вот а так в яви тоже там почти нативный socket опять же у вас нет родного сокета вы можете работать сети только с ограничению кросс origin то есть только вот туда либо зайдем сделан round trip за xml файликом заберем куда-то еще полезем то есть на самом деле сетевая деятельность я вы тоже бить на контролируется браузером с флэшем это наверное лучшее что создано для наших задач это печально признавать но есть одна проблема вот нельзя просто так взять и использовать flash то есть это это как женитьба вот у вас есть какой-то букет на конфетный период вы там ставите этим плагин чик там еще что то виджете какой-то затычку fubag на flash а потом вы думаете какая хорошая девушка почему бы не жениться и решайте передовой через них допустим видео вот и вы прекрасно идете в загс расписывайтесь там это по тису и 300 рублей за регистрацию вот а после загса большинство но те кто делать подобные видео streaming на флэше они берут звонят каким-то знакомым дива хам там нет файла все говорят да девчонки поют пойдемте тусовать и желательно ближайший там стрип-клуб там еще к вам всякие там плагины водятся еще что то все море возможности мнением жены при этом вы не интересуетесь вообще в качестве жены выступает компания адаб как я уже говорил и короче считаю что все нормально с ними куда-то указываете прямо загса жена состоит ну читать что все хорошо а потом оказывается что реверс инжиниринг это не то что вообще разрешено их лицензии что вам нужно втаскивать рядов вмс там еще чего-то он стрёмный хорошая опять же на стрёмные настройки там отдельно экспертизу нужно поэтому flash это нельзя просто так вот там пойти за гулять на одну ночку с флэшем на нем надо жениться вернемся к нашему тисе пи вот у нас в парке с обещает такую классную штуку это мультиплексирование ну на на пальцах это вот мы сразу всю можем вписать в один канал то есть у нас есть много логических разных потоков вы впихиваем их в канал и в канал как теперь дается к нам тоже можно найти много по код потоков сразу собственно для чего это нужно на практике как правило очень простая вещь если мы говорим о типе вот у нас есть большой блок данных мы его отправили в одну сторону а потом ненене по ты подожди подарил же уложился во все внутренние буферы в середине стола укладываться уже часть его попёрла где-то там на клиенте голова начала вылезать а потом это все не не это не нужно секунда отмена еще более важное сообщение вы его пытаетесь кинуть и она упирается вот зад есть такая терминология не ею придумал слоны и мыши вот мышь опирается в этом туннеле взят слоном и показ он не пролезет через это все мы же за ним никуда я никуда пролезть не может и это очень неудобно потому что нам нужны всякие контрольные сигналу нам нужен hard by ты желательно что-то все не блокирует этим проезжающими слонами поэтому мультиплекс вот который обещает допустим не партесь это вроде классная штука нам очень нужно в тисе пи такого невозможно как невозможно мы просто можем использовать возможность того что у нас есть несколько каналов мы кидаем два канала допустим pack 2 для упрощения на самом деле на мобильном браузере двумя и мы ограничивались нужно больше нельзя это эти два канала будут и вести себя очень интересно они будут там засыпать чахнуть дохнуть там очень чутко балансирует нужное приложение с энергопотреблением доступном браузере немножко побольше у нас есть возможностей мы кидаем два канала и они пакеты с этих двух каналов начинают смешиваться на всем пути за замечательно если нам нужно прогнать какую-то быструю мышь она просто встроиться в в определенном момент на определенной промежуточной коробки и и пакет пойдут вперемежку с большой то есть то что пакет эти себе могут перемешиваться мы используем вроде как по нескольким каналам получаем вот эту мультиплекс то есть мы можем там что-то быстро сказать какой-то быстрый сигнал послать несмотря на то что у нас там прет очередной кусок картинки кусок картинки ну это может завести может выпал мегабайта на слабым на словом подключений это достаточно серьезно и поверх этого всего мы наградили велосипед конечно я рассказываю первую очередь про клиента транспорт автор xlr то есть это такая штука ну маленькая такая либо внутренние не знаю насколько у нее есть шансы стать не внутренней но она есть в ней есть несколько частей значит у желательности что с ним можно было просто обращаться во первых это попс откуда же без попс оба обязательно он есть это в принципе то с чем оперирует основной код нашел приложение вот этого консольки которая гонит себя видео и выгоняет input под под самым живет такая штука как роутинг то есть вот у нас есть исходящие выходящие место g и задача роутера вообще определить что это за тип сообщения и куда на асфальт немножко развивая мысль у нас есть еще под ним такие очереди то есть но какой-то внутренний буфер клиента допустим мы двинули мышку все эти сообщения уложились в буфер и дальше там медленного плеваться браузер сожалению браузера обнаружилось маленькая неприятная деталь во всяком случае у soul сафари и chrome а вы ей они полезут опять выяснять вот когда по тем же vysokie там ты делаешь райт это все сразу сваливается куда-то во внутренний буфер браузера и все время он рейде на прием то есть ты туда на записал и он всегда готов принять больше записал еще больше там и вот можно распухать как угодно и при этом вот это распухание к сожалению не контролируем так что очередь на самом деле уже есть возможно мы ее зря втащили но в случае если у нас там что-то более медленная какие-то фабрики и тащить очень полезна и при нативного использование вася насыщена выход очередь бесполезная на вход очередь то есть нам что-то прислали мы тоже это все сложили сообщение где-то и начинаем там отрисовывать эту картинку потому что декады там различные переработка и и но она занимает время то есть мы можем захотеть чтобы сообщение немножко подождали есть конечно пол эта штука ты заказываешь не нужно там пожар вот умнее жирные сообщения вот эти эти этого типа этого есть тонкие это у этого этого типа эта штука принципе другие говорится что это сообщение пришло жирным или пришел тонкая она там поднимает необходимое количество connection of или держит их или управляет и начинает эти пакеты сортировать так ты тоненькие сюда пролезешь ты жирный ползи сюда сюда жирно уже ползешь вам не обязательно приходи по порядку ты при сюда и вот такое фасование исходящего трафика она делает а входящий просто совмещают эту штуку управляет реконнекта me кто нибудь знает как можно за детектив то что у нас вообще отвалился тисе пи socket ну да ну да у нас по нему ничего не происходит кроме того что скоро произойдет тайм-аут нет активности а тайм-аут у нас дефолтные браузере может быть там 30 секунд то есть у меня на 30 секунд на полминуты что-то тормозного вот я тут двигу мышку и она тормознула 30 минут это уже достаточно что там закрыть вкладку попрощаться с продуктом если понятно что ничего не происходит 30 секунд вот поэтому нам над понять что на транспорте ничего не происходит разумеется для этого там гоняется логических орбит то что у тисе пи есть конечно своих орбит но он тоже в общем то ли не венки как правило либо очень лениво а еще в веб сокетов есть скорбит и если говорить о в парке ситом своей системе ща hard битов то есть орбитум еще втащили hard bed ну ну много ни мало полезная штука вот то есть нас логических орбит который в принципе теории позволяет очень быстро обнаружить что что то не так собственно орбит нам говорит что что-то все прервалось то есть ну как бы я послал ничего не пришло у нас наверное disconnect тут надо понимать что диска я попозже расскажу о существующих решение как это все решается на самом деле здесь с обработкой дисконект of первая часть этого надо детектив вторая часть на него отреагировать и отреагирует на неё этой немножко сложнее есть вот пара подходов то есть лишь на reset и то что такое как еще приложение может тебя браузере реагирует на дисконект мы считаем что у нас все мы закончили отношения с этой сессии все пока заново подключаемся и все заново идет максимально простой и приятный способ но как бы мы можем опасаться что что-то потерялось человек там набирал текст он не до набрался или там что-то мы пытались сделать она не получилось или там кусок графике можно лучшею дотянуть заново поэтому есть второй вариант это соответственно фриз реплей что такое фриз мы понимаем что у нас disconnect произошло с помощью орбита там или действительно socket сам сказал я сдаюсь я сдох там явно р-р какой-то либо явный фильм какой-то пришел от сервера и мы морозим интерфейс и смотрим а когда вообще это реально прервалось но что представление о сервера сервер шлет аффлек альер шлет решили просто не доходит друг друга вот когда реальный момент разрыва произошел наверно мы можем обнаружить только по сообщениям которые дошли вот мы прикапываем их номера время смотрим что накоплено за это время если слишком много то все уже пока если еще нормальные то есть шанс пропихнуть но если соединение восстановится то мы сделаем replay но единственное вот это фриз реплеи и то есть ограничение если у вас вот все приложения что там что там на каких-то жутких соплях там одно дернулась потом через некоторое время с каким-то непредсказуем таймингов дернулась второе у нас отработал этот тайник вот эти вот тайминги асинхронные всякие зацепки к сожалению они сильно вредят тому чтобы можно было просто догнать оставшиеся сообщения что клиент или сервер на них бы среагировали если у нас есть четкое там стоит машина то есть со всеми переходами журналом состоянии тогда мы что-то можем сделать то есть взять впф проиграть этот журнал в клиенты либо сервера in any на это отреагируют собственно у нас задач потом разблокирует пользовательский вывод чтобы пользователь мог проделать работу ну и собственно такая штука она частично срабатывает тех случаях когда у нас произошел дико никто дисконект а потом reconnect произошел очень быстро этого часто на мобильных подключений бывает удаленный доступ это чувак там планшетик симку воткнул и пошел гулять ну возможно по другой стороне пошел гулять не потащил с собой ноутбук то есть частой и это на самом деле вот этот микро дагон сессии он вполне себе может улучшить ощущением пользователя от работы у него чуть чуть нагнула они совсем уж все он навернулась есть еще всякие штуки из коробок которые кому-нибудь что-нибудь знакомый из перечисленного можно руку поднять всего очень хорошо начни зря вообще рассказываю что либо эти ребята решают приблизительно мои ну наша же задача чем мы занимались они обеспечивают какую-то прослойку которая управляет транспортным и в приложении просто импортируем какую-то либо на клиенте какую-то любой на сервере и у нас как бы транспорт готов из коробки к сожалению у нас не было возможности красиво там втащить там ну да я вы еще что-нибудь такое на наш бедный хост потому что его бы разорвало там размер дистрибутива поэтому писали серверная часть у нас своя как бы велосипеда велосипед это роскошь которую мы можем себе позволить но есть прекрасные готовое решение из коробки ну как прекрасно это и сейчас они застыли в очень странном состоянии там сначала был это кокос сокеты он и сок же с то есть два таких комплексах решения под но дуб одно дтп по верху если бы так называемый оберточка и оберточка поверх клиентской либо browse браузерного транспортного стек а вот они то же самое обеспечивают орбиты мультиплекса мультиплекса они обычно любят тянуть на логический уровень то есть вы что-то пишете она еще раз таскает это все скучаем м копи обратно соединит от этого скучаем нам копия ну как бы это не критика то есть это действительно можно начальном этапе сильно сэкономить разработку а потом почему-то это все превратилось какую-то кашу взаимозависимостей честно говоря о текущее состояние я до конца даже описать не могу то есть там обертка поверка бирки к тому же плагин плагин поверг обертки как то так то есть всё совсем дружину как это увязывают тампоны стоило 100 к верху вопросов вот но в принципе основной игрок это соки ты он его первый сдох потому что вы перри раздули из него выковыряли всё лишнее все лишнее частично въехала точнее послужил источником для вдохновения для и дженоа дженоа это более высокоуровневые уровень местным труда плюс примус еще более высокая вас к уровню обертка которая может свищи те вот эти штуки ну плюс есть all the bangles тоже там вот как сокс джей с это отдельная такая семья транспортных решений принципе puffy чем по всему остальному ну как бы если интересно можете сами это посмотреть и за ознакомиться но круг решаемых проблем приблизительно такую же сцену то могут быть уже зашита флешбэке но с флешем такой у нас отношения что вы что она немного не бывает то есть наверное без флеша вот более высокий уровень это уровень место джесс из как мы вообще представляем сообщение у нас сообщение ходят сами по себе но несут некоторое пространство и хищников которые позволяют им увязываться секунда в рамках сеанса можно key изображать рпц то есть мы с помощью попса бы сказали в томате кинули сюда и ждем ответ вообще если пришел с таким же номером мы считаем те ответ аннулируем леснер на это дело больше не слушаем подобные плюс нумерация так называемый заказ потока мы говорим давай мне поток я его никак не буду контролировать ты мне по росту высылать по мере возможностей поток этих состояний и мы слушаем они к нам приходят так идет картинг так идет мышкой с клавиатуры вот эти вот основные штуки которые обеспечивают пользовательский ввод вывод вот то есть и у нас есть айдишник глобальный вот этого что-то вроде рпн вопрос-ответ но при этом на вопрос может быть много ответов если мы этого хотим плюс серийные идиш никита есть какой-то адресуем внутри чанг то есть мнение не перемотай мне пожалуйста вот это я недополучил пожалуйста мне вот эти сообщения по мышке из буфера заново пошли от для этого нужен там идентификации чанков внутренняя к той штуке как мы кодируем сообщение то есть разумеется первым делом а попробуй джейсон для этого всего и поняли что ну как джейс но он прекрасен тем что имеет совершенно нативную и очень высоко высоко оптимизированную дико высоко поддержку в браузере казалось на северной стороне во первых у нас чего-то не нашлось настолько хорошо оптимизирована оптимизированного джейсона это во первых во вторых у него есть недостаток даже если мы возьмем там джейсон при этом мистер шпг его аналоги недостаток в принципе самого формата что мы каждый раз тащим всю схему данных с собой вот уже ясно все эти вложенности все эти вот и что это серийная что это словарь каждый раз мы это все передаем название полей поэтому как не компрессируются штуку buy дизайн избыточная мы полезли с relations фреймворке их есть три штучки из основных это про табу фирс от гугла 3 вт и евро дрифт от apache и евро вот я забыл вот значит тут у про табу first на самом деле было большое преимущество мы уже использовали во внутренних транспортах и вообще вот вопрос об этих штуках возник из того вот у нас общается те серво из этом потоке session а еще что то вот принципе пересылая между droid друг между другом сообщения на парта буферы почему бы это не вытащить наружу действительно чего у нас браузер опроса не будет еще одной сервисе который понимает все хорошо ну как бы мы провели некоторое сравнение скоро размеры но если уж они для нас стали критичные сообщений приблизительно идентичные потому что дальше уже начинается какая-то именно компрессия не удаление лишнего а именно компрессия да на который нельзя не передать вот удаляйте лишнее вот нам ударили у них при приблизительно объем сообщений ну на кита тестовых выборка что мы делали он приблизительно идентичный получился и там выкинули там выкинули но были принципиальные моменты это во-первых дизайн всех этих штук то есть если про the buffer эта штука которая следит служит одной определенной цели она позволяет закодировать сообщение с помощью какой-то схемы раскодировать его и все и сгенерировать код который это делает 3вт уже начинает мыслить уровне сервисов интерфейсов то есть это конечно полноценный тяжелая дверь но во первых сложность коды генерации у нас очень большая получается то есть и чем было чем больше объем кода генерации проекте тем больше крюков с ней связанных и на самом деле вот 3вт как-то не элементарно получилось за implement и даже там ради теста несколько аналогичных схем и евро то есть евро это отличная штука она только доехал достаточно поздно включилась в эту большую тройку она позволяет работать очень гибкими частично типизированные схемами то есть если нужно там совмещать что-то там по гибкости джейсона и наоборот фиксированные схемы наверное это удобная вещь но плюс разработчику конечно с про то буфером было удобнее работать документация этом уровень всего уровень всего у них как бы от гугла в коробке к счастью появилась очень хорошая имплементация парта буферов на клиенте это товарищи под ником decode aion you mentioned принципе это очень интересная разработчика я в конце там даже ленточку на него превью что проследить что делает principium основной его вектор это криптография вообще на уровне gs pro the buffer он там сделал постольку поскольку кучей надел инструментарий для работы с бинарными данными на джейси очень удобного там высокоэффективно в том что еще и сделал эти про the buffer этом с интерпретатором танк skoda skoda генерации всем остальным ну как вот генерации все налито вот то есть это замечательный разработчик замечательная вот этот имплементация от него мы ее совсем немножко допили вале и при этом там он по скорости до пилки сильно нас обгонял то есть там недавно он там на 3 на триста процентов увеличить производительность просто там перебрав весь код исходя только из производительности то есть постоянно там штука из коробки который еще приятные сюрпризы преподносит вот из минусов про то буферов оказалось то что сообщение нас конечно компактные но у нас нету нативного никакого свеча чтобы так развернуть и красивые погибают сидишь в шарки как дурак осмотре что что вообще-то пролезу чем оборвался вообще так и должно быть или тут еще что-то должно быть все неудобно то есть сделали какие-то отладочные обертки с двух сторон но к одной кнопкой можно нажать и переключить бинарный вид в текстовый ты хотел можешь отличить что вот тут ошибку мне из некорректных данных а тут у меня лажанулся реализация что-то с ней не так там схема устаревшие там или не вы неправильно что-то был или код глюка ну то есть на самом деле это огромный минус protocol buffers если с ним связываться то эту проблему придется решать этот именно ту от к бинарного протокола сразу что тут хорошую еще написал вот собственно основная схема всегда строилась если и вся 100 если мы делали никакой другом аналогичном фрейм эркер схема построения сообщения это базовая request a базовой реплей то есть все что ты отсылаешь от себя это request все что принимают в сибири пай то есть это маленькое такое выливается в бить их начале сообщения бинарного а потом уже идут в так называемый extension и то есть там у 3вт это не немножко по-другому выглядят но уже поля который говорят а это сообщение такого типа она нам вот можно отправить туда и декодируют его надо так ну плюс у нас есть некоторые направление для тюнинга направления для тюнинга с чем связано во первых начну снизу вверх так ведь не степи вормар пам парам пам но тут как бы нам нужно делать системы точно beach park не на нестабильных сетях в чем в чем смысл что даже если канал для мы делаем какой то канал websocket и для мышей то есть маленький сообщений мы его предварительно прогреваем что он немножко там у него спортом конечен винду побольше стал и вроде как она эффективнее там больше даем данных держала на проводе когда перед тогда передает то есть принципе вот эти вот моменты к что-то еще подгружается можно использовать для того чтобы немножечко прогреть транспорт и там какой-то старт первый запрос пройдут менее болезненно пресечь и индексация это если к нам уже что-то пришло или сервер помнит что нам что-то отдал ему хорошо вообще это заполнить клише и запад предложить клиенту заполните следующий раз плюнуть и айтишником к этому хожу каким-то небольшим шоком вместо основного блока данных желательно это делать конечно автоматически то есть мы там передали картиночку курсора и потом мы запоминаем это клиенты и вроде уже спрашивал вот тебе там хэш или наоборот клиент приходит а знаете я тут фокус тоже немножечко имею у себя полезного сохранена в прошлой сессии такой лес к шее доступен уже ага вот это мы не ждем просто cacib маленький то есть ну самое важное это экономия на данных это не послание никаких лишних данных в данном случае автоматизации этого процесса но она может иметь какие-то небольшие бенефиты ну далее permesso компрессия это такая штука кстати в партесь и пока их мира не обладает даже по моему в перспективе это возможность визит ну тут я если мы в архетипе котом привыкли носить эффективный там газит на сервере эффективный gzip на клиенте плюс еще несколько механизмов компрессия тут во-первых свет сокетами у нас этой возможности нет они никак не zip улицам и горе гоним допустим по ним road джейсон и думаю что он будет также эффективно как с помощью обычного там вашти теперь с запросы передаваться нет это не так он никуда ни за что не сожмется сейчас уже постепенно появляется extensions там стаскивают их from архивирование всего солнце цели с ндс архивирование websocket of но не до конца и втащили плюс там есть две опции архивирует возможность активировать там отдельное сообщение либо канал целиком вот отдельное сообщение пока никто даже не замахивается канал целиком поэтому connection manager умеет делать простую вещь он говорит что вот этот вот канал у нас типу лица и вот если мы хотим там тратить какой-то вверх и то что реально жать мы в дипой мой канал вот этот вот остальные там если уверен что сами все уже пожали хорошо либо дано в данных жать просто нечего отправить бы побыстрее тогда вот в эти каналы то есть принципе поднимая канала веб-сайтов с разными вот этими свойствами зимовкой и без и павке можно там водить дополнительное пространство роутинга хотим мы это же отели не хотим вот и век workers то есть пока честно говоря о верха до огромного на кодирование и декодирование мы не заметили но вдруг мы захотим все усложнять или там допустим вести какое-нибудь дополнительное шифрования к этому всему делу потому что дело хорошее безопасности мало не бывает нам в этом всем конечно сильно помогут любви workers аналог там не знаю запуска нового тренда то есть ты запускаешь донатом новый контекст v8 и он аккуратненько общается с текущим выступая как отдельный поток то есть это позволяет во первых уделю утилизовать под задачи второе ядро во вторых там внести часть логики в этот worker и изолирует как серво лесу с каким-то своим интерфейсом с и варки раме ну как бы какие есть мелочи они во первых двух нот при этом дохнут иногда без предупреждения войны ну если у вас в основном контексте у вас не падает вкладка наверно вот так не сдохнет во вторых очень часто я там ошибка на них к сожалению нельзя замыкать никакой транспорт водку конечно вообще в отделе worker там втащить вот это управление транспортной пересылкой все эти конечно нельзя втаскивать туда конечно мобильном браузере они просто очень дохнуть потихонечку потому что считается что эта штука не очень нужно в обычном доступном браузере тоже конечно могут обрываться и при этом достаточно неожиданные постоянно надо будет три конектится это могло бы избежать то есть браузер привыкли что активный конечно и держать в открыл привязанные к открытой вкладке и и анти к контексту запуска приложение так ли я уже из времени выбился извиняюсь вы можете чет почитать по этой теме скажите у вас были кинг проблемы доступом клиентов когда они сели за практика entire city писаны proximo там за сквидом танки на рам и все такое да полно значит ешьте типичные прокси но как бы эта проблема за рамками но когда на которой обычно пишут что обратить мороз отважно дитем на администратора от этого многом помог помог https то есть 400 там https прокси то гораздо более редкое явление у нас то большинство проблемам снимают то есть если вы использует то проблема прокси она рассосется на большую часть подскажите пожалуйста вы когда говорили про поддержку мультиплексирование в тисе пи а если есть браузера возможность использовать argent стрим в тисе пи потому что в самом тисе пи заложена возможность передачи быстрого сообщения да-да-да-да-да браузер это прямого доступа к tcp он не дает ни в каком виде браузер и эта функция не предоставляет да возможно если очень нужно это можно попробовать вот яворский socket имитация сокета она ближе всего там действительно на уровне пакетов по моему можно это попробовать сделать в остальных средах точно нет спасибо большое а вы не думали такой схеме когда в процессе использовать допустим как основной канал а вот вашу схему с высотки там как fall back некий то есть если браузер не поддерживает в барти сито переключаться на выпсуке то есть все таки выигрыша в процессе существенно должен быть передачи картинки я так понимаю в если мы используем кодеки которые поддерживаются в партесь и используем свой кодекс то есть это преимуществом уже теряем далее в партесь и пока в основном к сожалению мы получаем проектируемый через storm трафик что мы тут это прокси ruim там через нашу веб-прокси упер toupper не получается что там в основном все сводится прокси равную трафику тоже преимущество такой достаточно зыбко дед партесь и там много нюансы связано взаимодействием там кода к и транспортного вот этого слоя то есть это что там воспользуетесь и теперь dp первую очередь это скат проявляется когда там при поддержке ловит нативном для него кодеков сожалению так то есть если у нас свой кода кто-то не дает преимущества почти еще вопрос такой фрезой play вот там сессия восстанавливается как при этом аутентификация проходит пользователя то есть не может ли кто-то просто разорвать connect чей-то чужой и пролезть сначала должен проломиться через tls а вот secu какого-то security там человека там к сожалению пока у нас не предусмотрено но возможно действительно это хорошее место для него то есть контроль целостности сессия да это хороший мысль еще один уровень двс спасибо еще за доклад спасибо"
}