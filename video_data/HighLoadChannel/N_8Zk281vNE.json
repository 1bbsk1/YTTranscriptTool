{
  "video_id": "N_8Zk281vNE",
  "channel": "HighLoadChannel",
  "title": "Как и зачем создавать NginX-модуль - теория, практика, профит / Василий Сошников (Mail.Ru)",
  "views": 3065,
  "duration": 2585,
  "published": "2017-04-22T14:48:18-07:00",
  "text": "ну что ж доброе утро дорогие друзья время без пяти действия я думаю это не помешает нам начать второй день нашей профессиональной конференции рад что вы все-таки смогли добраться до школы управления ну остальные в пути надеюсь они уже подойдут во время доклада и включиться в процесс не буду многословен позвольте мне представить василия сотникова сотрудника mail.ru group он выступит с первым нашим докладом посвященным технологии enjoy an excess верно то верно спасибо большая да я присоединюсь спасибо что все пошли так рано это было тяжело я знаю ехал с севера очень долго и прошел через семь кругов ада вот можно вывести и сегодня я вам расскажу о том как создавать индекс модулей и что самое главное попытаюсь ответить зачем это надо делать это надо далеко не всегда но есть определенный круг задач которые можно решить на в стране unix а вот краткий наш план на первое я введу в курс дел расскажу о брате tourindex а второе я пытаюсь сразу сходу ответить на некоторые часто задаваемые вопросы потому что очень часто ко мне люди работающие вам игру подходит у спрашивают одни и те же вопросы решил просто в небольшой faq вывести прям сразу чтобы было лучшее понимание что будет дальше ну и самая интересная часть это анатомия анатомия я расскажу о том как создавать engine.exe модулю какие есть типы как есть немножечко подводных камней к ножка скажу подводных камнях но без всех тонкостей потому что сами понимаете нужен x то очень сложная технология там тысячи нюансов тысячу тонкостей ну и попробую ответить на вопрос зачем их создавать и зачем мы их создаем в mail.ru и зачем я их создавал овалов вы работой него моего вот ну так же вчера вечером я решил написать примеры буквально шаблон engine.exe модели который вы можете просто взять и воспользовать в конце я дам ссылочку что в нем и товарищи сказали что без этого моя презентация неполная вот ну его если останется время тоже презентация объемная еще отвечу на ваши вопросы ну и начнем с частью видение и часто двое вопроса первое orchid ru index у меня с тремя ассоциируется с матрешкой на самом деле так она есть есть некая кора в котором находится вся базовая пя из которую можно слепить что хочешь в данном случае был ослеплен их и ттп из хода т.п. были серебряные об стримы и также скриптовый движок и ниловский держу окно работает с мэлом тоже сделан на базе core а вот модули который уже пишут для хтб они сделаны had т.п. core то есть сами понимаете такая матрешка есть база это кора есть слои ниже ниже ниже и причем чем ниже слой тем как правило больше всяких модулей мир сами понимаете что для хтб полно есть модули и все они базируются к красных и т.п. core и возможности engine икса и вот один из самых часто задаваемых вопросов это о модели память яндекс яндекс пользует полу это помнить всегда и надо брать правильный пол очень многие люди делают частую ошибку и стараются прибить свои буферах скажем connection у a connection в режиме keep-alive можешь жить очень долго и сами понимать что такое буфера будут скапливаться до тех пор пока жив connection ее жених сможешь просто утечь поэтому надо всегда выбирать правильный пол если мы хотим просто сохранить какой-то буфер на время жизни request и логичнее прибить окрик весту не connection так же надо помнить что эти пулы периодически чистятся и у них есть свои lifetime и они в принципе все достаточно логичны connection живет рамках connection request рамках request a конфиг всегда жив и периодически до мер живо its а вот там также есть много других контекстов но о них чуть дальше вот так же старайтесь использовать внутри engine is a всегда engine отцовские локаторы ссылочка на 5 находится наверху почему надо использовать именно их а они быстрее б их проще де бо жить если вы используете его лабиринты уже suspend файл бенджен xa ну правда честно говоря в жизни не дибазол engine и куски и буфера мне приходилось то что полу без и правильно сделать перерасчет работает отлично но бывает такая ситуация от мира совсем недавно был он как недавно год назад когда мне пришлось использовать стандартный мало калак realloc почему потому что в интернете нет реала к это большая проблема если у вас есть к это библиотека которые используют realloc то вы просто не можете подменить эти функции локации в библиотеке например хороший я взял в принципе я придумал как это сделает сесть кто знаком с паскаль строками можно просто 4 батика больше выделять пробивать еще размера этот кусок памяти использую для реала локации обычный джинкс gearlock вот этот пример это engine x-com это внутренняя структура здесь можно увидеть как раз вот эта вот ссылочку на полу вот то есть данном случае если вы будете уделять что-то в рамках конфига у вас будет жить до тех пор пока жив конфиг а важен exe конфиг живет всегда у пока выручка его не очистить а ну там есть разные конфеты об этом что же дальше так что надо помнить надо всегда посмотреть структура который вы хотите прибить и приблизительно понять где она живет и чистку это время со всех все это на автомате будет в начале нам за этим очень четко следить вот а теперь очень коротко о том что есть в engine.exe как ну и какова структура репозитории устроено вот наверху опять а внизу что там есть 1 в engine.exe очень много структур данных и строительство пользуюсь именно их потому что а они уже знают обожженных скулах б эту максимально активный способ его использую жирных типами данных то что мужчины xi почти все типы данных это либо type d в системных типов либо своей собственной структуры вот так же в engine x коры можно найти ios дпм себя естественно завернутый фасад это может пригодится если вы будете уже писать не своих это dp модельную женой все расскажем какой-то свой тисе пи модуль такое тоже возможно то что хтб по сути сделано на основе коры его можно расширять с при желании как угодно также там можно найти стоит машину которая отвечает за полинг файла дескрипторов ну и много других полезных функций и как логирования работа со скриптами и с конфигами вот а теперь самое интересное самой наболевшая осени наболевшая самое неизвестно это то как устроены инженер смотри какие типы бывают поскольку я ограниченного времени я решил рассказать только о трех основных это с самого наверное интересным этап стримах вкратце потому что действительно это тема для отдельного доклада я сколько ни пытался на прогонах я никак не мог уложиться в 45 минут поэтому сегодня мы рассмотрим только три основных модуля это хендлеры фильтры и прокси прокси вкратце на самом деле там много других из типов модулю как я и сказал . т.п. по сути это тоже модуль на основе кора но в такие нюансы мы уже заходить не будем тоже это очень долго и опять же эта тема для отдельного доклада engine x имеет все engine.exe подчинён одному поттер ну это паттерн членов приспособился другим словами ваш request от польза от request от пользователя проходит через отдых т.п. модуль х ттп запускает какую-то последовательность chain модулях и если они все отработали хорошо то улицей получить хороший ответ если нет то получится ошибка ближайшие аналогии вот эта строчка кода я подумал это будет идеальный налога аналогии надеюсь я прав всем понятная строчка это по сути башни греппа им что-то достаем первую строку подели метро . , делаем сорт и почет чё и подсчет слов вот принцип работает жены гсм он модуля очень схож с этим то есть если pipe сломается у вас отлетит весь этот chain и ваши вы получите ну соответственно ошибку так что месть сигналы и так далее джексу или все то же самое есть поэтому а также всем ко всем абсолютно итак смотрим на доноситься именно так также если копнуть чуть глубже можно обнаружить что помимо того что это чей этот чейни разбит еще на фазы выжженных сеть очень много фаз каждая фаза называется определённый момент времени при определенных условиях проходятся все хэндлеры внутри фазы после чего ее приключения уже с результатом выполнения той фазы на другую фазу вот в принципе этот рисунок это иллюстрирует то есть у нас есть некий набор модулей фазик проходим получаем результат идем на следующую фазу и вот в принципе те фазы которые сейчас в engine xk ттп доступных принципе они самые говорящие я думаю вопрос а тут им не возникает если есть вопросы можете прям щас задать на самом деле по фазам его отложил отложим на потом в принципе сказал не все понятные то есть сервер играет в поезд configure fright обычный контент вас вот а теперь приступим непосредственно к тому как разрабатываются модули именно этим правилам который очень тем правил максим вещам который надо обязательно сделал для каждого мода первое любой модуль мужчину все начинается с конфигом и в engine.exe есть определенные способ именования таких структур для вашего модуля для любых других модулей даже для внутри индексов это использовать вот такое соглашение по именованию то есть engine и т.п. показывает что мы сейчас для хоттабыча ты делаем это имя вашего мода это может быть что угодно и соответственно один из типов конфигом and server локонов все полнота ржаных sconfig это как раз оттуда идет есть main это самый глобальный скоб есть server by the server есть локэйшн локэйшн iv это тоже считаете локэйшн простуд специфический о нем если будет останется время расскажу детальней вот на самом деле эти конфиге эти структуры они могут нуждаться на разных этапах то есть вам ничто не мешает сделать эту структуру чтобы она присутствовала и в менее в сервере и в локэйшн даже в локэйшн iv ничего то есть все что надо это написать одну функцию и задать бит маску определенная об этом чуть позже вот здесь мы в принципе адам директивы собственно нужен конфига присутствует директивы соответственно когда разрабатывайте свои модули вы должны понимать что вы должны что-то дать какую-то ручка администратором пользователем мужчины и для этого есть специальная структура этой джин x команд с хотя я все ссылочки на пи размещаю вот здесь так что вы потом можете просто посмотреть там ничего сложного нету и здесь по сути все что присутствует это имя имя это то как в яндекс конфиге будет представлена ваша директива это тип это как правильно сказать тип это как раз и есть та маска что его чем является эта директива то есть присутствует она в локэйшн в минков server can a call back call back существует чтобы распарсить уже значение этой переменной есть большой набор уже готовых call back of примеру если мы используем и джинны qstring когда нужно просто строчку сохранить то мы должны реализовать call back a взять уже готовые жены кстовский ну и дальше несколько системных более я не хочу позже расскажу по умно в следующем слайде да на следующем слайде я вот примеру допустим мы создаём некий модуль под названием модульной вот у нас появляется некая переменная обычный интеджер и мы соответственно хотим это перебросят интеджер в конфиг вот все что нам надо это принципе объявитесь вот такую структуру вот в этом массиве и соответственно если у нас был бы много разных переменных у нас было бы много элементов этого массива и вот как я и говорил вот эта маска здесь в данном случае этот бит москва ре что принимается один аргумент здесь о том что это директива локэйшн конфиге в серверах конфиги и в main конфиге вот если по еще я захотела кэшем iv иметь соответственно не пришлось бы добавить еще один кусок этой маски соответственно вот это инженерская функция она существует для парсинга энтов обычных это специально для экономии времени чтобы каждый раз эту функцию не делать ну а в set of просто говорит о том где располагается это поле в нашей структуре это такой старый добрый session их ок я не на нем застрять внимание не буду потому что по сути в данном контексте вот принять как данные то есть смысловой нагрузки дополнительный он не несет вот ну и заканчивает такой массив обычному джинкс null команд по сути маркер о том что массив кончился потому что в engine.exe почти все что вы обновляете объявлять внутри своего модуля это static и она экстер ниц и где-то там потому что вот жены все сейчас чинит осматривать мы сейчас уже есть два способа как и зарабатывать модули это либо скомпилировать вместе с индексом либо лот модуль но об этом чуть попозже в данном случае надо помнить что у вас пока все будет static и то что нужен конечный маркер потому что он как раз идет поэтому массиву до конца до этого маркера вот все мы создали какие-то директива хорошо у нас все это работает но теперь нам надо сделать install install внутри engine x как бы создание конфига его мертв и для этого существует такая структура как engine x h top model t on a pretty достаточно простая тут есть несколько этапов инсталляция это при configuration это до того как происходит какая-либо конфигурация пост configuration а также несколько других функций о них на следующем слайде поподробней и вот мы допустим хотим чтобы то что мы объявили ранее наша директива на мер жила снова кейша неправильно все что для этого надо сделать это вот в той структур q забить два наших call back a который мы сами объявили внутри нашего модуля и соответственно использовать ждут фиалок при аллоцировать наш конфиг из ответ здесь кстати я забыл слова мертв написать ошибочка у меня будьте внимательно вот и сделать его мер в engine.exe если это примитивный тип который понимает engine x уже есть большой набор функций чтобы мерзнуть любые переменные собственно если это ваш собственно какой-то тип скажем ну я незнаю у вас там очень к этой хитрой строчек который надо проползти скажем xml и вы хотите в отдельной структуре писать то вам надо будет функцию имиджа из это такой переменные соответственно описать самим и передать его call back вот и ну и соответственно на этапе мер же конфигу этой функции можно делать ки дополнительной проверки сказать что произошла ошибка такая то здесь также можете заблокировать и еще дополнительно сделать вот все у нас множится конфиг мы получили директивы теперь самое интересное как к нам сказать engine.exe что появился наш модуль для этого существует индекс модуль т это специальный тип и опять же объявляется статикой внутри нашего объект не к то есть обычной переменной и описываешь предаешь контексту то эти команды которые мы сформировали ну и также можно дополнительные call бейки для более гибкого управления то есть допустим если мы хотим купить специфическое действие сделать на и нет мастер на выход из нашего мастера и так далее то есть в принципе здесь тоже думаю все понятные вопросов нет просто дополнительные ручки для управления примеру зачем это нужно давайте подумаем если бы наш модуль использовав shared memory в безусловно захотели бы при выходе и убийстве потока бы скажем и разлочить вот для такого и существуют эти ручки для дополнительных действий вот исходя из данного пункта думаю все поняли либо уже догадываются о том как создавать джинкс модули все что надо сделать по сути описать несколько статических перемены объявить несколько call back off вот и все и наш модуль подцепиться но это еще далеко не все теперь самый главный нюанс как добавить хендлер фаза и как сделать фильтры как раз чтобы у нас на какие-то события внутри не внутри engine икса вызывались наши функции и вот как раз об этом сейчас мы будем говорить хендлер ах и фильтрах это две разные сущности я немножко на 5 вернуть здесь к фазам но всякий случай фазы работают фазу вызывает определенный момент времени вызывают некий чей заканчивать чиню возвращаются и идут к следующей фазы и так до тех пор пока все фазы не пройдены либо фаза не прерывалась вот и как раз хендлеры работают с фазами то есть что такое fender вы можете забиндить любую функцию на любую из этих фаз и сейчас я вам покажу как это делается как вы помните у нас при объявлении модуля мы могли передать дополнительные ручки вот допустим здесь на пост configuration то есть когда у нас уже отработали директивам получили переменные заполнили их нашего конфига мы можем мы должны сделать если мы хотим применить какой-то фазу добавить функцию принц или зации и соответственно в этой функции описать следующее что мы достаем как видите контент фас из engine и кстовского core конфига потому что как я сказал это всех at&t по кори живет и просто добавить туда свою функцию обычно марой пушем и все у нас эта функция вызывается на контент на контенте то есть другими словами штука и контента фас когда у нас кто-то возвращает ответ у нас дергали сахар хаос и мы можем там делать что угодно скажем мы можем посчитать не знаю количество слов в ответе от сервера или не знаю ли дополнительно сжать его каким смл горит вот и каждый раз когда у нас кто-то возвращает ответь будто у файл будет то еще кто то у нас вызовется эта функция в ней мы можем уже поработать с х ттп request выдернуть данные которые нам нужны добавить что-то туда либо наоборот удалить и так можно делать с каждой фазой но главное помнить что все фазы вызываются в разное время другими словами если вам надо поработать с контентом то не надо добавлять свой хендлер в лоб фазу то что лог фаза она происходит когда нужно что-то записать грубо говоря там можно наоборот какую-то не знаю статистику дополнительную собирательством интересно в такой фазе а в такой фати нужно обработать контент этих хороший пример ш вспомнил последний раз когда я контент фазу делал и все я не надо было как бы это правильно сказать мне надо было тренировать картинку на лету для счетчика утоп mail.ru вот хороший пример то есть я просто не делал ничего я просто генерировал эту новую картинку в зависимости от квари параметров в зависимости от той до счетчика и так далее вот фильтром это немножко другая сущность что такое фильтра помните нашу чейна фильтра по сути это обычный 1 связанный список каких-то фильтров и все что нужно сделать чтобы добавить в конкретный фильтр в свой гендер это просто взять статическую переменную джинкс который называется dom next хэдер фильтр ясность стоп-кадр фильтр добавить туда свои хендлер и все данном случае это у нас это у нас header фильтр идет и ваш finder будет вызываться каждый раз в какой то момент времени на этапе обработки фэдеров хороший практически пример нам нужно выставить свои cookies для к унтера и проверить допустим сменить ip тит куку скажем нужен на конкретный вид кукла все что надо сделать это по сути просто добавить новых игр фильтр и проверить но хедира которые поступают как-то с ними преобразоваться преобразовать уже в нормальную qq вот хороший пример зачем это используется еще такой хороший пример зачем это используется все знают такую директиву как это header джон каком-то стандарт узкую киску директива вот она использует этих игр это чем можешь там делать что угодно с heading to пышными ну и принципе вот вся инсталляции выглядит всегда так вот на самом деле тут еще body есть я про него забыл body уже срабатывает на у нее тоже идеология тот же список но срабатывает он и этапе уже обработки контента так и вот самое интересное наша структура request если вы будете когда-нибудь разрабатывать для engine.exe эта структура станет вашим лучшим другом вы будете часто ходить в этот ход возможно вы видели что-нибудь забиндить и чтобы быстро на нее прыгнуть оно огромное и и нам знать там очень много нюансов поэтому если вы хочу разрабатывать познакомьтесь этой структуры там нет ничего сложного там просто надо прочитать и понять она в себе хранит collection она всех хранит хедер и которые пришли от пользователя которые уйдут пользователя она хранит в себе всех эндеры обработчики свой собственный пул который работает на этом request я вот так же она хранит body более того как когда вам надо вычитать гарантированно целая боги либо послать гарантированно что engine x уже все поймет по сути он работает все время как ну как pipe он может не накопить до конца 17 послать точно кратера вам надо вызвать специальные функции используют конкретный request очень конкретной структуры костер вам пришло в ваш hander вот и тут мы подошли к самому интересному и самому наверное как бы это правильно сказать сложного моменту и жены с очень буфер в engine.exe любая работа с любым буфер мод очень буфер то есть это по сути одна связанный список буферов вот он очень citron может быть в файле это может быть ширад memory это может быть readonly memory это может быть темпами memory я подумал что здесь углубляться не буду в чин буфер потому что там очень много нюансов на самом деле главное все что о нем знать что у вас сообщение может прийти но вообще тело не в одном куске она может прийти по буферам маленьким маленьким кусочком это особенно важно когда вы разрабатываете обстрелу чтобы апстримом вам может прийти по 4к или вообще не знаю поборите к если вам надо это все прям за парсить вам надо будет делать какой-то хитрый потоку и партер который работает именно с членами я в принципе в тех примерах в ридми который ссылочку дам позже я скинул примеры на два таких up stream а кому будет интересно как именно реализовать внутрь engine.exe потоковый парсер потому что еще есть такой одну важные правила engine x нельзя блокировать у вас один worker даже если там есть открыт полым редко кто пользуется если вы это worker надолго заблокировали вы потеряли очень много рпс это тоже помнить всегда вот и немножечко че и вернемся опять после таврического сцепления очень буферов в принципе вот эта вся структура как выглядят то есть у нас есть позиция l'est если это файл файл поз соответственно таги и куча флагов и в принципе все эти комменты они еще взяты из engine.exe о них надо помнить представьте себе ваш фильтр ну или ладно ваши хэндов что угодно пришел кусок памяти который по мячу что его нельзя модифицировать то с таким такой контент вы не имеете права модифицировать вы должны его скопировать себе изменить какое вы хотите отдать дальше поэтому эти флаги их надо постоянно приятель еще вот хороший пример многие модули которые написал не работают с chain буфером если там стоит галочка infile потому что я хотел и был такой древний вот работал быстро если не дай бог у джен x начинает подтянуть из файла и сок шали счет куда-нибудь тает все умирает в этом таком случае очень логично скажем проверять чин буфер на то что он не infile если вам это не нужно и писать ну админу лог что вдруг вы крутите размер буфера пожалуйста поэтому это тоже хорошая структура с которой вы должны подружиться вот а вот этих примеры то есть своего upstream модуля я хоть и написал что примерно 6 модули для engine.exe а только один open source и вот собственно из него код показал то о чем я рассказал то есть здесь правда единстве что используется up stream чин буфер они request но они request буферы но логика тоже в принципе что просто проверяешь надо флажки и на эти флажки как-то определенно реагировать вот этот пример кода который сейчас скажу у многих работает вот здесь частности transcode это потоковый парсер которая долго мучительно делал вот вот мы дошли до прокси оправься как я сказал или об стримах или лот баланс страх на самом деле я не знаю как здесь правильно характеризовать потому что они все похожи ну с точки зрения реализации поэтому расскажу только саму идею зачем это существует но без деталей потому что там очень много нюансов я говорю я физически сколько не прогонял не укладывался с рассказом о том как их делать в назначенные вот на мой доклад рей ну время в принципе что такое up stream at proxy паз что делает прокси паз по сути что он делает это в chunk ум режиме но девчонки а точнее chain режиме отдает данные бэг-энда может на них было строить по разным правилам ничего не мешает вам прикрутить то любой протокола предположим у нас есть какой-то демон которая работает на про the busy ничего не мешает в engine.exe сделать на него балансировку и с преобразованием протокола то есть на вход к т т т т т т т с там с каким-то джейсоном скажем или даже знаю сырым про того фон и вы можете его преобразовать в чистый пар the buff и отдать апликэйшен серверу либо любой другой протокол вот в этом вся идея об стрима и по сути up stream это готовое api внутри engine икса которая позволяет а легко конфигурировать такую балансировку по ключу скажем еще каким-то критериям б делать бэкапы то есть случае если вы оставались все up stream он пойдет по-другому углу ну и очень много разных ручек для об стримов то есть сколько максимально файлов может быть китай mode и и так далее все доступность коробки я примеру не написал не успел точнее сделать как сделать ops 3 ману яву закончу надеюсь сегодня или завтра и выложат посылке которая я дам ну надеюсь все понятно объяснил четкую ops 3 мая что с ним можно сделать также помимо того помимо если вам не нужна преобразование в другой протокол вы можете их использовать для кастомные балансировки правда на мой взгляд часто не требуется потому что есть open расти и там есть отличная директива балансира бэйла а то есть можно балансировку написать сунул уаз любой кастомный логика не знаю хоть в редиску хоть и правда все сдохнем под нагрузкой на такой сделать можно вздох он сдохнет проверял большая нагрузка где просто пробыл у меня влетела цвету в потолок возможность залу острог я подозреваю потому что балансировка парламент когда я пробовал и самый больной вопрос на нем были сломаны тонну копий тысячу админов рыдали тысяч разработчиков матерились на админов это дипломе нг а ну я вначале сборки забыл сказать черт ножка слоя перепутал звиняюсь здесь показан новый способ сборки вон жены xeon недавно изменился я старый не стал показывать и специально ним не написал ни слова и я просто взял на самом деле из своего репозитория как вы как выглядят типичная конфигурация от этого икон engine.exe чтобы добавить модуль по сути это баш или shell вы просто описывать несколько переменных наш элей все вы можете даже при линковать не знаю си плюс плюс runtime суда вместо статической библиотеки если хотите то есть потом проблем никаких нет более того скажу по честному ялинка вал engine.exe плюс быстром тайма в этом проблем нет главное чтоб exception engineers не проник из плюсов потому что джинкс разнесет в ч потому что psy не очень дружу с плюсовым mixup шинами вот здесь просто описываем что где лежит а дальше просто заполняем вот этими переменами что я писал выше и джинны какие переменные и вызываем of the module of the module находятся внутри engine x репозитория а может быть этот новый способ сборки если эту пользуются им потому что старого старый способ сборки его скоро не станет как только все перейдут на свеженький engine x доставка вот она больная тема я ее ждал долго и упорно на протяжении наверное уже 3 лет мы все время просто собираем свой jing с кучей модуля вы просто его тепло им главное в отдельный от систем от системных индексов путей это очень важно потому что какой-нибудь админ спросони захочет engine и к со статусом поставить на пишет the path to get in стал engine x и полностью ложат твой сервер поэтому это очень важно плюс у нас есть несколько проектов 10 несколько совершенно разных индекс модулей так получилось том что это разные проекты внутри скажем mail.ru то есть срб есть топ mail.ru и не знаю почему это не объединить там нет противоречий просто так сложилось и мы до того дошли что просто уже дробим по имени проекта в пути куда все это кладем это более страдания на самом деле но сейчас она так второй путь который появился относительно недавно он правда пока не рабочие это выжженных сможем грудь и сошки почему он не рабочий потому что engine исправлять fingerprint это и сошки бинарный и чтобы он принял этот модуль у вас большое количество флагов сборки engine.exe вашего модули должно совпадать сейчас я придумал способ как-то решить в принципе упретесь допустим система debian или допуская буде бен и у нас там в принципе мы можем вытащить информацию с какими флагами джинны с был собран ничего не мешает свою модуль собрать такими же флагами а потом запаковать я это ещё не пробовал могут поставить это на рельсы но сейчас думаю в такое направление потому что грузить модули она проще но она носится больнее потому что есть проблема свингер принтом ну вроде как я знаю парни пытаются это решить ли верить их вики ну и второй вариант менее наверное популярен камер внутри мыло может быть в реальность стал популярный это докер люди берут обычные жены к обычные пути и просто делал с неё докер имидж и кладут на сервер но еще и там запускают но не знаю на сколько это , но просто у нас люди этим пользуются вот и теперь самый наверное провокационная вещь зачем их создавать ну а самый наверное ответ в лоб это потому что у тебя появляются новые технологии новые хотелки если вы хотите внести свою часть контрибуцию нужен x охоте за балку вы можете добавить какую-то классную фичу digimax или внести новую технологию внутри на жирных скажем пальцах от т.п. 30 это будет новый модуль вот это мой аргумент на котором заканчивается почти закончился заканчивались часто многие споры зачем нужен джонс модуль за то что многие используют индекс риверс праксис чтобы балансировать в какой-нибудь плюсы которые все что делают это указывают engine и косули клиенту как работать то есть такой ситуации логичней когда нет ни состоянии ничего вместо reverse proxy написать engineers модуль особенно в 100 нагруженных проектов это конечно если у вас все если у вас а при конечно хранить состоянии какие-то туда это уже тяжелее но опять же тут надо смотреть на задачу вот и поэтому мы перешли к решение бизнес-задач вот типичный пример это мой предпоследний точнее это было майтри предпоследних модуля для топлива до этого у нас там был обычный хтб серверов написанной руками когда никто не знает он был написан поддерживать его было почти нереально постоянно ломался были проблемы и так далее было волевое решение просто взять и переписать и логику ныне джон x сделать как несколько модулей модуль который раздает хуки модуль который формирует джесс файл которая дается на счетчика и два дополнительных имидж модуля специально для этого проекта блин 4 модуль дав получилось на даже вот что он делает по сути он принимает эти данные от пользователя формируют строчку и асинхронно это все логи рует на диск с чего эти логе уже поднимаются каунтер мы обсчитывать когда мы когда я сделал эти модульной engine.exe у нас лучше стало по циpкa как выяснилось наконец-то завел css цель правильно потому что это он неправильно работал тяжело все-таки сделать кошерные сосед внутри своего приложения это больно особенно его проверять так что вот хороший пример статистика аналитиком идеально вписывается состоянии нет есть cookies все ваши сцене общей пользы и как правило хранятся есть просто какой-то atomic инкремент но если у вас такая логика и она даст что просто делается на слушая не помню latency упала это сто процентов ну это кстати учу удивительно было потому что я вам давал что lacoste вырастет хорошо там был голый пол от прямом смысле голый и пол и функции 3 на 5 тысяч строчек кода ну потому что его написал неизвестно когда это было тоже неизвестно вот и сбоку где-то еще и ссср был который не работал так что честно не помню единство циpкa вирусу для из цели потому что он начал работать правильно вот я хорошо помню пришлось его делать менее кошерному вот рекламные системы вообще идеальный cayce ну я думаю тут либо opt-in расти либо прямо engineers модуль писать зависит уже от ваших потребностей толщину это все классика жанра и даже добавлять не буду там вообще почти состоянии нет вам нужно все что к этом abc алишер от memory между таким между вегасом и вашим телом который будет уже связи иметь и все вообще идеальный случай но я только неуверенность чтобы навести честно вот мой конвертация протоколов просто признаемся иллюзия у нас у всех это т.п. у нас у всех браузер и так далее и когда мы пишем кучу бинарного протокол на все это выливается что где-то есть хата т.п. то зачем нам лишние прослойки можно просто up stream написать который будет преобразовать их и ттп в протокол x все достаточно просто и на самом деле это не так сложно это самом деле вот мои работы по вечерам две недели я думаю у вас примерно столько это же уйдет причем это был тяжелый протокол островными хан шейками так ну и вот ссылка например и который обещал там три примера немножечко ссылочек на пару об стримов для ops 3 мая как сказал не успел написать то что я вчера это буквально написал до что у меня друзья сказали что вот эта презентация без примеров и полная там очень примитивный код буквально в 100 строчек кода там все то о чем я говорил плюс она делать дополнительную логику к примеру word каунт на body при фильтрация подмена контента и так далее то есть это можно скопировать и даже побаловаться там есть специальный майк файлы сели все что там короче описаны инструкции как это собрать вот я постараюсь расширить это и написать комментарии в коде потому что не успел вчера час на этом в принципе все понятно как я сказала уже ногти все сама документирующие ся вот главного учиться гриппом пользоваться то что кассета вам никак не привыкну бассейне как не просто я запущу это вот вопросы и контакты мои уложился давайте поблагодарим василия за выступление с данным докладом если у вас есть какие то вопросы можете прямо сейчас их задавать zdravstvuite спасибо за доклад вопрос по фильтр модулем по фильтр и бодрым на body есть какие-то инструменты для него что им и надо что-то вставить новую дан можно вставить ну вот эти чем буфера на самом деле все что надо сделать это посмотреть на то какую буфер пришел то есть можно его менять или нет если бы менять нельзя создать свой собственно не меняя этот скопировать тот изменить что хочешь просто либо chain травли пить по середине отдать но я по самом деле на к на голом все нет на самом деле это можно я не знаю мужчину скрипт это возможно сделать честно говоря этого ушел тем парням у тех парней спросить возможно это на linux хребте можно сделать не знаю еще вопросы будут там посмотрите кстати вот по ссылкам по примерам там просто word каунт он считает количество слов выдаваемых отеля вот там вот прям один в один то что о чем вы говорит просто немножечко на добавить можно просто побаловаться и все это конфигурируется то есть что за слово он считает в конфиге gemix а да да да да да смотрите если будут вопросы просто можете мне либо пнуть на твиттере либо прямо перед х бишь и создать отвечу ну раз уж больше нет вопросов у зрителей давайте поблагодарим еще раз василия спасибо ему большое если появятся какие-нибудь вопросы то вы сможете задать их уже в кулуарах"
}