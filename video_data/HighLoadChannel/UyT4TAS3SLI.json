{
  "video_id": "UyT4TAS3SLI",
  "channel": "HighLoadChannel",
  "title": "Distributing systems in Scala with Fiangle / Julio Capote (Twitter)",
  "views": 66,
  "duration": 1802,
  "published": "2017-04-22T14:47:44-07:00",
  "text": "здрасьте привет я буду выступать построения систем нас кого благодаря финал я потом расскажу что такое скалы и нагло начну я себя пожалуй меня зовут хулио хулио капота я работаю в команде 5 твиттере и в твиттере вы меня можете anansie от коттеджей в общем можете присылать свои вопросы и туда тоже поскорее пройтись по презентации потерпите с вопросами отвечу на них в конце выступления мы будем говорить про сервисы что они означают мы поговорим про скала и про финал и у меня будет много примеров потому что вы поняли о чём я вообще здесь веду речь масштабирование очень важно определиться в первую очередь с объем нашей работой масштабирование образовать большое количество пользователей часто люди не задумываются о том что масштабирование также предполагает разработчиков у вас может быть два разработчика которые начинают обслуживать систему на потом вы начинаете снимать больше человек и думать о том как расширять вашу систему соответственно ваша система должна поддерживать всех этих новых специалистов системы начинается с малого что-то простой простой прототип первые запускаете разворачиваете все хорошо и начинает пользоваться потом появляются новые функции и ваш систем должна выполнять кит новые задачи и наступает такой момент времени когда больше реки хан функций на эту систему нарастить невозможно возникает монолитное система это не хорошо потому что вы тогда ограничены одним языком и огнем runtime и может быть это не идеальный язык для всех ваших задач то есть вы сами себя ограничили также монолитная система поддерживает ограниченное число разработчиков и и чем я больше становится системы чем больше функциями появляется тем более опасными становятся развертывание потому что она новые фичи может вырубить всю систему как найти решение проблемы но обычно мы разбиваем систему на красных сервисов приходите на amazon amazon точка ком вот эта страничка она обращается к сотни разных внутренних сервисов в амазоне это рекомендация это лучший продукт сегодняшнего дня это разной оптимизацией для разных групп пользователей и так далее так далее это называется распределенной системы хорошее название преимущество такой системы состоят в том что каждый сервис использует свой собственный язык вы можете писать на том языке который лучше подходит под выполнение поставленной задачи и это хороший способ перенести систему к традиционно было написано одном может быть более медленным зыкиной ruby on rails например принести ее начнут более быстрая на java печкина что-то в этом роде распределенные системы означать что вы можете поддержки многим девелоперам вы можете девелоперов собрать вокруг разных систем соответственно определенной специалист работает над определенная система также означает что каждый сервис вы размещаете индивидуально но все равно все усложняется рано или поздно появляется вот систему куча сервисов обращаться к другим сервисам которые обращаются в очередь к новому число большому числу новых сервисов что делать с такой комплексностью невозможно конечно требовать от каждого девелоперов знать всю вашу систему эрик он знает приложение он знает сервис он знает эту логику и требовать от него чтобы узнал все это конечно не реалистично соответственно нужен какой-то проект какая-то модель платформа на которой арт общаться все или решение проблемы дебаггинга будет намного эти легче если все имеют возможность совместной работой и можно выхватить те проблемы которые сказываются на работоспособность всей системы финала как раз является такой платформой но мы начнем со скал потому что большинство моих примеров написано на скалах что к искал может вы и не слышали не слыхали когда просто ласкала это новый заживем он компилирует бойкоте машин java есть рацион и совместимость java то есть он может быть что-то написано на java который обращается к тому что написано на скала и также код на скалы может обращаться к тому что персонажа во это функциональный язык java традиционно ориентирована объекта это объект ориентированный язык все что происходит с этим объектом свойство сам этого объекта это java но и скрыла ориентированного объекта есть принципе получается лучше из двух номеров какие-то проблемы проще описать и функциональные математические другие скажем big ориентированном языке терминах объекта начинаем есть значение очень просто есть значению stringvar это из-за меня жалость как сначала у нас тип перед переменной а здесь в этот шаг здесь наоборот я наперед типом дальше возрасте с 27 и доехав скала не обязательно даже указывает тип и в большинстве случаев можем вот так написать это более еду больше похоже на ruby и на другого и современный язык где нет типов это то же самое да это одно и то же - а литва разными способами дальше есть лекции стандартно есть лист и выписок все одного типа есть последовательности эту порядок еще не все мальчики есть словари и крыши этом мы под foobar и когда я вот хороший сейчас будет пример у нас значение advan это равно x и добавляем единицу к иксу и возвращаем мы можем использовать функцию через of light light 2 получаем 3 вот такое функциональное применение широко распространено искала можно напрямую получить эту функцию я там со второй раз а там же написано протащим слайде мы можем сделать 4 и можем сделать мэр по этому списку и обман и вращать по каждому значению + 1 соответственно мы получим то же самое список что и раньше но каждое значение будет увеличена на единицу это устранён эй премьер это можно встретить и в рубли не знаю все еще похоже на каждого вы можете написать вот так я прямо им оставить пустой сначала либо вообще можете этого не делать либо вообще может и все упростить с точки обойтись и без кубок обойтись можно мне кажется совсем просто и легко читается когда вам приходится в одном коде дальше что мы делаем мы добавляем по единице к каждое значение будем фильтровать потом четные числа очень легко выразить вот такую операцию с помощью этого языка вы можете делать композиции для нас это будет важно при дальнейшем изложении материала одну секундочку чуточку подвисла и мы можем еще такое значение сделать это и это вы соответственно о соединении с ума и дуа нет 2 делаем и получаем 5 объект ориентированные маккуорри классы но да все как обычно все что имеет смысла для вас еще класса то что мне очень нравится скала то чего нет java но кто потерял община называется это сокращает количество исключения но который может иметь программа загадочная штука смотрите чтобы начать мы foobar и из музыки а мы как мы получаем извлеченный из куба мы хотели получить значение для фу и здесь поскольку map возвращаются разные варианты общем мы получаем сумму барыс а не знал значение то есть что-то там есть в этом ящике и такие она пользуется обычно это вот такой такая зависит даст вам исключение в программе но вместо этого мы получаем нам соответственно способ работы с этими значениями очень простые я хочу показать вам так скажу общем кадровая сигет из-за карты map этого не существует природе наркозе вы этого не знаете прочти соответственно вы пишете i get a little girls то что внутри это общая а если это на тогда используем дефолтное значение постоянно делая программирование для заполнения каких значений стандартных библиотеки скалы и примеру вы найдете много смотрите на что получается мы можем еще сказать так и с кейсом x когда верни x а если нет тогда верни leave a like i do it есть много разных способов работ с классами и которые помогут вам в таких стандартных еще одна прекрасная штука это то что общем это просто коллекция месяце их рассматривать капусты коллекции лета коллекции же еще одно значение foreach и проще общаться за принцем результаты из тафты есть мы увидим результат если нет если коллекции пусто и дальше ничего не увидим это тоже будет нам важно в будущем пока просто запомните это теперь переходим к финалу фреймворков которую мы написали power для этого используем на еси и потому что бы наши внутренние сервисы в твиттере было бы проще писать уволит в ригу в такой финал flight center фреймворка писем вор клиент-серверный вы можете описать или клиенты sofinag они могут использоваться метод но при этом понимать друг друга асинхронный станете все делается функций call back в режиме колпак и есть лупы событий и не обязательно ждать ответа для продолжения ваших операций то есть вы можете конкретно указать последовательностью порядочность операции на кирпич вот происходить в новом режиме по мере необходимости и надо тоже функциональная штука потому что полностью траншей философию функций скала и композиции и тогда верните все это более подробно например а чуть позже безразличен к протоколу вы можете иметь или в твиттере мы используем кэш есть много разных протоколов которые вы можете реализовать поверх и виноград очень гибкая штука говорим про фьючерс фьючерсы так учила концепция финал это единая валюта так сказать когда мы говорим о параллельных операций в системе что к фьючер вечер это тоже такой черный ящик мы знали что внутри мы не знак когда он будет канала крым вернется когда вернется к нам это значение потому что это природа параллельных операций мы еще не знаем будет успех или провал от операции этот некий компромисс но благодаря этому компромиссов мужу многие вещи делать одновременно давайте посмотрим как это выглядит на примере есть такой мир называется печи уралом берем и возвращает фьючер ответ скажем фьючер такой контейнер получается вот примерно так ответ может быть все что угодно и мы пишем хочу и возвращаем поскольку это тоже коллекция также каков шанс и мы можем делать map мы можем сделать обычные лишь которые мы делаем из коллекции на семантику тут интересно потому что это требует ваш если некоторые еще могли не проезжаете мы сделаем мягкого ответа когда-то приходит неважно когда он приходит на клаве чтобы он пришел тогда мы напечатали талант а еще интересно цвет будет продолжаться мы будет регистрировать school bag гарри реализация вне зависимости от вас от разработчика это очень полезная штука им болезней н а сам боролся за что произойдет в случае успешного ответа или неуспешного если наш успех унисекс с тогда мы выводим результат если нет тогда лог говорим план сервисы что такое означает внутри final ericsson один из разработчиков твиттере написал замечательную статью которая называется ее server is a function ваш сервер функция презентации есть ссылка на слайд и он там рассказывает что кофе на голы как он облегчает жизнь разработчикам можете себе представить что в сервисе есть вопросам и ответам получается запрос ребятам фьючер ответа это основа основ любого вашего сервера правильно из запрос и приходит ответ пихает если взять и клиент мы отправляем запрос и получаем у червей сервис для мы реализуем красавец мы делаем запрос делаем объект вопрос по разным заразит как мы уже говорили с через скобки или без google play диспансер и хвалили квесты на говорим что если будет успех то печатать это тоже самое через заплатил внести наверно у нас похожи примера в предыдущем разное мы размещаем пылаем функцию и получаем ответ как дает ответ собственно случается здесь запрос клиента и что делал случае успеха а еще тут мы видим новую функцию white раньше что охрана и начну функция колдера сервер этот поток не будем ждать пока образуется ответ поэтому же в основном потоке мы говорим о системе что нужно подождать обычно сьют реализуюсь контексте уже ждет ждет уйма что бесконечные соответственно для того что у ментов полными то вы можете добавить сюда для того что против паузы и чтобы система жилось ответа или сервер например на со стекла сама server service response опроса привет и вы применяете плавить этот запрос мы сами это делаем мы здесь говорим это и тогда сэр получает запрос он должен вернуть значением фьючерс нового ответа хай это то как вы возвращаете значение немедленно видов обычно здесь происходит запрос backend который сам по себе вы можете это толще через ответная play и я покажу потом же воли кантри примеры станет еще более понятно еще раз запрос request фьючер и снова сервера мы создаем на сервис сервис определяем классы до называем его еще пяточка surf необходимо мы тоже переносе сервис на этот порт и ждем пока работу клиентов которые мы только что создали мы можем прокси пример потому что насколько все финал просто и у нас есть крылья сделали его уже с вами раньше google . 80 порт и сервер который клиент клиент у нас сервис тоже можем обработать closure это полный прокси-сервер человеку и мы ждем вот книга предлагает вам еще работал интернет проект это то что модифицирует пару примерно такой фильтр высоте же успел 2 пойда запроса ходящие исходящего и также входящих ответов большинстве случаев это один и тот же тип вы можете использовать простой фильтр simple фильтров вы указываете просто способ использовать api и фильтра делаем request входящий а потом сервис который мы заворачиваем и возвращаем фьючер ответ здесь есть фильтр который называет screen filter он что делает заворачивается и сервис и добавлять питательный знак к любому ответу который мы заворачиваем или расширяем простой фильтр simple фильтр таким образом есть используемой и что делал случае успеха если что происходит успешно но и должны установить кататься контент сайта вот это которой предлагал решили добавить к этому ответу ! response контент поскольку это этот пример который мы видели раньше используем фильтр и помните про позиции мы используем композиции функций для того что вы планируете интернет-сервис у него отличная система метриках и если вы собираете статистику the pinnacle тоже собирается для вас классическим данных и потому что l дебаггинга приобрести время таймс много разных значения если вы будете использовать нога обычно он слушает по борту администратора неважно какой сервис cash-in что-то у вас обычно есть администраций порт и в твиттере у нас есть коллектор и которые забирают это все в одну базу данных а потом мы можем обращаться и анализировать и смотреть как там все идут дела и как производительность это пример того как это выглядит изнутри вы видите что мы собираем подробные метрики 5070 средние значения среди арифметические максимальные и минимальные много всего вы можете дополнять эту библиотеку своими собственными метриками то же самое иман сервер который мужественными хорошо знаем можем добавить сюда еще сбор статистики на север и поставить счетчик hunter x hunter он будет отслеживать эти перемены и вы можете и секундомер и таймер и мы можем измерить скорость время исполнения этой операции по средним и по по 99 это как талия и на хороших способов начать работать с кино голове предлагаю вам финансов в риан это система притом коуди который объединяет opel senator сенатор получается выглядит это примерно так get flash request нам передали и он выдает простой хай и видите как возврата через фильтр иностранном тоже асинхронная сенатора есть сервер когда расширяется на 3 сервере создаем контроллер регистрируем его на серафина то и все соответственно это сайт на котором вы можете найти дополнительную информацию там есть там плиты и джейсон метрики и фильтры и все остальное это очень хороший способ знакомства со скалы и я сам учился скале и есть общение рейтер приложение с которым вы можете поиграть для того чтобы в эту тему войти по душе если у вас есть вопросы то пожалуйста задавайте это дополнительные ссылки финал гайд там вы найдете но могу больше информации помятой что я только что изложил как использовать она как писать турин сервер как реализовать коды и так далее а это статья который я уже в minnow очень явные настоятельно рекомендую а это сафина так все и если у вас есть вопросы то с удовольствием они хотят спасибо в чем основные преимущества от использование скалы и фена гола по сравнению с другими программными языками например поэтому торнадо в чем основные преимущества скала смысле оптимизации или реализации хороший вопрос вы можете использовать все что вам нравится мы как компания хотели использовать то то что вы основа с на живьем обычным историческим использовали разруби и сейчас современных и девелоперов трудно заставить его использовать скажем на прямой java of scale и есть как раз та экспрессивно сть которые людям нравятся в ruby и python но при этом скорость и инструмент профилирования там намного лучше и приложение очень легко управлять и администрировать такие сколько сервисов работать этой технологии и вы используете promises потому что java есть похоже концепцию для клиентов все сервисы в твиттере использует сингл у нас сейчас наверное больше ста и будут появляться новые потому что они все время так делают время появляются в фантазии использованием и promises честно говоря про фонтант не очень хорошо знаю потому что я сам из бэг-энда но я думаю в наших фреймворков для фронтэнда реализовано чтобы похоже я хочу спросить как вы поддерживаете совместимость сетью в каком смысле как вы поддерживаете совместимость сетью вы говорите у вас много много разных сервисов какие-то из них же устаревают другие про то более современные вот как вы следите за понятно афинагор удобная вещь потому что там есть возможность балансировки нагрузки и создание связей можете создать список хостов или звуки бернарда чтобы извлекать списке хвостов можно так следить за этим зоопарком клиент знает что когда используется функция плане она случайно извлекается из пула есть разные стратегии конфигурирования мы еще делаем мышцы заметили убирается при определенных условиях какие-то функции потом они также добавляются то есть за кулисами так сказать идет большая работа который делает систему более надежной и устойчивой меня есть вопрос про версии пьянь скала или другой фреймворк он дает возможность публиковать новые версии 5 а крем который работает предыдущей версии 1 продолжать не робот а я понял что вы спрашиваете про разные версии и про совместимость версий совместимы но зависит от поставщика и 5 и вот клиента если они не будут пытаться сломать эту систему для того чтобы использовать разные версии сама ничего не сломается только если вы не будете что-то паре питаться сломать специальные если вы нибудь менять какие-то параметры там но между релизами мысль до мы стараемся обеспечить совместимость в основном это совместимость имеет место скажем так страсти а есть у вас пример как сколари финал подключается к существующим проекта ржа да если вы придете в финал гайд от amd руководстве нога там очень много примеров сотни примеров по java в твиттере и есть ржавые финалы если что такое взаимное уважение между java и финальным поддерживаем и тот и другой язык несмотря на то что она долга it вы найдете опускала я вижу больше вопросов нет спасибо"
}