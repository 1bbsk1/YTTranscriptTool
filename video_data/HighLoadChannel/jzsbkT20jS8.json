{
  "video_id": "jzsbkT20jS8",
  "channel": "HighLoadChannel",
  "title": "Устройство распределенной точки обмена трафика Cloud IX снижение затрат оператора связи / Дм. Шар",
  "views": 433,
  "duration": 2055,
  "published": "2017-04-22T14:45:49-07:00",
  "text": "доклад про то как сэкономить свои деньги все мы знаем про то что есть точки обмена трафиком представьте себе распределенную сеть обмена трафиком с точками обмена в десятках городов вот именно об этом и пойдет речь в докладе дмитрия шарова устройство распределенной точки обмена трафика клауд ай икс дмитрий прошу на сцену оказанием услуг разных городах нашей страны и какой-то момент времени мы решили сделать себя стартап уйти от понятие область и выходить у нас родилась идея создать проект про который я расскажу про организационную участие потому что техника это конечно очень хорошо впитывает и данную сильно реальная жизнь относительно которая любит ибо это существует тоже нему не менее важно потому что если не будет реально инфраструктуры реального бизнеса то конечно же тогда и этики будни ошибка нужны что мы сделали в свое время мы построили инфраструктуру операторскую в москве и санкт-петербурге и стали оказывать услуги связи различным контент-провайдером различным операторам связи по мере это строительство этой сети мы решили что было бы неплохо изменить идеологию не продавать связанность интернет а предоставлять сервис и предоставляет сервис обмена трафиком для участников мы построили довольно большое сейчас на следующем слайде я расскажу мы объединили прошли своими каналами связи через россию это москва воронеж ушли в харьков киев-львов дальше франкфурт вернулись в россию и через петербург и обратно замку ритор на москву построили некий большой футбол и дальше уже относительно этого погоны начали строить такие ответвления для того чтобы это все когда начали строить мы столкнулись большой проблемой о том что в различных городах нашей необъятной родины не существует каких-то точек определенных мест где операторы связи и контент ресурсы могут спокойно между с тобой состыковаться возникают эти ограничительные вещи виде ростелекома других операторов связи и мы как владельцы сити дата-центров у нас есть торговая марка to the house у нас есть свои дата центры в москве в петербурге сейчас мы строим дата центр в екатеринбурге есть работающий функционирующий в красноярске в запланированные владимир воронеж то есть мы наша задача это движение в том числе контента в точке его потребления вот мы изменили идеологию дата-центра da da house и сказали что это площадки нейтральности и сейчас оператора связи как бы там в эти города где ему есть начинают также подтягиваться как бы для того чтобы включаться в сетями на трафика я расскажу про общую диалоги а вот техническую реализацию того как это все существует будет рассказывать наш там главный специалист по тарелочкам технический директор антон евгений нехороших это отдельная про него расскажу суть в общем-то довольно простая построив стратегические цели как бы наши понятно мы пытаемся сдвинуть большие массируют трафика из точек его концентрация это москва петербург киев в региональные места то есть мы или этот трафик пытаемся вывести к точкам его потребление соответственно и же стараемся развивать всякие статистические инструменты потому что объемы трафике которые сейчас проходят внутри нашей сети они и значительные начинают расти по мере включения операторов связи и контент ресурсов и соответственно мы видим в большом массиве данных каким образом трафик перетекает внутри как страны так и как бы города то есть это очень интересные данные то какая эти инструменты тоже запланированы в рамках нашей системы тоже там антон евгенич коснется нажать ну на сегодняшний момент времени я уже сказал что мы построили и строим эти дата-центры где контент эти петельки байтики могут размещаться и ставится это москва и санкт-петербург владимир там сейчас идет проектирование екатеринбург красноярска тоже рабочие дата центра киев одесса это украина собственно вот так вот представлять на сегодняшний момент времени эта сеть то есть это вот эти города частью это уже функционирующий ядро city про которые я говорил это в рамках вот этой всей большой географии трафик ходит в рамках никого кольца опять-таки все технические нюансы как это все там происходит это все вот антонович будет вот на своем правильном техническом языке рассказывать а я просто вот покажу здесь то есть у нас есть включение в амстердаме во франкфурте в любовь и харькове вот и вот небольшое колечко запланирована в следующем году этому беларусь и казахстан а это уже дальше антонович будет рассказывать собственно в рамках каждого города рамках большой вот эта инфраструктура эта клава доить в каждый город спускаем профессиональную . обе на трафиком то есть мы говорим что в рамках локального города будь то это москва будет это было диммер будет а екатеринбург локальный трафик локальных решений которые мы приводим за собой со всем этим оборудованием абсолютно ничего не стоит а его участников ровно по одной простой причине что бизнес идеологии бизнес-модель клондайк за это как бы как раз оптимизации затрат на включение как бы оператора связи либо контент ресурса в эту сеть то есть в рамках этого мы говорим что на каждом городе мы не читаем трафик и еще называем абсолютно бесплатно мы здесь не стали публиковать некую матрицу как бы доступность в этих городах но учитывая то что нашей компании уже там больше 12 лет то москве это примерно там 15 а может больше различных дата-центров которые здесь москве существует этот это центры в санкт-петербурге это любые играют все города которые есть в этом списке мы стараемся максимально охватить как бы для того чтобы контент который вы разрабатываете либо контент который мы вы иметь отношения могут совершенно спокойно к нам включится то есть это порядка 15 узлов в москве это петербурге это даже вот маленький город воронеж который является центром черноземья мы в свое время постарались сделать так что все возможные зависимы или независимой площадки как бы объединены нашу сеть то есть помимо того что мы строим эту большую структуру в каждом из городов мы проводим колоссальную работу по строительству это центра либо по организации связи внутри города также мы делаем важные вещи которые касательно контента это 10 запланировано и идет сейчас разработки там сидели на то есть для того чтобы трафик гораздо эффективнее хотел внутри также в рамках портах значение которые мы обеспечиваем для контента или операторов связи мы спускаем моника мультисервис ность это значит акиты вы мы даем также это тоже очень интересное решение этот стартап это стартап который сейчас запустился до старта который сейчас работает мне очень интересно смотреть как он развивается потому что сейчас ведут включения во всех этих городах которые есть и вот предыдущий бачек говорил про большие объемы скоростей здесь они абсолютно реальны они все эти существуют в рамках такого забавного большого кольца я с огромным удовольствием там сейчас представлю там антоновичу нехороших это человек который является разработчиком не только вот и владеет информацией потому как устроен клава кт интернет и ксенчик он еще является разработчику многих-многих других программных продуктов и в том числе какое знает точно не знает никто в том числе и я передаю слово но на самом деле буду рассказывать больше пойдет них действительно по всяким сервисным вещам этот дмитрий слова у нас мастер вот на этом плане хочу продемонстрировать на самом деле самую простую обычную точку обмен трафиком ее можно сделать практически на коленке дома в этом сейчас на текущий от времени какие хитрости не надо для этого достаточно взять обычный коммутатор первого второго уровня там какого вот дома нашли хоп подойдет спокойно для тех цель весь принцип построения обмена трафиком точки завязан на тех двух замечательных маленьких коробках рон серверах на которых крутится любая программка птичка up in bgp или кварков которая позволяет вам строить таблицей маршрутизации и немало важный принцип работать всей этой системы завязан на том что во всех этих таблицах муж цитируемых передается на khol не road сервер а участника системы тем самым нагрузка никогда не попадает на обычный сервера а весь трафик бегает в пределах коммутатора только то есть вот так устроен обычная . обмена трафиком любого города единственное что там может быть меняться это вот тот самый switch на котором надо больше больше больше больше пропускать способность который может не хватать в рамках города вот то что там написано это там джунипер ли экстрим это в принципе не обязательно условие говорят для начального уровня если вы хотите перемен тировать или что-то сделать вас спокойно устроит любой храм коммутатор там начального уровня без всяких проблем то есть вы можете это даже поэкспериментировать подняв там два общежития связав там на приватных сетях вина приватных автономных системах и все у вас будет работать и будет отваривать любые вещи ну соответственно кого любит и мы пошли дальше и нам вот эти точечки пришлось соединиться с такую стеночку все у нас было хорошо до того момента как нам возникла необходимость соединить множество таких точек в разных городах между собой при этом немаловажной задачей мы оставляем возможность им локально обвинил ся между собой если человек не хочет получать префиксы трафик за пределами пограничном ушки затар а вот и джони и много сольется с учат 80 то он у нас соответственно получает маршрута из таблицы роутинга ты вот basic скажем так создав эту систему мы себе усложнили тем что нам пришлось создать множество таблицу роутинга маршрутизация которые в дальнейшем вот допустим если человек хочет выйти клиент из так сказать локального облака в глобальное то он должен получить некий набор префикса в которой присутствует соседнем облаке то есть соответственно мы платим сколько нужно таблицах маршрутизации в зависимости от того какую мы сервиса хотим предоставлять клиентам задача в принципе не столько сетевая сколько относится к программированию потому что на предыдущем слайде я назвал несколько программ это burton bdp-2 на которых вы собственно регулируете как воздвигает трафика строится таблица иммунизации и в рамках этих программ мы выбрали bird честно скажем потому что там больше гибкости с точки зрения построения маршрутизация если он на что-то хочется попроще вы можете взять какой-то cisco ставил некий интерфейс котором вы очень красиво все настраиваете коммутаторы которые мы берем для этого решения вот перечислены две модели джунипер extreme зависимости почему мы и выбрали радостям стала значит во первых это все части гигабитный коммутатор и то есть там в 4 1500 40 портов 10 гигабит на 670 ом 48 значит но есть маленькие особенности вот если увижу ни пера можно предположим у нас кончается емкость портов в каком-то городе то есть здесь от города мы ставим нужным в каком-то городе кончаю кварты стою проблема расширения вот у джунипер и его базовой поставке очень удобная система zakirova нее спортом interconnect она который позволяет соединять стек 128 гигов соединение делать между двумя устройствами то есть очень удобно масштабируется если мало бортов то есть если вы в теме мы будем это делать из archon аламин наращивать десяточный портами связывать между коммутаторами то здесь от гордо выбираем нужную модель понятно что если брать уровень москвы и санкт-петербурга танки его скорее всего тут и такие модели не пройдут потому что там надо брать горем серьезное устройство типа блокадой манов которые там 12 торопиться пропуская способностью их как базовое вот построив такую архитектуру соответственно возникла проблема помимо одни трафика предоставлять людям другие сервисы и всего облака так как мы научились в принципе не планете кучу сайте филонов то есть вот клиента подключается у нас коммутаторе акса методом нет tranque а получается обычный спорт и усердием мы все отдаем мы приложили никто усилие реализовали возможность учета этих сервисов в рамках байтов пакетиков там зависимости от сервиса какой получается и соответственно начали возникать идеи что мы можем еще предложить основная идея это было начало как будет минус он сказал это хана тебе припяти we have с точки зрения если это в допустим во владимире это в общем-то не нужно потому что это рядом с москвой и тут все хорошо там из москвы инете вида летает multicast вам то есть речь идёт про хотя бы чуть подальше регионы появляться в триста-четыреста вот когда дальше уходит сигнал типичный возникают проблемы которые во первых multicast гнать из центрального региона просто не интересно потому что ну зачем занимать полосу на магистралях если можно поставить ти ви хав под систему с тарелкой и подмешать туда что немаловажно локальный сигнал для того чтобы люди смотрели новости например своего региона они новости камчатского края когда мы то ненужную это по поводу телевидение дальше еще сервис понятно что сервис сиены он нам позволяет разгрузить наши магистральные каналы и предоставить более быстрый доступ клиентам оператором какому-то конфету например использование сиена популярный сейчас вот в регионах это доступ к приобрету который кэшируется и позволяет не гонять больше объема трафика в сторону youtube в бассейн магистралей то есть все в основном оседает на coursera есть это вот то что был касалось непосредственно архитектуры то что с чем мы столкнулись на этапе строительства этих вещей мы взяли проапгрейдили все hydra сити и перешли на джипе значит москве но стоит 960 в регионах мы ставим восьмидесятые причем мы не ставим привычные модели там две строковые 470 и потому что вот этот разрыв прям каиде железо очень большой получается мы берем или младшую модель либо страна слова хорошие при внедрении этой системы вы столкнулись с тем что от эту мышь нацист у нас были систему аналитики которые все считали все было хорошо когда поставили шум перту случайно узнали что оказывается вся система аналитики вас закралось бы там там всего лишь потому что вроде как сказал creed нам на полу не нравится мы будем изобретать свои штуки и придумали jakl собственно говоря пришлось за оперативный режим этом порядка там где-то за месяц придумаю секреты которые из антисекс а которые транслируют сэр джон непер и converter v 2 ну сделали мы были счастливы у нас пошла статистика все хорошо но тут опять случилось горе которые джунгарского так вышло в это вводите x который кто-то говорил о не передаются индификатор автономных систем но там либо случайное число либо 0 соответствовать никого еще одна задачка которая тоже там приносит очень короткое время решать мы и решили у нас получилось что мы за где-то на 60 там 50 тысяч пакетов в секунду of law трафика на одном из коллекторов предположим нам приходится лука пить соцсети совершила патриса для них автономной системы а это примерно 200000 префиксов надо посмотреть парой пускай базиль и звуками вот эту проблему мы тоже пришлось решать и мы решили успешно за счет этого как раз в метро человек аналитиком и в ней тоже все занимаемся нам интересно знаете как трафик разбегается по регионам потому что не знает разбегается мы не сможем улучшить или оптимизировать свою сеть чтобы контент оставался как можно быстрее ну это собственно говоря hydra сити замкнуты который год проходит питер-москва гифы франком все до этого это была услуга третьем уровне обида сейчас я хочу показать как еще можно использовать облака . клауд мы всегда забываем что людям бывают нужны обычные транспорт и которые нет третьего уровня обычный там соединить два часа без внедрения дорогостоящих железо война консультации трафика из одного протокола в другой обычный l2 люди хотят получить обычный транспорт вот соответственно примере есть клиент во франкфурте есть где-то в москве по умолчанию они соединились и лучше маршрут через киев был выбран случае построения вот обычными методами сити вот если вот так вот сейчас случится то все все умерло клиент остался без связанность ну в нашем случае соответственно пойдет верхнем маршрутов и это делается уже на я буду называть на уровне два с половиной то есть mls такие плохие вещи собирается трасса примерно реконструкция как пойдет наш ум на втором уровне может достигать до 30 секунд конечно но в отличие от третьего уровня вот на этих точках нам в вас уровне можно оценивать загруженность всех магистралей и клиента второго уровня пойдет даже боли приедет на маршрутом нежели клиент третьего уровня тоже догонять и который мы тоже в сеть внедряем ну собственно говоря вот это как в конечном итоге выглядит наша сеть вот этих соединений между точками это надо рассматривать не как вот там идет оптоволокно для леонович допустим вот москва киев два маршрута нарисованы на карте ну сразу значит по праву маршрута который без сбросов в городах там идет несколько лет и мы стараемся брать разными маршрутами левый маршрут который идет со сбросами в харьков белгород штука там тоже будут разные маршруты мы переживаем за то что наши связанных должна быть как вкопанный не дай бог она разрушится потому что вы останетесь без сервисов мы максимально даже вот с точки зрения вот ответвления владимира в нижний новгород хотя оно и идет вроде как бы отдать тропиночка мы там всегда предусматриваем что там будут резервные волокнам лямды от других сторонних операторов которые не идут в одном колоссы образом значит ведро сити вот тут понятные москва санкт-петербург киев франкфорт из за того что у нас находится с красноярске дата-центр достаточно большой нам пришлось строить туда ответвления попутно мы сейчас запускаем дата центр в екатеринбурге как раз покупатель на сибирь все эти вещи которые я рассказал и они есть работают и просто надо временно внедрение ну по преимуществу немножко опять немножко уйду все-таки от техники коммерцию вот благодаря всем нашим техническим изысканием мы на самом деле достигли то что клиент не надо заморачиваться городить в кучу планов поднимать кучу всяких соси в этот порт в этот порт мы все сделали так что это наша забота и поэтому с любым слуга даем с одного борта мы научились читать и полосы мы научились считать и байты то есть как хотим так и считаем причем считаем и сервисы можем считать это в какие из какого борту этой и в какие регионы все это улетай утилизация марта это как раз заменить имелось ввиду в том что в один порт мы наливаем все утилизируем у по максимуму то есть мир практика стандартные подключение чем говорит о том что вы воткнулись в этот порт систему учета и качения говорит вот вам ребята гигабит два с половиной мегабита 10 больше мы не как считать не можем и сюда наливается только логово общение больше ничего извините другом мы не умеем потому что надо считать это все они это просто не могут в общем это не значит да вот возможности поставить коммунити мы оставили возможность к любому клиенту который выходит за пределы локального админа точки 1 и трафиком регулировать как он хочет с кем общаться он может любому оператору запретить у тебя видеть он хочет там не хочу видеть этом киев из москвы пожалуйста не будет он как может регионами закрывать он может закрывать операторами это на его выбор остается он получает то что он хочет ну как правило оператор за несколько стыков какой ты у дешевле какое-то дороже он может выбрать для себя направление более экономическое которым он выгодно будет работать возможность получать трафик в других точек обмен дырочками на предыдущем слайде у нас есть включение вообще excel крупные где маленькие бизарро тельства нас и дятла исключение и весь этот трафик на текущий момент мы отдаем внутри нашего облака то есть люди которые там подключаются у нас там допустим в воронеже у нас узел стоит понятно что централизация трафика у нас киев москва питер происходит вот мы ту возможность деталей в регион пожалуйста собирайте пользуйтесь мы лучше ли связность маршруты стали короче трафику выбежала гораздо больше первый день включение там киеву вот мы подняли когда вы одна газель он там практически сразу десятка скушал из-за того что маршрута стали прямее со стола ближе операторы в первый же день попросили нам а можно как-то регулировать это дело мы не ожидали потому что там слишком трафиком нового 1 можно притушить это пока то есть такой приятный сюрприз выскочил значит узлы на всех площадках города каркал бедра числа например в воронеж хороший город для того чтобы обеспечить соединение доступной то есть наша цель это доступность сервиса во всех участках города мы сделали три точки три точки подключения на всех трех точках стоят 40 портовые гигабитный коммутатор в которых не в кольцо мы готовы включать там людей наш принцип чтобы удобно было оператор стыковаться потому зачастую все-таки есть точки обмена трафиком и тоже очень видно в регионах где жесткие условия там не дадут камер зависти или еще что то в этой рамке для операторов и никакого продвижения не тут чтобы понимали например разницы цены интернета то есть если в москве то там допустим 100 рублей за мигом образу замигает топ в красноярске недавно было 700 рублей вся стала 500 рублей то есть мы двигаем эта масса чтобы вы все-таки стал и подешевле по доступнее потому что как только становится интернет доступней мы на аналитический всех наших график видим всплески как народ пошел в сеть это сразу видно подключение но связи с тем что мы ставим железки портами который ну тут сам оптимально это либо гигабит и выключения будете которые вы можете на полную катушку утилизировать тарификация нутрификация зависимости от услуги да мы научились это считать причем научились считать достаточно прозрачно без нагрузки на сильное оборудование и почему была выбрана я являюсь коммутатора не позволяй такую вещь делать как то есть мы навешиваем формальные счетчик ethernet именно на соединением с клиентами которые регулируют различные сервисы включали счетчики тем самым получаем счетчики входящие восходящего направления и дальше эти счетчики умеем запирать пойти на это тоже было выбрано не случайно по оборудованию чтобы это барду не позволяла и еще не маловажный такой фактор навешивая всегда firewall и на что-то обычно подрывается что очень сильно возникает загрузка на процессор при большом объеме трафика от этих устройствах если там ethernet фильтр навешивать на порты и тогда подобное не вызывает большой нагрузки на процессор этим надо пользоваться потому что эти люди боятся включать фаерволы думаю сейчас у меня вся железка скрутиться тома 10 гигабит трафика на самом деле это мы объявить нормально да и есть ли правила подключения в нашей системе томить надо автономную систему приватная автономная система мы не можете держать то есть тут становитесь лером или получаете просто автономную систему и смелых подключайтесь добро пожаловать к нам собственно коротенько было так закончено если шток готов ответить на ваши вопросы спасибо давай объясняй чтобы было удобнее вам рассказывать предположим этот раунд сервер служит для того чтобы обеспечивать работу ветерок таблицы вот эти вот таблица они создаются именно научили я нашел где они расположены по вашей инфраструктуре каждому в каждом каждом вас как старая не сеть и сеть все у меня все вместе взойти за такую услугу если люди берут то понятно дальше l3 они не жалел трение не пускаются давай мне нужно это вот делается на джамперах многих на магистрали мы регулируем куда там падет человек налево или направо всегда мы единственное что делает джунипер он обеспечивает доставку вот этих различных таблиц из других регионов и опять она дает и the world сервера то есть вот данном картинки джунипер является тем же самым участникам локального ячейки который подключен также имелись у кроссовера обмениваются допустим basic ну вы сказали basic это то что таблицу только локального трафика она не выходит за пределы нет нет мы это не делаем потому что если мы сделаем сессию между горы серверами the traffic побежит через р с сервера а это нельзя делать смотря какая статистика для учета трафика на борту направлении по mac-адресу используем да с точки зрения аналитики тут очень большой такой набор во первых я уже говорю что нам пришлось решать проблему в эти фиксе это лука по автономных систем которых отсутствует второе когда нам там теряется источник и получатель трафика мы ты решил следующим образом наперед серверов цру клены периодичностью снимаются анонсы тех участников которые есть и те которые люди сторону облака и список этих эффектов участвуют в системе аналитики для определения текущего пропитание пакета пакет пролетел над луками ли автономку source destination еще от лука пили откуда и в какое направление прошел пакет я согласен колесе в этом есть ну регионов очень редко тут мы смотрим кто анонсирует префект есть это пройти я знаю прекрасно предположим ситуацию что есть два миранда раза которого сидит третий оператор и подключен с юности рука городов и префикс может ли подтверждала противным и через то есть но почти редко такое бывает когда можно снимать с чем связан если вы с ним проблемы теперь они просто перестали справляться переходить переходим на деньги потому что ну как бы он не был занят помогает и вообще еще называли как конкурентного преимущества дают 3 год назад представляем ну три года составляли оператор связи любые тоже там точки ценность электронных честных можно было на услуги я понял мы это делаем и с точки зрения что тут рукавов наши ключи у нас это возможность тоже есть то есть если оператор который знаем мы включились хотят для своих клиентов пробросов какой-то туннель скажем это свидание мы этим не занимаемся на какой путь вы хотите мы это сделаем то что там другие операторы которые там транснациональные имеют каналы от москвы до камчатки пожалуйста они тут тоже могут"
}