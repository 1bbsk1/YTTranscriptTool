{
  "video_id": "TSWBOJ19ofA",
  "channel": "HighLoadChannel",
  "title": "Трафик-инфраструктура Dropbox / Алексей Иванов (Dropbox)",
  "views": 3320,
  "duration": 2868,
  "published": "2018-11-19T03:10:32-08:00",
  "text": "так на а вопрос а кто был на dac иди олега сегодня утром про фейсбук днс dns facebook давай хирурги окей мы частично пересекаемся так как оба рассказываем про . присутствия мы частично пересекаемся поэтому я судя потому что много народу было у олега я очень быстро пройдусь по тем местам которые у нас общие и так меня зовут алексей я рассказываю про трафик инфраструктуру дро бокса до дропбокса я делал трафик в link ты не дали нкт и на я работал в яндексе делал такую штуку как перевод яндекс с free bsd на linux кощунство правда итак начнем с общих слов общая информация дропбокса что вы примерно понимали какие нагрузки у нас пол миллиарда пользователей раскиданных по всему миру у нас петабайты метаданных и акса байта данных у нас миллионы запроса в секунду и то рабита трафика и отправите как раз таки миллионы это рабиты мы сейчас поговорим поддерживаете эту инфраструктуру наш этаж мотор вот так вот он выглядит данный момент то есть примерно 20 точек присутствия по миру ближайшее время мы расширим и точку присутствия да где это прямо на 30-35 . покроем фактически почти все континенты простите пингвина и тут нужно ответить на вопрос почему нам нужны . присутствия какую проблему они решают ну все мы знаем клиент европе сервера в америке задержка 150 миллисекунд даже если сам запрос обрабатывается 100 миллисекунд суммарная задержка получится где-то 700 мы кучу времени тратим на хан шейки то что вам продают сидена всегда они говорят вот вы короче ничего не меняете в коде покупаете наш продукт например ее у вас становится все сильно быстрее просто добавляя точку присутствия посредине но для дропбокса очень важно не только задержка очень важна скорость передачи данных и вот это пример 2 тысячи сессий идущих одна из них идет в точку присутствия близко к пользователя другая идёт напрямую в дала центр и тут мы видим то что понятно то что после дней который идет ближе она разгоняется быстрее но еще это соединение которое идет к точке присутствия она в итоге выбирает более высокую скорость потому что фактически мы очень близко к пользователю мы выгребаем его пакеты из публичного интернета засовываем в наш backbone нам вот такой у google засовы мы там наш backbone там нету потерь пакетов и тисе пи работает банально быстрее у нас нам разогретые соединения все прекрасно и тут очень важный момент как мы трафик на эти точки присутствия загоняем поскольку банальной если неправильно загонять трафик на точке присутствия то можно сделать хуже даже если у вас их сотни если вы случайно маршруте зиру и ти пользователи из австралии в европу это будет сильный медленнее чем если бы точек присутствия не был овощей и пользователь бы шел напрямую в америку в до центр и мы поговорим о нескольких основных технологиях как вообще трафика раскидывать по дата-центром реалистично время про последние у нас не будет последний метод это когда вы явно берете и отдаете пользователю юрл в котором написано в какой дата-центр ему идти о возможно в какой дата-центр через какого транзитного провайдера даже не просто пихать в сердце так изображение или мы поговорим про первые три то есть бюджет и dns и их комбинацию начнем с они каста поскольку он самый самый простой чтобы вам настроить и никас ничего делать не нужно вы анонсируете одинаковые подсети со всех ваших точек присутствия dns у вас очень тупой он всегда возвращает 1 тот же адрес и интернет магическим образом вас вон секретирует в ближайшую ближайшую больших кавычках точку присутствия из бонусов красота в настройки относительно оптимальный роутинг и если у вас кошка заползает трансформатор ваш ваша . присутствия отказывается без интернета трафик автоматически переключается на другие . присутствие то есть это ничего делать не нужно анонс bg пышный пропал трафик перешел но есть и минусы первое вы теряете полный контроль на трафика вы не знаете где вам где трафик вам придет вы даже не можете просто убрать трафик . присутствия легко второе ничего не знает би джи пи бедный про задержку про потерян окна линки про толщину этих самых линков то есть бывает такое то что вроде бы hop off одну сторону меньше но расстояние физическая больше и мы это реально видимо наших графиках то есть на низких пирс анти лях дело dns а и никас работают в принципе одинаково а вот на высоких писателях часто бывает ситуация когда мы отправляем пользователю в очень оптимальное место этого резюмируя до беды пенни каст очень простой в настройке автоматически flower из коробки но не самая оптимальная маршрутизация и без самое верно важно это то что нету контроля над трафиком нельзя просто даже задраить поп не побив все соединения то есть вы видите кошка идет трансформатору нужно все переводить другой дата-центр а не можете ничего не сделать и сделать не побив все соединения и последнее и самое важное trouble шутить и не каст безумно безумно безумно трудно то есть вы случайно с кем-то заперлись в новом месте у вас трафик пошел через это место плюс у администраторов столько контроля над у администраторов провайдеров интернет-провайдер столько контроля над джипе то что фактически вы идете по оптимальному маршруту а по самому дешевому маршруту и тут мы приходим geo geo dns ум это то что в принципе решает многие проблемы с они кастом случае с ги 1с он наш сетап становится сложнее теперь у каждого у каждой точке присутствия есть своя собственная потеть свои уникальные адреса dns теперь тут нужен сильно-сильно умнее он теперь в зависимости от географических координат клиента должен выдавать айпи адрес айпи адреса разных точек присутствия из бонусов вас появляется полный контроль над трафиком вы можете уменьшать и увеличивать веса вы можете перенаправлять пользователей из одной точки присутствия в другую вы можете монетизировать по странам покутить континентом по широте и долготе как хотите из минусов теперь если кошка заползает трансформатор т2 центр пропадает из сети но вдн если он остается вам нужно либо автоматизация которая это дело будет выносить с dns и либо умных dns hal щеками которые это будет делать автоматом вторая проблема это абсолютно обратная проблема я касту фактически dns дело dns ничего не знает про кровь сетевую топологию то есть возможно то что географически близки и точки очень странно топологически соединены например на границе страны может получиться так то что одна . присутствия ближе но трафик идет через столицу этой страны или если страна очень большая как россия той если вы применили россию какой-то точке присутствую вас vladivostok поет в европу или наоборот москва может пойти в токио ну и самая классическая проблема dns а этот отель теория вот это как бы график того как мы выносим трубок задком от одну из точек присутствия из гнс а теперь у нас взять секунд и тут видно первое в теории мы должны получить ровно ноль новых соединений через минуту на практике первые 15 минут нам обычно ходят провайдера интернет провайдеры которые в попытках уменьшить нагрузку на своей dns-сервера просто копирую его родит отель на 10 15 минут long tail and этот веселый то есть если у вас есть публичный api и к вам будут ходить очень странные клиента например утру боксы есть клиенты холодильнике то есть реально холодильнике которые в рамочке показывают фотографии из вашего дро бокса и эти холодильники рисованных dns на старте то есть представляете вы включаете в розетку холодильника он резал вид dns вот о таких много на самом деле есть холодильнике есть принтеры есть видео камеры камеры наружного наблюдения баш скрипта perl скрипт в кроне у кого-то и таких таких примеров море и вот этот long tail понятно часть из этого бота но как то соответственно резюмируя роутинг угол dns лучше полный контроль над трафиком мы наконец-таки плавно можем убрать трафик с точек присутствия может быть и надо слишком плавно если честно но опять же мы ничего не знаем про задержку физическую мы также во многих регионах от банкиры очень важно важно качество вашей гималаев и база в некоторых регионах нужно использовать 2 3 героев и база в некоторых нужно использовать специальную дела и пи базу и вообще от качества гималаев и база зависит очень очень много теперь давайте поговорим про гибридные способы балансировки это как комбинировать и не каст вместе с герои dns сам так чтобы получить как бы плюшки от обоих nor на мой любимый способ это когда вы у вас каждая точка присутствия все еще имеет свой unicast адрес но при этом каждый из них еще анонсирует более общую подсеть то есть потерь которая включает все остальные точки присутствия это значит то что если кошка заползает трансформатор я вроде третью кошку или 4 сегодня убивая то у вас пропадает полностью . присутствия вместе с ней уходит более специфичный анонс более специфично анонс уходит у вас ваш unicast адрес становится и ника с адресом фактически вы можете в любой момент переключить переключиться с unicast она и никас просто убрав специфичный анонс это хорошо работает для файлов ира второе это отлично работает случай до доз а вы можете любой момент переключиться на и не кастом второй вариант иметь возможность контролировать трафик все еще используя не каст и так аллоцировать dns сервера с ftp-сервером и на них тех же ника с подсветкой в этом случае когда вам придут тут важно понимать то что все она работает на таком на теории то что если к вам запрос пришел на dns сервер в этой точке присутствия пауни касту то и если вы отдадите не каст адрес клиента то клиент вам скорее всего придет по это тоже соответственно вы всегда имеете возможность либо отдать и не каста адрес и надеяться что к вам придет клиент либо фактически отдать unicast адрес другой точке присутствия то есть вы все еще используете и не каст но вы можете контролировать нагрузку плюс вы имеете возможность дара инете то есть вы берете отдаете если вы перегружены в данный момент или вам просто нужно погасить что-то отдаете адрес другую тачку присутствия ну и перейдём к на рынок самой интересной теме это как раз таки реал user монитор то что позволяет короткому ram что позволяет нам оптимизировать конкретно задержку то есть грубо клиенте есть небольшое количество кода которое время от времени пингует все точки присутствия и агрегирует эти данные отсылает к нам на основе этих данных мы строим вот примерно такую карту задержек от всех пользователей да у всех точек присутствия вот это как бы визуализация оптимального маршрута очень удобный инструмент показывает нам как бы качества с генеральной карты также места где нам в принципе не как необходимы новые . присутствия соответственно основе этой карты би джи пи и full view иногда нескольких данных с мониторинга абарай набирай дав ручных мы генерим карту оптимальной ешьте зации то есть для каждого слышь 24 в интернете можно сгенерируем у оптимальнее всего идти и на наших тестах рам dns всегда выигрывает у диода и нас от чтобы потому что мы теперь мы реально оптимизируем метрику которая нам нужно оптимизировать ну и резюмируя да у грамм dns самое лучшее качество маршрутизации полнейший контрольно трафика вы можете в свой пайплайн запихнуть абсолютно любую логику из минусов поддерживать do the pipeline и очень больно особенно если он мастер в ядре вашего ваш инфраструктуры он должен работать быстро он должен работать очень-очень reliable итак давайте посмотрим что внутри точки присутствия происходит сетевой точки зрения там ничего сложного нету там фактически есть маршрутизатора есть набор серверов к маршрутизаторам подключены сами сервера транзиты подключен пиринг приватный и публичный подключен бурбон никакого маги с точки зрения сетевой у нас там двухуровневая система балансировки у нас есть офисы l4 балансира который road traffic на 7 engine x на l 4 балансиры по и симки разбрасывается трафик прямо от роутера вопрос такой почему мы просто не сделали вот так вот просто сразу не начали победителей трафик с роутера на engine.exe фактически тут ровно такая же проблема как у и николс то у вас нет никакого контроля над трафиком в этом случае вы не можете плавно задрай нить машину вы не можете управлять весами чтобы вы ни делали какую операцию вы не производили убираете добавляете backend вы бьете соединение и у людей вот это вот не было ни единого разрыва вот в очень неприятной ситуации поэтому мы решаем эту проблему в данный момент appy appy весом l4 балансер фактически у него есть connection тайбл который решает проблему изменения с это бэг-энда когда у вас что-то меняется если запись есть таблицы state а то она она текучее соединение никак не аффект то есть там происходит как какие-то изменения списка брендов но все текущие соединений идут куда они шли 2 что там есть это consistent хаш что он позволяет если соединение нету в списке в к начинкой бля мы проваливаемся в консистентных ешь консистентных и ширу им это соединение нам backend и на какой борьбе с она не попала она будет консистентной зафиксирована на тот же backend это был довольно перегруженный слать давайте просто посмотрим на конкретных примерах вот у вас два соединения двух разных клиентов идут через 2 л 4 балансира разных на два разных олсен балансира теперь ситуация l4 балансер умирает соединение переходит на другой балансер но так как у нас там consist in cash она в принципе котируется на тот же тот же backend что мы которая отправляла другой балансира обратная ситуация если нам нужно например выкатить новые ядро раз катить новые ядро наилучшим балансиры и мы хотим затруднить машину то можно сказать айпи весу благодаря connection тайму можем сказать о пвс то что туда новые соединения не отправляй но старым дай завершится и таким образом мы можем плавно делать rule out ядерно пример из из плюсов l4 балансиры это прекрасно мы их очень любим они и сами отказоустойчивые а не горизонтально скейлится они дают нам возможность играться с весами и делать грейс пул grey + сами они как бы тоже столице горизонтально л всем балансира за ними тоже скалится горизонтально то есть это реально одни плюсы из минусов нужно поддерживать дополнительной wta tour и не балансировщик of у теперь про engine акс тут на самом деле забавно перед тем как рассказать про engine x нужно на самом деле рассказать как у нас работает инфраструктура и так как работает диплом вдруг боксе мы у нас моно репо внутри моно репы все все зависимости описаны boyzone дальше бэйзел отвечает соответственно сборку за тестирования мы соответственно берем собираем дженкс тестируем индекс запись и запихиваем туда же конфиге индекса запихиваю туда тузы какие-нибудь боренька социально пример comand line клиент упаковываем все в сквош fs раскидываем торрентом на машины mountain там бредуны в итоге у нас получается так то что тепло и работает быстро нам их серверов всё абсолютно одинаковая то есть нет такого то что где-то что-то разъехалась overlay офисов нет ни каких то есть все в редон ли все им ютубом из минусов мы не имеем возможность на ходу менять конфигурацию то есть чтобы раз катить новый конфиг engine икса нужно идти и пересобирать пакет выкатывать новый пакет понятно что для прокси которая занимается у которой есть большой список брендов с весами это не очень оптимально неохота каждый раз это все перегенерируем для engine икса мы написали такой небольшой сервис который ему динамический генерит бэг-энда то есть он сможет наши топологию наш сервис discovery в наш мониторинг как то это все компилирует и отдает engine xv engine.exe и село которое подцепляет список брендов и на основе него там есть директиву балансер байла на основе этой директивы уже дальше роутер все входящие соединения то есть она абсолютно не блокирующие есть мапо которая говорит куда рудь эти этом оба раз в секунду обновляется и того резюмирую нас есть инкрементальные быстрый билды благодаря моно репе и благодаря благодаря бы и злу у нас есть очень быстро тепло и мгновенный rollback рубик это фактически изменение сим ленка у нас есть герметичный имеют обл пакетов фактически контейнера там все сам все статических ленкова на все независимо но при этом есть возможность управлять динамической конфигурации то есть вот мы написали вот эту сервера динамической конфигурации который позволяет быстро раскатывать бэг-энда а теперь довольно большая часть сколько у нас времени что же происходит с трафиком внутри дано центра внутри дата-центра у нас работает много компонентов первый компонент это сервис прокси наш мандат который фактически доставляет трафик от от себя до микро сервиса то есть он находит какой конкретно микро сервис конкретный запрос отправлять и к и выбирает на какой конкретный instance этого микро сервиса мы отправляем этот трафик дальше у нас есть курьер с усанин и офис это сервисы которые позволяют общаться трафику внутри до центра то есть когда один сервис хочет говорить с другим сервисам включается вот эта вот часть мы реалистично успей наверное поговорить только про первую часть бандит если останется время в конце может быть и очень бегло пробегусь по именно нашему сервису внутреннему и так бандит бандит это наша сервисная прокси почему мы написали что-то свое зачем нам свой а затем прокси почему не взяли какой-нибудь эти прокси или например яндекс и по правде сказать пять лет назад было примерно так там был такой сэндвич из engine икса и эти прокси но уже тогда были проблемы с динамической конфигурация всего этого дела и тогда у нас были десятки сервисов сейчас у нас сервиса в сотне уже и вопрос изоляции безумного жена очень очень охота чтобы один сервис не мог убить другой сервис один плохой из нас не мог положить все прокси 2 вторая фишка это количество инсов у нас очень много инстансов этих сервисов и там сотни тысяч уже то есть динамическая конфигурации нравится безумно важной и напрягли ловит дитен джинкс каждый раз это вы фактически удваиваете свою память изменение происходит в принципе каждую секунду в продакшене то есть приладить engine x на каждой в каждую секунду это не реалистично и еще у нас много разного железа поэтому как мы балансируем между конкретными из инструмента в принципе тоже важно тут довольно забавная история про последний пункт он мне как сыр и очень близок сколько у нас мониторинга вокруг этого сервиса на самом деле от этого очень много страдает топом source продуктов потому что мониторинга возможности заглянуть в них понять что происходит очень очень мало тут забавная история мы когда написали эту штуку мы ее продавали вот по первым трем пунктам поскольку любой внутренний продукт когда ты его написал его нужно как-то продать внутри уговорить пользователи его на самом деле использовать то есть мы приходим к разработчикам и говорим вот стоп который предоставляет изоляцию динамическую конфигурацию балансе на бабло а брали люди вот по последнему пункту по мониторингу они фактически ставили перед своим сервисом прокси она им давала метрики она им давала алерта она не давала tracing из коробки и то есть мониторинг стал вот такой фичи для продажи это прям было безумно круто крайне рекомендую если у вас есть какие-то внутренние продукты как вы задумываетесь о мониторинге этого дела изначально поскольку это может стать гигантской гигантской продажной фичей мы плюс вам как администратором будет сильно более удобно как программистом добавившим это дело будет сильно сильно более удобно это поддерживать и так архитектура банды это буквально он я сразу говорил очень очень простой архитектуры банды до 35 секунд есть listener которая со птица единение отправляет их очередь маркеры разгребают очередь отправляют запросу ops 3 мы все никакой магии стандартных табачную библиотека гошка кошечки но есть очень много таких маленьких reliability фич которые делают нашу жизнь сильно-сильно-сильно более интересные например все наши очереди они лифа то есть фактически это стыке все знают а что типа есть хороший очереди есть очереди плохие вот фифа это плохая очередь лифа это хороший очередь все знают то что на очередь должна должен быть лимит но лимит по размеру у всех есть а вот лимит по времени не у всех и лимит по времени это на самом деле одно из самых главных вещей которые вы можете добавить в очередь чтобы дропать request во который в ней торчат обрыв больше секунды и вот на самом деле искал такой то что фифа это плохая очередь олив хорошая и вот если у вас есть возможность переупорядочить соединения то лифа всегда будет работать лучше чем фифа вот это пример того как представьте у вас залип какой-то сервис на бэг-энде это может быть я не знаю gc это может быть switch плохой то есть что-то у вас залипла и потом от липла и вот случай с фифа очереди задержка у вас вот так вырастет и потом будет медленно медленно медленно спускаться вниз это ещё хороший случай то что она спускается она может просто не уменьшаться вас что-то залипла и все входящих request of достаточно чтобы как был очередь не разбивку по этому фифа это плоха участь случай слив а у вас как все залипла такой от липла многие из вас могли заметить то что вот в продакшен такое бывает что сервис уже поднялся вот там switch хлопнул сервис поднялся оао все сервисы по пути залепляй и вы их ри стартуете когда она все понимаете нормально работать так вот слив а такой проблемы нету если у вас везде по пути лифа то она отработает прекрасно плюс если у вас есть там лимит на это тайные вид на очередь то у вас есть всегда верхняя граница лет инси которую просто больше в очереди вы не проведете тут еще очень важная фишка про sap sitting то есть sap sighting он важен только если у вас там сотни и десятки тысяч инстансов брендов или возможно в принципе уже даже отыщи когда у вас десять или там 50 back end of the самсоненко смысла особо не имеет вот как выглядит например то есть что означает совсем как а когда ты отдаешь бог не все бренды маркером а лишь какую-то под под этих бесов сеттинга каждый worker общается со всеми бэг-энда то есть понимаете если там будет 10000 worker of 10 тысяч брендов то у вас будет вот такой вот практически full межсоединений это может быть там десятки сотни почти миллион и иногда соединений типичных это большой выход на ядро это просто расход ресурсов случай с abs и кингом у вас каждый worker получает лишь под множество этих самых брендов то есть мы уже расходом как минимум меньше ресурсов на уровне ядра второе если что-то где-то залипает что-то где-то плохо себя ведет например up stream который в сотни тысяч раз медленнее чем все остальные он потенциально может заметить любого worker а и в worker у вас просто если они синхронно это все совсем плохо они сойдутся вот на этом об стриме и умный потенциально имеет возможность ощутить все если у вас есть absenting то у вас один плохой ops 3 может повлиять только вот мы 1 варка но еще менее очевидная штука это статистика если у вас используется как он темный лорд balancing не просто рандомный предположим даже лист connections если у вас десятки тысяч up stream of the никакого лот balancing работать не будет если у вас будет недостаточно запросов фактически если вы используете метрику как медиана времени ответа то она будет слишком стара чтобы использовать когда вы доберетесь до этого об стрима метрика будет уже бесполезной если вы используете гистограмму по количеству активных соединений например опять же если у вас слишком много об стримов метрика бесполезно ваш инстаграм и будет как хоккейная клюшка такая у вас есть up stream с несколькими контактами все остальные по нулям случае с об сайдингом ваши инстаграм и всегда актуально ваши ваши статистика актуален гистограммы имеют нормальное распределение и таких вот маленьких именно реала и белить и reliability fitch в бан дейзи очень очень много но бандит был нашей первой попыткой работа с микро сервисами очень давно сейчас наверно двое имеет вот что-то подобное то есть функционал плюс-минус похожий возможно если бы вы описали это сейчас мы просто взяли и двое допилили бы его под свои нужды но но но но очень многие идеи вот из самого бандой да они переползли в наш внутренний runtime стек это фактически на нашей орбите начали discovery все эти идеи вот за несколько лет эволюции превратились из просто вылезли исходящего прокси и этим же идеями абсолютно начали пользоваться все наши сервисы внутри то есть когда один сервис общается с другим сервисам он имеет часть этих reliability фич и вот тут сколько у меня времени хватит я совсем вкратце расскажу про наш runtime наш runtime опять же это то как сервис общаются друг с другом основной компонент runtime а это наш курьер курьеры the jar пессимист рпц вся разработка в дропбокс основанным и контрактах разработчик пишет контракт в виде про то бафа из этого про то бафа кода генерации генерятся серверные стопы и генерятся клиента серверный стопы под язык который на котором вы хотите писать сервера и туда включается сразу обоюдная модификация от веса и сеяли рейд limited racing мониторинга статы все вот все что нужно для сервера все там кода генерится ничего люди сами не пишут и генерятся клиенты подо все языки которые поддерживаются в боксе то есть вы написали разработчики например а клиент у вас появились тут же под питон раст джаву и так далее и фактически это позволяет тратить безумно мало времени и получать максимум which at our миссис т.к. второй компонент это сусанин наш сервис discovery как понимаете от сервис discovery называл русский а пиво очень похожи на dns но с поддержкой в очередь то есть вы можете сказать я хочу не просто разрезал bizol ведь это имя но я хочу следить за изменениями этого сервисы когда там появляется новый инст пусть мне тот пусть урнут вот этот хелбиг вторая очень важная фича это то что он поддерживается с этим то есть вот ровно тот же совсем который был в банде он теперь встроен сусанин что это дает то есть на про tekken если у вас стоит ли сервер то вам неважно какой конкретный sense вы будете использовать вам не нужно знать обо всех инстанциях вам нужно достаточно инсов чтобы наполнить свой к начинку и поэтому благодаря вот этому свойства если мы просто вы на давать вам на 36 инсов брендов если у вас к ночи на полу шесть то вам не нужно постоянно слать модификации то что что-то изменилось за пределами вот этих шести инстансов на практике это реализовано как такое кольцо где кольцово консистентная хостинга и вы мы просто выбираем часть incense oud на этом кольце и теперь вам приходит уведомление дергается ваш call back не только не когда что-то где-то меняется а когда меняется что-то внутри этого кольца то есть до приходит новый сервер или уходит оттуда новый сервер старый и это существенно уменьшает нагрузку как на сам сервис ковре так и на ваш сервис вы не постоянно не переустанавливайте из писаний то есть когда у вас десятки тысяч инстансов это безумно важно без этого любой оси разыскав склочница под нагрузкой ну и а fs от нашей правовой системы для конфигурации как я уже говорил все вдруг бог семью табл любой сервер любой сервис он тепло its а вот со своим конфигом и больше не меняется и если ты хочешь поменять конфликте нужно виде plaisir из это не очень удобно поэтому то есть такое такая фишечка способ с интерфейсом который тоже в принципе у меня кстати делать watch а то есть муж взять и заводчица на конфиг и когда конфликт поменялся ты приводишь свой сервис сервис у тебя все еще имеют обл все еще герметичен но вот он имеет возможно ты имеешь возможность за секунда обновить конфиг мы это например используем опять же все интегрировано вместе поэтому мы это используем для обновления и селе for писи то есть ты хочешь добавить новые сел ты не хочешь для этого ready плоть все сервисы ты берешь записываешь файл в офисе какой файл кода генерация все те сгенерил а также работают райт ли мин ки рейд лимит или ты хочешь включить tracing для большего количества квестов опять же записываешь файл vfs.ini тонар на все про инфраструктуру runtime его у меня к сожалению нет никаких выводов под конец доклада то есть ну какие выводы могут быть вот мы так сделали да она работает нам принципе нравится но это точно не последняя фаза эволюцию мы сделаем лучше мы сделаем интересние и вот тут вот пара примеров того что мы планируем делать ближайшее время мы понятное дело построим больше . присутствия мы хотим очень начать работать по начать работать над рам ingresso мы хотим продолжить работать на drom игре сам мы хотим переписать l4 балансир наконец-то кен с gps она наверное xd по и и бпф или может быть взять фейсбук овский катран мы их также очень большие фанаты герпесе и очень странно получается то что внутри нашего дата-центра мы используем как бы одну среду разработки а снаружи и другую и мы хотим от этого избавиться и вытащить герпесе до наших клиентов то есть иметь and the end джер писи от клиента до сервиса как минимум мы уже это делаем на наших приватных и pr многие наши приватные 5 которые например пользуются листок клиенты они and anger писи и возможно начнем это дело для будущих версий публичного и 5 мы также думаем все то что мы не переведем наджар писем и просто сделаем джерки sitrans coding то есть на и джед прямым убыткам конвертировать наших от т.п. запросов jar писи запросы и внутри дано центр будет только герпесе то есть мы избавимся вот от от всех этих странных и т.п. протоколов внутри еда стандартная картинка мы нанимаем и если у вас есть вопросы мой twitter телеграм и почта ну плюс я еще тут с уверенностью спасибо вот эта запись твоего доклада новых аэс и грант с благодарностью привет из 90-х окей давай по сути у нас конкурс шуток правах а если я тоже я весточка молота что это молодец молодец красавчик друзья вопрос есть вот смотрите она проводится здесь вот ты где артем да артем говорите на куратор лапса привет ещё раз значит насчет отеля в резул горах в рабочей группе райпо магма трогаем между met and wales был была бумага из какого-то исследователи из университета и университета дюссельдорфа который померил райп атласом рекурсивные резольвер и в у провайдеров в него и обнаружил ровно ноль рекурсивных ризограф которые завершают отель но понятно обнаружил многие которые занижают кажется ну то есть либо он нашел не все одном все-таки атласа хорошее покрытие либо это все-таки ст обрезал веры то есть те же холодильнике вот те которые будут по 15-30 минут ну возможно они в новой это хороший point мы смотрели на user agent of которые все еще ломятся в старый старая . присутствия там были браузера то есть браузеры или user agent браузера user agent браузера то есть это это хороший вопрос вот там точно было много холодильников возможно в новой версии холодильников еще добавили типа патч который просто раз 15 минут в реализовывать dns но я честно не знаю что ответить я пойду тип гриппа это это на самом деле не вопрос это комментарий что мал на самом деле тут кто-то до поисследовать еще или может написать чувакам издатель door поможет они локи крови ну прелесть очень инфраструктура то что у нас все эти лаги в хайве есть в принципе можем пойти погребать больше построен гистограмм типа агентом добрый день добрый учитель алексей керн спасибо большое за так вот собственно схема где point of presents анонсирует не только они коса адрес но еще и менее специфичная вопрос собственно такой не ловили ли вы хоть джеков то есть если нанси она случае dos атаки например да то есть вы выбираете анонса не каста анонсируется в специфика и таким образом возможно хай-тек на мой взгляд анонсируется лес и фиг мы не ловили этого продакшеном вот такая схема продаж они спросят данного хаджи кого не ловили не у нас вот все все точки присутствия анонсируют вот эти вот слышь слазь 16 и конкретную слышь 24 пока вот ничего такого не было давайте просто поговорим потом посмотрим как это может что мы с этим можем сделать announcement of the internet подход about every six weeks for персик считается bit more you ask инаба утром роман как говорит по-английски am asking about с американского адвоката свои мысли форму triple play совсем до интернет отвечает так близки вот фото на оке висикс адрес in time for example и частью сэмпл чай певый don't play my excess вы-то алдис лакировки каланик останови аннан стал tanks бирюза и пешками привет спасибо за такой мыши рассказать о данном был насладимся фильтр айс можешь про них чуть поподробней осыплет рано потому что с ними всегда более никто их нормальные умеет а там все просто если у тебя две прокси твои то они точно проекта бандитами еще еще один бандой то они могут договориться плюс у тебя всегда есть ситуации когда ты абсолютно безопасно можешь зари травить например если ты выкинул request из очереди то есть запрос прочел вот помощь я говорил то что есть там ограничение на время пребывания в очереди вот если ты запрос выкинул из очереди то ты знаешь то что он не выполнился и ты можешь наверх передать то что случае я запрос не обработал ну прям вообще вот это не просто тайм-аута тайм-аут и звучит как это инкрементироваться это делать 10 можно туда хедер добавить можно добавить какой-то статус код свой но идея прям такая там из 1 источник снова я отвечает частично на вопрос который был значит по поводу мост специфика в случае атаки значит ну известно что мост специфик в интернете это с лишь 24 потому что с 25 будет отфильтрован большинством об стримов мало кто знает что в последнее время уже если слэш 24 фильтруется потому что как бы память надо to play не она как бы заканчивается вот и особенно разные неудачники с оборудованием фирмы brocade очень любят это делать но потому что как бы плюс еще ipv6 туда загружается вот уже сложить 24 не помещается это я просто к тому что когда diedas mitigation подключается путем анонса с лишь 24 нужно всегда быть готовым что 531 процент трафика но останется ну и да еще к тому же он он сможет залипнуть убирание ipv4 анонсов bgp это до 4 минут в общем такой такой момент артем просто хочет половина твоих аплодисментов понимаешь на него артема очень много много опыта в плане борьбы с ddos атаками он знает о чем говорит красота и у нее очень подружки симпатичный еще есть вопросы друзья вот последнее смотрите сейчас тем временем ребята все кто смотрел нас в интернете вам большой привет вам отдельные аплодисменты сейчас пока микрофон несут мы увидимся с вами в этом году обитают в обязательном порядке не переключайтесь весь год да пожалуйста вопрос здрасьте спасибо за доклад такой вопрос насчет 4 маршрутизаторов перед нужен иксами нельзя ли такой вариант использовать поставить на engine иксах берд и по успев на маршрутизаторы анонсировать айпишник не следовательно если нужно загасить то сначала гасим бёрд туда трафик не идет и я рассказывала вы слышали эту историю про не было ни единого разрыва вот что происходит когда вы опускаете бёрд вы опустили bird у вас все эти типы соединения побились тот момент то есть все фактически эти пакеты потом придут на другой сервер этот ответ простой на любой тисе пи входящий пакет который не мочиться по цельсию соответственно пользователь грузил файл не знаю масяня downloaded file downloading но и там 99 процентов и дисконект очень неприятной ситуации спасибо вот ну вообще это это валидный сетап когда тебя доносят то есть это до до хи ты не хочешь чтобы у тебя работали чтобы те никто перегрузил 4 балансиры можно к лоцировать l4 балансиры вместе прямо на машинах совсем балансирами фактически получается так почти как сетап как вы сказали только есть еще таблицы стэйта который если чо перешлет в другое место спасибо большое алексей спасибо всем спикерам всем участникам в интернетах мы увидимся скоро кому за лучший вопрос книжку отдадим без любви хаджи кинг это наверху это вот здесь а вот все вот прекрасно"
}