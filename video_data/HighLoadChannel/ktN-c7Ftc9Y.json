{
  "video_id": "ktN-c7Ftc9Y",
  "channel": "HighLoadChannel",
  "title": "Продуктовые проблемы при создании очередной Docker PaaS / Владимир Ярцев (Castle Digital Partners)",
  "views": 828,
  "duration": 1623,
  "published": "2018-01-16T12:34:56-08:00",
  "text": "здравствуйте дорогие друзья я владимир ярцев city of компании ksl digital партнерс и я хочу рассказать о том как мой пробег стал продуктом на самом деле про доклад называется вот так потому что я уверен что это проблема системные и если идти по этому будет он вы на них обязательно ступить не то чтобы я не умел создавать продукты я видел как сетевой я видел как продукты создаются но когда я занялся с вами под project там почему-то я решил что мой маленький проектик будет играть будет жить по другим правилам не по правилам больших продуктов что такое тут hero это heroku аддон сейчас он находит остаде public beta у него 70 бета-тестеров еще 30 тестеров для того чтобы он вышел в продакшн скажите пожалуйста кто имел дело с heroku кто что-нибудь диплом на heroku хороша эта платформа платформер за сервис и идея в том что то что вы делаете на heroku она запускается в контейнерах контейнера стайлз и сзади плоть туда ну скажем бабульку или что-то что слушает на порту отличным от 80 и 443 просто не получится для того чтобы за деплоить до того чтобы воспользоваться базой данных на heroku есть marketplace и в marketplace есть куча донов там более 150 и уже наверное этой базы данных и каши из кельна успеть базы хранилище для логов аналитика все что угодно но это лежит не там куда в деплоить и код а в marketplace и вы подключаете то к своим приложением идея родилась идея чтобы сделать какую-то такую среду наверное положите это так и живут аддоны куда вы можете заполучить свою базу данных рядом со своим heroku предложения это нужно например если существующая система донов вас не устраивает и вам нужно за тепло ведь что-то свое но не туда где живут обычно контейнер heroku а в кармашке рядышком то есть такая аналогия это ваш микро сервис этот цветок вы вы сажаете в привычную среду в какой-то кармашек этот микро сервис начинает жить по правилам heroku что это за правила пользователя те программистов которые диплоидный heroku они платят достаточно большие деньги за то что они получают какую-то среду более удобную чем просто выделенная машина и более про более простой в настройке чем скажем rubber duck первый ход я решил сделать этот сервис для себя для себя лично мы коленки под капотом было сервис тут у все сделал некий веб-интерфейс виде приложения синатра куда можно было ставить кусочек докер компот yabla нажать на кнопку поехали и это докер кампус отправлялся в сервис тут он который собственно разворачивал это дело в облаке на докере как решение для себя как пруфов концепт это работало но я даже не мог пожарить это коллегам потому что это решение было не очень стабильным за месяц тут ума он был в бете успел изменить api мне пришлось гнаться за то другом за него изменениями и периодически так просто не взлетал докер был нестабильным тут он был в бете и коли говорить чуть не работает сходи посмотри пошариться миром это нельзя вот как-то на этом этапе продуктовым изогнулась и я отложил эту идею наверное на полгода ящик и через полгода пришло осознание а с чего вообще пользователя будут ставить моя done зачем она наверное у них есть какие-то нужды наверное им что-то у них не получается или слишком дорого я решил посмотреть а что собственно пользователь получает от heroku что такое heroku бей что не платит сразу небольшой спойлер все что сейчас буду рассказывать все шишки которые я набил наверное я их не набил бы если бы познакомился с полом джексоном это продакт менеджер в компании оказал digital партнерс но он живет в америке и в самаре не встречал если бы с ним познакомился год назад и если почитать вот его этот блокпост блок косилка эти идеи про которых сейчас расскажу их можно будет освежить и так почему же пользователя которому вдруг взбрело в голову за тепло и тяну скажем risen гибели майский рядом с heroku самому почему он не развернёт машину в амазоне и не напишет там yum install в рыбы выглядит все просто и после этих двух команд все летит так нет не так у в какой-то момент у него возникнут abs проблемы и если у вас 10 янв ароматов time staying продакшн это где-то что-нибудь еще то набор этот подъем усилий который нужен по поддержке вашего сама пестово решения он тоже умножается на 10 это дорого и пользователи которые платят heroku деньги платят не за то чтобы отменится и решение посмотрим что такое heroku вы это когда вы делаете когда вы делаете то что написано в документации вас все работает из коробки это когда у вас есть аддон на которой вы заходите и без чтения кода без каких-то выполненных мозговых усилий понимаете в каком состоянии приложений из чего она состоит у вас есть от даже борды есть настроенные логе метрики в heroku сделать стандартным способом соответственно вам это не нужно придумывать как программисту который что это диплоидный heroku бэкапы практически во всех аддонов саппорт практически во всех addon-ов и очень важная вещь инфраструктуру это сервис представьте на секунду что только что случился очередной ход блит и все в мире веб-серверы уязвимы web-серверы срочно нужно бежать почти это не проблема heroku пользователя потому что пользователь за тепло if she got no heroku отвечает только за безопасность своего кода за инфраструктуру за нее отвечает кто-то там другой не моя проблема соответственно возвращаясь вот к этой концепции я хочу заде плоть микро сервис в кармашек который живет по правилам heroku никто не мешает пользователю воспользоваться come on line это не противоречит херовый это не противоречит ценностям hiroko и на самом деле все что нужно дать пользователю это сказать вот у тебя есть докер компост которым то пользовался локально ты отладила это в девелопмент режиме сделать теперь доктор кампус об но в облаке и она у тебя полетит и все будет хорошо ведь я ни о чем не надо будет волноваться это можно сделать такую штуку и нaуки руку есть come on line интерфейс не только даже борды но и come on line плагины и можно написать команд line плагин который скажет что теперь ваш джокер complete он работает не с вашей локальной машины с докером которую мы вам только что развернули там в облаке и тот докер он увешан всем чем надо и мониторинга me to my backup у него есть вы уважаемые пользуйтесь продолжаетесь пользоваться тем чем пользовались девелопменте для вас ничего не меняется просто все работает это решает прав задачу quickstart а из нашего списка heroku ценностей ну что только что случилось точки зрения продукта до прав в концепт я думал что ну вот сейчас запись на тот умерешь и еще пару неделек все буду в альфе и весь мире купит после профу концепт у меня появился достаточно четкий бэбкок что мне надо делать и бог вообще на два месяца изменился скоб если вы я своему начальнику гипотетическому в начале проект искал мне нужен месяц еще две недели я бы сильно облажался и продуктовые проблема я попытался пошарить от решения с коллегами и команда docker machine которая там где-то под капотом было доктор машин crate она занимает около 7 минут где-то на 5 минуте мне говорили что кеничи происходит вообще я пошел работать не отвлекай меня я просто не мог показать решение коллегам в решении просто машина в амазонии заметки можно развернуть быстро за две минуты следующие задачи и списка даже гордо пассировку вы не должны быть что на самом деле достаточно пользователям я взял простой скрипт который просто выкидывал на экран сепию зачем диски уже идет коллеги говорят но позволь драку cloudwatch и можно выцепить еще и сама зона еще полсотни метрик где же они здесь где графики где история на самом деле на heroku есть new relic тоже доступен как аддон и пользователю которому все это надо он может нажать на кнопку установить невелик в бить свой ключ и все это получить а кому не надо соответственно не будет этого делать отсюда мораль это решает эти три тибете но я не трачу силы на создание вот этих этой кучей дашбордов сколько там одну-две недели будет no coding мораль не видеть если у тебя есть решение ты его понимаешь что фильтр уфе так следующая задача это логе когда мы закупаем запускаем докер кампус up именно а точит то мы видим блоге процессов которые там исполняются когда мы запускаем этот detached мода dk campus от минус d и ушли курить бамбук мы логов не видим и нам нужно их эти logis машины с докером как-то пересылать на heroku тоже решается задача просто для этого документированные пиарь вы вешаете какой-то агент в докер машину он логе читает туда пересылает и там они видны стандартом для heroku способом в чем проблема да это решает проблему логов в целом с точки зрения роковой но когда я это показываю коллегам они пытаются запустить команду докер кампус а вот этот вот в удаленном варианте где-то там в облаке прибавит свой микро сервис и у них логов на экране нет я только что сломал привычное поведение то есть те кто пытались воспользоваться они говорят у меня редис повис и фея повисла потому что netlogon на самом деле просто у докера есть несколько драйверов лагов и тот драйвер который использует джейсон и journal de они сохраняют привычное поведение а другие драйвера ломают мораль сохраняя привычное поведение в моем случае просто переключился на journal de итак вы решили 3 пункт из heroku way и это уже достаточно солидная штука чтобы пожарить ее со всем миром напомню цикла roll out на у хируко доном такое что сначала нужно брать 10 быть его альфа набрать 10 пользователей потом выйти в бета это когда ваша доступно маркетплейсе но вы не можете чарджить деньги набрать 100 пользователей после этого вы падаете продакшн и собственно зарабатываете вот я вышел volvo и как в 1 альфа тестер сам я решил за тепло через индиви у неё есть вот такой дашборд хочется конечно его открывать почтите пьеса чтобы он был запароленный этот пароль должен жариться с heroku приложением чтобы то что я на хирург за тепло например рисовое приложение который теперь будет сын тебе общаться как с аддоном чтобы и она знала пароль и рисом тебе знала пароль то есть у меня этой проблемы конфигурации сети без но еще и сервис discovery че теперь же я сертификат даже на какой-то менталист его тоже надо где-то регистрировать под капотом service desk а в речке пес решается через склад сэр то есть я притащил сторонний сервис и как раз я 1 раз есть и он мне дала сервис дисков речь теперь вторая штука тоже решает стандартным способом и heroku есть переменная хранилище для переменных окружения secret и eg и аудитор compose можно использовать интерполяция достаточно их связать и вы получаете рабочие решения морали не придумывайте фичи заранее слишком много потому что по пути в продакшен ваш ваш продукт обрастет решениями и вам нужно сконцентрироваться на том минимальном объеме задач которые нужно чтоб чтобы показать ваш продукт миру если будете много fitch придумывать сразу то просто не дойти до продакшна итак я решил пожариться решение с миром и для этого я сделал сайтик на коленке написал heroku те в центр article такой маленькой how to сделал форму регистрации и стал написал пост и стал ждать когда же собственно пользователь вобьет свой e-mail без этого никак они не могут стать альфы тестерами пока они не дадут на свой e-mail я должен будет зарегистрировать стал ждать 1 пользователь первый посетитель на сайте 10 и 50 регистрации нет у меня хотя такой ужас я спросил жены дорогая что мне делать и спроси и вообще в интернете люди очень любят давать советы если что-то не знаешь как сделать сам просто попросить совета в интернете ну что сделал пошел в реддит спросил как и пожарят решение с миром и не прослыть злобным спамером получил совершенно потрясающий сюда ко мне сказали что ты ну то есть я на своем сайте ты не не объясняешь какой в л ю я как пользователь получу от продукта а вы что просишь давайте посмотрим внимательно еще раз на сайт форма целых три поля кнопку которую нужно нажимать кнопка с видео которое больше похоже на стрелку и маленькие-маленькие ссылочки которые наверное даже никто не заметил в левом нижнем углу оказалось достаточно просто переработать сайт сделать четкий посыл до хера я такая штука которая превращает любой образ стокер хаба в микро сервис запущенные рядом с heroku без духе рава это не можете сделать docker пожалуйста справа рядом ссылка на видео время сколько усилить и пользователь понадобится чтобы просмотреть это видео и с команд как ты будешь пользоваться докера есть на самом деле если там пролистать еще вниз прокрутить то напротив каждой команды будет интерактивный по пабчиков зачем тебе эта команда нужно какую ценность карты команда несет зачем убивать и юз кейсы а что с помощью вообще с помощью этой технологии можно сделать и в общем-то этого хватило чтобы пользователь пошли мораль но на самом деле используй фидбэк любой фидбек и всегда говори о нужных пользователей не почему мне нужно что вы поставили свой дом а почему вам нужно чтобы поставили этот отдан интересная штука я написал документацию отдельную полную документацию через битбокс битбокс он очень хорошо не индексируется гуглом почему-то вот по этому запросу я вылез в топ а запросто тут на нуждах этот запрос сбивает пользователи которые у которых есть реальная нужно воспользоваться и дизайн кабины heroku поэтому поэтому заправился была просто сумасшедшая конверсия 3-бета пользователей пришли по этому запросу что случилось продуктовой точки зрения даже после того как я победил backlog после переосмысление концепта там может быть немножко затянулся как всегда до настоящего реального запуск в альфу когда у меня появился реальные альфа пользователи прошло еще несколько недель потому что мне пришлось возиться с сайтами с документацией переосмысливать кучу еще и вот на это ушло время к этому надо быть готовым когда делаете свой продукт и мораль такая итак первый багрепорт приходит пользователи говорят просто ничего не работает на самом деле достаточно тяжело пользу пользователь в америке я в россии он мне мне прилетает alert я очень ждал этого первый баг репорт он принял где-то в час ночи на самом деле club flyer которая притянул на предыдущем шаге имела а пешку не очень популярную и пользовались может быть сотни в пару сотен пользователей и в класс app просто смог взять и поменять свою api никому об этом не сказать попробовал в amazon так сделать опирайтесь на плечи гигантов дальше посыпались глупые ошибки пользователей но кто бы мог подумать что пользователь тепло еще что-то через докер не имеет установленного докера на своей машине или что пользователи не читают документацию выяснилось что все так и поэтому в команду line интерфейсе пришлось обработать каждый возможный edge кейс каждый возможный сценарий ошибки и вместо скажем я now in the spawn докер яну and писать уважаемые пользователи пожалуйста поставьте докер вот ссылка вот как это сделал для вашей платформы и после того как я переработал именно эту часть продукта глупые ошибки они исчезли хорошо альфа пройдено 10 вольт или набраны пора переходить в бета специфика продукта такая что раз я перепродаю амазонские ресурса я просто беру amazon узкую машину по цене пор который продает amazon накатывание докеры продаю пользователя дороже в сути такое пораженчество каждый альф пользователь мне стоит примерно 6 долларов 100 бета-тестеров мне будут стоить 600 долларов вместо я на них ничего пока не выручишь показ один имеет беру вдруг значит без объявления войны пирог берет и создает свой способ где плоть докер на себя как ты вообще без блокпоста произошла очень тихо вопрос закрыт открывай документации там написан способ тепло ведь докер у меня паника можно ли мне идти дальше ведь компании моей компании стоит 600 долларов в месяц я не известно насколько вообще затянул создания продукты потому что мне теперь нужно создать конкурентные преимущества перед heroku у меня жена теперь запилить бэкапы и там чем быть еще чего у heroku нет именно вот в этом подходе я побежал продукт за веком именно в этот момент и познакомимся с полным джексоном и он донес до меня очень простую идею дотягивает пользователь доходит пользователи идут радуйся посмотреть сколько тебя пользователей в месяц так и будет двигаться дальше он донес другой день любой продукт какой был не был он проходит через три этапа первый этап это он boarding вы должны заставить ваших пользователь находить вас щелкать на кнопку зарегистрироваться и этот этап успешно пройден вторая часть это карта скамп лишь как только пользователь смог за тепло и почему надо смог приконнектиться к своей базе он смог увидеть дашборд начну говорит все ключевая задача выполнена и третий этап это администрирование это собственно тот самый этап когда ваш продукт начинает приносить деньги и пользователи на этом этапе они начинают выдвигать повышенные требования ему же нужны bacopa ему же нужно что все было хорошо и как можно лучше экономила их силы кстати вот ссылка по которой все это можно прочитать также пол джексон познакомил меня с понятием пирамиды элемент флю когда мы что-то доставляем пользователю в продакшн то этот кусочек функциональности на самом деле пользователь не нужен ему нужно ценность что он получит взамен и ценности выстраиваются от функциональных к социально важным ну например функциональная ценность эта фича сохраняет вам время онлайн бухгалтерия позволяет вам быстрее платит налоги и обратите внимание и плавский iphoto кажется это ж не просто дисковое пространство куда можно загрузить фотографии это штуку с помощью которых можно создать моменты воспоминания то есть организовать ваши фотографии в вот поток ностальгию лайфхаки что то что помогает вам быть продуктивным в в большом масштабе например фитнес-трекер дает вам надежду ну скажем похудеть или просто вести здоровый образ жизни заметьте не факт что установите сына фитнес-трекер вы будете вести здоровый образ жизни он вам пока дает только надежда и социально значимые благодаря соцсетям вы можете почувствовать себя частью чего-то большого единого глобальных трансконтинентальных групп пользователей или контрибьютором в купер нет ну я послушался совета пола джексона я пошел в бету это график количества пользователей на продукт пользователь действительно успешно идут несмотря на то что heroku предоставляет почти тоже самое и что лично для меня важно это то что в самом начале я пилил идею я совершенно не знал нужно на пользователем или нет впустую трачу свои силы или нет то сейчас я получаю фидбэк от рынка и для меня это уже как раз в ил и для меня какое-то ощущение признанности я понимаю что пользователям это нужно дать если будет продукт был не не ради денег это было бы panzar себя чувствовал что этим будут пользоваться и я могу строить какие-то более или менее оптимистичные прогнозы давайте посмотрим какие шишки я набил тенту market нужно решать проблему реальных пользователей иначе просто рынок обгонит тебя как только то тираж фокус с реальных проблем реальных пользователей ты сменяешь нам нужно использовать стандарты и не ломать привычки потому что когда мы придумаем что-то новое для чего уже есть решение мы теряем силы на то чтобы объяснить пользователям как этим пользоваться лучше сказать вот делали как докер compal сработал и все будет нужно общаться с продукта веками и не только люди далекие от программирования подчас могут дать вам либо очень важный фидбэк либо привнести какую-то концепцию которую в программировании вокруг вас ее нет и это очень важно нужно осознавать файлы когда мы доставляем что-то пользователю нужно всегда помнить а зачем ему это иначе не продать и нужно опираться на плечи гигантов спасибо за внимание и маленький офтоп что меня в данный момент больше всего интересует это как же все-таки эффективно работать в продакшене с докером и с воланами из бака по me если у кого-то есть реальный опыт в коридоре был очень рад пообщаться спасибо спасибо вопросы у кого есть поднимайте руку один появился скажите пожалуйста у вас получилось выйти из бета пользователь мне еще нужно 30 пользователей сейчас меня ровно среди коллег пригласить пользователями будет в два широком и там здесь marketplace даны такер и доступен как публично это просто бесплатно пока еще вопрос у кого-то есть хорошо спасибо тогда еще раз у нас будет перерыв и после него можно будет продолжить секса последний доклад этой секции возвращайтесь приходите будет интересно"
}