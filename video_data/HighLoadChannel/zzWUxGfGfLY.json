{
  "video_id": "zzWUxGfGfLY",
  "channel": "HighLoadChannel",
  "title": "Персонализация за 10 миллисекунд / Владимир Посвянский, Иван Вовк (Tinkoff.ru)",
  "views": 4405,
  "duration": 2858,
  "published": "2020-04-14T11:24:03-07:00",
  "text": "в общем еще раз меня зовут вова всем привет мы работаем в тинькове и развиваем нашу собственную систему нашу собственную тему персонализации и оба тестирование о которой сегодня собственно и хотим вам рассказать если вы хотя бы раз были на нашем сайте то скорее всего уже сталкивались результаты нашей работы тем не менее что для большей наглядности чтобы не быть голословной у всех вас призываю сейчас присоединиться к вай фай точки guest и перейти на главную страницу тиньков точка ру где специально для вас и только на время нашего выступления будет настроено специальная версия главной странице с таким баннером хеллоу да какие после такой небольшой вводной части давайте перейдем к основной части нашего доклада и расскажем вам как мы это делали как мы пришли к идее что нам нужно своей собственности м персонализации как мы делали mvp и наконец как мы решили что нужно отказаться от mvp и все переделав поехали больнице что не знаешь про а по тестам я конечно знаю ну давай поподробнее расскажу всем остальным оба тесты являются простым и универсальным инструментом для проверки продуктовых гипотез в чем они заключается у вас есть какая-то базовая версия страницы она у нас обычно называется контрольная вариация и есть какое-то альтернативное отображение данной странице это тестовая вариация и вам необходимо понять какая из двух вариаций лучше контрольно либо тесто и как мы это делаем весь трафик который идет на данную страницу мы рандомным образом разбиваем и между двумя нитями вариациями спустя какое-то время мы смотрим на целевую метрику это может быть например конверсия и с помощью простого статического анализа принимается решение о том а что же лучше а либо бы давайте эту концепцию рассмотрим на примере данный кейс взят с нашим рекламу на вал лендинга осаго где аналитика решил протестировать за два заголовка первый довольно таки такой сухой страхование осаго и второе очень-очень длинный рассчитайся сага бла-бла-бла манит как ты считаешь какой из двух заголовках работать лучше по моему короткий и это абсолютно верно короткий заголовок дал плюс 15 процентов заявка что является реально очень классным результатом но тут важно понимать о том что не все продуктовые гипотез являются настолько же простыми поэтому в тиньков мы придерживаемся правила то что любое даже самое незначительное изменение странице необходимо прогонять через оба теста и оба тестов мы проводим действительно много за последние три года мы провели в общей сложности по всем продуктам около 250 став чтобы лучше понимать эту цифру это означает что мы каждый новый тест запускаем каждые 4 дня это реально круто но важно отметить то что абед с они являются какой-то серебряной пулей очень часто apts ты не показывают никакой статистической значимости и в нашем кейси только 15 процентов всех оба тестов являются успешными то есть которые показали эстетическую значимость на всем трафике и результат которых были масштабируем и мы также ли довольное долгое время но так как для тинькова я без в отсутствие отделений оптимизации интернет канал является супер важной задачей потому что это позволяет привлекать трафик быстрее и эффективнее что самой главной дешевле мы вкалываем поняли что хотим превзойти вот это классические 15 процентов и двигаться дальше быть более эффективными и поэтому пришла в голову мысль о давайте сделаем свою собственную систему персонализации тебя как разработчику и предстоит реализовать чтобы реализовать нужно знать чего хотите давай разберемся чему хоккей когда мы начали искать в точке родственных на самом деле нашли довольно таки быстро потому что каждый наш опыт с там мы проводили анализировали не только в общем но и в частности на более детальном уровне уровня в разбивке по различным срезом таким как источник трафика тип устройства гена и многое многое другое и очень часто мы находили небольшие точечные сегменты на которых детектировать и статистическая значимость и мы поняли то что мы хотим заставить вот эти маленькие сегменты работать по полной мы хотим на эти сегменты настраивается точечный персонализации скрыть с контентом с креативом эффективность которого выше чем эффективность дефолтного креативы который показывается всем это первый пункт плана но важно еще что то что оба теста никто не отменял они были есть и будут скорее всего всегда и поэтому мы хотим научиться пытаться проводить чуть более ум на наши целевые решение следующие после проведения любого оба теста идет и стадия поиска сегментов поиска эти чистый значимых сегментов как только мы их нашли на эти сегменты мы настраиваем пирс точечную персонализацию когда доходят время до следующего робот с то он уже проводится не вакууме а уже с учётом всего накопленного опыта с учетом тех персонализации которой были раньше собственно вот такое решение ты же сказал что уже провели 200 вся тестов значит наверное вы начнете пользовались да все так у нас действительно было коробочное решение которое по факту представлял собой джесс библиотеку который устанавливалась на фронт но такого решения есть ряд недостатков одной из основных это скорость потому что когда вы становитесь уже с библиотеку на сайт кто встает вопрос а в какой момент и необходимо отображать персонализированный контента страниц сценария 2 первое это то что мы отображаем страницу базовую сразу потом фонд фоне ждем загрузки библиотеки и потом когда все загрузилось мы делаем круто refresh и подгружается персонализированный контент но это решение не очень хорошие сортире не x а потому что крючок человек будет видеть сам организм страница второе решение кажется вроде более правильным это то что мы сначала ждем загрузки целиком библиотеки и только потом мы отображаем уже персонализированную страницу но тут есть должна одна проблема то что данная данная библиотека может загружаться одну две три секунды и вот никак не плохо вас вижу скорее всего ваши глаза немножко и расширились и и вы не понимаете что все это время пока библиотека не загрузил человек будет видеть белые крана что очевидно тоже плохо особенно это важно становится в разрезе недавнего исследования гугла которая показывала то что если скорость загрузки страницы больше одной секунды the balance right на вашей странице будет расти экспоненциально мы очевидно это тоже очень сильно не хотим это одна из проблем вторая причина почему хотел свое решение это без релизный мы все наши персонализации оба тесты хотим взводить без релиз ты сейчас мы этого сделать не можем поэтому наше решение должно быть интегрированы с нашим собственным конструктором сайта через который мы можем изменить абсолютно любой элемент на страница в том числе и настройки формы так же мы хотим чтобы все персонализации оба тесты не отваливались и были устойчивы к любым внешним изменениям например если у нас изменился ради какого-то блока либо вообще какой-то блок пропал со страницы наша система должна об этом alerts а возможно даже в автоматическом режиме разрешать такую ситуацию очень важно что мы хотим наконец использоваться наши внутренние данные такие как данные о транзакциях пользователя данные существующих продуктов и данные об интересах сейчас мы это делать не можем и наконец лет светлом будущем мы хотим прийти к какому-то коробочное решение к некой черной коробке под капотом который крут с алгоритмом машинном обучении которые сами будут принимать решение о том как к какому сегменту какой креатив нужно показать вам наверное аргументация вот такая звучит здорово давай начнем с этим weepin' у для этого как-то точечно хотя бы сформируем требование для gp super давай только перед тем как начать сделать систему и и нужно как-то обозвать мы ее называем нас здесь он динамика контент оптимизация в рамках в импе я предлагаю повторить базовый функционал всех коробочных решений которые у нас сейчас есть первое это сегментам сегмент это набор правил по которым мы определяем юзерам для начала давай выберем сегмент пан get параметрам по куклам по типу устройства по делу и вот просто в качестве примера что такой сегмент это например все пользователи которые зашли из контекстного трафика либо все пользователи которые зашли с мобильных устройств на любой пользователя возраст которых лежит от 20 до 25 лет как то так после того как у нас будут реализованы сегменты нам необходимо сделать а пытаться которых я вот как разговор говорил ранее ну и наконец после оба тестов нужно сделать небольшое дополнение это сплит-тесты по факту являются то же самое что и б только сравнение контрольной вариации с твое происходит за счет редиректа с одного орла на другой как-то так вам слушать здорово еще будем лепить плюнем склеим нам нужно сначала модель данных а у нас в отделе в rtb есть в отделе привлечение есть удобная система называется rtb real time bidding она торгует рекламой то есть примерно показывает нужную рекламу нужным людям и используется там модель системы которая отвечает мне кажется нашим представлением о конкретно там есть изначально плейсмента есть тот url наверно на котором мы хотим чуть размещать далее есть аудиторный сегмент тот самый срез аудитории то есть пользователи айфонов пользователя текущей вайфай сети допустим то есть та аудитория кому мы хотим показывать и собственно креативы в нашем случае системой персонализации страниц это будет какие-то наверное джейсон патч или что то в этом духе этот что мы хотим показывать над этими связками есть над этими элементами есть такая связка именована и это онлайн этим то есть стратегия она связывает кому мы хотим показывать чем то есть мы назовем эту стратегию так-то с данными вроде определились перейдем от слов к делу модель действий сначала к нам приходит кто-то с каким-то request там что нужно сделать сначала нужно сегментировать понять куда он относится для этого мы воспользуемся сервисом у нас уже есть сервис называется enrichment он нас обогащает информацию о пользователе то есть по уже известной пришедший информации по и пешни конфидором определять дополнительную пайпе гео-позицию по федором по юзер агенту допустим девайс более точно устанавливает это нам поможет более четко разделить аудитории сегментировать и и более точно далее нам необходимо произвести тот самый таргетинг то есть из этих сегментов выбрать целевой какой-то котором сейчас мы хотим показывать там какой-то приоритетный поиск или что то в этом духе определившись с целевым элементом нам необходимо еще это все залакировать чтобы отслеживать воронку опять же в терминах artemy такая штука называется им прошу контекст то есть кто к нам пришел и чем ему отдали это лаги руется куда-то наружу в какой-то обычно новый сколь старридж из которого потом строится воронка привлечение чтобы эффективно понимать сколько нам это стоило когда мы кого привлекли или не привлекли и так далее дальше нам нужно сгенерировать самые креативы почти что я имею ввиду в этом нам наверное наверное точно понадобится какая-то runtime информация в наших персонализация хто есть текущее время data is на девайс пользователя с текущей контекст мы на этапе генерации этот контекст будет подставлять в эти самые креативы почти ну и таким образом его получать более актуальным на этом этапе в принципе персонализация готова то есть креативы те самые патчи с генерированием и можем отдать его наружу осталось это все делал для наблюдаемости обложить метриками чтобы понять что вообще там происходит тут как бы графит всё стандартно довел бен на этом этапе выглядел примерно следующим образом для всех внешних сервисов которые как-то я тут записал писались коннекторы ну просто коннектор с обработчиками каких данных для таргетинга опять же приоритетный поиск все это переплетается причудливый процесс получается веке берите пользуйтесь ну давай посмотрим что получилось горящими глазами берем накипи и запускаем пользователи начинаем год пользуемся но к сожалению через к в это время наши горящие глаза потухают энтузиазма тоже проходит потому что египте получился не совсем тему каким рассчитывали системе есть ряд проблем первая проблема это то что она часто отказывается это бы еще ничего но на локализацию проблемы уходят очень много времени вплоть до 1 дня это сильно раздражает бизнес заказчиков то что они постоянно видишь что система не работает а также напрямую проблем не связаны скоро частью на который важно сказать в рамках in every у нас возникла проблема с фиксом потому что то админку которым мы прикрутили к сервиса по факту язык повторяла предметную модель системе пользователю нужно было независимо заводить сегменты креативы line айтемы плейсмента а потом все это дело между собой связывать когда этих сущность становится много то пользователи просто путаются и перестают понимать все о каком у юзера что нужно пока верю что нужно показать ну и наконец в рамках америке мы реализовали только базовые кейси на а оба и сплит-тесты это то что есть у всех а мы все-таки хотим двигаться вперед и дело стоит делать что то новое то что она действительно будет приносить нам выгоду такие такие штуки как персонализации много-много чего плюс за этот год чтобы пользоваться ведь у нас появились новые который тоже нужно реализовать и сейчас не совсем понятно как здорово потап развития и план развития это значит что хотя бы это кому-то нужно ну и чтобы развивать давай определимся вообще куда вы движетесь чего хотите чудо сложный кейс супер а первый сложно кейса так называемые связанные тесты у нас сайт состоит из огромного количества страниц и на этих страницах многие элементы однотипные хорошим примером является продуктовый меню иногда приходят дизайнеры с новым дизайном и твое меню и просят это дело протестировать ну и здесь очевидно то что если пользователя увидел новый вид меню на 1 страница тон и вы должны увидеть на всех последующих не должна уже быть такого то что во время серфинга по нашему сайта где-то посредине вы видели старое меню потому что очевидно что это испортит you x и следовательно понизит эффективность данного меню тем самым нужно реализовать ника прилипание пользователя к креативу контенту второй кейс это нам необходимо онлайн детектировать коллизия между сегментами и вот для чего представим что у нас есть два аналитика которые сидят в разных комнатах и не ничего друг от друга не знают и например аналитик ваня решил на сегменте с 1 настроить какую-то персонализацию например осетии кнопку перекрасить в красный цвет все здорово но через какое-то время аналитик вова решил завести очень похоже персонализацию например с перекраской кнопку в зеленый цвет на и сегменте с 2 нормально все но сегмент ис-1 и ис-2 в общем случае могут пересекаться и у нас в системе возникает конфликт который необходимо каким-то образом разрешить что мы делаем во первых нужно уведомлять авторов о том что в системе конфликт это делается через лак либо через почту после этого не наступает стадия разрешения конфликта первый вариант как можно это сделать это назначить приоритеты и если у каждой стратегия году назначен приоритет то вот на этом пересечении будет срабатывать 100 стратегия 1 у которой приоритет выше это так называемый неявное разрешение ну и второй явно новенький простой кейс это что просто аналитики садятся и изменяются своей сегмент в таким образом чтобы явного пересечении сегментов не было 2 key если чё нам нужны к лизе это для учета персонажа в тестах которых говорил ранее ну который хочет становиться подробнее про что ролики реально сложные кейс представим что у нас есть какая-то базовая версия страницы заголовком бесплатная доставка карты надо и какой-то предыдущий тест показал то что сегменте с 1 лучше работает заголовок узнаете решение банка онлайн но ему настроили такой персонализацию все здорово спустя какое-то время мы хотим завести новый оба тест например процитировать текст сетей кнопки оформить карту против получить кредит и сегмент и хотим проводить на сегменте с 2 которые полностью включается себе сегменты с 1 которым было персонализация для нас и такие с очень часты как бы что здесь делается у нас опять появляется конфликт решение 2 1 довольно таки такой кондовый тупой мы забиваем на персонализацию и просто включаем а оба тест ну здесь минус в том то что а пытаюсь будет работать тогда волками а мы хотим чтобы все работал на исторических данных поэтому наши целевой решение заключается в том чтобы оба тест распался на 2 под теста 1 под тест будет крутиться на сегменте с 1 и где есть персонализация из об этом под действием будет персонализированный заголовок и 2 патос будет крутиться на сегменте где нет никаких персонализацией но и следовательно как заголовок будут базовые кейса такие как будем это реализовывать здорово звучит это здорово и очень круто но у нас проблема у нас отсутствует архитектура в нашему випе что имею ввиду у нас было декомпозиция уже когда мы составляли как должен выглядеть в плену декомпозиции не есть архитектура декомпозиции это набор задач которая вы хотите решить с помощью вашего кода архитектура это же некий общий подход к решению этих задач если она отсутствует такое решение новых задач при том самом развитии в ра которую воду говорил вам при написании нового коды в вас всегда стоит вопрос как это встроить мою систему и при протяжении протяженном времени то есть на промежутке нескольких десятков лет допустим из вашей системы столько выживет у вас получится просто обрастание обрастание бросание все это закончится очень печально окна известным комиксе и мы можем принципе сейчас взять и съесть то что хочет его вы просто не приметить написать вот эта штука вот эта штука настроить но это закончится плохо мы остановились и решили сделать архитектуру что же я предлагаю архитектура давайте поговорим о модульности конвейерах вы замечали в принципе что все вокруг модульная вспомните мебель языке или автомобили почему так происходит это сложный и скорее даже философский вопрос но например с точки зрения бизнеса такие вещи просто проще производить и производится не все на конвейерах и чё такое конвейер это ничто иное как модульный процесс и почему не так распространено наверное потому что обладает какими-то качествами на этих качества хочется остановиться поподробнее первое это масштабируемость если вы производите табуретки вам нужно больше табуреток в единицу времени вы просто рядом отнять еще один конвейер получить дверь в редки в минуту они одно и так далее этот процесс можно продолжать бесконечно пока у вас есть деньги в пресс далее эта гибкость если вам место табуреток понадобились стулья вы просто поставить еще один этап к двери который кваши табуретке в конце прикрутит стул на выходе получите стол далее то наблюдаемость модное слово обзор обе лиц это самый и каждая стадия в целом очень маленький мне легко забраться ее обложить какими-то метриками и посмотреть на inside как она работает как она он правильно ли она работа по каким-то измерим величинам или неправильно и отсюда же вытекает четвёртое хорошее качество это просто то каждый этап он очень маленький и забраться в него опять же очень просто легко понять как он работает если он не нужен выкинуть если у сломался подчинить единстве фундаментальный недостаток который есть конвейере это возникающие конфликты если у вас какие-то стадии или конвейера зависят друг от друга то есть использует контекст предыдущего этапа вы не можете их вы бы выполнять параллельно вы должны поставить друг за другом и на борьбу с этими конфликтами уделяется больше время чем построению своего конвейера обычно и что же мы видим в принципе все вот эти плюсики это качество любого enterprise данного приложения то есть то что мы хотим от enterprise на приложение так давайте конвертируем все и получим вот это вот но вы можете возразить и принципе подумать не любую вложение конвертируем а у меня сложный разветвленный процесс и так далее на самом деле любое все ваши наш мои вообще все приложения в мире уже can we rise раваны они крутятся на конвейере процессора все процессор конвейерные и что же я хочу сказать этим давайте взглянем на архитектуру того конвейера где все это уже исполняется потому что собой там есть чему поучиться и такси пью конвейер немного хардкор не идем до цепью конвейер что происходит тут пять стадий фундаментально так конвейер выглядит уже шестьдесят лет за это время принципиально суть не особо менялась какие-то стадии бились на под стадии количество доходил до 31 то есть та самая гибкость но в целом фундаментальная ничего не менялось что происходит и что собственно получение инструкции decode и и декодирования дальше идет исполнении какой-то доступа память и запись результата и кажется что в принципе просто и все теперь знаю как работает конвейер но не все так просто за все эти 60 лет инженеры и архитекторы наших процессоров они придумали огромное количество способов чтобы оптимизировать этот конвейер некоторые из этих способов настроены на оптимизацию в скорости работы конвейера не которые борются с возникающими конфликтами 3 используется в совокупности с предыдущими двумя чтобы минимизировать их негативные эффекты и это конечно клевая экскурс в историю но чего я хочу этим сказать кажется что если вы возьмете ваше приложение используйте в нем вот принцип so happy you can very за цию конвейерный какой-то pipelines вы получите во-первых архитектуру которая проверены временем и которым можно развивать практически бесконечность и кроме того она имеет огромный багаж знаний то есть все вот эти способы и про них можно почитать где угодно изучить и применить их переложить на вашу историю и если цитирует окон молотилка в инструкции то например любой backend эту молотилка request of аналогично аналогично это все очень прикольно но я бы хотел еще раз остановиться на вот этих системах оптимизации чтобы показать насколько вы они применимы например бэг-энда я рассмотрю только три из них начнется супер скаляр насти тот самый параллелизм на уровне инструкций в сипе он устроен несколько сложнее в бэг-энде он наверное выразиться что-то следующее то есть когда каждая стадия у вас выразимо таким некоторым самостоятельным и котором и он может присутствовать ни в одном экземпляре на конвейере а в нескольких если оно у вас тяжелая вы можете ее просто multiply целовать таким образом выравнивая true путь по всему конвейеру чтобы ничего нигде не задерживался не организовывать очереди тех самых дорогих простоев далее это внеочередное исполнение если у вас backend например не справляется с потоком входящих request of скорее всего они где-то накапливаются в очереди и найти чтобы более оптимально нагрузить ваш конвейер потому что вы там применили какие-то оптимизации ли еще что то вы можете разгребать очередь не в том порядке в котором она организовался произвольно оптимальной обладая каким-то знанием или инсайтом и объединение request of какой-то аналог в лив или что то типа того вы можете если вас стаде есть тяжелая она ходит карта памяти на диск или по сети вы можете внутренние микро request и которого наружу торчат обвинять в один большой бак чего request и таким образом экономить на транспорте ну сказано сделано давайте конвертируем нашу систему итак начнем с envy пей который у нас уже было для начала нам понадобится какое-то регистровые хранилищем ну аналог регистра хранилищ нас убивает будет value реже стали допустим это для того чтобы стадии нашего конвейера смогли обмениваться какой-то информации передавать друг другу контекст по цепочке скажем так это будет локально у нас это реализовано в локальном таком попса by маленьком league там где стадия подписываться на нужные аргументы и в результате своей работы публикуют обратно какой-то результат который уже другие могут опять же если они подписались на него использовать начнём собственно на первой стадии это будет вот самый decode фич http к нам приходит какой-то http request моего пальцем некоторые внутренние представления назовем его дитя request и кладем на этот самый реестр далее тот самый поход в in richmond мы берем это 10 request идем в in richmond и обогащаем информацию получаем максимума пользователя текущем request и кладем результат обратно получает виктор янович response далее необходимо посчитать сегменты которым относятся то есть у нас уже есть максимум информации теперь мы посчитаем сегменты мы возьмем этот максимум информации то здесь о request to reach a response посчитаем каким сегментом относится текущей забросить текущий пользователь и результат положим обратно дальше из вот этого результата нужно строки тировать то есть выбрать целевой сегмент который нам в свою очередь определить целевую стратегию то есть целевой line a team который свою очередь то есть эта связка сегментов с креативными то есть таким образом по факту мы ищем те самые целевые креативы мы возьмем результат предыдущей стадии сегменты положим обратно тот самый найденный целевой line a team далее вот самая генерация креатива возьмем текущей контекст runtime тот самый который мы хотим подставлять у нас это реализовано у нас креатива и тот же сон почти внутри есть какие-то макросы которые на этом этапе раскрываются положим их обратно и в целом персонализации тот самый джейсон патч у нас готово уже да но была еще одна стадия которая занималась логированием им прошин контекстом добавим ее что она делает лаги рует кто пришел учу отдали хорошо возьмем дикари квест и что отдали это собственно креатив наш лагерь быть мы будем это куда-то наружу потому что нам эта информация на рандами не очень нужна она нужна аналитиком таким образом мы производим результат не обратно на реестр для дальше для использования на конвейере а куда-то наружу то есть стадия работает в фоне она порождает задачу берет текущей контекст рождает задачу по отклонил ее куда-то наружу то есть оно не тормози то есть конвейер ведь и готова давайте начнем развивать то что там хотел вам и так прилипания то самое сквозная меню кажется что нам нужно запомнить что мы отдали кому но этим же занимается село к я сказал что силок мы не будем использовать дело в том что силок это очень большая структура там есть вообще все нам нужно немного меньше структура нам нужно просто буквально какой-то одесских пользователя и запомнить какой-то adige не креативы что мы ему отдали назовем это напишем стадию которая как раз формируют эту информацию и поступали точно также как оселок откладывает и и откладывать мы будем в enrichment и когда следующий раз пользователь придет за этой информацией мы на ст-1 reach me то получим ага вот ему мы уже выдавали такой штукой вся эта машины reprap таится до стадии генерации сразу то есть мы не будем искать сегменты таргете и так далее то есть менюшка будет за вами следить а или там б вариация стадии работает точно также рождают фоне какие-то процессы то есть обратно обратно на конвейер она не откладывать результат хорошо идем дальше были коллизии на этапе таргетинга я сказал что мы ищем целевой сегмент то есть принципе пояс прерывается когда мы нашли 1 приоритетный но если мы продолжим делать это фоне например опять же то мы найдем все оставшиеся то есть что могло бы еще сейчас отработать если бы вот этой стратегии не был опять же эту информацию куда-нибудь отложим то есть этот процесс продолжается фоне ее и за использует у нас например этой которая говоришь уже информирует пользователя коллизии ну менеджер ferni кто заводит а коллизиях и может разбивать сегменты на ней пересекающиеся заводить на них отдельные вот те самые 2b тест кажется что разработка и канализация нашей системы готова аван пользуйтесь супер мне нравится стадии все понятно но кажется мы забыли про очень важный момент помнишь в начале выступления я говорила про то что мы хотим прийти к кому-то коробочным решению и у нас она keys вот-вот появятся мы хотим персонализировать на главную страницу даже для нас было на страницах равносильно продуктовый страниц любого интернет-магазина и мы хотим показывать наиболее релевантные продукты более релевантным пользователям что мы хотим у нас есть отдельный сервис предиктор который умеет строить какие-то модели машину обучения на основе данных которые он получал данный страниц нам нужно научить на сервис сервис здесь и ходить в этот предиктор с к раме а после этого сортировать карточки согласно этим скором насколько это реализуемая и укладывается твою архитектуру ну как я уже сказал в целом так легко и тривиальным то что конвейер по занимает гибкость возьмём и раздвинем его добавим новую стадию где она пойдет наверное где-то перед двигаться и креатива то есть нам нужно сходить в предиктор получить него порядок и на этом порядке основываясь генерировать те самые карточки нужном порядке хорошо напишу стадию который ходит в предиктор будет анти себе не знаю dippy не важно что вы там используете использовать мы будем качестве входного параметра тот самый результат таргетинга таргетинг это же связка у нас сегмент с каком-то набором вот этот набор это будет набор карточек мы их отправим в предиктор он от сортирует нам эти карточки согласно своему имели там магическую и мы вот этот порядок который мы получили от предикторов вернем обратно и основываясь на этом порядке уже стадия креатива видит вас девочка цвет поменял уже будет генерировать патч для вашей страницы в нужном порядке то есть мы получим сортировку в зависимости от и мыльных каких-то предпочтений теперь точно все что я имею как разраб я имею красивую картинку во первых во вторых я имею клюву архитектуру который ну в принципе я доволен почему я доволен он уже highload она должна быть быстро и она и есть быстрая быстрая в плане во первых работ и наша система сейчас работает со скоростью 10 миллисекунд на request то есть каждые десять миллисекунд это в один поток каждый здесь миль канск миллисекунд хвоста вот тот самый креатив он выходит на нагрузке если нужно больше еще один поток еще один поток еще один поток таким образом на 8 ядрах вы можете вы ну с каждого потока стр ps получается 8 я драхмы выжимаем 800 ну там чуть-чуть плюсик еще идет 860 на самом деле мне кажется отличный результат потому что типа если у вас сорока восьми ядерный какой-то xeon огромный у вас получится 5 к отлично дальше что еще скорость скорость разработки как мы уже показали на примере с предиктором если вам нужно что-то разработ какую-то новую фичу вас есть развитие вам приходится запросами каким то напиши то то то то вам уже понятно как это в принципе встроить вашу систему если приходит с какими-то правками вы понимаете нужно разобраться в какой текущей стадии за лишние если какая-то абсолютно новая фича вы просто пишете новую стадию его вставляете ее в конвейер делается это очень просто целом дальше это скорость понимания те как я уже говорил все стадии очень маленький мне легко напряга объяснять вот эту историю я могу за 10 минут раскидать новому пришедшему разрабы мою команду как это работает и в принципе обычно вопросов не возникает авто нас там какие-то детали ли тонкости реализации и еще скорость наблюдения которая говорил если всю эту вот механику клевую картинку обложить метриками мы получим очень красивые инсайты у красивых плане картинок но очень клевые сайты по поводу того как у нас работает кольер какие стадии дольше какие меньше получим отдельная метрика и в качестве примера я бы хотел повелеть привести наши графики с prada сверху те самые 10 миллисекунд про которые я говорил в 13 то есть это 99 предстательству задница конвейера вот 10 секунд каждый как вот стулья обрабатываются 10 секунд то есть стр psp факт и снизу тот самый более интересный график это опять же 99 простоте сколько этот request проводит на каждом этапе тут для меня эта профилировка в runtime мне прок профилируется прям сразу если что-то куда-то не уходит уплывает я вижу куда это уплывает и у меня-то таргетированные разработка и поиски сразу понимаю а вот от стадии поплыла я в неё смотрю в этом хода не очень много отлично но что тут интересного синенькая это in richmond тот самый вы видите что это стати занимает больше всего времени впринципе логично она ходит наружу за энри чем мы ждем пока она нам ответ вернется то есть какой-то round trip есть и собственном если мне захочется оптимизировать скорость работать о конвейера первую очередь я буду смотреть на нее и потому что оптимизировать один rich ментов два раза я в целом практически в два раза увеличу скорость работы всего ему всего моего конвейера в целом я доволен и в качестве итогов хотел бы рассказать подвести какие-то точечки что есть ну что я предлагаю я предлагаю конвертацию почему потому что это во-первых проверенная архитектура который обладает огромными плюшками кроме того у нее есть огромный багаж знаний по оптимизации если вы написали какой-то не не писали вам попал в руки какой то код который вы не хотите разбираться которое написано целиком из костылей попробуйте его конвертировать разобрать задачу по вот этому pipeline если у вас есть приложение которое не достаточно быстро работает и вы уже выжили все абсолютно вплоть нам даст эмбер на каких-то оптимизации попробуйте канализировать там существуют миллиарды способов как сделать его быстрее если вы пишете новую какую-то штуку пишите сразу канве вы точно не пожалеете на этом мне кажется архитектурная часть закончила вам рассказывать спаси большая получилось по моему неплохо на этом наверно можно было заканчивается но нет потому что мне кажется то что без реальных бизнес-кейс of это всегда было бы просто архитектурой кобура стикера должна зарабатывать деньги приносить пользу бизнесу и акт 1 о тех кейсах которые мы можем реализовать вам еще это рак текстурами и хочется рассказать первый кейс и такие тоненькие сброшены заявкой у нас очень часто бываю ситуация что человек начинает оформлять заявку например на кредитную карту но по какой-то причине не заполняются до конца это может случиться по многим причинам у меня нет собой паспорта либо он просто отвлекся часть этих потенциальных пользователей через какое-то время попадают на главную страницу и тут мы с ними хотим коммуницировать наиболее эффективно моему на первом месте показываемая абанера напоминающие о том что у них есть уже оброс брошенная заявка и предлагаемые заполнить более того здесь мы коммуницируем на личном уровне и в этот баннер можем поставлять имя отчество и фамилию что угодно а пользователя второй кейс это примеры геотаргетингом возможно многие из вас знают то что у тинькова проходит довольно часто спецпроекта с различными с различными торговыми центрами по всей россии и данные спецпроекта необходимо каким-то образом промолчать очевидно что если торговый центр находится в новосибирске как в данном случае то этот баннер нельзя показывать на всю страну его нужно показывать точно новосибирска и новосибирской области на клиентов и вот здесь мы как раз и это реализовали и что самое классное мы это рисовали буквально за 2 5 минут классно и наконец мне хочется вернуться к кейсу сортировка me еще раз об этом поговорить ну что на нашем сайте можно реально собрать очень много информации о том какие у человека есть продукты чем он интересуется на какие страницы как часто и как давно он заходил если все это делала собрать вместе и засунуть в какую-то модель то мы можем построить наш сайт и конкретно под вас конкретно в текущий момент времени и поэтому наш сайт может быть таким таким каким мы такие и даже таким на этом наверное все давайте кратко подведем выводы с точки зрения бизнеса в моем понимании слазим выпьет будет всегда это не хорошо и не плохо это данность из нее нужно вытащить максимум пользы но в какой-то момент и архитектуру и бизнесу нужно остановиться проанализировать все эти знания которые они получили за используя какое-то время использованием mvp и переделать архитектуру таким образом чтобы в ней были отражены все бизнес требования предъявляемые продуктом в качестве итогов хотелось бы сказать тот самый разработчику вещи если вы отталкиваясь от без истребования в чем вообще задача разработки написать инструмент под задачи бизнеса и ваш инструмент должен отражать развитие бизнеса если у бизнеса вектор развития на 10 лет ваши архитектуры ваш инструмент должен иметь запас прочности на 10 лет и если вы заранее об этом подумайте и заложите что все будет хорошо и я предлагаю в качестве той самой серебряной пули это канализация если в целиком ваше приложение к анализируется прекрасной конвертировать кусочек канализации это здорово can very зиру это на этом все не слышно у микрофона села батарейка бывает такое мужчина а кто из вас вчера потерял бейджик я он на автопати ты кредитку корпоративно не потерял просто где искать скажи я потом скажу ну скажем хорошо ребята есть вопросы смотрите вот первый год поехали два вопроса потом новосибирска поехали здравствуйте очень интересный доклад очень часто встречающийся кейс подскажите вот я услышал что вас есть ограничение по времени ставите ли вы какие-то лимиты на вашего конвейера и существует ли у вас какие-то темплейт ответы случае если как микрофон л.с. заберите его пожалуйста да да да у нас каждый этап своими лимитами обложен это статический анализ то есть каждый этап во-первых имеет лимитов у нас практически все стадии имеют лимит 50 миллисекунд и весь конвейер весь ответ должен был сформирован за 150 миллисекунд если он не успевает мы просто дробным это такой автоматический rate лимитер то есть такая задача туда со и дефолтную страниц то есть мы же генерируем патче мы просто его не генерируемого он видит какую-то страницы по умолчанию без этой персоне зато есть ничего не падает нет все хорошо вот еще вопрос пожалуйста про да здравствуйте и спасибо большое за доклад у меня вопрос такой то есть apts ты это всегда работа с гипотезами до гипотезы то есть это всегда вероятности и я на вашем пай плане не увидел от обратно и подкрепление то есть как вы мониторите и обрабатываете неправильный таргетинг скорее выброс бизнесу ну что имеется ввиду под неправильным таргетингом ну допустим меня зовут его на вы меня назвали максимом или показали мне я какой-то но провокационную допустим страницу который мне не понравилось просто неправильно это тоже результат если есть разница между а и b это это результат неважно плюс или минус ты просто понимаешь что тот минус даёт или плюс то есть если мы вас назвали не правильно то вы наверное с конверте здесь и будет мы увидим что что-то там не так работает в эту сторону посмотрим есть это аналитики делают это не конвейер делает который просто делает в дает кому-то разные вещи и все ну да перед запуском каждого нового теста мы определяем сегмент на котором пользователь на которым мы хотим крутить этот тест вот если какой-то причине он тени очень подходит но это наша ошибка ошибка гипотеза до якобы просто не покажет результат но еще говоришь в конечно в тестовом режиме вы сюда микрофон дайте пожалуйста что в тестовом режиме тебе мой кредит не на был закрывать пожалуйста спасибо за доклад было познавательно скажите совершенно обошли стороной вопрос о а тестов то есть вы упомянули что вас очень низкая конверсия гипотез даст статистически значимые вот если у вас в вашей системе место а а тестом и примерно рядом же вопрос какие то есть в планах алгоритмы для автоматического выделения сегментов чтобы не заставлять людей искать границы сегментов хороший вопрос по поводу а тестов от с то всегда есть на стадии запуска т.е. когда мы только внедрили эту систему первые два-три раза это были классические а теста когда у нас запускается какой-то новый продукт любой новый продукт от первое идет всегда тоже от с атакой установочной чтобы понять все ли хорошо работает после того как мы убедились что все хорошо работает уже дальше идут а оба тесты если говорить про автоматизацию прям такую-то вот сейчас да есть идея про того чтобы это автоматизировать а по факту в 1 trans это просто будет циклически по всем срезам которые мы используем прогонять тест на стихи 2 хи-квадрат тесты и смотреть а где ей значит а где нет возможно будущем что-то более умное с этой маленькой ну пока честно не знаю спасибо еще один вопрос из москвы потом новосибирска отправимся спасибо за докладывать она была простой балансе был указан некий разработчик который ушел от вас устав разбираться в этом годе вернулся ли он после такого конвейер то это не вернулся но он ушел как раз на стадии випе которой я говорю что это после этого дома же вернется после этого доклада его будем надеяться мы надеюсь вас не мазали да если ты наш слышно слышишь возвращайся пожалуйста вот следующий вопрос у меня два вопроса парализации прямо в микрофон ближе-ближе где вы храните вот я начал оформлять карту где вы храните вот эту инфу у нас есть свое хранилище называется где вы хде выхода the warehouse вот там хранится но в банковском контуре вот прям в наших краях я не нажал галочку соглашаюсь с условиями если вы не жаль там зависимости от ну то есть это все все равно хранится вот в одном месте то есть у вас есть единый контур данных которые вот персональные данные вся эта история которой мы обрабатываем то есть там все под соглашениями я к тому что я жизни не продолжил я просто вел номер телефона и имя уже телка есть живо скрипт код который запоминает что увели но нет если вы заполнили там например и у телефона нажали кнопку далее там отвалились например на шаги с паспортом то там есть галочка вы соглашаетесь со всем и поэтому dota если уже заметили зажимая далее она уже запоминает если галочки нет у меня еще вопрос если я нахожусь в москве персонализации по москве я переехал а на страницу или уже бы другая завести то там есть персонализации которые на ваше место жительства есть на текущую локацию то есть если текущий у нас например такая же история работа со стариками приложения вы приезжаете в новую страну вам показывают типа чем заняться в чехии посмотрите что-то в чехии ли потом вы уезжаете из чехии как вы провели отпуск вот ваши траты из чехии и так далее я здесь дополнят а что если уехал другую страну с того же самого устройства получает нас сохранится вообще персонализация про брошенную заявку спасибо на этом мы москву поставим на паузу новосибирск задайте пожалуйста ваши вопросы внимания на экран и слышно уже задавайте говорит а что на боевики написано подожди а извини огнем у нас нет и что у нас нет звука из новосибирска может дайте нам звук из новосибирска это все просто это все microsoft skype там вот это все извини пожалуйста с мы перезапустим ся по проверь микрофон и звук звук из новосибирска дайте на проверяем крав он есть говори про реки его великий ну теперь уже не получится с так воодушевленно как вначале я хоть я благодарил докладчиков действительно интересный доклад очень прагматичный здоровский взгляд и классно что они на вдвое что вы именно вдвоем 8 той же таком даете очень бы всегда хотелось видеть такой симбиоз между как бы да вот технической стороной бизнеса вай стороной вот и отдельно отдельный респект за то что пример по геотаргетинга был из новосибирска это от всех нас красиво ну и вопрос спасибо центр финансовых технологий у меня бизнесовый вопрос потому что это часть особенно понравилась вот смотрите вы рассказывали про оба тесты и про персонализацию и в начале доклада их очень сильно делили на текущий момент все что касается персонализации у вас идет отдельным кейсом или вы персонализацию которую делает бизнес тоже используете результаты ее в качестве а pt100 чтобы сделать какие-то выводы отдал эффективно или неэффективно было то ли та или иная персонализация зачем вот разделение такое было или у вас его нет я просто правильно понял нет этого как раз разделения между оба тестами консультациями вообще никакого нету реализация то логически вывод из оба теста то есть мы сначала проверяем какую-то гипотезу находим сегменты где нужно сделать персонализацию и об этой сконвертируется персонализация после этого все новые оба тесты проводятся уже с учетом существующих персонализации то есть это как бы логически цикл это одно и то же по факту но спасибо большое достаточно мощно то есть персонализацию же бизнес до проводит но это все как бы все все оба тест и все персонализации проводят бизнес да ну спасибо гипотеза спасибо новосибирске я правильно понимаю что вас один вопрос валя мба и вопрос да спасибо супер у нас еще 2 минуты на вопросы из москвы поехали спасибо за доклад вопрос такое не рассматривали возможность получения фидбэк от пользователя по поводу того чтобы показать такие предложения например осаго если нет машины мне она вообще как бы мне интересно вопрос на самом деле давно хотели эту штуку делать и буквально недавно мы начали внедряться наш сервис а опросов то есть стандартный механика пройдите опрос чтобы как раз получить обратную связь от пользователя потому что так очень долго страдаем и мучаемся как как правильно таргетироваться один из потенциальных там как мы это решаем эту проблему например если у вас есть другие продукты наш нашей компании например дебетовая карта либо кредитной карты при оформлении там есть дополнительные поля опциональный например если у вас машины и все такое то есть на это эту информацию мы тоже можем использовать ну да а так ты стоишь за их где-то просто в метро читаешь объявления кто-то мем проходку ту же милость врагу надо купить у тебя и у тебя в этот момент из микрофончик это коп туда и все и реклама тебе вот пожалуйста еще вопрос прямо микрофон по поводу сегментов есть ли пересечении сегментов вида там разработчик который приехал в чехию или какой-нибудь смену же среднего звена это все отдельные сегменты какой бизнес модель сегментации можно пару слов по этому поводу то есть как система узнает меня и как-то таргетируем ну по факту когда бизнес и решать что нам нужно определить какой то новый сегмент формируется правило формирование этого сегмента после этого там каждый новый слуга adizero до который к нам заходят мы его видим смотрим он попадает в эти правила формирования твой сегмента и следам и это запоминание мной мухах складывается в хранилище является локация частью сегментации если это заложено в правильно и только если заложено правильно там еще есть оффлайн сегмент это то есть у нас есть партнер у которых мы отслеживаем то есть если вы например на каком-то сайте с у нас есть эта интеграция и вы там находитесь мы какие-то вещи например о вас знаем и можем знать что вы интересовались как не знаю какими-то продуктами и эти продукты когда вы переходите к нам на сайт мы уже знаем что вы там были вы вас запомнили и сейчас говорим вы были там смотрели то то возьмите на это кредит вот пигменте альпинисты возможно лично вы можете в дискуссионный зоне это про продолжить разговор"
}