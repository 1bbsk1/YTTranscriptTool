{
  "video_id": "5PSEjMvOskc",
  "channel": "HighLoadChannel",
  "title": "NGINX за пределами nginx: njs, nginMesh, Unit... / Николай Шадрин (NGINX)",
  "views": 4705,
  "duration": 3252,
  "published": "2018-11-20T12:23:59-08:00",
  "text": "прямо на титульном слайде у нас огромное количество страшных слов и в расписании вы увидели что мы будем рассказывать про такие вещи как engineers and mesh uni template раз plain это все очень интересно и давайте я вам скажу вначале почему и зачем мы рассказываем такой доклад здесь и дженкс как веб-сервер как reverse proxy балансировщик известен вам очень хорошо на российском рынке среди российских пользователей все его прекрасно знают но engine x кроме известного веб-сервера это еще и большая за заметных размеров компания у нас уже работает больше 200 человек по всему миру в разных городах и не только в отделах маркетинга и продажах но и в разработке тоже разные проекты про которые мы говорим сегодня разрабатываются не только в россию разрабатываются не только носи на других платформах языках а в разных местах по проектам обратите внимание где именно можно смотреть их исходные коды и информацию у нас существует два разных гитхаба репозитории один это гитарный яндекс и другой это engine.exe нг в котором живут более моли маленькие сателлитные проекты значит цель сегодняшнего доклада это обзорная экскурсия мы не будем очень глубоко вдаваться в каждой из этих проектов потому что по идее по каждому из них можно сделать отдельный доклад на час а то и больше поэтому мы посмотрим что именно эти элементы архитектуры эти программные решения что они делают как ими пользоваться где найти информацию по ним и в конце будет оставим это заметно и время на то чтобы задавать вопросы на то чтобы ответить на вопросы то есть готовьте в вопросах концу доклада итак первая часть это разговор про библиотеку кросс плейн зачем мы построили систему парсинга конфигурации для любой системы автоматизации для различных решений которые внедряют в устанавливают конфигурирует индекс люди пишут конфиге конфиге можно писать как текстовые файлы их можно писать как с помощью каких-то template них движков можно писать на таких вещах как ansi было по пять шифона всем чем угодно но в любом случае разработчики стараются не писать конфиг руками как только вы ставите что-то в большую инфраструктуру не пишите конфиге руками библиотека кросс плейн работает над тем чтобы преобразовывать конфиг engine икса в стандарт стандартный джейсон это очень удобно для того чтобы потом включать это в любые системы которые этот конфиг будут развертывать или преобразовывать дальше либо вынимать из него какие-нибудь определенные данные как-то их использовать библиотека работает в оба направления то есть вы можете создать свой собственный джейсон по любому из по такому виду из с теми директивами с теми параметрами которые вам нужны и в одно движение преобразовать это в конфликт далее вы можете использовать это как в командной строке также вы можете использовать кросс plain внутри питонов ских скриптов как модуль подключаете кросс плейн и использовать его вместе внутри своих питонов ских скриптов в создаете это изменяете конфликт с помощью стандартных удобных структур значит что кросс plain и не делает это глубокую проверку конфигурации на ее валидность когда конфигурация engine.exe запускается на конкретном сервере с конкретной версии engine.exe это можно технически полностью проверить что конфигурация запускаем а я только в контексте конкретного сервера то что делает раз плейн это преобразование форматов это наш шаг до того как вы конфигурацию зальете на сервер и начнете и запускать самим engine.exe значит берите кросс плейн на гитхабе на яндекс young слэш кросс plain разрабатывается этот проект в сан-франциско одним из наших инженеров и командой которая работает над следующим нашим проектом engine xampp литвой amplify это система мониторинга индекс это такая штуковина которая в принципе работает хорошо и вообще-то не ломается но понимать как именно она работает какие есть в ней метрики какие элементы инфраструктуры стоит правильно отмасштабировать над зачем именно следить для этого мы построили систему правильного мониторинга джен exact который назвали эмблемой установка обливая очень простая ставится простейший агент рядом с вашим индексом агент автоматически находит все инстанции джон x дополнительно смотрит на софт такой как и php-fpm и москве соответственно зная то как работает яндекс смотря на конфигурации amplify еще и читает блоги при этом его не нужно специально конфигурировать для того чтобы понимать формат логов бенджен икса берутся logo файлы либо берутся они напрямую из на прямой через syslog и представляются в метрике которые можно смотреть пса интерфейсе значит еще один момент который надо понимать некие данные из вашего engine x а то есть общие метрики они будут хранится в облаке эмблемой а то есть это не он примет решение это saas но скажем так метрики могут собирать разные решения вокруг что особенная может сделать нам плевать для вас это работа с конфигом и понимание насколько ваш конфиг хороший amplifiers keygens учитывает конфиг с помощью косплей на создает структуру этого конфига убирает оттуда особо страшные персональные данные и отправляет на анализ анализ производится автоматически и результаты анализа можно смотреть внутрь и интерфейсам припай там очень много интересных вещей можно найти особенно если конфиге большие часто случается что чего-то в них не хватает что есть какие-то недостатки какой-то директивы может не хватать что-то может с configure нам не по самым лучшим практикам и автоматически вы можете понять в каких местах вашей конфигурации но сделать изменения то есть даже если вам не нравятся метрики или вы умеете отлично собирать метрики и логе как минимум посмотрите на apple пай для того чтобы проверить свою конфигурацию насколько она хорошая amplify можно найти по адресам плит по engine x платком там же находится документация агентом плева я написан на питоне и и является open source иным продуктом его можно найти у нас на гитхабе далее продуктом прямая он разрабатывается частично в сан-франциско и частично в москве следующая часть нашей обзорные экскурсии это индекс java-script это уже более сложная задача по созданию более динамических конфигураций и по добавлению скриптинга в конфиге engine.exe до того как мы разрабатывали нгс существовало и существует уже долгое время много способов сделать вашу конфигурацию более динамической во первых это создание сложных переменных вы можете создавать переменные состоящие из разных элементов из разных кусков и устанавливать их в заголовке имена серверов делать различные умный про xing и по всякому управлять этими данными в переменах многие вещи можно сделать непосредственно в логике джон их scan2go это рекомендуемые методы чаще всего это самый лучший способ есть если есть возможность воспользоваться не скриптами готовый логоть и логика конфигурации готовой логикой индекса лучше ею пользоваться как есть следующий элемент которым можно пользоваться это директивам об мапу позволяет создавать вам вид видоизменять одну переменную на основании значений другой переменной это очень интересно и достаточно концептуальная фича индекса и часто ее используют вместе с регулярными выражениями для того чтобы на базе какого-нибудь регулярное выражение поменять одну переменную в другую следующий метод делать конфигурацию более динамичны это первый уже по моему больше десяти лет выражен x можно встраивать перловые скрипты и пожалуй более популярный метод сегодня чем pearl это строить динамические конфиге на базе lua значит пролом можно сказать много чего многие ребята строят достаточно серьезные конфигурации строят большие lua скрипты и прямо-таки создают такие applications сервера внутри самого engine.exe с использованием большого количества лова кода пожалуйста не дни не делайте так не создавайте очень большой кот в engine x of scam конфиге это часто бывает небезопасным это может сломаться в непонятных местах и яндекс не предназначен для того чтобы быть апликэйшен сервером поэтому если вы используете но если вы используете большие скрипты на пир ли или что то в этом духе во-первых пожалуйста тестируйте это очень аккуратно и внимательно и очень серьезно тестируете во вторых смотрите где в инфраструктуре лучше использовать большие наборы кода может быть имеет смысл построить отдельные в приложении отдельные апликэйшен сервер за пределами джон икса чтобы обрабатывать трафик более серьезно то есть скрипты которые встраиваются в engine.exe вский конфликт они сделаны для быстрых изменений данных для того чтобы сделать конфиг динамичным не для того чтобы сделать целое в приложении и засунуть вовнутрь engine.exe так вот мы построили свой собственный java script и что мы сделали мы не взяли готовы java script машину мы не взяли диет мы не привязывали новый джесс containex у мы построили java script с нуля зачем спрашивать ноги и дело в том что известные и прекрасные хорошие java скрыт машины предназначены для того чтобы работать в долгом в долгое время они относительно долго создают контекст они следят за мусором они работают предназначен для того чтобы обработать с большим количеством запросов и после того как они долгое время отрабатывают они еще и занимают ресурсы ресурсы на то чтобы правильно выйти и так далее в общем оказалось что для работы в рамках одного запроса для того чтобы быстро стартовать для того чтобы быстро что-то сделать и быстро выйти наша собственная java скрыть машина лучше подходит мы сделали ее как раз с целью чтобы чтобы обеспечить быстрый старт и и уничтожения окружения по нашим тестом если заниматься стартом и остановкой машин типа рейд и сравнивать это со стартом остановкой машина ндс разница примерно на три порядка то есть ндс работает исключительно быстро в контексте данного запроса значит как этим пользоваться мы берем либо исходники на нашем гитхабе индекс nps либо берем готовые динамически модули с пакетов если вы ставите engine.exe из наших репозиториев прямо там же где живет индекс вы найдете и модуль нгс значит модель вставляется в конфигурацию далее кладется java script file и у нас есть простые директивы для того чтобы устанавливать переменные скриптом либо выдавать контент прямо в конфиге значит когда я изучаю какую-нибудь новую платформу мне всегда нужен how old is хеллоу ворлд а дальше можно сделать многое можно понять базовую такую каноническую форму запуска чего-нибудь и потом из нее выяснить что при что происходит как с этим работать дальше как это расширять значит на экране как раз такой хеллоу ворлд для java скрипта для и джесса в начале мы видим что у нас в яндекс он вставлен динамический модуль вас есть reference на файл java script на диске и дали ему нас в локейшн не выдается контент с помощью java script of sky директивы в java script of sky директиве соответственно существует специальный объект и нужно специальным этим объектом вызвать риттер тогда выдаст контент обратно в яндекс одну вещь стоит здесь заметить если вы поменяли java script на диске нужно сделать reload yandex автоматически он не будет считывать файл с диска на каждом запросе спрашивают нас очень часто зачем что можно делать с java script имплементация в таком виде добавление сложной логики в конфликт это очень общая фраза то есть в ваших собственных скриптах ваших конфигурациях вы будете вы сможете сами увидеть все варианты использования но несколько примеров сейчас на экране можно проверять аутентификацию пользователя можно сгенерировать jason wade токены можно сходить во внешнее api для каких-либо внешних проверок и на базе внешних проверок направить запрос куда бы то ни было либо соответствующий up stream либо не дать доступ вот человеку club контенту либо сделать что-то еще на базе решения этого внешнего api и и другие примеры они относятся к кэшированию к более умному и серьезному видоизменения урлов перед проксирование и вплоть до того что можешь можем с помощью java скрипта делать сложные обед с тенге и наворачивать более серьезные логику в конфликт ну внимательно опять же смотрите где стоит пользоваться встроенным языком скриптинга а где стоит что-то взять и вынести наружу и за пределы и джон икса в отдельное приложение значит java script можно взять у нас на гитхабе виде его исходников далее посмотрите пожалуйста на наши блоги в на яндекс платком по тегу engine скрипт и поэтому тегу вы увидите несколько очень серьезных достаточно длинных статей про с примерами того как как java script можно использовать с индексом и 3 ссылкой идет отдельная страница engine x на этом сайте есть array первичная документация по всему что мы поддерживаем в этой имплементации java-script тут но стоит сразу же отметить что мы не поддерживаем вообще все что java script умеет в принципе у нас есть чуть более ограниченный набор функциональности которые поддерживаются в этом опять же с целью того чтобы использовать его в контексте запроса использовать очень быстро и не не для того чтобы делать большие в приложения с помощью этой структура так вот для того чтобы делать большие и серьезные веб-приложения и для того чтобы запускать мы разработали applications сервер под названием индекс unit это уже четвертая часть нашей презентации и давайте рассмотрим зачем же мы делали еще один applications сервер вроде бы их уже есть много вроде для каждый для каждого вида в приложении можно спокойно запускать разные applications сервера и запускать код приложений достаточно известным образом одна из предпосылок для того чтобы для того чтобы заняться этой проблемой это так как в последнее десятилетие менялась инфраструктура если мы вспомним как мы даже 10-15-20 лет назад ставили сервера мы их заказывали где-то далеко придержал этот коробка распаковывали ставили их в стойке подключали провода занимала это долгое время часы и дни недели в зависимости от того какой процесс а сегодня с помощью всяких облачных структур мы можем просто поднять виртуалку в облаке сделать это за минуты если у вас уже стоит разные контейнерные системы вы это делаете за секунды или доли секунд в дополнении к этому часто вы даже не делаете самостоятельно вы берете и с помощью ваших devops инструментов вы даете задание 1 масштабировать какие-либо сервисы но тот факт что сервисы масштабируется еще означает что вся остальная инфраструктура вокруг этих сервисов должна уметь понимать как эти сервисы размажь тобира вались где они работают как они как ходить на данный сервис и так далее следующая проблема которую мы рассматривали это проблема большого количества языков в серьезных в проектах мы всегда задаём людям с которыми общаемся вопросы что у вас за код на чем вы ходите что за платформы и если проектах хотя бы какого-то большого объема очень часто мы видим ответ что мы используем сразу много платформ или вот как-то мы используем одну и немножко другую и причины для этого бывает очень хорошие очень правильные временами большие организации покупают целиком готовые решения или целые маленькие компании которые работают на другом стеки приложений часто бывает что конкретный стек лучше предназначен для какой-либо определенной функции например если мы делаем какой-нибудь машин learning с большой вероятностью мы делаем его на питоне если мы строим какой-нибудь frontend с большой вероятностью мы строим его на java скрипте иногда это просто мода вот кошечка сегодня модный язык многие люди ходят на год и считается что это сейчас классно а вот pearl наоборот почему-то сегодня не модный ну все эти причины то что у нас появляются разные варианты поднятия серверов разные варианты запуска приложений на всяких непонятных языках или понятных нам языках это ведет к тому что у нас появляется много разных стыков приложений много разных серверов много вариантов 1 развертывания разного софта чем больше этих вариантов появляется тем больше типов конфигов надо учить тем больше различных особенностей того как конкретность так работает надо знать и это просто сложно в дополнении к этому это у нас есть еще один тренд это trend micro сервисов микро сервисы сегодня популярны многие организации многие проекты даже если у них есть какие-то большие старые приложения они берут и начинают от отрывать отпочковываются счастье этих приложений в отдельные сервисы и эти отдельные сервисы они тоже становятся часто сделанными на других языках относительно большого монолитного проекта они часто поднимаются на инфраструктуре отличающийся от старых приложений и со всем этим как-то надо работать так вот мы построили новый applications сервер который сделан по который сделан полностью динамическим и сделан и контролируется с помощью понятного и простого api яндекс юнит это не индекс который имеет свой код и свои ограничения по работе units строился исключительно как новый софт без обратной совместимости с кодом и джон икса он строится юнис строится для другой задачи для задачи запуска приложения для задачи запуска кода на языке который вы уже знаете на языке в приложение опен юнита это основной элемент того как вы его конфигурируете вместо того чтобы брать конфигурационные файлы класть их на диск и после этого перезапускать или каким-то образом заставлять веб-сервер читать эти файлы с юнитам вы посылаете запрос на и изменения непосредственно папе самого-самого софта непосредственно в сам юнит значит по умолчанию api у нас работает на unix сокете он может работать и на внешнем адресе если вы запускаете api управление на внешнем адресе я это скажу на сегодня 1 5 пожалуйста закройте его какие какой-то безопасностью настройки firewall и настройте аутентификацию не открывайте api управления просто так наружу далее немножко поговорим про архитектуру из чего состоит юнит юнит запускается как главный процесс который создаёт процесс контроллера и процесс роутера процесс контроллера занимается приемом запросов на изменение конфигурации изменения конфигурации могут приходить либо как полный большой джейсон со всеми приложениями со всеми данными которые вы можете себе представить либо как отдельные точечные изменения в случае если у вас уже юнит работает в нем есть какое-то количество приложений запущена вы либо хотите запустить еще какое-то либо либо изменить параметр отдельного приложения далее в unity есть процесс роутера состоящие из нескольких треков которые принимают клиентские соединения клиентские соединения будут приняты по http и отправлены через жареную память в процесс и приложений что это нам дает это дает возможность отделить сетевую конфигурацию полностью от конфигурации приложения то есть такие вещи как количества маркеров приложения такие такие вещи как а кому борту какому айпи адресу привязана какой именно из ваших приложений это эти вещи а они отделены в принципе но при этом они управляются единым open если мы посмотрим чуть более внимательно то что мы можем конфигурировать вопию не то это достаточно много параметров которые привязаны к самому приложения мы можем делать метода get путь делить туда в этот api изменять любое любой элемент любую переменную прямо на ходу значит еще раз если вы запускаете apis который вас смотрит наружу либо не делайте этого либо настройте правильные уровни безопасности вокруг этого далее очень интересный момент это как у нас приложение похожие как они отличаются юнит на сегодня поддерживает пять языков это печки питоны руби pearl & go и если мы посмотрим как вот пример который поместился у меня на слайд это чем у нас похожи и чем отличаются печи питонов sky руби приложения и верхней части мы видим что у всех у них есть набор параметров которые в принципе совершенно одинаков по конфигурации и вместо того чтобы настраивать три разных апликэйшен сервера у которых три разных типа конфигов три разных разных подхода конфигурации вместо этого можно это все сделать в виде одного и либо 3 api запросов но каждый язык из языков немножко отличается в своей имплементации поэтому у них есть и собственные наборы параметров которые специфичны для каждого из языков значит где брать индекс юнит вы можете зайти на главный сайт юнит engine x.org можете посмотреть на код юнита у нас на гитхабе а можете просто в одно движение запустить его в доке подписывайтесь на отдельный мэйлин лист на яндекс ольга который называется unit либо если вы увидели вас появились какие то вопросы их можно очень удобно задавать прямо на гитхабе представляете и джон x на гитхабе принимает ищут следующая часть следующей даже две части нашего доклада они относятся к более таким инфраструктурным задачам это купер не this increase контроллер и сервис меж когда я не отметил то что юнит у нас разрабатывается в москве разработка юнита заведует сам лично игорь сысоев и игорь несмотря на то что он основатель такой большой серьезной компании он все еще занимается архитектурой кодинга он ему очень интересны сложные технические решения которыми над которыми она работает вот то есть проект построен в культуре engine икса и он является таким олицетворением новых методов создания web applications егоров так вот двинемся дальше в сторону система регистрации контейнеров и управление сетями в новых микро сервисных архитектурах губернатор сегодня популярен это проект от гугла в которой достаточно открытый и многие организации его уже используют таком в продуктивном режиме в бою и обрабатывать большое количество информации запускает множество поводов и контейнеров в своих инфраструктура значит энгр из контроллеров для купюрница существует множество для разных сервисных прокси для разных типов сервисных прокси есть свои контроллеры которые позволяют управлять конфигурации этого прокси для engine.exe вот я сразу же в самом начале этой части скажу что контроллер существует два один из них создан комьюнити кубер не tissot он живет у них в репозитории и поддерживается сообществом у него есть свой набор функциональности набор фич у него есть свои собственные баги и есть контроллер который создан индексом на который живет в нашем репозитории и работает непосредственно с конфигурации и кроме всего прочего он имеет официальную поддержку есть еще один продукт который я особо не рассказывал в этой презентации the engine x плюс который коммерческая версия engine.exe и наши коммерческие пользователи хотят использовать фича коммерческого engine икса в губернии тисе и в соответствующих инфраструктурах и как раз наш ingress контроллер может продвинутые фичи плюсовой версии джон иксов тоже использовать непосредственно нативный напрямую с помощью с помощью интерфейса купер найти со давайте немножко посмотрим на то что купер нить из предоставляет какие функции можно выполнять что можно делать с энгр с контроллером который мы создали для индекса повернитесь и купер notice предлагает он предоставляет ресурс ресурс ingresso но он сам по себе не создает балансировщика нагрузки прокси о самку вернитесь напрямую не может серьезно управлять веб-трафика но при этом cooper tire представляет и интерфейсы для того чтобы этим трафиком управлять с помощью внешних прокси для разных проксей балансировщика нагрузки есть свои ingress контроллеры то есть для печей прокси это свой контроллер для индекса свой один или другой для инвайт третий и так далее далее по энгельс контроллер который мы создавали что у нас ставится у нас ставится яндекс и софт энгельс контроллера прямо в один и тот же контейнер ingress контроллер это отдельный софт который генерирует конфиге engine.exe создает ресурсы энгельса и забыт занимается перезапуском engine.exe для вот коммерческой версии он не всегда перезапускает индекс там можно пользоваться api чтобы делать отдельные изменения напрямую если мы посмотрим на то как мы можем кастомизировать индекс это достаточно серьезный набор функций которые можно применять через конфиг map & annotations то есть конфигурации в купер не this way а мы записываем различные данные в том виде в каком мы можем каком мы хотим их видеть в конфиге анжи никса часть функциональности доступно как отдельные элементы если вы создаете что-то совсем особенное вы можете создавать сниппеты когда вы создаете сниппеты это вы просто пишете конфиг engine.exe который будет поставляться в определенный локейшн в в конкретный сервер блоки которые будут создаваться там на ходу значит потому как использовать ingress контроллер все очень просто вы идете на наш хип-хоп вот и там есть подробная информация о том как им пользоваться и что можно делать gemko которая сейчас играется с консолью она показывает как мы запускаем индекс создаем несколько разных несколько реплик индекса далее очень просто видим как у нас все красиво раз масштабировал это один из примеров такого канонического масштабирования сервисов в принципе в системах типа kuyper найти со и последняя часть доклада это небольшой разговор про сервис меж и разговор про проект engine меж который позволяет запускать и управлять индекс сама в среде и steel значит сервис меж откуда откуда пошел этот термин откуда появилась эта проблема оно выросло из того что у нас последнее время появляется большое количество мелких сервисов запущены в динамической инфраструктуре эти сервисы начинают постоянно видоизменяться их масштабируют их перемещают из одной сети в другую с ними постоянно что-то происходит в общем такое понятие как maintained swindle там какой-то downtime для того чтобы что-то регулярно поменять его в этих средах особо не существует все время что-то падает все время что то поднимается все время трафик должен ходить по разному сервис меж в принципе как система это отдельный слой вашей инфраструктуре который позволяет вам динамически и распределена управлять отдельными отдельными прокси отдельными элементами связанности этих систем и желательно и очень хорошо если ваш сервис меж это система прозрачная для ваших сервисом по хорошему приложение которое какой-либо программист написал в написал на каком-то языке в каком-то виде его кода ему не обязательно и хорошо если этому этот программист не знает и полный и не должен знать про так как именно это приложение будет ходить и общаться с другими приложениями у него должен быть просто простой интерфейс что-то мне из сервиса а нужен сервис б значит я знаю как вот до сервиса б достучаться дальше задачей инфраструктуры сделать так чтобы из сервиса можно было добраться до сервиса б так вот сервис мышь как концепция предоставляет возможность такого динамического управления от от одних сервисов к другим engine меж как имплементация сервис мешок из тела поддерживает различные правила политики крипто вания мониторинг tracing это все очень необходимые функции для такого управления трафиком контейнер с прокси контейнер с индексом добавляется прозрачным образом то есть приложение как раз не должны обязать не должны видоизменять свою конфигурацию чтобы начать ходить через сервис мышь или ходить в сервис напрямую они им не обязательно знать как именно работает сеть между ними если мы посмотрим более внимательно на то как как у нас работает менеджер у нас существует агент который работает с системой и still i still это климента ция сервис меж от google агент конектится к аутентифицироваться всеми аутентификации конектится к системе который называется из тела пайлот агент собирает данные о том какие нужны сервисы где они находятся и генерирует конфигурацию для индекса далее в яндексе настроен несколько многоуровневый роутинг для того чтобы это правильно и быстро работала и конфигурация конфигурация которая сгенерированная этим агентом она применяется на на данный прокси далее после того как уже трафику ушел к данные по трейдингу отправляются наружу чтобы остальные элементы из тела могли понимать что происходит с этим трафиком на сегодня это май-июнь 2018 года я пока не могу сказать что ребята ставьте и city of production пока не надо это еще бета будем надеяться что из тела будет действительно хорошей системой и в будущем мы будем ее устанавливать и использовать в бою а пока что готовьтесь к таким подходом управления сервисом смотрите на разные решения пробуйте обязательно пробуйте как это работает значит где можно взять инженер это отдельный бит хоп репозиторий который называется engine меж он разработка engine мэшап ей занимаются наши товарищи в сан-франциско и в саннивейл в калифорнии на сегодня истер на сегодня инженер работает из тела 071 и еще раз кистью это штуковина которая находится в бете engine мэтт и джимми что же в бете поэтому проявляйте аккуратность и так мы прошлись по нескольким по 6 проектом который инженер сделает и которые не являются собственно веб-сервером engine.exe значит это кросс plain парсинг конфигурации из джейсона в джейсон удобно использовать для того чтобы не писать конфига руками amplify это saas мониторинг который позволяет вам не только создавать классные графике но еще и проверять насколько ваш конфиг соответствует хорошим правильным практикам создание этих конфигов нгс это java script имплементация которая сделана для динамического конфига индекса чтоб чтобы дженкс более configure как регулируемом был для более сложного управления трафиком но пожалуйста не делайте целые большие приложения на и джесси также как лучше не делать большие приложения на встроенном virgin x lua pearly или что то в этом духе вы носите в серьезный кот наружу для того чтобы запускать различные веб-приложения мы сделали индекс юнит и юнит позволяет вам не только и запускать но и динамически всем управлять значит юнит управляется через api он ничего не reloaded если очень не нужно им позволяет запускать приложение на сегодня на пяти языках но больше языков планируем поддерживать и следующие две вещи которые мы рассмотрели это ingress контроллер engine миша который они позволяют нам смотреть на и управлять трафиком в средах кубер не tissot и engine меж позволяет управлять трафиком видеосервис меж под системой истек и на этой замечательной ноте мы наверное откроемся все вопросов спасибо 1 2 левин александр который collapse у вас там перелив случился чтобы 6а да так и есть иначе мы начали с 0 и на этой прекрасной ноте 1 рекомендация api доступные на звездочке это нехорошо не надо повторять примерным кэш api пожалуйста по умолчанию пусть слушает 100 27001 все туннелях сошлись я смогут прокинуть мы не хотим ни вы ни мы видите понятны engine.exe я полностью согласен что api должен быть закрыт по умолчанию в наших пакетах юнита с версии после приватные бед и api по умолчанию живет на сокете вот с сокетом тоже можно работать в носу 27001 совершенно согласен можно нужно нужно отлично спасибо вопрос такой есть ли в планах изоляции отличный вопрос значит юнит позволяет запускать разные приложения разные приложения на сегодня могут запускаться под разными unix пользователями с разными группами то есть это такой скажем так первый уровень изоляция которой мы сразу в него вписали в планах есть поддержка си groups то есть более серьёзная изоляция в том числе изоляция по ресурсам одного приложения от другого она запланирована отлично спасибо спасибо за доклад есть вопрос что у вас по поводу планов юнита и живым java в принципе языков юниты java это вопрос который я ждал поэтому очень часто нас спрашивают когда будет поддержка java и когда будет поддержка java-script а планируем вот уже сейчас у нас идет исследование среди разработчиков и отдельные ресурсы разработки занимаются сейчас этим вопросом то есть до планируем работаем над этим ну какие то есть уже информация может где-то ведете блог какой-то по поводу это знаете про джаву нас спрашивают настолько частые настолько много что как только у нас будет информацией бета-версии и возможность этого использовать мы сделаем столько шуму что вы точно не пропустите спасибо добрый день спасибо за доклад хотел бы узнать во первых насколько сейчас вообще стабильно для использования в про де юни юнит сейчас позиционируется как версии 10 его как и любой новый софт нужно внимательно тестировать вашей инфраструктуре есть несколько функциональных ограничений над которыми мы сейчас работаем в частности поддержка tls и веб сокетов который мы от на сегодня еще не умеем но очень скоро будем для простых web приложений и для web-приложений достаточно известных таких как wordpress и другие фреймворке вы его уже можете использовать пробовать кроме того весьма вероятно что вы юнит не вы ставите сразу наружу перед ним вы поставите индекс firewall cdn и весь набор стандартного applications т.к. естественно вы это за мониторить и правильным образом и со всей этой со всем набором приложений когда это все правильно взлетит юнит будет таким же элементом инфраструктуры как другие апликэйшен сервера только с функционально стями легких быстрых изменений вашего состояния под приложений и консистентной sti то есть одинаковых типов конфига для разных типов приложений то есть каким cms уже тест ревнивые делали со своей стороны да мы делали тестирование с несколькими разными cms с различными приложениями и мы видим сейчас большую активность у нас на гитхабе от разных пользователей которые это пробует в разных режимах а где то можно будет увидеть страницу где там совместимость цены так далее странице совместимости если если мы говорим про такие языки грубо говоря все кроме go to вы можете использовать это с cms к без изменения даже коды этих cms какие языки поджигаем не понял какие еще языки планируют мы планируем поддержку java и java script как самые такие основные вещи на сегодня и мы собираем информацию от от вас от наших пользователей по тому какие языки вам еще нужны то есть что вам нужно для вашей инфраструктуры если вы в списке гид хоп ищу с не видите языка и платформы с которой вам нужно поддерживать напишите отдельный ticket чтобы нам смотреть за активностью по данному языку и мы будем видеть насколько это нужно широкому кругу пользователей окей по ндс еще два маленьких вопросов во первых что будет если в ран тайный код упадет бюджетными да есть ли энджи с овский код упадет такого и это я вам сразу не скажу что что я пробовал это выходить из java script они отсылая ничего обратно грубо говоря ничего хорошего гей и что будет весной дженкс не падает при такой при такой проблеме не падает с запросом ничего хорошего не происходит какие что если вдруг я зачем-то подрасти решу загрузить слишком большой джесс файл слишком большой джеймс файл тоже не пробовал не знаю во первых не делайте так загружайте небольшие файлы для небольших изменений конфигурации для быстрых изменений в контексте запросов извините если сделаю больно http 2 в контексте юнита ищите пе-2 в контексте юнита планируется причем планируется в обе стороны вот все будет и как говорит наш разработчик и ищите co2 валентин бартенев валентин говорит что в инфраструктуре юнита и в unity его будет сделать проще чем это удалось сделать в engine.exe отрадно слышать спасибо спасибо за доклад вопрос по мониторинг amplify он данные откуда берется джинкс статус как и как вы сказали я понимаю документации все будет написано но быстрый экскурс что он берет откуда это всегда отлично в двух словах амплитуд читает engine.exe вский конфликт чита engine is it can pick находит все директивы лоб формата и директивах access logo смотрит в эти акса слоги в соответствии с этим лаков ароматом оттуда считывает данные по всем переменным далее ищет все директивы дженкс статуса которые этот стоп статус для плюсовой версии в дополнение смотрит в плюсовые япет за плюсовым статусом собирает метрики оттуда далее собирая метрики пологом и по общей статистике только общие метрики слогов и статистику собранную с со статус модулей он отправляет в облака то есть логе целиком в облака не идут это слишком много данных и то это было бы ужасно еще вопрос эти потом в будущем метрики мпа можно передать какое другое хранилище например про митоз или аналог ну где с коллектор скале к'туна сохранить эти данные потом она будет работать с ними для sas версии вот именно для мп левая у нас нету api доступа к а к нему то есть вам нужно пользоваться через веб интерфейс который мы предоставляем но есть проект называется engine x контроллер в которой который позволит вам поставить систему в которой им плитка и полностью включен на свои сервера и там будет api доступ но и то это уже будет на вашей инфраструктуре это коммерческий проект оплетаем можно пользоваться бесплатно на небольшом количестве хостов спасибо здравствуйте у меня вот вопрос тоже по юниту то есть какая часть все-таки управляет а синхронностью и конкурентностью в запросов и вот многопоточности это все-таки сам код на конкретном языке или здесь юнит как-то вносит свои коррективы юнитов ский процесс роутера занимается тем что смотрит на набор запросов которые идет на определенный хосты порт запихивает эти запросы в соответствующие очереди на worker и приложений и дальше worker и приложения , разбираются с ними уже соответственно по порядку если мы рассмотрим такие вещи как например где где много запросов обрабатываются самим небольшим количеством процессов там они они прилетают в этот процесс вместо того чтобы поиграть по сети они пролетают через жареную памяти понятно есть возможность управлять грубо говоря вот то что на конкретный road конкретный сервисная поднять их там несколько процессов между процессами какой именно запрос на какой именно процесс упадет такого у нас сейчас нет в рамках одного объекта приложения все его worker и считаются равноправными и кому именно из маркеров конкретный запрос придет мы не можем сказать если их нужно такую большую гранулярный создавайте отдельные приложения с меньшим количеством worker of и отдельно направляйте трафик на каждый количеством бургеров мы управляем количества маркеров вы управляете а сего"
}