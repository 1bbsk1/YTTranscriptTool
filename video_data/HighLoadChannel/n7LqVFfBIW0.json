{
  "video_id": "n7LqVFfBIW0",
  "channel": "HighLoadChannel",
  "title": "RU, Developing Software for Persistent Memory / Willhalm Thomas (Intel)",
  "views": 118,
  "duration": 2120,
  "published": "2017-04-08T11:03:31-07:00",
  "text": "меня слышно прекрасно большое спасибо что сегодня вы пришли ко мне извините что не говорю ни слова по-русски но очень рад что у нас есть переводчики и они будут переводить то что я сегодня буду греть я поговорю о том что является предметом моей страсти это новая память и более что интересно меня для меня как использовать его в нашем программном обеспечении особы в отношении такой продолжительной или устойчивой памяти это совсем новый подход в их памяти и во первых это наша стандартный отказ от каких-то претензий я не буду зачистки то есть у что я скажу может оказаться неправдой но вот новая память которую intel я объявил о создании несколько недель назад это не диром это не флэша но это не волатильной а память и я даже не знаю что это такое целом но скажу вам что не характеристики этой памяти во-первых в тысячу раз быстрее чем тип лыж которые есть сегодня у него прочность гораздо выше на флешках и кроме того что она прекрасно масштабируется по сравнению с текущие технологии то и мы сможем пользуются больше памяти на тех же самых устройствах которые у нас есть сегодня все что я хочу сказать о памяти а теперь я поговорю о том как мы будем использовать эту память во-первых каковы преимущества внедрение новой технологии памяти и какие есть и такие каким образом нужно будет заменять программирование с тем чтобы использовать такую памяти в конце своей презентации я расскажу вам некоторые примеры о том как мы можем какие применять архитектуры особенны до базы данных и каким образом мы можем использовать преимущества так как новые устойчивой памяти и так с точки зрения технологии она имеет больше мощность емкости в кроме того мы можем ее сделать в apple от нее мы сможем сделать больше установите памяти на том же самом устройстве это мы можем сделать более банк больше димы чем у нас есть сегодня и кроме еще одно преимущество такой памяти это ее устойчивость то есть оно не волатильна и и вместе с программным обеспечением мы можем использовать вот это вот устойчивости когда вы делаете reboot на сервере данные будут все еще хранится в этой памяти и негативным моментом является вот латентность этой памяти о немножко выше чем диром но тем не менее она гораздо лучше бы по сравнению с тем что у вас есть сейчас и эту и доступностью скажем будет по каналам памяти лотность будет еще выше чем на ssd и она будет немножко медленнее чем деревне но с . именно тот же пример на порядок скорости и можно будет программировать также как мы делаем это для де рама и так что за устойчивости здесь у меня особый слайд and мы говорим что у нас есть два вида а х памяти хранения устойчиво вот это с одной стороны это мы работаем с памятью которая является постоянная то есть это ваш диск честер ssd и потом когда вы начинаете программу вы загружаете данные из ваши устойчивые памяти и 100 чего хранилища и вы ждете когда а ios начинает работать с диска и когда у нас появляется вот эта устойчивая память у нас будет всего один вид памяти которая будет одновременно и долговременным и доступным и фактически это меняет всю парадигму по наша в прошлом у нас было два вида памяти а сейчас это все комбинируется и складываются в одну 1 в 1 устойчивую есть ли вопросы потому что вы затихли то есть когда есть вдруг вопрос или ясность пожалуйста прерывайте меня сразу потому что я сюда приехал именно для этого и еще преимуществом такой память из и водится большая больше мощности и производительности если у вас сервис большей памятью это позволяет вам работать с большими объемами данных в памяти и не нужно делать пейджинг на двух дисках и кроме того и у вас растет скажем base база данных у вас просто наращиваете память в одном сервере и если у вас несколько на том же и фактически у нас меньше хостов но с тем же объемом памяти еще возникает одна возможность это быстрый рестарт ваших приложений то есть если нужно вам загрузить ира байты ваших данных это за раньше это занимало в минуты или часы с другой стороны если вы работаете в промышленности и вас важного заданных то вы можете это фактически время простоя в долларах то есть и у вас есть доступность то то есть у вас скажем сервер если вы до 5 минут это уже тысячи долларов но то есть это не решает все проблемы но одновременно это является снижением вот непроизводительных затрат как я уже сказал что есть еще оговорки на то есть вот you сожалению латентность в этой памяти больше немножко и но тем не менее это примерно тот же порядок цифр как и использовать дыры ну кроме того нужно помнить что если вы заботитесь о производительности то вам нужно использовать такую структуру данных которая не страдает от латентности и поэтому каширование работа происходит скажем вы используете рейсы и и это подготавливает ваши данных и и вы не будете тогда страдать от латентности и как у как часто вы будете использовать это память то есть может быть с компа использовать если только иногда вы можете при прибегать к использование этой памяти то есть и скажем вам не так важна производительность может быть не обязательно используется память но но кроме того если у вас есть при фитинг с высокая латентность я вот здесь показал это на слайде вот эта структура данных с левой стороны мы используем сканирование через ray у нас моделирование вот этой вот более медленные памяти который называется and persistent memory это устойчивая память и латентность у него удваивается но производительность снижается всего на 7 процентов и это означает что мы получаем данные тогда когда это нужно и еще чтобы ты доказательно теорию нас есть две колонки по сведениям мы когда отключаем префетчер и и делаем тоже самое сравнение озером и бпм то тут мы видим производительности и как это а как показано на слайде я когда мы используем дерево be + здесь производительность и потери примерно более значительны и выбираем имеет преимущество и здесь мы увидели это снижение на 37 процентов то есть вопрос такой диром является часть иерархии в данном случае мы их и у нас два таких а набора память их диром или persistent memory устойчивая память и и один из них это 1 ден а это другой день и подводя итог по latin вот префетчер если у нас если random access то тогда нужно быть нужно примерно оставаться в регионе дирам если вам не нужно вот это вот такая производительность а вот диаграмма которая показывает какие данные структура этих данных можно использовать и более прям имеет преимущество при с использованием process and memory и это когда ваши данные не получает преимущество от вот этой к устойчивости и может быть вы можете использовать эти рама но если у вас нужно использовать большую мощность и вам не стане страшная латентность то тогда здесь persistent memory является прекрасным выбором и не нужно никаких apple ств циклов оптимизации и вы можете посмотреть в общем выбирать те структуры данных которые вы хотите использовать я вам сказал что это новая парадигма то есть вместо перед у вас вместо диска и диром теперь появляется одна память и поэтому нужно будет использовать new новые и pr и здесь уже есть предложение и у нас появились документы которые с рекомендациями использовать также от мы используем i'm a map в.п. открывайте файл находится база адресов и вам нужна особая система файлов и мы мы можем их когда если к тельств и чаппа и и вот с этим устойчивых памятью мысль может мат делать map вот эту карту этой устойчивой памяти и не будет вы фактически мы мэппинг начинается без всякого копирования прямо непосредственно в базе данной базе ваших адресов но существуют и другие проблемы может быть они и проблемы но во всяком случае особенности когда мы записываем в нашу устойчивую память что-то потому что существует определенный кеш между нашим ведром и случая памятью и это вот посмотрите простой пример если мы хотим вы изменить переменную с 0 на 1 на единицу у нас появляется маркер который говорит это правильно труб и и прежде чем мы запишем этот код у нас это ставится фолса там где напротив 0 и теперь мы ставим единицу и пишем true но может произвести случится что один уже сидит у нас к в кэше и сервер когда он выключается и потом включается скажем у нас будет сохранена и сохраненный ноль и единица не всплывет и есть у нас такая забыть этот flash который смывает вот это вот бывшую переменную и этот flash фактически может вас быть таким образом за то чтоб он стирал это и здесь мы должны записать м fence который будет предотвращать того чтобы и вот не сходили с этим неблагоприятное событие и тут фактически мы пишем новую инструкции и это в том числе перками это устойчивость комет и и тогда он гарантирует нам что все данные которые мы смыли они остались в вашей устойчиво памяти и после этого вы можете доложить пользователю что все это устойчиво выйти немножко это более затруднительно чем обычно мы составляем память но тем не менее потом это будет делаться очень быстро потому что диска у нас никакого нет и здесь посмотрите список тех инструкции которые можно будет использовать эти слоям flash остается там навсегда архитект архитектура skylink оптимизирована для текущих ситуации но есть еще инструкции которая о том как писать кэш line right back он не промывает эту память но сохраняет копий и вместо того чтобы хранить их в памяти с тем чтобы обеспечить вот эту устойчивость и еще пиками цаета я уже упоминал это подтверждение того что все что за записано в памяти должно остаться там и альтернативой может на является особо железо которую мы будем использовать для особых а сервисах и и я думаю что коммерчески доступные серверы уже будут иметь и систему встроен и может быть я вас уже испугал вот с помощью этих таких memory fensys это ограждение памяти но тем не менее есть такая библиотека open source которая уже инкапсулирует все это и вам не нужно будет делать все это пиками цифр это промывание этих flashes вы получаете эту ребра турию эту библиотеку и и больше вам не нужно волноваться о таких вещах или использовать счастья этого такое а локатор который является устойчивым или безопасным для устойчивой памяти он уже так сказать и внешней доступен и вы можете оттуда его позаимствовать давайте теперь посмотрим а о том как это можно использовать для создания каких-нибудь отличных вещей скажем коллеги из из оцепили trace ростовского университета мы уже кое-что написали прототипы баз данных следующего поколения использующие устойчивы память и это статья уже было опубликовано instant recovery и в январе и идея заключается в том чтобы продвинуть это до самых пределов возможностей чтобы мы могли полностью использовать все преимущества новой технологии и такие мы во-первых можем напрямую изменить данные вашей памяти и вы можете заработать напрямую с устойчивой памятью и если вы хотите быть эффективными и программировать в фб раз вы можете использовать этот параллелизм и и стой это использовать эту модель разделяя устойчивую память edirem некоторая структура данных могут базироваться на устойчивое памяти другие будут использовать обычный диром и в зависимости от требований вы можете менять структуру данных между этими двумя областями памяти и вот простой пример от текущей это традиционные база данных вот здесь вот у нас есть данные которое хранится есть журнал теперь журнал этот лог уйдет потому что уже испугал ноги ой мы писали этот журнал мы убираем совсем и будет у нас микро лог и мы так же уходим от от копирования на диск и заменяем это все обычным копированием на п м и получаем все данных они мы в нашей устойчиво памяти она не волатильна и или мы храним продолжаем хранить это в дым и здесь можем провести такой барьер и переводить между двумя этими этими областями и до наших оценок мы используем такой прототип здесь мы не использовали новую память но мы его ее моделировали для наших экспериментов у нас был особый сервер у которого было два центральных процессов и лидером был к нему соединён с ним он и и он на использовала систему файлов для устойчиво памяти и мы искусственно снизили вот это вот производительность и был такой печи с микро кодом с о басе имитировать вот эту вот латентность и немножко процесс об использовании памяти был притормозим и мы использовали один из цепи один из процессоров с латентность you 90 на на секунд и для dm и мы моделировали латентность 200 на на секунд для устойчивой памяти и после этого сравнивали вот наш новый прототип база данных и что мы увидели слева это производительность на пресс протяжении долгого времени и при перезагрузке всей системы после этого мы сделали такой на пинка устойчивой памяти и посмотрели сколько времени потребуется для восстановления структуры данных в дерьме и и посмотрели насколько у нас эта разница то есть у нас была обычная структура данных для де рама и такая специализированная для устойчивой памяти и и посмотрели что для восстановления у нас все восемь секунд но это не так быстро и тем не менее мы не слышали вопрос сколько у нас был объем данных здесь это пара гигабайт не так уж и много у нас ограничено был этот симулятор вот этот но детали всех вы можете прочитать в статье итак мы хотели увеличить скорость работы и здесь мы применили другой идею наш нас вторичная дат структура данных в не требует ответа на запрос мы хотели мы начали запросы с использованием а исходные данные и в то время как мы перерабатывали индексы нас в бэкграунде мыс но мы по идее увидели увеличение скорости ответов на запросы и после этих операций мы получили что время до полной скорости оставлялась осталось до 8 секунд но вот для некоторых операций это то эти это было гораздо быстрее и мы еще поиграли с этой с этими возможности и подумали если мы некоторые индексы перенесем в устойчивую память и и вы их не нужно путали после этого перестраивать и здесь мы демонстрировали так и если мы посмотрим то мы здесь платьем определенную цену в производительности но но здесь у нас производительности было дельта восстановление было на меньше на 2 секунды ну и вот латентность была значительно процентов меньше и если мы все перенесем устойчивую память тогда у нас моментальное восстановление но здесь мы у нас меняется reboot на 30 процентов и тем не менее у нас восстановление системе в 5 милости мили систем и с использованием различные конфигурации мы стали смотреть что нам интересно вот пропускная способность это или восстанавливаемой системы и если нам нужно моментальное восстановление то тогда у нас вот этот скорость обработки информации с репу то значит не имеет так не играет такой важной роли и в зависимости от нагрузки и структуры данных вот эти кривые выглядели по разному но тем не менее для ваших предложений о приложений вы можете выбрать то что вам наиболее подходит и подводя итог я могу сказать что persistent memory случае памяти это фактически меняет обстановку на рынке конечно время еще есть в до того как она по появятся мы можем значительно улучшить время восстановление перезагрузки и если мы будем период профилировать наши системы нам необходимо учитывать что будут потери производительности будет высшей латентности но мы не нужно будет перегружать при рестарте эти инструменты будут скажем уже такие драйверы для ленокс microsoft уже объявил что они будут поддерживать такую же парадигму программирование и есть в библиотеке pm уже доступна и для пену и вы можете начинать разрабатывать ваше приложение с использованием симуляторов или то ядро которое уже это есть потому что и пиа и будет примерно таким же абсолютно каким вы его видели а теперь большого задавать вопросы да пожалуйста дня внесут микрофон спасибо за вашу речь есть два вопроса и первая из них это вот эта память и будет иметь те же самые циклы вы ограничения как ssd и второе какие размер этой памяти насколько она большая пока очень мало информация раскрывается для нас то что мы сумели выяснить это действительно революционная вами вид памяти и там и доступности и вот очень высокая она более надёжная и жизни циклы и дольше вот это вот первое что я могу сказать автору и какое по размерам памяти мы услышали что два сокета сервера да будет до 6 терабайтов это больше чем у нас имеется сейчас есть вопрос из 2 части если правильно понимаю ваши модели вот это вот скорость обработки будет примерно такой же как edirem но это что очень мы может быть не знаем вот этот скрипт каким он будет вот мы видим что у нас есть нигана вирулентность но может быть у нас нет полной ясности с производительностью вот пропускной способностью но вы знаете моделирование это всего лишь и мы он имеет свои ограничения поэтому здесь все все характеристики мы не можем пора проверить поэтому это только у нас была частично эксперимент такой сети спасибо за на презентацию к сожалению я ним самого начала присутствовал как ее установить на сервер и какие каналы мы будем использовать для того чтобы связать процессор с памятью intel предоставит это как обычно peace экспресса девайс это это должно быть применима из на тех же такие же будут связи электрические такого же размера как обычные димы и здесь я а это все что касается серверов а никто не газ машет про цену скука там есть какие-то прага графики допустим сколько будет вот волшебно эта память стоить за один гигабайт скажем но мы не знаем пока ценника но оно должно быть дешевле чем диром за гигабайт дешевле иначе и никакое здесь выгода и не будет нет еще есть вопрос когда будет релиз объявлен когда можно будет покупать ее вот это я не могу разгласить сказать вам ну где-то и через завтра или через пять лет в этом диапазоне спасибо"
}