{
  "video_id": "aR8ItZjeIsU",
  "channel": "HighLoadChannel",
  "title": "Новая архитектура шардинга MongoDB / Leif Walsh (Tokutek)",
  "views": 98,
  "duration": 1905,
  "published": "2017-04-22T13:07:47-07:00",
  "text": "и сразу же расскажу о том как запустить новую шар какую архитектуру mongo db высокой доступности лучшем использовании ресурсов оптимально не знаю пользуетесь ли вы обращали просто идея моя классная идея хочу прогнозировать еще пока не созрел сегодня поэтому просто хочу с вами ей поделиться может быть нам и оптимизирует где синенькие каналу бы этажах праймари зеленая это вторично и у каждого шага кэлен электрики на очень базовом уровне следами кто нам это даёт это на 3 основных 20 и наша эффективность производительности ваша аппаратные прямо аппаратной частью каждой из проверим может вступать в виде одного узла и у нас чтение повышать если у вас вторичные запросы истины приложение все возможно ида данных можно сочетать фрагментом любого из серверов реплику потому что фрагменты данных на них идентичны если запрос и ограниченные операции ввода-вывода умирать им буду повышается пропускная способность и такой вот классно из серверов дает существенный прирост производительности понятно есть ещё ситуация giraffe узел быть партиции rowan и естественно у вас повреждены и вот эти два нас есть большинство где мы промашку принимать потеряла можете потерять 2 видеозаписи повторяется до 2 2 произвольной дадут не подняв за мной 3 шт 1 копия признательна за вернемся это те преимущества которые репликации мы предстоим что нас сделаны зингер количество время запрос происхождение r for меня от узлов на отказать нормальных эрмин усадят облажаться показать стоит реплики десять шагов , 10 машин то принципе много будем делать такой миксера принципе mongo db заменяет gdb практиками собственное решение его может загрузить экспериментировать можно использовать самое эффективный ставь акции производить транзакции отдельными шахты и прочее и прочее снимать которую буду щас объяснять это слово можете об этом факторный деревьях раз после обеда довольно секции хотите об этом существа другие вопросы с вами беседовать можете обращаться ко мне поговорить отказываться буферизации можно использовать использовать операцию воду выводы зрели одесских прочитать и недорогие то есть нажать различных дисков не доверяете попробуйте сами завозили естественно здесь работа очень таким образом как вы видите дело принципе тоже самое когда чтение и запись этого чем-то скорость скорость чтения конкретное у нас есть разница между чтение записью основности то есть при одном лишь тут идет идет например запрос на часть участь модифицировать запрос и сам апдейт как конкретным вызовет то есть данном случае вы должны найти документов определенную принять ему изменение записать его обратно то есть тут операции что язык всегда однако принял репликации все данные мариса кондурсо должны быть одинаковы там нечего делать можно осуществлять дорогие операции праймеры делать натурально и потом записать достаточное количество информации чтобы потом избежать операции мнение записать все индекс сразу не использовать производительность что это нам дает результате у нас получается два мой сердца подумать вот загрузка праймари который использует на сто процентов здесь он использует вот вывод на 9020 было дисперсность неважно какая как только отражаемые решение вторичные слой полностью отказывается от операции чтения полностью max процент если вы делаете репликацию это личный сброшенную то есть вас остается достаточно громко операции иссечения восточнее можно пустить на чтение вторично не требует чтения-записи 3x сейчас конечностях больше для чтения потому что используется для за это к историчности важно не забывать сильно нужно понимать разницу давайте распределим сервера что мы сделаем помещений дело 2 авто личных каждая машина реплицируется милый обман обозначает совместного дарья полякова я сделал вторичный еще вторичный и важно какие дам на этом шаге он находится на каждой из машин этот шар заменим их другим любые изданные upper уменьшает горячие даже находится на одном из сёл шагала для фейсбука актуальны горячую да про джастина бибера на все а нам нужно распределить между этими тремя машинами так и получить 3x чтение и дальше трафик по записи он пойдет на все добраться до конца пользоваться большим количеством во улице липли к горизонтальным масштабировать запись всем трем машинам можно пойти на будем и другой круг и на подобного рода архитектура как мне кажется лучше может работать ресурсы вашего аппарата обеспечивает естественное них пока никто ещё не пользовался это просто моя еды идея может быть кому то эта идея понравится кто-то может это использовать усовершенствовать использование ресурса при таком раскладе когда один новый у нас отражает нужно переключить вторичная налоги сделать файл озерца не у вас будет меньше возражаем способности потапа там что не будем нацию совместно использовать ресурсы но доступность по-прежнему сохранится на странице года машина будет возвращена так сказать в строй когда вы там все настроить можно потерять отказ каждый шар представлен все реплики и вольны на каждом шарди у вас есть полный оборот каждая машина она отвечала на все данные все серверы можно сохранить и восстановить таким образом стоит больше идет личности будут пользоваться тебя ресурсы и colocation из печи наиболее оптимальную нагрузку аппаратного описать что все классно сработано на amazon и это я понял по посуде корзину в корзину покупателя виртуализация положить сегодня он дает напоминание об этом некоторые сандра колдунов и некоторые другие менее известные поставлены существует масса компонентов дать нам о анис и многие из них касаются нагорного записи и чтения программу c конфликту очень интересная область исследования не будут в данном случае об этом мы поговорим о том как это было сделано классное решение они как-то мелисса конца sexy man кольца так далее все прочее отдельные все сервер играются пирами все серверы разные абсолютно равны и условиях проще со каждый сервер финама хорониться совпадающие наборы данных выбираете 27 на основании меняются данными зуба и правой части но не всеми и данные будут как бы вот распределены размазанные с сервера выберутся конкретную партицию чтобы у вас получилась некоторые авторы распределения этих огромное количество для нас тических подходов можно использовать для того чтобы он здесь использовать можете погуглить consist хочу узнать о том как этот принцип работы 20 отличный в принципе я сейчас в общих чертах расскажу на серверах в кольце 7 обучение каждый элемент вы вставляете 4-разрядный формация помещаете эти другие на кольца рядом друг с другом и таким образом они составляют часть этого кольца равномерно распределенная по всему кольцо используется хэширование следующий д-р серверов на кальция вот и спасителях они не даны положим у нас b это для хранения cd вторичные гражданам шарден и все данные между b и отправляются в dc как в основном и ремонтируются забей ты на реплика данных в этом случае зависимости от того куда попадают ваши данные вы считаете операции записи на любом из этих сердце из вас равномерно распределяются данные для вас получается линейные масштабируем что можете записать любую из этих машин по спокойно идет репликация с коэффициентом р как я показала получаете все преимущества от наличия этих реплик танцевать у нас получается людей в штабе ранее и получать все приезжают использую обычно это понятно а посещаю системе wmx и шарф в стиле 1 а у них можно об этом говорить много многие захотят использовать случае у вас есть набор реплик но ведь это у нас на основной реплика копия создается для двух машинах еще набор бабе б который реплицируется на других играх других машинах то есть данном случае dns сойдешь с ума не то что правильно обработать такие вопросы но если вы наладите работу что произойдёт при нормальном работе такой солю рации каждый узел и физическая машина будет играть на 43 сервере какие-то данные какие-то на вторичную сервере это понять и услышать ваши физические сервер и они будут ходить совпадающие наборы данных фрагменты наборы дан в данном случае я хочу вам показать буквой s это коэффициент шарден то есть у меня всего 8 и показано количество копий данных значит track 3 копии данных в данном конкретном zones к расплате на картинке получается с x это меня пропускная способность для записи может записать любовь к машины у меня получается есть преимущество я могу создавать количество реплик копии размером с р то есть меня получается отличное решение по восстанавливать доступности восстановлению данных данные всегда будут доступны в мире одна копия сохраняться и доныне потеряю да вот наличие мест есть и дай нам очень интересная штука как добавлять и удалять эти узлы как удалить добавлять ноды когда добавляется моих добавлять и узел аж сразу после же добавляйте на но dh что происходит с пространством наконец 200h и забирает либо половину данных от а отсюда и потом на все эти данные нужно переместить и сцена наш что остро либо же вы можете эти всего узлы переместим на кольце и у провести либо лакировку распределение пусть данной опять перемежается кластере основном принципа ноги по принципу дина они используют виртуальные ноуты которые весьма удобны для создания они изначально изначально создают сложных узлов но данный которые может хранить определенное что данных и таким образом при добавлении какого рода будет задействован кстати можете почитать дополнительно формацию вам эта тема интересна но идем дальше если добавляю сюда казани музыка публично какой-то not take домой новый узел вот сюда добавим который будет естественно иметь основном разделся и у меня перейдут сюда вторичные зачем ты этот узел забирает один на вторичный с диалогом сюда одну реплику отсюда и перемещает отсюда отсюда и серым виде разделы и также берет все под себя g и навещает сюда не освобождается свободное место для вторичного заражения из узлов а то есть получается создал новую репку новый узел и чанг балансе балансировщик фрагментов все перемешивает и балансируете данные перемешивается перемежаются узлы используйте перемещать данные куча одному другому для того чтобы соблюсти на равновесие и получается что у вас создается путевка на вашем сервере и на старых имеющихся в структуре идет уравновешивание балансировка давно сказано во всем кольца естественно в такой микс это не происходит если хотите узнать модель то обращайтесь ко мне за моими не имеет отдельный разговор тем не менее проблема какая есть значит этого то на чем нам придется работать дальше как предотвратить перемещение перемещения и перемешиваем и использования балансировщик фрагментов чанков в данном случае возникает вопрос как же все-таки даже всё-таки мы можем изменить баланс так что это было сделано интеллектуальным образом чтобы все фрагменты были англии мисс плен и правильно правильно повеливал кассандра реактор имеют различные стратегии решения данной проблемы очень интересно и подробно и значит вопроса можем позаимствовать их идеи использовать у себя проба нет второй момент каждый должен так или иначе осуществлять отладку при эксплуатации необходимо находить машины в случае их отказа поднимать и так далее в архитектуре мозга это крайне сложно потому что вот сколько серверов нужно знать новичкам графической машине сколько их там грузится для этого нужно использовать соответствующие фантаре поиска объединять процессы фатин очень сложное решение у нас пока еще никто это не использовал поэтому кому интересно и такое решение обращайтесь как можно сделать благодарю за внимание я инженер по nittoku так работаю со всеми вопросами которые касаются актуальных деревне в том числе обращаются ко мне с частыми вопросами долгую mx если вы используете уже mongo db у себя активно то обращайтесь к тоже по вопросам производитель сpu дабы мой email мой twitter продуктовая страничка на сайте топку mx току так большое спасибо за внимание ваш вопрос послов bold мой вопрос о распределении операций чтения на репликах нас леев реплика предположим нас life репликах находятся абсолютно те же самые данные что и на основных на принципиальных узлах верно ли то что это можно сделать абсолютно синхронно нет нет это то что требует от приложения возможности работать со старыми данными некоторые могут некоторые а у вас проводилось тестирование на тему того может ли это отказать и оставаться устойчивым в течение ских секунд в целом нет нет не может опуститься small malkova бойцы если задержка если отклик составляет 10 20 миллисекунд попробовал понимаете дело в том что проблема будет если у вас реплики будут дальше располагаться и в отдельных зонах то тогда конечно же будет задержка при отклики и нужно определять иную стратегию конфигурацию при чтении данных этих машин потому что эти проблемы знают меня проблемы которых я встречаю в своем университете мы как раз над этим работаем ну тоже над решением таких проблем самого булгакова творцами использовании виртуальной синхронизации которую как вы правильно здесь изложили нужно уравновешивать дак это тема актуальна по не идет масса исследований называется тема casual консистенсии по-английски что это такое вот предположим что вы не можете перемещаться во времени до времени но чтобы вы все-таки могли бы сделать а ну короче вы создаете такие виртуальные часы основываясь на показаниях не физических и виртуальных часов вы определяете мы максимально объективную производительность да да да эта тема отдельно который не касается там случае мы этим и mongo db частности каково будущее вашего продукта и mongo db mongo db в точке 2 и 8 версии 28 работать стороны чипе ой то есть а что это значит мы покопались выходят поменяли их код создали storage engine это как раз для такого рода решение мы конечно же не получим быстрых обновлений кластеризации она не будет включена в данную версию но мы сейчас работаем над созданием версии которые она будет легче обновляться и будет более сопоставимая и совместима с приложениями вот так я отвечу на этот письменный вопрос ну здравствуйте мне вопрос мне не на тему вашей презентации непосредственно но вы и кубе все таки конечно же очевидный эксперт в области он mongo db можно увеличить размер и вес использовать большее количество индексов и индексов музей тысячи больше размер чем размер по умолчанию вопрос очень актуален для меня размер н.с. это к yandex мы не знаем там сколько угодно можно использовать mongo db размером с можно безопасно увеличивать насколько мне известным его можно безопасно увеличивать и проблем с этим не возникнет ну indexof к yandex конечно будет много быстродействия замедлится пожалуйста какой то есть столько inox столько индекс безопасно это можно использовать до такой палец безопасен спасибо ride free applications вы про это говорили о несчастье mongo db смотрите хорошо поместить реплики на отдельный сервер все таки да для безопасности да это так просто хотел уточнить совершенно верно"
}