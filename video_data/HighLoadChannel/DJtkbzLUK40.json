{
  "video_id": "DJtkbzLUK40",
  "channel": "HighLoadChannel",
  "title": "Переписывать или не переписывать? Жизнь с техническим долгом / Антон Потапов (Ingram Micro Cloud)",
  "views": 1271,
  "duration": 3173,
  "published": "2019-05-15T04:05:40-07:00",
  "text": "всем привет меня зовут потапов антон я это в компании на микро и я бы хотел поговорить о том что всем вам хорошо знакомо о техническом долги о том как с ним жить и наверное наиболее таком kaleva рынком вопросе переписывать или не переписывать значит для того чтобы мы двигались более менее продуктивно давайте начнем с того что выяснил что такое технический долг значится моей истории я буду предполагать что в технический долл включены все те шалаши из костылей которые у вас есть продуктовый логике то есть где то вас поджимало время вы добавили имплементацию с ограничениями где-то вас поджимало что-то еще и вы за использовали там старую технологию например где то вместо нормальной сортировки вы написали сортировка пузырьком потому что у вас там не знаю 5 объектов массиве а то есть вся вот эта область это неотъемлемая часть технического долга вторая часть это все что связано с сборкой вашего результата интеллектуального труда и доставку этого до конечного потребителя билды все проверки на фазе билдов статические linker и стиле все остальное автоматизация deployment а апгрейда притчей типа стейки вся вот эта кухня связанное именно с доставкой и вещи связаны и собственно самим тестированием да то есть это юниты это интеграция тесты это тесты которые шастают по его и от начала до конца вот обычно в этой области как раз любит больше всего добавлять долг то есть тесты всегда откладываются на потом кто-то хочет что-то добавить если вы делаете езды к или опия и обычно сюда добавляют документацию потому что это тоже ваш ваша ответственность вы должны это делать теперь что с ним делать на самый популярный вопрос самое популярное решение с точки зрения бизнеса это что больше всего беспокоит нас это ничего смысле давайте его продолжать накапливать почему потому что делать можем быстрее на самом деле это не такой уж плохой ариант у меня есть истории я не буду про них открыто рассказывает сейчас если захотите могу потом показать когда мы ничего не делали с очевидной проблемы архитектурного плана и в принципе жили нормально просто потому что это никому не мешала вторая часть это вы придумаете какой-то план и кропотливо шаг за шагом покидаете этот самый технический долг при этом не делая никаких революций ну и самый смелый вариант опять же популярный у тех кто только начинает кто-то в детстве смысле на заре своей карьеры переписывал что-то с нуля ну ну я ожидаю лес рук да да да да да и обычно люди на старте что-то переписывают ничего не получается и этот опыт навсегда остается с нами и потом когда мы уже взрослые опытные профессионалы мы сталкиваемся с проблемой что мы не переписываем на самом деле иногда это имеет смысл и это одна из историй которую я хотел бы сегодня рассказать как мы переписали с нуля и коммерс и мне кажется немножко преуспели в этом деле давайте немножко поговорим о том как обычно происходит разговор про технический долг вот там вот слева у нас для вас слева для меня слева точка зрения разработчика его что-то достала он долго терпел долго страдал долго думал что с этим делать и у нее в голове появилась финальное решение нужно все это три factory потому что ты фиксер один бак добавляешь два новых девелопер фичу приносишь 10 новых багов все там больше делать нечего текст справа обычно это человек который принимает решение это может быть ваш начальник это может быть product это может быть project кто-то еще и вот ему это прекрасная идея подается в свете очень непонятные абстрактные формулировки давайте напишем много тестов из этой фразы человек который в технике не понимает ничего у себя понимает что-то хотят потратить на это время но при этом вылью 0 но мы предположим что это чек вежливый и пытается разобраться в проблеме потом спрошу это зачем опять же человека которого давно болела этот вопрос вызывает только одно негодование и ответ выдается на отстань сейчас за пару недель все пофиксим вот причем надо понимать что формулировки мы сейчас поднимем к вырыть люди которые поднимают про технику понимают про что еще идет речь а вот второй человек эту часть предложение пропускает потому что это непонятная непонятно исчезает но опыт опыт работы в команде где много технического долго пару недель превращает в месяц коэффициент двоечка оптимистичный ну и плюс погрешность это уходит в квартал в результате в голове складывается идея квартал впустую но он все еще надеется надеяться понять что он получит что все получат опять же в голове у человека который предлагает эту идею у него уже все разложено по полочкам там все аккуратно все стройно целью сплошным потоком льется на всех но этот ответ не сформулирован нормально не сформулирован понятно и опять же абстрактная формулировка все будет лучше человек со стороны бизнеса обычно понимаешь в этом месте где то обманывают и в лучшем случае вежливый человек вам скажет да но потом знакомая ситуация отлично как я вам предлагаю с этим бороться если вы с этим сталкиваетесь я лично с этим регулярно сталкиваюсь мой pm не понимают зачем технический долг у меня этот вопрос зачем не очень беспокоит поэтому я и мурашову эти вещи и иногда он меня убеждают в том что что то не нужно делать иногда я его убеждаю в том что что то нужно сделать всего лишь навсего нужно ответить на вопрос зачем вы хотите инвестировать в этот самый технически долг и вариантов ровно 2 вы либо что-то улучшаете или бы где-то экономите смысле 3 варианта не бывает ну можно по потом подискутировать но я не вижу их если вы что-то улучшаете обычно у этого что то есть понятное определение с точки зрения бизнеса и есть единицы измерения то есть у вас количество дефектов в релизе в штуках количество свечей в релизе в штуках количество релизов не знаю там раз в неделю раз в месяц раз в час и все остальное доставка от идеи до продакшена в единицах времени календарных не фортах если вы что-то экономите это должно быть что-то понятное что-то измеримая у вас меньше разработчиков готовы продолжать developed продук с той же скоростью у вас меньше саппорте рф могут поддерживать этот продукт или поддерживает тот же продукт для большей аудитории вы можете провести через информационную систему то же количество объектов меньшими силами или тоже команда намного больше поэтому ордеров заказов не важно чего протащить через вашу систему если вы можете в таких терминах ответить на вопрос зачем вам осталось сделать совсем чуть-чуть добавить даты и стоимость сколько стоит съесть этот технический долг и когда вы сможете это сделать когда вы получите такой план и пойдёте с ним разговаривать с product owner am директором начальником не важно с кем во первых вам будут относиться немножко более серьезно потому что вы пришли не с какими-то эмоциями предложениями в которых ничего не понятно а с более-менее измеримые и значит верифицируем ее вещью во вторых у вас есть шанс что вам скажут нам это не нужно и вы лучше поймете какая задача стоит у бизнеса какая задача стоит у вас лично она вам на бизнесу надо и может быть вы просто перпендикулярно ближе направлении хотите двигаться еще одна важная часть когда вы принесете такой план заключается в том что вы сами избавитесь этой иллюзии на тему того что за две недели можно все принципиально улучшить мы я расскажу эту историю чуть попозже год планомерно улучшали продукт и в нем осталось его еще очень много теперь истории да про то как мы с помощью вылью договаривались продуктами и поджидали технический долг решая разных задач первая история это я работал в команде которая занималась разработкой ей на выезды к компания тогда писала новую контрольную панель наш продукт занимается дистрибьюцией облачных сервисов такая платформа куда можно подключить разные сервисы типа офиса 306 5 и продавать его через на смене жить его через нас заводить юзеров и вот эта вся большая кухня мы писали контрольную панель моя команда занималась разработкой ей на выезды к control и виджеты навигация визарда интеграция приложений друг с другом и вся в эту дорожку и предполагалось изначально что мы помогаем другим командам devil опять но по факту оказалось что мы им только мешали мешали почему потому что у нас было порядка 20 блоки блокеров в каждую неделю а это означало что если к нам приходит блокер мы откладываем все остальное садимся фиксить его а другие ребята ничего не могут сделать пока не получит фикс от нас такая очень неприятная ситуация на их было 20 в неделю то есть четыре в день это минимум два человека full-time занимались тушением пожаров и это то что не нравилось нам это что мы предложили бизнесу поправить сказали ребята давайте мы с этим что-нибудь сделаем бизнес стал давайте это не нравится и мы подумали что с этим можно сделать проведя анализ багов мы выяснили что основная проблема это отсутствие нормальных тестов классика жанра кто-нибудь сталкивался с тем что багов много потому что тестов мало спасибо я не чувствую себя одиноким значит и мы решили что нам нужно добавить новых юнитов и первое что мы попробовали сделать это научились писать новый код с хорошим покрытием казалось бы ничего простого смысле бери допиши но нет во первых каждый раз на не каждый раз а первого раза три мы говорили себе вне в этот раз этот баг эту фичу мы сделаем по старинке остальные уж потом в следующий раз все будет правильно были проблемы с роботами которые иногда мешали нам жить но в общем мы научились с этим бороться по пути заменили под систему тестов на какую-то другую которая помогала нам двигаться вперед и только после этого мы сказали себе окей теперь мы достаточно взрослые мы понимаем чё нам это стоит мы готовы каждую треть нашей capacity смотреть к нашей к пасте каждую операцию тратить на то чтобы подъедать долг потому коду когда уже написан зари лежим люди им пользуется но он не покрыт полгода мы писали треть нашего времени тесты кто-нибудь проходил через это упражнение полгода писать юниты вот вы наверняка добились того что стало лучше у нас стало в два раза меньше блокеров и самое главное мы перестали своими блогерами мешать другим людям девелопера мы стали нашей проблемой стала самой актуальной проблемой стала другой от нас теперь захотели не ломать смысле не стабильности развития омской ребята ну как бы все стало неплохо но нам бы больше печей и в этот самый момент мы поняли что в целом все нормально мы молодцы технического долго стало меньше на стали меньше теребить по непонятным историям и теперь мы просто пишем тесты в этой команде на новый год но старый кот мы как это сказать системно с этим не боремся то есть мы съели достаточно большой кусок долго оставшиеся оставили и поехали дальше два года назад мне предложили поработать над развитием нашего in how снова би ту би и камер solution а который на тот момент состоял из технического долго чуть менее чем полностью для того что вы понимали масштаб беды значит не было бил новых машин от слова совсем но смысле просто не было разработчику себя на девелопер scanstation и что-то собирал и потом внес это в продакшен своими ручками 1 и суть элитных функций имела 20 копий это не преувеличение это не метафора это аккуратно и число 20 копий то есть ребята которые девелоперы продукт до этого добавляя новую утилиту you функцию чтобы не сломать предыдущее поведение добавляли новую копию этой функции и так сделали 20 раз доводилось кому-то видеть что-то похожее о и я честно честно честно думал что это не настолько популярна вот проблема с которой мы столкнулись но в смысле нам самим было очень неприятно с этим работать мы тратили вагон времени на поддержку то есть такая не очень интересная работа ты ничего не улучшает что просто поддерживаешь и постоянно тратишь на это силы бизнеса не устраивало то что команда которая до этого занимался доработкой на самом деле не ел 5 новых фич они там три года писали этот продукт они сделали правильную штуку они быстренько нарастили аудиторию пользователи они там есть там живые деньги там все хорошо но они утонули они прозевали тот момент когда нужно было из ситуации мы быстренько на коленке делаем стартап чик перейти в более такой формализованный продуктовый стиле разработки и эту проблему мы решали следующим образом мы решили что мы не будем смотреть на количество багов мы не будем смотреть на количество critical of блокеров или старее или печей не важно что мы будем смотреть на время время которое разработчик тратит я поторопился извините на вот эту вот неинтересную нам активность мая все трека им жире в жире треком же и время это независимая часть истории просто у нас были эти данные и мы решили что мы будем ими пользоваться для того чтобы выбирать что мы будем делать мы пришли к моему искали случае дорогой смотри мы два человека full-time из десяти тратим на раза на поддержку ность онлайн смысле эти люди вообще не пишут продуктовый код они просто отвечают саппорту и каждый релиз месяц как каждый релиз который мы делаем 1 месяц мы несем до продакшена потратив на это человека неделю ну то есть мы можем взять иного человека он неделю full-time с понедельника до пятницы все таки build который уже есть донесет до всех клиентов давай мы немножко времени будем тратить на то чтобы это улучшать а что ты получишь взамен от тебя потом больше будет больше разработчиков которые будут делать вещи быстрее и попался нам сговорчивый парень мы с ним договорились на 15 процентов казалось бы не очень много он самом деле с 10 человек это один человек точно и ещё немножечко и силами одного человека может довольно много сделать значит первое что мы убрали это мы убрали некоторые такая страшная тяжко эти говорить технологическое наследие от предыдущей команды мы убрали введя и введение кому-нибудь доводилось писать код не интересно вот это вот боже мой есть эти несчастные для меня было дикостью мы договорились с админами пофиксили проблемы объяснили всем что введя сию пена мне нужен для того чтобы защитить интеллектуальные права и в общем можно жить и сильно лучше потом мы поддержали в нашем и комиксе интеграцию с плагинами которые есть к нам в нашей платформе платформе есть продуктовые специфичные плагины там офиса есть удару бокса есть и в других ребят есть и исторически сложилось так что в нашем ника mercy эту логику дублировали в коде нашего продукта который писать могла только наша команда скорее новый мы не будем так продолжать больше мой дадим вам тот же самый инструментарий если вы интегрируете с платформой вы работаете вместе с нами автоматически из коробки если у вас что-то не работает в платформе не у нас это не наша проблема это ваша проблема почему потому что это ваша интеграция три человека месяца инвестиций и человек full-time освободился смысле мы выкатили то в продакшн объяснили людям что этим можно пользоваться они начали этим пользоваться катом еще за три месяца часть логинов самых важных переехала и у нас освободился целый человек самый низко висящий фрукт который мы нашли минимальная стоимость максимальный эффект вылью просите следующая часть мы начали работать над нашим сеем мы заявили белковые машинки мы завели инструментарий для тестирования кому-то доводилось добавлять имени тесты в продукт который в продакшене и в нем никогда не было unit тестов кажется популярная практика да вы понимаете да что это значит что иногда код можно просто выбросить и написать новые просто ну потому что иначе к нему не подцепиться это было не наш случай к счастью нам немножко повезло и здесь самым важным для нас было следующее вот эту кухню мы каждый раз то есть мы планировали ежемесячно мы каждый месяц отвечали для себя на один вопрос что мы можем сделать за месяц потому что в конце месяца мы реализуем функциональность что нам максимально сэкономить время в будущем и получилось так что мы например не вкладывались в нтн тестирование самого начала а научились автоматически апдейтить из куда мы выкладывали наш сайт и наш опять почему потому что исав у нас несколько автоматизировать это проще всего и соотношение ресурсы против пользы самое хорошее отдают автоматически базы данных мы написали на пире сильно позже потому что достаточно сложная процедура но история показала что мы редко меняем базу данных и нам этот инструмент конечно полезен в принципе но прям сегодня он нам не сильно спасет ситуацию потом мы научились писать какие-то м т м тесты потом мы научились их запускать на продакшене потом мы научились тестировать какие-то продуктов и специфичные вещи на продакшне да то есть мы каждый раз это вот я просто очень хочу что вы по про были против своего опыта принцип прицениться к этой идеи мы на итерацию планировали ровно ту работу которая за операцию нам принесет вылью то есть мы что-то делаем релизе мы сразу начинаем получать какой-то профит может быть немного может быть чуть чуть но все еще таким образом мы год улучшали продукт теперь у нас этот продукт может поддерживать меньше одного человека то есть один человек дежурный отвечает за все инциденты прилетающие саппорта но при этом иногда у него бывало возможностям пофиксить парочку багов которые просто на нем висели они не из саппорта или кому-то там помощница код пореветь в дизайне поучаствовать то есть немножко поучаствовать нормальной работе мы научились релизиться за 1 человека день да ну то есть мы общие усилия которые потратили сократили в 5 раз а по пути мы еще насобирали довольно большой объем работы и это был на самом деле не весь объем работы которую мы у нас находился на то есть мы прикинули что пофиксить все инсталляцию написать нормальные тесты закрыть сценарии выкинуть все костыли и убрать copy-paste старый кот вот эта вся это больше чем пол человека года полгода команды в смысле вся команда полгода делает только это ничего кроме этого ни одной фичи ни одного бага ничего не фиксит только сида и технический долг в этом месте стало немножко грустно ну потому что мы поняли что все низко висящие фрукты уже собраны а в проекте все еще ну как бы достаточно много всякого ненужного и к счастью к нам пришел бизнес сказал ребята в тот же самый проект для того чтобы наш инхаус solution сделать доступным для других пользователей платформы а их там где-то 150 по миру это исторически так сложилось что этот компонент есть только в компании ingram потому что раньше компания инграм купила софт но никого не купила разработчика сейчас она купила разработчика поэтому я как бы в играми мы и пользователи разработчик одновременно в это раньше они были только пользователям и они написали эту подделку и оно не доступно никому никому другому а деньги в ней есть и бен сказал ребят давайте пожарим этот инструментарий ну конечно можно но логе пишутся в из qu'elle саппорт вы скрыли не умеет и поэтому что нужно чтобы там был разработчик родовая травма я согласен я к этому не причастен но это неудобно и вот в этот самый момент вспомнив то сколько у нас технического долга и что мы вообще можем с этим поделать мы решили что мы эту штуку перепишем с нуля если возьмем заново все frontend все еще на java скрипте бэкон все еще надут нити но это уже не тот тут нет и java script немножко не тот framework и разметка совсем не то но напишем те же бизнес сценарии бизнес требования к этому этой к этому продукту показа просите оказалось не очень просто собрать то есть мы предыдущая история домой год съедали технический долг в этом продукте мы взяли его вдоль и поперек там простите меня 15 экранов но смысле что может быть проще месяц я full-time наш pm full-time еще один pm на половину своего времени на наш директор половину своего времени месяц натурально месяц собирали по крупицам от всех людей в компании до кого могли дотянуться а что должен делать этот продукт ну потому что документация наш технический долг ее тоже не было в смысле ты приходишь к людям играешь смотрите вот мы делаем вот эти фичи 10 штук остальные все выбрасываем в ok с этим и играть нет что вы там столько блокеров и мы все аккуратненько записывали месяц 15 экранов потом когда мы поняли все таки что мы хотим сделать очень хорошо поняли детально поняли обсудили это со всеми для кого это влияет из для кого-то этот инструмент для зарабатывания денег смысле наши союзы с помощью этого продают сервис и зарабатывают на этом деньги мы сели писать такой холодный дизайн опции было вот собственно 3 до взять то что уже есть довести это до нормального продукта написать с нуля вариант который мы выбрали или взять что-то сторонняя сторонние не стали брать почему потому что но в общем обоснование показала что для нас это будет дорого выписали табличку три колонки несколько строчек сколько стоит выпустить первую версию то есть когда мы сможем за релизиться сколько стоит добавить следующую фичу ну потому что мы же потом заходим этот продукт развивать мы ещё не закончили свечами в нем сколько стоит поддерживать да ну то есть саппорт надо увеличить два раза сократить в два раза и сколько стоит использовать на то есть люди которые конфигурирует этот кий коммерс для потребителей с ними что нужно сделать сказали что больше что меньше выписали все в одну табличку и сказали что переписать самый лучший вариант на основе этого варианта сделали план сказали ребята мы поддерживаем старую систему также как и раньше ничего не меняем приходит баги блокер ные мы fixin приходят инциденты мы разбираем подсказываем помогаем потому что бизнес должен продолжать работать но полгода мы оценили свою разработку в полгода приблизительно столько же сколько технический долг мы девелопер только новый продукт бизнес сказал конечно опция так себе ну почему бы и нет нам повезло мы убедились убедительные или у нас талант убеждения в общем я не знаю но мы их убедили значит как убеждали важная часть истории которая нам помогла сэкономить некоторое количество нервов времени во время запуске переписаны версии мы все со всеми обсуждали мы всем рассказывали на самом разном уровне детализации то мы делаем зачем мы делаем как мы делаем для кого мы делаем у нас есть был формулировка это этого проекта по переписыванию и коммерса объемом в одно предложение в один абзац в один в одну страничку на конфлюэнция в can в дизайн под каждую фичу и бизнес сценарий который есть в комиксе потому что разным людям нужны разные вещи а если к вам приходит ситес прошит вы правда переписываете grind вида почему мы ему даем абзац он говорит а вот эта часть мы ему даем страничку ингрид а вот это и там дизайн свечей и что он доволен и он уходит да ребята у вас все хорошо продумано все нормально вы молодцы работаете план есть идете по нему успеете вы молодцы мы успели мы молодцы важная часть истории заключается в том что когда мы пришли к тому решению что вы все-таки переписываем не все люди внутри команды были оки с этим смысле я чётко помню в некоторых глазах тихий ужас как наши сейчас заставят переписать на что-нибудь другое нам чуждо посетил господи пи том какой нибудь я не против китайцев ничего не имея но у нас его почему-то не любят не знаю почему а что же мы будем делать а нас всех уволят пишу об ну в общем это отдельная песня смысле правда если вы надеетесь что вы можете что-то большое переписать и у вас команда который разбирается в этом продукте скажи . наконец все не скажу кто то скажет да кто-то скажет нет мы не стеснялись отвечать или не сознавались отвечать на вопросы всех людей до которых этот наш анонс нашего плана доходил к нам приходили линейные продакт-менеджер и линейные силы говорили ребята у меня там есть очень важный сценарий у нас есть на спрашивали что он хочет и говорили есть или нет но будет потом или нет он вообще не нужен в этом месте люди спорили но обычно мы всех убеждали в общем мы очень много говорили очень много говорили все еще продолжаем говорить когда мы начали запускать этот продукт в продакшен нам прибегали люди пересушите там же есть важная фича мы говорили до мы договорились в январе что мы ее вообще не делаем ну ладно а еще вот это без нее вообще нельзя это блокер смысле прям совсем блокер мы говорит все еще договорились делаем через три месяца через три месяца нормально все спасибо я вам правда если у вас нет плана вы не взлетите потому что люди будут приходить со своими светлыми идеями непрерывно мы запустились продакшен люди все еще приходят и говорят а вот та фича мы верим да или нет в зависимости от чем приходят и я уверен они еще полгода будут приходить с такими идеями обратная совместимость очень важная часть истории мы поддержали плагины и поскольку мы поддержали плагины нам нужно обеспечить для них обратную совместимость потому что иначе все люди которые их девелоперы нас проклянут здесь на самом деле довольно просто мы взяли сэмплы плагинов которые у нас есть мы взяли наши тестовый сценарий которые были в старой системе все из-за implement или провернули прогнали нашли проблемы постарались пофиксить у себя часть проблем сожалению пришлось фиксить плагинах что считали когда решали фиксить у себя или в плагинах смотрели сколько стоит проблема и пофиксить у нас сколько стоит пофиксить под в плагине умножали на количество плагинов добавляли время на апдейт плагина умножали на количество плагинов сравнивали некоторые вещи фиксили у себя например у нас есть в плагине возможность за дизайне за disabled кнопочку никс визарде покупки сервиса да то есть вы покупаете офису на спрашивает на какой те над вы хотите зарегистрировать эти сервисы и в этот момент по каким-то причинам офис офисные вот плагин чека офисный экран визарда говорит дальше не пройдёшь мы научились обходить их логику и когда все хорошо кнопочка nix зелененькая смысле голубенькая семья можно замкнуть и все про все проходит некоторые вещи типа уникальности идентификаторов к сожалению мы не смогли пофиксить по техническим причинам мальчик ребятам sky ребята вот здесь код был написан не совсем хорошо это правда он был действительно не хорошо написан его нужно написать лучше потому что в противном случае вы работать не будете они исправили эти вещи к счастью таких проблем было немного технический долг возвращаемся снова к нему мы же с него начали до смысле мы поэтому и решили что перепишем потому что он нам не нужен но мы его снова добавили может быть для кого то сюрприз но в новом проекте написанном с нуля за дизайне нам в течение месяца бизнес требования дизайн все по феншую было сделано снова он и я считаю это нормально если правда в этом нет ни большой беды во-первых он помог нам за релизиться во время смысле отсутствие парочки нтн тестов это конечно беда но если мы вы не успели вовремя к нам бы доверие никакого не было и всего переписывание было бы впустую смысле все полгода они бы ушли коту под хвост мы решили что мы будем жить в одном баттлоге технический долг и фичи будут приоритизировать а друг относительно друга каждый раз когда мы хотим определить что мы делаем следующем релизе это немножко сложно но потому что человеку который они технически нужно объяснить почему мы хотим потратить время на написание там тестов например конкретно вот это или для этого модуля или автоматизировать deployment или например написать он стал нашего модуля мы так и не убедили его зачем нам это нужно у нас его нет в смысле наш модуль нельзя снести аккуратно это очень не простой процесс но пока никто не просил все довольны с тем что есть то есть фичи настолько хороши что никто не хочет носить его часть тестов мы сделали в следующем релизе то есть мы пришли к продукту искали суши мы не успеваем проблемы мы не достигли до истины рава ли не до выяснили там что надо было поменять процессе работы поэтому давайте мы делаем так мы сейчас релизимся об этом следующий месяц мы весь видимся раз вместе с мы пишем тесты на канава целый месяц без свечей это плохо ну ладно потому что вы релизе тесь во время и натурально мои в июне отдали релизный build версии 10 11 содержала только баг фиксы и андуин тесты после мы не добавили ни одной фичу него сейчас мы в рамках прототипа делаем фичу которая вообще без тестов смысле мы просто рядом с боку написали кусочек компоненты которые нет тестов мы намеренно не писали юниты и вообще не задумывались о том как писать the mind and st почему потому что мы хотим быстренько сделать парочку экранов отдать их бизнес людям посмотреть она для них подходит или нет решает бизнес сценарии или нет и только после это сказать о кей и тоже подделка хороша настолько хороша что мы хотим иметь ее в продукте и мы хотим для не иметь регрессию чтобы не тестировать его каждый раз руками и прям с этим fine смысле он понимает что если мы за два месяца выкатим поп он взлетит он решает бизнес-задачи мы говорим все ребята паузу перерывчик мы занимаемся тем что гарантируем что каждый следующий релиз это не сломается и это немножко вправляет людям мозги они начинают понимать зачем мы это делаем и зачем нам теста важная часть истории эта команда до которая участвовал во всем этом проекте смысле это к сожалению ну может быть не получается сделать хорошо запланированном по крайней мере у нас не получилось нам пришлось местами совершать подвиги мы помогали юг с дизайнером делать хороший у вас дизайн смысле наш разработчик садился писать экран превью ордера да ну то есть вы набрали заказ там вам показали скидки налоги и цены вы более чем быть их за все это платить все понятно и выяснилось процессе разработки что для некоторых конфигураций это неудобно экран нечитаемый непонятный плохо мы три раза его переделывали потому что команда за будет криво versace давайте сделаем вот так так будет лучше мы решили что мы хотим сделать continuous delivery но смысле правда из продукта который недель удивил релизиться руками мы давайте сделаем по современному 21 век на дворе ну что вы там книжки люди про это пишут мы что не можем можем мы оценили пол человека года нам стоило это упражнение в тех ограничений в которых мы жили я пришел прямо сказал давайте сделаем но ведь нет игры почему он ведь нам не надо нас устраивает release 1 месяц бизнесу быстрее не нужно они не в состоянии переварить новые фичи с большей скоростью и мы пока это не делали то есть мы работали немножко как поэмы ecommerce это такая штука которая очень сильно зависит от продуктового каталога от прайс рейтинга и от ордер менеджмента да то есть для нас три внешние компоненты которые пишут другие команды разработки и мы для них были по сути поэмами то есть мы приходили объясняли им ребята нам нужен такой-то опять которые возвращают какие-то продукты с таким-то смыслом мы его используем в таких-то конфигурациях смысле мы ходили на продакшен вы сняли как там что сконфигурирована чтобы потом объяснить разработчикам в каких условиях могу работать то есть мы были поэмами и в этом смысле тоже та самая я sdk команда из 1 из 1 истории да мы же о том же самом езды кости пишем не очень успевала затем с какой скоростью нам нужно разработки мы построили отдельный процесс разработки то мы делаем виджеты почти готовые для sdk они смотрят в код говоря туру моего к мечам к себе когда они готовы платформы забирать себе в ездока этот виджет они вы забирают у нас и там делают уже более у стандартным документация хорошие юниты большие ты и тестов и вся вот эта история то есть мы немножечко меняли процессы под себя изначально об этом не знали наши intent с ты написано опять же но мы взяли все в платформе поскольку модуль платформе взяли у них sdk с помощью которого пишет с нам пришлось им объяснять какая должна быть у этого архитектура потому что мы отдельные модули релизимся отдельные поэтому те идеи которые не были вначале для нас не работают со всем то есть мы работали не просто формате взял спецификацию написал взлетела было очень много других активностей которые немножко выходили за сколку такой вот очевидной зоны ответственности ими приходилось заниматься чё получили это реальные данные адоб цена денег и заказов между новой системой и общими системами это что этот график означает что ближе какой там седьмому ноября 15 процентов денег проходила через новую систему мы запустились production так что у людей есть старая система рядом новая система и если они хотят они могут пользоваться новые если хотят могут старый мы никого ни каким образом не форсен у них есть возможность именно возможность пользоваться двумя системами 15 процентов денег там в новой системе я считаю это достижение почему потому что это би ту би ecommerce это люди которые зарабатывают деньги с помощью этого инструмента представьте себе у вас неделя до релиза знакомая ситуация правда и тут выходит новая версия вашего любимого еды и вы будете обновляться она другая совсем у нее другой юань она написана других технологиях а совершенно другая кто рискнет 15 процентов рискнули но там он был в смельчак это хорошо а вот то есть я считаю что мы преуспели смысле правда и я почему хотел рассказать вам эту историю потому что в мире бытует мнение что переписывать нельзя это плохо ужасно на самом деле можно если вы хорошо понимаете что это такое и чем это будет стоить зачем вы это делаете а то есть мы переписали софт который про деньги который в продакшене которые про отношения между бизнесом и бизнеса да ну то есть с точки зрения человека который мы просто так пытается понять что это такое да это прям такой вот крава веньки enterprise мы взяли пришли систему и переделали и с нуля ничего ни одной строчки кода не сохранено не тестов не документации не сценариев смысле просите сценарии то конечно все сохранились как раз наоборот бддс них сценариев то есть все полностью написана с нуля она работает в нем более удобный интерфейс она работает быстрее она решает задачу лучше для потребителя если подводить некоторые самаре дай начинать закругляться то мне кажется что наиболее разумным подходом было бы следующая история если вы хотите что-то поменять техническим долгом которого съесть это понять какую бизнес задачу вы хотите таким образом решить понять как вы хотите мерить то что вы решаете какой вас прогресс есть там нету его работает ваше предложение или нет вперед всего научиться не ухудшать ситуацию это очень важный шаг и некоторые люди его почему-то иногда пропускают если вы можете делать не хуже вы уже наполовину преуспели потом осталось только делать лучше и все это дело повторяют до тех пор пока вы решите что уроки смысле все проблема которую вы решали изначально теперь больше не проблема или это не та проблема которую хочется решать ну и закончить мне хотелось бы вот этой вот идеей что управляете своим долгом осознанно решайте сами что зачем и почему вы делаете должны быть микрофоны для вопросов у нас есть наверное минут 15 если не получится то потом можно будет обсудить рядышком спасибо за доклад я здесь я здесь проверили а до я вижу а я правильно понимаю что и новой старой системы это монолитное приложения она достаточно маленькая для того чтобы пилить и на микро сервис своей вот тот самый бог который спросите пруфов концепт компоненты которые мы пишем без юнитов это кандидат на то чтобы отщепить ее в соседней компонент но пока мы не знаем хотим мы devil опять или нет она рядышком с нами как только она станет достаточно понятна и большой мы ее отнесем а вы не рассматривали вариант того чтобы вот выделять какой-то бандит контекст ну из монолита и оптимизировать и рефакторинг же конкретно вот этот bound контекст отдельно от всего остального тот зависит от того что она личная разработка взять и существующие компоненты какой-то кусочек и его переписать возможно микро сервисе возможно в отдельной библиотеки ну то есть как бы но мы занимаемся именно этим то есть если мы оптимизируем какой-то старый кот мы ни в коем случае не переписываем еще с нуля мы просто параллельно начинаем делать ну похожий на старый проект который выполняет те же бизнес-задачи но написано уже ну с нуля с июня тестами с интеграционными теста не прочь в моей практике у нас были такие подходы то есть мы меняли на например под систему unit тестов sdk мы заменили полностью да то есть мы не переписали весь фреймворк мы переписали только тестовый кусочек конкретно в этом случае такой вариант мы не оценивали наверное потому что мы на самом деле мы когда рефакторинг эту штуку в течение года мы некоторые вещи внутри таким образом изменяли то есть мы код который занимался ордер flow из нашего кассационного перевели на некоторую стандартную библиотеку я просто хотел показать что подход под названием перепишем да он уместен не только в чем-то таком очень маленьком но иногда бывают такие состояния продуктов проектов или бизнес-задач что это уместно для всего продукта или компоненты большую информационной системы да то есть то что то что нужно переписывать усилиями 15 человек в течение шести месяцев привет спасибо за доклад у меня на самом деле два вопроса один выходит из другого вот вы говорили о том что были такие моменты когда вы говорили что мы вот месяц или два месяца решаем проблемы технического долго а потом беремся за блокеры и фичи собственно вот мой вопрос как у вас получалось укладываться с срок вот в этом месяце не происходило ли так что ближе к третьим дерево решаю что вам нужно полтора месяца два месяца какой вот бизнес-шоу на эти уступки с точки зрения проджект-менеджмента у нас не меняются даты в смысле это наша договоренность это бизнес-решение мы 1 месяц выкатываем то что можем выкатить обычно за месяц мы что-то можем улучшить мы не очень можем менять ресурсы за ну то есть у нас есть команда мы не умеем там за аутсорсинг для пятерых человек работу внезапно поэтому мы работаем только со scope'ом релиз когда мы подъехали тесты мы съели столько тестов сколько смогли то есть мы фиксили блоки рн и и баги это всегда приоритет номер 0 но потому что что-то встало мы не можем с этим мы не можем это отложить это нужно срочно следующем мы ели school party рацион состоял из тестов да некоторые тесты мы недооценили некоторые переоценили и но наверное процентов на 70 80 того что мы хотели мы съели оставшуюся часть мы положили в backlog и когда начали планировать следующую итерацию решили как бы что пока эту штуку мы не будем брать то есть мы оставили ее новые фичи по про их будем делать с тестами то есть мы постараемся не увеличивать долг но оставил плоском спасибо и второй вопрос насколько команда сама по себе была опытная какой процент сеньоров потому что кажется что если слишком много то рефакторинг им сложно заниматься junior of работающих на 3 факторингом у нас не было средний возраст больше 10 лет опыта разработки то есть супер опытную команду из и new да у нас прям несколько человек прям прям монстр и смысле это люди которые там с прошлого тысячелетия промышленно разрабатывают софт и они нам очень помогли конечно то есть мысли без этих людей это было бы невозможно мы вам спасибо можете спросить я повторю вопрос скажите пожалуйста на ваш взгляд юнит-тесты они вообще работают потому что по моей практике у нас много unit тестов они требуют поддержки ломают бьют но по моему за последний год нам практически ничего не было были в вашем опыте это реальный нашем опыте вот первая история она была как раз в районе тесты и про изменение количества блоки рных багов продукте у нас чёткая корреляция там была полна процентов 15-30 было 20 больше блокеров в неделю мы довели до 70 в среднем по моему процентов к врачу за полгода и стала между пятью и десятью как именно юнит не intent и к сожалению мы для sdk intent не писали потому что но это немножко невозможно и это блокеры именно sdk то есть мы ломали backward compatibility опять fma ломали поведение виджетов для нас это работало сказать так что я точно уверен смысле на руках есть какая-то статистика что юниты помогают всегда это я к сожалению могу спасибо возможно вам нужно с юнитами что-то сделать возможно у вас сам инструментарий не подходит под те задачи которые вы решаете то есть тут я к сожалению могу так сходов что-то порекомендовать кроме того что вы опять же возвращаясь вот когда история вы пытаетесь понять какую бизнес-проблему вы хотите решить если вы хотите ее решить до в чем вы хотите умерить ложное срабатывание юнитов или что то еще то есть вот как то так я бы подумал об этом до большое спасибо вам за доклад меня зовут юрий мне хотелось бы узнать что помогло вам решить такую героическую задача не использовать не фрагмент ни одного фрагмента кода из старой реализации все переписать полностью с нуля это высочайший уровень владения кодом всей командой либо аналитика высочайшего класса что у все знают требований все знают полностью доскональной бизнес-логику реализованы старой системе у нас во первых были очень опытные толку он почему были они все еще есть опытные толковые ребята и со стороны разработки со стороны pm а мы очень много потратили усилий на то чтобы разобраться в том какие бизнес требования мы хотим закрыть то есть что для кого мы делаем и у нас был опыт работы с пользователями и сценариями тех то система которую мы переписывались мы знали из чего во что мы хотим перейти получается что команда была долгая команда доработал обезопасить обычный старых системах часто меняются это в команды мы работали над этим проектом с августа 16 года полгода мы отбор делись в эту разработку год мы отвечали за этот продукт целиком и полностью в декабре прошлого года то есть чуть чуть меньше года назад мы решили что мы ее перепишем то есть у нас был опыт между годом и полутора год полтора года опыта год ответственного опыта я бы так сказал понял спасибо большое спасибо за доклад мне хотелось бы услышать ваше мнение насчет двух вопросов есть мнение что антоним технического долго это чистый код и вы согласны с этим антоним технического долго это чистый код так в том то и дело что технически долг это не только про код это про вещи которые рядом с кодом это про вашу документацию это про ваш дипломанты автоматизацию deployment мое мнение да то есть я к этой к этому вот всему отношу эти вещи то есть это не всегда продуктовый код надеюсь я прояснил хорошо спасибо и второй вопрос кто виноват в накоплении технического долго я бы сказал оптимизм большинство людей с которыми мне приходилось работать и как со стороны produce менеджеров из дизайнеров разработчиков и тестеров бизнес людей люди обычно оптимистичны в том какой объем работы нужно сделать и насколько сколько нужно по на это потратить усилий и обычно в процессе работы всегда объём растёт и соответственно вам приходится решать вы готовы накапливать технический долг или вы готовы двигаться датами или бизнес-задачами то есть вам приходится решать насколько мы живем в реальном мире дешево бесплатно смысле дешево быстро и качественно не бывает приходится иногда жертвовать вот этим самым технически многом пока мы разрабатывали первую версию мой вверх наша на самом деле де накапливание только технический долг на некоторый бизнес в течение наиболее потому что он просто не успевали магами это не успеваем и они уезжали ниже в backlog следующие релизы то есть мы накапливали и то и другое одновременно отсутствие что для меня технический долго это не какое-то абстрактное зло с которым нужно всенепременно бороться и искать ну как бы с которым жить невозможно это некоторый набор а этому в баттлоге у вас который вам как техническому человеку стоит чего-то смысле вам нужно тратить ресурсы на поддержку пока вы не решили эту задачу вы тратите какие-то деньги но бизнес вещи с этой точки зрения ничем не отличается пока у вас сайтами в баттлоге они на продакшене бизнес не зарабатывает деньги то есть компания опять же их теряет это вещи с моей точки зрения они приблизительно одинаковые источник разной вы как технический человек знаете что можно изменить внутри под капотом чтобы оно работало лучше и вы приносите так как технически долго backlog бизнес люди знают что нужно добавить продукт как сценарий чтобы в нем было больше денег можно пояснить получается технический долг и новые фичи это очень схожи ведь дармы поэтому и положили их в один backlog то есть мы мы научились разговаривать с премом на таком языке что мы можем сравнить добавить новый wizard или написать тест iq старому и он понимает что если мы не напишем тесты у нас есть риск что мы все сломаем и потратим время на ресурсы есть риск он знает что если мы хорошо не разберем и не покроем юнитами test the corner кейсы мы может быть не выясним пока об этом не узнает клиент это все еще для него риски и он понимает немножко их природы и этого достаточно чтобы он взвешивал что против чего он хочет взять в ближайшую итерацию это его зона ответственности не наша спасибо спасибо"
}