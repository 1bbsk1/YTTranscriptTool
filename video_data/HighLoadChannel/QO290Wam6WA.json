{
  "video_id": "QO290Wam6WA",
  "channel": "HighLoadChannel",
  "title": "th2 — cистема с открытым исходным кодом для функционального тестирования / Наталья Крюкова",
  "views": 1032,
  "duration": 2805,
  "published": "2021-10-04T02:47:14-07:00",
  "text": "меня зовут наталья крюкова я работаю в компании сокотра и вот уже больше 10 лет и за кто занимается тестированием сложных систем в основном в сфере финансового сектора компания эффект про дан момент состоит из больше чем 6 100 специалистов и мы имеем несколько офисов по россии а также в грузии в америке и в англии наши клиенты это бирже и поставить системы по всему миру от токио dance on пола от йоханнесбурга до осла и наши клиенты в число наших клиентов также входит более 20 по бир из более половины бирж из топ-20 кроме тестирования мы также занимаемся разработкой программного обеспечения за водкой если бы точнее тестовых tool of test of the love которые мы используем в нашем внутреннем тестирование то есть они используются нашими специалистами и также используется на стороне клиента 1с тулов наших новых тулов которые мы на данный момент разрабатываем а также который мы выложили в прошлом году в открытый доступ на git хоп базовую часть этого разоблачать платформы называется мечту и я сегодня хотел рассказать про данный tool про то как мы и почему мы и решили его разрабатывать птичку это гринборд который предназначен для тестирования комплексно финансовых систем в первую очередь нтн тестирование ты что поддерживает разнообразные протокол уже сейчас а также мы планируем в будущем добавлять новые протоколы кроме того утечку в широкие возможности для интеграции с test management система- мисс де факто таким системами системами дата анализа мы также вы полностью готовы к тому чтобы быть развернуты в облаках не только на железе кроме того птичку из возможность автоматизации но в первую очередь именно как часть in the end сценариев без фокуса непосредственно на тестирование ей то есть почему почему мы решили что нам необходимо разрабатывать тестовый толк в первую очередь конечно это исходит от особенностей финансовых систем и также от некоторых limitation of в тестовых а прочих которые были нами замечены в процессе работы об этом мы поговорим в первой части так вода также я бы хотела рассказать поподробнее что есть принц птичку и почему мы считаем что что конкретно мы подразумеваем под мечту и под парадигмой тестирования в функциональный социального те стены под нагрузкой и так же мы поговорим про архитектуру и что пропал каким образом мы и его создали на базе чего данный момент базируется наша технология и также провести использования почему наверное многие знают что особенности финансовой системы в первую очередь одной из особенностей является ее сложность это комплексная система которая состоит из многих компонентов и каждый из этих компонентов он обладает своей собственной логикой и как правило лайкой достаточно комплексный сложный для того чтобы протестировать подобную систему требуется написание большой тесто в библиотеке и выполнение большого количества тестов с другой стороны еще одной особенностью финансовой системы является тот является достаточно высокие требования по доступности и по поддерживаемый нагрузки по нагрузке которые должны поддерживать система для того чтобы обеспечивать свою работу и как видно на этом слайде количество данных как известно она увеличивается из года в год и даже сейчас можно увидеть что уже через три года планируются двукратные даже трехкратное увеличение данных которые будут проходить через биржу количество trade валим который будет на бирже и это означает это означает что эти регламенты они будут все больше и больше ужесточаться каким же образом мы тестируем этим системы таким образом в принципе обычно тестирую такие системы в первую очередь это стандартные концепция когда мы разделяем тестирование финансовой логике функциональное тестирование и тестирование не функционально и если мы будем про специальное тестирование то например один из наших слов который называется sunfish он мы используем для функциональной его тестирование и он представляет из себя ту который общается с всеми компонентами системы на бирже и пользователь кей который пишет тесты он должен внутри своего теста ван бо иван написать все степа то есть например мы хотим проверить ты space в котором посылается ордер на биржу бирже возвращает нам какой-то фидбэк по 13 и также возвращает некоторые ответ по марке то типа drop копи по любому другому протоколу и например также мы хотим проверить все ли хорошо у нас в базе данных которая также подключено допустим возможно это какой-то построить базы данных которые reporting база данных которые тоже связаны в единую комплексную систему нашего приложения финансово приложения и пользователь должен прописать в нба иван сеть из россии эти шаги и также прописать 100 твиттере завод как правило если мы говорим что в принципе система сложная то есть количество тестов которые необходимо будет большое то ясно мы понимаем что илюша методика тоже будет большая и написать в принципе мы ее можем поскольку у нас есть чудесные сцены специалисты которые разбираются бизнес-логике и умеет писать тесты но если мы встаем в точку когда нам необходимо эту библиотеку поддерживать мы сталкиваемся с проблемой поскольку количество тестов очень большое если мы вынуждены менять вашу библиотеку обновлять ее под новые требования или для новой функциональности то количество времени которые задач и задач на на этот обновление она стремится к бесконечности можно стремиться к бесконечности и безусловно сильно увеличивает тестовый цикл если мы говорим про не функциональные требования то соответственно здесь также у нас в том числе нашей компании есть ряд тулов которые мы используем и проводим тестирование отказоустойчивостью и perfomance test и тест с связанные с нагруженность you но в любом случае как правило такие тесты они фокусируются именно на стабильной системы на и и отказоустойчивость и это значит что мы подаем какой-то значительную нагрузку которую с целью проверить и быть уже ты делась биржа или не выдержат и в этих тестах как правило мы упускаем что пускаем не обращаем внимание на функциональные моменты которые возникают под достаточно высокой нагрузкой на все таки не такой убойной чтобы прекрасная бежа разломилось на несколько кусочков и в принципе мы этими двумя подходами можно найти достаточное количество багов мы можно подойти руси тема функциональный не функциональном эти подходы они рабочие но например если у нас мы будем про потенциальные еще про баги который связан например с далеками в системе и например с троллингом или например с неправильным бочонком когда из-за высокой нагрузки происходит сбой в системе и в принципе с точки зрения ее отказоустойчивости все происходит так как нужно но при этом часть допустим транзакции она теряется либо например происходит сбой в матче не джинни и какой-то треть происходит неправильно и такого рода баки нам скорее всего не получится идентифицировать с помощью только функционального и только не функционального тестирования из выше обозначенных причин и тут встает вопрос ну собственно это же в принципе случается не так часто возможно есть вариант подождать до продакшена оставить всё как есть когда нибудь там через какое-то качество временем этот вопрос произведет со мы его увидим проанализируем пофиксим и всем будет счастье но как в жизнь показывает практика такая она достаточно печально и не не приносит хороших результатов поскольку он например один из известных случаев когда фейсбук выходил на api и из-за высокого количества транзакций цен акций которые об этот момент были сгенерировали на бирже произошел сбой который привел к тому что книжка была закрашена и не такие заявки которые приходили на биржу они не обрабатывались такая ситуация существовала в течение нескольких нескольких минут они получатся но более того даже после того как проблема была разрешена за время когда произошел этот сбой накопилось достаточно большое количество транзакций в очереди которые потом еще около несколько часов обрабатывались и по сути биржа была неработоспособна течение около трех часов или относительно работоспособна это ситуация она привела к многомиллионным потерям как соответственно участников рынка это динка которые хотели поучаствовать выходить из бука на пер а также большим штрафом а для биржи и мы не соответственно подумали мы не только тогда подумали принципе мы эту проблему решаем в течение всего времени работы полинг зад прав но в принципе в любом случае здесь получается что у нас есть национальности дни функция тестирования а не существует отдельно центр притяжения багов находится в двух точках а посередине создается область abs это не покрыта никакими тестами тогда собственно логичным является момент что есть необходимость в туле который будет не только тестировать функциональные не функциональны но сможет под не убойной нагрузкой идентифицировать какую-то функциональную проблему из может одновременно работать и сознания тест мне функциональными из тем что и лежит на середине таким образом мы ближе к выводу что нам нужно сделать тестовый tool который бы отвечал некоторым особенно важным знаешь точки зрения характеристикам первую очередь это модульность кроме того нам была необходима гибкость конфигурации возможность дата анализа и также ряд характеристи таких как устойчивость масштабируемость и вариативность тогда мы стали думать что же нам необходимо каким образом нам нужно реализовать tool чтобы она для удовлетворял этим требованиям и конечно когда мы стали думать про модульность и гибкость конфигурации мы пришли к решению что нам нужно уходить от монолита и приходить к некой ника сервисных и текстуре где у нас была бы какой-то сайт компонентов каждый из которых выполнял свою выделенную роль но при этом они организовывали эту систему к систему складывались на кен varmint который дальнейшем можно было использовать ее специалисту для тестирования и мы приняли решение что это будет обернитесь носят модульности нам было так же важно не только разделить это все по каким-то сервисом далее мы их называем сервисы компоненты коробочке а дальше возможно буду падать все эти термины но и выделить несколько функциональных слоев которые в которые мы могли бы объединить наши сервисы в первую очередь это конечно core компоненты они на слайде отмечены синим цветом внизу и это компоненты которые ответственны за обработку данных за их сохранения и за за последующие предоставление этих данных конечному пользователю корку паненки на данный момент выложены в open source они доступны и на базе этих компонентов а также некоторых темплейт of для кастомных компонентов мы данный момент строим наше solution varmint и для разных бирж и интегрируем мечту в наши текущие проекты кроме core части также присутствуют часть соответственно и за взаимодействие тич туса клиентской системой опять же это сет компонентов которые могут взаимодействовать как по с 1 гид в яме могут заманить с базами данных могут загружать данные например из пикапов из файлов raw data то есть вся информация которая не обычно необходимо для проведения тестирования которые актуальны для финансового сектора еще один слой это слой основных компонентов и так оппоненты нацеленные на а специфическую кастомную логику возможно чаще всего уникальную для конкретного проекта и весь может быть достаточно большая вариативность это могут быть компоненты которые отправляют сообщения в клиентскую систему могут быть компоненты которые симулируют активность либо например осуществляет некую верификацию сложную верификацию просторе консервацию lps верификацию и так далее и так же еще один слой и the data service in da момент мы занимаемся их разработкой и еще один слой который тоже достаточно важен и он напрямую связан с нашим следующим требованием а именно с гибкостью конфигурации а именно слой инфраструктуры это то что позволяет компонентом взаимодействует друг с другом эффективно и позволяет формировать январе менты множество январе мента в зависимости от тех рекламе тов которые у нас имеются конечно это не только связи между компонентами как на этом слайде но еще и но еще и сори escudo но во многом и взаимодействие этих компонентов 2 со внешним миром взаимодействия со клиентской системой а также поддержка source кода который из которого состоят эти компоненты и взаимодействие informed of который мы будем строить на базе компонентов между собой для этого мы все вот с компоненты которые были на предыдущих слайдах добавляем создаем на базе них namespace вы вернетесь и и он является нашим тестовым бармен там данный доступен момент его конфигурация она задается в конфиг файлов которые доступны в ките и которые могут быть изменены любым пользователям также в пятен сохраняются и хранятся source code кас иных компонентов и сами тесты непосредственно для того чтобы с помощью youtube со прочее сядь и сиди организовать тепло и и развертывание компонентов в тестовых informed of так я ранее говорила мы также должны легко or часть титул open source и поэтому все что связано с компонентами он хранится и на данный момент на гитхабе и собирается в open source репозитории докер имиджа в том числе там хранятся но как я говорила нам важно иметь ни один парламентом важно чтобы этих обормотов было много поскольку поскольку существует вариативность конфигурации которые нам нужно тестировать и поэтому мы создали дополнительные компоненты которые позволяют пользователю даже пользователю песни солисту без глубокого дома с experience а менеджеры систему январь менты самостоятельно иметь возможность создавать новые январе менты создавать новые компоненты перекат фигурировать их менять data flow и эти компоненты они указаны здесь на огненные в золотую рамочку и называется интер менеджер info оператор этот интерн слой он базируется на холм операторе и далее мы чуть поподробнее про него поговорим то есть данном случае у нас есть пофигу рация конфигурация в гите на слайде это нижняя левая область system configuration r1 и r2 info нквд сонная схема которая представляет из себя множество все раса красным resources кабинете со в я вам формате они описывают птичку коробочки их параметры включая лимиты для каждой коробочке определенные характеристики и так далее у нас также есть информер джер компонент который отвечают за развертывание конфигурационных схем из git репозитория в кубе рн и отец и он мониторит изменения в текстуре по x' и тория и deployed в случае каких-то изменений компоненты в кабинете и также инфра оператор который является кастомизированные мире мин тации каберне this кастрюлю sources основу безумная надави таким образом интер менеджер мониторит схему в git репозиторий любые изменения которые там происходят далее он загружает случаев появление этих изменений он загружает последней версии в копны отец и инфо оператор мониторит идти штука ставлю sources и дальше создаёт из них homebrew лиц который дальнейшем ком оператор тепло от в купер notice таким образом мы освобождаемся от достаточно большого количества степов которые ранее были нам необходимо для того чтобы работать с января ментам то есть если например раньше без этой inwin структурной схемы мы должны были для того чтобы пользователь мог работать с бармен там почту предоставить право пользователю доставить права в кластер в рыбе тымкив кассандру что уже рождает дополнительные может ожидать дополнительные проблемы может служить источником опасности также создать namespace секса за секреты сервисы дипломаты в общем длинный список для того чтобы получить долгожданное отличный бармен здесь что инфра единственный должен сделать пользователи это пойти в git создать там отдельный прочь с дипой туда свои ciare компоненты в свои красным ресурсы для своего анвар мента и далее случится нечто информация которая сзади floyd все эти компоненты внутри кабины tissot более того мы также разрабатываем отдельное приложение которое даже избавляет пользователя от необходимости пообщаться с китом то здесь например пользователи не хочет даже не хочет работать с китом либо не имеет такой возможности по разного рода причинам то есть вариант открытия в бою она потом просто в графическом интерфейсе параметры коробочек которые нужны и с линковать сделать создать data flow и опять же после нажатия кнопки корейцы зайдет магия in varmint будет создан следующий следующий случай особенность которая была важна для нас при создании те что это возможность дата анализа и того чтобы дата анализ проводить полный анализ нам необходимо сохранить как можно больше информации как только это возможно поэтому мы хотели добавить мы хотели чтобы вся все данные которые приходят с клиентских систем они сохраняясь в базу а также все данные которые мы посылаем в клиентскую систему и данные которые генерируются внутри и this stuff то есть те студенты от коробочек или сервисов которые появляются в результате работы таким образом сохранив все эти данные данные мы храним в формате мы предоставляем возможность интеграции наши базы данных с этими даты сервисами посредством ти что api и можно поскольку мы уверены что данные не кодированные не декодирование что они точно в том виде в котором они пришли к нам с клиентской системы мы можем на них надеяться и на основе них строить разнообразные статистические характеристики проводить анализ а подключать машину но нет модули и так далее следующая особенность которая у нас нам было важно это возможность создания ленгвич агностик тула который не диктует пояса заселим в к на каком языке писать свои кастом компоненты в данном случае у нас код написан в основном на джаве компоненты которые которые общаются со сторонними системами они написаны на поэта не на java на кон на небольшая часть на си плюс плюс и к сан и компоненты сейчас основном написаны на потанина java но в принципе мы можем подключить любой язык который поддерживает герпесе потому что поскольку тесты связаны с нашими коробочками с помощью герпесе также нам важной в фильтрах приложениях важно еще одной особенностью является тот факт что есть большое количество так олоф финансовых и да каждый два протокола как правило необходимо создавать отдельные connect и отдельные компоненты для кодирования и декодирования этих сообщений и опять же нам необходимо для того чтобы поддержать эту модульность и для того чтобы поддержать разнообразие нам необходимо во-первых разделить их а во-вторых иметь какой-то свет этих компонентов когда мы их деле мы делим их на два слоем первое это непосредственно к моменты которые взаимодействуют системой и второй слой это компоненты которые занимаются кодирование и декодирование разделяя таким образом мы также уверены что все данные которые попадут в базу они будут в первозданном виде поскольку мы их не а декодировали и никакие баги которые возможно присутствуют в кодеках они не повлияли на то что мы сохранили в базе это также важно поскольку мы позиционируем в данном случае кода компоненты как эти компоненты которые также могут быть написаны пользователями и если что-то пишется большим количеством людей то естественно возникает большая серьезная опасность дополнительных ошибок и чтобы этого избежать и таким и таким образом делим этот слой на 2 части также еще одним примером еще одним примером разнообразия является юз кейс диск кейс с тестированием например блокчейн систем например 3corda почему почему это важно почему нам в этом случае будет полезен тич ту в ялте приложениях sense ачивку арт-р 3 каждый узел сети может использовать свою версию тебе можно использовать свою версию базы и о своей версию корды и также имеет свой собственный набор настроек это фигура ции и нам о таким образом необходимый инструмент который сможет перебирать большое количество вариантов всех этих конфигурации и разных версий разных компонентов и пропускать поток транзакций под нагрузкой для различных конфигураций также одна из характеристик которая важно важно нам тестер мне наш в создании нашего тестового тула а также в принципе для тестовых и других систем это обеспечение устойчивости поскольку мы строим январе менты с многими состоящий из многих компонентов и поскольку опять же мы делегируем часть описание часть этих campo частях части этих компонентов не только development отделу но и кей то мы должны быть уверены что в случае если будет за тепло им какой-то кусок кода который не работает либо какой-то компонент который содержит себе ошибку это не повлечет значительных проблем в январе менти это не положит его и не потребует дополнительного многочасового и нас тегирования вмешательства devops отдела в данном случае мы на данном слайде мы видим что у нас есть компонент кодек которое ответственно за декодирование и например если он тебя какие-то перепевают какие-то изменения и проблемы это не мешает не ломает con компоненты can activity компоненты которые взаимодействий непосредственно с системой а также все компоненты связаны с дефекацией они также остаются живыми это значит что когда как только кода снова заживешь полной жизни будет здоров и счастлив мы автоматически получим рабочую систему опять и нам не нужно будет добавлять ваше качество работы связана с при конфигурированием и поддержанием бармен то данная система нам нас получилось реализовать благодаря естественно acs бурно тельцу который поддерживает кто предоставляет возможности устойчивости и также рыбе think you по которому у нас происходит взаимодействие между компонентами и один из последних опций последних параметров которые важны для нас это возможность масштабирования в данном случае опять же благодаря возможностям купить матисса и нашей архитектуре мы можем создавать несколько реплик и компонентов например если у нас идет поток данных от клиентской системы через и старым столь же компоненты которые ответственны за про затем данных и сохраняется это все в базе если мы например подаем большую нагрузку и видим что наши компоненты связанные с хранением данных не справляются мы можем поставить ни один restore a поставить их 11 и в соответствии с этим перенаправить потоки таким образом существенно увеличить пропускную способность наша система в целом таким образом мы создали систему которая во первых удовлетворяет придерживается ломает парадигму функционального и не функционального тестирования как отдельных сегментов поддерживает позволяет тестировать финансовое предложение функциональную логику под нагрузкой и представляет возможности связанные с дата анализом с масштабированием и устойчивостью в процессе работы над этим над нашим телам мы встретили разные затруднение и вынесли некоторые уроки часть из них возможно кому-то покажется очевидными часть из них возможно кому то будет полезно в кратце если гарри вкратце то если вы публикуете получаете сообщение в рамках одного приложения то лучше использовать разные connection и в противном случае сервис будет полностью привязаны будет превышена topmark также также мы столкнулись с не данной проблемой связаны с тем что поскольку наши компоненты выложены вот он source и публикация ведется велась на бен три наверное все знают что в недавно времени с этим возникли сложности поэтому такие риски тоже нужно учитывать и продумывать заранее того чтобы поддержать с устойчивость приложений которые выложены в open source все эти моменты которые здесь указаны и принципе мы рады обсудить либо в секции вопросов либо на нашем стенде вместе с одной командой которая сейчас тоже на холоде спасибо шаю вырез менты наталья закончила а готовьте вопрос у нас есть вами буквально минут 5 чтобы задавать вопросы зала так друзьях и оперы пожалуйста подвигайте те к тем кто поднимает руки сейчас по задаем буквально два три вопроса от h тебе от нас подарок других за сокращая венцы держи можешь пока поставить вот сюда вниз красиво и так если кто-то готов задать вопрос в первом ряду так наталья спасибо за доклад в своем докладе уговорили мы что ваше приложение нацелена на тестирование вот именно бизнес приложение торгов приложения в чем специфика вот как это вот это вот направления до чем это отличается тестирование обычных api там это первый вопрос и 2 вопроса насколько вы оцениваете порог входа в ваше приложение то есть насколько она готова к тому чтобы обычный человек взял склонировать гитхаба репозиторий поставил себе ваш приложение попробовать протестировать что-то свое и спасибо начинается второго вопроса мы на данный момент в пикапе у нас выложена весь хор и часть template компонентов для практически всех остальных сервисов и также у нас присутствует какой-то часть инструкции для того чтобы пользователь мог установить и что и также создать свои компоненты на основе кастомных этих template of поскольку также у нас есть инфраструктура которая сказала до этого который как раз позволяет сделать достаточно низким порог входа и позволяет специалистам либо другим специалистам которые не обладают каким-то очень углубленным опытом в депо постель одевал мантии в принципе реализовать на основе чту свой solution что в целом мы достаточно готовы но естественно и ничто не мешает нам совершенствуется что мы продолжаем делать постоянно насчет первого вопроса если можно конец повторить высказал вот эти пожалуйста в принципе эти что он нацелен на тестирование на комплексное тестирование сложных систем на нтн тестирование мы так компания специализируется на финансовых приложениях и у нас в час из ну может быть из коробки есть ряд компонентов которые наиболее подходят именно для финансового сектора в том числе например фикса вы и протоколы и другие протоколы и рейтинговые и конечно для них но в целом поскольку у нас также есть и модули взаимодействие например the rest api посетите по id мы также можем добавлять другие протоколы чисто теоретически мы можем кодировать мечту и под другие другие приложения не только финансового сектора но мы в принципе базируемся пока что в принципе мы не пока что мы базируемся на финансовом секторе так еще один вопросик давайте и наверное будем просто темноту ли вопрос следующую проверки безопасности у вас как-то отдельно проходит игра не интегрированное приложение вы имеете виду может единичную осуществлять проверки безопасности а поверьте безопасности в принципе это не та же чем мы надо но я занимаемся поэтому в целом сейчас из коробки скорее нет так очень короткий был ответ можно еще один вопросик задать есть желающие онлайн кто-нибудь у нас хочет никого видимо да так а вопрос появился все ты будешь крайним спасибо за доклад вопрос такой вот как я понял но с помощью те и что можно протестировать например ну вот такой кейс приложение которое так или иначе взаимодействуют с биржи вот market дату откуда берет то есть ее надо как-то замок и то есть в определенном формате вам предоставить я чувствую или как нет о чем он нам в принципе если в какой-то ваш кейс предполагает необходимость стимуляции марки даты то есть у вас нет потока который должен может прийти в было те что-то в этом случае что представляет возможности симуляции это отдельный компонент он так и называется сидеть и в него можно ну как бы the core компоненты на основании него можно сделать дополнительный костюм компонент со специфической бизнес логикой под ту марки дату которая нужна вам для вашего случая если же мы говорим о том что все таки у вас есть доступ к марке дат на маге твоим и вы можете к нему подключиться то тогда для этого у нас существует соответственно connect и это компоненты которые могут подключиться к этому трафику марки дата трафику по разнообразным протоколом по в плечу по фасту и соответственно эти данные тоже загрузить систему где эти где их потом можно будет сравнить обработать страниц ордер n2 например если это нужно сделать какую-то агрегацию лба из чек и так далее ну то есть по факту у по сути симулировать работу бирже если мне нужно нам можете не слышать и там спасибо"
}