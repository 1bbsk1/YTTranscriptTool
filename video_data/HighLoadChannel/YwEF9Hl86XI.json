{
  "video_id": "YwEF9Hl86XI",
  "channel": "HighLoadChannel",
  "title": "Bare metal K8s, или Туда и обратно. История Quadcode / Илья Устинов (Quadcode)",
  "views": 183,
  "duration": 2450,
  "published": "2023-10-06T07:20:35-07:00",
  "text": "Всем привет Меня зовут Устинов Илья компания кваткрот команда cubernets platform рад вас приветствовать на нашем докладе барметал квс или туда и обратно коротко про компанию мы финтехкомпания занимаемся тем что создаем по для торговой инвестиционной индустрии про нашу команду нас 7 человек называемся мы кубернатис платформу занимаемся тем что внедряем сопровождаем все процессы вокруг кубертиса в компании всего за пять лет в нашей компании Прошло где-то около 17 человек все из них на слайде все прекрасные инженеры когда-либо увидите передавайте привет от меня жмите руки чтобы в докладе Я хочу рассказать про нашу перспективу жизни время толкластера как докатиться до 4 часов при скеле 1 ноты как сократить это время до трех минут если вы уже докатились и как кластеры и что можно перенять к себе про наших кластера коротко коротко у нас три кластера в трех окружениях припрут инфрат предпрот используется для statles приложение компаний info используется для коротко живущих приложений такие как Get laprunner и jenkins Runner и браузерные тесты либо что-то еще самый большой провод 97 нот каждая но до 40 ядер CPU 256 гигов памяти info и самый маленький и переходя к интересной части хочется начать с того чтобы прыгнуть в машину времени вернуться во времена до 2017 года посмотреть что вообще было до того как умер появился в компании был Монолит который пилился на микросервисы микросервисы в свое время жили в LX контейнерах которые были нарезаны антиблометеле выдавался и выдается в команду эксплуатации по процессу когда команда эксплуатации зашла на нашу формочку заказа серверов накликала желаемую конфигурацию сервера после этого Нажала Отправить письмо автоматически ушло в датчик датчик отдал в промежуточную команду эксплуатации сервер произошла первоначальная настройка которая должна быть одинаковая на всех кампании после этого передался в команду опсов которая запрашивала для донастройки под куберк CF базу данных что-то ещё докер и только тогда нас начинают завоевывать мы пишем свою тестовую платформу которая позволяет в digita лошади на Виртуальные машинки поднять микросервис запакованный в докер контейнер и все его зависимости Или от кого Он зависим поднять на этой машине и отдать айпишник разработчику пустить его на тестовую сборку и безопасно дать разрабатывать В итоге у нас что есть модное желание переехать на микросервисы и очень много разного runtime для наших микросервисов где-то от LX где-то просто берметалл в тесте докер контейнеры и нам нравится как докер контейнеры себя показывают в качестве runtime Мы хотим их в качестве общего runtime для всех микросервисов и понимаем что мало просто так взять и запустить докер контейнеры где-нибудь в Облаке Или например металл их надо регистрировать чтобы было меньше ручной работы не было бы этого доклада если бы выбор не пал натис мы выбрали cubernetis и стали без какой-либо экспертизы глубокой в Облаке и в клубе в том числе решать какой кубер мы хотим либо совхоз либо облака до 2017 года можно было сказать что в принципе для нас мы можем потрогать мы знаем что это здесь за сервера как они выдаются где они стоят что это за железо плюс это будет нашим датике в наших стойках и требования безопасности и бизнеса в связи с тем что мы все-таки финтехкомпания по единому сетевому периметру и низкой латвинции будут удовлетворено облако в свою очередь мы можем сказать что нельзя потрогать с одной стороны хорошо с другой стороны с одной стороны плохо с другой хорошо по той причине что если в стойке упадет питание то носиться с красными глазами будем точно не мы на тот момент ходят слухи что управляет облаком проще Но они в основном маркетинговые мы не можем найти большого xperience в сообществе И тем более на нагруженных проектах И относительно сетевого периметра и латенсии надо идти к нокам надо определять что это вообще за низкий латент ставить им задачи на гибридную инфраструктуру уже датчика с облаком задача стоит донести оркестратор в компанию быстро по стоимости Сюрпризов не будет железо даже арендовать дешевле где-то на 20 тысяч евро в год на каждые пять нот в нашем случае можно сказать что это зарплата не самого лучшего девопса но очевидно что кроме вычислительной мощности в виде инстансах в амазоне придется платить за инфраструктуру вокруг этих двоинстонцев это разные сокращения и мало того если за какие-то из них не надо будет платить надо будет платить людям которые в них разбираются Идя дальше очевидно что мало просто поставить кубер где-то в Облаке или у себя нужны будут люди чтобы сопровождать процессы вокруг нашего кубера нужны будут люди чтобы разрабатывать процессы тепло и авторизации разграничения доступа в определенные моменты обязательно микро которые переехали что-то пойдет не так что-то обязательно пойдет не так нужны будут люди которые будут разбираться что же пошло не так пойдут команда в разработке и тут мы определяемся в главном для себя вопросе в Чью экспертизу в этом случае мы согласны инвестировать в экспертизу внутренней команды которая близка к разработчикам или в экспертизу тех поддержки Amazon мы принимаем решение экспертизы инвестировать во внутреннюю экспертизу так как непонятно еще и как техподдержка вендора будет работать и решаем поднимать кластер у себя на Толе находим на тот момент четыре решения это Клопс ренчер и берете питается сразу поднимает кластер тогда на облаке C2 прекрасный мануал командочка за командочкой за пару-тройку вечеров можно собрать свой кластер из пары нот но сопровождать Это около нереально потому что это нужно автоматизировать нужно выбирать человеческий фактор и это уже автоматизировано раньше или куб спрее у нас выигрывает просто потому что написано это наш основной акт компании его банально проще читать проще разбираться в бинаре раньше не хотим Он позволяет тогда гибко настраивать компоненты из которых состоит кубер А мы еще не знаем какая конкретно солянка из этих компонентов нам нужно с окружениями работает тривиально так же как и ансе было те же самые groupars и которые на которые начался существующие наше окружение уже И для нас плюсом что разрабатывался mirantis это одни из Пионеров кубера тогда в принципе мы на их экспертизу честно говоря сильно опирались внедряем раскатываем через Наши первые кластера подари к и морти когда-то бессонными ночами когда-то после бессонных ночей получая наши три кластера первый микросервиса заезжают и мы получаем следующие два года прекрасной жизни сопровождение кластера в которую входят все стандартные операции и для кубера и для металла вот обновления с авто ноты до того чтобы не успеть обновить сертификаты в первый раз и с красными глазами их обновлять мы живем следующие два года живем-поживаем факапов наживаем один из факапов довольно интересный к нам пришел наш датчик и сказал ребята Я открываю новое помещение хорошо сказали Мы мы рады за тебя Ты прикольный классный ты нам нравишься развиваешься Ребят вы не поняли я новое открываю а вторая закрываю War клоуиды Возьмите и пожалуйста в новое помещение свалите вроде все просто Купер Мы возьмем новые ноды в новом датике или мастера старые опустим Все будет прекрасно с нотами мы так и делаем Все проходит А вот мастерами получается похуже потому что спрей тогда не поддерживал скилл мастеров в принципе мы два года крутим кубер думаем Ладно мы не хухры-мухры Давайте заскелем сами на тесте все получается на природе допускаем Down Time в 15 минут понимаем что мы не согласны напротив так экспериментировать и решаем что самым простым способом перевести мастера из одного помещения в другое будет взять и перевести мастера из одного помещения в другое на машинках вытащить из стойки положить на машинку и перевести в другое помещение 9 раз так делаем для 9 мастеров никто ничего не замечает А осадочек у нас остается потому что во времена всяких фалтолеранс и классных терминов нам приходится заниматься тем чтобы чтобы возить железки на машинах это не единственные проблемы которые стали возникать если в начале нашего пути скейт кластером занимал полчаса то с ростом до 20 минут он стал занимать около 4 часов ввиду того что играть нам в ногу в минус то что на самом деле позволяет поднять солянку из практически любого любого набора компонентов для кубера И огромное количество так просто скипается чем больше но тем больше все это время занимает стало понятно что надо с этим что-то делать 4 носки в одной ноды это какой-то титаническое время тем более он может вылить ошибку и потом ждать еще 4 часа Ну как-то вообще не хочется чтобы не быть голословным скачал последний коп спрей поднял несколько это двоинстонцев тут график зависимости времени от числа инстансов для sample конфигурации в рост времени в десятках минут понятно что много на что это влияет от скорости интернета соединения до мощности машин на которые катится Но в любом случае тут ни секунды тут ни минуты тут десятки минут и даже если противники был на 50 нотах на 50 нотах уже будет что-то страшное с этим надо что-то делать Мы подводим итоги мы поднимаем что мы за эти два года прекрасно разобрались в переменных Cube спрея когда его надо обновлять у него переменные делятся схлопываются тебе нужно идти в PlayBook и смотреть что поменялось пока ты понимаешь что поменялось ты еще лучше разбираешься С тем как работает кубер и Делаем выводы что ковстралия реально долго скипает тоски нам не нравится и мы уже понимаем что нам нужен не любой а наш предсказуемое настроенный нам понятным образом кластер очевидно что также куб спрей не позволяет делать некоторые операции по сопровождению кластера например с телеги мастера также тогда он не позволял агрегатить кластер на лету нам приходилось обновляться с версией на версию переездом микросервисов с одного кластера на другой мы понимаем что в принципе мы можем взять большую часть А если найдем еще какой-то бинарь Здорово можно делегировать операции по иниту кластера скейлу ноды было бы вообще прекрасно можно сократить количество тасок просто радикально начинаем искать такой Бинар и находим Опять без Сюрпризов это Куба он только выходит из беты установит начинает светиться в официальной документации кубера и мы принимаем решение написать свой playbox пишем свой плейбук внедряем перекатываемся еще один раз на версию 1.16 playbok выглядит так же как и миллиарды других плейбуков в мире и что получаем выигрываем по времени самом деле очень сильно то что каталась два часа начинает кататься 9 минут операции все те же самые с нами остаются мы думаем что Отлично Можно выдохнуть когда снова будет 4 часа решительно непонятно мы до них докатились за два года никогда Мы так Не ошибались потому что приходят к нам бизнеса говорит ребята Мне нравится как себя ведет Мне нравится как ним работают микросервис это стабильно единственный инцидент был у вас на природе 15 минут это не страшно Давайте все место стоит микро сервисы гнать в кубер начинаем жить следующие два года и расти уже до примерно сотни минут проходит эти два года и к чему приходим что на сотни наш playbox начинает кататься полтора часа мы понимаем что мы на пути к тем четырем часам которые вообще не нравится это противно гадко и отнимает много времени про Апгрейд России лучше вообще не думать это требует взаимодействия с другой командой для сотни ноты Это около недели может занять нагреть версии кластер тут стоит отметить что последний раз перекатывались уже в течение полугода потому что число микросервисов было титанической уже пока все из них взяли поставили себе задачу на редиплою спринт оценили ее прошло много времени и мы понимаем что праздно на том самом пути к полутора часа то надо что-то делать но тут вопрос А зачем особенно от бизнеса Все работает полтора часа то что долго катать одну ногу это более внутренняя инфраструктурной команды Я за неё Я за эту боль плачу им деньги при этом мы тоже Понимаем что нам бизнес платят деньги и за задачи которые повышают нашу ценность перед бизнесом и это Казалось бы правильно нужно к этому мотивация чтобы из этого Круга выходить и мотивация приходит точно также с бизнесом приходит нам бизнес и говорит ребята отлично последние четыре года поработали у нас наконец-то единый Райан микро сервисы в докер контейнерах все классно но напроде у нас растут ошибки в диплоие и по-разному разрабатываются микросервисов в зависимости от того где какой оркестратор Мы предлагаем решение два убрать кобер exprodo и оставить там только докер что мы не хотим делать либо взять нашу тестовую платформу и добавить cuber сборки уже туда тестовая платформа за это время обросла дополнительными облаками в виде амазона гцп всеми теми сокращениями из инфраструктуры и мы решаем что будем поднимать на двоинстонцах тестовые сборки временные с нашим кубером говорим бизнесу Давай это за бизнес дает ТЗ как любят сделать что-то нереальное получилось круто не получилось Ну вы пытались ТЗ получается следующее время поднятия кластеров должно быть меньше трех минут дается двоинственных при этом число нот произвольное число кластеров тоже произвольное кто катал екс понимают что они в данном случае по три минуты но совсем не подходят если смотреть на наш Flow то по нашему слову Нам нужен отдел из 20 из 200-1000 китайцев по количеству сборок в день чтобы эти самые сборки катать создавать инстанции добавлять их в инвентарь никаких дженкинс запускать PlayBook отдавать разработчику можно автоматизировать букву раскладку раскатку плейбука Но вопрос Зачем автоматизировать раскатку плейбука если надо автоматизировать раскатку кластера наш шокальный интерес в этом что мы сможем избавиться во-первых а танцы был минус Минус Чек и гонять Ту же самую конфигурацию на тесте 200-1000 раз в день и никакой минус Минус чек не даст нам такой уверенности в нашей конфигурации и очевидно что здесь где-то должен быть рецепт той боли чтобы не катать наш кластер 4 часа видеть вот эту ошибку от антиблог на слайде и потом катать еще четыре часа кстати в зале есть кто-нибудь кто с ней встречался Поднимите руки пожалуйста супер а кто ее решил стоило попытаться Давайте дальше в итоге мы понимаем что у нас есть что-то что мы должны делать совершенно другим образом как мы это делали последние четыре года отбрасываем все то как мы делали оставляем нашу экспертизу что мы делали я Обращаемся к корням заходим на github hardway и видим в его роднике что он выделяет По большей части 9 этапов для поднятия кластера каждый со своим числом команд опять же за пару вечеров в ручном режиме это можно поднять можно это даже за пару недель за автоматизировать но хочется чего-то попроще попроще есть документации кубера Он предлагает Кубан и если присмотреться в то что он делает то по факту для инита мастера и не так мастера 5 этапов из Hard он сворачивает команду нет минус конфиг для дополнительных мастеров без этого ключа установка CNN сейчас случае Калика еще одной команды Но если хочется еще проще то можно даже не Джони ноду можно разложить на нее сертификаты заранее сделаны запустить с ключом минус Минус регистр нот и нода сама круглят сам запустится зарегистрируется в кластере и не придется даже эту команду делать Итого мы понимаем что у нас есть четыре команды которые должны быть выполнены в правильное время в правильном месте идем прототипировать чтобы не делать особо велосипедов идем к себе плейбук делаем Где в переменные дев окружения и для них переменные ставим This Holder и как на слайде слева раскатываем на ец-2 инстанс получаем конфеты как на слайде справа с этими самыми при этом мы просто делаем с этого после этого из этого снапшота уже запускаем instance кластера которым прописываем метаданные значения для поискхолдеров также в этот снапшот кладем просто баскрипт который запускает из клауденита который запускаем из клаудинета который забирает метаданные сервера метаданных амазона с ядом подменяет значение переменных и запускает Кубан halm Install и так далее И в итоге мы в самом деле получаем три минуты пока но до сами Независимо поднимаются с мастерами стоит на первом Мастере ожидания в 180 секунд если за это время Все ноды которые перечислены метаданных не за дженились в кластер то скрипт считается не выполненным подумали Вау прикольно получилось первого раза даже за три минуты надо пойти инструкцию почитать посмотреть как другие ребята делают вооружились крепом мясо Сашим пошли к вендорам сначала пошли на нода eks кластеров грехнули по екс клаудине таут подлоги увидели скрипт ktc быстрота Саша с вот этой портянкой на слайде всматриваться в неё не надо я расскажу все что там происходит Это моя функция без всех If сокращенная максимально там АВС клей для того чтобы забрать метаданные сервера метаданных Amazon чтобы их подменить заранее положенные конфеде и систем ктл Старт куплет если коротко то это все если зайти на ноды digitalotion кластеров можно найти в скриптах скрипт 30 сервис если зайти в него и посмотреть что там происходит забираются метаданные сервера метаданных после этого смотрится Какая вместо данных прописана роль это мастер или куплет запускается соответствующий бред они себя подтирают на файловой системе их нету но Файлик 10 метаданные кстати выглядят Так мы посмеялись когда увидели похожую точнее идентичную логику с ролями нот если пойти в гкм грехнуть по кьюб в клаудене Тау подлоки можно увидеть что-то новое понадеяться на какой-то новый механизм увидеть там сервисы подумать самом деле вдруг что-то новое найти губернатиз Таргет у него configuration Service и крупностоящему сервис в надежде увидеть что-то новое посмотреть что за сервисы но не найти ничего нового это ваншот сервисы которые ведут на скрипты конфигурцы хелпер и конфигура Саш первые 3700 строк 2300 строк можно набраться смелости окунуться в один из этих скриптов увидеть большое количество однообразных функций как на слайде например это прямо оттуда по скачиванию мастеру сертификатов мастеров там происходит в принципе все то же самое кругом с серверами это data.google Internal забираются сертификаты мастеров и питоновые надстрочником конвертится в переменные после этого подменяются светом запускается куплет и все что все это рассказываю не для того чтобы сказать что какие мы крутые сделали почти так как вендоров нет о том что кабернетис это сложная система Мы все знаем что это очень сложная система Но для ее сопровождения даже вокруг делают довольно таки тривиальные кирпичики везде какой-то сервер Мета данных что-то что эти метаданные сгенерит переменные дальше внутри скриптах это чтобы забрать метаданные после этого тот же самый сет и System ktl Start к вопросу о том крутые ли мы да Нет еще на самом деле потому что наших вы кластера все еще на месте они никуда не делись А вот еще одна точка поддержки у нас появилась Но очевидно что по-другому сопровождать кластер можно и возможно несложные и Возможно даже будет проще чем было раньше мы понимаем что мы как-то хотим уже совместить вот эту скорость работы в облаках тем контролем за конфигурацией кластера которые у нас есть на BR metaly и очевидно что если для облаков не хватает процесса скеллинга кластера и апгрейда существующих кластеров это там сейчас пока просто не нужно сборки временные они живут дольше недели то для хардвер не хватает как раз таки всех тех систем которые есть вокруг мастеров на ec2 когда И то и другое появится мы получим возможность это совместить будет классно но опять же вопрос Когда все идет так с первого раза уже сейчас в принципе мы видим что мы гребем новых проблем проблемы примерно следующие это уже перестанет быть Push системой когда мы пушим нашу конфигурацию это будет уже какой-то пол системой со всеми болезнями по систем про которые на хайлоуи наверное лет пять назад не рассказывал только ленивый и за 4-5 лет за это рецепты от этих рецепты от этих болезней так и не поменялись файл Фаст тогда тестирование никуда не девается в нашем случае Мы надеемся что так как barmetal кластеры встанут просто частным случаем тестовых кластеров которые поднимаются 200-1000 раз в день мы все-таки сможем отлавливать ошибки в конфигурации до того как они пойдут на провод как раз таки эти самые 10-1000 раз в день на наших разработчиках очевидно что система становится сложнее раньше было добавил инвентарь и пошел смотреть влог женкинса то становится по сложнее появляются какие-то системы вокруг какие-то метаданные какие-то скрипты чтобы их Забрать все это между собой как-то должно работать с другой стороны да с одной стороны да с другой стороны можно это со скрипом уже назвать наверное микросервисами которые докатились до инфраструктуры мы до этого дожили возможно и в принципе с микросервисами учились работать также последние 4-5 лет рецепты всё те же самые логинг-мониторинг обзерлобилити сделать микросервисы сами по себе тривиальными в своей сущности чтобы было сразу понятно кто отвалился где отвалился когда отвалился если уходить от теории к практике то mailstone который перед нами стоят Какие сейчас задачи из принтов Мы хотим решить например апгрейднуть ядра на наших станодах за час Если получится это делать то будет прям круто Disaster Recovery встанет у нас кататься прям часто по 200.000 раз в день это опять же не один такой уверенности в том что всё хорошо все окружения раскатываться одинаково это без комментариев точки поддержки лишние уведут и мы уйдем наконец-то от зависимости в размере и количестве кластеров Чтобы это сделать мы для себя определили следующие порядок Сначала мы добавим скиллы обрез на ец-2 кластера чтобы процессы были одинаковые на обоих в обоих случаях После этого мы сможем понять и оценить все доп системы или требования к существующим которые нужны вокруг предметом кластером после этого останется согласовать инструментарий для реализации этих систем с другими командами и бизнесом Чтобы не платить велосипеды пойти переиспользовать у других команд опсов если они согласны если не согласны Сделай что-то свое после этого остаться останется внедрить перезагрузить кластера и жить себе спокойно проживать новых факапов наживать и последний слайд оглядываясь на 5,5 лет назад меня спросили чтобы вы сделали по-другому если бы говорили себе тогда на внедрение кластера что-нибудь Я спросил свою команду Ну первая мысль Не суйтесь туда на вас сожрет вторая Да ничего бы мы по-другому не делали Мы все-таки немножко даже горды с тем что решение инвестировать во внутреннюю экспертизу команды нам позволило вроде бы нащупать Ту самую тонкую тропинку чтобы совместить и гибкость облаков вендоров и гибкость конфигурации Однако другой вопрос Если бы мы это делали сейчас и сейчас нуля внедряли если бы спросили бизнес бизнес скорее всего сказал да ребятки КС есть уже опыт в сообществе вроде работает Зачем париться опять-таки после екс есть вопросы Что делать когда что-то с микросервисом идет не так если предполагать что нас не устраивает техподдержка Amazon она мне нравится как она работает она все-таки решаем инвестировать внутреннюю команду на вопрос Это все-таки пушка конфигурация набора нет или какая-то пол конфигурация к чему мы сейчас приходим с нуля это наверное все таки был все еще Push потому что на этапе внедрения нужно донести ценность настолько быстро насколько это возможно с пол конфигурации сложнее страшнее она большая Она требует что-то вокруг кластера мы бы без экспертизы в клубе на это посмотрели подумали Да ну нафиг и нормально спокойно запустили но сама итерация перехода возможно было бы быстрее потому что есть такие люди Как вы которые сюда пришли у которых есть экспертиза в клубе есть такие люди как мы есть кто-то может выйти рассказать и возможно на что-то нас вдохновить Всем спасибо за внимание Меня зовут Устинов Илья мои контакты на слайде буду очень рад вашим оценкам вопросам кто не успеет сейчас задавайте вопросы в Telegram лучший вопрос получит набор для кислотного требовал шутингов Спасибо ваши вопросы Вот первый ряд у нас Спасибо за рассказ у меня немножко втопный вопрос но все-таки можете немножко раскрыть зачем вам на тестовых средах постоянно диплоить новые кластера Почему вы не можете диплоить там приложение существующие кластера Ну там в отдельном спейс даже если вы хотите все приложение целиком раскатать зачем вот эта задача создание тысяч кластеров каждый день у нас во первых по стандарту компании мы делаем голые сборки каждый раз для чистоты эксперимента чтобы они на другие не влияли и в данном случае мы предоставляем наш кубер таким же как он у нас на проде это целевое то есть там микросервисы в этих тестовых сборках живут с теми же самыми правилами в тех же самых-спейсах которые у них Я надеюсь ответил на ваш вопрос Спасибо в первом ряду еще был вопрос а уже нет Большое спасибо за доклад рассматривали концепцию Когда можно катать непосредственно сперва первый слой условно Купера А уже внутри него есть мастера и потом управляются отдельными ногами рассматривали Федерации но не понравилось в чем была причина сложность управления и нам нравится в такой системе что она по сути более тривиально что ли меньше точек отказа Мы за то чтобы как я говорил это сложная система и в принципе мы работаем со сложными системами всегда мы считаем что Наша задача как инженеров сложными системами управлять просто простыми еще проще желательно Спасибо хороший ответ Спасибо интересно рассказ А скажите пожалуйста что с данными вот какой контент сторож интерфейс использует Как вы данные заливаете на эти перезалитые кубы как апгрейдить соответственно путем перезаливки кластера раньше была перезаливка кластером это просто была раскатка нового кластера сейчас мы уже перешли на свой playbox версии 1.17 стал поддерживать агре на лету и это по факту написанный свой плейбук который тот же самый кластер но до занодой опускает обновляет и до версии 1.22 мы так и катимся запускаем дженкинсе жопу идем печаль после этого смотрим Все ли хорошо или к нам кто-нибудь говорит об этом Спасибо за доклад у меня такой вопрос Вот вы сейчас показали историю развития тулов да для развертывания губернация а вашу систему заложено отслеживание новых применение тестирования и развития вашей вашего процесса процесс разворачивания или нет процесса изучения новых туров для развертывания губернатоса Я предполагаю что вы не остановились на одном единственном решении А все-таки смотрите дальше и шире тут у нас подход итеративный пока можем сопровождаем как можем возникают проблемы начинаем решать просто потому что решать проблемы превентивно опять-таки невыгодно для бизнеса всегда потому что есть что-то что приносит больше денег Однако сейчас мы согласовываем как раз таки функционал который нам нужен а потом уже будем искать инструментарий для этого функционала и это уже вопросы планирования планирования и так далее по факту мы сервисная команда у нас как такового постоянного процесса поиска новых решений нету если сверху спуститься то вы будете искать а по постоянного процесса или если мы продадим бизнесу мне наверное похожий вопросик на предыдущий вот я заметил что вы сократили скорость раскатки но сначала с 4 часов до одного часа путем перехода от Cube Спрей на Cube Admin А за счет того что энси был плейбуке стали намного короче меньше там типа шагов а второй стадии апгрейда у вас стало что вы уже раскатывали snapshot и на них тоже уже почили готовые снапшот по сути тоже оттенция была еще сильнее избавились Вот Но еще упомянули про ошибку чтения с нула вот сложилось впечатление что в целом вы не очень сильно любите энцевал вот если у вас планы перехода на какие-то самописные сервисы которые делают эту работу или мужские другие решения в целом относятся отличный инструмент для своих задач в нашем случае он просто стал выстреливать в тех местах где мы от него не ожидали я я могу сказать что он Я вообще не могу сказать что какой-то инструмент плох каждый инструмент хорош на своем месте в нашем случае мы просто поняли что в нашем случае что он где-то уже немножко исчерпал себя и работа с ним по той схеме по которой мы работаем с ним сейчас не позволяет нам решить нашу боль по времени эксплуатации потратим на эту времени и нужно найти что-то другое как раз таки исходя из того то что какая-то система себя исчерпала и началась стараться поиска новых решений новых подходов в конце концов sensible мы жили и живем с точки зрения управления конфигурацией они уже 6 лет и он нас в этом случае его нас в этом устраивает можно Спасибо за доклад У меня вопрос как устроен процесс обновления версии кластера cubernetics если у вас там Rapid Table И вообще как вот вы переходите на новые версии сначала идет Все с тех же самых тестовых сборок которые мы поднимаем только в данном случае не пол системы есть jenken GB которая по существу поднимает на виртуальных машинах Там обновляем сначала вручную смотрим Всё ли хорошо после этого пишем playbo для обновления Тестируем на тестовой среде как бы это было на природе после этого идем на припрут обновляем там точно так же дженкин с собой автоматически после этого тот же самый плейбол катится на пруд и Инфо Ну то есть не бывает ситуации когда у вас одни приложения в проде крутятся на одной версии кластера другие на другой версии параллельно вы не поддерживаете несколько версий сейчас нет раньше Когда жили перекатами у нас такое было но опять-таки микросервисов много команд много и это дорого для BR metalo поддерживает Две версии кластера потому что они тебе нужны примерно одинаковых объемов это требует в старом кластере диске или ноды в новом скелет ноты проще существующие взять и на лету обновить Спасибо Спасибо у нас вопрос глубине зала Да привет рассматривали ли вы инициализацию кластера через ltsp по пикси чтобы можно было такое Golden Image взять и раскатать Ну а остатки уже дальше через иак аманси был любой что можно было бы ускорить инициализацию всего кластера на бар метле Нет не рассматривали коротко отвечу не рассматривали этот толинг не смогу дискутировать если в кулуарах пообщаемся расскажешь будет круто да крутая штука по сути ему табельный образ ты бутавишь машину прямо по пикси и там уже готовые среда в которой можно за джоннить кластер Ну и дальше все по накатам Возможно мы к этому придем как раз таки когда начнем искать инструментарий Спасибо большое ещё вопрос здесь просто они пробовали использовать для сокращения времени развертывания кластера с помощью был плагин метаген Если да был ли эффект конечно пробовали не было эффект был но мы естественно и метаген и джантранер и косо выделенный для этого раннего тюнин или как только могли это уже 4 часа максимально затененный конфигурации антиблона насколько смогли потому что впоследствии перешел на экзотику Багма и за счет того как раз таки получилось что не четыре часа тогда еще и все прописаны и это было титаническое время на самом деле еще вопрос от меня а я правильно понял что вы не используете автоскелинг это эластичность берметов костеров Это совершенно другой вопрос Мы думали было когда-то идея добавить Карпентер на например инфровы кластер чтобы раннеры могли джоннится к барометтам кластеру из облака но пока оно только на этапе идеи Спасибо ещё вопросы Ну если вы передумаете то ловите нашего прекрасного спикера на автопати и Спасибо ему за его прекрасный доклад И вам спасибо за ваши прекрасные вопросы и лучший из них мы сейчас выберем Я вот не знаю Мне нравится первый вопрос а нравится последний вопрос Давайте залом попробуем выбрать делегирование Давайте за первый вопрос Поднимите руки пожалуйста а за последний тогда последний вопрос его просто помнит лучше можно молодой руку и получить Ваш подарок вот там человек в глубине зала и для тебя у нас тоже есть подарок Зато прекрасный доклад Спасибо вам за ваше внимание Спасибо спикеру за его заклад и на этом Мы закончили всех будем рады видеть на автопати Всем спасибо"
}