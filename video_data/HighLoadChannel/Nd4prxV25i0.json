{
  "video_id": "Nd4prxV25i0",
  "channel": "HighLoadChannel",
  "title": "Сага о yield. Скрытые возможности / Евгений Евсеев (МойМеханик)",
  "views": 1428,
  "duration": 3227,
  "published": "2018-01-16T13:28:02-08:00",
  "text": "спасибо меня зовут евгений и я люблю питон вот это была шутка нет это была не шутка 10 любит он рассказывать буду проел и что с этим можно что с ним можно делать я работаю в компании мой механик и занимаюсь тем что чине автомобиля при чем делают и хитро по телефону удаленно сейчас clicker заработает а может и не заработает что-то не так в презентации а вот теперь заработала ну что же такое ладно разберемся значит что я делаю я помогаю оформлять заказы человек хочет починить автомобиль он вызывает хочет заказать техобслуживания но масло поменять например можно ехать в автосервиса можно залезть на сайт выбрать услугу посчитать цену или заказать время мастер приедет починит прямо рядом с домом или рядом с работой под окном что нужно что все это было возможно начат проект начался с того что начали переделывать web-интерфейс решили сделать все с нуля потому что старый был сделан на джиг вере кодом многое в общем у выкинули другими словами давайте все перепишем но была выбрана методика отжарил никакого проектирования детального вдумчивого пожилому значит вот новые требования вперед какие технологии были выбраны redex и rayjet для тех кто не знает редакция то у нас управление состоянием храни состояние и через событие это состояние меняет а роджерс это библиотека наподобие реактор аналог которые реактивный тезис обеспечивает ну а вместе с вязки у нас получается есть состояние из библиотека который имеет отрисовывать интерфейс поэтому текущему состоянию 3 программиста работали три месяца но веря тому что используется flags подход когда у нас интерфейс реактивный нас вся верстка собрано не размазана как это обычно бывает если писать черри джек вере шаблоны легко понять их довольно просто отладить мы можем воспроизвести любую ситуацию вручную или ещё как-то поменяв state а еще можно использовать компоненты много раз в общем все отлично сейчас покажу что получилось значит вот у нас есть страница корзина а как она работает мы хотим выяснить как она работает начнем наверно с того что пощёлкаем эту страницу на продакшене что она там делает но видно the master отображается есть формочка просит ввести телефон e-mail там что-то еще дальше внизу учитывать понятно это завершение оформления заказа но после этого мы залазим верстку в компоненты видим иерархии эти компоненты как они друг от друга зависит нас остался не выясним все один вопрос а что собственно происходит по клику пользователя скажем на кнопку отправить заявку ну или отменить или что то еще как наша страница реагирует на действия пользователя посмотрим за лет залазим в код и там мы находим такую штуку у нас есть функция он концов она эта функция вызывается по клику на кнопку вернуться что происходит ну посмотрим значит 100 направляется событие судя по названию можно догадаться тут начались какой-то процесс ордера blade и он отменяется лизинг дальше так еще одна функция это вызывается когда нажимает на кнопку отправить здесь похоже на повезло здесь вызывается функция апдейт ордер это как раз тот самое обновление заказа который мы видели перед этим но тут в он саксэс придать искать другая функция апдейт квот лезем по коду дальше смотрим и видим она на самом деле вызывается начнутся два запроса к серверу на обновление заказа и на перерасчет цены и похоже у нас ошибка в коде потому что первый запрос мы отменили по нажатию топку назад а вот второй запрос мы забыли отменить смотрим дальше оппа так в той же самой функции дальше по ходу в общем если сервер на у вернул какой-то магический статус 4 куча налей и 5 конце то это значит что ключ протух клич авторизации пользователя нужно его перегенерировать соответственно пользователь сначала раз авторизовываться после этого запрашиваю авторизацию по новой ну несколько неожиданно и что это значит это значит что наша страница на даже нормально отрисовывается ситуация когда полете на самом деле не авторизован потому что star отправленное соответствующее событие юзер локаут и надо проверить что там шаблон еще не ломается что все работает корректно так ну посмотрели братец а просто ура мы молодцы учета забыли о точно что-то забыли как насчет вот этого где работа с формы полете что давай там же ошибки должны быть нужно чашек и отобразить как минимум получить их сервер отобразить этот год мы не нашли ну наверное стоило поискать лучше еще мы забыли похоже подгрузить заказ использовать нажал и в 5 нужно дождаться когда сервер придет информация по заказу и только после этого отображать уже страницу ну или делать страницу такой чтоб она корректно работала при отсутствии данных о заказе да еще мы не нашли логику которая переправляет пользователя дальше ну где-то оно там видимо и так что же мы имеем мы имеем код который с одной стороны прекрасен это флаг с другой стороны он разбит на части и довольно хитро переплетены еще неясно день у начал один конец и все это что-то напоминает у этого всего есть такой вкус знакомый вот такой это спагетти код конкретно на моем опыте прошествии трех месяцев разработки год превратился вот в это три человека но при этом никто не один из них не знает что происходит где происходит и когда нужно поправить страницу то надо все читатель сначала на проект большой чинить автомобиль довольно сложно на самом деле мы заказ оформляется там тоже не тривиально можно дописывать функционал у нас отжал у нас постоянно как из рога изобилия сыпется фичи фичи фичи фичи добавлять их уже никто не состояние чуть что сразу всё ломается и тут значит происходит следующая сего проекта андрей говорит наш у нас тут планы поменялись нужно немного еще вич прикрутить значит вот такая нужна сайт упаковать чтобы он как виджет всплывал на сайте партнеров так на кнопочку нажимаешь всплывает вместе со всеми со всеми наворотами что можно оформить заказ не уходя с сайта года после этого мы возьмем и обернемся это фон gap и сделаем в его мобильное приложение вот вот это все как только сделаем нас будет следующая часть нам нужно будет еще одно приложение забацать этот раз для мастеров которые уже эти заказы исполняют ну вот я ну так по прикидкам и всего раза в три больше итак впечатление было примерно вот таким это неизбежно что то с этим нужно делать давайте попробуем проблем подойти с другой стороны попробуем плясать то есть как можно проблем переформулировать у нас есть код который раскидан где-то там по проекту вот типичная задача когда мы что-то на страницу дописываем это понять что происходит вот и предложение char который все знает мы подходим спрашивала а что там вообще происходит какой последовательности о чем я должен знать прежде чем допишу туда свой код и он нам рассказывать примерно следующая ну значит на этой странице сначала отображается такой прелоадер что заказ загружается а ну и в это время сервера прилетят к нам данные мы ждем после этого отображается страница с формочки заказа там снизу поля input и мы ждем дальше когда полечить ведет как только он вел мы отправляем их на сервер эти данные серверному выплевывают ошибки говорит чет не толь вели номер телефона уже зарегистрирован был ранее мы их эти ошибки отображая ну и дальше в цикле ну так вот крутится крутится и вот такое писание поведение страницы на простое можно словами так раз два три все объяснил все просто все понятно и ну примерно понятно куда чего нужно дописывать а теперь мы попробуем взять эти семь пунктов и перенести их вот так прям по одному конвертировать их в код как-то сделать значит сначала да сразу подсказка в комментариях сверху везде указаны циферки точно такие же как они были на предыдущем слайде пункт первый отобразить пилот но только эта функция mount image вот она берет иначе наш визуальный компонент размещает на странице компонента создать прелоадер пейдж после этого загружу происходит загрузка заказа сервера значит обычно если мы это делаем стандартным способом то здесь у нас разрывается поток исполнения мы передать говорим что нужно отправить запрос на сервер а вот когда придет ответ что то там нужно будет уже к другую функцию запустить другую логику но мы-то хотим чтобы оно все было в одном месте прямо так вот что можно было посмотреть на код сверху вниз и понять что происходит поэтому мы здесь пытаемся использовать магическую штуку ел как она работает fitch вот стандартный жар скриптовый fitch он на возвращает объект пролез этот объект мы передаем кьелд и здесь у нас выполнение программы прерываются конкретно наш код передает управление наружу и говорит что я хочу продолжить исполнении так после того как придет ответ сервера и когда только придет ответ сервера то я то это будет объект response который мы сохранили в одноименную переменную дальше но мы делать действием по аналогии response на самом деле у него можно вызвать метод джейсона тоже вернет promise соответственно моего 5л дим и получаем в этот раз уже данный заказ обзор ну и помещаем его в тени риру им соответствующее событие поехали дальше нужно показать форму заказа снова мы вызываем монтаж единственное отличие здесь заключается в том что в этот раз нам нужно как-то с этой страницей будет коммуницировать когда будете нажимать на кнопку нам надо узнать о том что на кнопку нажали и поэтому создан специальный объект причину идея точно такая же как с про местами разница лишь в том что этот промысел может срабатывать много раз в канал кто-то бросает события мы можем на нее подписаться и сказать дождись пока в этом канале не появится события и делаем этого таким образом ел track а дальше мы передаем канал в котором ждём события и как только на произойдет мы получим это самое событие в переменную форму дата здесь мы дождались ввода пользователя отправили данные на сервер полностью по аналогии дождались ответа получили список ошибок если ошибок нет мы перенаправили пользователя на новую страницу с оплатой а если ошибки есть то мы их засовываем stor помещаем штор для того чтобы в интерфейсе а не отобразились нам остался седьмой пункт самый сложный конечно нам нужно чтобы процедуры повторялось раз за разом значит нам нужно бесконечный лайл мы берем и весь код оборачиваем лайл но еще хорошо бы этот код куда поместить чтобы он жил не только на слайдах ракета нас проекте поэтому берем и оборачиваем его функцию одна функция которая делает все от обычно отличается синтаксис он там появляется звездочка фарш на звездочка это говорит о том что наша функция она умеет прерываться с помощью ел door подробнее что такое л д а function звездочка это то что называют по другому к рутины или со программа специальная такой специальный вид функция который может прерываться ой элт этой конструкции которая говорит о том что вот в этом месте надо прерываться как-то работает по прочный простенькая вот мы создаем эту программу раны говорит она как только я запускаю сразу же в лук вываливается сообщение что она готова к работе после этого мы создаем объект команду команда для некого кода снаружи управляющего кода что мы хотим нам случае мы хотим дождаться ввода пользователя и у того кода снаружи у нее есть команда для этого специальное вот я такое название ленивы пусто было понятно дождаться ввода пользователя мы просим внешней код это сделать за нас и как только пользу и что ты ведет вернуть на данные которой он велел положить их userdata и аналогично мы просим внешней курт дождаться ответа сервера ну или того чтобы он знал какого ответа мы ждем мы передаем promise объект о каком запрос сейчас идет речь как только ответ придет то снова данные будут возвращены в server data чтобы было проще все это воспринимать чем я обычно пользуюсь я воспринимаются программы как некий аналог процесса мы его запустили удачно что делается на событие реагирует их ждет и когда он больше не нужен мы просто останавливаем вот это самый типичный способ взаимодействия с этой штукой для того что полностью работал на нужно часть наружние некая библиотека снаружи которая будет вся наша команда выполнять то есть она предоставит свою api нам и в качестве библиотеки на проекте мой механик используется ридак сага она очень примечательна эта библиотека много из сначала неочевидных но потом просто убийственных особенность которые облегчают жизнь но в этом не сейчас в общем просто рассмотрим вариант c ридак сагой что она умеет мы можем вилт передать promise и тогда вернется управление только когда этот promise будет разрисовываем еще мы можем попросить дождаться события в канале это то что использовалась ранее но можем делать намного более интересные вещи у нас есть какая-то другая программа мы хотим запустить что вы работал параллельно то есть у нас теперь не одна функция работает а сразу несколько все параллельно все прерываются и чего-то ждут каждый чего-то своего мы можем это сделать с помощью специальной команды ford и передать ей что нужно запустить в ответ мы получим специальный объект task с помощью которой мы можем управлять этой картиной а именно что мы с ним можем сделать мы можем сказать а давай-ка 1 пусть первая наша су программа дождется того момента когда 2 закончит свою работу это мы делаем черри join или другой вариант а давайте мы ее отменим она больше не нужна заканчиваю работу прямо сейчас не дожидаясь и все будет аккуратно прекращено команда концу на самом деле намного более влажная и как ключевая в этой библиотеке чем может показаться самого начала сейчас я покажу в чем фишка а фишка в песочницах предположим у нас приложение довольно большое и мы используем routing у нас для разных адресов используются разные су программы и мы хотим сделать так чтобы для каждого адреса работал для каждой адреса задать свой код чтобы он работал работа работала как только пользователь переходит на другую страницу он сворачивал свою деятельность и случится аннигилировал а и мы запускаем другую песочницу таким образом мы получаем код который разбит на маленькие кусочки очень слабых друг дружкой связаны не будет такой ситуации что на одной странице мы запустили процесс пересчета цены в это время пуджи перескочил на другую страницу и спустя 5 секунд ба-бах и цена поменялось чтоб такого не было как-то можно провернуть у нас есть адрес каталог странице каталога и для нее мы сделали со программу ран каталог пейдж все просто на пользователь на нее попал на эту страницу со программа ждет что там пользователь сделает куда кликнет но предположим он кликнул на ссылку я упрекнул на ссылку перехода в корзину этот момент 1 су программа верхняя она резко сворачивает свою работу вообще исчезает запускается другая но это она сложная значит здесь параллельно запускается еще процесс обновления заказа что-то отправить на сервер дождаться ответа а там дальше дальше запускается еще пересчет цены вот ему попадать такую ситуацию что у нас начиналось все просто а вот он бабах их стало много и тут пользователь нажимает на кнопку оплатить нам нужно как перескочить дальше так вот и возвращаясь к идее команды концов она умеет работать так что она за вас всю работу сделает она отслеживает всю последовательность вызовов кто там кого запустил еще попросил сделать и когда ранд картридж самая верхняя су программа и сказано заканчивать свою работу она аккуратно завершит работу всех своих дочерних 100 программ но то есть нам ничего не надо думать он просто говорим заканчивай и она всё исчезает как будто его и не было все мы перескочили на следующую страницу другая классная штука которая тоже может быть не очевидной при использовании ридак саги очень активны можно использовать исключение я сейчас покажу в чем смысл и что не получил позволяет достичь предположим у нас есть су программы для страницы с корзиной ран кортеж и вот она работает или то там внутри запускается другая все программы сделать запрос к серверу обработай ответ а там где-то еще ниже внутри выкидывается исключение опера наши специально исключение специфическое для приложения что происходит это исключение сначала ищется обработчик в api есть он там или нет обычный тратишь его там нету дальше проверяется нет ли случае моего уровня выше в ран кортеж и там никакого специально обработчика нету и тогда мы делаем финт ушами мы заводим специальную стандартный стандартный обработчик верхнего уровня то есть мы все это оборачиваем другую функцию которая как раз реализую тот самый тратишь что позволяет достичь вызов обращение работы с api она происходит в огромном количестве мест кода но по сути все наше приложение но так или иначе завязано взаимодействие серверов каждый раз обрабатывать стандартные ошибки протух ключ пользователя или заказ не найден или ещё что-то такое каждый раз писать этот код на утомительно и зачем это нужно теперь мы можем написать универсальную штуку хендл come on a pear os и обернуть нее все страницу и если никакой специальной логике по обработке специального вида исключения не предусмотрено логикой страницы то ли не у нас есть стандартный обработчик давайте конкретней а нет ни конкретней сначала покажу как то примерно работает мы хотим создать функцию decorate a ей мы передай передадим наших ран карты что на выходе получим обернутый грамм картридж реализацию не вот такая довольно простая мы создаем еще одну со программу которая все что делает это внутри блока тратишь передает управление исходный о программе если исключение произошло то мы его можем обработать прямо здесь дальше конкретный кейс значит мой механик работа с заказами на заказ это у нас запись базе у нее есть айди общем нам нужно постоянно получать информацию о заказе и и может так получиться что пока пользователи там чай кофе пил звонил менеджеру еще что то такое за это время заказ исчез менеджер вот меню или что то еще произошло и получается что нам в огромном количестве вызовов к api нужно везде обработать одну и ту же ситуацию заказ не на один заказ не найдя что делать что делать можно писать каждый раз логику под это стандартную бойлер plate но опять же зачем это делать если мы можем сделать вот так мы вызываем логику нашей страницы и оборачиваем в треке который все что делает это перехватывает предоставляет стандартные логику для обработки ситуация заказ не на один данном случае мы просто показываем страницу красивую извините этот заказ не найдено можете вернуться на главную страницу ну что что-то такое и она стандартно или все приложение дальше нужна авторизация сервер говорит что этот запрос нельзя делать без авторизации поступаем аналогично снова оборачиваем снова перехватываем исключения специальный наши логин рекламе ну и в этом случае просто направляем на страницу авторизации другая типичная ситуация что-то сломалось у нас есть какое-то исключение никем не обработанные вот оно всплыло на самый верх ну можно сделать так что просто все просто выдать alert извените у нас у сломано а можно показать красивую страничку и мы снова проворачиваем тот же самый трюк мы перехват и вообще все исключения эта штука на самом верхнем уровне сидит исключение отправляется в центре и мы показываем красивую страницу извините что-то не так можете вернуться на главную страницу ссылка кнопка но и так далее другая интересная особенность шаблоны без сайт эффектов о чем речь значит обычно приложение выглядело так у нас есть 100 у нас есть ряд который все это отрисовывает в данном случае сторону выполняет функцию модели данных area кто выполняет сразу две функции он как бы и view и как бы контроллер это если мыслить в рамках им вести концепция чему это приводит вот в пак есть классная штука ход модуль replacement когда мы берем и прям react компонент наш подменяем по горячему взяли вынули и новый год туда подставили это здорово потому что вы можете прямо так вот сидеть за ноутбуком вам говорят вот так вот это влево звень немножко ты сбегаешь чуть влево проходит там секунда и сразу можно видеть результат потом ничуть не получилось давайте значит свет поменяем здесь плошечку добавь и прям по горячим все делается делается делается за одну итерацию тратит вам буквально доли секунды пока сохраняешь файлы переключаешься на окно браузера у тебя там уже все свежее но проблема в чем если мы меняем компонент то у нас на самом деле отрабатывает еще логика которые в нем была зашита например там может быть логика которая в принудительном порядке отправляет запрос к серверу подгрузить заказ или еще что-то делает и получается что в теории это дано все здорово мы взяли подменили но у нас там есть логика и она может некорректно отработать для текущего состояния stora который мы сохранили что с этим можно сделать в принципе все просто мы оставляем 100 расставляем react значит компоненты react они по-прежнему скоро тянут данные их от и отрисовываются вот но реактор ничего не пишет он туда не dispatch от события вместо этого он использует для этого посредника нашу программу он в канал отправляется бытия пользой нажал какую-то кнопку обработает и пожал сто а дальше она уже обрабатывает чему эта схема классная вот в данном случае реакторы реально работа как сменная панель к у нас сохранилось сохранилась состояние у нас если запрос к серверу куда-то улетела еще ответ не пришел он по-прежнему будет корректно обработан потому что все это происходит с о программе нашей мы можем взять просто и одну верстку заменить на другую верстку и ничего вообще не поломается в данном случае у нас react выполняет функцию view а вот служит функция контроллера логике чего надо сделать она вся перемещается в со программу так зачем все это есть праздник жизни значит как я уже говорил по окончании трех месяцев разработки никто уже не ориентировался в кодовой базе flags он хорош но проблема осталась нужно было что-то делать попробовали одним способом подойти пытались он ввести в проекта вдруг поможет пытались сейчас даже не вспомню там было пять попыток по моему что то сделать конечном счете остановились на том зачем я рассказываю оно помогло конкретно мы смогли снова наращивать функционал в бешеном темпе очень быстро вплоть до того что перед тебе sedici который что-то просит сделать и ты прямо при нем это делаешь проходит 10 20 минут и готово в коде очень легко ориентироваться вы хотите добавить функцию страницу просто берете открываете функцию этой странице это обычный кот читайте сверху вниз то есть как только вы все прочитали все вы знаете что происходит на страницу больше никаких дефектов прямо от начала до конца намного меньше более plateau показала как можно обрабатывать стандартной ситуации если заказ не найден требуется авторизации к там довольно много всяких разных и вот таким нехитрым способом можно количество этого куда сократить в разы а ещё у нас стал классно работать код модуля replacement ну прям вообще огонь итак тем кто хочет попробовать как это сделать на github есть репозитории там примеры кода но несложные такие чтобы можно было понять что происходит пощелкать запустить еще есть документация порядок сага там описано пишет что можно передавать в ялте как она будет реагировать вот а ещё это можно внедрить на своем проекте самое веселое лучше конечно чужом проекте на всякий случай вот но можно и на своем попробовать это можно сделать по частям все что вам нужно это модифицировать роутер вам нужно сделать так чтобы теперь при переходе на какие-то определенные адреса страниц непросто управление передавалась компонент а вместо этого запускалась к рутина подход опробован на проекте мой механик пополам потом опробован еще на таком проекте там где создавался чат и еще один проект насколько я знаю там использовался react я презентаций указывал что там был роджерс но на реактива тоже все вполне себе работает есть люди которые тоже делали и последнее объявление на правах рекламы в общем можно все это каждый раз а самому выдумывать а можно сделать небольшой микро фреймворк то он устроит 1000 строчек кода и все на этом вот и я ищу людей которые хотят в этом класса начинание поучаствовать и внести свой вклад в том чтобы веб стал еще немножко лучше спасибо секунду сейчас можно задать вопросы что по истечению вопросов докладчик выбирает 3 наилучших вопроса эти люди получают наклейки которые по специи можно будет обменять на ценные призы самую сложную часть вопрос на спасибо за доклад очень интересно действительно саги прекрасная технология позволяет абстрагироваться от его я и моделировать предметную область в чистом виде но большая просолилась он большая проблема в том что в которой я столкнулся это отсутствие каких-то внятных примерах больших и хороший документации и единственный более-менее внятный вариант это книжка на им издание там лежит по secures в общем не знакомы это был муж не продолжать давайте расскажу как у нас это было начало посоветовать что они первые три месяца которых я говорил там был написан ари dax роджерс я туда не дописал там был еще один плюсик плюс 3 dax сага и это было ужасно и код который я привел он адаптируем потому что ничего прасаде не была на самом деле он был носорог написано его копировал там были саги кусочками проблема в том что люди которые разработали ридак сага они у них потрясающе работать интуиции они сделали прям офигенно яппи вот я лучше не видел на питоне например хуже сто раз причем 4 или 5 библиотек смотрела специальная скала нету ли на питоне подобная реализация ответ нету то есть очень удачно штука направлен в том что они не поняли как и правильно готовить это что они советуют это сплошь и рядом антипример а и вот так делать не надо и мы сначала начинали как классный подход давайте попробуем у них документации все описано смотри дело раз делать два дела три три месяца проходит и ты понимаешь что но это просто от вообще там понять что происходит ну ну невозможно и корень проблема заключается в том что они пытаются прикрутить вот этот подход новый к старому велосипеду и у них вместо того чтобы плясать от со программ то есть со программа управляет всем мне вместо этого всем управляет насчет раид или react по событию куда-то там что-то выкидывается а там в течение всей жизни приложения висит сто пятьсот со программ каждое из которых думаю что она шибко умные знают как правильно реагировать на это событие и это приводит к возрастанию сложности вот вы добавить добавили одну страницу там у вас значит там четыре запросы серверу потом берете еще страницу добавляете вот обработчики 4 запросов они вас как веселья так и висят но смысле они по-прежнему работают блокируешь добавить новую логику и там снова еще три запроса и два из них повторяются от вопроса надо использовать вот те или новые писать но всеж ленивый давайте используем но там нужно чуть логику поменять это вот пару мифов добавить значит ты добавишь на пару мифов и все нормально потом значит золотишко смотришь бы а там значит этих рифов уже ну просто немерено и непонятно что происходит и он все так у связаны между собой в общем не работает и после этого стало понятно что-то надо менять и как раз топах о котором я рассказываю это таблетка от этого я правильно понимаю что вот с этими льдами joe young and sell решается проблема того что когда уже пользователь одну кнопку нажал идет какая-то загрузка и он может нажать вторую до пришел только эту проблему она решает или еще какие то ничего не матерям не слушая внимательно но собственно эти вопросы не буду отвечать лучше просто еще раз посмотрите где не решать эту проблему там всего лишь один кубик допустим даже есть несколько promise of the можно стандартный promise о использовать которые там разрезал виться когда все про миссы прошли посмотрите ладно я не выдержал посмотреть все таки повторюсь был пример самом начале заказ у нас когда нажимать на кнопку отправить и но сначала сервер уходит запрос обновить заказ на сервере после этого рассчитать цену на сервере но и цепочка с почка последовательно одна за другой идет после этого нужно сделать на самом деле в новой версии там еще два запроса один из них это подгружает расписание мастера причину довольно хитро и логика делать или не делать и что-то там еще я уже сейчас не помню на так вот посмотреть так вот что нельзя расписание мастера сделать один запрос вернут него расписание мастера за того что вы это можете сделать только после того как обновили заказ и только после того как вы выяснили вообще проценко сработал или нет вы не можете вызвать мастера если он не знает сколько стоит ремонт такая логика приложения и вы конечно можете с помощью там бубна или чего-нибудь еще решить все это другим путем и более того она решаема другим путем мы решили другим путем проблема в том что стоимость поддержки модификация такая высокая что проще переписать чем продолжать в том же духе понятно ну попробуйте другими словами слышишь клубу глупый вопрос вот этот вот ел худел форк и так далее то только в этом сама в библиотеке собственно это и есть саги до бана and forth да да это специфично для саги дасима понял нет смотрите там был пример и показывал на что мы вьют записями объекта с командой вот фотка народы точно так же не сначала делает она генерирует объект команды описывающий чем-то сделать елтон поддерживается движком jalas java script а вот на что вы туда пробросить и в этот ел это зависит от библиотеки которая работает снаружи fredag сага в данном случае то есть нет такой штуки как help for java скрипте есть ел так общем-то вопрос фифти-фифти ел to the java script for это api саги давай только громче можно сначала спасибо за доклад очень интересно а вот такой вопрос а вы писали тесты аха спрашивает сразу тут написали вместе но простой я вот видел там пример это что вы сразу скорги смочить то есть вы put- и вообще не используйте тогда так ну очень история какая вот я говорил что ридак сага разработчики не прям гениальное эти придумали очень простой все здорово но документацию не куча анти примеров к делать на один из них них такой значит ну так как у нас есть йод а давайте мы сделаем так чтобы у нас все программы все были чистыми функциями чтобы онер вообще никуда ничего не отправляли чтобы все что нужно с внешним миром сделать они через ент выкидывали наружу и тогда мы сможем это протестировать мы можем взять эту программу подсовывать и правильные ответы и протестировать проблем заключается в том что если вы поете таким путем то вам нужно будет в точности один-в-один повторить логику вашего программа только зеркалирование ну то есть нет смысла в программе которая ничего не делает внешним миром потому что за программа это вообще штука которая синхронно там же бизнес-логика быть а как же есть старый подход называется такой если вас есть сложное сложная логика вы выносите в отдельную функцию потом вы тестируете или этого не делать и синхронные и асинхронные для этого делать не надо только все усложняется на такой писали не так я там говорю если за падешь этим путем то это приведет к полному повторения логике ваши сайты только с другой стороны баррикады до этого все равно что написать логику два раза только по другому тут считался даже еще интереснее значит ну старые тесты которые тестируют отдельные функции не асинхронные обычные они никуда не делись пожалуйста пользуйтесь и это классно дальше дальше больше в тот подход это которыми я говорил он предполагает что вы тестируете не через подмены гелдоф а через прокиды вание событий в тянул вы имитируете действие пользователя и отдельно довольно просто можно прикрутить что у которой будет имитировать ответы сервера причем вы можете теста писать асинхронно чтобы не просто ответ от сервера пришел чтобы он конкретно пошел через две секунды мы просто вот возвращаясь даже к тому putu почему рекомендуют его использовать то есть он возвращает объект это косяк ридак саги и можно просто дело текла ладно да ну а не так советуют делать по той причине что когда делаете путь вы передаете управления наружу она там уже решать вернуть вам управление обратно или может другую программу запустить это у них к ключевой элемент у них все завязано ридак подразумевается подход который не капица в документации когда вы просто в редакции направляюсь сто пятьсот события не так как нибудь сами разберутся с потом вот и тогда вам сильно нужно все делать через путь чтобы можно было прервать что можно было передать управление другой стал программе например если вы этого не делать он не нужно а микрофон поднимай выше что видно на сколько я понял это один из основных + в которую редакция get в вашем проекте как бы эдак сова принесла ваш проект это плоский асинхронный код а вот вы используете другие подходы которые позволяют плоский синхронный код как получить например библиотека или асенька уэйд скажу на сервере у нас к но смысле это тонкий тонкий серверная насколько важно именно а фишка редакций как бы учиться что не используйте react ключевая ключевая роль в том что в двух вещах это форки возможность запустить вот смотри у тебя и странице заказа пользователь клацает это включу слугу включить эту выключить включить выключить и вот он клацает и если у нас в это время перерасчет шел надо значит вот сворачивать и запускать новый потому что изменился заказ нового такое запустили у через форк его нет можете восстановить а потом после перешел другую страницу вы все сворачиваете выкидываете и никаких сайт эффектов ничего там последовать не приедет сервера просто редакция гана как бы ориентир на во многом нарядов скажем тот момент когда вы говорили проход рилот как бы от проблем там с редакция была бы решена показалось интересным что вы не используя редакцией доктора заюзали да нет вреда кс мы использовали во все построено на редакция ваш макс не показал пример совета как подход использовался именно редакция все на редакции построена но там тоже своими заморочками на самом деле из условия сложная модель данных огромная и пришлось использовать таком очень интенсивные широко потому что иначе и ориентироваться невозможно привет меня зовут саша спасибо за доклад и у меня два на самом деле вопроса первый это я видел что вы используете центре и вы не испытываете никаких проблем с актрисами и ссор с попами при ловле басса но это каша из проблем который час волнуется этого как пытались решить или нет пока запись помогали раньше сейчас полон перестали том как как с разрабов провели с ираном коде из генераторов очень да ужас непонятно что происходит вообще ну в общем в общем не решали бережно губин нужно изучать и догадываться где же оно могло сломаться но к сожалению нет вариантов я понял да и второй вопрос это вы показывали что вы храните все события в реакции через саги то есть насколько это оправданно с точки зрения трудозатрат ведь есть по любому у вас есть какие-то синхронные события не проще ли dispatch этих сразу из react и ну да хороший вопрос кстати говоря где здесь и границу провести концепция делать компоненты тупыми прям так что они даже свое состояние не хранят она вообще порочного порой проще все таки чтобы он что-то хранил с другой стороны нам зачастую полезно в ссо программе знать например какая вкладка сейчас открыто из 2 это синхронная операция переключение вкладок вот но все-таки в программе полезно знать у меня нет универсального решения этой проблемы как конкретно на проекте мой механик уступаем у нас есть несколько режиссеров для редакции стандартных и loader ошибки форм и что-то там еще она повторяется раз за разом писать каждый раз нет смысла и поэтому на уровне со программы мы просто их комбинируем складно составляет сделаем новый star нас для большинства страниц есть свой маленький старик то есть вы несколько споров и до 10 столь глобальный там справа состоянии получается приложила доехали на глобальный спортом только информации которые нужно везде это кэш и грубо говоря там информация заказах ранее погруженных каталоге автомобилей зоны обслуживания и при этом на 1000 то информацию только на странице ошибки формы например их наружу все равно удалять но можно конечно все перехватывать и специально их тереть но тогда у нас глобалист о разбухает и неприличных размеров там вообще невозможно уже сориентироваться для каждой страницы специальные отдельные значит это отдельное дерево вот чтобы этого не было создаете свой маленький спор и плюс этого подхода в том что очень легко потом комбинировать виде у серы там на эту страницу у нас есть форма а значит нам нужен прелоадер и нам нужно штука которой ошибки отображает а еще на это страниц там есть специальное сообщение об ошибке на чьи берем другой режиссер взяли три режиссера скомбинировали вот вам новый маленький стол и он исчезнет как так пользуйтесь очень чуть не надо выше notes по сути у вас получается приложение в приложении то есть каждой страницу вас является ряд приложений такая история вся эволюция и биологическая такая она вся про обертки обертки обертки ну да ладно спасибо большое спасибо за доклад на самом деле предыдущем уровень человек спросил практически случае хотел но вы не ответили осинка вы это можно использовать вместо еды она более очевидно мне кажется ну наверно я не пользуйся ничего сказать по данному поводу второй вопрос поскольку код становится синхронным а какая отмена происходит запросы по таймауту например там надо через 10 секунд его ну вот через форк мы берем запускаем два процесса один сервером общается другой просто ждет 30 секунд как только он дождется 30 секунд у просто сворачиваю в этом то и проблема второй процесс должен знать что конкретно отменять если кот идет последовательно то ну если в бочке случаев на самом деле-то затем надо будет считаться когда то нужно и когда это нужно для этого есть специальный трой кетч у которого может перехватить исключение отмены программы то есть она отменяется не просто взяли и выкинули там самом деле исключение всплывают вы можете его остановить сказать что вот если здесь в этом моменте в этом месте отменили то она там еще какой-то ресурс освободители что то сделать это можно сделать на самом деле плохой дизайн когда такой нужно делать это просто как надо этого избегать в принципе потому что таких вещах просто ошибиться и ну зачем все стрелять в ногу а потом голову а ну то есть получается мне чтобы отменить запрос мне надо прям со в самой же функциях но в первом этой программе не смотреть вопрос уже улетел запросу же влетел да ты просто не обрабатывающего ответ вот и все это вообще ну да но опять же 523 запрос подряд идут первый прошел обработан а второй ты не отослал тоже сработало отмена после подойди я покажу например да спасибо за доклад в принципе большинство вопросов которые мне были уже задали вот остался такой вот технический по поводу обработки ошибок я так понимаю у вас идет просто обертка на обертку или есть все таки какой то вот набор обработчиков которые вот вы в один закидываете aberdeen загадкой ну подход с декораторами он чрезвычайно универсальная показывал вариант когда мы берем всю страницу целиком оборачиваю ну не то что сами не мешает никто не мешает взять я беру кусочек вот конкретно сочи который отправляет данные пользователя на север обёрнут декоратор который перехватывает стандартную ошибку пользователь ввел что-то не то и он сразу это сам конвертирует в другое исключение ошибка форм р стране ошибка форма а это исключение стандартным образом запихивается в star то есть там можно бойлер kate снизить до такого размера такого малого количества что вы просто пишете вот функция которая общается с сервером вот у нее там какие-то ошибки происходит вот значит один декоратор будет такой тип ошибок обрабатывать он значится медиа другой декоратор другой тип ошибок обрабатывать вот так это бернулли бернулли обернули товаре театре все возьми запустим не и все больше не о чем думать не надо его спасибо еще вопрос по поводу работы с нелинейными сценарием то есть если вот рассматривать пример вашего приложения мы видим там довольно линейный сценарий что вот in the country а если соответственно нас происходит какое ответвление там сад и какие-то ещё дополнительные линии вот mute первый путь это когда вам нужно нужен фоновый процесс который постоянно на всех страницу что-то делает например что там сервером синхронизирует давай честно его запускайте самом начале он будет висеть и ждать каких-то событий в канале в своем вывода канал можете что не бросить чтобы сказать давать там возьми паузу на две секунды или что это такое то есть его канал коммуникации нижний мир это будет специальный канал который вы можете своими бросать и он будет работать все время пока пользователь находится нашем приложении но этот вариант он плох по умолчанию тем что он сложность увеличивается он теперь чтоб моей как работает страница надо голове держать что там фоне чего-то там есть а если таких много а если их намного вертолете неприятные вроде как ставить вредно но тут опять же тот над которыми говорил дает второй вариант второй вариант он такой вы делать все то же самое но только в одной своей песочница маленькой и как только пользуйтесь страницу уйдет все это исчезнет а это позволяет при разработке других страниц вообще об этом не помнить не думайте не знать и вот это вот это очень важно то есть все так же в этот процесс просто да там какая-то инициализация потом а теперь запустим не через форт запустим не еще одну нашу программу которая будет параллельно а вот а запустить еще одну но теперь если родитель будет остановлен то эдак сага позаботиться о том чтоб остальные тоже были остановлены и в этом поэтому удобство заключается спасибо от меня валерий зовут вопрос собственно тоже про ошибки как происходит восстановление насколько я понимаю ваших примерах у вас сценарий в основном доработали вызвался вот это оберточка и она стоит передала там ошибки нет ни компонент компоненты и просто нарисовали мне как идет обработка то есть это где-то вверху превратил обработчик и наши шаги они как бы прервались как мы возвращаем и мы не возвращаем ты сделал а если те варианты которые я показывал они предполагали что у нас яратам глубоко-глубоко возникла исключительно ситуациям и сгенерирует исключение но начал всплывать устройство слайд и каждый рассказал всплывает вы можете написать свой обработчик специальный кастомной чем за этим исключением сделать его проглотить а можете не писать он всплывает дальше это что я показывал это штука который позволяет сделать универсальный обработчик на случай если никто его не перехватил если вам нужно что-то специально это вы перехватываете вот там где знаете чистим делать а вы не пробовали делать такие штуки чтобы наверху это все ловите потом пытаться не частота с точки зрения архитектуры это самоубийство не надо так спасибо за доклад что с перформансом вот эти вот миллионы крокетов они же по идее должны очень плохо влиять целом вообще большие функция носить практически здорово тут трагичный ракет и ну во первых когда траки чите написаны вы их уже не видите для вас просто декоратора обернуть обернуть и вернуть они перестают смущать вот но если по сути то какие примеры были заказ не найден авторизация протухла ключ что-то сломалось все терзает почему сервера пришел ответ а там сказано что форме ошибки пользователь ввел вот все что я перечислил это не то что случается по 10 раз в секунду это то что случается там ну раз но 2 может быть за жизнь одной странице и все это исключительно ситуация потому называться исключение вот случай если вам нужно что-то обрабатывать очень часто то механизм заключение очевидно вам не подойдёт но давайте конкретный пример рассматривать а мужчины в целом же хром он не очень хорошо вроде как оптимизирует или вообще даже не может оптимизировать тот код который написан средства там всякие хорошо когда вас беспокоит производительность вы чего делаете вы или профайлер am пользуйтесь или можно по старинке ищите те места которые в цикле в исполняются много раз вот эта штука нацики не исполняется хорошо она все настолько хорошо что я вместо react использую view джесс и там все сделано до безобразия просто при любом изменении история перерисую ся при любом вообще но смысле этом не отлавливать и специальные события там и единственном скульпторе select для того чтобы пересчет среза сторону происходил быстро и при каждом при каждом изменении история он перерисовывается и она работает безумно быстро ну то есть от просто незаметную моментально вот но и при этом с исключениями ни разу не были проблема производительность так что скорее таких проблем нету чем не спасибо итак временно вопросы вышла евгений выберите три вопроса поднимался тот вопрос не помню как зовут а там где про да про ридак сага как их правильно готовить на таити так был еще там вопрос да и вот здесь вопрос понравился до сего имен не помню приношу извинения с тем очень туго"
}