{
  "video_id": "QT1yDL-L0t4",
  "channel": "HighLoadChannel",
  "title": "TDD: когда нужно и, самое главное, когда не нужно / Павел Калашников (SimbirSoft)",
  "views": 5269,
  "duration": 2564,
  "published": "2018-01-16T13:08:12-08:00",
  "text": "Меня зовут Павел Калашников я Руби разработчик компании Soft Сегодня я хотел бы рассказать вам про разработку через тестирование СТ D and development перед этим перед тем как я начну У меня вопрос кто слышал про эту штуку отлично Ой какая классная аудитория кто использует её регулярно Или постоянно То есть у кого она грубо говоря в продакшене назовём это так вот ну вот Не ну есть у кого-то Да ну и ну собственно аудитория соответственно понятна перед тем как перем как докладу пару слов о себе почему это рассказываю у меня немного опыта у меня 5 лет опыта коммерческой разработки Но чем он интересен с самого начала опыта коммерческой разработки используют так или иначе ТДД почему это так Ну попал сразу в компанию которая это делает пришлось научиться сразу же и в итоге применял или не применял ТДД к разным проектам что я тоже считаю результатом вот в течение этих 5 лет это порядка проектов собственно вкратце для напомню О чём собственно Что такое ТДД ТДД - это когда мы сперва пишем тесты потом пишем реализацию соответственно мы написав тест получаем прогоняем их получаем красные потому что нет ни реализации ни интерфейсов ничего Потом мы делаем реализацию достаточную для прохождения тестов тест у нас становятся зелёными и потом мы соответственно этот код факто мы получается у нас готов функционал на этом задерживаться не будем Итак все это всё знают давным давно а что самое интересное лет пять назад а Конкретно в русскоязычном сообществе появилось много адептов разработки через тестирование то есть Эти люди обещали всем что если вы будете применять это свои разработки это ускорит вашу разработку это э внесёт новые процессы и вы будете купаться в золоте А ну и лет пять назад многие компании большие и маленькие начали пытаться внедрять э разработку через тестирование свои проекты и В некоторых случаях а Да и и собственно э какие были ТДД обещания Да грубо говоря первое обещание - это было ускорение скорости разработки грубо говоря сперва говорили что будет немножечко дольше потому что будем ээ Ну потому что программисты ещё не будут привыкать сразу тесты писать а потом соответственно всё ускорится будет быстрее чем обычно А Некоторые предлагали такие утопие варианты как а сперва написать тесты не писать реализацию и показать тесты заказчику и собственно чтобы он утвердил вот кто-нибудь слышал чтобы вот кто-то так сделал вообще вот слышал кто-нибудь Да вот я ни разу не слышал но я знаю людей которые на конференциях рассказывают и доказывают это постоянно притом спрашивая у них Они говорят нет я только читал то есть ну ладно О'кей Но вариант реально классный с права написать тест и не тратить время на реализацию заказчик утвердил Ну под заказчиком Я здесь понимаю а человека который ставит задачи и принимает их то есть в случае с аутсорс - это реальный заказчик в случае с продуктовым направлением это А ну вот тот тимлид или какой-то руководитель который соответственно ставит задачи и принимает их ну и соответственно логично обещали высокое покрытие функционала тестами обещали меньше отладки что тоже логично потому что тест написано уже сразу и отлаживать не надо они са много вещей ловят сами и более проработанная архитектура приложения это так уже тоже типа должно было быть а в итоге очень много компаний подготовились что мы сейчас будем использовать Т изучили матчасть внедрили процессы и знаете примерно чем всё это закончилось а это связано с тем что ттд на самом деле нужен не всегда то есть Есть действительно проекты где ТДД подходит где Если вы его внедрить у вас разработка очень очень ускорится И вот все вот эти Обещания которые были они сбудутся действительно но есть проекты где ТДД использовать совершенно нельзя И сейчас мы поговорим о том как отличить вот эти проекты в которых можно использовать ТДД и в которых этого делать не надо Ну от слова совсем а ау Господи слуша я пропустил Опять этот слайд А и собственно испытали вот Коллеги с такими травмами испытали у на соответственно ТДД разочарование А в чём оно проявлялось А ну то есть какие были назовём это отговорки В итоге да то есть многие коллеги засор говорили что это только продуктовым компаниям доступно Ну типа логично да А многие говорили что в нашем стеке технологии нет такого чтобы спокойно писать тесты а потом удобно делать реализацию много говорили вообще это не работает это бред А фронтендер говорили что только на бкдет ветственно Ещё ещё были я слышал аргументы что в этой предметной области тоже Не сработает О'кей Но это отговорки на самом деле Дело не в этом а как я уже сказал ТДД нужен не всегда и собственно От чего зависит действительно применять на проекте ТДД или нет Это зависит от трёх конкретно вещей которые мы сейчас обсудим а Первое - это человека который ставит и принимает задачи мы его будем называть заказчик то есть дальше Вот заказчик - это вот именно вот этот человек который ставит и принимает задачи Я уже объяснил чем он отличается в продуктовом и в аутсорсе а ценности самой команды разработчиков потому что ну если команда вообще пишет тест к своим проектам то как бы она может применять ТДД если тесты писать не принято то о чём речь соответственно Какие тесты до реализации А и ответственности менеджмента потому что в любом случае когда а заказчик даёт задачу есть какой-то менеджмент который отвечает за её исполнение и заказчик первое время при разработке через ТДД не будет видеть какого-то результата в продакшене и здесь должен менеджмент за это отвечать говорить грубо говоря заказчику что пока пишутся тесты то есть здесь ещё нужна ответственность менеджмента Итак какие у нас критерии использования ТДД а Первое - это в проекте на котором он используется сейчас мы будем говорить в основном про end то есть тот самый хороший приятный Кэн Когда у нас приходит http запрос возвращается J Но по идее это применяется ещё и может применяться во всех других сферах но мы сейчас будем говорить так как у нас backend ко то мы говорим про backend а а то э первый критерий - это описанная структура интерфейсов Ну грубо говоря вот у кого во всех проектах с которыми он работает на данный момент Ну скорее всего это один или максимум два есть rest API или Jon API Вот вот используется Точно Вот А ну да и и безусловно аналоги то есть вот я могу про какие-то аналоги ещё не знать о'кей и безусловно есть коллеги у которых э ну вот вижу по глазам происходит что-то не то то есть должна быть описана структура интерфейсов либо это действительно json API либо rest а либо какая-то своя собственная придуманная зависящая от предметной области но она должна быть описана А зачем это сделано затем чтобы А когда у нас есть описана структура интерфейсов А мы в любом случае придумываем эти интерфейсы грубо говоря грубо говоря на этапе написания теста если это описанный структуры интерфейса нет и программист не знает какой будет интерфейс он и тест будет писать очень долго соответственно у нас преимущества ТДД в виде скорости разработки какой-то Там ментальной вовлечённости и так далее и так далее и так далее они пропадают программист Тит оче много времени на написание теста что не должно происходить пример Вот соответственно если у нас есть то программист всегда знает что там у него есть индекс Там какой-нибудь и так далее То есть это всё мы знаем и программист сразу начинает писать тесты зная какие у него запросы Какие зае приме немножечко ещё про другое Мне многие коллеги из тестирования говорили то что писать тесты до до реализации ещё сложно потому что А блин сложно тестировать приходящий J Ну вот это вот огромную простыню очень сложно тестировать потому что я же не буду вставлять это в код я лучше сперва напишу реализацию там у меня прилетит это Jon я его скопирую и тогда в тест вставлю Ну то есть я прямо цитирую А во всех Нормальных фреймворка По тестированию есть вот функция аналогичной которая написана здесь Match respon сма то есть Она что делает она в определённой папке находит файл candidates JS и там у нас просто в джейсоне написано аккуратненько не в коде а где-то соответственно в своём же файле Джейсоном описано А да придётся писать руками J Но если у вас есть описана структура интерфейсов скорее всего вам придётся просто его копировать из файлика с файлика то есть написать надо будет только один раз а всё всё остальное потом вы тесты будете писать очень быстро соответственно мы получаем это всё первый критерий описано структура интерфейсов далее один подход к реализации интерфейсов я дальше приведу пример с чем это связано конкретно но э Если вы работаете в рамках одного фреймворка там больше 3 лет то давным-давно знаете что в рамках что одни и те же экшены одни и те же эндпоинты реализуется буквально всегда одинаково практически Если действительно соблюдается Ну J J API на самом деле вот здесь вот то есть если в проекте есть один подход к реализации интерфейсов и что-то там отличается только по минимуму то соответственно ТДД Использовать можно во всех остальных случаях могут быть неприятные вещи я о них попозже ещё расскажу а да Ну соответственно вот я хочу обратить внимание в проектах над которыми вот конкретно Работаю я в течение 5 лет Action Show вот выглядит примерно так для разных сущностей то есть плюс-минус какие-то две строчки Может быть о чём-то другом третий пункт в задаче описана реализация то есть заказчики вот эти люди которые ставят задачи делятся на два типа Первое - это технари второе - это вот не технари технари они когда описывают задачу надо всё-таки даже если они этого не делают всё-таки просить иногда их об этом чтобы они сразу расписывали реализацию как вот описано здесь Вот потому что технари ну он понимает что что в итоге должно получиться когда он там пишет bending endp То есть И что мы здесь видим почему это важно для ТДД а потому что кажд потому что у нас каждая строчка это фактически получается а отдельный тест простите два теста то есть один тест на сакс то есть на успех и один тест на негативный результат Вот и мы когда начинаем реализовывать задачу сразу пишем сперва два теста Про первую строчку про Вторую про Третью и так далее и так далее и так далее соответственно опять тесты пишутся быстро и мы получаем главные Профит А ну естественно можно писать не два теста можно писать там на один на позитивный результат и там 10 негативных - это тоже собственно вариант потому что разные негативные варианты возвращают разные ошибки Вот соответственно просить если у вас руководитель техна ой заказчик Простите технарь ставить его задачи Вот именно таким образом чтобы а была описана была описана грубо говоря реализация и Б чтобы он сразу так сказать показывал вот такие вещи вот как здесь допустим сразу вот запрос http указал в задаче очень удобно было Вот как раз вот как раз на этой задаче было очень удобно это сделать И соответственно в критерии когда надо использовать это я сразу это вот вкратце перечислен то что я говорил до этого это не взаимо заменяющие критерии это не взаимодополняющие Но грубо говоря Если у вас есть большинство из них можно использовать ТДД точно и будет Профит Давайте повторим в проекте чётко описано структура интерфейсов J API API в проекте однотипный подход к реализации интерфейсов заказчик ставит задачу описывая в ней Ну тут тоже интерфейс хочу обратить внимание то что здесь вот мы говорим вс-таки о кде здесь немножко нде тоже потому что Ну это тоже важно и я вот приведу ещё пример почему это важно задача ставится в стиле одна под задача один тест Ну то что я говорил Ну либо один либо два теста на позитивный и на негативный вариант в в вашем стеке технологии есть высокоуровневый фреймворк условие не обязательное но в каждой популярной технологии Тем более на которой зарабатывает в Кэн есть высокоуровневый тестовый фреймворк То есть я вам сейчас их Если вы меня спросите А вот в этой есть вот там какой-нибудь в Джаве есть я не отвечу но есть это гарантировано 2017 год на дворе Почему условие не обязательное Ну потому что не мне вам рассказывать потому что тесты должны быть абстрагирование от реализации по сути если в нашем стеке технологий нету тестового фреймворка на котором мы можем тестировать грубо говоря в этом же языке программирования на котором проект написан что нам мешает взять другой язык программирования чтобы он просто дёргал опиш ему какая разница ему Какая разница что под капотом А и соответственно нет отдельной команды qa А я я этот пункт ещё обсужу ниже Так ну это вот опять же скажу это вот тоже должно быть здесь написано необязательное условия не знаю почему я не написал нет отдельной команда qa Это тоже не обязательное условие безусловно дальше А ну вот соответственно про qa А в методологии написано что программист должен сам писать тесты зачем чтобы у программиста перед реализацией появилась какая-то ментальная вот связь задачей грубо говоря то есть я сам по себе знаю на самом деле было несколько раз когда ты пока пишешь тест написал тест один позитивный написал негативный потом думаешь Ага а ещё может быть Вот этот кейс Ещё один тест написал потом ещё один кейс и так далее и так далее В итоге у тебя там уже всё протестировано всё продумано а бывали кейсы когда вообще начинал писать тест Ну там грубо говоря на каком-то высокоуровневым ДС Да начинал писать тест Ну и просто понимал что задача какая-то и и обращался вот к заказчику с вопросом а это нелогично там не должно быть такого кейса это не работает это никому не нужно и и были случаи когда заказчик Слушай точно да и задачу либо переделывали либо отменяли и такое было поэтому в ТДД важно чтобы программист сам писал тесты Если у вас есть отдель кэйи И тем более кэйи автоматизаторы вот у нас в компании таких есть их 60 человек а один из главных профитом ТДД соответственно Уходит потому что по идее эти тесты должны писать щики вот поэтому Если у вас на проекте есть отдельные щики то они скорее всего должны тестировать после конкретной вот там конкретный продакшн йн и так далее а Вт их впутывать не надо то есть тест тесты и тесты в ТДД и тесты для щиков - Это совершенно две отдельные истории Не пытайтесь это путать хотя хотя А есть в терминологии ТДД так называемое я не помню как по-английски Но в общем приёмочный их заказчику эти тесты написали опытные кэйи которые могут вот миллиард кейсов сразу расписать Ну О'кей Ну какая-то подозрительная схема на самом деле но вот я вот я ли считаю что мешать это всё-таки не надо а когда ТДД не нужен То есть сейчас мы с вами поговорим о критериях когда реально ТДД не нужен некоторые критерии которые сейчас буду говорить они исключают сразу же Ну они являются обратной противоположностью критерий который я описывал до этого ну чтобы так сказать мы с вами подробнее всё это разобрали Итак а Первое - это задача без должной проработки а соответственно в чём у нас прикол tdd Мы сперва пишем тесты Вот они у нас красненькие да потом пишем реализацию достаточную становит зелёными тесты Видно вам да что там написано Да видно Ну должно быть потом соответственно Фактори и показываем заказчику заказчик говорит А я не это хотел задача была не должен задача была без должной проработки и заказчик говорит я не это хотел хотел вот чтобы было по-другому в итоге мы переписываем тесты переписываем функци реализацию и снова Фактори то есть в случае если в случае если бы у нас был заказчик который прорабатывает задачи то у нас вот последних трёх строчек не было Но если вы работаете Ну вот такой заказчик так сложилось который не прорабатывает должным образом задачи они к вам приходят сырыми Да есть вариант что после реализации заказчик скажет я хотел не это то ТДД лучше использовать не надо вы будете два раза делать ненужную работу потому что Вы сперва напишете одни тесты потом ещё придётся переписать другие тесты В таких случаях ТДД на самом деле ни капли не ускоряет разработку а на самом деле её затормаживает ещ то есть надо помнить о таком заказчике Если он если вам с ни приходи а да простой пример который был собственно в жизни был заказчик ну говорит мне нужна форма регистрации Там миллион короче полей плюс надо добавить аккаунты социальных сетей и ну собственно и всё то есть вот так была поставлена задач Мой коллега Ну взял эту форму полностью сделал вот на одной странице поставил эти кнопочки авторизоваться которые просто соответственно обновлялись там ну там обновляли страницу возвращали обратно и авторизовать в социальных сетях ВС нормально логично работает как бы сделали то что попросили Да и он сперва написал тесты под это то есть эта штука сперва там тыкала вот вот в эти инпуты потом эти инпуты появлялись собственно тесты проходили всё было хорошо собственно отправили заказчику он говорит Ой а я хотел трх ступенчатую В смысле сперва фамилии имя потом аккаунты в социальных сетях потом соответственно ещё там дополнительные поля все всё ровно все тесты которые написал коллега пришлось удалять Но они были про одну страницу вот а здесь уже Три разных страницы уже переходы надо отслеживать уже надо какие-то там возвращения обдумывать то есть и в итоге коллега потратил гораздо больше времени а учитывая что полей было очень много времени было потрачено Ну неимоверно для такой задачи Поэтому если вы работаете с заказчиком и в вашем случае задачи до программиста доходят Не проработанным ну не надо всё-таки использовать Ну на свой страх риск в любом случае потому что заказчик может сказать я хотел Не это а дальше когда ещё не надо использовать ТД когда есть сложные вычисления В чём суть в том что когда мы пишем мы должны соответственно сделать какой-то вызов функции запрос что угодно и сравнить его с каким-то ответом уже которые есть у нас в случае со сложными вычислениями мы Ну не можем получить ответ заранее Потому что эти сложные вычисления ещё не реализованы то есть в голове там эти слож вычисления сделать не можем в этой связи написание теста до будет занимать очень много времени потому что ну Вам надо придумать как написать этот тест чтобы он был адекватным ну и собственно причина это сложно предсказать результат и дальше идёт всё остальное многого времени уходит на написание теста а здесь лучше писать тесты после То есть когда вы реально реализовали функционал а он вам возвращает какой-то ответ и вы этот ответ просто скопировали ну там в каком-то одном кейсе или в наборе кейсов и соответственно тест у вас сравнивает с каким-то результатом а в итоге это получится быстрее Ну и ТДД здесь не будет мешать Потому что его тупо не будет а простой пример вот Поднимите руки те кто делал систему бизнес Intel Нет никто не делал вот да вот Ну что это такое вкратце это когда заказчику нужно огромная там админка в который Миллион всяких графиков по огромной базе терабайт в 40 и эта штука считается это вот эти графики они считаются не в риал тайме они соответственно там по какому-то по какой-то крон задаче считаются Каждые сутки то есть и писать тесты для такой Ну вот для Что такое Всё хорошо да Да это что-то из прошлого Судя по всему да О'кей А вот и писать тесты заранее до случае с такой задачей когда мы просто ну огромное количество данных надо обработать Ну это сложное вычисление Да это будет очень долго то есть я в итоге мы Кстати вообще ту систему бизнес intelligence которую я вот сейчас вот вспоминал у себя в голове Мы вообще тестами не покрыли потому что пёс её знает вообще они заказчики сами не хотели что сами не знали что хотят от этой системы мы-то откуда знаем что они хотят вот поэто там писать тест переписывать их потом Тем более они были сложными мы вообще не стали покрывать эту штуку вот поэтому в случае с системам бизнес Ну аккуратнее на самом деле мне кажется эта штука там неприменима всё-таки про безопасность Я никогда не занимался проектами связанными с безопасностью Ну то есть грубо говоря там дальше там обезопасите запрос какой-то параметр ставили потом накрылось я Даше безопасности нено а читал то есть читал связывался с коллегами общался сказали то что в случае когда нужна серьёзная безопасность банковские системы и так далее а серьёзные требования к безопасности ТДД тоже сложен потому что ну тесты не могут ещё покрыть так сказать вот эти кейсы связаные с безопасностью здесь нужно участие человека Вот и поэтому применение ТДД Ну как-то вот в общение с коллегами Мы решили что Ну неприменимо по крайней мере кейсов мы таких не знаем если узнать кого-нибудь такого Ну обязательно пообщайтесь с этим человеком и можно вот у меня контакты взять Я с удовольствием с ним тоже пообщаюсь очень интересно что же там как же это всё применяется Но вот насколько читал насколько знаю не стоит Итак ТДД не нужен резюмируем когда заказчик ставит задачи без должной проработки когда реализуется незаурядный функционал и реализуется функционал связанный со сложными вычислением Это я одно и то же имел в виду в итоге а реализуется функционал связанный с большими нагрузками Ну я не описывал вкратце но здесь тоже понятно то что когда у нас мно много данных ну в тесто окружения их совать что ли то есть тоже очень сложно предсказать заранее и реализуется функционал связанный с безопасностью cy pas D development что это такое очень много таких проектов бывает вот в моём опыте их было достаточно много а мы сейчас говорим о проектах Вот именно О том самом приятном ламповом бэнде Когда у нас есть просто запрос и просто J возвращается J возвращается по J API и всё у нас хорошо И на самом деле разработка одно удовольствие в таких проектах благодаря tdd можно применять Copy Pass Drive and development А что соответственно мы делаем вот допустим у нас есть уже проект какой-то работающий в нём есть эндпоинты связанные Ну крут реализованный к Create read update Delete связанный с юзера там с какими-нибудь моделью Post и так далее и так далее вот нам надо создать модель candidats вот которая у нас была да модель candid что мы делаем мы копируем тесты в копируем тесты юзеров просто в новый файл меном эндпоинты и названия сущностей это две команды соответственно просто там делаем замену на C прогоняем тесты они у нас упали естественно потому что нет реализации копируем реализацию переименовывать название сущности в реализации напоминает две команды виме прогоняем тесты Они у на зены ише дорабатываем нам делаем нужно Вы скажете А зачем здесь ТДД здесь можно просто реализацию скопировать и всё Ну я бы два раза подумал перед тем как копировать реализацию без тестов то есть и здесь ты сразу копируешь тесты потом копируешь реализацию там там по-любому что-нибудь упадёт то есть ну реально маленькое что-нибудь упадёт и ты это заметишь и сразу же пофиксите сно И что самое главное для каждого эндпоинт вот в самом начале проекта написать огромный пул тестов Ну просто там я не знаю вот опять же на один позитивный на 20 вот в ито в проекте в котором это использую там на каждый пишется Примерно 15 тестов на оди 15 тестов 25 у нас уже 1000 с чем-то тестов Вот почему Потому что я просто их копирую В итоге и вот собственно потом дорабатываем напильником делаем какую-то логику но скорее всего она Если действительно правильная архитектура приложения там поработать придётся немного и недолго были такие йс Благодаря этой шту Ко когда передо мно Т зада сонно пой кру для Лой новой сущности я делаю за 10 минут и вот и вопрос говорить менеджеру что я так умею или нет Вот потому что в следующий раз онн задаст логичный вопрос Ты что опять за 10 минут не сделал вот поэтому Ну грубо говоря вот делал за 10 минут Ну и минут 40 пил кофе чтобы потом не дай бог не прилетело вот ИК сло всякий г использовал это конкретно примени к проектам которые полною удовлетворят все критери там и Jon IP должен быть и вот и заказчик должен быть классный технарь там задача расписывать и всё такое только тогда это применимо во всех остальных случаях это уже на страх риск а почему-то перед словом команды бук ой цифры два Нет это интересно Куда он пропал ладно А вот и вот и соответственно это можно реально применять то есть то есть это очень классная система и Ну на самом деле благодаря ей вот у мене конкретно Конкретно хватает ещё работать над своими проектами потому что создание там для своих маленьких проекти проекти ков вечером новой сущности это 10 минут и там мне никому врать не надо Я сам себе заказчик Вот это экономия времени А время - это наш с вами главный ресурс Коллеги и за него за него нам и платит дальше папам это о чём хотел рассказать да соответственно помните говорил Я не знаю почему эти слайды оказались здесь Но помните говорил о том что реализация интерфейсов долж быть однообразной да то есть связано с тем что действительно разработчик должен знать что у него будет в коде реализации уже знать на 90 там 99% вот даже если такого функционала нет это не простой там взять что-нибудь да по параметру ID но он всё равно должен знать остальные 99% Что является таковыми Вот соответственно Я вот здесь вам хочу продемонстрировать вот у нас контроллер у него есть два эндпоинт собственно даже если если вы не знакомы с рельсами Я думаю Тут и так по-человечески написано всё понятно в шоу Мы ищем по параметру ID в в Create мы создаём если у нас создался успешно мы редирект на на собственно User pef если не создался рендерить формочку обратно с ошибками естественно вот тест прое написан тоже вот так вот Я за что Люблю рельсы за то что Ну действительно всё написано по-человечески и А вот возвращаясь к тому что утопий вариант тесты показывать заказчику Но вот в случае с этим Ну если заказчик англоязычный Ну типа Можно он заказчик может спустя там какое-то время уже привыкнуть даже к синтаксису потому что ну смотрите написано просто по-английски просто нижним подчёркиванием из двоеточием иногда ну скобочки убрать можно их здесь просто оста поставил чтобы это легче было читать то есть это реально можно показывать заказчику А и такие тесты пишется очень быстро при том Я хочу обратить внимание что у нас дальше идёт candidates вот и всё то же самое написано к слову я даже в этой презентации специально специально заменил просто ctr нар чтобы вот показать то что это я даже что даже благодаря ТД можно даже в Google презентации копировать всё очень быстро Окей когда я обычно рассказываю про ТДД мне обычно коллеги двист Ну и коллеги из начинают говорить что Ну вот у на чтобы написать много писать всего это очень много времени уйдёт и в итоге решил в конце рассказать про очень удобный стек который может быть абстрагироваться этому стеку в принципе наплевать на чём написано ваше API это рубины стек соответственно на выбор один из трх фреймворков Мите и кукумбер огурец Вот это библиотека кото реализует пат фабрика Girl Ну или какая-нибудь другая Там они ещё есть но Factory Girl самая надёжная и соответственно selenium poter gas или Phantom JS То есть вы все знакомы с этим кто-то что-то слышал про последние строчки точно и почему-то у меня здесь не добавлен ну здесь стоит ещё добав добавить Chrome headless Который совсем недавно У нас появился или Хроме он headless Я не помню не подскажете нет а а ну а то есть оба поддержит Всё я потому что иногда слышу Chrome Иногда хромиум думаю я что-то путаю всё ну ну да значит здесь Chrome headless Вот кстати разработчик Phantom JS когда узнал то что вышел chome headless написал в своём Твиттере я бросаю phantoms Так что не использовать phs Подержи его поддерживать больше никто не будет Ну это так Вот соответственно у нас получается что мы можем я конкретно вот сегодня коллегам рассказывал вот Александр сегодня рассказывал про интересную штуку которая поможет разрабатывать по ТДД Ну грубо говоря приложение Да на с вами Прим В чём трудность разработки э по tdd приложений где у нас там есть отдельно angar там в своём отдельном ангуляр проекте и отдельно там энд на каком-нибудь рельсе э PHP или чему-нибудь и Ну или чему-нибудь другому В чём собственно сложность в том что надо писать отдельно тесты и на жава скрипте и на а кэндес разные люди и Пускай сами себе пишут тесты О'кей Но а здесь тогда ещё больше коммуницировать надо потому что ну тут больше кода грубо говоря надо писать и Б А как жить к разработчикам им ещ сложнее будет если два раза повторять тесты ну и ну и тем более даже в случае если разделены разработчики то в любом случае писать два раза больше тестов надо в начале и заказчику говорить что оно будет ещё совсем не скоро вот что соответственно делать Мы со своей командой отработали действительно работающий вариант стека нурата риант стека который пот вам пить тесты на энде которые могут тестировать н на ЧМ бы у вас там не был там что угодно вообще то есть вот и более того этот стек абстрагироваться грубо говоря Вот вот этому запущенном коду если ему указать куда ему тыкаться да На какой порт вот На какой адрес ему ему Ему грубо говоря наплевать что как там реализовано он просто делает запрос понди Ну Ну соответственно Вот не надо было переименовать это там будет Get с СШ и соответственно дишни вот он просто будет отправлять запрос и просто проверять Джен к которому вернулся и всё то есть вот это в случае с эндом с обыкновенным А ну здесь я Опять повторяю что опять надо просто вот заменить название назва двумя строчками ВИ это вообще тут не должно быть Вот и п Каба и плюс там весь тот стек который написал можно делать Вот так вот то есть все поняли то что написано на Руби но скажите пожалуйста вот люди незнакомые с ру что вот непонятно вот здесь вот вот суть остаётся в чём Что мы можем писать просто тест на бэнде вот тестовое окружение у нас будет запускать наше приложение всеми его микросервисами со всеми фронтами и так далее и соответственно тестировать сразу со стороны пользователя грубо говоря что здесь написано пользователь посещает страничку с адресом opportunities кликает на кнопку на которой написано должно быть вот прямо вот New Opportunity заполняет поле у которого Ой а это если написано name у него значит этот промт заполняет поле с промпто name Вот и заполняет его фразу New Opportunity соответственно заполняет следующее поле и кликает на кнопку то есть всё эти тесты могут писать и Эндер и фронтендер одинаково То есть им действительно Ну тут тут не надо знать какой-то особый стек тут тут не надо знать в синтаксис Руш или какой угодно это действительно работает и мы сейчас пытаемся наших фронтенде пересадить на это полностью пока они пока сопротивляются но я думаю что это всё что что что скоро Начнут работать по этому стеку Поэтому скажу так у нас в команде когда мы начали это использовать действительно работать по сложных проектах Когда у нас там есть вот на фронте ангуляр или какой-нибудь реак с редк сом и так далее стало гораздо легче Почему особенно СТК разработчиком Почему Потому что тесты все в одном месте они запускаются все грубо говоря одной командой А у нас есть одна точка истины Что самое главное у нас есть действительно одна точка истины Когда у нас изменяется требования к проекту изменяется API изменяется интерфейс и так далее нам надо фиксить тесты в одном месте и самое главное эти тесты они действительно они абстрагирование от реализации настолько что они смотрятся у нас со стороны пользователя То есть им действительно вот ну пофигу и для них Главное чтобы была веб-страница на которой можно что-то делать Поэтому вот с таким стеком всё это разработка ТДД действительно приносит все те самые преимущества с которыми мы можем купаться в золоте конкретно вот в нашей команде это получилось вопросы Уважаемые коллеги я вроде бы постарался это побыстрее так Вы обещали носить микрофоны да я свой не отдам Спасибо за доклад У меня даже не вопрос небольшое дополнение потому что про безопасность Вы как-то очень Лихо мне доводилось да заниматься парой проектов связанных с безопасностью Я что имею сказать что во-первых прекрасно ложится на ТДД даже если Вы посмотрите на криптографические алгоритмы у них всегда есть тестовые вектора по которым вы проверяете что ваша реализация Она действи считает во-вторых потому что Ну вот например мы писали н с шифрованием и Представьте у вас весь протокол зашифрованный и вся база зашифрована и цена ошибки очень высока То есть вы не можете потом зайти в базу и сделать там апдейт например всем если там данные попортили потому что там мусор Ну с твоей точки зрения вот поэтому там тесты они прям роля бегают то есть Т плюс Безопасность это работает да да ну смысле было полно всякой зарой бизнес сообщения всякие скрытые румы Ну то есть в этом смысле это обычная бизнес логика которая точно также покрывается тестами Ну вот да Я скорее всего Вот про это вот говорил про проникновение про Я не особо Вебер Я про xss не могу ничего сказать Ну да речь шла в большинстве большинстве случаем о вебе конкретно Потому что есть такие проекты где 80% времени уходит на кейсы которые вот коллега сказал Вот у меня первый вопрос я правильно понимаю что под сум теста почти всегда тут имеется в виду функциональные или интеграционные А да имеется функциональный интеграционные Юнит тесты в плане ТДД Ну да просто такие вот обычно ТДД иногда пытаются Ино к Юнит тестам применить ни в коем случае я если я этого ни разу не сказал Прошу прощения Да лучший идеальный вариант интеграционный функциональный Ну вот вот вот вот вот вот и второй вопрос там вот все тесты были очень простые А если там сложная бизнес логика особенно связанная с предыдущим стейтон реальной жизни функциональные тесты почти всегда на довольно сложный предварительный стейт ориентированные вот что там делать и как Ну то есть явно Вот то есть Обычно когда Джи висты говорят что им сложно писать Юнит Юнит тест они м тут про это что мне чтобы написать юнитест надо поднять базу заполнить её дампов там с миллионом записей потом начать собственно сделать поднять ещё 10 серверов десяток сервисов а потом уже запускать тесты Но вот тут вот как понимаю библиотечка Тут не не спасёт тут нет а тут уже разговор о другом вот конкретно если у вас действительно вот с микросервисами там надо какую-то тестовую базу Да Ну То есть Вам надо вот то есть у нас конкретно настроен докер для тестового окружения То есть у нас тесты запускаются в докере там ну с их ментом там все то есть вот вот так вот это будет работать то что вы говорите если постоянно базу заполнять Если всё делать это ну это это ус какой-то другое да Угу Всё спасибо да спасибо за интересную както изложение рассказ а вот могли бы небольшую предысторию дать как вы к этому шли Что по дороге пробовали Почему в итоге остановились на tdd И что там как бы какой наибольшей сейчас у вас есть Профит от этого И почему его будете продолжать дальше использовать и там не знаю какое время вы его Точно будете использовать там Чего ждать чтобы с него потом дальше уходить либо может как-то изменять Ну я в самом начале доклада сказал что так получилось что мой первый опыт в коммерческой разработке был в компании где т ой простите было по просто ну серьёзно старшие коллеги сказали вот только так то есть Поэтому пришлось учиться Я даже более скажу Так что когда пришлось столкнуться с проектом где ТДД использовать нельзя Это был определённо даже какой-то ну разрыв шаблона то есть что-то такое потому что до определённого момента первые года полтора в вся коммерческая разработка Вот честно моём опыте была именно чере через тестирование это вот ответ на первый вопрос на второй вопрос Пока Я работаю в вебе то есть да Пока Я работаю в не собираюсь уходить от ТДД если когда-нибудь сменю на если когда-нибудь сменю сферу разработки сферу деятельности там уже сяду и буду разбираться подходит ТДД к моей нынешней сфере разработки или нет в вебе я писал как оно подходит у нас Back соответственно вот в случае с вем описали в случае с десктопов работает пока в вебе буду использовать и тогда может быть что параллельно ещё смотрите может какие-то новые есть Вот или не знаю конкуренты подобного подхода либо там какие-то изменения то есть вот как ну что-то на рынке с этим происходит или ТДД он в принципе один такой иго Главное что с ТДД происходит на рынке это как я сказал Опя в самом начале все об этом знают но никто не использует вот что с ним происходит поэтому как-то не сильно что-то меняется так ещё вот вот у Александра вопрос да спасибо за доклад Я случайно забежала не ожидала тебя увидеть я хочу вообще Full Stack на No JS А поэтому мой вопрос будет больше Ну вот касаться Наверное фронтенда мы действительно сегодня с тобой обсуждали вот это вот тестирование на эту тему и у меня вопрос Ты говорил что вы хотите перенести всё это На кнд А как с действительно Юнит тестированием в фронтенде потому что Ну понятное дело интеграционные тесты - это классно Но сейчас с логики на фронтенде тоже на самом-то деле и как бы её тоже иногда нужно тестировать Ну мы когда сегодня с тобой обсуждали вот собственно я и позвал тебя это обсудить потому что вот этого вопроса мне не хватало в чём дело у нас к сожалению Ну вот ребят с которыми я это обсуждал не было супер Ну вот Супер прокачанный фронтенде это в основном были молодые ребята и вот этого вопроса никто мне и не задал то есть я вот до сих пор на него ответ не знаю можно даже обсудить сейчас но на энд мы юнитест не пишем на самом деле то есть у нас на вот на текущих проектах которые иду Т реально Юнит тестов нет ни одного Почему Потому что мы решили что будем все юзер кейсы прописывать в интеграционных тестах как я говорю У нас на один endp 25 тестов Ну и пока то есть Пока нет потребности в Юнит тестировании то есть проблем с этим нет Если когда-нибудь понадобится тогда будем думать а вот по поводу фронтенда там скорее всего нужно Юнит тестирование учитывая особенно в rest API когда собственно тебе приходит пачка данных и тебе нужно их как-то немножко преобразовать чтобы показать пользователю Ну и оперировать потом в удобными ми именно привязанными к интерфейсу какому-то конкретному Да и учитывая как на компоненты всё там разделено Да вот это вот это интересный вопрос на самом деле надо вот подумать теперь будет пообщаемся тогда пообщаемся тогда это интересно Я возвращаюсь А как писать тбд который посуди функциональные тесты там где функция зависит от внешних подков которые нельзя замокать ну а приведите пример когда нельзя замока платёжная система внешняя где документация Категорически не соответствует реальной жизни собственно такна всех Ну да то есть ну вот в этом вопросе здесь Здесь есть очень важный момент то что с платёжными системами вообще писать сразу реализацию и тыкаться вот в эти ошки это опасно то есть в любом случае надо попробовать замокать да и ну мы встречались не с платёжной системой встречались с другим сервисом который это сервис был связан с организацией временной регистрации в Соединённых Штатах Америки есть сервис я не помню как он называется уже забыл Но вот там один запрос стоит 20 долларов стейн у них нет Прочитав 2 с по страницы ПДФ документа мы поняли что там чего-то не хватает Ну что Ну что мы сказали заказчику то что это сложно будет Ну то что это будет опасно сейчас нам быстро сделать и ме обща с саппортом этой прекрасной организации после долгого общения с саппортом пока они нам не подтвердили всё то есть и даже более того нам спустя полтора месяца предоставили возможность там сделать несколько запросов которые вот там пометили бы как не оплачиваемые Вот и здесь надо превозмочь вот это безус ну они не знали то есть мы действительно разбирались вме с ними тог на сервисы которые шлют SMS например и дался трафик потом на основе этого трафика писался МОК Ну да он не всё покрывает и Да они меняют потом IP но но в любом случае у нас как бы нет мока мы можем получить МОК и потом уже написать тест к чему я собственно веду что на самом деле функциональные тесты как единственный вариант меня просто очень смутило Потому что есть некоторые сценарии которые функциональными тестами не покрываются вообще там любой нормальный кон гонка рейсинг там по базе данных на Большой нагрузки Ну вот вы не про большие нагрузки я говорил то есть вот Ну вот Ну даже не большие нагрузки а случайные нагрузки да то есть там не столько про проблемы сколько про то что оно мягко говоря неустойчиво то есть что как пот ДД не решает проблемы с неустойчивыми тестами с гзн багами Ну вот честно скажу у меня таких кейсов ещё не было задача вот случайное нагрузки покрывать не было Я думаю у меня будет это когда-нибудь и это тот редкий случай когда в бэнде приходится Юнит тестами Писать много хорошо Я те я тепер буду ждать встреч с этой штукой так о Всё я я же правильно вижу то что рук больше нет да Всё спасибо Уважаемые коллеги идём пить да"
}