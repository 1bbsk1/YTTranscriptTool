{
  "video_id": "B6r20LBrvYw",
  "channel": "HighLoadChannel",
  "title": "Обнаружение аномалий во временных рядах / Павел Филонов (Лаборатория Касперского)",
  "views": 8362,
  "duration": 2697,
  "published": "2018-08-16T04:38:21-07:00",
  "text": "уважаемые коллеги и друзья нам дают разрешение на запуск с очередного доклада меня зовут паша филонов я тружусь следователем данных в лаборатории касперского и сегодня я бы хотел с вами обсудить те вещи которые волнуют меня очень сильно последние годы вот лично меня волной две основные вещи это рыбалкой обнаружение аномалий если я правильно угадал конференции сегодня мы были говорить о обнаружение аномалий они другой и здесь я сейчас сделаю вот первый следите за руками магический фокус смотрите я сейчас постараюсь 35-40 минут говорить о вещи которые не буду давать определение почему ну что сколько определение вы не будете пытаться дать аномалии скорее всего однозначного с которым все согласятся и все скажут это именно она вы не найдете но я буду отсылать так сказать к вашему личному опыту что наверное каждый для себя лично в какой-то свои задачи может предположить что такое в его данных в его ситуации в его проблемах это возникновение к этой странности аномалии чего-то нового чего он раньше не видел если у вас такого вот звука не возникает сразу то смотрите на эту картинку вот красная рыбка это в некотором смысле аномалия который здесь присутствует конце конечно я не буду говорить об абстрактных аномалиях я буду рассказывать конкретно про ту задачу которые сейчас занимаюсь последнее время это защита объектов критической инфраструктуры и об связанной с этим обнаружения аномалий в многомерных временных рядах это были если конкретно но перед этим для того чтобы немножко попытаться структурировать вообще говоря как мы будем вести наш диалог сегодня ну сначала я буду рассказывать потом вы не надеть будет задавать вопросы я бы хотел вспомнить такую заветную мечту ну на мой взгляд любого инженера когда вы сталкиваетесь какой-то задачей желательно как можно меньше придумать нового и желательно как можно лишь больше взять готового потому что мысли люди ну вот лично я по крайней очень ленивый я очень не люблю придумать что-то новое я люблю чтобы я чуть было не дали инструкцию сказали делать так делать два дела и 3 вопрос хорошие инструкции ли плохая пример плохой инструкции может быть вы знаете называется как нарисовать сову когда сначала он показывает шаг номер один рисуем два круга а потом вам показывает шаг номер два рисуем все остальные сову вот мне бы не хотелось чтобы сегодняшний мой рассказ был похож на эту инструкцию поэтому я воспользуюсь немножко другой по сути мы с вами пойдем по вот этому вот кругу гуляя в разных направлениях круг это такая характерная картинка которая часто встречается в разных задачах по анализа данных черточки это быть не должно не обращать на нее внимание и по сути она описывает некоторый процесс шаги некоторого процесса под которой можно как под гребенку подогнать в принципе очень большой спектр задач по обработке данных и получения каких-то выводов в том числе я постараюсь подогнать задачи обнаружение аномалий под вот такой вот процесс и мы пойдем потихонечку по каждому шагу первое о чем действительно многие забывают и на что я рекомендую всегда обращать внимание перед тем как решать любую задачу где там надо нейронных сеточек получить еще чем-то заниматься нужно пойти пообщаться с бизнесом и спросить вообще у вас есть ли у вас проблемы если у вас есть проблемы можем ли мы их вам помочь решить вот этими нашими всякими странными новыми непонятными технологиями если мы будем возвращаться к моей области это безопасность объектов критической инфраструктуры то там действительно у бизнеса есть проблема она такая в каком смысле заезженная вот надпись главное на слайде stax на этот очень заезженный пример главреда который был обнаружен много лет назад и полностью проанализирован у которого есть одно очень неприятное свойство в отличие от классических зловредов которые обычно любят красть какую-то коммерческую информацию или любят делать так чтобы сайтики начали медленнее работать или наносит другой вред такие системы способны наносить физический вред то есть разрушать физически разрушать какие-либо установки обычно самая главная область подвержены такого рода таком это различного рода производства энергетика нефтегазовой промышленности мической промышленность металлургии и так далее то есть это разговор про борьбу с системами которые целенаправленно созданы на то чтобы наносить физический вред подобного актом за счет чего конечно как мы понимаем почти все современные виды производства не управляется автоматически они управляются через специализированное аппаратное и программное обеспечение которое естественно создано людьми и содержат какие-то проблемы уязвимости которые можно эксплуатировать эта проблема проблема бизнеса бизнес хочет найти решение этой проблемы чтобы таких ситуаций которые описаны здесь и отсылки которые есть низу слайда на подробные обзоры что вы такие ситуации возникали или меньше или как-то нивелировать их риски тогда мы пойдем к следующему шагу этому круга и попробуем понять а какими данными мы будем работать когда будем пытаться защищая защищать объекты подобного типа для этого нам нужно рассмотреть какой-нибудь достаточно важное производства с технологическим циклом каким-нибудь конвейеры подобным с одной стороны можно рассмотреть такое это прошлый век как вы понимаете сейчас все выглядит немножко по-другому и наверное лучше один раз увидеть чем десять раз услышать поэтому я просто запущу короткий видеоролик и похода в немножко его прокомментирую это вот компьютерная модель к просто удобной визуализация какого-то объекта химической промышленности на котором происходит разные технологические процессы я к сожалению не большой специалист по химии я знаю что здесь что-то вариться в реакторе смешиваются разные газы под действие температуры происходит какие-то интересные реакции образуется новой смеси они попадают систему конденсации который разделяет газообразный составляющая jitka образных составляющих попадает равной системы стратификации которые продолжают разделение фракций для того чтобы выделить собственно целевую все это циркулирует таком общем цикле и естественно этот процесс нужно полностью контролировать поэтому он полностью обвешен различными датчиками сенсорами которые стараются фиксировать давление температуры уровня заполнения тех либо иных систем и систем управления например здесь это управление вентилями подачи какого газа подавать больше какого газов подавать меньше опасность при работе с такими объектами изучается в том что в обычном режиме с ними все хорошо но если услу мышь на кае стиль направленная задача нанести физический вред этом объекту то как показывает практика это действительно возможно сделать здесь слава богу эта картинка которая демонстрирует чистую теорию но за счет того что отключаются некоторые системы некоторые начинают вести себя не так как ожидалось допустим у них просто подменяются данными с которыми оперируют что-то может пойти не так в данном случае уже срабатывает какие-то лампочки которые над предупреждаю такой до плохой ситуации к сожалению здесь еще по сценарию отключена система правоте вареной защиты поэтому все становится очень плохо не надо считать что так происходит всегда в реальной жизни здесь конечно картинка немножко утрированное но опасность остановки производства за счет чего потеря но достаточно большого объема средств вот это вот реальная опасность которой надо бороться каким образом такие ситуации которые здесь изображена и желательно видеть как можно быстрее как только что-то начало идти не так как только возникла какая-то аномалия в данном случае завод начал вести себя не так как он ведет себя обычно он явно выходит на какой-то непонятный режим и стандартный для него вот это момент времени надо пытаться обнаружили как можно раньше и чем раньше нам это удалось тем больше у нас горизонт принятии решений для оператора уже надо ему что-то сейчас остановить или надо срочно отправить бригаду ремонтников или предпринять какие-либо еще день действия для того чтобы ну да такого уже не довести если в говорить немножко более формально это просто картинка эта симуляция но что приятно это simul занятно симуляции на самом деле для стоит реальный компьютерный движок который во первых рисует замечательной картиночки во вторых обсчитывает всю химию физику процесса поэтому значение всех показателей допустим температура давление уровня заполнения можно действительно посмотреть во времени в динамике и вот говоря временной ряд я буду подразумевать вот такие графики здесь их нарисованы всего три потому что все не вместились на самом деле для большого объекта их может быть тысячи и даже десятки тысяч это сразу намекает что скорее всего человека 1 2 даже 10 посадить следить за всеми невозможно обычно на подобную производства saka самые критические показатели выводится на панель оператора и он за ними следить любопытно можно ли используя остальные данные которые обычно не видны сразу на панели также помогайте ему находить странности аномалии отклонения и может быть даже быстрее чем они про проскользнуть на основную панель то есть опять-таки расширяя ему этот горизонт принятия решения скажите а кто-нибудь видит здесь странность в этих данных поднимите руки вот что интересно не все видят действительно нужен какой-то глаз который желатин должен понимать что там происходит на самом деле здесь идет небольшая атак а вот в этот интервал времени когда я сейчас его нарисовал видно что что-то там как-то не и сломалась немножко пошло не туда куда ожидалось где-то стало чуть больше чем было где-то чуть меньше чем было любопытно что не все подняли руки то есть даже не тренированный человек некоторые такие вот типа аномалии во временных рядах может не увидеть глазу особенно если они вот так десятками перед ним ползут часами часы за часами то есть нам явно нужно здесь помощь помощь какого-то маленького робота который будет во первых не лениться и все время пристально следить за всем потоком данных во вторых у него будет столько глаз сколько таких графиков нашей системе у обычного человека все два глаза вряд ли может конечно можно слить больше чем за двумя графиками но вот за сотни наверно уже не уследит желательно чтобы робот мог уследить за всем вот такой пример данных который нам предстоит работать и вот эти вот окошке а точнее конечно самая левая граница этого окошка это те интересные моменты времени который мы будем искать давайте пойдем дальше мы поняли как выглядят данные это такие временные ряды точки теперь если мы говорим про какой-то машин learning или да это майнинг нам нужны сами данные много чем больше тем лучше давайте я немножко расскажу про то про какой набор данных мы конкретно здесь сегодня будем вести речь это набор данных называется ценности из man процесс datasette теннесси это вот географическое место где предполагается находится модель вот завода 3d реконструкцию которую мы только что видели и мы с нашими коллегами использовали эту модель она хорошо описано все физические и химические процессы хорошо описаны для создания компьютерной модели который позволяет стимулировать данные в любом количестве и для нас самое важное позволяет взрывать его когда нам это удобно как вы не догадываетесь для реального объекта позволяйте его взрывать нам не позволят поэтому для того чтобы проверять работают ли вообще методы которые мы разрабатываем которое про беру им нам конечно не жду немножко синтетические данные при этом мы должны накладывать на себя некоторые дополнительные ограничения чтобы когда мы попытались это системы принести в живой мир она продолжала работать чтобы например не требовала три раза взорвать что-нибудь только потом работает об этом будет видно и сама структура данных первый у нас это слизь о составить примеры этих вот данных каждый пример это вот такой многомерный временной ряд размер 159 то есть него 59 графиков это на самом деле считается достаточно маленький объект по своим размерам длительность одного примера 120 тысяч точек это пример 120 часов это такой характерный прогон завода от началом его старта до того как он вышел на слой стационарный режим выборка обучающие на которой буду показывать примеры это 438 вот таких примеров таких запусков и здесь очень важный момент на него хочу обратить отдельное внимание мы предполагаем что в обучающей выборке у нас anomaly нет действительно 0 для реального объекта не ну не разумно требовать чтобы там обязательно были плохие данные обычно как вы на догадываетесь все хорошо в этом есть некоторая особенность интересно этой задачи которые отличают ее от классической задачи обучение с учителем когда у нас есть много примеров 1 класса много примеров другого класса здесь мы скорее говорим о чем-то типа 1 классовым обучение а вот для проверки нам как раз вот этот трюк компьютерной модели нужно потому что там мы можем симулировать как хорошее поведение так и плохое и проверочное множество сайты 406 подобных примеров часть из них по-прежнему хорошая для того чтобы проверять что нет сильно большого количества ложных срабатываний часть из них плохая и как раз вот в плохой у нас прям есть окошечке на которых происходит что-то странное ну предполагает что злоумышленник каким-то образом прошел через систему защиты и начинает модифицировать уже внутренние рычаги управления пытаясь расшатать объект и вывести его на режим сожалению который уже невозвратный по каким-либо причинам общий объем ну на мой взгляд достаточно небольшой распакованы видит 75 гигабайт поэтому мы с большим удовольствием с коллегами даже этот деэссер сделали публичным если пройти по ссылкам ниже наверно самая вкусная часть будет для людей которые занимаются анализом данных в этой области когда я начинал работать я не смог найти вот аналог подобного пример в открытом доступе чтобы было много размечен ago и прям по моей специфики поэтому если кому интересно ссылочке ниже приведут вас к тому чтобы эта дата секс скачать а мы используя его как основу для обучения основу для проверки наконец-то дойдем до того что обычно почему все начинают это с этапа моделирование а нет я решил проскочить его наша один шажок почему потому что я не хочу сейчас говорить подробно моделирование до того момента пока мы с вами не договоримся а цели цель неформальную мы уже озвучили нам нужно пытаться обнаруживать эти атаки но скорее всего методов обнаружения будет больше чем один если мы хотим выбрать из них какой-то в каком смысле лучший нам нужно их уметь сравнивать какой лучше какой хуже а для того чтобы уметь сравнивать нам нужно как можно более простая шкала желательно одномерное одно число поставить соответствие методу допустим чем больше число тем лучший метод работает на этой на этих данных чем меньше число теме тот хуже работает на этих данных если для каждого метод это число высчитать выбор становится ли настреляли давайте поговорим об этом числе как раз в контексте задача раннего обнаружения аномалий тоже ничего не придумываю просто используя готовые подходы достаточно на кстати недавно описанная этот подход подробно описан в так называемом момента а нам ли benchmark для того чтобы измерять алгоритмы раннего обнаружения одному алей давайте попробуем протестировать идею как он работает вот этот вот шкала пусть у нас есть наш график я нарисовался лишь один есть какое-то окошко помечены здесь с пунктирными линиями в процессе которого как раз и происходит что-то странное есть такая вот аномалии на этом интервале времени и дальше мы должны наш алгоритм должен называть точку времени момент времени когда он считает что что-то пошло не так и за каждую точку времени мы ему можем давать какие то очки или штрафовать давайте посмотрим как предлагают авторы на мента на мели скоро штрафовать и награждать алгоритмы построен в такую кривую которая от -1 до 1 и понятно чем она больше тем награды больше чем на меньше тем награды меньше даже отрицательно можно считать штрафами и посмотрим какие могут быть точки ну например алгоритм сказал вот здесь проблема но очевидно что он ошибся никакой проблемы там еще даже не было она ещё даже не началась поэтому с какой точки зрения можно сказать это ложноположительный срабатывания фолз позитив он ошибся лишний раз выкину красный флажочек лишний раз разбудил людей штрафуем его за это данном случае напустим на минуса единичку дальше если он попал в окошко здесь любопытный факт что можно просто его награждать всегда единичкой а можно до награждать чем он ближе к левому грани где тепле гайка левой границы то есть чем раньше тем лучше поэтому здесь награждаем и очень высокой наградой 0 и 3 девятки если он дважды указал в окошке ну наверное 2 просто неинтересен втором мы будем просто игнорировать оставим только самый лучший результат если же он говорит уже про за пределами окошко здесь тоже есть свои нюансы последствия аномалии вот этих вот окон они могут еще длится какое-то время к тому же алгоритм может быть тормознутый то есть он отдает ответ чуть позже чем реально что-то произошло ну при этом он угадал примерно что было что-то но не успел мы вас оштрафуем конечно но не очень сильно ну если ты уже совсем совсем совсем далеко от ситуации котором было интересно штрафуем его прям как фосс пусть получается для каждого примера мы можем посчитать сумму вот всех вот этих точек которые нас там возникнут понятно что для каждого примера вот это окно anomaly одно а например фолз позицию с то есть точек которого все за ее пределы может быть много то есть если алгоритм плохой у нас будет очень часто будет по ночам это плохо если алгоритм хороший он будет выкидывать красный флажочек только когда действительно что-то происходит и чем раньше вот обнаруживать тем лучше вот в каком-то смысле придуманное но такая логичная разумная метрика которую вот мы посчитали с коллегами достаточно адекватной для наших задач со всеми остальными примерами можем поступить просто мы просто миру им по всем примером и дальше для того чтобы полученная шкала и число представил было проще трактовать проведем небольшую перри нормировка переформируем результат 0 до 100 100 это вообще идеальный детектор то есть водка только что произошло в сразу этот момент сказал все и никогда ничего лишнего он не говорит 0 это так называемый 0 детектор это тоже алгоритм он имеет право на существование которой никогда ничего не детектирует и дальше нам интересно будет располагать какие-то алгоритма в этом интервале и вот здесь как раз мы наконец-то будем говорить о моделях моделирование и конкретно подойдем к авто энкодером что это такое это один из приемов организации вездесущих нейронных сетей которые вообще говоря неплохо себя раньше зарекомендовал в обработке картинок идеи его достаточно просто он состоит из двух частей это кодировщик еда кодировщик энкодер и декодер его задача чем-то похоже на такой сжатие с потерями задача энкодера взять исходную картинку любой объем данных и сжатие в меньший размер задача декодера взять этот уменьшенный размер и разжать ее в оригинальную мы с вами прекрасно знаем что в случае когда у картинок есть какая-то структура который повторяется то горит мы сжатие для них работают хорошо алгоритмы сжатия с потерями еще лучше любопытный факт то что за счет того что мы заставляем вот этот вот алгоритм обучаться на разных данных у него возникает интересные свойства он например начинает учиться учиться хорошо сжимать и разжимать только эти данные которые видел то есть он не тратит свою энергию на то что вы учиться сжимать и разжимать и данный который никогда не видел потому что мы можем его еще ограничивать допустим в той мощности которой он обладает и он будет чисто пытаться за точится под нашей пример под нашу обучающую выборку в данном случае и как тогда мы можем его использовать для того чтобы обнаруживать какие-то конкретные аномалии допустим мы берем нашу обучающую выборку только синий рыбки только хорошие примеры и учим на каждой рыбке этот кодировщик он учится сжимать рыбку и разжимать и обучили после этого подаем хороший пример но он таких или близких к этим много видел и скорее всего ну и как практика подтверждает действительно он очень хорошо ее раза жмет мы можем например как-то сравнить две картинки пока вам это расстояние и посмотреть насколько картинка исходно отличается от результирующий и вычли тикают ошибку восстановления насколько хорошо он восстановил данные если это ошибка маленькая наверное он такой пример хорошо ржал значит наверно он его видел скорее всего это пример характерны для обучающей выборке если же мы возьмем другой пример который он раньше не видел тут кстати anomaly 2 порядков вот кто что красная все заметили а кто заметил вторую аномалию она смотрит другую сторону это тоже может являться некоторым факторам скорее всего для таких примеров ошибки восстановление будет очень плохой он все равно и сделать синий ну ладно может быть она будет смотреть другую сторону но действительно восстановлена изображение ну или какой-то объект будет очень не похож на свой оригинал то есть высокая ошибка восстановления и есть конечно это гипотеза всего лишь это предположение о том что наверное вот этот объект как-то сильно отличается от всех других посмотрите на него подробнее обратите на нее пристальное внимание то есть по сути является таким фильтром через который пролетает много рыбок и он задерживает только подозрительных позволяй конечно уже людям разобраться непосредственно в том то не видит а все остальные через сеть и спокойно проходят дальше вот эта идея но этот идеи на рыбках давайте посмотрим примеры еще не столь близкие к реальной задачи но как-то хоть связаны с временными рядами например пример который можно подготовить очень быстро и продемонстрировать косвенное того что технология работает для временных рядов возьмем синусы очень просто сдвинуты по фазе то есть обрезанные в разные куски и будем учить такой кодировщик эти синус восстанавливать что очень интересно здесь 50 точек basics of a сжимается все в 4 то есть коэффициент сжатия больше 10 из вот этих четырех точек потом разжиматься назад вести ну вот на этом интервале как мы видим для хороших примеров вот именно таких примеров его учили только немножко сдвинутая туда-сюда работает он хорошо внизу красная изображен окрас ошибка восстановления ну просто среднеквадратичная ошибка для каждой точки восстановления она какая то внизу колеблется ничего интересного не представляет собой если мы начнем вносить разного типа аномалии самый просто это какой-то выброс кстати обрати внимание этот выбор сделан специально чтобы его амплитуда не превышал амплитуду синуса поэтому простейший алгоритм который просто горит все что больше единицы это аномалия здесь бы не сработал в случае же авто энкодера для такого простого щупа он очень быстро его находят действительно он не знает что это такое он не умеете и восстанавливать он установить его как умеет а умеет он только синуса и тогда наши при восстановлении тот момент видеть очень характерно ну выбраться это наверное самое неинтересное в обнаружение аномалий все-таки по выбросам вот таким кратковременным точкам уже гораздо больше интересных методов любопытно посмотреть в другие области например смена частот когда синус остается том же но мы меняем частоту и вот видно что в самом начале он еще пытается как-то его приблизить но он не умеет делать синусы таких частот поэтому он все равно выстраивает свой какой ему нравится естественно это очень не похожи на те данные которые мы подаем ошибку начинать без старости другое хитрый прием это смена фазы прям в окне на котором мы его рассматриваем здесь он вообще теряется перед вообще не понимает что делать мы подкармливать все окно он восстанавливать как умеет вот он умеет гарета умей только такие вот это вообще не понимаем получаем достаточно агрессивную ошибку прям настя на всей области естественно в тот момент когда сама смена фаз произошла на этом искусстве на примере работает вопрос работает ли на том да это с этим про который я упоминал если да то единственно ли авторинг удар можно построить оказывается что таких кодировщика fda кодировщик можно построить очень много я наверное здесь просто пожалуйста рассмотреть только несколько и результаты я опишу только до четырех которые мне показались наиболее интересными и первыми простыми в реализации для того что мы могли хотя бы для них сравнить и понять для этой задачи какой лучше всего подошел первый это полна связный это такая очень простая достаточно нейронная сеть и она схематически изображена на картинке если вы предположим с нашлось времени спускается вниз то вот эти синие кружочки входы это как раз точки это может быть одна . это одна кривулин к это может быть 59 . 59 кривулин их момент времени вне внутри мы его сжимаем в явно меньше представление то есть красных кружочков меньше чем синих а потом пытаемся рожать всё назад восстановить также как для синусов только здесь примеры пойдут чуть посложнее преимущество его в том что он очень простой это очень просто кодируется и очень просто работают по сути если не усложнять архитектуру это очень быстро работает поскольку это просто перемножении пара матриц и он хорошо работает у хорошо восстанавливает данные картиночки попозже мы посмотрим но у него есть некоторые недостатки вот первые с которым сложнее всего бороться и бороться надо только архитектурные у него скажем так пакетный режим работы то есть он должен подождать все окно данных и только с ним работать получается что если внутри этого окна что-то произошло сигнал поступит только когда окно закончится поэтому здесь очень интересно ограничение на подбор вот этих окон их нельзя делать слишком большими мы будем слишком поздно реагировать на все если же их делать слишком маленьким и мы можем что-то выпускать поэтому здесь такой вот ограничение с которым надо уметь бороться второе более неприятное у него действительно большое число параметров вот например попытка засунуть 100 точек по времени такой авто энкодер для этого набора данных приводит по моему порядка к двум миллионам параметров это считается достаточно ну не сильно много современно нейронной сети спокойно переваривать десятки сотни миллионов параметров но это все равно достаточно тяжеловесны инструмент для работы он неповоротливый он долго учиться имеет свои недостатки при хранении передачи и так далее поэтому отнесем это к его недостаткам и третий недостаток что наш плохо локализуется нам иногда важно не только момент времени ну и желательно примерно какой ряд вот у нас там тысячи вот таких рядов укажи на каком именно что-то пошло не так к сожалению структура этого кодировщика он реагирует бурно сразу на всех и локализовать конкретно где не получается хорошо неплохо получается локализовать когда ну как неплохо вот его на псков это 8 и 3 напоминаю что 0 это самый минимальный стоит основной максимальный ну то есть явно не фонтан вот пример его работы да это набора данных на самом деле аномалия произошла на самом верхнем графике вот синий это исходный зеленый это восстановленный и вот в синем был резкий выброс принципе он был обнаружен был обнаружен хорошо проблема только в том что ошибка восстановления пошла сразу по всем видам поэтому обнаружение есть ну локализация в плане она какой кривой именно что-то происходит она чуть похуже потому что ошибка восстановление по каждому ряду она достаточно большая хотелось бы конечно самую большую ошибку восстановления именно потому ряду где что-то пошло не так может быть с этой проблемой справиться его коллеги например следующий это рекуррентный авт энкодер у него чуть чуть отличается структура он не пытается взять и засунуть сразу все за один раз за один присест он берет каждую отдельную точку по времени и скармливает их в скрытое состоянии вот это вот красные кружочки как бы накапливая только аккумулятор поступает в конце такой выбрасывает весь результат то есть скармливаем по одной точке за раз и в конце выбрасывал результат для всех точек которые нас получились что приятно у него гораздо меньший параметров за счет чего вот самый простой способ это подсчитать количество стрелочек на прошлом слайде стрелочек было гораздо больше здесь стрелочек если вы подумайте просто принципиально меньше может сказать что каждая стрелочка это вот есть этот самый магический параметр чем их меньше тем какой то смысле лучше но из недостатков он тянет тот же самый пакетный режим работы он ответ выдает в самом конце значит мы должны сначала скормить все точки по времени и только в конце увидеть ответ значит мы запаздываем явно с точкой принятия решения и у него тоже проблемы с плохой локализации аномалии как и у предыдущего коллеги зато у него чуть чуть повыше на псков может быть мы можем пойти дальше и если мы сейчас изменили входной слое мы можем немножко поиграться с выходным слой частности перейти на такой который я не встречал конкретно как он описан в литературе его называй просто синхронный задача этой машинке на каждую точку входа выдать одну точку выхода при этом имея некоторое состояние накапливать его на всем окне обработки получается когда мы выдаем самую последнюю точку в окне у нас как бы есть еще память о всех предыдущих это очень кстати характерная идея для того чтобы использовать это для анализа индустриального производства почему по сути она все описывается какими-то вот динамическими соотношениями если позволите дифференциальными уравнениями которые постоянно накапливают некоторые историю по краю из предыдущего момента времени поэтому этого это очень такая интуитивная и натуральная архитектура на мой взгляд для данной задачи и у него достаточно эпохи результат во первых у него еще меньше параметров он действительно поддерживает потоковый режим работы то есть на одну точку входа сразу выдает выход можно в этот прям момент времени смотреть ошибку восстановления и пытаться принять решение и надо ждать пока дойдет до конца все окна обработки к сожалению он не вот по-прежнему плохо локализуется аномалий это вот его тот же недостаток но нам скоро у него подлетел аж до 37 это достаточно неплохой результат понятно хотелось бы 100 ну я пока таких не видел если у кого то получится при этим не мне интересно и мы посмотрим еще его собрата который близок чем-то по идеологии но немножко отличается это секта сек система которая хорошо себя зарекомендовала в машинном переводе вот имена обычно такой картинкой пытаются переводить с английского на французский и идея здесь в том что мы по-прежнему пытаемся сжать всю историю данный нам в одну точку а потом из нее рожать но последовательно то есть не за один раз выбросить сразу весь участок который мы ожидаем на выходе а точку за точками как бы порождаем ответ у него есть интересные свойства что например у нее не обязаны совпадать размеры входа и выходов что делаете очень интересно для машинного перевода но не столь интересом может быть для задачи обнаружения на молли во временных рядах поскольку мы стараемся реконструировать на той же временной оси что нам было дано изначально хотя можно поэкспериментировать зато у него замечательно с количеством параметров это наверное самое легковесная каком-то смысле но может быть тяжеловесной в плане реализации вот с точки зрения программирования наверное вот этот авто кодировщик самый тяжелый если у вас конечно нет библиотеки где он сразу готовый есть и по своим такому от качества работы по наб скор он сильно опережает допустим рекурентные тот же самый полна связаны но немножко отстает от синхронного вот обсудив немножко отличие всех этих четырех архитектура давайте попробовать свести вместе и посмотреть по вот этой формальной метрики очень удобно просто можно выстроить и все в ряд чем отдел отличается от другого здесь добавлен еще 5 он не относится к авто кодировщиком это просто базовый алгоритм ниже которая и вообще не видел смысл что-либо делать сам низу находится алгоритм который она зал мин макс он просто считает минимальный максимальное значение на обучающей выборке и у него алгоритм принять решение очень простой если больше максимального плохо меньше минимального плохо работает отвратительно но понятно что ниже такого ну просто нет смысла что-то обсуждать и вот видно как один за одним потихонечку страз тающий мощностью мы приходим к тому что для данной задачи здесь надо очень важный момент обсуди чистого для данной задачи этот результат имеет место я не исключаю что если подать другой задачей другой области либо даже другой набор данных хотя мы тестировали на разных наборов данных на самом деле вот это вот табличка на более-менее стабильно хотят циферки начинают немножко ползать то синхронный кодировщик оказался самым приятным впечатлением формальной метрики но и лично для меня он приятный с точки зрение потоковый режимы работы его очень просто реализовать не в пакетном режиме в потоков для того чтобы он сразу принимал решение о том что что-то идет не так ну и следует дальше по вот этой вот наши съемки нам казалось бы вроде бы самое время перейти самым интересным и дипломант у но как мне подсказывает нас уже заканчивается время да и в принципе совета находится еще до сих пор в плотной разработки поэтому я думаю что это может стать темой следующего доклада следующем году так если кому интересно можно пройтись по основным источником на которой я опирался и спасибо за внимание перед тем как будет вопросы два маленьких объявления первое у нас есть целых 2 ништяка за самые интересные вопросы дается кто знать что это такое поднимите руки вот считаете что вы задали вопрос и второе меня еще очень просили для самых интересных вопросов подойти найдите путям потом меня на нашем стенде касперского у меня там есть особые призы такая замануха полная теперь прошу да за бумажки честно говорят не в курсе но хотел спросить как вы учитываете влияние переходных процессов в trainz сети и смотрите если у вас перри обученная модель а в этом случае переходные процессы попадут соответственно в хорошую так бы в на отображение вы получите их же но они же являются соответственно аномалиями и других случаях и связанные с этим вопрос пробовали ли вы lst м блоки для того чтобы учитывать вот такой момент спасибо большое за хороший вопрос даже два вопроса я с удовольствием на них отвечу почему это моя боль я много времени потратил на это первые переходные процессы они есть в обучающей выборке и это было для нас большой вызов научиться работать не только на стационарных данных где обычно все просто и может быть даже не нужно таких сложностей она учится работать именно данных с нестационарным режиме причем агрессивно нестационарным режиме периодичны и данные где при а перевода нам заранее неизвестны и если эти данные присутствуют в обучающей выборке то они хорошо восстанавливаются и они не считаются аномалиями если же конечно нам покажут переходной процесс которому мы совсем не видели раньше либо в другое время мне ничего страшного то тогда дано если они были в обучающей выборке они отработают хорошо и второй вопрос все вот связанные с рекурентные системой построены на ios темах дам вопросов а зима и александр зовут меня вопрос что быть как все таки быть с эротическими time series да ну то есть применяет на сайт регистрации кислоты регистрации мужчин женщин есть мне общее метрика регистрации так далее в я должен под каждый временной ряд имеет свою модель чтобы исключается взаимной корреляции высоко о кардинальных метрик или как или это все в одну модель скармливается момент не очень понятен хороший вопрос он даже принципиальный мы скармливать все в одну модель почему потому что мы считаем что у нас не будет этих экспертов которые нам все разделит по группам с одной стороны с другой стороны нам важной короля псы между данными поэтому мы как раз не хотим строить для каждого ряда в отдельности какая за счет этого мы теряем а вот как-то упоминали локализация то есть мы не можем понять кто именно явился первых причиной и какого-то всплеска для вот подходы с кодировщика мида для других например подходов которые мы тоже рассматриваем там локализация получше второй вопрос про если меня есть тренд данного из метрику меня со времени изменяется имею есть периодичность правильно ли я понимаю что соответственно должен регулярно защиту литника обновление моделинга есть каждый день я перри рассчитывая потому что у меня метрик какая ползет вверх обычно сданы в данных который мы работаем трендов обычно нет да они как раз квази периодическими но мы отдельно рассматривать ситуацию с трендами да она гораздо тяжелее и обычно тренды плохо описываются но мы точно поставить несколько элементов когда тренд по ним линейный простейший тренд понимается хорошо и он прогнозируется достаточно далеко конечно настанет рано ли поздно момент когда нужно будет переобучать здесь вот еще был вопрос а можно еще вопрос да что если допустим данные не временные ряды а изображение статично я хочу в нём найти аномалию допустим ну шум наложил сирикит где другие дисторсии произошли какой вот лучше всего архитектуру или методику вы можете порекомендовать в принципе авто кодировщики это хорошая идея а из архитектур для картинок традиционно все таки хорошо уложились это свёрточная сети то есть свёрточная авто encoder попробовать для картинок я бы рекомендовал начать с него а можно еще вопрос а вот они задавались вопросом вот нашли анна молева варёном ряду или там в другом наборе данных они взяли и как ли восстановить то есть компенсировать или вы ни занимались такими вопросами конкретно в этом докладе не занимались в принципе давайте так скажу не занимались вопрос вы пробовали совмещать выходы моделей то есть например вы берете потоковую модель пакетную назад уже обрабатывать с обратной стоимостью не пробовали но я хорошо спасибо и второй сдвиг то есть вы можете не каждый атом 10 минут сдвигать секунду если числитель на возможность да этот папа обычно регулировал параметра зависит от личных возможностей sawyer ну окей и третье разделяли ли вы то есть искали ли вы какие-то паттерны шаблоны то есть потому что некоторые некоторые параметры очень сильно коррелируют друг с другом это отдельные техпроцессы можем так сказать и если идет там всплеск по отдельному техпроцессу это нормально при условии что в другом месте занимались вот был замечательный доклад кстати до этого по поискам паттерн их дискретных системах но мы скажем так смогли вроде бы найти решение для одномерного временного ряда но вот обобщить его на многомерные так же легко нас уже не получилось и она требовала вот этого слишком много экспертного знания надо было бы с каждым конкретным случаем очень долго сидеть человеку чего нам хотелось избежать поэтому сейчас уже особо не рассматриваем выделение вот этих шаблонов паттернов спасибо большое пожалуйста там был вопрос скажи пожалуйста как вы работаете с категориями данными наверняка ведь у вас зато сетах они постоянно попадаются и избавиться от них невозможно поэтому вы должны это учитывать хороший вопрос спасибо вот про тот набор данных которая сейчас рассказывал там нет категорий ных данных про тот других которым мы работаем ну вот часто мы работаем еще с сетевым трафиком там мы делаем иногда очень глупо байтик и байтик вот от 0 до 200 55 и самое что смешно и иногда это работает лучше чем подбрасывании монеток но конкретно вот в этой задаче там все веществ назначенные данные или по-крайней мере булевы 01 и там просто category in их не было спасибо за такое два вопроса построить маленьких собственно 1 прогуливались taking моделей то есть наложение результатов в общие модели объединения вот а второй пробовали ли вы подозреваете так архитектура обучение во время использования то есть что есть у нас сменился паттерн сменилось общая картина чтобы этого чудилось спасибо первое нет не пробовали почему я считаю был получен результат и они того не стоят они на чуть-чуть увеличивают точность но сильно усложняют система для внедрения второй ответ нет не пробовали on-line learning потому что мы считаем он не всегда хорошо как раз описывать переходные процессы именно переходных процессах когда выходит из стационарного режима и это нормально такой может быть иногда часто могут все равно быть сбой здравствуй вопрос получает как раз где-то равен 75 до мы смотрели они работают на том наборе данных который приложен сразу в моменте и это обычно одномерные и без переходных процессов то есть обычно такие стационарные полу стационарные процессы с резкими выбросами это раз поэтому вот конкретно их алгоритмы нам не подходят для этого и второе у них как раз больше on-line learning потому что они по моему имеют первое окно такой раз гоночная потом сразу входит в режим обучения сказок пробовали но для наших просто отвратительно результат наши в то же время и наши методы к их мы тоже не пробовали потому что скорее все там мы получим обратить на результаты за очень маленьких объемов обучающей выборке то есть немножко разные данные спасибо большое за давайте последний вопрос у нас вроде есть время до собственно метрика получилось там лучше лучше модель 37 на вот этого начались бизнеса спрашивают какая проблема из теперь как объяснить что это вообще за цифра как она годится для производства или нет хороший вопрос возможно бизнеса не стоит ли показывать почему потому что ее нужно объяснить тогда как вы понимаете от половину народу сразу может может уйти попытки это объяснить это раз второе оно получено на синтетическом наборе где есть размеченные данные у клиента его набор данных и там нет плохого поведения если мы для клиента бы могли на его наборе данных показать это значение тогда бы наверное мы смогли объяснить смотрите вот хорошо работает но я думаю что для конкретного живого набора данных где нет например аномалий я только хорошие примеры такой метрику во-первых нельзя посчитать и тогда наверное и не стоит использовать как весомый бизнес аргумент мы иногда экспериментируем собственно с переносом берем вот эти симуляции из разной природы это раз и у нас есть второе направление мы пытаемся именно смотреть то что мы можем для каждого набора данных выяснить это такую обобщенную ошибку восстановления то есть насколько в целом эти данные хорошо реконструируются вот это можно сделать на любых данных и на симуляции компьютерных синтетических и на реальных и вот дальше есть гипотеза что если это мы там хорошо идет реконструкция и в одном случае неплохо идет обнаружение аномалий то слабо гипотеза трудно подтверждаемой но что и в реальности будет идти хорошие обнаружение на моль но я согласен что использовать это число как бизнес аргумент я бы не рекомендовала это скорее такой внутренний технический инженерный способ понимать мы правильную сейчас ручку подкрутили или неправильно спасибо большое я думаю что все вопросы были хорошие поэтому кто вот в поисках вот таких штучек вот подойдите вот здесь я буду стоять пока и спокойного мы все наклеим спасибо"
}