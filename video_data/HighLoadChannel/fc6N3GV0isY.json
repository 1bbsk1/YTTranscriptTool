{
  "video_id": "fc6N3GV0isY",
  "channel": "HighLoadChannel",
  "title": "В Tarantool 2.1 появилась поддержка SQL: подробности / Кирилл Юхин (Tarantool)",
  "views": 1042,
  "duration": 2957,
  "published": "2019-05-15T02:48:36-07:00",
  "text": "меня зовут кирилл и же про поддержку sql в tarantul и зачем до чего доехали такое по старой встречи вас замучить уже второй день пошел 4 часа осталось два доклада потерпите вот ну давайте тогда начинать соответственно на прошлом наверно хайло ti или нет я не точно не помню и рассказывал про то что мы добавили искали в альфа-версию тарантула вот соответственно на днях у нас у нас выходит бета-версия и по сравнению с альфа версии вот у нас изменения добавились мы добавили и скальную консоль вот мы наконец-то сделала сделали строгое типирование как нам всем известно а античная сколь строго тикированный язык не имеем права общем создавать колонку стефом текст и вставлять туда интеджер и очень наоборот и вот вещи на подобии того вот мы заметно улучшили интероперабельности слов что это такое и зачем это нужно я расскажу немножко дальше на слайдах вот включили наконец-то вчера все необходимые constraint и триггеры в общем то они чувствовали как работают еще мы сейчас более менее в состоянии бета-версий то есть мы в общем то с вещами закончили я имею тарантул версии 2.1 и теперь будем в общем-то работать над стабилизации с целью с целью это дело выпустить в качестве релиз версии где-нибудь ближе к концу этого года вот соответственно какие у нас были цели когда мы занимались в общем-то за не начинали делать поддержку sql в таранто ли во первых у нас как вы наверно знаете вы все знаете что такое скурили да и что такое до родов да ну большая часть хорошо вот общем тарантул это в основном у memory решения о той вскоре это такая штука которая позволяет очень хорошо манипулировать с данными да в отличие от не а вот это тоской нло это язык сугубо императивные в общем-то и выборки по данным делаете не очень-то удобно там у меня будет дальше мотивирующий слайд я в общем то покажу вот что еще еще мы вообще хотели все-таки большинство современных фреймворков они пользуются es que el более того низу чаще всего пользуются всякие melody бесси и g9 драйверами и чтобы повысить доступность в общем-то тарантула для таких вот фреймворков мы решили сделать тоже как бы es que el их ним общем-то приделать 9 9 9 драйвера вот соответственно также очень хотелось бы добавить возможность что вот тарантул можно было прямо сделать в качестве дроп--ин replacement а для какой-нибудь современный собой не займу сколь какой-нибудь или под газ просто взять и заменить то что большинство интернет-страница нетривиальная несложные общем то база данных подними лежит обыщи не очень сложные в общем то мужчина если какими-то совсем экзотическими возможностями этих судьбы данни пользоваться то можно в общем то и заменить никаких проблем нет вот и соответственно в конце концов мы очень хотели добавить в общем-то консистентной самом широком смысле потому что изначально изначально тарантул него интерфейс на язык луи в общем так из case set насти у неё это чтобы проблема там они не так уж в общем то разве ты там утопало может быть совершенно разное наполнение общем то нет внешних ключей нету constraint of типа человека прочее прочее вот это все мариша общем-то пытаемся решить в 2 версии тарантулы который общем то планируется поддерживать es que el вот ну соответственно картиночка сока система у нас тут центре о бибиси надо же что-то положить это рядом и не нашего просто и конкурсы девисе в общем-то это эти два драйвера позволяет включить целую кучу разных фреймворков общем-то у нас уже есть работающие odbc driver но он так условно достаточно работающие вот эта продукта еще надо везти вести но тем не менее вот у на сумму осилили в общем то его включить там подключить как его microsoft access увидеть там в общем то данные из тарантула вот соответственно можно пытаться это самое надо везти его думаю в общем-то стащить прод то же самое касается и то же самое касается касается g9 мы тоже общем то его планируем довести до ума и тоже где-то рядом с релизом выпустить вот не знаю насколько видно или нет надеюсь что видно здесь пример того почему но с точки зрения удобства пользователя почему мы решили делать из quelle несмотря на то что тарантул это общем-то applications сервер в нем уже есть какой-то язык язык общем-то ну можно по-разному оценивать на не такой уж он плохой вот соответственно здесь пример вы что-то и нажав здесь мотивирующий пример первые две строчки crate apple да то есть мы создаем две таблички чего там у нас три поля 44 поля первичный ключ вот и соответственно справа вот маленькие маленькие четыре строчки запрос типа select который мы бы хотели в общем-то получить да это простой join пойди одно условие нет типа неравенство да и мы выбираем уникальные значения казалось бы да с точки зрения история это совершенно простейший запрос в общем-то да проще трудно что все представить вот а слева продемонстрирован это же самый запрос написанная руками нала вот во первых надо оценить надо оценить его размер да то есть насколько почти на порядок у просто длиннее в тексте до соответственно в нем на порядок больше опечаток это но это как бы только вершина верхушка айсберга да тут надо понимать что то можно посмотреть да мы создаем сначала временную табличку для того чтобы сделать join складываем туда результат joy надо потом делаем отдельную вспомогательной табличку для результата distinct а после этого еще общем-то для результата делаем отдельную табличку понятно что память у нас не резиновая то есть лол это это таблетка таблички которые вы создаете ввода в какой момент качества в окончится память вам не известно в какой момент включится горбач коллектор тоже неизвестно да то есть вот тут целая куча целая куча проблем просто связанных с памятью но есть еще более серьезной вещью смотрите мы делаем фактически руками join в первом цикле да то есть там один for но и в дети там за кого закопан фактически другой форму там поиск по до спуск по дереву что это означает означать что мы фактически расписание исполнения запроса за hard ходили то есть мы не глядя на то какую структуру вообще имеют две таблицы т1 и т2 сказали что мы будем исполнять сначала обходить сначала 1 потом вторую совершенно очевидно что если если геометрия таблицы размер таблицы то-1 и то-2 существенно различаются то скорость исполнения запроса на будет разная если ну зависимости от того какой именно цикл мы будем прокручивать первым вот эти все вещи делает оптимизаторы планировщик es que el 99 9 в процесс в периоде в общем-то зубы д они этим занимаются датами специальные компоненты которые вызывают вскоре планер вот и который отвечает именно за эти вещи выбирать с максимальной эффективностью в общем то эти самые for a выстраивать их правильно там солвер и какие то есть все такой тут ничего этого нет вот допустим и даже посмотрели какой размер таблицы 1 это 2 но никто не сказал что эти таблицы не меняются во времени да то есть нужно меняться местами и соответственно этот цикл будущую оптимально в через год станет перестанет быть оптимальным вот соответственно такая вот гора проблем которая связана просто тем что вы пользуетесь для того чтобы оперировать данными императивный язык используете вот вы не говорите что вы хотите получить вы говорите каким образом вы хотите это получить вот чему становиться между вои как бы иску или вот так соответственно просто как мы решили делать из quelle у нас есть у нас возникло несколько вот так скать управляющих принципов которым которыми мы руководствовались но во первых нам надо было выбрать какой-то диалект хотя бы какой то понятно что все субботы имеют свой диалект es que el какой-то ближе к nsi какой-то немного дальше но все равно это в общем то все диалекта я не знаю существуют ли какие-то субботы которые полностью анти возможно эта дебита или какой-то не знаю еще что то часто вы не в курсе вот но судя по всему текущий тренд заключается в том что как бы продукты не огораживают диалекта да то есть они все-таки огораживаться фичами поэтому насколько мы понимаем большинство существующих субботы в общем то движется в сторону ansi а все новые как бы они пытаются в эти ansi и мы в общем то так же решили что лучше всего нам выйти отличными с курением вот второе надо понимать что большинство этих самых как это сказать большинство инфраструктур который реализует processing остальным запросов из куриных запросов они ориентированы на дисковые субд и что это означает в практическом плане это означает что время трансляции школьного запросов конечный план исполнения она не так уж важно если вы 10 10 миллисекунд транслируйте школьный запрос после на 5 секунд запускаете в общем-то доступ диску то в общем то него не так важно 10 там или 20 или 30 миллисекунд исполняется транслируется ваш запрос ситуация кардинально меняется если вы пользуетесь in memory технологии когда вы знаете что ваши данные хранятся фактически в и дерева и доступным сопоставим с вареньем трансляция этого запроса вот поэтому очень важным при проектировании ско или было сделать так сделать так чтобы время трансляции запроса было более-менее приемлемым хочу чтобы она была хотя бы сопоставима со временем доступа в общем непосредственно к данным ну вот и третье это консистенция уже сказал нужно понимать что у и сквере у еско или есть целый ряд различных типов консистентной стида то есть я говорю например не знаю но канал то ограничение нормальная да чек консистентной внешние ключи что угодно в текущем со реализации воину интерфейса тарантула этого всего не не существует соответственно очень сильно повышается вероятность возможность выстрелить себе в ногу то есть вы объявляете я не знаю объявляйте что текущая колонка должна быть больше 10 после этого и зло можете вставлять в общем то значение 5 6 7 а вот соответственно бы очень хотели чтобы консистентной было не только на уровне иску или но и напала на уровне лот чтобы не было никаких общем-то возможности ее нарушить вот соответственно подумали мы значит подумали и решили что нам нужно все общем-то и сразу мы сначала хотели написать и вскоре вообще с нуля но задача это практически непосильная вот ну кто читал стандарт ansi sql видео он какого размера просто чтобы оттуда вычленить необходимый fitch этот какой-то не менее мы сливаем время потратиться плюс для этого нужно очень серьезно экспертизы именно в написании разбор щиков языков программирования который нас не было поэтому решили поступить проще мы взяли очень простую зубы д оторвали от нее все укроем транслятора ну то есть разбор щека запросов от транслятора снизу приклеили тарантул вот я уже наговорил многие из вас знают что этим этой суммы до стамбула иску light слышали происходит оно все вот и соответственно тот уровень на котором она была реализованном принципе более-менее устраивал за некоторыми исключениями которые молчат пытаемся за фиксить вот соответственно что у нас сейчас есть таран плоскую или у нас есть практически полноценные транзакции с и в point и вот вообще любой формы select и то есть всех видов join июнь он except intersect sap секса кори из команд и был expressions так далее так далее соответственно все модификаторы которые нужны вы вскоре люда то есть основная идея вообще таранто вода основная цель поддержки искали тарантул это не просто поддержать весь искали лишь он огромный основная идея была в том чтобы первое обеспечить нормальное selecta и второе сделать нормальную консистентной всю как все остальные не интересует ну постольку поскольку вот в языке жестов сказал да триггеры стандартные школьные триггеры ну вы наверно знаем дальше немножко глубже на этом остановлюсь то есть там воскурили есть 2 есть два вида триггеров мы реализовали пока только один на втором этаже сделаем вот вьюшки у нас работают более менее нормально constraint в общем-то constraint отдельно останавливать колышет а мы сделали очень важное для саботаж штуку которых который тоже не было которые тоже не было потом в континентальном общем-то таранд или в основном вот mercedes немножко час а в общем то подробнее на всем этом постараюсь становиться так ну соответственно давайте посмотрим на крит и был в общем-то syntax но довольно стандартные общем-то я так понимаю 99 процентов субботы обладают этим синтаксисом да ну там я не знаю может быть у некоторых нет if not exist соответственно и такая табличку и уже есть ничего не делаем вот в улицах расписано что именно происходит когда вы вызываете такой statement такой по операторам мы создаем space соответствующим именем заметьте что по стандарту ansi по стандарту ansi именно upper коситься вот тарантул кистинцев поэтому нам приходится пиркей стиме на если они квартира ван и вот после этого создается после этого создается не именованный первичный индекс подними ногу нам понимается то что его нельзя дропнуть в общем-то только это также создается уникальный вторичный yandex потому что у нас потому что с поля помечены как уникальное вот и наверное не знаю большинство не большинство но этому что большинство из вас кто пользуется тарантул знает что не поддерживает трансакционный дрели уэйда дверь это означает что это означает что вот эти все три операции последовательно они не трансакционные соответственно если вы успешно создали space т1 успешно создали праймари индекс у вас обломалось создание secondary индекс от вас останется мусор вот то есть вас все откатиться при этом останется space именем t1 без единую а из единственным индексом праймари индекс мы пытаемся это как-то побороть час создаем какие-то списке то есть он как бы если где-то там что-то у него обламывается он пытается это делать все откатить вот по этим спискам о чем-то и идя назад но все равно это костыли мы с этим будем продолжать бороться хотелось бы конечно в итоге прийти к тому что в общем-то да дверь все же стал традиционным до чтобы если у нас не получилось создать только бы не получилось вот соответственно тут это у нас есть две колоночки до что statement должен иметь и что он может иметь он обязательно должен иметь именно колонок и имен вот он обязательно должен иметь первичный индекс большинство субботы поддерживают так называемые скрытые yandex.ru айди мы это дело не поддерживал нас обязательно нужно задавать первичный индекс в таблице вот так же мы можем разрешается иметь различные constraint и ну естественно дефолт видео про колышет не расскажу немного позже также мы добавили секунд это же автором ту автор антон версия 110 вот называется не это фича здесь называется автоинкремент дальше после того как мы создали наше соответственно space у нас как вы знаете с версия не помню какой 17 по моему возникли форматы так названо форматы то плов у space и соответственно мы можем в ло посмотрите увидеть какой формат что тут интересного интересно что поле у нас обретает имя имя и тип ну можно еще посмотреть на то что у него есть поле которое обозначает что делать что делать когда нарушается условие ну лабильности вот то есть если она нарушается то можно вызвать или в аборт либо ничего не делает либо транзакцию откатить танцы вы этот самый миллион различных действий вот дальше что такой автоинкремент на самом деле автоинкремент поддержит в тоже так у него почти во всех свободы у нас я так понимаю ближе всего к раку там можно явно создавать там можно явно создавать как же называется секунды до секунд а вот соответственно нас под капотом точно такие же секунды создаются вот для того чтобы вас плода если ограничение что у вас поле должно быть типа интеджер и обязательно это-то и секунд можно вешать только на primary key но на других свободы тоже что-то похожее какие-то ограничения вот возможно мы их потом расслабим немножко будущем он соответственно как пользоваться своем табличку помечаем поле как интеджер как интеджер primary key автоинкремент и просто вставляем туда null и эти места которые мы хотим в общем то что завтра инкремент или вот соответственно пример исполнением надо понимать как работает автоинкремент он берет текущие максимальное значение прибавляет единицу и соответственно вставляет вот смотрите то есть у нас и надо понимать что значение 101 это 100 + 1 но значение auto increment и не может уменьшаться соответственно если мы сейчас делаем тринкет таблица 1 то следующие вставленные автоматически значение будет 102 вот и до тех пор пока не переполнится 64 довольно много пойдемте дальше create index и специальный оператор который позволяет создавать не только ними новые на яндекс но и очень-то именованы индексы индексы нужны для двух целей самое главное чтобы ускорить select 2 чтобы constraints ссылочной ссылочной целостности соблюдать либо уникальности вот соответственно но синтаксис у него почти как у креи ты был соответственно у нас есть у нас есть опциональное ключевое слово uniq является ли иных с уникальным да ну и кто так здесь тоже самое что для crazy ball делает вот из особенностей как это ни странно во всех субботы по-разному прям практически 50 на 50 мы сделали как в анси имя индексы локально по отношению к ним space у таблицы то есть у нас таблица индекс именем один при этого в таблице то яндекс именем т1 при этом совершенно валина создать счет на таблицу и в ней индексы тоже с именем и один вот почему то в общем то в некоторых суббота это не так вот немножко дальше расскажу про crow про pragma который у нас есть ну для индексов мы сделали 2 pragma посмотреть какие из индекса у таблицы он просто печатает список индексов имен индексов и второе для данного индекса вывести информацию о нем вот так же к индексу можно обратиться просто и зло а вот тут вот пример вот тут пример как вы смотрим на из таблицы 2 индекс номером 1 вот он уникальный это видимо праймари ключ уникальный тип у него скаляр он почему-то ну label и значит не провели ключ наверно вот и соответственно номер фил да у него два вот дальше dml соответственно совершенно классические стандартный этот самый дома или три операции вставить удалить обновить вот давайте на них быстренько остановимся и сердце практически классический как и в любой другой судьбы д который поддерживает из ковель они довольно сильно отличаются от того что есть tarantul и как минимум в том что а там or ность она соблюдается на уровне statement а то есть вот смотрите у нас тут описан insert insert вас quelle и и соответственно внизу перечисленные операции которые делаются собственно тарантула соответственно с точки зрения с quelle а вот этот insert 3 значение 3 различных значений в таблицу это как бы должна быть атомарная операция поэтому мы неявное и откладываем tarantul и транзакции вот и соответственно если что-то из этого обламывается на откатывается от самой транзакция поэтому наполовину ставить нельзя вот какие тут еще особенности мы сделали специальную оптимизацию точнее притащили и редиску light она называется xr соответственно мы разрешаем делать insert select в таблицу но есть если у вас форматы у двух таблиц совпадают если нет триггеров и constraint и одинаковые до копирование то делается просто прямое копирование противном случае там достается то по перекодируются проверяются constraint это потом вставляется там довольно разительная разница для произ-ва в производительности и ну такая штука может помочь при миграции и впрочем всяком так что еще можно дефолт значения задавать и уже говорил вот причем где угодно вот тут есть за два дефолта значение по умолчанию вот соответствие можно вставлять значение по умолчанию просто никуда не указа некие значения соответственно здесь ставится в первом концерте вставится что у нас 666 и на а вот если после не выполнить 2 insert он просто выдаст ошибку потому что второй раз будет вставляться значение 666 вот вот такие вот у нас insert и delete на совершенно классические ничего в них особенного нету вот даже не значит он про них сказать они под vr clause позволяет исполнять практически все что угодно плюс мы сделали специальную специальный оператор он того мы есть какой-то из поздних версий стандарт ansi он называется тонкий ты был у него есть особенности во первых он очень быстрый во-вторых он не вызывает триггеры которые связаны с дилерами в третьих но это уже было в силу особенности пирантела он в силу особенностей тарантула он а он является del операциям про составляет системный space поэтому нельзя использовать внутри транзакции вот но так если принципе очень нужно быстренько очистить таблицу огромного берем просто вызываем tranque этого что никаких триггеров ничего все удаляется вот теперь апдейт нападает у нас реализован через дели to insert это это и плохо и хорошо ну минус скорее больше чем плюсов из плюсов что из плюсов то что в отличие от tarantula мы можем обновлять первичный ключ в общем то зачем это надо вопрос тоже такой не знаю не уверены что это кому-то когда-то надо а вот минусов больше мне кажется минус заключается в том что это общем-то очень сильно это очень сильно отрицательно сказывается на производительности датой чтобы обновить the pale moon достаем все значение to parse кодируем меняем потом брат кодируем иуда и вставляем обратно space это если вспомнить о том что тарантул позволяют делать итеративно и апдейты в общем то не очень здорово так что мы это дело будем улучшать улучшать и улучшать то что мы сейчас делали это в общем то просто синтаксис да то есть мы серьезный performance performance анализом не занимались вот и будем мы думаем обязательно будем заниматься со мной в общем то ближайшее время так у нас есть понятие он конфликт actions что делать если какое-то какой-то из конца из constraint of нарушается например если у вас есть constraint uniq да если вы вставляете дублирующиеся значение что делать в общем-то у нас из специальной конструкции которые говорят что делать матчем по умолчанию аборт просто стоять и cуществует мента портится исполнении транзакции продолжается также можно есть файл который более немножко более агрессивный чем аборт немножко больше откатывает там подробности кулуарно объяснить вот есть рубрику ночи всю транзакцию текущую откатывает нести гнара a statement просто пропускается replace риплейс он довольно хитрый сейчас вот я тут следующий слайд до показываю показывает в чем хитрость риплейс вот смотрите допустим у нас есть табличка в табличке два уникальных индекса первый это праймари ключ 2 в общем-то uniq допустим там изначально есть два табло 1221 и после этого делаем такой вот риплейс которые заменяют фактически нарушает constraint и в двух соседних то плах вот то есть нарушает constraint айди по первому полю для первого табло и нарушает constraint uniq по второму поля да вот соответственно что произойдет в этот случай в этом случае у нас в этом случае у нас имеется два то плана один вот это в общем-то не баг это целенаправленное поведение так что пожалуйста будьте аккуратнее с этим триггеры мы добавили поддержку триггеров триггеры как и положено и вскоре persistent они сохраняются устанавливаются вот для вьюшек мы сделали instead of триггеры то есть вы можете объявить вьюшку повесь на new in state of insert trigger и после этого общем то делать в эту юшку insert и и вместо общем-то непосредственно inserto у вас будет в общем то выполняться тело триггера мы к сожалению пока сделали триггер только for each row то есть у нас два типа существует два типа триггеров furniture for each statement хорошо восполняется для каждой изменены для каждого измененного кортежа до хочет 3 на каждый стоять над вот мы сделали пока только для каждого для каждого кортежа для statement of тоже сделаем ну и соответственно приведем пример триггер а вот создать триггер после вставки на табличку t 1 и что-то там еще вставить удалить в общем-то это не полноценный псм очевидно да ну хоть что то в общем то можно что-то еще сделать помимо непосредственно ставки так какие у нас существуют ограничения целостности всего их четыре штуки uniq not null нотном они уже есть tarantul и я на них даже останавливаться не буду у нас есть чек ограничение то практически любой школьный statement типа их больше 5 x умножить на x меньше не знаю а есть такое минус в том что мы проверку constraint и типа чек сделали пока только в лом вас коим углу еще пока не успели затащить на обязательно затащим к релизу и плюс сам главный референт шоу constraint а это форме ключи в торонто никаких форм кличей не было мое общем то их добавили а ну да вот соответственно мне про чек тут не совсем правильно 1 гулять написанных можно создавать и зла вот вызывать их а зло к сожалению нельзя вот тут пример создание зло создание constraint и типы чек ну и соответственно тоже самое только только для вас q или вот довольно полезная штука но над но я особенно не буду останавливаться тут просто приведён пример как использовать клаусу он конфликт соответственно если мы нарушаем constraint not налто общем то вызываем rollback внешние ключи внешние ключи у нас persistent на внешние ключи персистенции вот у них есть специальные разрешены модификаторы что делать в случае их нарушения там каскад restrict но экшена так далее реализовано клаус дифферент то есть проверка внешних ключей проверка внешних ключей на комете транзакции то есть мы набираем набираем изменений проверяем по счету в конце это чтобы циклические ссылки мэра продолжали работать вот и соответственно к синтаксис довольно классические так по нему вам везде одинаковый вот существует целая 4 ограничения на внешние ключи во первых во первых по полю в парадиски таблицы должно существовать уникальный индекс типа колонок должны совпадать в родительской дочерней таблице чего там еще то в дочерние таблица при создании внешнего ключа должна быть пустой но это ограничение думаю мы исполним там все вот вот что касается внешних ключей дальше alter table это такое-то дали операция на у нас сделано очень примитивно соответственно мы можем переименовать таблицу но она довольно такая не то чтобы перемешать таблица это перри миновать таблицу интеллектуально то есть вы не просто переименовываем таблицу временного все триггеры там все там он на кого она ссылается все такое так что ты ну не совсем тривиальная операция при реальная но не совсем вот и плюс маму и мы сделали специальную штуку этот constraint то есть мы можем добавлять for ключи тоже после того как создали таблицу это сделано для того чтобы сделать чтобы можно было сделать петли по вторичным ключам напоминаю что парень таблицы должно существовать на момент создания дачи на ссылки из нее за черной таблицы вот соответственно сделали специально вот такой этот constraint когда таблица создана чтобы можно было делать петли по внешним ключам ну и соответственно дроп constraint меня даже ничего и в общем-то и сказать тут у меня несколько слайдов с довольно такими нетривиальными select a mi которые сейчас уже работают учет у нас целый сьют тому не знаю это тысячи тестов и за skull это одно из преимуществ sqlite а почему взяли там очень хорошее тесто покрытие практически 95 процентов вот и очень сложный select поддерживаются вот тут у нас silex грубая есть heaven и ордер buy в общем то что у нас еще есть у нас есть сотку ирисы вот видите мы создаем два sap курия там где-то используем joy им как ты черт любой тоже делаем вложенные запросы что у нас еще есть но составные запросы да то есть у нас есть интерфекты концепта в общем-то все это есть уже сейчас работает можно сейчас качнуть гитхаба собрать и увидеть что все вот это в общем то можете всем можно уже пользоваться вот тут ещё кола и шины он парковалась с отдельно будет вот команд и был expression тоже есть тоже работает в общем то довольно модная штука вот что еще мы сделали вьюшки юшка это очень то полноценный объект он практически как таблицы toгдa oни зинич вставлять ну что такой уж кавэшка это фактически именованный select вот в общем он такой же select the конкурсе стеца вот еще раз напомню что про него при желании в него можно делать вставки если мы делаем триггер instead of inserto объявляем нами вьюшки после и можно делать ставки и никто общем-то это сама никакой не никто никаких ошибок не будет вот тут опять же пример статистика у нас работает движок который анализирует статистику и соответственно планировщик ей активно пользуются всего два уровня статистике 111 4 ст от 1 содержится шин тривиальной информацию про яндекс там типа сколько строчек какую сторону отсортированы что такое совсем что-то простой и планировщик этим принципе пользуется и более сложные называется от 4 это уже гена это уже статистике основаны на гистограмма и вот тут уже вот этот запрос который был в самом начале презентация в самом начале презентации ум как вывод на основе статистик которые собраны гораздо лучше бы в общем-то все эти все эти фары в сети циклы расставил вот но есть специальные какие-то хинты для этих статистики на них не буду останавливаться и стереться потом расскажу вот и можно посмотреть на камере план монэкс explain клэри плану в общем то пишите перед select ом и смотрите в каком порядке они у вас выстроились да что у вас как там какие временные таблички создались может быть автоматически индексы и все такое транзакция транзакция в общем то практически один mondeo 1 в 1 в 1 напиться в tarantul най транзакции даже проблемы маркиз один-в-один то есть с интерактивным транзакциям как вы знаете проблемы в консоль не имею до госпитализации в консольном режиме поэтому общем-то полис аккуратно а так все то же самое star transaction к метро убег отзыв point и все такое все эссенции нечего тут даже в общем-то и не добавишь не прибавишь колышет это очень важная штука для зубы дивана на знаете что это такое все в общем то это как именно сравнивать строчки вот мы разрешаем делать к логичны как на текстовые поля так и на выражение который фигурирует селектор по умолчанию tarantul и сейчас поддерживает река лишь она одна unicode unicode кейс intensive и баннере но баннере это просто мем company даже останавливаться не буду а вот и не код поинтереснее мы ради этого и не кода внесли в тарантул так называемой либекку это индустриальный стандарт для не кода и в общем то все сравнения которые где фигурирует конечно kalash не не код пользуются вот этой библиотекой почему она такая классная быстро и несмотря на то что это не кот не такая шина и медленная общем-то по сцене с баннере вот есть возможность создавать свои конечно но только через ставку специальной системный space но в общем то работает тоже пирсе стен то pragma эта штука совершенно никого отношении имеющий каску или просто чего людям периодически нужно всякие служебными штуками пользуются которые вскоре не очень-то покрывает вот у нас есть вот тут 4 pragmart привел в качестве примера соответственно 1 pragma это уставить движок по умолчанию как вы знаете в таранто ли два движка 1 in memory другой дисковый когда вы пишете crate требл хотелось бы иметь какой-то движок по умолчанию в каком движке он именно создает таблицу вот соответственно этим делом можно задать или посмотреть если у без аргументов и вызывайте рекурсивные триггер и соответственно являются ли 3 горе рекурсивными соответственно если у вас триггер вы вызываться триггер там мы сделали insert они знали апдейт вызвался еще один триггер от можно его вызывать или нельзя то насколько там рекурсивно он или нет можно посмотреть список внешних ключей которые заданы на субботы тоже непонятно как это делать обычно маску или и соответственно глубина и глубина join a которая разрешена сейчас по умолчанию за разрешено не более 30 таблиц joannites связаны с тем что эта штука рекурсивный там solgar который строит план запросы он рекурсивный мы у не успели сделать на основе цикла поэтому там может переполнится стык вот вот поэтому я думаю что это ограничение раз лови но если вы хотите больше пожалуйста ставьте вы значение огромным выкручивать руль и митволя в unlimited и в общем то пользуйтесь q хотите справляем вот соответственно мы добавлены бу built-in функции тоже довольно тривиальная штука из во всех базах данных примитивный riddex называется лайк длина строчки а пирло арки и сквотирования с числовые функции сложить просуммировать минимум аксиом посчитать сколько штук до средняя ранда но в общем то все такое datetime у нас типы типа datetime у нас не реализован и поэтому да и тотем нас возвращают строчки с текущей датой с текущим временем это вот тоже то на чем нужно дальше работать вот очень важная штука называется user-defined function очень хотелось бы уметь писать функции зло и вызывать их и соску или вот такой возможность уже появилась бета-версия вот оно какое как и пользоваться тут видно что fitch не доделал на посту поскольку мы добавили строгие типы то сигнатуру функции которая передается в sql стоит только из имени да то есть там не типов аргументов не тип возвращаемого значения не сдается вот соответственно эта дырка мы эту дырку тоже заткнем там будут общем-то передаваться в нормальной сигнатуры декларации функция типы данных вот эта самая главная фишка появилась бета-версии теперь нельзя объявлять колонки без типовыми или нарушать в общем-то правил типирования вот к сожалению проверки чаще всего сейчас runtime в половине случаев они runtime то есть статическое типирование подразумевается что фронтами у вас нет ошибок связанных с типами час пока не совсем так но мы работаем эту сторону и я надеюсь что к релизу мы сделаем так что или к следующему релизу делаем так что ошибок связано с типами с типами runtime вообще не будет типовых нас очень мало и фактически это там два числа blob и и текст соответственно будущем будем очень сильно развивать эту систему типов и k должно быть там на порядок больше на порядок но раза в 3 точно вот соответственно как пользоваться и вскоре сколь можно вызвать тремя способами но через бинарный интерфейс это последний будет здесь с помощью мета команды установить язык с q или просто писать и скальные команды и соответственно с помощью специальной ложкой ложь на вопи вызов books из коллег за счет просто передавая туда школьный запрос вот есть поддержка вай про то про ты наш бинарных протокол вот там тоже можно искать иску исполнять сколь ни и запросы более того там в отличие от бокса sky лексику передается чем эта информация это аккаунт ну и соответственно типа именно колонок это нужно для удивись и джитибиси интерфейсов вот чтобы они могли что-то адекватное показывать я не знаю это полностью общем-то слайд очень строю мы сегодня с утра взяли сервер вот поставили обычный тарантул apt-get install mais quel тащи мария baby вот и пропустили типе сиси на разных этих самых размеров were house of performance а у лацию мы будем делать позже я думаю что ближайшее время но сейчас это просто так вот мы посмотрели но принципе он быстрее не знаю насколько это соответствует действительности никакого тюнинга вы не делали вообще не в таранто ли не по иску или вот соответственно что на самом деле то есть и слетать в правильные руки мой сколь щик возможной вы город все по-другому вот соответственно последнее чего хотел бы сказать что пока нет у нас не сделано курсор и мы выпилили все привилегии потому что их tarantul и очень плохо ложились на тарантул там никаких ролей ничего нет ну тоже будем делать у нас нет информации ским и соответственно хранимых процедур и античных у нас нету у самое главное у нас нет вот этих вот самых крутых типов для свободы которые предназначены этой time i guess i'm all карин силла все то тут она очень нужна его у нас нет совсем вот соответственно yandex настолько бы деревья могут быть хаш индекс мы тоже сделаем итераторы только двунаправленные да никакой to overheat от бокса остался такой интерфейс описанный тоже удалим его весь нету вот частичные функциональных индексов которые тоже многие просят но я думаю что мы это тоже когда-нибудь добьем ближайшие самое время вот соответственно состоянии нас бета но у нас на самом деле не совсем бы это потому что бы это я думаю выйдет там завтра послезавтра мы всегда делали вот и кучу багов в общем-то закрыли пока делали и соответственно что мы хотим в конце иметь в конце в конце мы хотим иметь полноценный шокирующая из quelle вот мы хотим чтобы тоской на работу в кластере в шарди вот чтобы кучу диалектов поддерживал мы оставили для этого специальные закладочки ну и соответственно of ловим все пасибо ваши а мой не знаю сейчас посмотрю нет кирюхин там только есть а сейчас я у меня есть это самое ддт скакуна да да да спасибо кирилл за доклад соответственно я тут пока вы говорили много записывал сажается на попытаюсь сейчас вот все вопросы задать так если у вас метровой и как работают операторы это первый вопрос у вас нет курсоров какие операторы вы сказали у вас есть таро таро итераторы да один из предпоследних слайдов и то чего нет и лет ничего нету это него нет нет еще вот one direction iterator а этого нет вычеркиваем это хороший был вопрос так по спроси квинси но смотрите какая штука уложи тарантул он распределенной как работают sequins и дорогу сейчас не совсем распределенный он работает только на одном узле конечно как будет дальше дальше когда кардера его деятельность вот это хороший вопрос и даже не знаю но надо что-то думать да как векторный цикл стали делать это это это хороший вопрос я не знаю так у вас есть отключение конце контроля консистенции для того чтобы делать какие-то ставки мощные чтобы можно было do do do do not я по 1 уже привел там рекурсивные триггеры можно выключать например можно выключать форум ключ и вот еще что можно целый ряд программ я на не на уровне программ все сделано это то что этого вскоре никак не ложилась могут о чем-то с помощью этой вот системы рычагов и блоков смотрите вы указывали что есть два движка in-memory дисковые а планировщик как-то это учитывает к perform от самого к не занимались но обязательно сделаем чтобы эвристики были отдельной для memory естественно для движка этот посох и хорошо ну кипы это же для компактности хранения и мне ты не только для компактности это первая для скорости когда вы сравниваете короче строчку 2 скалярных типа это одно а когда вы сравните два читается совершенно другое там веток в общем два раза меньше просто на самом деле ещё такой вопрос наверное больше тарантулу то есть но насколько он компактно хранить например крайне крепок про api вы сказали что там будет один из secret и би си а вот всякие поддержки со стороны энтерпрайза типа какой-нибудь форму там типа hibernate подкрутить отвар blitz как диалект туда у вас есть такие планы но мы думали об этом но пока у нас нету сильного диман да как только диман возникнет энтерпрайза demand мы их к только возникает сразу g да да давай так не вопрос спасибо спасибо за доклад у меня несколько тоже вопросов возникло во первых по первичному ключу вы сказали что он только интеджер но не у не менее нет а первичный ключ может быть авто инкрементирование только случаев у интера все я значит война и правильно понял второе можно ли управлять sea queen сам назначением все конца в иску или нет ну вообще тарантул папа у него полноценная поддержка секретов так что если прям очень надо включаете лавра девять и последний а нет не последний вопрос когда вы рассказывали про altera я не услышал про изменение данных колонке таблицы ну то есть условно говоря изменение типа колонки вот ед implemented элементов ед и последний тогда вопрос вот сейчас вас спрашивали sequence и работают только на одном инстансе внешние ключи тоже сената же самой пойти большое спасибо за доклад и я хотел спросить про то как сосуществуют между собой мир и lua и мир сиквел а мне это интересно во-первых стратегически то есть видели вы что они будут рядышком развиваться во вторых технически ну вот особенно любопытно как это как сиквел ложится на потоку модель тарантула вот все эти замечательные in or join и пока он исполняется все остальные стоят ждут вот конечно соответственно мы бы очень хотели я уже говорил несколько раз чтобы с точки зрения системности ella es que el были как бы это самое на но ну в ногу двигались с точки зрения потоковые модели да совершенно верно тарантул это фактически 1 3 2 и более того 1 файбер на я штука соответственно пока исполняется огромный select он в общем то все остальные стоят и ждут у нас есть планы это улучшить в первую очередь потому что selected скорее все-таки review да то есть можно сделать какой такой прогорает фрака на пути тот самый этот самый select какой-то более в какой-то отдельный поток в общем то там его исполнять и разрешить по крайней мере insert и в случае винил одесского 2 шкалам нога трэйд в этом атаки правда просто нет вот здравствуйте вопрос по поводу уровня изоляции транзакций он такой втором туре но точно четыре вида есть редко метод ребят лаурид и так далее вот на виниле он этот самый и в нем все тоже сериала и забыл самых жестких еще раз какой сериала избу сериала on потому что однопоточный и конечно они обвинил тоже умею многопоточный приведу сериалах забыл аня то есть получается блоки в блокировках селектора быть нора смысла нет потому все сериала это был неверно нет ну мы может быть это подкрутим еще моды константин пришел спасибо за доклад конечная цель и запуск реальных приложений wordpress джумла я слышала уже теста и вскоре light прогоняйте пробовали прогоне теста и wordpress и джунглей мы еще не доделал и драйвер для такого состояния что шевчук прогонять но в моем видели мы открывали моим microsoft access и видели что там данные из тарантул реально возникают в общем то прямо вот выглядит как работает спасибо за доклад от у вас стран туле и зло есть на такая вещь как absurd и вы планируете как то вы скрыли засовывать taste мной сейчас и у нас своя же верю я же показал что сейчас апдейт просто позор там уделит и insert и сверху это вообще не связано эти вот вещи то есть вот переделать пути дают конечно безусловно а подскажите пожалуйста подскажите там минерал даст а это вопрос почему сразу смотри тебе это то что ему быстро смогли поставить изгибе но вскоре по x' и тория вот люди с утра на сервере мы будем мерить вам понять дело в том что performance у лацию мы вообще еще пока не делаем не занимались перфоманса в принципе вот так как ты без без без картинки совсем неудобно мы решили быстренько взять стандартную мари деби и прогнали ее степи здесь есть система уже общем-то адаптировали для тарантула для mori de пионы так адаптирован вот"
}