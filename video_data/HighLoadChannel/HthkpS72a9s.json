{
  "video_id": "HthkpS72a9s",
  "channel": "HighLoadChannel",
  "title": "Нейронные сети на страже индустриальной кибербезопасности / Павел Филонов (Лаборатория Касперского)",
  "views": 4556,
  "duration": 3482,
  "published": "2017-04-22T14:48:03-07:00",
  "text": "у нас уже как раз подходит к нужному времени чтобы ни в коем случае это самое страшное что может произойти то задержать свой доклад и чтобы следующий после тебя докладчик про тебя думал все что он только посчитает поэтому начнем сразу сориентируйте меня кто слушал доклад с утра она не очень много людей очень хорошо значит я могу хотя бы две минутки повторится все остальное будет совсем другой поэтому не уходите я вас прошу меня зовут паша фионов замечательно секция я с удовольствием послушал доклады про интересующие меня вопросы эксплуатации нейронных сетей и надеюсь с не меньшим удовольствием для вас я расскажу как применяются для решения наших задач эти технологии наверное может быть не столь много технических нюансов я дам сколько постараюсь рассказать историю как мы туда пришли на мой взгляд сейчас не стоит вот так говорить что любая задача мы соберем неровность решаем все таки за должника это процесс прихода к тому что используя тот либо иной метод я пришел сегодня ни один со мной пришло несколько помощников 1 из них зовут шелдон он очень умный он вообще по моему доктор астрофизики или что то типа того играет сериале теории большого взрыва шелдон при этом очень большой любитель по юморить я такое ощущение что многие его фразу знаменитую что все становится лучше перефразировали уже вот такой вариант потому что с разных сторон с новостных каналов с разговор о своих коллег уже с телевизора я слышу о том что применение аппарата искусственных нейронных сетей совершенно разных областях дает невероятнейший интереснейший результат я вообще я очень доверчивый человек по жизни но когда я надеваю свою инженерскую кепку и остановимся очень большим критиком и когда мне начинает рассказывать что вот это все фантастика и the silver bullet это решит все ваши проблемы меня всегда очень так и начинает отстранено я начинаю слушать и очень критично к этому относиться пока я сам не пойму не пройду этот путь не дойду до того что до это те методы это те способы эти решения которые нужны конкретно для этой задачи я не готов заявлять с ходу сходов что все становится лучше но что-то действительно да об этом в том числе сегодня поговорим и мне второй помощник это джон джон маклэйн замечательный человек примерный семьянин вроде бы из одного большой спаситель и защитник всей галактике от террористов какой-то вот кто в детстве хотел быть как джон макклейн кроме я никто да есть есть несколько человек да я согласен что между нами наверное не визуальное сходство но нет недавно мне начало казаться что мы с ним примерно занимаемся одним и тем же в некоторых вещах мы с ним коллеги в частности по моему в 4 части своих похождений джон макклейн начал бороться неспроста с террористами а самыми злыми страшными и неприятными кибер террористами там было бы фантастический сюжет что люди эти кибер террористы взломали компьютеры начали управлять электрическими сетями начали перестраивать светофоры начали управлять перегонкой газа для того чтобы что-то взрывать разрушать наводить невероятное количество разрушений конечно джон всех спас я даже не сомневался к начинал смотреть фильм вышел 2007 году конечно он был такой сказочный немножко ну и сюжет был игривый но к некоторым сожалению несколько лет спустя примерно три-четыре года начали появляться примеры того как вот эти юмористический взгляд на кибер террористов которые эксплуатировали фильме начал ходить реальную жизнь вот в центре этого слайда название зла вреда который стал известен 2010 году основной целью которого и назначением было даже нет не всегда кража конфиденциальной информации либо подобные с традиционные для зловредов сфер деятельности одно из его задачи которой входило это было эксплуатацию 2 масти асу тп систем управления технологическими процессами изменения этих процессов которые бы способствовали выводу из строя и их установок в частности именно из-за его действий по моему ядерная программа ирана была отброшена несколько назад он изменил программу технологического процесса вращения турбин обогащения урана и вывелось трое несколько из этих трубин путем эксплуатацию 2 мастифа системах брани технологическими процессами ситуация несколько раз повторилось других частях света и это стало некоторой проблемой которая начала требовать решений по крайней мере в в рамках систем защиты про конкретные объекты до которые защищают вот это было связано с обогащением урана мы можем варить и других объектах пример какой-то вот объект который мы будем пытаться защитить что-то связано с нефтью перегонкой скорее всего в судя по картиночки это объект и на него можно смотреть с разных ракурсов разных уровней разными слоями можно смотреть на уровне сетевой безопасности какие узлы с какими общаются каким можно общаться каким нельзя можно смотреть на слое то что запускается на конечных узлах что запускается на узла где работают система с и т.п. что запускается на узлах инженер ских а можно спуститься еще на один уровень как раз я работаю в отделе который занимается вот этим нижним уровнем это технологические процессы что реально происходит на объекте что нагревается где повышается давление где происходит перекачка уровней где включается конвейеры я включается реле потому что физическая атака направлена на разрушение может быть обнаружена в том числе там на одном из последних этапов и вот сбоях и атаках на вот этом уровне и способов их обнаружения мы сегодня в принципе будем говорить и говорить мы будем в контексте того что сейчас называют machine learning когда я учился мы называли это обучение по прецедентом сейчас модно другие слова ну тоже надо ими пользоваться и там есть одна проблема вот она была очень большая и она занимает на моего времени подчас больше всего это где добыть данные все нам говорят что вы все это хорошо работало и давала какие-то интересные результаты распознавать они классификации и регрессии вам нужны большие объемы обучающей выборке это вот одна из первых проблем с которой мы столкнулись когда начали думать как эту задачу можно решать допустим используя обучение по прецедентов есть реальные объекты с них есть данные записаны и но к сожалению их не то чтобы очень много и самое что для нас не удобно и в них обычно все хорошо то есть у нас нет записи данных как что-то взорвалось то есть нету размеченных данных как раз на тех случай который бы хотелось искать а это сразу говорит о том что сформулировать допустим это в виде задачи классификации будет проблематично может быть можно искать где-то еще вот немножко про реальные объекты да в чем они характеризуются у них самый интересный реальная физика это вот реально что-то происходит нагревается сливается повышается давление и выправляет реальные программируемые логические контроллеры устройство на которые как раз обычно сочетаются атаки с полнотой данных у них есть проблема там обычно столько хорошие примеры ну редко когда специально создать ситуацию когда что-то пойдет не так это очень редкий случай практически аномальные случае и в тройник да это сайтах их просто нет и данные немножко трудно добывать это такой длительный процесс надо записать как ведутся технологические процессы в разных измерениях эти данные как-то перенести то есть очень не быстро можно воспроизводить эксперимент с получением этих объемов можно пойти ножка другим путем если мы не можем сразу пытаться работать с реальными объектами и тестировать на них модели и понимать какие модели работают лучше обнаружение вот таких атак можно попробовать пойти на натурные модели это мое любимое не такие милые игрушечные сверление заводик размером не очень большим вот примерно там два квадратных метра что интересно он при этом имитирует почти все части реальной системы там есть сенсорная часть которая фиксирует положение каких-то элементов там есть управляющая часть который включает выключает реле что любопытно управляет этой схемы реальные плк программе логин программируемый логический контроллер который используется в реальном же производстве но гораздо проще что-то воспроизводить делать какие-то эксперимент вот такой вот вариант это называется а cabot обычно их использовать для демонстрации но мы в том числе используем данный сник для наших экспериментов такая вот наливайко велика стёпа течкой со своими сенсорами со своими управлениями чем они характеризуются у них конечно же упрощенная физика причем иногда совсем сильно упрощенная но там стоят по-прежнему реальные плк плохих примеров там мало почему их приходится все таки в реальном времени имитировать там не знаю что-то испортить что-то ручка придержать чтобы данный сенсор записали какое-то отклонение от обычного поведения тоже не очень быстро процесс на по камере там уже можно имитировать что-то происходящее плохо долго добывать данные имеется ввиду что в реальном времени они все работают кружева верится крутится в реальном времени если нам нужно записать данные за неделю это займет неделю что достаточно долго и можно пойти третьем путем про которой я в основном буду рассказывать сейчас это модели компьютерные а смоделировать их логический процесс динамическая система некоторые которые занимаются и нагревом какой-то жидкости и перекачки либо каким-то производством технологическим которые можно симулировать записать все данные и что сама интересно достаточно быстро вносить какие-то искажения в эти данные то есть фактически имитировать атаки такие модельки это просто визуализации примеры которые характеризуется уже следующем давних модельная физика да у них модельные плк тоже это резонно виде software to программы но самая приятная там много различных примеров которые можно генерить и там очень быстро можно набирать хорошие объемы данных которые в каком-то смысле они искусственные но если их посмотреть глазками вообще говоря инженер говорят что они очень похожи визуально на те характеристика как ведут себя системой настоящие вот очень много из того что сегодня буду пока называть как раз связано с симуляцией вот таких компьютерных моделей и на основе тренировочных множеств которые выбор который порожден и ими же вот как мы видим вот эти данные психологический процесс для нас это просто некий многомерный ряд его эволюции во времени здесь он рисовался в несколько каналов но в реальных системах обычно доходит до десятков тысяч с которым приходится иметь дело видно что есть сразу интересные свойства про котором рассказать это нестационарный ряд то есть они все не похожи на такие дрожащие вытянутые константы что-то квази периодическое достаточно сложной структуры мы не можем заранее сказать какие ряды непрерывные какие дискретные какие вообще логически какие-то из них связаны с физическими сенсорами какие-то связанные с управлением по сути на входе у нас есть только вот такой набор данных и для того чтобы хотя бы имитировать реальную ситуацию мы себя иногда говорим что учиться мы можем только на хороших данных нам некогда в реальной эксплуатации не дадут учиться на плохих данных их не будет плохие данные будет появляться только процессе вывода а тренинг должен происходить только на хороших данных то есть такая в некотором смысле 1 классовой классификации и можно назвать и вот это на уровне компьютер модели это ограничение искусственная то можно было поставить задачу более строго на можно было построить сильно задачу бинарной классификации но мы здесь больше будем говорить об аномалии detection или то что именно в сфере индустрии он называет for detection обнаружение сбоев отклонения технологических процессах как например вот в таких рядах давайте посмотрим несколько подходов на самом деле один подход уже реализован он работает имеет право на существование но у него есть свои проблемы и альтернативы по сути это подход на основе правил вот живой человек может взять и на ком-то языке закодировать правила которые вносят ограничение температура не должна превышать 600 градусов вот в этой системе или давление не должна быть ниже такого-то это понятные правила они очень легко трактуются очень легко понятно уловить их свойства нарушения они прозрачные вот этот то что на мой взгляд очень часто недостает современным системам машинного обучения они могут давать ответ но редко они могут его объяснить почему они решили именно так а не иначе если мы будем чуть дальше говорить о технологиях глубокого обучения там по-моему эта проблема может еще ярче стоять что там ответ получить можно но трактовать его это отдельная задача которая возможно даже в рамках этой теории не решается то есть масленок обычно непрозрачной модель дает она скажет что есть проблема но если ее спросить эту систему и модель а в чем проблема и почему ты считаешь что это проблем нормального внятного ответа получить можно не всегда в рубис нужен эксперт нужно человек который понимает что вот эта температура на в таких пределах вот это давление на в таких пределах таки эксперты есть не всегда в распоряжении не всегда их можно арендовать на такое длительное время чтобы они скажем так проводили такую экспертизу а для маши лирник нам нужно много данных только тогда это работает но есть интересный момент которые ставят под сомнение руль bass всегда ли они подойдут селе возможные проблемы они уловят дело в том что по сути любой системы рассчитан на то что они будут ловить те атаки про которые не знают если злоумышленник попробовать эксплуатировать что-то новое новый тип новые вектор атаки который раньше был неизвестен не окажется такого правила она была раньше не известно и это может быть достичь своего успеха интересной особенностью которая собственно и мотивирует в том чтобы проводить исследования в этой области заключается в том что потенциально по крайней мере подходы на основе машин whirling могут ловить то что они не знают ловить что то новое что то странное то чего раньше не было что как раз в области кибербезопасности на мой взгляд представляет гораздо даже больший интерес ловить не то что мы знаем а ловить что-то новое новые способы эксплуатации зрелости которых мы еще не знаю есть конечно в обоих подходах некоторые недостатки рублей сложна сложна в реализации если это собственно и ds или их надо писать их на то что то компилировать их надо как-то исполнять если это внешнее ds или там тоже есть целый куча своих технических проблем вот коллеги на других секциях рассказывали есть проблема у разных встроенных программ языков программирования для реализации этих правил по сравнению например сруба с системами на данном этапе развития этикет именно мое личное мнение машин верник гораздо проще в применении по сути благодаря наличию но невероятно количество удобных фреймворков сейчас для того чтобы работать с нейронными сетями наверно уже не обязательно даже писать свой бег прополисом и скорее всего даже если напишешь своём получится хуже есть даже не просто смысла мотивация напрямую использовать готовые решения которые как раз и упрощают реализацию в этом смысл из еще недостатков робость долго внедрение их надо писать это живые люди будут садиться будут их писатель занимают время иногда если этих правил должно быть сотни в худшем случае наверно 1000 это может действительно занимать время здесь стоит быстро не зрение он со звездочкой что я под не подразумеваю если у вас есть данные тогда да у нас пугают иногда фразами что он вот система будет обучаться неделю я видел внедрение руль bs которые длятся по три года эксперты сидят и описывают различные системы правил для того чтобы ловить разные интересные атаки не только в индастриала вообще в сфере компьютерной безопасности поэтому по сравнению именно с любой с подходом для этих систем можно организовать быстрое внедрение в случае если у вас есть готовые да это сет а именно для данной задачи здесь вот интересный момент обычно говорят ну как может быть фолз позитив ложные срабатывания врубай сыграю легко человек который пишет эти правила это человек он ошибается напрасно песни правильный правило он сработает с точки зрения формой лайки правил сработало верно но она не написала реальную ситуацию это была просто ошибка человеческая ошибка и я много таких видел там действительно не есть и никуда от них не избавиться ну про то что это неотъемлемая часть вообще любого машины ринг здесь наверно спору нет я не видел ни одной система обучения по прецедентом который работает без ошибок вообще в принципе ну только наверное систем которые еще не делает пред бы кстати таких немножко упомянем в конце а точнее ручках интересных которые позволяют нам открутить вот такой сравнительный анализ показывает что если левый столбец уже исследован и понято его преимущества недостатки почему бы не попытаться посмотреть в сторону правого столбца может быть даже там комбинированные подходы применить случае необходимости мы будем больше говорить о правом столбце о том как его применить как конкретно данной задачи я долго думал перед тем как вставлять этот слайд потому что ну я был уверен что люди перед которыми я буду рассказывать вы уважаемые коллеги прекрасно понимаете такой машины нет но я недавно открыл новую кривую технологического х и под гартнера и я вижу что маши лёнинг по-прежнему на пике то есть это позволит что для меня значат для меня значит это очень опасно и слово потому что стоит собери 100 людей у каждого свое понимание что это такое поэтому если позволите извините за может быть простоту но я попробую очень коротко объяснить что я понимаю под этим очень какой-то простой взгляд которого мне в принципе будет надеюсь достаточно чтобы построить дальнейшем о изложение я рассмотреть например вот такой задачи зачем агрессии есть точки иксы и игреки нам и кто-то дал свыше наша обучающая выборка мы можем с ними делать принципе все что хотим но нам потом начинают задавать интересные вопросы связаны с этим . скажите а какая . скорее всего какое значение y скорее всего находится вот на этой прямой вертикальной как мы можем ответить на этот вопрос мы можем пойти просто мы решаем задачу регрессии вот так это будет визуально мы по 2 подбираем модель кривую за такую ленку прокси мацию смотрим где она пересекается с река несет а вот наша . мы предсказываем что для такого икса у нас будет такой y вот так я например понимаю часто ношу лирник и на удивление большая часть задачи который мне рассказывать эту область она укладывается в эту модель только иксов чуть-чуть побольше становится сначала становится 2 потом 3 равно как-то сразу переходит в пространство из десяти тысяч другой фокус ну считается что инженеров достаточно воображение что представить пространстве размерности 10000 а у кого такого хороший опыт и миллион действительно привет я правда придумал как эту картинку использовать с пользой в контексте именно моего доклада вот это мы предсказали а что если нам теперь говорят подождите а реально было вот такое то есть мы еще замерили вольтметр оказалось что y вот такое что мы можем в этом случае сказать ну и сказать ой там что-то не так похоже что вот этот игорь который пришел он не такой как все остальные какой-то странный он аномальный мур вы даже сбойные а посмотрите кого на него внимательнее по сути я вам сейчас опять вот рассказал всю суть дальнейшего доклада теперь мы будем просто расширять размерность иксов наших бы становиться все больше и способы по стране туда кривой линки все более изощренными мы пройдем даже целый путь в несколько шагов который приведет нас уже наверное к теме конкретных нейронных сетей давайте начнем начнём мы с простых методов которые мы начали пытаться исследовать решать эту задачу они еще они связаны с машинам обучения но может быть еще не связан с глубоким обучение с неровными свечами это подход сегментации временных рядов идея очень простая надеюсь на своем быстренько и про не пробежимся но детальная скорее всего не останавливаться не буду в случае желаний я готов буду ответить на дополнительные вопросы если у нас есть временной ряд что-то дрожащие по времени то мы можем попытаться выделить нам характерные кусочки вот он состоит в целом из таких трех сегментов бывает такой столбик такой столбик и вот такая вот benq дальше мы можем каждый сегмент как-то закодировать давайте возьмем ширину давайте возьмем высоту чистоту спектр начнем набирайтесь наши признаки и заполнять замечательную таблицу объектов признаков вот после этого любой специалист по желез каждого я дальше все понятно у нас есть матрица мы сейчас можно сделать все что только угодно наших любимых чисто например можно поставить задачи кластеризации выделить характерные кластеры которые есть нашей системе попытаться даже как-то подобрать гипер параметрами их число которое примерно должна описывать сколько и скорее всего там и дальше каждую точку который попадает в тут либо нет кластеры мы можем красить какая-то будет красненькая какая-то будет синенькая то есть превращать этого по сути в дискретный набор последовательности и поскольку набор меток который тут последовательно и дальше к этому набору меток мы можем применять любые методы анализа вот таких цепочек последовательности в том числе работают некоторые методы из обработки естественных языков что удивительно но дальнейшие исследования у нас пока в этой области остановились почему потому что получил первые результаты для одного ряда мы сразу подумали в нашей системе десятки тысяч следов можем ли мы легко масштабировать это решение так для на хорошо ляжет на уже задачу близки было я близко к реальный оказалось что если посмотреть достоинства хорошие очень удобно визуализировать можно красиво красить прямо визуально эти графики вот это допустим синенький сегмент это что-то наливается вот красный сегмент это идет процесс какой нагрева и так далее легко таксовать даже если кто-то нам потом эти кластеры посмотрит скажет ой это у нас действительно нагрев а это у нас включается этот конвейер можно даже визуализировать и объяснять какой сейчас процесс протекает системе но здесь нужно все равно помощь экспертов легко применять символьные методы о чем я рассказал а вот самым главным недостатком вот сами алгоритмов сегментации их целая набор видов из тех что подходили нам которая выделяет сегменты не обязательно равномерные сложной структуры к сожалению онлайн алгоритмы способны работать на потоке там достаточно трудоемки и они не всегда успевают для тех нагрузок которым мы должны такой системы приспособить вот второй пункт скорее всего остановил нас в принципе пока в развитии этого направлении то что его очень сложно обобщить на многомерный случай там начинаются невероятные вопросы по поводу синхронизации по времени разных рядов как правило синхронизовать когда их очень-очень много потому что каждой в отдельности рассматривать можно но не так интересно и середы очевидно очень сильно коррелирует между собой по сути например одни или да это просто управление над другими включение насоса причине нагревателя или выключение поэтому методы корреляционного анализа там очевидно могут показывать более интересные результаты по связке что для нас очень важно поэтому пошли дальше необходимость подобрать множество параметров это отдельный вопрос принципе он такой небольшой недостаток он есть каждом наверное из методов но здесь просто их оказалось действительно много ну не известно заранее число кластеров следующие можно посмотреть литературу на великая задача кто-то решал до оказывается можно сходу найти готовый монографии именно вот обнаружение сбоев в индустриальных многомерных рядах и там начинается с достаточно понятной теории в частности метода главных компонент который кстати нам очень понравился показал себя очень хорошо на этой задачи может быть недостаточно хорошо но давайте о нем все-таки пару слов скажем он просто настолько на мой взгляд понятны и подходящие что умолчать о нем нельзя я тоже прошу прощение а кто знает что комета главный компонент как он работает а все таки наверное про этот слайд у меня лишний я попытаюсь имена в контексте данной задачи чуть-чуть может быть визуализировать его что если мы возьмем наш многомерный ряд синенькие и дальше возьмем любую точку по времени мы получим средств точку вот в этом многомерном пространстве и можем дальше расположите на плоскости где много давайте пофантазируем остальные 10 миллионов иксов до прошивание 9000 иксов ну нас хватит фантазии я уверен а дальше поставим вот какую интересную задачу а что если эти все синенькие точки еще лежат примерно какой то прямой или красивая сложность гипер плоскость когда добавляется приставка гипер мне начинает все нравится гипермаркеты тогда гипер плоскости здесь она будет такой более простой она проводится конечно нет не хаотично не случайно она проводится даже так чтобы расстояние от неё до сих точек было минимальным и потом каждая точка проецируются на нее по сути минут понижение размерности было двухмерное пространство стало одномерно и дальше вот в этой откинуть их размерностях можно ставить очень интересные задачи как раз обнаружения странных и нестандартных поведений напротив точек который на эту прямую но совсем плохо ложатся который очень далеко находится от нее на этой плоскости которая эти точки могут быть странными непонятными таки можно обнаруживать и детектировать метод хорошо себя показал но у него некоторые все-таки проблемы по точности полноте наблюдались и мы захотели получить более лучшие результаты мы начали крутить в гипер параметры докрутили до каких-то разумных пределов но дальше он как бы стал на свои максимальный показатель это было не сто процентов далеко и мы начали искать уже другие подходы ну вот здесь кратенько про его достоинств недостатки мне очень нравится его алгоритм обучения по сути там одно очень эффективно и разложение даже для многомерных систем она работает очень хорошо и быстро очень быстро работает онлайн алгоритма в там то есть принять решение о том это то что мы раньше видели это что-то совсем новое неожиданный для нас хорошо укладывается на канале случаем просто предназначен для него более того он водомера в случае очень плохо работает как раз для него многомерный случае это его вотчина он там прямо живет обитает это лучшее что может использоваться для этого метода а вот извини достатков он очень завязанными на плоскости или прямые если наши точки лежат на какой-то кривой сложной огибающей поверхности то тогда он может начинать давать некоторые интересные сбоя а если начать думать то наши данные они имеют как раз нелинейную природу динамическая система технического процесса по сути своей описывается нелинейной системе дифференциальных уравнений поэтому природа эти зависимости в принципе нелинейны и линейные методы могут там иметь теоретически ограничения поэтому хотелось бы посмотреть в сторону и других способов работает без памяти вот это наверное одно из сложных его свойств память можно добавить но все равно станет вопросы выбора окна на сколько он помнит что происходило в прошлом надо выбирать ручками он помнит на пять минут прошло и он помнит на 10 минут прошло и на час но что если у нас система вот есть такое красивое свойство маркова системы это когда настоящее будущее здесь только от настоящего бывает системы и другие когда что-то вот какие то грехи которые мы сделали в прошлом далеком очень сильно повлиять на наше будущее вот у нас как раз такой случай какие-то переключения системы в прошлом возможно достаточно далеком могут повлиять и спрогнозировать что-то в нашем будущем и настоящем и подбирать ручками вот эти окна практически не возможных я нам нужно когда предлагать автоматически что в методе pc и видится ну неудобным скажем так хотя где-то и возможно а вот здесь появляется уже 1 его непрозрачность дело в том что статистика который рассчитывается в ходе примере этого метода их нельзя нормальным людям объяснить что это такое то можно построить некий график ошибки но когда попытаются ошибка чего ну как то вот всего прочего конкретным не знаем дело в том что его ошибка на агрегируются и она не разделяет отдельные ряды между собой посмотреть на всю картину в целом если половина системы ведет себя нормально половину сбоит он скажет просто простую систему и локализовать уже это чисто методами писей не видится здесь возможно едем дальше а наши дорожки вот мы подбираемся уже к чему-то наконец-то прошло на in plain докладу первая попытка первый подход снаряду все эти прямого распространения по сути просто многослойный персептрон и с разными функциями активацию которые мы применяем наверное достаточно оригинальным образом хотя я такие подходы видел и они мне понятны мы пытаемся заглянуть будущее то есть мы знаем что у нас сейчас и было несколько прошлой назад а дальше мы пытаемся придумать как эта система себя поведет дальше пытаемся предсказать спрогнозировать оценить что будет меняться результата как вы видите не идеальные я согласен то есть например считаете использовать это для прогнозирования там ставок курса доллара бы точно не стал но что для нас было интересно и важно но характер и тренды и особенно главное правильный циклы и периодичность она описывает но осталось всего лишь то взять то что слева и получить то что справа кто это может сделать вот здесь как раз есть подходов много но для вот таких нестационарных ковать и периодических рядов показалось адекватным именно посмотреть методы связанные с сетями прямого распространения то есть схематичных написан вот синенькие каждый ряд это наш вход и сейчас назначенный красненькие зелененькие красники это наш скрытый слой может быть один на самом деле обычно там внутри два или три и на выходе зелененькие это прогноз причем ни в одной точке а может быть на целое окно вперед на две минуты вперед на три минуты вперед на 10 минут вперед зависит от выбора параметров то есть как система будет развиваться дальше я думаю идея понятно что из это можно сделать можно взять прогноз и потом подождать как наступит этот момент посмотри что там реально происходит если прогноз совпал с тем что ожидалось наверное в порядке она как себе раньше льва так раньше ведет а если прогноз на уж совсем сильно разъехался с тем что реально произошло это может быть интересный момент на него может быть стоит обратить внимание и выделить его как некий потенциальные ну еще трудно сказать сбой не сбой но явно в момент неоднозначное неожиданный но свои исследования в этом направлении мы тоже чили переустановили потому что там встретились с похожими недостатками про достоинства наверное говорить не надо они присутствуют на слайде они понятны но для сетей приморск устранения которые не имеют памяти вставить та же самая проблема то нужно выбирать окна мы смотрим на 10 минут назад мы смотрим на час назад мы можем смотреть хоть на день назад авто и что если события связаны больше чем днем ты к тому же смотреть на день назад это если у нас 10000 видов мы по каждому смотрим 86 тысяч четыреста . многовато чуть получается мне не нравится да цифра хочется чуть-чуть еще покомпактнее побыстрее это все-таки должны работать в реальном времени в некоторое понимание потоково на стриме и отсюда потихонечку мы начали приходить к тому решение что сейчас исследуется наиболее интересный глубоко нами это рекуррентные сети в частности некоторые их представители такие как эластин ячейки здесь я чуть-чуть вот слайде к в которой скорее всего все знакомые всем даже картиночки знакомы упомянул но я хочу использовать эти слайды чтобы выделить интересные мысли которые нас посетили когда мы выбирали и раздумывали какое же из методов вообще говоря является наиболее перспективным и на какое следует вкладываться в плане исследования наиболее глубоко вот натали рассказывал нам замечательно про рекуррентные сети pon картиночка было то примерно такой же это очень популярный блог где человек очень простым понятным нормальным английским языком объясняет как работает этот механизм я лучше него точно не расскажем но я хочу здесь проиллюстрировать одну идею вот такую шутку если хотите я сначала не мог понять когда вот говорят deep learning глубокое обучение многослойные сети свёрточная десятки слоев сотни слоёв тысячи наверное кто-то пытался на скорее все пока еще плохо работает или наверное уже работает а когда мы говорим о рекуррентных ну вот когда я смотрю эти архитектурную там 12 . нарисую ты все обычно а где глубина и от потом догадался они бесконечно глубокие если их развернуть во времени каждая точка времени это новый слой в некотором смысле они на мой взгляд у как бы круче всех остальных в них не 100 слоев в них не 1000 в них сколько вы хотите слоев то что они вместе со своим весами несут свою историю они могут помнить далеко назад причем правда смотря какие вот не зря сейчас все говорят целости игру на самом деле есть более простой вариант обычные рекуррентной нейронной сети они даже работают в принципе неплохо только обучаются они очень очень очень долго если вам интересно я могу кратко упомянуть вообще говоря причину вот этого обучения считаете что вот эта сеть это как испорченный телефон и когда вы пытаетесь передать все справа налево каждый раз все становится все хуже и хуже и хуже история обрастает дополнительными особенностями и вот когда этих слоев уже тысячи туда вообще доходит не та информация вот well as them это что-то типа правильного телефона он имеет не вносить этих слухов дополнительных домыслов он доносит от начала и до конца но старается по крайней мере правда там тоже есть ограничение всю информацию позволяя учитывать глубокую историю ну собственно статьи работы показывает что история может быть достаточно глубокой и специальное исследование которые на исследуют рекуррентной нейронной сети с точки зрения сколько они помнят и вот обычные символы р-н у них память достаточно короткая уэллс темпами даст гораздо больше у его близких соседей может быть еще больше но наверное стоит эти даже по шагам останавливаться на текущих наиболее интересны применяемых решениях чем эта память для нас важно как раз тем что какие-то события в далеком прошлом могут потенциально сильно прилить наше будущее и мы даже не очень знаем вот эти коридоры по времени мы хотим чтобы она их выучила сама что событие допустим коррелирует пределах одного часа или одного дня если повезет может быть 5 минут но чтобы это не приходилось наносить и фиксировать как параметры системы чтобы это просто могло быть автоматически выведена в ходе обучения причем мы к сожалению даже не все можем знать вот выдалась это или нет только по каким-то уже суммарным показателем грига ценным цифрам вот эти мысли на вилле нас на размышление о том что подход с использованием рекуррентных нейронных сетей для нашей задачи может быть хороший ну конечно мы здесь ничего не придумали носами если почитать те же работы в области прогнозирования временных рядов на основе искусственных нейронных сетей большую часть методов там можно увидеть на основе рекуррентных и интересные тоже гибридные подходы но о них наверно сегодня рассказывать не буду это может уже чуть-чуть может быть в нюансы да что там какая сеть рассматривается вот что мне понравилось она простояла детально просто я-то всего два слоя фиксированных правда не разворачивается бесконечного времени это по сути так достаточно классическая архитектура энкодер декада первый слой пытается сжимать информацию на входе запоминая какие-то вот просто вот все это глубокое обучение он сам учится какие-то интересные признаки выделять из временного ряда запоминая их на этом слое а следующий слой как бы декодирует разворачивая в данном случае в будущее пытается прогнозировать и вот на входе наши x in внизу это наше настоящее и чуть-чуть на историю назад а на выходе x и один стиль очками это то что мы ожидаем будущем здесь используется подход секса 100 секунд то есть на вход подается окно при этом что приятно поскольку все это еще имеет состояние она помнит на титул как но учитывать который мы подали сейчас напомнить все предыдущие окна который мы подавали в этой системе и вот это достаточно интересный момент достаточно приятный dance подход для нас это окно это не наше ограничение памяти это скорее наши струмент управления производительностью в данном случае и где-то точностью прогнозов окно на выходе это наш горизонт прогноза для нас очень важно уметь варьировать потому что варьируя вот это окно насколько далеко мы смотрим в будущее мы можем тоже находить интересные разные эффекты например эти очень маленьким окном вперед есть опасность что начавшаяся развиваться аномалии нас как бы притянет и будет считаться что это нормальное поведение поэтому очень хорошо прогнозирует надолго вперед и надолго вперед последствии сравнивать коротко да какие основные достоинства недостатки мы здесь выявили как каком-то смысле конечно в кавычках бесконечная память она затухает помнится там не все вообще что выложилась воду системой на чьи было бы очень классно замена оперативки эффективного онлайн алгоритмы выводы вот максим рассказывал сегодня право inference но на сердечных сетях вообще говоря для рекуррентных скорость вывода вот я перевожу inference как вывод я не знаю более понятного русского слова но наверняка какие-то аналогии есть он достаточно быстро и это приятно хотя медленнее чем в писе и ну естественно здесь гораздо больше идет вообще говорят мистических операций из недостатков без них никуда есть свои ограничения 1 с которым мы столкнулись холодный старт поставка систем обучили заморозили и коэффициенты потом прошло какое-то время я начинают применять она как бы оказывается вот еще не имеет память это как младенец у него есть чистая стёртая память потому что оно никак не связано с тем на чему его учили ну и ряды те же но состоянии уже другое его как бы переместили в какой-то другой момент есть начальный момент разогрева когда она подстраивается обычно это требует прохода одного двух технологических циклов после чего за до прогноз уже выстраивается на какой-то стабильный вариант но это просто означает что на этапе холодного старта нам надо игнорировать все возможные срабатывания детектор аномалий скорее всего там просто еще система не настроилась вот это не очень приятный момент хотя вот я послушал коллег и недели у меня средний эксперимент по обучению сейчас лица но самый большой на 12 часов что мне составе что мне очень повезло что я могу так быстро ставить эксперименты всего лишь через 12 часов я узнаю результат иногда это действительно будет долгий срок хотя я чувствую что где-то наверно конечно уже пора более глубоко задумываться об ускорении потому что хочется больше ставить экспериментов сильно больше и такие длинные сроки они конечно немножко начинают смущать например fit for все эти учатся гораздо быстрее в этом смысле непрозрачность достаточно сильная то есть если моменты расхождения от этого прогноза реальных значений еще можно обнаружить то пытаться трактовать я думаю что там есть какие-то способы решения мы просто сами сюда них не дошли если вот коллеги мне потом про них рассказать я буду очень рад мы пока их не знаем до конца хотя исследований в этой области начинаются что может быть можно не только выкидывать флажочек это плохо а еще и пытаться как-то немножко локализовать проблему уточнять что плохо может не очень плохо может вообще уже все вот совсем пошла вразнос но непрозрачность опаленной присутствует давайте немножко разрядился я покажу образно как это может работать давай очень схематично здесь нам конечно потребуется помощь джона макклейна я такой набросал схематичный сценарий есть наш заводик он нормально работает синенькое то его реальное значение зелененькое то наш прогноз а внизу это ошибка между прогнозам реально значением красненькая а раньше рынка это самое интересное порог срабатывания когда мы должны начать выкидывать флажочек пока все хорошо держимся до прогноз не идеально это видно ну я незнаю систему со стопроцентной точностью прогнозам я думаю даже финансовых рынках таких нету потом появляется злостный нарушитель что-то делает каким-то я не знаю невероятнейшим образом он проходит через все остальные слои защиты он должен пройти уже на три слоя защита чтобы дойти до такого уровня и изменяет поведение нашего технического процесса мы начинаем видишь на что-то отклоняется в данном случае например синенькие уровень никогда до такого высокого уровня не поднимался он никогда не был таким большим а например столбики которые есть здесь плохо видно но столбик никто не были такими широкими столбики обычности гораздо более узкие были поэтому там тоже идёт накопление суммарные ошибки и вот этот порог начинает превышать для нас это сигнал что есть опасность мы это можем даже хотя бы локализовать во времени и включить наш любимый флажочек вот-вот момент надо что-то срочно предпринимать если так дальше пойдет мы не ручаемся за последствии мы вызываем служба поддержки происходит все что происходит обычно в этом случае солнечными к наказаны ну я бы так хотел это видеть таковое обычно там гораздо более сложные разбирательства давайте в завершении этих немножко поговорим теперь о том хорошо если мы нашли какие-то способы решить нашу проблему как нам понимать насколько хорошо мы это делаем может мы это делаем не очень хорошо может мне все на обнаружен обнаруживаем или может быть мы слишком часто выкидывали наш флажочек это немножко бесит когда на это начинает ложные срабатывания здесь я снова буду вы меня простить рассказывать про ищи которая скорее всего все знаете но я хочу что мы здесь немножко все-таки имели общее понимание поэтому я вам расскажу что мы будем понимать под ложными срабатывания my и ложными не обнаружениями вот есть такая задачка просто бинарной классификации когда в реальном мире бывает все хорошо штатный режим или да вот сейчас вот кто-то нас такое что-то плохое происходит это по строкам а по столбцам это то как работает детектор он либо говорит шеф у нас большие проблемы и надо срочно предпринять либо он говорит все нормально работаем стабильно ничего неожиданного не видим когда мы попадаем с зеленой области все хорошо мы либо ничего не происходит мы ничего не говорим либо что-то происходит и мы начинаем говорить что у нас проблема а вот когда мы попадаем в красной области это бывает ошибки 1 2 рода их ещё называют когда у нас либо ложные срабатывания все на самом деле хорошо а мы начинаем зря отправлять страшны эсэмэски либо другой интересный тип ошибок все плохо уже а мы еще даже не заметили что плохого происходит вот две такие страны медали и вечный трудов между вот этими двумя вещами которые даже любят пересчитывать я прошу прощение пару формул будет но не страшно я думаю многие даже догадались каких считают вот такие две простые величины точность по сути она как раз просто от нуля до единицы число и говорится уступая 095 точность это мы сто раз выкинули флажочек 95 по делу опять лишних то есть пять раз мы разбудили людей зазря они злы а в 95 мы правильно сказали они побежали исправлять проблему и полнота что такое полнота 083 это когда было сто каких-то вот этих разыгрывание было 100 а так из них 83 мы нашли 18 нет пропустили к сожалению ну плохо звать не пускать вот на этих двух характеристиках обычно и работают при чем они связаны всегда интересна история она не одна не отлить делим а другой мы начинаем крутить одну падает другая начинаем обратно снова что-то плохо и мы долго думали а как выбрать вот нам что важнее например бывают системы где очень хорошо понятно пример какой давайте классический пример попробую не классически я знаю отличный пример меня кажется если и чары есть они меня поддерживают смысле представьте вы нанимаете сотрудника что такое фолз позитив это вы наняли ну вообще не того вы каким-то образом он прошел через все собеседования пришел на рабочие места и все очень плохо стало а фолз негатив это вам пришел такой профи что просто все перед ним стоят на голову ниже но вы его не взяли я думаю что если вы поразмыслите вы поймете что цена фолз пользуете в гораздо выше гораздо дороже стоит взять не того чем не взять нужно это вот пример такой банальные житейские системы где одно тип ошибки гораздо важнее другой а пример обратные не приходит в голову такой а представьте что у вас много денег и вы венчурный инвестор и с одной стороны вы можете вложить стартап он прогорит вы потеряете ваши деньги вы сделаете фолз позитив но с другой стороны вы можете вложить facebook и вот ну насколько не знаю мне говорят я не очень в этом рынке хорошо знаком что опасность пропустить очередной фейсбук она гораздо выше чем потерять деньги на каком-то star тогда который проговорит поэтому там полнота гораздо важнее и нужно выключить ее ну вот меня обманывают коллеги вывезут меня на истинный путь и очень рад когда мы теперь говорим об одном и том же понимаем что эти две величины во-первых они связаны скорее всего и во-вторых они разные и значимее значений в разных системах мы можем попробовать сами принять решение что важнее а можем попробовать приложить это все-таки наконец-то на нашего пользователя какие то наверное ручки управления системы ему нужны не конечно всем нравится система с одной кнопкой вкл выкл но например в аудио центр есть еще громкость можем крутить туда можно крутить сюда наверное мы можем крутить и вот эти две показывать 2 этот показатель а вот здесь как раз показано как мы их можем покрутить по сути мы крутим вот этой оранжевой линии который было помните порог срабатывания мы можем крутить и выше можем крутить ее ниже из-за этого система начинает показывать разные характеристики например мы поднимаем порог срабатывания выше мы теряем в полноте зеленый график начинает спускаться вниз потому что некоторые атаки они становятся на незаметны зато точность растет потому что если уж такой большой пару перескочила значит точно что-то идет не так и синенькая ползет вверх можем откручивать наоборот ставить порог срабатывания чувствительность очень низкий тогда мы точно скорее всего обнаружим все проблемы но к сожалению флажочек будем выкидывать иногда излишне много раз как на данный момент мы считаем принять это решение заранее при проектировании системы мы не можем скорее всего надо дать наводку пользователю скорее всего эту ручку одно из немногих который надо прокинуть конкретно до него и вывести этот большой рубильник ну и летом тумблер крутим сюда крути закон он сможет понять на каком уровне чувствительность или как громко любит слушать музыку кто-то любит погромче кто-то любит потише а красненькие то то что пытаются обычный привести к скалярной метрики я так называемая от мира красивые слова гармонической среднее между точностью и полнотой как раз по красненьком мы можем вообще понимать уже на уровне нашей модели вот если мы добавим еще один глаз тем слой как нам понять мы сделали правильно или нет если красненькая максимум поднимется а по сути это обычный чем характеризуется и синенькая зелейника начинают плавно как-то ползти вверх ну наверное мы сделали правильно а если мы добавили 10 слоев и все вот как-то совсем опустилась вниз наверное лишние добавили это дает по крайней какое-то понимание уже для исследователя и проектировщика архитектур какую сторону он крутит ручку в правильную либо неправильно без этого механизма я вообще с трудом понимаю как можно подбирать какие-то гипер параметры по сути мы подходим уже к завершающей части доклада наверное в конце кому интересно можно чуть пройтись по источникам я постарался какие-то самые характерные ссылки работы разместить какие-то из них общего назначение какие-то специализированные для аномалия datex night time series а вам спасибо большое за внимание я готов ответить на ваши вопросы сколько времен вот давайте микрофон передадим здравствуйте спасибо за интересный доклад вопрос про ручки нельзя ли например взять и построить для конкретного производства маленькую модель технологического процесса и свести часть параметров просто к дискретному сигнал что мы находимся в аварийном режиме или мы находимся в штатном режиме и его уже сопоставлять с сигналами там защищаемого контроллера чтобы ну в это же просто легче обучать было быть да я понимаю вопрос это один из хороших методов именно математического моделирования системы но мы почитали что очень дорогой если каждым новым заказчикам мы будем сначала проектировать его с помощью sopro его система первых не все нам расскажет что но конкретно происходит нож не все знаю до конца что конкретно происходит и нужно достаточно большое количество экспертов которые достаточно хорошо это спроектированном читали этот дорогой способ и наверное все таки нам ведь не нужно управлять этим производства нам нужно только осуществлять его мониторинг отсюда пусть появилось решение не идти этим путём и не моделировать систему а пытаться построить модель которая конечно непрозрачно но сама по мере примерно поймет его поведение вот здесь еще был вопрос спасибо за прекрасный доклад а вопрос такой сократив задумывались что злоумышленники стой стороны вот новые аниме про историю сторона вообще похож на спецслужб да нет ну нормальный хакер казаки еще не нужно увлекаться ну как например обычно задают вопрос день валентина чем доказать не можем вот я могу ответить только так я не отвечу лучше аленка что знаете больше чем надо сказать спасибо спасибо за доклад подскажите пожалуйста а думали ли вы применить такой же метод скажем так не только для асутп но для black для анализа обычных зловредов например по сетевому трафику пыли по тому как пользователь работает на компьютере и если думали точнее если применяли то каковы результат этим занимаются не мой отдел до пробовали я не знаю точные результаты по моему большая проблема опять таки souls позицию очень много фолз позитив и пользователям не нравится главной проблемы вот это но есть результаты как раз связаны с тем что прос когда внедрять и можно ловить то что не известно ранее да но зато и насколько я понимаю там как раз нет проблем с большим набором данных да и наверное с скажем так вообще с данными опять таки нет проблем с хорошими данными но есть проблемы с классами плохих поэтому сложно строить задачи классификации и можно работать только на вот примерно тех же подходах что я рассказывал спасибо вот там еще был вопрос да у меня вопрос спасибо за доклад а такой вопрос собственно прорабатывается ли как-нибудь система нейтрализации атаки после обнаружения ведь на техническом производства скорее всего там вопрос минутах стоит если кончик будет разбираться что там 10000 графиков куда ушло уже будет поздно может какая-то автоматизация на это мы нет мы этим не занимаемся мы пытаемся делать предупреждение и ограничения вот кстати да можно вопрос моему коллеге создать более детальные в кулуарах он я думаю ответит более конкретным методам защиты вы же они обнаружения спросите у суда код подскажите пожалуйста как вы считаете точность планту если у вас нету как бы сами их срабатывание изначально была скажем что задача как бы 1 класс хороший вопрос давайте еще раз его проясню как только мы взяли компьютерную модель в этом можем генерировать и те и другие но мы сделаем себе искусственное ограничение учимся мы только на хороших а вот точность и полноту считаем и на хороших или плохих ты сгенерированные плохие да это сгенерированный плохие спасибо вопрос такой вы каждый раз всем параметры загоняйте в эту нейронную сеть или частью производства загоняйте каждую свою просто для того чтобы аномалию которое происходит сделать брелок локализованный вопрос вы делаете вот сразу по всем вашим датчиком или бьете их начать возможно пересекающийся нет сейчас мы даже не бьем почему потому что несмотря на то что эти части части локализованы но не между собой начинает все равно быть связаны и часть информации из одного блока перетекает в другой и мы тоже не знаем через какие каналы нам их никто не подсвечивает поэтому мы надеемся что путем того что мы загоняем весь объем если там есть скрытой внутренней корреляции то они будут выяснены в ходе обучения но подтверждение скажем так строгих у нас нет что это действительно обнаруживается может быть разбить на несколько поменьше было бы логично но мы пока так не делали все вроде вопрос исчерпан и если что я далеко не убегаю поэтому спасибо вам большое"
}