{
  "video_id": "7csjkaktQNU",
  "channel": "HighLoadChannel",
  "title": "СберБанк Онлайн: масштабная трансформация legacy / Артем Арюткин (Сбер)",
  "views": 719,
  "duration": 2663,
  "published": "2023-10-06T07:15:26-07:00",
  "text": "так Всем привет прежде мы познакомимся Я представлюсь и так далее давайте наверное решим о чем будет наш доклад сейчас есть два сценария первый я расскажу слащавую историю успеха о том какие мы большие Молодцы как мы отлично Все трансформировали есть второй сценарий я расскажу о том как Я облажался Давайте проголосуем кто за облажался я понял организаторы обещали что короче будет полегче Ладно ладно давайте я короче сейчас меняю фамилию Меня зовут Артём Я работаю в Сбере можно сказать всю свою жизнь на самом деле работаю в Сбере и занимаюсь как раз все это время Сбербанк онлайн Сегодня поговорим с вами о том даже не так Наверное мы с вами вместе попробуем трансформировать наш большой такой толстый легасе Монолит на микросервиса посмотрим как это у нас получится посмотрим чему мы придем посмотрим где мы облажаемся вы сами выбрали сценарий поехали по структуре поговорим о том что такое Сбербанк онлайн вспомним Что такое Сбербанк онлайн попробуем вместе спланировать работы посмотрим что у нас пойдет не так я вам обещаю что-то у нас пойдет не так в конце я отвечу на вопросы у нас шикарные подарки и чары отдельно просили это подсветить подарки отличные задавайте вопросы не стесняйтесь за лучшие вопросы подарки поехали Что такое Сбербанк онлайн поднимите руку те кто пользуется Сбербанк онлайн надо менять работу короче везде одно и то же рассказывать здесь нечего -5 минут от докладов поехали Сбербанк онлайн в цифрах Сбербанк онлайн цифрах это 75 миллионов Мау это уникальных пользователей была в месяц это то с чем мы работаем по сути сейчас мы с вами вместе в эти полчаса руководим проектом по трансформации платформы Сбербанк онлайн а значит на вход должны получить какие-то требования первое требование 75 миллионов мал второе 400 плюс команд развивающих Сбербанк онлайн Пока короче все звучит не очень хорошо и не очень успешно вторая история 120 тысяч входов в минуту у нас такое настоящий серьезный хайлоут у нас ежегодный рост нагрузки 15 процентов скорее всего мой бизнес сейчас кричит зубами потому что возможно он 20 процентов но давайте считать 15 вторая история у нас надежность четыре девятки в отличие от какого-то интерактивного сервиса возможно сервиса с фотками с картинками неважно чем угодно мы не можем позволить себе быть недоступными потому что когда вы стоите на рынке вас трясет за руку ребенок и просит купить арбуз а у вас недоступен Вы не можете пополнить свой счет с карты вы не можете перевести продавцу деньги скорее всего вы тоже начнете поговаривается плохо но вы расстроитесь скорее всего поехали что имеем дальше Давайте посмотрим на архитектуру это архитектура типового ДБО в любом банке на самом деле даже не важно говорите Вы про корпоративное ДБО говорите Вы про депо физлиц как мы с вами но у нас физлица у нас множество каналов обслуживания такие как это АТМ это банкоматы на самом деле через который вы с нами взаимодействуете Это мобильные приложения Web это приложение для офисов обслуживания это все то через что мы работаем на самом деле их больше есть всякие голосовые ассистенты и другие подобные поверхности так называемые через которые вы работаете есть сервер сайт он здесь подсвечен почему подсвечен Потому что как раз его мы будем распиливать у нас есть большой толстый надо нарезать его на кусочки перенести на классную модную новую платформу и сделать людей счастливее чтобы разобраться чуть-чуть поглубже в том что такое Сбербанк онлайн Посмотрим дальше есть слой интеграции это классическая история для банков в банках обычно это Enterprise сервис бас в корпоративные сервисная шина сейчас не Очень модно Поэтому в Сбере мы эту историю меняем коллеги должны рассказывать про синапс Завтра у них будет доклад послушать реально классно интересная штука а за всем за этим стоят абски так называемые автоматизированные банковские системы это карты кредиты вклады и еще огромное количество то есть что мы должны понимать Сбербанк Онлайн это интерфейс для взаимодействия с теми самыми системами которые реально отвечают за проведение клиентских транзакций за Принятие решения выдать ли вам кредит за Принятие решения какую процентную ставку по вкладу вам предложить смотрите у нас на входе есть требования У нас есть более-менее понимание Как устроена Как устроена архитектура где это находится внутри большой корпоративной архитектуры оргструктура Если станет скучно начинайте свистеть Пойдем смотреть авэрки оракал такое тоже есть посмотрим нагрузку на сервера и так далее будет интересно смотрите орг структура почему это важно понимать у нас 400 команд каждая из них должна сделать определенные приседание чтобы превратиться чтобы уйти с Монолита на микросервисы фактически этим невозможно управлять особенно в классическом таком классической такой структуре в которой Наверное мы находимся то есть для понимания где мы с вами находимся сейчас Дайте штуку заработает вот Короче ладно мы находимся Вот так мы находимся там где платформа Сбербанк онлайн написано то есть я нахожусь в той рок-структуре все остальные у нас это называется трайбами Давайте назовем для упрощения управления нам не подчиняются единственные Кому мы все вместе подчиняемся это Греф то есть ниже уровня абстракция у нас нет на который мы скажем так могли бы сказать что вот этот человек примет решение и скажет что приоритетнее таких управлений участвующих конкретно в этом проекте было больше 15 здесь 4 просто для примера это некий продуктовые направления мы вместе с бизнесом живем Рука об руку единым порыве страсти развиваем наш продукт таких там больше 15 участвующих в нашем проекте к чему я все это рассказываю нам нужно понять на старте Где нам будет больно на входе есть матричная структура управления если упростить Это означает что кого вам дали с тем вы работаете вы не нанимаете этих людей вы не отвечаете за их бонусы за их зарплаты вообще на них не влияете Короче сказали работаешь с этим работаешь с этим все что ты можешь сказать это прийти попинать его руководителя и сказать Что Блин он плохо работает это единственное возможность продуктовые команды со своим бэк-логом условно приходишь например в какие-нибудь платежи за сотовых операторов и сегодня ты у них где-то вот здесь логи они говорят и парень Мы завтра все сделаем для тебя вообще прям обещаем все работы будут выполнены приходишь через неделю спрашиваешь Ну как дела они говорят пришел бизнес короче опустил твою задачу куда-то вот сюда вниз и больше мы вообще не занимаемся и это постоянная борьба с которой Приходится работать с этим ничего не поделать высокие требования к надежности Я уже сказал что мы не можем позволить себе упасть в проме и не можем позволить себе быть недоступными сразу все СМИ начнут писать что короче сбол не работает не знаю все не работает ничего сделать не можем клиентские деньги застряли и все волнуются все боятся Поехали дальше какой смысл вообще в том чем мы занимаемся классическая такая история на самом деле здесь абсолютно ничего не уникального нет несмотря на масштаб У нас есть Legacy мы пытаемся его трансформировать для чего для того чтобы ускорить Time to Market за счет микросервисов и независимая разработка Мы работаем в Agile А значит независимая разработка для нас критически важна текущая архитектура которую мы с вами имеем она не позволяет этим заниматься вторая история Она кстати Спорная со мной многие не согласны что стоимость снижения Legacy было нашей целью Но я это здесь записал Что такое стоимость вообще автоматизированной системы для тех кто может быть с этим незнаком крупно это две составляющих Первое это люди которые на нее работают то есть чем больше вы генерите тем дороже она стоит вторая История это количество доработок в легасе которое вы делаете Ну собственно говоря вот две большие таких крупных составляющих чаще всего кстати люди дороже Давайте заспойлерию где мы облажаемся облажаемся Мы в инфраструктуре вот с ней всё будет плохо следите дальше что будет происходить а третья цель хотя это больше похоже на лозунг а не цель мы не делаем трансформацию ради трансформации мы должны улучшать сервис для нашего клиента Смысл в том что мы должны работать в синергии с бизнесом дальше вы увидите как наверное этот смысл преобразуется у нас в цели и то как мы будем выстраивать процесс проект короче что нам с этим делать Вопрос такой да возникает у нас на входе огромное количество команд всем на вас все равно каким-то образом надо трансформировать при этом вас постоянно трясут с этим тоже надо что-то делать общий kpi для бизнеса it классическая схема она не всегда работает но если она работает это круто у нас получилось Она реально работала То есть у нас на уровне директоров был общий kpi который говорил следующее трансформируйте вы уже свое это Legacy систему и у бизнеса и уйти вот прямо одинаковые с одинаковыми формулировками то есть мы должны куда-то на High Level занести эту цель слово это нифига не помогло раз вы выбрали именно такой сценарий потому что у директоров целей много и какими-то целями они готовы иногда пожертвовать Следующая история это концепция мы говорим что у нас работает 400 плюс команд А это означает что мы не можем говорить командам делай а не делай Б Но это Физически невозможно потому что в таком масштабе не существует по сути человека который держал бы все в голове который единственный уникальный понимал бы как это все работает а если такой человек есть скорее всего у вас плохая структура и нужно с этим срочно делать что-то сделать с этим срочно мы не можем нанять армию Архитекторов который тоже будут отслеживать каждое техническое задание Ну это просто дорого и в какой-то мере нерациональным и безумно поэтому мы должны создать некую концепцию общие рамки в которых команды будут принимать свое решение то есть команда должна сама уметь понимать делать ей а делайте Б И К чему Она в итоге с этим придет это ей позволит быть гораздо гибче хотя мы пострадаем сроках и пострадаем в результата на самом деле Следующая история это ответственность на уровне команд мы занесли цель на уровень хайла должны занести ее на уровень команд самих команды сами должны понимать ответственность и Профит который они получат от этой миграции Профит простой если у тебя Time to Market там не знаю 5 недель 5 недель даже мало Пусть это будет 10-12 недель То естественно команда понимает как классно будет если он снизится до двух недель ну здесь мне кажется для команд понятно И к слову команда изготовленностью брали эти цели это тоже прикольно Это один из был э реально рабочих способов который нам относительно помогал относительно поможет мы же с вами прямо сейчас это делаем исходя из тех целей и исходя из тех скажем так в водных которые мы имеем для себя Давайте примем следующее решение возможно попозже попробуем его вместе по челленджи А давайте начнем с самых популярных операций Ну то есть мы что делаем мы пытаемся ускорить Time to Market Когда мы говорим про ускорение тайн тумаркета чаще всего это самые популярные операции потому что у бизнеса идет конкуренция с другими такими же банками они постоянно прибегают с инновациями суперскими идеями А значит нам нужно снизить количество изменений которые мы вносим в легасе и все эти изменения направить на микросервиса Пусть все это развивается и ускоряется там Time to Market там меньше все прекрасно Мы у нас с вами есть гипотеза интересная что самые популярные и самые частотные операции под популярность Я имею ввиду еще и частотность они же самые высоконагруженные то есть они нам приносят больше всего нагрузки на нашу систему давайте для примера чтобы не было слишком абстрактно приведу вот там три операции до относительно популярные это платежи то есть Клиент сбол заходит чтобы сделать платеж клиент был заходит чтобы сделать перевод клиент был заходит чтобы посмотреть свою историю операции их в реальности гораздо больше но кажется в голове будет сложновато удержать все остальные Поехали дальше то есть мы говорим следующее что эти операции еще и самая высокая нагруженные Что самое прикольное мы с вами проверяем это на нагруженном тестировании и внезапно оно нам это подтверждает Короче мы счастливые пару лет назад такие вообще с улыбкой бежим делать бизнес бежим ускоряться и нашему счастью Нет предела любой проект нужно оценивать у нас должны быть какие-то метрики на самом деле метрик достаточно много того как мы оцениваем есть всякие корпоративные метрики которых мы должны тоже достигать в рамках нашего проекта Но посмотрим сейчас на несколько таких наверное которые интересны будут нам всем самый простой способ Если я мигрирую бизнес операции с легасе на микро сервисы давайте считать сколько я мигрировал ну здесь мне кажется такая Простая история мигрировала одну записал себе плюсик мегрел вторую записался плюсик и так далее кстати еще так и не достигли 100 процентов сейчас у нас пока не очень с этим получилось но не суть нельзя наверное как руководители проекта мы с вами не можем их считать равноценными эту метку и каждую мигрирующую операцию не можем стать равноценными У нас есть условные платежи у которых 70 миллионов пользователей в месяц есть какая-то другая операция у которой 10 миллионов пользователей в месяц и считать равноценными наверное чуть сложно и будет искажать картинку можно вводить всякие веса но вместо веса Давайте ведем вторую метрику в которой будет ее аналогом она нам в будущем пригодится с вами Это количество клиентских операций в Legacy я эту метрику люблю Я за ней лет 5 сам смотрю в нашем мониторинге она мне очень нравится Метрика классная о чем она нам скажет с вами она скажет нам что мы взяли перенесли самую популярную тяжелую операцию с Монолита на микросервиса и как будто бы идем к успеху вон видите у нас Как здорово Это Метрика обвалилась в какой-то момент то есть успех прям приближается всё классно а в чем Профит этой метрики она исторически коррелирует с утилизацией железа То есть когда мы там много лет считаем свою копасите Я раньше занимался надежностью Сбербанк онлайн и ежегодно считали какой будет прирост нагрузки клиентка Исходя из этого планировали новые мощности и она в принципе плюс-минус всегда коррелирует с этим вот кроме одного момента вы его видите сейчас что происходит у нас радикально падает количество операций утилизация железа не очень то есть мы почему-то застряли в этой части следующая Метрика я говорил что одна из целей это снижение стоимости люди самое дорогое что есть в нашей системе нам нужно как можно быстрее взять этот наш интеллектуальный потенциал и перевести их в русло разработки микросервисной микросервис микросервисов чтобы они там развивались ускорялись все было классно приносили Профит бизнесу мы этого в принципе достигаем за счет того что мы начали с вами С тех операций Которые наиболее популярны у клиентов А популярность чаще всего равно как можно больше бизнеса прибегает с просьбой что-то изменить изменить иконку не знаю внести какой-нибудь автоматизацию дополнительно и так далее мы этих людей быстро переключили и они счастливые довольные развивают микросервис А у нас с вами радикально падает стоимость что интересно на графике есть такие всплески это второй интересный момент его тоже стоит запомнить что мы дорабатываем внезапно наш Legacy для интеграции с микросервисами то есть мы не просто развиваем микросервис мы еще и связываем их друг с другом последствия эта играет определенную интересную роль определенную интересную роль в нашем проекте Да наверное правильнее сказать так и количество используемого железа в легасе это график повторяет то что был наложен на график с количеством клиентских операций что важно Вот из текущего понимания с метриками извлечь Первое у нас внезапно инфраструктура не падает с той скоростью с которой мы рассчитывали вторая история мы интегрируем Legacy с монолитом И третье мы шикарно сократили расходы на ресурсы людские в легасе означает резко снизили ее стоимость Поехали дальше зачем мы с вами все это обсуждаем чтобы в один прекрасный момент оказаться в ситуации когда проект завершён на 75 процентов что интересно есть вопрос который нам задают с момента как проект завершен на 40 процентов на 50 процентов на 60 процентов и на 70 процентов вопрос абсолютно один и тот же один и тот же Когда вы начнете сокращать инфраструктуру что мы имеем к моменту когда проект завершен на 75 процентов количество операций в легасе точнее неправильно количество операций 60 процентов операций у нас выполняется на новой микросервисной платформе Давайте подумаем насколько у нас снизилась нагрузка на железо в Legacy на 0 не на сколько короче вот у всех такое же лицо я одинаково на этот вопрос отвечал 40 процентов Когда было 50 процентов Когда было 60 процентов 75 процентов вот так Ну помимо первого тезиса что у нас постоянно растет нагрузка если помните на входе Я сказал о том что нагрузка ежегодно растет на 15 процентов клиентской активности Это означает что чтобы снизить хотя бы на 15 нам нужно умудриться в реальности от первоначальной точки снизить на 20 на 30 процентов то есть мы должны бежать быстрее на самом деле да чем это происходит в реальности Давайте Давайте вместе попробуем понять А что нам с этим делать к слову А стоит ли вообще с этим что-то делать Может мы смиримся не знаю посыпем голову пеплом и извинимся перед всеми какие еще метрики можно посмотреть метрики модно популярно надо смотреть метрики нагрузка на базу данных здесь в таком столбчатом виде представлен отчет oracler по базе данных нашего Legacy как раз монолитом в принципе плюс-минус так также отчет выглядел 2 и 3 года назад То есть у нас ничего не меняется 1 2 3 4 5 6 это некий Селект и insert и Да и так далее То что у нас есть ворохли они здесь обезличены Но не суть я про них тоже расскажу еще отдельно так вот они все на месте в этот момент вы думаете короче отчеты нам рассказываешь Артём Возможно это очень плохой руководитель проекта и наверное тебя стоило уволить еще год назад Возможно не знаю пока не уволили почему так происходит если помните Я сказал о том что микросервисы обращаются к Legacy и внезапно это нормально То есть это та концепция с которой мы с вами согласились И посчитали что это Окей супер давайте так жить почему так происходит Видите вот этот столбик под номером три это один из определенных селектов к нашему монолиту Почему мы смирились с тем что он нормально что он остался на том же уровне на котором был потому что если бы мы этого не сделали то при попытке перенести этот запрос мы бы уперлись наверное порядка 15 команд уперлись бы в одну команду и все сидели бы ждали пока же она реализует этот сервис на микросервисной архитектуре А прикол в том что этой команды в итоге было еще три наших задачи которые были более критичны для нас в этот момент да мы могли долить ресурсов и так далее но скорее всего это отняло бы гораздо больше времени помимо того что нам нужно организационно найти эти ресурсы нам нужно было я не знаю там их влить в команду они должны были бы разобраться их еще Найди Попробуй на рынке нам проще было просто сказать ничего страшного Это инфраструктура она у меня уже стоит в банке Я уже за неё заплатил так я вместо того чтобы тратить на поиск и найм новых людей доработки эти пусть стоит себе инфраструктура Пусть они интегрируются вместе Но эти вызовы естественно остаются как временные мы естественно заводим тех долг к слову неестественно не всегда мы заводим тех долг иногда мы об этом забываем но давайте считать что в идеальном мире команда Это когда-то исправят прикол в том что если бы это была проектная работа всегда то есть организация которая работает по проектному типу скорее всего здесь Было бы неприятно потому что команды которые должны были бы устранить этот тех долг Они могли быть расформированы до того как мы вообще предоставим возможность работать на новой микро сервисной архитектуры это к слову надо наверное держать в голове Просто я недавно с коллегами из другой организации из двух получается вот летом с одной и с другой две недели назад мы как раз обсуждали у них тоже есть похожая задача по миграции по трансформации их ДБО и вот у них как раз проектная организация и для них это больно то есть они не могут себе такого позволить А что важно понимать еще не все организации согласны с тезисом что инфраструктуру можно оставить вне для некоторых это реально Цель номер один им нужно как можно быстрее избавиться от инфраструктуры Ну потому что это несет определенные риски потому что эту инфраструктуру они не могут даумашнить масштабировав каким-то образом Либо это будет стоить слишком дорого То есть им реально дешевле убежать с неё чем чем оставить вот поэтому для них это может быть важно Это то что держать в голове То есть то что я рассказываю но наверное применимо в конкретный кейс то как мы с вами этим всем занимаемся у других организаций могут быть определенные свои нюансы конечно а новые продукты могут использовать старые сервисы это тоже Интересная ситуация есть один далекий департамент у которого не было никогда продуктов вообще в Сбербанк онлайн Вот они сидели сидели где-то в конце наверное предыдущего года придумали классную фичу счастливые довольные побежали получили арх решение и на 90 процентов они в целом ушли в целевую архитектуру То есть все прекрасно они счастливы Да и мы счастливы вот у них есть вызов вот этого селекта который под номером четыре В данном случае он Он должен был вызываться для одного миллиона пользователей всего один миллион пользователей и мы с этим Окей Пусть вызывается себе пусть довольны зато мы быстро выведем фичу чем сейчас попытаемся на микросервисах все это быстро реализовать команда опять заняты кейс тот же что лучше заниматься чем-то другим моменте что происходит приходит продуктолнор У нас напомню Мы работаем в идеале приходит продуктовый и говорит Их команде Ребята надо фичу прятать не под плашкой для тех клиентов кто ее раскроет и увидит А надо выводить прям сразу и так они и сделали только после этого столбик начал расти потому что теперь он вызывается этот Селект не для одного миллиона пользователей а для 75 миллионов пользователей то есть для каждого клиента входящего в сбол мы внезапно дергаем этот Селект у нас всегда стоит выбор мы можем затянуть гайки и начать кошмарить этих людей просто пиная их ногами Каждый раз когда они пытаются сделать что-то подобное А можем быть наверное чуть гибче и сказать Окей такое бывает у нас есть послабление которыми мы которые мы готовы дать всем командам инфраструктура опять-таки то же самое Так по базам данным все посмотрели пойдем серверам Ладно я понял всех короче интересует номер один Да вот огромный короче столбик о владелец сервиса потерялся Помните у нас огромная организация огромное количество команд никто не хочет быть владельцем вот этого сервиса каждый говорит следующее я говорит пользователь А сервис провайдер не я да я например топ-1 пользователь То есть все остальные не знаю в 10 раз меньше меня его потреблять но все равно не мой сервис порядка наверное трех месяцев ушло на то чтобы взять кого-то из трясти и сказать заставить его подтвердить что это он пользователь еще наверно месяца три ушло на то чтобы запланироваться еще месяцев 6 ушло на то чтобы облажаться то есть не очень хорошо получилось с этим сервисом чудо не произошло Ничего мы справляемся этот сервис начал уменьшаться то есть бывает на самом деле такие приколы что самое интересное Даже если мы взяли вот так вот с вами сократили бы все эти запросы просто по щелчку пальца уничтожили бы их все мы бы не сократили радикально стоимость инфраструктуру потому что первые люди дороже гораздо дороже для нас по крайней мере в нашей структуре вторая История это у нас стоит огромный здоровый машины которые АС и даже если убрать из которых один Второй третий наш столбик мы все равно не сможем с ними ничего сделать Они настолько огромные что надо гораздо больше усилий привнести чтобы это чтобы убрать потому что вот здесь на самом деле вот во всех этих столбиков скрывается 15 процентов нагрузки А дальше еще идет порядка 80 селектов которые по одному проценту нашу систему нагружают и с этим ничего не поделать нагрузка на сервера приложений здесь сильно Останавливаться не будем Давайте пару кейсов расскажу в принципе ситуация все те же самые мы позволяем интегрироваться легасе с монолитом для того чтобы команда не блокировали друг другу Потому что если команды блокируют друг друга проект сдвигается фиг знает куда это классическая проблема там наверное таких стандартных организаций до которые не знаю все пытаются прям запланировать и пытаются не съехать с планом из интересного на серверах приложений у нас больше 50 процентов нагрузки дают 10 сервисов из 140 здесь видно Да мне кажется прям на графике что Короче после седьмого пункта вообще ничего не видно но там есть если чуть увеличить масштабировать там хоть что-то заметно Это первый интересный кейс вторая история сервис менее 10 процентами это по-моему 5 входит в топ-10 по утилизации CPU внезапно не так много пользователей но так он нагружается в систему Кстати мне нравится как дизайнер выделил Спасибо большое топ-10 прям похоже на успех до проектирование когда у тебя есть такой не нагруженный сервис но который нехило юзает твое CPU так бывает Короче все равно все то же самое на самом деле логика принципе плюс-минус такая же но единственный В серверах Мы конечно можем поступательно сокращать их как только снимаем нагрузку но не делаем этого Потому что если мы попытались убрать сервис который у нас Вот первый и второй самый высоко нагруженный то мы бы никуда вообще не сдвинулись потому что все сидели бы и ждали пока на микросервисах реализуются нужное нужный набор сервисов мы Для чего собрались проект мы по мигрировали у нас что-то получилось в целом Кстати мы достаточно успешны то есть миграция плюс-минус завершена во многом мы добились радикальных успехов по снижению стоимости то есть дешевле сделали систему процентов на 70 или 65 Смотря как считать но все равно что-то же можно улучшить Давайте вместе пофантазируем что можно улучшить Помните я делал такую вырезку и говорил о том что для некоторых организаций фокус на снижение железа может быть важным Кстати это такая классическая история Я ее тоже видел когда реально это пытается сделать важный и целью номер один у этого есть проблемы они проявляются обычно чуть позднее как это выглядит Мы открываем базу данных Oracle например да вот который я показывал такие видим вот этот сервис под номером один прибегаем к разработке к архитектуре говорим ребята срочно его убирать они убирают убирают сервис под номером 2 3 4 5 Мы счастливы и довольные не знаю убиваем 30 процентов нашей инфраструктуры то в чем проблема а бизнес приходит и говорит надо реализовать мне одну фичу какую-нибудь вторую третью четвертую пятую А у вас микросервисная платформа она не готова для этого да на ней сидят эти супер какие-то нагруженные сервисы но при этом все доработки вы делаете по-прежнему на легасе монолите это долго это дорого куча рисков это развивать и так далее но это проблема то есть вы там постоянно что-то развиваете тратите огромное количество ресурсов то есть количество доработок в Legacy у вас будет расти от этого никуда не деться Ну либо Вы можете топнуть ногой не знаю приостановить развитие Но тогда вы проиграете конкурентам это отдельная боль можно очень долго об этом говорить внезапно вам в какой-то момент времени потребуется наращивать инфраструктуру А кто сказал что бизнес не придет какой с каким-нибудь кейсом с каким-нибудь продуктом который будет напоминать тот самый столбик номер один улетающий под потолок Почему нет И что вы им скажете скажете ждите полтора года пока и на микросервисах это сделаю они не будут ждать скажет Вам делает на легасе ты придешь и попросишь новую инфраструктуру то есть сначала у вас инфраструктура упадет вы счастливые довольны а потом придете запросите еще раз ее же скорее всего будет не очень приятно и будет такой специфический разговор Мы можем вести строгий архитектуру архитектурный контроль используемых доработок и используемых сервисов помните кейс когда мы интегрируем микросервисы с Legacy потому что нет еще нужного сервиса в нашей новой архитектуре можем запретить это можем топать ногой говорит так нельзя делать не знаю под страхом увольнение Чего угодно короче но тогда мы друг друга заблокируем я уже приводил пример что у нас команды будут сидеть и ждать пока какая-то одна команда реализует этот сервис на микросервис на архитектуре вместо того чтобы вызвать Монолит и сидеть себе спокойно С тех долгом потом его устранить в продуктовых командах продуктовой структуре организационные в идеале и так далее Это Окей потому что это позволяет нам с вами гибче управлять наверное нашим процессом миграции и перехода а второй продукт обычно не умирает бесследно у него может пропасть конкретная команда которая его развивает если продукт Уже не надо развивать Но по крайней мере останется тот кто отвечает за этот продукт тогда вы его найдете и заставите устранить этих долг не знаю под угрозой смерти из-за не знаю там еще какими-то угрозами или ящиком пиво но какой-то способ вы найдете как этого избежать плюс минус этого подхода что у нас будет расти стоимость разработки нам нужны огромные оргкомитеты которые за всем этим будут следить нам нужна армия проектных менеджеров которые будут бегать и постоянно это проверять то есть определенные ограничения второй минус том что всегда найдется какой-нибудь ФЗ от Центрального банка который надо срочно исполнить как они супер бизнес фича который принесет вам 250 не знаю там процентов роста прибыли и вам сделают исключения бизнес на это согласиться ID директор согласиться все на это согласятся и вы все равно столкнетесь ситуаций Когда у нас есть долг Давайте заключение пробежимся чуть как у нас с вами шел проект каким выводом мы пришли где у нас что-то пошло не так но первое мы начали сервисами самым высоким Мау то есть уникальных пользователей в месяц и это принесло свой Успех это позволило нам развивать людям новые продукты с ускоренным тайн тумаркетом и легко масштабировать нашу разработку но у нас получилось плохо с инфраструктурой потому что наша гипотеза на старте не сработала хотя у нас были для этого все подтверждения В общем ситуация бывают разные второе нам с вами не нужно было гнаться за инфраструктурой Ну первое перед нами конкретно стояла такая задача это была наша это была наша организационная такая особенность которая нам позволила это сделать во-вторых мы посмотрели с вами Что конкретно нам Наверное это было бы даже немножко вредно третья история общий кипяй для бизнеса этим тема классная если это получается и она работает Это реально Здорово когда все директора как бизнесовые такая тишна и вовлечены в эту тему поднимает ее профиты и видят свои плюсы и минусы отдельная история как этого достичь но не суть сейчас с вами берем просто за данность У нас есть концепция того что должны делать команды то есть мы не говорим командам делая они делали б это действительно важно Это просто позволяет на Нам же быть гибче и лучше Ну и последняя история эта ответственность на уровне команд это реально безумно важно когда команда вовлечены и понимает все профиты которые они от этого получат Ну собственно говоря проект мы нашли все у нас как будто бы получилось хорошо есть недостатки но Везде есть свои недостатки теперь вопросы Напоминаю что есть отличные подарки за вопросы меня это отдельно просили подчеркнуть еще раз подчеркиваю Так что задавайте Не стесняйтесь Спасибо Спасибо за доклад ваш вопрос такой вопрос Какие интересные крупные инциденты у вас были на проме Как быстро удалось устранить и как повлияло на клиента инцидента Наверное это отдельная такая большая история Она в рамках миграции у нас действительно бывали инциденты Я так понимаю вопрос скорее как раз про миграцию а не в целом про жизнь Сбербанк онлайн здесь что мы в целом использовали мы старались достаточно длительное время на легасе поддерживать инфраструктуру достаточно и вы видели да почему она была достаточно всегда и вторая история поддерживать функционал в рабочем состоянии потому что если когда падал какой-то сервис на новой платформе мы достаточно оперативно возвращались на Legacy это делалось достаточно просто фактически клиентский функционал не особо деградировал Да клиент ничего не замечал и это было хорошо то есть нас действительно были инциденты они были Ну крупные наверное можно и так назвать Вот Но мы от них таким образом защищались Спасибо Здесь вопрос второй ряд Здравствуйте спасибо за доклад У меня первый вопрос коротенький В чем заключался фейл который Вы обещали рассказать это в том что у вас было количество железа которое вы хотели уменьшить а в итоге не уменьшили это вот хорошо спасибо У меня вопрос второй вот более развернутый хотел получить ответ смотрите у вас когда была Legacy у вас была одна допустим одна команда которая занимается одним участком Теперь вы начинаете пилить микросервисы и у вас как бы всё то же самое до сих пор одна команда но она уже занимается и поддержка Legacy и переводом в микросервисы и поддержкой э-э других микросервисов был ли у вас рост команды Как вы вообще с этим работали Либо вы там заставляли людей в текущие там в одной единицы работы со всем этим и если вы развивались то как вы поступили с разросшейся коман а Когда вы переехали вопрос наверное заслуживает отдельного доклада часа на полтора-два похоже но если попытаться упростить то история следующее Когда у нас было Legacy у нас было ни одна команда конечно же Это было множество команд которые пилили продукт но они работали по некому принципу стакана Давайте назовем вот так то есть когда приходит кто-то и просится включится в backlock этих команд и соответственно история балансируется раз там с какой-то периодичностью Да эти команды реализовывают сервисы все бегут дальше Потом был второй этап нашего масштабирования Когда у нас началась только миграция это когда всем командам Кто прошёл спец обучение разрешали дорабатывать То есть если команда прошла обучение у неё есть квалифицированные разработчики внутри организации получивший короче вот они могли дорабатывать э-э Legacy при этом сами и развивать свой Монолит постепенно так как там доработки снижались то Мы перешли к истории когда у нас есть только продуктовые команды то есть команда она приотвечающая за развитие платежей там за сотовых за сотовые услуги Вот она n-tnt отвечает за развитие за доработки из-за миграцию в том числе То есть она дорабатывает как микросервисы так и дорабатывает Legacy чаще всего это было так были понятное дело там куча нюансов на таком масштабе они просто всегда возникают э вот но наверное структурно вот приблизительно так мы так мы жили Отвечая на вопрос росли мы по ресурсам командам Да это в целом следствие даже больше эджана трансформаций которые произошла Ну то есть когда мы работаем классически Таких вот банках они банки обними обычно кондово работают у них есть цика центр компетенций а куда ты приходишь и просишь что-то разработать вот это как черный ящик в себя забирает и у них сбалансировался они тебе что-то выдают и там всегда ресурсы более ограничены чем в продуктовую историю в продуктовой разработке у тебя всегда много команд сколько продуктов столько там команд Ну либо в каком-то масштабе соотношение поэтому конечно же мы конечно же мы приросли но приросли в большей степени вот из-за трансформации а не из-за миграции команды которые занимались раньше монолитом они собственно говоря в том числе участвовали в миграции развивали Да там определённые продукты уже на микросервис на архитектуре в основном это была платформа то есть эти команды Они развивали они развивали платформу которая лежит вот под всеми этими микросервисами Спасибо Артём два вопроса Артём два коротких вопроса Я здесь слева от вас Ага спасибо первый вопрос как у вас размещены данные под микросервисами я правильно понимаю что у вас Legacy платформа это по сути есть один из клиентскими данными или они у вас за дублированы между различными микросервисами И второй вопрос Как вы планируете Oracle замещение технологическим замещение если я не путаю сегодня будет City говорить наш как раз Наверное они это скажут вот если не скажут то я могу отдельно потом просто рассказать вот предлагаю наверное так потому что там будет просто развернутый ответ можно будет послушать об этом Второй ответ по поводу данных нет ни один инстанс Ну просто масштаб не позволяет иметь один у нас достаточно большой шарнирование расширенное но если говорить про наверное на неком вот том уровне архитектуры который я показывал то и легасе и Монолит они в принципе одинаковы Ну то есть я имею архитектуру вот На таком уровне концепции она одинаковая есть шарды в которой живет клиент в котором хранятся данные данные мы не дублировали Ну практически то есть понятно что нам в процессе миграции где-то нам нужно данное дублировать Но логика была в основном такой что если клиент транзакцию делает в микросервисов то она хранится в микросервисах если клиент делает транзакцию в монолите он хранит её в молите куча нюансов того как это было конечно же было дублирование но верхние уровни в ответ вот такой и спасибо я вижу что у нас еще бесконечное количество вопросов Но к несчастью У нас заканчивается время Поэтому после ловите спикера в дискуссионной зоне она ровно перед выходом из зала Давайте поблагодарим еще раз спикера за прекрасный доклад голосуйте за доклад и пишите вопросы Выбирай кому что уйдёт мне понравился вопрос про инциденты первый вопрос понравился который И второй вопрос мне понравился по-моему как раз был второй вопрос про то раз расслали у нас команда разработки все два Спасибо вам за ваши прекрасные вопросы Спасибо еще раз докладчику У нас для тебя тоже есть Презент И вам всем спасибо за внимание мы вернемся после небольшого перерыва"
}