{
  "video_id": "F8Q3brDDZ3A",
  "channel": "HighLoadChannel",
  "title": "Визуализация данных в браузере с помощью D3.js / Михаил Дунаев (Rambler&Co)",
  "views": 473,
  "duration": 1738,
  "published": "2017-03-30T23:39:10-07:00",
  "text": "итак давайте начнем с визуализации данных или с различными диаграммами мы сталкиваемся каждый день это там google analytics это какие-то интернет-банке это excel это все все все на самом деле графики присутствует преследуют человечество всю нашу историю один одна из первых интересных визуализации данных это десятый день нашей эры не известный астроном изобразил с помощью диаграммы движения с помощью для годам изобразил движение помнить о небесных тел следующая интересная работа это уже семнадцатый век это движение пятен по солнцу тут уже видим некоторые timeline появляется то есть от зарождением по графике следующий это такая интересная штука 18 веке появились такие устройства которые позволяли сделать механический timeline то есть вы прокручивая ручки снизу слева и справа вы можете как бы разворачиваете свиток в лево или в правую сторону и смотри там какой-то узнавать историю из этого документа то есть от такой альтернатива книги также в этом в то же время появляется такой прекрасный экземпляр визуализации данных это как история человеческих империй точно такой же timeline это первый это качественный цветной timeline который появилась у людей эта штука это самая известная историческая инфографика это инфографика показывает движение войск наполеона от франции до москвы и обратно и соответственно бежевый цвет это движения до москвы черном все это движения обратно толщина линий показывает количество войск у наполеона и также обозначена специальные веке то есть мы допустим можно увидеть как при переходе через ряд наполеон потерял часть какого-то своего войска такой вид данных такой вид у до представления данных которые позволяют нам наглядно увидеть историю а это уже наше время это визуализация которая показывает рождение и смерть носители культуры то есть синим цветом это где человек родился красным вам умер это ребята собрали всех исторических каких-то важных деятелей дни культуры ученых артистов которые и от линии показывают как они ведь они родились и где они погибли и видно что процесс урбанизации происходил на всю во все время когда суслова у человечества то есть саматха ранних времен люди носители культуры стремились культурные центры и причем при этом и дождались на окраинах то есть как сейчас со всей россии все люди едут в москву это началось и сейчас это было всегда а к сожалению трения развитие современных технологий и и развитие инфографики большую часть населения нашей планеты используют стандартные графики из excel и и дальше конечно никто не идет на самом деле графиков гораздо больше а есть такая красивая диаграмма который показывает какой график вам нужно выбрать зависимости от ваших данных то есть это если он от показать взаимосвязь распределение сравнение композицию вот хороший пример как можно красиво представить классический график это уже конечно же понимаете не excel это количество смертей в войне в ираке это нью-йорк таймс помощью таких кровоподтеков показывает банк чарт и видно наглядно во первых это красиво во вторых видно наглядно сразу сколько людей когда погибала точно так же это мои бывшие коллеги и студенты графики риа новости чё-то тут изобразили одну видно как это красиво понимается да то есть если мы не ограничиваемся и к сельскими графиками этого у нас сразу начинает получаться красиво и модно а я также тоже хороший пример не смог его не поставить это флоренс найтингейл а основательницы медицинского движения в 19-м веке изобразила смен причины смертей в английской армии то есть видите да 19 век а уже какая красивая графика колосья excel или же вот наше время это количество популярность онлайн компьютерных игр или уже вот мой любимый это мой жесткий диск этот вид графика называется 3 map и то есть программа для mac os и windows 10 который показывает нам площадь каждого треугольника это размер файла это все файлы на жестком диске видно что зеленые то там сериальчик который я смотрю а красный это папка applications синие to swap файл и и в таком виде когда вы видите жесткий диск свой в таком виде вы сразу можете понять куда делась ваше место где какой файл много места занимает очень удобно и наглядно это о том как надо представлять данные зачем это нужно однако когда появляется интерактив интерактив baby все дела меняет свое конечно же количество графиков и диаграмм а резко возрастает и не поддается никакой классификации вот хороший пример на д3 на что это в нем совмещены сразу несколько типов диаграмм и а результат конечно фантастический на самом деле инфографика и визуализация данных под web а это имеет очень короткую историю все началось в 90-х годах с программы macromedia director это предвестник флэшек на ней перу начали появляться под вып 1 какие-то типы визуализации данных естественно после директора пришел нам в помощь flash платформа flash платформа была прекрасным на самом деле визуализировать данные строить графики на флэше это не приду не придумать лучше инструмента риа новости использовала flash как основной инструмент для инфографики два года назад они отказались полностью от flash 1 до этого времени использовать потому что потому что удобно естественно на смену пришли эти трое парней все вам знакомы html javascript css и привели с собой соответственные слабее в дуэль с в g em g или позволили нам делать под вы почти все то же самое что мы могли делать на флеше вот что позволяет делать нам d3 это небольшая дымка того что вот как это работает он лайн все работает быстро это вектор красиво и без каких-то тормозов d3 одна из лучших библиотек на данный момент для визуализации данных мы можем посмотреть скриншот с гитхаба что этой библиотек начала свое развитие в десятом году что она все это время последние пять лет динамично развивается в последнем времени так сильно развивается на это скорее связано с тем что ход как бы устоялся и новых фич не так много нужно придумывать и мы можем увидеть что там 37000 звездочек да и почти 10000 форков говорят о том что библиотеки действительно хороша также она входит в двадцатку самых популярных библиотек наяву скорее все для гитхаба вот хороший пример уже использование посредством библиотеки d3 в наше время это нью-йорк таймс показывает не важно что они показывают на самом деле у вас важно то как они это показывают здесь очень хорошо видел data driven подход то есть каждый элементов хранит себя какой-то каждый дом элемент хранит в себе какой-то элементы часть данных и мы просто каждый раз когда мы выбираем тот или иной способ отображения мы просто говорим как нам надо эти данные отобразить а эти данных на уже в этом элементе и можно посмотреть как до 3 красиво делает анимацию как это все работает качественно быстро и главное что в продакшене очень нет никаких проблем вот тоже хороший пример тоже d3 это визуализация температуры в сша в разные годы видно что меняется месяца зациклена и можно прям наглядно увидеть в каком году была засуха в какой год было было было много дождей во первых это реально красиво на это можно просто долго смотреть залипать и я и я ей это работает и работает хорошо или же вот третий пример это токио wind speed вы можете прямо сейчас открыть ноутбук лучше после докладов посмотреть в реальном времени визуализируется скорость ветра в токио очень красиво каждый раз вы можете посмотреть где как зачем очень популярный сервис у нас допустим gismeteo не знаю скоро уеду таков додумается а или же вот тоже пример это тоже не йорк таймс это визуализация которая управляется с помощью скролла то есть в данный момент а когда снимал этот ролик я с караулил мышкой ему можно видеть что страница статическое но меняются графики и все наглядно и красиво быстро то есть это такой способ который позволяет нам уйти от тупых из сельских табличек от обычных графиков и сделать какой-то проект который имеет большой вау-эффект этот эффект когда пользователь свой придумают вау как это круто что же у нас в россии в россии все тоже на самом деле также но достаточно хорошо расскажу вам про несколько своих проектов и как они собираются проект мы начинаем каждый раз примерно вот с такого вот excel узкого файла редактор дают какие-то данные мы вместе с редактором начинаем решать что мы хотим с этими данными сделать это что это за файл это численность населения россии в разные годы которые бита павла растан то есть по оси y мы видим разные гадаю по оси x мы видим возраст и соответственно на пересечении мы видим сколько людей довольно возраста проживала в россии в разные годы в конечном итоге мы хотим получить примерно такую диаграмму где по оси x мы придумаем что будем показывать возраст по оси y мы будем показывать население этот за 90 год и и соответственно разные цвета будет украсить мужское и женское население и уже то есть мы показываем какой год мы отображаем 3 990 и уже даже на статическом слайде на ней интерактивным мы можем уже разглядеть какую-то историю главный что главное зачем заниматься в зале зации данных это показать людям историю которые они не могут увидеть в xoтeли узкой таблицы здесь мы уже здесь мы уже видим такую штуку как эхо войны видите вот этот провал это дети которые не выдали свое время второй мировой войны и соответственный бэби бум это дети которые родились после второй мировой войны соответственно также на этой диаграмме мы пометили возрастом довольство способного населения то есть от 16 до 50 55 и 60 лет и показать и посчитали сколько на одного пенсионера приходится забота способного населения это на самом деле очень важные цифры я вам скажу зачем то есть мы видим что девяностом году приходилось на одного пенсионера 3 рабочих человека и соответственно мы добавили timeline которым вы можете поискать в лево из травы чтобы менять год смотрите как это работает работает это так мы нажимаем на кнопку play и наши года начинает меняться d3 анимирует наши графики мы видим как эхо войны и ползет уходят на пенсию и что у нас сейчас примерно 3 и вот обратите внимание что три работающих человека на одного пенсионера на что происходит за этим за этим происходит такая интересная штука чтоб дети которые делились во время бэби-бум и они приходят на пенсию эккарт количество пенсионеров в россии резко возрастает и количество работающих людей на одного пенсионера резко падает фактически пока она ситуация стране что каждый рабочий человек получает зарплату за себя из одного пенсионера понимаете что у нас получается что что если вы видели что в двадцать пятом году будет меньше 2 человека на одного пенсионера и это будет реальный пенсионный кризис это такая штука который показывает нам как из данных можно найти историю для журналистики это очень важно или же то есть как это было сначала да это было просто кашу цифры следующий проект 2 это точно также мы нашли в открытых источниках информации о депутатах государственные думы все депутаты государственные думы всех шести созывов и мы видим название депутаты какой он форме информация имя депутата фамилию партийная принадлежность и годы когда он пришел в госдумы когда он из глаз дома ушел что мы можем с этими данными сделать мы попробуем их визуализировать первым делом и возьмем первый созыв и покрасим всех депутатов в соответствующий цвет датой соответствовать цвет их полтинник надежности и построим от меньшей партик большей уже красиво да на учет не та история никакой нет давайте дальше визуализируем все шесть это достаточно просто делать что и созыв государственным дома мы видим как появился единой россии как кпрф теряет свои позиции из-за этого тоже очень интересно да ну чё ты истории никакой нет а давайте добавим историю мы знаем что депутаты переходили от одного созывов другой давайте про чертим линии если депутат перешел из первого созыва на 2 и получается у нас такая диаграмма уже красиво красиво красиво мы видим как депутаты переходили из азова созыв что это действительно каждый созыв это не какие-то новые депутаты этот парень депутаты из прошлых файлов извините добавим в эту схему не много интерактива и получится такая штука когда мы можем выделять отдельные пальцы мы можем тыкать в каждого депутата мы можем проследить историю какого-то депутат история когда вы сам кпрф посмотреть как люди переходили заодно и пальцев другую мы сможем увидеть людей которые пропускали какие-то созывы видите их линия обходит какой-то конкретный состав уже очень интересно да уже пользователь может зайти на сайт потыкать это работает это вектор это из в игре это работает хорошо даже на медленных браузерах на самом деле мы изначально хотели делать png подложки отрыл дарить их нам нужно быстро браузере делать png подложки потом когда я увидел как это хорошо работает в сыром виде в svg решили оставить так и я в этом нисколько не жалею какие истории мы здесь можно найти здесь мы можем найти первую историю мы можем найти депутатов которые были во всех шести созывов то есть такие вот люди как бы с историей мы можем увидеть что большую часть таких депутатов от кпрф которых держит своих людей никуда их не пускает наверное потому что новых то нет точно так же мы можем выделить всех депутатов которые я пропускали какие-то либо созыва вот тоже интересно непонятно зачем и вот мой любимый слайд это депутаты которые меняли свою политическую принадлежность 4 и более раз это люди которые находятся в государственной думе не из за того что не по политическим соображениям а по каким-то иным данный потому что человек не может 4 менять свои политические убеждения ну хотя кто знает больше примеров вы можете найти на сайте майка баста команд восток это автор этой библиотеке автор библиотеки d3 и надо сказать что майк мостик он большой фанат примеров он их собирает в огромном количестве и вы прокручиваете страницу с примерами они все не кончается не кончается не кончаются не кончаются я здесь все с не говоря ни разу закручивал до дна и потому что их там столько и примеры есть на каждый день примеры с кодом и все хорошо написано то есть можете найти все что вам понадобится и так немного кода d3 библиотека как и любая другая библиотека для работы с дом элементами начинается все с селекторов селекторы очень до 3 очень похож на джека или селекторы работает до 3 select дефлектор div можно выделить только первый элемент либо все используются в 3 селекторы api либо сезон связал это селектор angel который использует джек вере и то есть если у вас параллельно подключен джек вере-то селектора будут работать быстрее ли вы можете подключить просто исчезало отдельные точно так же как в d3 работать ченнинг вы получили визу там можете вызывать методы давайте сделаем какой-то проект позволим как он делается от начала до конца вернемся к моим любимым депутатам почему так люблю запутать вас того что я какой-то политический там активный чувак государственная дума в россии это прекрасный источник данных потому что данные все про депутатов от кареты и мы можем когда каждого депутата на сайта госдума узнать его там имя партийная принадлежность его зарплату его квартиру в россии его недвижимость в россии зарплату жены недвижимость жены и машины его машину жены мы можем про каждого депутата узнать все кости поперёк вот как впитать пример да мы можем узнать количество выступление депутата количество законопроектов которые этот депутат привнес в глаз дома очень очень хороший этот пример и если им и давайте сделаем такой при сделаем такое предположение что чем больше депутат зарабатывает тем меньше он выступает и проверим так ли это или нет нанесем на нашу в наш svg вот таким образом каждого депутата каждый депутат будет отображать с помощью квадратика и покрасим каждого депутата в цвет его партии представим что мы на спать или сайт госдумы сейчас это я просто в белоручка my первых трех депутатов мы в джейсоне сохранили его имя его зарплату количество речей и партийную принадлежность пока нам ничего больше не надо о кей 3 подключается как обычного библиотека первый что мы делаем нам надо и центральное загрузить да все кто знаком с джек верю всем все понятно d3 джейсон патрик джейсон и callback который обрабатывает ошибку и возвращает объект джейсон для работы следующее что нам надо создать нам надо создать из вгс в нашем дом дереве мы пишем 3 select б dead end и своего ничего нового точно так же нам надо задать от дополнительные атрибуты ширины и высоты и тардис это хай все просто понятна и знакома и руки и мы видим что после выполнение этого кода у нас появляется своей элемент с ними нам атрибутами следующее что мы делаем следующего очень важно и мы должны что такое библиотека d3d три главные задачи и the data binding data binding это когда вы привязываете данных большим дом элементу это тип приложения которое называется data driven приложение которые управляются с помощью поступаем их данных окей что нам надо сделать нам надо вспомни наши данные привязать к прямоугольником мы делаем svg select all а rect в ответ на возвращается соответственно пустой массив понимаете потому что с врага мы только что создали эффектов там нет и мы к нашему пустому до 1000 массиву делаем такую странную манипуляцию но так работает до 3 и когда вы начинаете ним долго работать это становится как бы очевидным этот путь мы при с помощью метода дата мы присваиваем этому пустому массиву наши данные джейсон депутат и получается такая схема смотрите когда у нас есть готовый проект у нас делать с помощью каждому дому элементу соответствует какой-то элемент данных да и они вместе связаны в нашем проекте сейчас у нас что если у нас есть данные но для каждого доныне назначена никакого дом элемента и мы делаем следующее мы используем метод интер метод enter возвращает нам возвращает нам элементы бедных как для которых не назначен никакой и льдом элемент то есть понимать элемент данных и дом элемент не возвращаться все данные в которых нету дом элемента и для них и он как оперирует по этим элементом и для них вы вызываем метод append ректа то есть мы говорим для каждого элемента данных для которого нету дом элемента назначь новый элемент rect он мало того что его назначат их свяжет вместе он его ещё от рисует в нашем дом дереве смотрите вот мы видим что у нас уже внутри не смогли появилось три элемента рек на самом деле это самое страшное самая важная часть библиотеки до 3 если вы понимаете вот эту часть если вы понимаете как она работает все остальное работает очень просто окей и точно так же для каждого эффекта мы сдадим виз и хай уберу в чем же смысл в чем смысл этого всего зачем мы это все делали это мы делали это для того что если мы сейчас это посмотрим то мы увидим этот черный один черный прямоугольник на экране маленький 10 на 10 пикселей в к которым они трое игре один на дорогой нам на это изменить у каждого координаты x y в зависимости от зарплат депутата и в зависимости от его количества речей и мы смотрите как дела мы берем метод это и передаем первый это какой нам нужно атрибут x а второй мы вызываем передаем функцию в которую будет передал два параметра д это элемент данных который соответствует этому дом элементу а второй это итерационный номер итерационный номер почти никогда не нужен но элемент данных нам нужно всегда мы возвращаем в этом нет в этой функции мы возвращаем то обработанные данные таким образом которые должны обозначает ну как привязаться к нашему атрибуту x вот есть небольшая напоминалка о том как выглядят наши элементы данных да то есть в иксу мы привязываем количество спичек количество речей соответственно точно также мы делаем с координатой y canta y мы привязываем количество зарплату наши депутаты не заколов прибыль и делим ее на я просто абстрактный взял 10 тысяч потому что понимаете нет 100000 понимаете зарплату депутат в такие что они в один в экран конечно занялась никогда не вылезать и вот у нас получается в браузере три наших волшебных прям квадратика которые мы нарисовали своим еще d3 ништяк очень красиво дальше если но естественно нам это не нравится и мы добавим немного цвета мы покрасим депутатов цвет его порции добавим атрибут фил и функцию и соответственно на основании того как он пальцы и вернем тот или иной цвет все элементарные такая чтобы нас получилось давайте представим что мы все таки нормально написали скребками питоне обошли да и сайт госдумы все оттуда сохранили и вот что у нас получилось от реальные это ну это реальная инфографикой оно основано на реальных данных как раз то что мы с вами делали и мы видим что по оси x у нас делать по и по оси x у нас зарплата по оси y у нас конечно выступлений это шкала нет нечестные мы не видим но это логарифмическая шкала то есть здесь от 0 от мутном пьяного значения так ну то есть она растянутая и мы видим что зависимости есть смотрите чем депутат больше зарабатывает тем меньше у него речей то есть есть конечно какие-то странные люди но большая часть видно что большая часть депутатов который выступает госдумы зарабатывают не так уж и много а тех тотчас которым мог зарабатывать они как раз таки сядь сидят и молчат поймал мыша ешь не спеша opaque следующая они мая вот это базовое представление о d3 все остальное все остальное мелочи анимации производится с помощью метода транзишен то есть изначально мы назначаем какой-то стиль с вами этот транзишен и следующий стиль если мы допустим то наш body плавно по дефолту в течение 1 секунды пока лестнице из одного цвета в другой подержится все традиционные и zengi и zengi это то как ваша анимация будет происходить то есть она будет идти либо линейно либо она будет сначала эти замедление потом ускорением либо наоборот очень советую вам на этот сайт зайти и посмотреть как работает лизинге и zengi такая штука что даже в самую простую какую то анимацию если вы добавлять туда немного ускорение и замедление ваши анимации становится сразу выглядеть богато красиво и и т.д. и т.п. точно так же в d3 10 большое количество layout of layout и это готовые шаблоны для основных визуализации данных давайте вам покажу какие то свои самые любимые вот допустим стрим граф стрим граф показывает форме потока различные данные тут они рандомно меняются и это понимаете это снято это ролик с браузера это работает везде и вот так то есть это работает быстро качественно и мне очень нравится я как человек который пришел во front-end из флэша который любит этот вектор этот графику что все это так хорошо работает мне это очень понравилось или допустим вот такая вот такой layout который но математически вы его за паритесь обсчитывать да как вам надо соединяет все потоки чтобы это ж не просто не просто они сужаются они соединяются в группки и вы можете натяжение это контролировать в d3 и то есть дефолта или вот мой любимый 3 map смотрите как красиво с резинками перестраивается 3 map онлайн в прямом режиме очень хорошо и того быстро и просто и главное что красиво всем спасибо запросу да спасибо за не такой вопрос насколько я знаю одна из причин использовать d3.js это возможность удобно работать с картами а можете прокомментировать это и даю удобно работать с картами я не могу прокомментировать потому что я всегда работал у нас был специальный человек картограф который занимался именно картами и ты как бы его часть ответственности до в d3 огромное количество всяких хелперов для работы с картами но к сожалению это немного не моя специализация у нас был картограф которые который прям сказки не работает вот там нас как я понимает он тоже все достаточно просто я у через он там и все остальные как дела если какие-то опыты по адаптации инфографика потому что им большинстве случаев когда я захожу на самой крутой инфографики с тем что у меня есть кармане я расстроена закрываю больше не возвращаюсь но вот эти вот примеры которые довольство мои два да они хорошо работают в айпэде в айфоне не хорошо работает потому что неудобно ватиканский нажимать но d3 работает из своего работает достаточно хорошо на всех мобильных устройствах но речь даже не столько при d3 сколько про то что видел ли ты хотя бы одну от общины и фотографии которые хорошо смотрится и на а и маки и на айфоне но скорее всего мне кажется что сделать это нельзя надо сутки делать разные версии потому что но это это не такой адаптив который notes layout приходится сильно менять если мы изменяем размер экрана и визуализации данных все-таки такая штука который требует простора все-таки на экране чтобы это были ввел наглядно видно было истории а насколько сильно участвуешь ты или другие технологии которые непосредственно воплощает все это в визуальных решениях это все рисую дизайнеров исключительно копите или нужно быть творческим фантазером таким ну у меня есть большой дизайнерский background я был дизайнером потом flash роман часу контейнером дам изначально когда редактор находит какие-то данные мы все собираемся редактор дизайнер и программист и мы лишаем как это лучше сделать то есть завершается со коллегиально а и после этого дизайнер уже как он сам это видит все это отрисовывать ну и конечно мы часто ходим дизайн и молодым человеком ты чё-то не то нарисовал ее ну как всегда больше нет вопрос ну хорошо тогда спасибо за спасибо вам"
}