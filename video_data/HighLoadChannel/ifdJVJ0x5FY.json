{
  "video_id": "ifdJVJ0x5FY",
  "channel": "HighLoadChannel",
  "title": "Способы компиляции C/C++ в Webassembly / Михаил Воронов (Fluence Labs)",
  "views": 1111,
  "duration": 3098,
  "published": "2020-04-14T11:26:20-07:00",
  "text": "всем привет меня зовут михаил я работаю компании флейм сапсане ram вот и сегодня буду рассказывать о том как собственно можно компилировать большой си си плюс плюс проекты на выбор m2 server сайт я бы точно позже расскажу вас начала хотелось бы задать вопрос а кто вообще из присутствующих здесь что-то пробовал написать для басом ля 0 на вы басом ля один шаг отличная кто знаком хотя бы примерно септик туре лица больше супер отлично а кто слышал такое слово в азии отлично значит быть интересно но если много обо мне я очень долгое время занималась системным программированием ну вот и последнее больше года занимаюсь утаим аббасом blue в компании friends labs вот и также являюсь одним из организаторов ибо семь этапов москве поэтому кому интересно погрузиться будет после доклада более глубоко всем обо всем ли можете подходить ко мне вот и что группы есть специальные группа в телеграме это одна из самых больших группы abba семьи она в аббасом нижнее подчёркивание ru вот там порядка 600 человек а кому то станет интересно можете взять и дней телеграме либо зайти в эту группу собственно чему его спросил то что знает потому что у меня доклад будет состоять из трех остальных частей во-первых я расскажу немного про выборы и право задать четыре буквы читаются как в азии во вторых я расскажу как можно компилировать с проекты с помощью ну 2-я компиляторов и emscripten а и силам я дал обоссым бля и третья часть будет посвящена полностью редиса его архитектуре мы посмотрим как он работает изнутри как устроены событий на ориентированная модель и как именно мы его портировали а вот так что бытового возможно запустить на в оба сабля в том числе и в браузере и в конце я приведу некоторые конкретные советы портирования то есть совета то есть там будут примерно к технике которые помогут вам быстрее портировать тоже проект и какие-то проблемы с которыми столкнется примерно каждый кто будет сделали server side a и у меня значит вот такие вот две ручные слайды а по темам и кто знает как этой темы кому интересно это можете включаться на конкретном своей а вот ну давайте начнем с боссом бля так как только один человек поднял руку и что-то дело нового сэм бля я расскажу про это чуть подробнее нам для начала вообще кому и зачем это нужно это лучше рассмотреть на примере существующих проектов на самом деле вы бассем ли делится ну как бы исторически он был создан для выбора далее ускорение приложение запускаемой браузере то есть это какая-то аналогия наклон посетив клиент от гугла либо там pinnacle вот и сейчас существует очень много таких шоу кейсов хороших вот и преимуществ игры вот например есть внутри нато изнутри портирован либо семьи с помощью emscripten а и вы можете запретить его себя в браузере это будет doom 3 а как он будет работать он будет скачивать слабо сэмпле пока браузер и спускаться в браузере никакого сервер сайта то есть это все будет у вас на компьютере для этого не нужно как бы до этого уже только браузер он даже даже телефоне до из телефон потянет ли этого как бы не нужно мне нужен windows дата мне нужна какая-то определенная операционная система нужен просто браузера а помимо думая из интересных проектов есть dosbox форсированный еду zbox можно запретить в браузере а в боксе например можно запустить на герой 2 вот играет не пока еще не портировали но мы с этим работаем а также из интересных проектов есть autocad на который позволяет за три щелчка мыши в общем дайте и спроектировать и рисовать съемки браузере между установки непосредственно autocad на ваш компьютер вот ну так же google всем знакомо и вот интересный проект раза full для используемая для deep линга машину обучения а его тоже можно использовать браузере также помимо всего прочего а и по этом ноутбуке портирована вам assembly и много чего еще вот но сегодня я бы хотел сосредоточиться больше именно на сервер сайта по сабля до этого этого бассем ли которая исполняется не браузере а на как бы на на сервере тут примеров меньше потому что в вас m2 server сайт ну наверное такое активное активное движение вот он панин ничего здecь то наверное года полтора назад вот и примеров таких громких проектов не очень много но например есть компания fast я достаточно известная она занимается сединам они есть в общем террариум террариум это как клауд компьютинга платформа который можно видеть оба сам ли клад и который будет исполняться у них кладя также у них сидел есть и специальные языки висели которая также внутри используются по сабле на эту многие из вас слышали про эфир да вот ребята планируют дает эфир использует эфиру виртуальную машину свое я не планирует через год запустить эфир 20 который будет вместо собственного торопи и филевской виртуальной машины использовать в оба семьи потому что в оба сэм были а он детерминирован за исключением 3 3 пунктов я не смогу потом потом подруги рассказать ну и вообще с криптовалютами на самом деле обо всем ли обрел второе может быть 3 дыхания потому что очень большое количество криптовалюты вот овчины вычисления она производится именно в оба сабли но еще из примеров это вот третий пункт это лабаз м для вида я то есть этот проект был создан в рамках google code summer eau вот и он действительно работает и можно запретить его possibly a на них сахариды и третий проект этого бассем ли пакетный менеджер вот он приведён вот здесь прощение мечтам приведено здесь вот внизу экрана примеру в использовании и как мы видим тут можно просто порой команд установите квартиру на его бассем были моды до нас учит аула запустить его и собственно как бы использовать из консоли но такой ультимативные шоукейс salomon x это как у founder докера вот он тут пишут о том что если будет ещё восьмом году был бы в бассейн и связи то ни было необходимости докере да и он видит за обо всем ли будущее сервис сайт вычислений но я думаю нет причин ему не верить и давайте при ответе на вопрос что же такой выбор м а я вот этот слайд позаимствовал у бэна смитом бен смит это но все возвращение бен смит это значит глава core группы в бассейн для кур группа занимается стандартизацией всеми вопросами связанными с аббасом бля вот или оба очень классный толк носи типиконе месяц назад и вот всем рекомендую посмотреть помним концентрировался именно на и м скриптами и в вашем браузере и вот тут представлена значит варианты конструирование определения в оба сэм ли я их очень много я для себя выбрал следующие бассем ли это открытый формат с такой виртуальной машины которая основана на гарвардской архитектуре да то есть у нас код одели на данных который определяет а appearance стек так как и любая стыковые машина как например дживы им обряд линейный память данные там специальные таблицы но особо углубляться не будем я могу потом подробнее после после презентации рассказать что интересная обособленный момент всего четыре базовых типа это два для винтов 300 2004 битные и то же самое для фатин поинтов есть нету никаких куда тебя нету структур нет ничего то есть все представлено только четырьмя типами например соска эта функция принимает поинта на массив то это как в зависимости от архитектуры соответствующий int и вывоз эмбрион появился на самом деле не так давно этот формат активно развивается очень много по озеру вот rens папа узлов он позволяет как бы он добавляет оба сэмпле тип для simd операций 128-битный то есть он как бы уже есть во многих виртуальных машинах но пока нету standards нету в виде обо всем ли 10 до его the bosom бля как бы сам по себе он не может исполняться на этот мы также как живым для него нужна специальная виртуальная машина вот по-английски это называется x кувшины varmint я буду называть от виртуальной машины но для простоты из гришин women произносить каждый раз сложно их можно разделить таких на два пересекающихся класса это во-первых и браузерные виртуальные машины у которой есть там кроме фаерфоксе до 85 гр monkey мешках и сервер сайт виртуальной машины вот здесь представлены наиболее интересные из них это вот 2 фильм по нашим тестом это самая быстрая виртуальная машина она использует и у м jit животные не только по нашему самом деле и вот таких два конкурирующих проекта вас мир i was in time от вас мира разрабатывается отдельной компании и его ключевой особенностью является то что он поддерживает 3 компилятора то есть это как бы такой фонд and in a b кэндис 3 компилятора а там кто то самое avenged который мы говорил крыльев и a single pass или вадима вам называется и вот последний он известен он такой под project но он интересен тем что он компилирует в бассейн блефуем дает это реально работает мы но мы его использовали изначально час мы используем master of ravens labs но в целом то есть такой подружек а там по моему 150 комментов в репе но это все работает и редис и не скрывает на нем отлично работают на 48 ли определяет этого формата текстовые бинарные вот ну лучше всего понять обособленно бинарном формате здесь представлены основные секции но когда есть очевидные секции секции кода есть менее очевидно например секции типов вот в секции типов описаны типы которые могут принимать функция типы сдаются с таким образом что таким образом что вот да стрелочка указывается то что должно быть на стыке до вызова функции и после стрелочки то что функция возвращает 0 тип говорит о том что то эта функция принимает два and a и возвращает настойкой тоже деньги вот второй тип означает что как бы это уводит его это грубо говоря у нас дальше будет интересовать две стальные секции эта секция импорта doktor указываются функции которые портируют данный модуль и секция экспорта ну да его по-своему еще типизированный то есть помимо вот типа функции стёпа о перемена о инструкции то же самое что джим и appearance так он тоже типизированный например вы не можете сложить фатин points anthem тому что это может быть интернированным например можно сложить только например 2 хватит пойнта одинаковой размерности вот противном случае будет по 7 литров и на самом деле вот как и говорил основные основная как бы работа крутится вокруг импорта-экспорта почему так потому что бассем были модуль он не может сам по себе что-то сделать он не может сходить в диска он не может вызвать никакой функции это по сути можно представить себе как программу на gpu она ничего не может сделать сама по себе ног но если нужно обратиться во например в жесткий диск либо в сеть оно делают это с помощью импорт of то есть вот бинарном формате определяется функций которая может дёрнуться бассем ли программа да и помимо этого есть еще экспорта экспорта это по сути внешний api чистка через которое можно этот модуль дернуть ну и соответственно тоже есть типы да как бы нужно вызывать функции с правильными типами дата вкратце про оба сабля давайте щедрыми немножко профазе от в азии это такое а как бы новый стандарт он появился в марте апреле этого года то есть символ порядка полгода а это стандарт который говорит о том как должны быть устроены импорта он определяет нескольким протоков попозже покажу но в целом выглядит так что это специальная липцы я которая состоит из трех уровней на первом уровне у нас массовым немного измененный наладить картинки посередине у нас или пропан который мы ждали того чтобы делать какой-то сын boxing она отвечает за то каким директория мы можем обращаться с какими правами и на последнем уровне у нас клауд обе которая как орске конвертирует нашей как бы вызовы им импорта его нужный формат формат ну когда вы здесь вот результаты и примите шансов lazy это на самом деле виртуальной машины чтобы запустить вазе модуль виртуальная машина должна по сути просто уметь обрабатывать такие импорта их порядка 50 они все по sextile а да то есть как бы нет угадывая стала the orc orc свет там и в дире ты в де сика ну понятно то есть часть а название непосредственно спорте какая-то часть чуть изменена вот но в целом как бы все более менее очевидно и как это все работает если у вас есть какая-то сиси пришлют программы и и компилируете сил янгом и потом получается модуль в котором есть импорт и стандартизированные да то есть если у вас изначально был какой-нибудь например все out as seo транслируется просто обдувает да то есть но там библиотечный код гриб вот и но в конце будет системный вызов и точнее будет вызов импорта и выбирает и по сути виртуальная машина просто должна уметь все вот эти порядка 50 импорт of правильно обрабатывать вот например а если посмотреть такое hello world а скомпилировать целевого бассем бля с помощью waze а можно увидеть что будет всего 5 импортом одессе готов да right of dried ты в достиг они идут и стандартной библиотеки помочь они если то мы следуем подключается историю подключается там месяца глобальные и современность и до утра у которых есть кубики вот поэтому они тоже тут в этом списке то по факту чтобы запустить ховард просто нужно имплементировать вот эти пять импорт of но на самом деле к сожалению не все так хорошо как хотелось бы потому что в азии но порядка полгода чуть больше и он много чего не умеет к примеру не умеют сети а он например не умеет работу не может многопоточность не может вы синхронности у него нету поддержки со jump off alone граммов над этим всем активно ведется работа этот репозитории git хоп crane лифт то можно найти возили pc и в азии знака каждый может вы contribute тоже это делаю наличие при наличии свободного времени но в целом это здесь и плюс по сути лучшее что есть такие давай теперь посмотрим собственно как как можно скомпилировать вот как бы сегодня он использует понятно его был евреем с 8 версия с 80 единиц и не ошибаюсь он торги для вас м ли поддерживает по дефолту раньше в седьмой версии он поддерживал экспериментальная нужно его было будет специального барон теперь он есть по дефолту ты что это знаете что есть разные тузы типа i will our для упаковки архивов и а в ммм а есть значит ним общий квас мы в.д. это все есть теперь по умолчанию и есть 2 triple а вот штука называется с кнопкой это называется 3pamm на то есть вот здесь первая часть это значит архитектура потом операционная система и огонь и есть два три по то есть 1 people нельзя просто так взять и использовать почему потому что нужно специально собранный из рук на самом деле си суд есть только один помимо возня дополнительный он вот находится под этому репозитория под этом пути и как мы видим это вот это просто под project человека если не ошибаюсь он работает тоже в угле либо выпало я не помню точно сейчас и как бы он уже не поддерживается то есть сейчас на данный момент возможно скомпилировать только в азии только с им портами вот ежели она была компилировать секрет пустот без импорта по возможности давайте посмотрим как можно скомпилировать простейший почти плюс плюс с помощью кроме во первых нам нужно указать и под то что называется sea south давай сейчас он здесь это путь к системному все сотрутся набор ёлочных файлов и в биотек во вторых нужно указать трепал на тот он называется таргет в некоторых новых семьях это ой таргет вот с афазии 60 можно вот о новом центре не писать про стать вас 32 вазе да и можно собирать значит как библиотеку и как бинарник будет отличаться тем что бинарник экспортирует один символ старт библиотека экспортирует то что вы укажете здесь есть определенные функции например здесь экспортируется функция in волк мы также можно очень много ну как бы сколько угодно функции экспортировать так как вот если мы соберём и вот как бы посмотрим текстовые форматы оба стебли 8 есть бинарный которая показывает текстовый текстовый выглядит как лист экспресс с экспертами вот и тут будет несколько экспорта в таких странных давайте посмотрим вот на шестую седьмую строки и bass & data and a что это такое это экспорт который равен global 1 главу угла 1 главу угла не определено 3 4 статья и по нему можем понять что вот google 2 он меньше чем в 1 до это но это чисто эта байка за это просто как бы не эффект это просто читаю из точное число что это такое на самом деле у вас модель хитро устраивает layout но мемориал памяти что-то все это линейная память модуля она может только расти в одну сторону не может уменьшаться есть только две инструкции memory stick взять еще одна и мымре гравюре читаете она стоит и из нескольких частей вот частности в его памяти и лежат то есть данные до данные это то чтобы в альфе было там секции bss это также памяти лежит стек а кто-нибудь может сказать почему памяти нужно класть так у нас есть как appearance т.к. на который как живым а есть еще стек памяти которая называется шоу 100 ком есть идея почему так должен памяти да отлично то есть во первых мы можем объявить массив на стыке если бы это все было в appearance таких вот там звучит живым а то и очень хорошо примерно в случись и мы можем видеть и массив настоятеля и мы можем более того взять адрес переменной со стока и границ про передать его функцию поэтому вот эти данные они должны быть где-то быть и вот тут они помещены в линейную памяти и стык фиксированного размера до можно управлять его его размерам все остальное место занимает куча и они растут так же как в x86 в разные стороны противоположное вот об этом он news ты ее скажу в конце и собственно data and говорит о том где кончают статичные данные и he buys говорит о том где кончается стек и можно записывать данные в кучу и вот буквально 11 проедем скрипт он потому что про него очень-очень много информации интернете даже есть книгоиздатель он опасен для поэтому я не буду повторяться вот инцес криптон этот исторический первый способ скомпилировать секрет в бассем ли вот он изначально использовал изначально он был создан тысяч одиннадцатом году и он компилирует lvm в java script ну точнее потому что джим старджесс а позже у него была добавлена поддержка вазом на основе боярин то есть часть снг скомпилировалось java script кривой код вот и вот буквально месяца два назад а по дефолту он стал использовать clank для сбора компиляция уильяма вы оба семьи и на самом деле он представляет много намного больше возможностей чем в азии почему потому что он эмулирует большую часть пасек стандарта в java script поля например он эмулирует 3d он эмулирует файловую систему через мфс даже может эмулировать соки то через 2 соки то и много чего еще но добрая doom 3 импортированы как бы достаточно просто красота того что из пользуемся им скриптом но давайте теперь перейдем к ним со снорри лесу да вот у первых вопрос вообще зачем нужна портировать среди слабо сабли кажется так он как бы неплохо работает сервер сайты как бы при чем тут вообще у вас а мне и тут и расскажу немножко про то чем занимается наша компания а именно мы делаем децентрализованное учитесь винное облако если кто-то захочет сделать git платно на без единого вторить и который не может начать банить людей пастране пожелания то вполне возможно сделать иванов рейсы но та же самая беги то были других сервисов где-нибудь единого париться как это работает у нас есть облака стоящая на износ вот и в облака пользователь загружает свой выбор сэмпле код и общается с ним вспомнить request resman сами с помощью массива байтов и наша задача чтобы вот в этот код работал быстро дозатор минирован и унифицирована и вот поэтому и выбрали в оба семьи потому что но обособленные более хорошо это будет варя it так устроен наш архитектура у нас есть два уровня впитывая security layer 21 раз состоит из сквозь строк из небольшого количества note 4 21 на каждом классе развернуто один и тот же инстанция бассем le nouveau земли модели например regis а когда пользователь делает 4 квест с помощью байта передачи батарея все ноды выполняют один и тот же request то есть каждый из нас мечтает одно и то же за этим гарантируется пир системность вот и после на результатах формируется с помощью этот термин то объекте консенсус результат отправляется пользователь на самом деле очень много чего на картинке еще из дополнительного но это как бы отоскоп данного доклада целом наша задача такая чтобы кот работу детерминировано для этого например от двух первой версии флюенс и у нас не должно было быть никаких импорт of потому что любой импорт это созданием termini зм на было потому что как бы обо всем ли кот никак не может отвечать за то что но зато функций который вызову то что она обрабатывается не в нем и теперь давайте не непосредственно перейдём к кризису и к его архитектуре редис на самом деле он очень хорошо написана могли то есть он написан на си там очевидные названия но если ты открываешь файл с названием серой . сид там именно часть которая качается сервер то ест открывающих файла названием моду модуль . си довольная часть который отвечает загрузку модули местам как бы очень много комментариев и на мой взгляд код написан хорошо и нем очень просто разобраться с большого количества комментариях и вот я поделил regis на несколько частей да как бы но основные из них это ядро которой все управляет объектива модули по система скриптинг который подают его скриптами и так далее и так далее вот я их представил как то так то есть нужно понимать что это он больше квадратики это как бы название модулей которые там я сам выбрал да и вот внутри маленький подарочек от названия файлов который которых реализован данный модуль просто хищные файла ну редис известен своими структурами данных их очень много здесь они как бы проведены файлы исходного кода которым примите ровать ее структуру данных вот как это все выглядит в работе то есть regis работает можно сказать в одном трейде до этого треть из 50 дней потому что это редис скажу апреля этого года его апреле портировал как как все это можно представить есть большой как бы есть отдельный реле звук который от который когда просыпаются значит он выполняет а потом он а потом и собственно досыпая до следующего ивента когда приходит следующий want из двух очередей учить файлы и очередь по таймеру вот он берет у него есть специальный алгоритм какой такой нищета под действие сделать он берет это действие и вызывает соответствующую систему но вот эти подсистемы до нужно понимать что это просто как бы по система именно в моем понимании это все тайники тайне микро сервиса не отдельные тренда не процесса это вот как бы просто пойти по его исходного кода и тип систему со очередь могут генерировать еще ивента который также последствии будут этим циклом выбраны и выполнена вот например клиенты а клиента это собственно непосредственно как бы клиенты редиса и также клиентом является другой инста среди со приказ то ли за ты либо например скрипт он является клиентом в одессе некоторых случаях они общаются с 5 мы над working да и вот вот это все работает потом треде за исключением ленивых операций есть дополнительно 43 до они лись обозначить внизу как бы ground рации а они нужны например для отложено удаления либо для некоторых background операции давайте рассмотрим как это примерно все работает вот начали значит это запускается мы бэйна вызывается серверы нет серую нет регистрируется файл event но зато файловым эта функция которая там с помощью макроса на может быть использовать разные асинхронные примите в операционной системы например полинг либо там какую либо что то еще вот из опыта регистрируется хендлер на здесь асептически гендер это собственно определенные сроки до полинга вот потом предположим что тот момент клиент открывается изменения вот это соединение остается файловым для этого соединения какой-то момент собсно релиз куру доходит до этого ивента и собственно его обрабатывая до обрабатывает его он с помощью вызова других модулей которые очередь могут генерировать как бы другие vento вот например если запрос был что-то типового скрипта это вызывается модуль файлов скриптинг который например тоже можно сгенерировать другое событие если какой-то долгая операция но много и мистикой вот но в конце концов формируя как бы результат формируется и отправляется тоже система networking нужно понимать что на паркинг тоже можно сгенерировать event а если очень длинный ответ вот он может отправляться по частям вот это все работает асинхронная и не до заминирован абсолютно то есть это все зависит от большого количества факторов от операционной системы от софта железо и так далее так далее у нас это все не выходила потому что у нас для консенсуса релиз должен работать до 3 минирован а вот и собственном пришлось очень сильно изменить его архитектура по сути грубо говоря мы его линия рисования первых мы вырезали многие модели которые которые не могут быть спортивного бас земли например модуль для загрузки модулей т.е. да потому что папа сейчас момент это не поддерживает по дефолту но осталось 4 модуля вот один из них например skype think то есть мы можно использовать исполнять его скрипты децентрализованной в одессе вот и все это работает теперь и вот так то есть все линейные теперь могу тут поставить часу я знаю что там сначала происходит значит опроса клиентов они не реализуются доли листа там нашим софт он написано на столе вот но и я точно знаю что когда запрос приходит он не чем больше не прерывается и присед пришествие запроса да у нас для этого запроса формируется ответ и только потом обрабатывается следующие request то есть все стало детерминировано но при этом вот такой вредный редис он сохраняет все структуры данных практически кроме о некоторых бэкграунд операции то есть кроме в из операции там есть еще некоторые там бы ground а разные вещи их и очень много то есть все основные структуры данных они были сохранение о скриптинг тоже был сохранён это все можно попробовать нашим дашборде на самом последнем слайде будет ссылка вот и давайте передём к последней части а именно к советам по портирования значит я говорю о том как устроена mamrie out в после компилирования сил angam и это накладывает некоторые точнее это меняет дамбы с которым будут падать определенные типы ошибок например 100 к верху на это все зависит конечно от виртуальной машины но с таким холодом и свечи он там не переполнит не перед адреса врата он не перед пилатом что такое три диска районы либо берегу что такое он может перетереть значит этичные данные вот то есть как бы крэш данн может отличаться абсолютно сильно систем x86 и например на point родри france да это как бы define be here вот но в случае x86 чаще всего он упадет sick sick из не ошибаюсь потому что у нас первый несколько килобайт первые несколько страниц в адресном пространстве они зама плен и без кода доступа здесь делается то же самое некоторым обеспечен varmint и поэтому это первая страница этот один килобайт он ну как бы такое не используемый для того чтобы виртуальной машины его тоже матери без прав доступа но не все конечно виртуальные машины это делают то есть все основные от вас 1 100 ml of ему доделывают новыми assembly это не делает а потому что там байт буфер в джаве там это сделать сложновато вот и есть такой совет при любом даже небольшом измене архитектуры исходного проекта его стоит компилировать в x86 этой драме и прогонять всевозможные тесты в которые в нем есть ну либо который вы сами можете придумать потому что вот вы оба сэмпле часто например на stackoverflow и заставы холл приложение может не упасть очень долго ну собственно как на x86 на x86 почти наверное она упадет такой очевидный совет на не нужно игнорировать предупреждения компилятора а в случае как бы это не нужно делать конечно всегда а независимо торги танос лучевого сам бля может генерироваться не валидный модами почему вот например такая вот казалось бы безобидной варнинг а то что это вор на интегрированные вас малдин венгером нам говорит о том что было найдено 2 функции с отличающимися сигнатурами если посмотреть то здесь сигнатуры отличаются возвращаемым значением потом сучьего и другом случае интер здесь две функции ссылки x86 by ничего не случилось почему потому что результат возвращается в регистрах она в регистре я x и barracks да если он не используется то как бы он бэкон почти всем комменты вызова он не должен забыть перед системном между вызвали случае оба сэмпле у нас т.к. виртуальные машины и ждет означается на стыке что это означает это означает что компилятор генерирует дополнительную инструкции дробь на 10 между два примера то есть это вывески того что будет сразу после лоис в этих функций вот и перезагрузкой в бассейн для модуля любой виртуальную машину происходит его валидация также учит живым и такой модель просто не будет загружен то есть его можно сбить но использовать сегодня как нельзя этот баг есть в трекере он заведен но пока к сожалению он еще не поправлен вот ну и здесь на самом деле он проявляется так что нужно подключить и стыдили вот и тогда как бы дворников не будет ну и такое тоже капитанский совет то что отдыхаем by heather это всем отдыхать до севера и компилятор может генерировать произвольный его басом блэкаут если у вас отдыхаем by heather эта тема очень много где рассмотрено грей замечательная статья на хабре рекомендую почитайте там про то как люди столкнулись с tranque шинам in the floating point ну вот ну и так достаточно много информации она прям столкнулась с тем что качественный сдвиг на больше то есть 3 петли им то было tv by heather вот это был в одном сплавов редиса и на этом все падало вот значит как вообще портировать деле себя как бы пришел к выводу что удобно использовать макросы когда можно было просто там взять и мой исходный код удалить изменять еще как и еще что то с ним делать на самом деле например это не удобно если вы хотите обновлять здесь вы хотите изоб стрима подтягивайте мнение это все неудобно будет очень большой div а вот с помощью вот такого очевидного подхода можно писать простой скрипт который будет обновлять более менее безболезненно помимо всего прочего силой предоставляет несколько entry стиков их три основных это как я говорю моим ресайз мэмри грол есть еще энди stick андрич иво андрич и вот специальная инструкция которая генерирует выбросом летроп то есть посреди исключения по давайте посмотрим поподробнее на из труб старичку давайте представим что нас есть какая-то такая вот функция в которой есть а сердце и вот при компиляции обоссым ли будет значит примерно вот такой код часть кода что в нем самое важное вот например строках 5 6 7 и как раз наш при turn a + 1 строки 10 и 11 это вызов assert файл да то есть вот по 8 структурный контру фол и вот внутри бог воевал 0 как раз таки находится валидный код если вот до ritorna собственно после этого блока находится код который выполняет черт если смысле если выражение неверно и вот здесь конце ставни и струбцины ищу бога почему потому что ну как бы компиляторы предполагает что сердце его выведет ошибку и сделай что-нибудь типа это управление никогда не должно дойти до но спустя вот вдоль струбцины чему она часто генерируются компиляторами для того чтобы потом вот компиляторами вас земля для того чтобы компилятор из его бассейны нативный код какие то они могли это оптимизировать на то что как есть какой-то начата базовый блок недоступен и о можно каким-то образом оптимизировать вот к чему это может привести это может привести к тому что будут такие стектрейсы в которых у вас будет elegance truction почему потому что пусть все компиляторы заменяют от сатаны и чубова на значит особую инструкцию уд-2 эта инструкция ну как бы да бывает на инструкция которая по сути является или construction a генерирует сигнал elegance так то есть нормальная ситуация мне никогда не должны исполнить эту инструкцию но если например у нас отдыхает by heather либо какой-то assert а там где баги либо что-то подобное вот и если вы видите что значит вы подключились отладчиком да и вот увидели что мы остановились на инструкцию до 2 и начнут сигнал или construction это скорее всего опыта отдыхать heavy либо какой-то сюр либо что-то подобное есть не нужно этого пугаться как бы это не император дибирова неправильный код у вас какая-то там неправильно инструкция это на самом деле вот где-то выполнился на речку и теперь давайте еще поговорим много про памяти то сайт появился вчера вечером почему сейчас расскажу почему вот был значит сайты где показывал какие есть экспорт и весь первый строя строкой специально оставил memory to go to memory есть скобочках 0 до есть то есть это 0 память о bass в любой несколько памяти боковой api только одна но о будущем может быть несколько и 15 означает начальный размер памяти баба сембой страница 8 страница это 64 килобайта присси начально модулю требуется 64 килобайта что это такое это по сути вот эти два вот это и низшего которая нарисована на лад а ты съемки это и мешалку дефолта одно равно хиба iso округлённо му вверх к размеру обо всем ли страница она всегда находится где-то в куча и также вот можно указать второе число после 15 это будет максимальный размер памяти вот а почему то свой появился потому что азия она что изначально он работал каким образом у него была локатора диалог и диалог внутри себя он вызывал сбр к 0 для определения бриза откуда можно собственно писать данные и сборка 0 вазе будут лимитирован так что он вызвал просто мимо ресайз текущего знаем о мире и все виртуальные машины на мемы ресайз они должны были отдавать и мешал границу и это приводило к тому что вот это пространство между he buys и ничего ну никак не использовать это пространство до 64 килобайта и более того некоторые люди погляди нечего выставить больше чтобы как бы ну то что их кажется что и лишь вот какая то такая память который должна быть изначально провоцировала вот это вот выбор simply by перестали вот этот вопрос мечте выстрелы ничего равны максимум у меня модуль падает вот что делать это на самом деле была проблема в вазе дождь и базе никак не использую he bass вот я как бы сделал пул request две недели назад его заминли и вчера его приготовить почему потому что в в m90 короче есть косяк который некоторых случаях и bass не генерирует символ из его нету в экспорт ах вот то есть в lm80 в мастере такой косяк был его поправили но пока не забудь портировали 90 вот и к сожалению пока можно столкнуться с тем что у вас есть много про падающего пустое пространство но кому он кому это важно то можете найти мой реквест это 114 на 801 все работает замечательно следующий совет по тебе говорил что в азии не поддерживается джампа и вот belong джампа они часто нужны они нужны например вот в рейде себе того чтобы еще не видите аву а для того чтобы в ума значит имплементировать обработка исключений но на самом деле почти все популярные виртуальной машины в частности вас мире was in time во фрейм скорее всего тоже не не проверял они представляют возможность открываться с этими функциями и они по лимитировано просто в них как это происходит у вас модуль будет импортироваться jump jump виртуальная машина сама при погрузке этого модуля будет его правильно обрабатывать ну и помимо этого почти все виртуальной машины у них есть brintv функции или отладки и давайте поговорим про отладку как можно отложить опасен для к сожалению не таким большим количеством способов почти всегда сервер сайт отлаживается с помощью принтеров да как бы стандартный способ все виртуальные машины это поддерживают вот если вы ну как бы да и само собой gdb осени приходил использую gdb вот но если вы делаете что то ли браузера и вас есть source маппинг и то вы можете через dev tool с браузерные который поддерживается семен там chrome и firefox мудрый на самом деле наиболее хорошая поддержка лучше фаерфоксе потому что как бы перед mozilla амо зил 11 труба 7 для основных вот там можно ставить брать помнит это можно ходить по инструкциям там есть source mapping вот там можно свою семейную памяти appearance т.к. то есть там как бы есть все все эти способы отладки которые хотелось бы иметь и сервер сайта помимо всего прочего вот есть последний пункт это туза составе боярин который позволяет интерпретировать инструкция бассем ли и просто водить их список до из вас какая-то небольшая программа иногда это может быть полезно и атлас мира можно собрать в дебаг режиме написано там нарастили собой собак режиме у него будет больше на трассировка уазик импорт of ну это какой-то будет аналог из trace дано из то есть это лучше чем ничего вот и хотелось бы закончить значит тем что вот портирование сиси поезда skoda она очень сильно зависит от таргета того вы портирует типа баузера либо под сервис сайт по браузер портировать на мой взгляд гораздо проще из того что этим скриптом эмулирует огромную часть по six подсистема да там 3d и сетевую часть диска вот давайте пока умеет зато не все меньше во-вторых часто оказывается что вот для большого проекта полностью портировать нельзя ну например если проекте из какой-то график когда-то очевидно графика на оба сэм любой носитель но как во первых не стоит во вторых и и не получится и почти всегда так бывает что можно выделить какое-то ядро которая можно форсировать нава басин для а все остальное значит исполнить либо джалла skype те либо либо на уровне виртуальной машины нотами борна кастомизировать да и вот портированные релиз его можно использовать как в браузере так и например а не знаю как отдельный какой-то модуль его можно найти в нашем репозиториев ремесла пс позвали div с оригинальным редисом то это будет порядка 2000 строк это виду вот этих макросов да и там примерно 300 это докер файла гетеро и вот это все вот работа с него примерно 5 месяцев вот так что спасибо и вот по этой ссылке можно найти на жду шпорт там можно подняться на птиц образованный редиски light тоже портированные и с ними поиграться также можно загрузить свой код который быть может быть свинка ван с редисом за школой там это будет как бы такая мини операционной системы потому что каждый из нас будет обладает своей собственной позиции вот это всем спасибо мишка доклад вопрос такой вот портированием редиса не возникало ли проблем допустим минорной версии одесса меняется и вы хотите обновить порт редиса и какие-то проблемы говорил про то что пришлось немножко архитектуру поменять а если бы она изменилась но сильнее чем ты думал вот какие-то такие проблемы у вас были смотри на самом деле я пробовал бы проектировать не так ну как примерно в августе а на самом деле сейчас архитектурой лишь чуть поменялось появилось несколько файлов на графа la connection . си который вот часть на паркинга в себе она содержит но вот из-за вот этого подхода нам не нужно большому счету не как ты счастлив если не добавляется новых файлов да если касаться . внутри одного файла и он не очень сильно меняется с такого подхода а по сути не нужно задумываться в архитектуре долги за к меньшая часть которой отвечает за классе царь api редиса и по сути там но почти такая же я скорее всего будет в по измененному в об стриме вот и вот бугре таким окрасом это можно делать более менее безболезненно я пробовал на снипам точной версии релиз и августовскую но в целом это было достаточно быстро понятно но все равно получит 100 процентно автоматизировать этот процесс нельзя потому что никто не не дает гарантии что архитектура в какой-то момент не станет совсем другой спасибо если нет вопроса всем спасибо за доклад у меня вопрос вот вы говорили что вам пришлось вырезать там несколько модулей чтобы получить эту деталь минирован ность нельзя было их также выбросить просто из исходного кода не портируют по сути так и получилось то что когда говорил вы ли здесь модуля это означало что в моем exсel они просто не включаются некоторые а некоторые вот например файл networking когда который на который нельзя исключить и то вот очень много этих макросов которые меняют его так чтобы он работал не соки to me alone работал сам другой внешней функции которые предписывают даму спасу по сути так как бы это не то что я выкидывал модели то что я выкидывала исходные файлы часть часть его полностью частицы изменялась ну смысле вообще можно было бы достигнуть только детерминированности не бартеру я либо семьи аспектом носил на самом деле то что написано сейчас можно скомпилировать него поставлю можно комбинировать в x86 и это будет отрегулирована вот без изменения архитектуры это невозможно потому что вот этот цикл асинхронный он абсолютно не терменировали полностью зависит от операционной система спасибо еще один вопрос вот браузере еще понятно для чего вы оба сэм бля а вот на сервере очищены совсем понятно чем допустим у него преимущество той же живые например ну ты такой холивар ный вопрос сейчас а дома-то и доставит вас война холивар на вопрос почему потому что я на самом деле думаю что какой-то момент в обо всем ли может заменить с черным в чем-то потому что сейчас спецификация вас м для на беднее чем живём например нету исключения нету там еще много чего от рогов но будущем они как бы уже по пропал узам они сравнялись и будущем скорее всего у вас м liquid момента пойдёт и на мой взгляд а и вот собственно как говорит о самом он значит можно было бы нового сэм ли по сути заменить докер то есть вот с помощью чего то такого да уже можно добиться поведение как у докера блокируя ну по сути дела и сэндбокс вот на возить на вазе импорта разрешая или запрещаю определенные из них можно добиться примерно поведение как у дропбокса то есть я на самом деле вижу будущее тоже в этом что первых это детерминизм это важно для вот криптовалют и важно для проектов вот почему нам особенно важно потому что мы считаем кэш-памяти если нас будет любой интер мини зм то соответственно память поменяется да как бы и у нас кэш и соловьиного эффектом будет абсолютно другим вот и отбирает взрыв nismo второе это какая такая замена докера и может быть замену java будущем ну либо не полная замена либо частично а как бы те же самые скейте как у джалла была помощь его правда да у меня вопрос правильно ли я понимаю что данная машина виртуальная на браузер может сохранить стоит между двумя выполнения me но можно ли поставить на полку во-первых заполнение такого года и соответственно продолжите ну например после перезагрузки вкладке там это вопрос именно пробрался да про браузерную версию на самом деле это вопрос интересный почему потому что тогда говорил что тут два класса непересекающиеся вот я плохо знаю может ли это вы 85d monkey но это точно может вас на вас мире можно выгрузить даже snapshot памяти как бы загрузить обратно и мы по сути штукой в обо всем ли это стек и понять вы ну как бы и по сути какой-то указатели какая инструкция сейчас выполняется если мы можем все это выгрузить все это работает армирована да мы все это выгружаемых это место потом можем обратно это как snapshot подгрузить вот та а это можно исполнить и вот вас мира он есть в браузере можете зайти на сайт его бассем ли . ice age и там вот будет вот эта вот штука слово которое я показывал в предыдущем слайде это можно все дела браузере то есть ответ на это вопрос да я не знаю точности могут и это вы 80р monkey но вот вас но это может да еще пару вопросов первый был лес ну скорее всего не было но был ли опыта работы с графикой через к сожалению не было то есть на самом деле это интересно потому что там я примерно смотрел как устроен doom носом ничего такого графического не делу макей начни запросов когда ты благодарен нашему спикером"
}