{
  "video_id": "g0UGW7Xg7so",
  "channel": "HighLoadChannel",
  "title": "Применение машинного обучения в анализе научных данных / Александр Прошунин (ГК Иннотех)",
  "views": 480,
  "duration": 1555,
  "published": "2023-04-28T06:19:52-07:00",
  "text": "Всем добрый день собственно говоря хоть сегодня хотел бы вам рассказать про то как своей работе Мы использовали Различные подходы из машинного обучения в анализе именно научных данных и собственно говоря сегодня расскажу про два кейса которые мы решали если вкратце обо мне Я действительно можно сказать ученый Я являюсь младшим научным сотрудником факультет компьютерных наук в Воронежском государстве университете в том числе я главный аналитик и дата сантизм Группы компаний на тех и там по большей части занимаюсь машин Ленин пересечь и когда-то я пришел к своим друзьям и физикам и к ним лабораторию и видел Примерно вот такую картину которую вы сейчас видите То есть у них там стоит большое сложный аппарат вижу что на кремниевые подложке у них чипы и собственно говоря и поинтересовался что они такого интересного делают оказалось что они анализируют нанопленки контактов потому что на уровне чипов там уже контакты несколько слоев там атомов либо молекул и для анализа различных электро электрических свойств химических и физических нужно было понять как все эти подложки ложатся и взаимодействуют друг с другом и они рассказали большой проблеме что у них не особо получается Спектр раскладывать смесь у нас составляющие вещества и собственно говоря Я предложил им свою помощь и первый кейс как раз про то как мы анализировали спектры а реальный Спектр по сути выглядит подобным образом у нас есть по горизонтальной оси энергии гамма квантов и по вертикальной оси просто грубо говоря некоторое нормированные величина по сути в штуках но так Спектр не особо хорошо видно и чаще всего представляет таким уже непрерывным соединяя точки и Давайте попробуем смоделируем С чего он может состоять И вообще попробуем вначале обратный путь сделать пусть у нас есть некоторая смесь которую мы заранее сами задаем и к примеру это смесь различных оксидов кремния и Да это дробные валентности это определенная новая область физической химии и для них у нас были известные эталонные спектры когда мы сверх чистые вещества снимали и как суммированный Спектр бы выглядел по сути когда мы берем каждое вещество начинаем смешивать и Спектр начинает крайне сильно суммарно меняться и самое грустное что в конце мы так или иначе всегда с неким шумом это получаем а шум оказалось хорошо что он по нормальным закону распределен и далее нужно было все-таки подумать и как приступить к анализу Именно этого Спектра Ну понятно дело что в первую очередь мы должны сгладить шумы и у нас были различные попытки это сделать но оказалось самым лучшим способом это применить дискретную свёртку То есть у нас есть когда некоторые сворачиваемое окно и с помощью него мы сглаживаем А Мало того мы это сделали через быстрое преобразование фурье которое можно видеть формулу страшно на самом деле не настолько страшно как может изначально показаться потому что более формально э-э эта сварка примерно так выглядит но она оказалась быстрая в реализации И если мы сейчас посмотрим на результат для свертки мы использовали окно хеннинга выбрал я его ну потому что она мне больше всего понравилось по результату ну и соответственно наша функция F это ну по сути реально данный Спектр и после применения Мы видим что Ну сгладилось достаточно хорошо за исключением вот горизонтальных областей где есть малые шумы но как потом окажется это нам сильно более не сыграло а были различные варианты свертки частности ради Потому что некоторые применяют просто единичное окно свертки где у нас просто есть график единичный и дает хороший результат окно хеннинга собственно говоря которое мы выбрали и мы видим что он тоже хорошо Ну и другие варианты тоже достаточно хорошо справляются с шумами в семерке и здесь Вы конечно можете заметить что сильно еще зависит от того длины окна которые мы используем Но это как оказалось сильно зависит от конкретных задач которую мы решаем а вот теперь возникает Следующий вопрос как мы определяли те самые проценты которые вот изначально мы в той смеси указывали опять же Пусть мы знаем эталонные какие-то спектры Вот например для оксида кремния с таким количеством составом это так будет выглядеть и мы всегда виде вектора некоторого представляем Мы же обрабатываем некоторые числа и по сути У нас есть какое-то большое набор Эталон экспертов и для них мы должны как раз определить вот весовые коэффициенты и итоговый Спектр можно заметить что Начинает все больше больше походить на линейную регрессию А если мы вот большую эту запись начнём более компактным математически записывать то по сути это и превратится в то что мы обычно называем Линейная регрессии а но есть пару проблем первая проблема которая возникла у нас это соответственно если посмотреть на индексы в Спектр то индексы в окончании все разные и это обуславливается тем что давным-давно квантовая физика сказала что только с определенных энергетических орбиталей улетает электронов фотоны испускает соответственно на разных энергиях мы получали данные нужно как-то было теперь их свести в одну скажем так шкалу общую и по сути здесь логичный следующий шаг это нужно сделать интерполяцию данных интерполяцию соответственно мы что под этим подразумеваем То есть у нас есть какой-то набор точек и допустим вот у нас есть некоторая красная точка И нужно понять где она будет более вероятно находиться то что Мы вроде можем в различные позиции поставить Либо мы вообще можем просто прямую линию между ближайшими соседями начертить и получить некоторую такую линейную интерполяцию но мы начинаем замечать что оно не особо хорошо описывает динамику Но если взять кубический сплайн кубический интерполяция она более точно будет описывать динамику не только ближайших соседей ну и соответственно соседей и собственно говоря мы её и выбрали а и ну теперь давайте по сути вернемся к нашей задаче регрессии если мы будем рассматривать ее в чистом виде как задачу регрессию то мы можем сказать что Ну вот у нас есть квадратичный функционал ошибки его нужно минимизировать как раз за счет подбора параметров Омега но сейчас возникнет следующая проблема если мы попробуем так влог решать задачу слева у нас всегда вернее справа всегда у нас будут реальные цифры отображаться зеленым мы всегда будем отображать реальный входной график а справа как раз результат каждой итерации и если посмотреть то решая задачи линейной регрессии У нас все хорошо график повторил И лосс минимальный на самом деле там около нуля но если посмотреть на суммарные значение омег то у нас получится больше единиц То бишь у нас больше 100 процентов получается что не особо хорошо то что ну в реальности это не особо имеет какой-либо физический смысл соответственно следующим логичным шагом было это Ну давайте введем ограничение на суммарный процент и опять мы начинаем Лос увеличивать по сути результирующий но следующая проблема появляется Что появляется отрицательные проценты что тоже хорошо логичный следующий шаг Это от нормировать от 0 до единицы каждое значение и мы начинаем видеть что график стало еще хуже описывать но теперь выполняются все условия дальше следующий логичный шаг Ну самые большие значения нам более Важно писать нежели вот значение те которые по краям Давайте ведем штраф для каждого непосредственной пары координат и Здесь удобно что вот это как раз значение точности совпадает со значением графика и достаточно наш вот эту матрицу Вектор значения умножить на транспонирование значения собственно графика и становится с каждой итерацией все хуже хуже хотя мы Казалось бы начинаем все действовать максимально логичнее и правильной и можно заметить что наш синий график начинает принимать меньше значения в Пике чем единицы Хотя изначально когда мы ставили задачу был разговор что это безразмерно величина от 0 до единицы грубо говоря штуки ну и соответственно нужна нормировка Если вот мы добавим нормировку финальную с помощью бесконечной нормы но вы можете заметить что это просто максимум вы будете абсолютно правы и график начал абсолютно точно совпадать отклонение там на уровне сотых процентов это на самом деле очень хороший результат и как оказалось уже на большой когда мы тестировали этот алгоритм большой выборки то он оказался достаточно устойчивым шумам мы почти в 100 процентах случаев всегда определяли качественно состав и количество состав всегда тоже был достаточно близок а собственно говоря так мы решили задача анализа Спектра следующая задача которую мы решали она возникает несколько в другой области в математике Я занимаюсь теорией автоматической управления в том числе и часто к нам приходит разные задачи в которых У нас есть некоторые динамическая система мы должны как-то построить управление чтобы Например у нас был там строк там периодический режим либо система не разрушалась Ну давайте подойдем к этой задаче более формально когда мы попробуем стать Мир вокруг нас есть большое количество математических способов но максимально простая ситуация это вот как у вас работает спидометр по сути как мы будем замерять скорость и мы вроде со школы все помним что это разность кардинально разность времени Ну это опять же вы можете заметить что это по сути средняя скорость а чтобы получить точную скорость вот как спидометр меняется в каждый момент времени мы сути должны найти предел Вот такой вот соотношения и также можете жить и заметить что это производная производная сильно связано с дифференциалом и по сути задачу поиска координаты от времени можно привести к простому дифференциальному уравнению Это пример который по сути не играет никакой роли Но самое главное что все-таки чаще всего мы будем использовать дифференциальное уравнение на самом деле очень большое количество реальных систем описывается дифференциальными уравнениями Вот и по сути теперь то что мы чаще всего решаем Давайте введем некоторую теперь сложную систему дифференциальных уравнений например которая вот в ядерном реакторе описывает концентрацию например нейтронов температуры и ее можно записать вот таким нехитрым образом она кажется систем большой страшной Но на самом деле мы более формально можем сильно проще записать где есть какая-то Линейная часть нелинейная компонента и давайте мы добавим некоторые как раз управление Вот и теперь наша будет задача состоять в том чтобы как-то понять что будет с ней происходить А собственно говоря что может происходить первое давайте для примера возьмем простую систему опять же внимательный зритель может заметить что это по сути маятник Вот и если мы посмотрим на его фазовый портрет то мы можем иметь увидеть несколько важных вещей то есть мы можем там заметить периодические решения то есть когда система будет постоянно с каким-то фиксированным периодом менять свое состояние мы можем увидеть устойчивые То есть когда у нас со временем изменения будут сходить к нулю и вот как раз компонента дифференциальных она будет не меняться во времени Либо наоборот неустойчивы То есть когда система как-то начнет там раскачиваться выходить из состояния и по сути Ну если это реально физическая система то она начнет разрушаться вот а также математики выделяет асимптотический устойчивые к вазе периодически но это особый режимы которые сейчас нам не сильно понадобили понадобится для диалога и вот самый главный вопрос вот у нас есть только внешний вид уравнения Мы как-то сели описали Можем ли мы заранее сказать Вот либо мы имеем возможность только короткий период моделирования просматривать И на самом деле в математике есть подобный подход и это называется Спектр показатель липунова и он по сути всегда может дать ответ какой будет режим есть одна большая проблема что вроде он записывается вот таким вот простым образом но оказывается что считать его на самом деле очень сложно По большей части это сложно Потому что есть много разных методов которые в разных ситуациях дают разную точность и нет до сих пор ни одного точного алгоритма оценки Спектр показатели Ну и понять дело что Коля я до адсонтист и очень люблю Machine Learning то наш путь пошел в глубокое обучение что мы сделали по сути мы посмотрели Как лучше всего последовательности обрабатывать а на самом деле сложно динамическая система Но это некоторая последовательность состояний и мы взяли концепцию энкодера причем мы добавили Attention Ну как бы не сразу но впоследствии добавили Он дал хороший прирост и декодер и по сути построили классификатор на всем уже привычным и известным Трансформеры Где на вход в энкодер мы подаем нашу последовательность состояний он выдает некоторое латентное состояние и уже наш декодер выдает нам классификацию режима теперь возникает но логичный вопрос Трансформера учить очень дорого очень сложно нужно очень много данных что мы использовали на самом деле в теории колебаний и теории хаоса очень много различных известных динамических систем где точно определены пространства параметров для каждого режима собственно говоря есть исцелятор дюффинга он известен он хорошо изученный и мы взяли большую выборку из него есть в том числе осциллятор Вандер поля различные уравнения Причем очень много различных гармонических осцилляторов И на самом деле так как я этим тоже занимаюсь у нас был ряд работ где мы новые системы рассматривали к примеру это двойной перевернутый маятник И для него Мы тоже полностью определили пространство параметров для каждого из режимов и также мы все больше больше набираем данных мы до сих пор до обучаем улучшаем нашу выборку и понять дело что мы должны передать какой-то дискретное состояние шаг дискретизации мы выбрали 10 герц Здесь очень важно что для того из-за того что мы это использовали для того чтобы в конечном счете определять реальные физические системы это чистоты дискретизации оказалось достаточно то есть не так много реальных физических систем которые будут за этот короткий момент времени как-то сильно колебаться и возвращаться к положению которое было до этого чтобы вот спрятать какие-то неустойчивые состояния передавали около пяти тысяч пять тысяч измерений у нас в энкодер влазила и здесь соответственно Вы можете сказать что тогда период различных систем у которых больше получается 500 секунд мы не отловим это Да ну здесь был баланс между сложностью моделей и реальными задачами для которых в конечном счете Это Трансформер применялся Ну и временем и ресурсами и оказалось что если мы будем решать классическую задачу с помощью Трансформера для классификации классов он хорошо работает и в конечном счете На текущий момент уже достигнута точность но валидации 91 процент опять же повторюсь что добавляются новые системы из-за того что выборку мы решаем отдельно методом галеркина чтобы получить хорошие точные состояния И постепенно добавляются э сейчас там уже пройден путь по-моему больше 100.000 различных реальных экземпляров и надеемся что в конечном счёте э когда мы добавим ещё более новые системы Ну мы сильно улучшим наш классификатор собственно говоря это у меня всё И я готов ответить на вопрос Нет не слышно Возьмите мой пока А мы с этим разберемся потом фоновом режиме Спасибо большое за доклад честно сказать на первой части кайфанул потому что 20 лет назад когда еще это не называлось дата с антистами называлась инженером программистом работал в институте общине органической химии делал то же самое вторую часть честно скажу не вкурил настолько глубоко Вот Но у меня вопрос по первой части Я в свое время халтурил и одновременно объединял и вопрос минимизации шума вместе с вопросом интерполяции и подбирал там либо какой-нибудь племенальный интерполяции либо какой-нибудь вы так не жестили нет Так мы же использовали кубический спайн для интерполяции Да но перед этим сначала почистили от шума да Вот я как раз говорю о том что можно по-хорошему подобрать либо такой полином который всё вам сделает красивенько Вот либо просто сэкономить на вычислении а здесь я конечно ну там не могу критиковать потому что только идея но я попробую Вот Но изначально когда выбирался путь иногда тот спектрометр который использует Вот мои коллеги физики иногда дает очень сильный всплески А поленом если больших степеней он Они любят объяснять различные вылеты и соответственно Я в первую очередь боялся этого но и Спасибо большое за идею так еще вопросы Ага Добрый день спасибо за доклад Да короткий вопрос Вот вы показывали в начале по поводу смеси да то есть химических соединений да то есть вас там гуся на самом деле были выглядела по крайней мере так что как галусианы некоторые может быть стоило им алгоритм использовать для разделения вот этих вот смесей либо другой вариант собственно говоря спектры вот тех примеров они действительно начинают похоже на нормальное распределение но далеко не все спектры у них есть различные особенности вот поэтому вот подобный лосс который я показывал и строился чтобы универсально самая большая проблема что когда идет анализ мы не знаем не количество некачественный состав То есть у нас очень большой набор эта и в первую очередь важно отбрасывать Вот какие-то значения а потому что был также момент когда другие попытки лосого Ну другие лосс Мы строили алгоритм начинал строить выбирать как можно больше не нулевых значений Омега и за счет малых значений комбинация большого числа начинал но не в правдоподобно картину строить физически неправдоподобную но в реальности Ну как бы график достаточно точно повторял Надеюсь ответил коллеги нас еще из чатика из чатика есть вопрос я его озвучу Вопрос такой Какие вообще виды сетей использовали Какие пробовали и какие порекомендуете для обработки массивов данных это прям очень широкий вопрос я тоже об этом подумал Но может быть какие-то напутственные слова все-таки автор вопроса можно сказать на эту тему на самом деле в первую очередь если что-то связанное опять же с последовательностями очень рекомендую все-таки очень хорошо разобрать последние там работы от Гугла от Яндекса вот по поводу сети пафов и на трансформерах когда все эти умеют Ну как бы типизировать разделять обучающие данные в том числе и по темам которые Google Причем одна из команд Google также на этой системе окажется минирован это называется которая уже начинает символьные вычисления делать Вот про классический рекуретную сеть ну как бы здесь если большие последовательности можно начинать забывать На мой взгляд они все больше больше теряют это актуальность Ну там где есть окружение не только по горизонтали скажем так на двумерной плоскости Но это свёрточные сети очевидно если входной тип данных а так сильно зависит от задачи Вот которую автор вопроса может решать Ну в современном мире эмэльки Нам надо просто хорошо знать весь Базис И хотя бы 4 часа в неделю тратить на Google скалярия посмотреть Что вышло из интересного хотя бы 4 часа в неделю тратить на Google скалярии Я поддержу так сейчас выйду из если у нас еще вопросы есть вопросы отлично Да спасибо за доклад практическому применении можете подробнее первое Я понял что вы Видимо это софт для анализа Спектра да то есть анализ образцов а для второй задачи это что будет управление реактором как это выглядит В итоге на самом деле очень часто не только для реакторов нужно построить некоторую систему управления которая будет выводить в нужный режим там примерно то что мы сейчас решаем Это для регулирования уровня тестостерона у мужчин соответственно он периодически и нам нужно периодический режим выдерживать там правда совсем другие системы уравнений и нелинейности другие и очень часто аналитические методы не работают по причине того что анализ нелинейных систем это дело неблагодарное когда допустим вы решаете реальную задачу инженерную чаще всего у вас какой-то срок короткий то Вот как раз для этого мы и строили Где мы можем пробовать разные системы управления отдать наш трансформер и он сразу скажет что скорее всего режим будет Вот такой вот и тогда его ну по сути отвечать на вопрос подходит или не подходит режим управления Надеюсь ответил"
}