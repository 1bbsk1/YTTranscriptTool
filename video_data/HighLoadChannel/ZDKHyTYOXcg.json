{
  "video_id": "ZDKHyTYOXcg",
  "channel": "HighLoadChannel",
  "title": "Как мы DNS для CDN делали / Константин Новаковский (G-Core Labs)",
  "views": 1973,
  "duration": 2955,
  "published": "2021-10-04T02:47:02-07:00",
  "text": "о супер замечательно спасибо за задержку спасибо за поддержку немножко обомне я работаю сейчас компания уже карлов занимаюсь в команде оперирование седин занимаясь dns и дает до этого занимался dns selectel и еще я немножко какое-то время занимался виртуализация облаками и чем-то еще вот и последнее время поскольку последний год работы в декоре и работаю над сединам то мне очень захотелось еще раз рассказать на холоде и 1 1 1 1 продам если михаил аудио рассказал там в пятнадцатом году еще раз про dns мы уже куда-то их больших масштабах кто-нибудь слышал о компании dji карл abs значит я не зря вставил этот доклад слайдов доклад собственно у нас очень много всего но мы мало известны потому что обычно средство очень часто это либо узкоспециализированные проекты которые нить нить игровые проекты да и в общем то компания dji core отчасти появилось за счет отпочковался компания wargaming для обслуживания инфраструктуры потом стала предоставлять эту инфраструктуру для других игровых компаний и не только игровых компаний в первую очередь мы я сидел нужен для того чтобы доставлять трафик до трафика при доставке трофи какие там есть как две проблемы да какие проблемы решают первое это объем трафика то есть в одну сторону и очень больших объемах то есть например обновление игры видеотрансляции и так далие второе это время доставки то есть если контент грузиться быстро это хорошо да пользователь не ждет то есть последние современном время мире фокус внимания человека достаточно маленький если страница грузится долго или что-то происходит долго он нервничает переключается на другую вкладку интернет магазина теряют покупатели и так далее у нас много точек присутствия в снг больше всего . отсутствие по-моему больше 80 они все время изменяются отдельный вызов для оперирования собственно команды благодаря командам 10 железяки ником у нас есть некоторая такая слоистая структура что есть отдельный ребят который занимается железом есть ребята которые занимаются так что счастл и вот до которые занимаются администрированию низкоуровневым есть ребята которые занимаются даст инфраструктуры доставки конфигурации в общем но не продуктов на сервер и отдельные уже оперирование которые команды например седин до конкретных продуктов которые с помощью там отдельных вич папито настраивает уже конкретно своей серваке собственно да как доставляется контент что происходит когда пользователь в браузере вводит адрес сайта сброс до обеда для нас важно две вещи 1 bravo браузеру пользователю приложения нужно обратиться к кому-нибудь адресу даты знать какому адресу обращаться и как ты получить этот адрес получает адрес он через dns да и выполняет запрос используя адрес да за что мы в этом всем будем бороться в данной оси за то чтобы быстро отдать этот ай-пи-адрес случае конечного приложения и сидена в целом это опять также latency и утилизация каналов то есть так чтобы точки присутствия не перелить да что такое dns как получить ip-адрес и кто вообще принципе знает что-нибудь про это слышал когда-нибудь разбирался я ну мало ли всякое бывает да на всякий случай быстренько про щелкаем да мы делаем запрос рекурсивном и сервер рекурсивно длинной сервис спрашивает корень корень отвечают в данном случае отдельным нюансам да у нас ns сервера расположена в том же домене что и сам рабочие сама рабочий имя которой спрашивается я сидел и в этом месте мы уменьшаем -1 хаб для скорости рисового то есть авторитетный сервер зоны и seo в данном случае tld seo по-моему это колумбии отвечают так же еще сразу ip-адресами нашего наших серверов стоит отметить что tld зоны верхнего уровня и на сервер и тоже бывают разные полотенце и в зависимости от зоны это также влияет на время рекурсивного выполнения разрешение меня собственно дальше добираемся до нас и мы уже отвечаем браузеру в основном говорить будем буду я про авторитетное сервер говорил уже что то много и немножечко про и пи адреса бюджет автономной системы кто-нибудь вообще слышал про это знакомые слова круто чё сюда пришёл так как работает сидел краткого все есть источник у клиента есть источник данных мы даем специальный имя которой он оказывает в своем домене на самом деле мы можем но сейчас я попозже об этом скажу да и потом на сайте или где-то ещё пользователь указывает этот url с нашим доменом седин доменом запросы начинает идти к нам мы делаем запросы к режиму отвечаем конечному пользователю каширы и есть еще тоже нюанс мы предоставляем предоставляли красивый поддомен в своем домене но если коротко то схема выглядит вот так как мы изначально у нас все это дело я работала когда-то очень давно не сервер бант кто-нибудь кто трогал bine настраивал а кстати интересно что не так уж и много работает есть механизм you если вы поднимите руки кто view настраивал когда-нибудь доставляем конфликт по пятам это было давно конской на самом деле не очень удобно особенно тебе когда тебе нужен мне целую зону до в целой зоне всего лишь какое-то одно имя балансировать поэтому нужно было какое-то решение альтернативное я на нашлось виде сервера geodon с который изначально была написана до написан ногой и изначально был реализован для обслуживания инфраструктуры и т.п. ну публичного тебе пула сервера точного времени вот простой конфликт на гол делает то что нужно с одной стороны пишешь откуда пришло и куда это отправить есть тип запись аль с этим мы даже в свое время радовались что так нужно икон так мы получали по крону на хостах запрашивали карлом и конфиг выглядит примерно следующим образом есть имя все файле как все в jison щеки есть имя для описания откуда куда если пришли из рута отправить на такие-то ip-адреса если не игру на другие если зайти туда если из финляндии то отправить на точно так же как в ру на самом деле из-за внутренней реализации вот эти алисы нам сыграли злую шутку когда мы в какой-то момент перестали из скажем до конца в коде неправильного формирования зоны мы где-то в некоторых местах не отвечали точнее отвечали пустым ответом и это было плохо собственно изначально зона у нас была всего лишь одна да и потом мы ее можно было легко доставлять потом появилось требование до нужно на кастомизировать един ресурсы для клиентов зачем это нужно делать первые у кого-то кто-то хочет платить меньше банально потому что какие-то точки присутствуют дороже кому-то футбольные матчи еще какие-то матчи игры регуляторы зависимости от типа бизнеса требуется чтобы их трафик принимался не принимался в определенных странах или наоборот только в каких-то определенных странах соответственно для этого нам нужно было начать кастомизировать это дело то есть начинается появляется компонент специально дополнительные который мы назвали балансировщик который формирует зона под каждого клиента уже отдельно и да тоже есть нюанс что даже между двумя запросами может быть за двумя дэна запросами может быть два миллиона happy запросов то есть но например в одном городе один крупный оператор у него много много много пользователей один recourse 1 1 пользователь спрашивает recourse мари курсы приходит к нам и мы отвечаем а дальше пару сотен пользователей пользуются этим ответом ему ты поэтому во время каких-то очень каких-то крупных событий действию на наших клиентов они нам периодически делают уведомление что у них планируется большой объем трафика в это время команда оперирования начинает внимательно следить за графиками собственно для этого в компоненте был начал балансировщика были добавлены так называемые гифы как мы называем когда можно точечно изменять какой-то нюансы балансировки по айпи адресом по автономным системам по регионам и так далее вот собственно придем дальше идем к не касту до чтобы дэн на сервер и отвечали побыстрее во всех регионах используются технологии никас кто-нибудь слышал про и ников вот если очень коротко до что у нас есть один ip адрес и он обслуживается во всех разных в разных точках присутствуя в разных регионах для того чтобы уменьшить время чтобы это сделать нужно в большом интернете да это может быть в локальном внутри dt центр работать так внутри дата-центр как раз так работают наши сидел хосты в том числе и в каждом дата-центре ни один dns-сервера несколько dns серверов и все они наружу даже внутри дата-центра также балансируется по by jacques используется никас для того чтобы настроить и не каст большом интернете требуется настроить би джи пи джи би джи пи требуется своя автономная система понятные слова про автономную систему кто такой автономная система учета вы как-то не активны ok для автономной системы что такое автономная система совокупность оборудование сетей которые обслуживаются какой-то одной конкретной организации соответственно от имени этой автономной системы анализируются другим автономным системам другим роутером соседнем api адреса таким образом вставляется таблицы маршрутизации и за счет таблицей маршрутизации какого-то точки до точки в мире мы получаем трафик стоит сделать отдельный момент да чтоб нюанс быть же ничего не знает про лет они себе джипе знает только про количество второму систем который нужно пройти чтобы достигнуть получателя сколько пакеты нужен пойти чтобы достигнуть получателя то есть и так называемая спать а esp off количество перов в данном случае очень важно причем есть нюанс когда у вас всего несколько точек присутствия растянуть этот они каст между этими двумя точками сбалансировать достаточно легко как только вас получит появляется больше точек присутствия это становится делать уже намного сложнее в силу топологии интернета и большого количества участников да и различных провайдеров мы сейчас у нас количество перов соседей с кем и с другими автономными системами установлены связи у нас их больше 5000 мы кажется мы на седьмом месте в в мире по количеству в случай pivo и pivo 4 собственно вот так вот в россии выглядит связанность автономных систем в мире там вообще сплошная заливка наверно будет такой градиент собственно мы настроили не каст у нас это все стало хорошо паника что у нас также ходит веб-серверы да то есть у нас есть для web серверов точно так же не кастовые адреса на которые отправляются трафик вроде все хорошо даже но бывают с доменами проблемы самой большой проблемой самые неожиданные для у нас был ну то есть когда мы что-то ломаем это хорошо точнее как этот это плохо но мы знаем что это мы сломали мы можем это что-то поправить а вот бывают такие случаи когда когда я уже говорил да мы выдавали клиентам с как красивый поддомен своем домене где-то там пришел клиент и то ли порнуху какую-то разместил то ли еще что отправили за жалобу регистратору регистратор домена раздели gear овал и мы стали бы там узнавать на как бы практически от пользователей причем по звонку да то есть слаженного то что мы с этим сделано с регистратором договорились домен вернули после этого убрали вот это красивые имена вели категории клиентов чтобы разделить одних клиентов скажем так проверенных клиентов на один домен непроверенных на другой даме и есть еще такая услуга когда регистратор может за отдельные деньги не сразу разделе гера вать домен то есть такие энтерпрайз регистраторы которые жалобы пропускают через себя через суд это все дело проводят и общем то так такие вещи не становятся уже не будут неожиданностью что вдруг что-то произошло разделили равале также проблемы с длинной сервером было дает тебе сказал long данный сервер ногу ланге иногда долго отвечает дропают пакеты первая мысль горбач коллектор начали копать но это был не горбач коллектор расскажу покажу графике у него еще так еще были дополнительные проблемы мало внутренних метрик ничего толком не выдает статистике запросов нет слабая поддержка со стороны разработчика apach af уже по почти уже мы бросали туда еще есть нюанс такой как раз в год разработчики ds3 курсоров и длиной серверов устраивают события под названием dns флаг дай когда они удаляют какой-то старый костыль из кода для того чтобы какие-то другие бины серверы которые были запущены 10-15 лет назад кто-то зашевелился и обновил их соответственно dns флаг дай это про соблюдение стандартов вопрос соблюдения rfc и где один из а также была проблема с соблюдением стандартов и рывки нужно было с этим что то сделать вот собственно про долгое время ответов статистика собирается через также через и 5 balls то есть очень много сетевой подсистему забираем метрик собственно оказалось здорово что внутри бена сервера был было блокировка которая отправляла на на внешний сервер статистики публичный статистику использования на самом деле это все не использовалась но блокировка была да то есть пока в конфиге не пропишешь ничего не что никуда не отправляется на было блокировка и это выяснилось при нагрузочное тестирование когда почему-то раз 60 секунд терялись пакеты еще есть нюансы да когда не работает домен это когда если анонсируете из одной точки присутствия оба имени сервера на api адреса то вот юрьевич то да и там немножко выбил из колеи собственно но в этом есть некоторый нюанс да это нужно для того чтобы и курсоры видели-видели и печники на серверов с разных сторон да то есть если в регионе падает дата-центр то для рекурсия в регионе как вот конечного пользователя для курса конечного пользователя остается виден второй адрес и возможно кто-нибудь помнит раньше регистратору был такое требование чтобы насирова располагались в разных по сетях класса c сейчас у нас без классного ему маршрутизация да теперь это в разных сетях 24 про доставку интернет хрупкий 80 . присутствия они все время растут где-то все время что-то ломается и время доставки начинает страдать в силу того что . присутствия иногда не может достучаться до командного центра случае сидена веб-серверов там тоже есть некоторые механизмы как это обойти но если говорить про нас да то как мы решили эту проблему мы не ходим в командный центр мы сделали доставку зон через потопе нас есть специальный файл директория там где генерируются зоны файлы зон и это директорию растянута по всем точкам присутствия кладем в одной директории файлике и они появляются во всех . присутствия и они качают между собой и нам данные распространяют и нам для не нужно переживать о связи с командным центром для того чтобы балансировать трафик часто бывает недостаточно мы видим только и пи адрес 3 курс уровне конечного пользователя есть для этого специальный механизм еду на из клиент согнет когда внутри пакета а3 курсором нас прилетает данные о по 10 оригинального клиента но первая проблема таких запросов у нас всего 30 процентов и это еще зависит от самого клиента это ресурсы клиента и например google public dns отправляет такие пакеты платформе отправляет квадр отправляет club flyer не отправляет и не планирует прайвеси first они пошли другим путем они добавили в гелий и манты нет айпи соотношений айпи адресов внешних айпи адреса free курсоров в своих с географией то есть принципе мы по их айпишник am более не менее неплохо определяем география не вся еда айпи адреса есть в европе не полное покрытие сетевая топология часто не соответствуют географии меньше link on se si что это значит чтобы периодически российские операторы приобретают африканские подсети и никто не исправляет это в hype пока кому-то например нам это не будет мешать и мы не придем с запросом макс майк мы используем axmedov скую базу и наполни мы и при этом мы постоянно для этого приходится ждать мы постоянно наполняем свою вот эту карту балансировки по и пешни campo под сетям по автономным системам куда это все дело отправлять есть еще один вариант да если у нас нету герой пита нам запрос на какой-то dns-сервер пришел мы знаем где он находится в какой стране в каком континенте и можем использовать его дело данные про стратегий управления трафиком можно отправлять все на и не кастовое идрисов выписаны ника стоит рисовых серверов в тунисе не гарантирует потому что отправить могут куда угодно почему куда угодно потому что тир-3 тир-2 операторы например там три может принимать меня есть пилинг в москве есть пилинг в нью-йорке он принимает префиксы в москве и анонсируют их же в нью-йорке и при этом а и спать с пав то есть количество автономных систем который должен пройти пакет предельно мал и поэтому в этом месте мог могут быть проблемы то есть это совсем не и никак не гарантирует latency поэт при этом со стороны оперирование сложно контролировать перегрузку серверов и сетевики постоянно дергать сетевиков накладно хочется иметь свой контроль наши сетевики не только для себя но и для облака колы медиа платформы для куча других услуг про можно отправлять на не кастовые адреса внутри ни кассавы добиться под unica unicast им я подразумеваю в большом интернете внутри есть все равно никас для балансировки внутри дата центра это уменьшает время файла вера точнее увеличим может увеличить время файла веры случае полного отказываются центра сразу сессии не порвется на этом матом цессия может не быть поэтому используем гибридную управление стратегии управления трафиком часть меня касты риса частный не каст дреса и в зависимости от страны континенты мировой и не касты то есть если мы очень хорошо знаем откуда пришел запрос днесь и на уровне dns определим то отправляем на ней unicast если нет то в страну континенты мира войников мировой никас мы отправляем в том случае если мы вот то есть мировой не каст такой unicast который растин вообще на весь мир туда мы отправляем если вообще ничего не можем понять про пользователя и при этом если брать геоданные дыма и сервера то latency все равно тоже плохо да какие точки отказа доноса есть to play all domain'у на серверах случае dns хостинга то есть какой-то момент к нам об этом я еще буду говорить нам пришел бизнес сказал что в эту 2 сидена дэн и сделайте давайте продавать разные 24 сказал автономные системы вообще есть специальная туза которая проверяет точки отказа даме si no single point of over прям рисует график и там одно из требований один по одной из точек это как раз автономной системы из того то что в реальной жизни видел это используются резервирование для серверов dd про метрики мы же должны понимать откуда все это делаю приходит и как-то разбирать инциденты когда к нам пользователь пришел и говорит слушайте что-то медленно первым из метрики скрепим прометею сам прям по всем кастом да все по-честному для детальной статистики используем dns tab изначально нас не было статистики в диоды с идет geodon эссе как мы эту проблему решили сейчас расскажу предварительно чуть-чуть про dns топтуны стаб такая штука которая отдельный тренд внутри dns-сервера приходит запрос вредена сервера данный сервер это как-то обрабатывает складывают в очередь и дальше уже что происходит с этой очереди данный сервер ничего не думает ему его задача обработать запросы ответить они следить куда там ушла эта статистика поэтому этот отдельный трек пишет в отдельный socket и мы уже из этого отдельного сакита отдельного внешним сервисом читаем эти dns запросы и отправляем статистику в сервис статистики как мы это делаем и прямо с и j пишем в клика us вот сейчас написано 20 гигабайт сутки сейчас наверно сейчас уже больше собираем это вот статистику через данный этап на хостах есть отдельный демон с отдельным буфером если он не смог дать ли house достучаться если не смог достучаться то потеряли собственно не страшно что потеряли нам главное ответить они статистику собрать со стороны клика us накрученную различные матвею и собственно за счет этого мы этому матвею мы немножечко 1 облегчаем гриппа не по этой статистике это раз и второе мы уменьшаем объем хранения еще также показываем случае думаешь хостинга эту статистику запросов что спрашивали и что спрашивали на что не ответили конечно пользователь собственно да мы хотели на что-то поменять где о dns и сделали свой букет кордом с кажется это достаточно популярное решение до хотя сначала хотели power dmf он прям вообще очень может во все и вообще я очень люблю по водам с но есть некоторые нюансы первое нужно думать много памяти да и у нас для всего команда разработчиков ланге до кардан с предоставляет уже у него там есть там быть and tracing то же самое вместо правда данный этап мы все равно переписали и он обеспечивает слой совместимости с как раз со стандартами сырых хе-ге 1с был изначально дочь нам тоже написано на гол он использует библиотеку микаге бы на так популярны библиотеками годжи нас в основе которой лежит кордон с поэтому портирование в общем-то не заняло много времени и был достаточно легко но для портирования нужно было как-то кое-что сделать так нужно было обеспечить совместимость что у нас ничего не сломается после того как мы будем менять дым и сервер с патчами так далее то есть первое что мы использовали flame thrower стрелял к от компании не суонк которые делает предельно тупые вещи берет свое список запросов и начинает очень много запросов отправлять в dns сервер риск div инструмент тот команды разработки knot рекурсии сервер что делает также поспит берет из базу из списка запросов данные запросы отправляет на разной длины и сервер и собственно в этом месте мы когда переписывали бэкенд у нас получилось не разойтись тем что уже есть уже работает в против чтобы поменять что-то сломать на всем сидение с гигантским объемом трафика dns этот но в общем у нас нас по головке не погладит в процессе вся это же еще куча дега баша еще всякого всего если что-то тормозит тормозит на уровне файлов на уровне системы до используем перс flames капот над флекса который очень удобно рисует дорисует он примерно вот так да что где-то что-то тормозит вот у нас какой то момент где-то что-то стала тормозить мы перестали понимать вообще чтобы происходит потому что мы не видели узкого места только видели что процессор то ничего не делает каких-то дырок оказалось что мы на виртуалку тестировали там как бы гипервизор будет перегружен так вот пришел бизнес и говорит давайте наш давно из продавать пришлось между балансиром данной серверами добавить dns api теперь у нас появилась еще одна . отказа возникли проблемы с тем чтобы формировать принципе зоны больших количествах особенно при когда нужно каскадно изменять очень большое количество файлов если раньше в балансе рыбы были специальные нюансы так называемые ссылки типа пожалуйста уважаемые балансиры выключай пи адрес везде теперь балансир не внутри себя это делает и теперь ему нужно пойти обновить это большом количестве внешних зонт которые находятся хранятся уже в данная сопи оказалось что когда начали продавать точнее в бит в байте выставили dns of dan is hosting у клиентов вообще совершенно другие запросы были и матчи между платы msi это конечно прикольно да ну да и дайте мне failover вот failover в разработке потому что оказалось что это нам нужно как бы сделать новый продукт и наверное сделаем новый продукт и скрестим из дыма и сомнение тогда уже выйдем из bad есть нюанс да нет клиентов с таким большим количеством точки присутствует количеством точек присутствия и методы балансировки вот эти давайте напишем большую портянку откуда куда им принципе не подходит для того чтобы подняться до sl зам начать продавать денисов пришлось сделать следующее да это подняться в статистике dns перф dns 1 точка ком забыл добавить слайд про то что у нас средние время ответа по всему миру данный серверов это среднем 20 плюс минус миллисекунд она периодически плавает потому что где-то точки ломаются где-то точки поднимаются как удалось добиться вот этого вот 22 миллисекунд это опять же спасибо команде сетевиков и команде закупок которые договариваются с большим количеством императоров для устанавливают большое количество пилинга то есть как я вначале сказал сложность растягивание каста заключается то есть она в начале не каста разделить растянуть на весь мир легко чтобы это было предсказуемо потом появляется такая гигантская пропасть когда у тебя и немного и немало точнее уже немало но уже много но еще немного количеству it перов и там все время что-то ломается но когда у тебя становится большое количество перов растягивание настройка опять становится предсказуем единственное что может потребуется дополнительный инструмент и мониторинг только-только мониторинг собственно что еще можно про это сказать про будущее поскольку это вот откуда куда во первых для того чтобы понимать откуда пришел пользователь да и в этом сидори курсоров мы приходим сейчас к тому что приходит опять нужно дописать реализовать чтобы использовать вот с данной бюджет и то есть full view со всех точек присутствие для совершения активных проверка для пингования всего уже не всего интернета у нас был такой поп когда мы для того чтобы изменить и улучшить в тунисе мы пропинговать и весь интернет из каждой точке присутствия и казалось что это с одной стороны улучшают качество время доступа сложных географических районах там где география скажем так не очень работает и пилинг не очень работать то есть там есть какие-то промежуточные нюансы но в целом на общую статистику в среднем это не повлияло это улучшение есть также использовать за счет данных бюджеты в точках присутствие утилизацию каналов то есть чем за транзит платим за объем до за их при в иксах мы платим в точках обмена трафик их за подключения за порт то есть нам дешевле утилизировать весь этот порт за уже заплачены деньги чем все время у нас будет прыгать цена и из месяца в месяц транзитный трафик также вот это вот использование откуда куда она не очень работает точнее она работает достаточно неплохо но вот как раз плохо работает свой лайнером то есть нам нужно постоянно перестраивать эту карту перестраивать зоны и поэтому мы сейчас уже переписали но ещё не выпустили в прод механизм что зона описывается меня отсюда туда также как бюджетный авто нам через бюджет автономные системы или . присутствия роутер анонсирует я могу принять этот трафик но только на уровне dns условно у нас есть там 4 записи когда одна запись говорит я могу принять не за россии и европы и зази другая говорит я могу из россии и африки до и между ними происходит балансировка таким образом там есть такой момент что сложно балансировать vesa да то есть там исчезает понятие весов как я уже говорил что за двумя дэн с запросами может быть два миллиона и степи запросов в этом случае как раз такой метод не работает есть еще ворох проблем опасности каскадного отключения когда может все перелиться провайдер может использовать несколько обстрелянных серверов разных регионов тут мы вообще сделать ничего не можем обычно такое происходит когда кто-то сидит через свой рекурсивный сервер который находится находится виртуалке держит алла уж они у него прописано еще об стримами кто-то некорректная балансировка постоянное обновление карты я уже говорил и если осталось время времени кажется не осталось я могу потом в кулуарах наверно рассказать про то как де пейном периодически ломает балансировку точнее не балансировку вообще сидел вопросы предложения спасибо да спасибо большое давайте тогда начнем задавать вопросы опять же как я обычно говорю что вопросы вы задаете и тут и и сливов в онлайне на скота видят и смотрит то можно и сдавать в чате их могу прочитать либо мы можем вывести вас прямо на экраны взлети вопрос константина в прямом эфире давайте начнем отель свою очередь запоминая и потому что мы выручаем книжку за лучший вопрос поехали константин спасибо за доклад у меня такие три быстрых вопросов в dts используйте а веры и т.п. или over тисе пи в основном и и т.п. но иногда бывает тисе пи то есть это иногда если кто-то не смог добраться до нас по идее то есть там процент соотношения трафика там 199 и и отчасти вот этот вот соотношение юге пик в тисе пи это один из показателей того что что-то идет не так то есть если типе вдруг вырастает значит что-то идет не так значит где-то мы продолжаем запросы по и т.п. спасибо скажете вы через свои dns или золоте только свои зоны или вы даете что-то еще только наших зоны мой резул такая у нас мы не предоставляем ри курсор и до авторитетные серверы мы делали держали только свои зоны и сейчас как раз запустили услугу чтобы любой мог нам прийти и добавить своих зон то есть мы предоставляем это как услугу то есть это можно то есть как слейд мы пока не работаем мы это не реализовали там еще нужно много для этого написать мне потом не всем это нужно для этого для синхронизации мы лучше использовать окна да и нас то есть dns амплификация так у вас нету dns amplify что к нам очень много прилетает а не то что мы участвуем в видосе кого-то бывает и как боритесь у нас есть метрика о том то что к нам вдруг прилетает очень много запросов и мы собственно видим что это какой-то как-то сейчас аккуратно сказать не очень хороший пользователь да то есть редко такое используется для легитимном у пользователя но легитимных пользователь великими домена точно так же могу для этого использовать есть еще 2 очень интересный вариант можно посмотреть дтл с которым приходят эти запросы то есть скорее всего эти запросы прилетают в какую-то одну точку присутствие для если они прилетают вам много точек присутствует нужно все равно посмотреть то tl и скорее всего можно поэтому-то телу определять кто что это не легитимный запрос под а по тылам я подразумеваю то тель ай пи пакет а точнее отель раунда в этой пакете сколько может пойти через роутер как правило они там 255 или общем какие-то такие очень неровно вот 64 это нормально а вот если он там что-то очень сильно нестандартное то есть иногда конечно может быть от solaris запрос пришел но это редко у него там как раз такое стандартные не виндовые значение они все очень похожи а у них еще одинаковые request айди ковыряет как правило ну то есть там есть некоторый набор параметров в пакете по которым можно это все определить и побороться этим можно добавив правила и 5 был с по моему 32 матча правило модуль есть и третий вопрос вы снижали latency чтобы попасть в топ по миру это было от бизнеса или были проблемы с повышенным плата msi ну то есть для пользователя там 20 миллисекунд и 970 большой роли особенно не играют когда наши следы приходит кому-нибудь им нужно что-то показать и убедить клиента там то что мы действительно классно но бизнеса да но мы все таки да зарабатываем деньги дай нам нужно рассказывать о том почему мы лучшие почему нужно выбрать нас спасибо стоит я не знаю говорил нет у нас очень много рестайлинга поэтому не очень известна как как именно к публичной компании известно добрый день дмитрий альфа-банк как я понимаю у вас и как у большинства седанов нет автоматической дистрибуции контента до по вашим сервером когда там одна прокси запросила какой-то файл не знаю об стрима то этот файл будет храниться на это только конкретная прокси а ваш dns учитывает как-то степень прогрета стеречь сервера когда отдает и пи адрес клиента о том что но там хост доступен по такому-то адресу и плохо расслышал я попробую перефразировать и скажи правильно я понял вопрос или нет первое это про что у нас только проксирование есть у нас есть отдельный запрос через и 5 сидена пожалуйста про грином кэш и мы его везде прогреваем прогревается если мне память не изменяет там где указано то есть у клиент может указать где он хочет принимать трафик и где не хочет и прогревается там где он хочет собственно dns отправляет только туда где куда разрешено то есть если заранее попросить прогреть то он будет прогрет dns про это ничего не знает про прогрет ну допустим конкретно вопрос у нас какой-то локальный достаточно проект ну например банк так и к нам заходят пользователь с другого континента му сами рик соединенных штатов допустим насколько разумно этого клиента отправлять на ближайший эти сервер который расположен сан-франциско хотя мы точно знаем что там нету наших файлов и наверняка они там будут бесполезны потому что следующий клиент взойдет из сан-франциско может быть через 10 лет так еще раз origine origine допустим у нас где-то в россии ну потому что настоянные клиенты в россии но бывают случаи что наш клиент полетел не знаю в отпуск командировку в штаты и за надо и не надо тут как вариант да и часто это делают отключают точки в штатах ну потому что это не имеет смысла опять же часто это используется для статического контента то есть мы проектируем статический контент для проектирования вообще всего это уже отдельные механизмы и насколько я знаю мы сейчас не очень активно проектируем вообще все ну что это как раз вот такие вот нюансы докладывают то есть в вашем случае лучше если ваша основная аудитория россия да я европа у нас в нашем личном кабинете поставить галочку принимать только в европе и в российском регионе то есть даже для ваших клиентов это будет наверное лучше наверное часто будет банк-клиент залезать соединенных штатов то есть это пост постоянно такой нюанс да вот когда мы что-то делаем это нам вообще зачем так имеет ли это смысл так вопрос да добрый день и спасибо за доклад вопрос такой вот рассказывали про разные типы и не каст api адресов получается что у вас очень много есть 24 те так чтобы делать для каждого никас адреса получается свои отдельные черты подсветка то есть в этом месте приходится очень много тратится на сети на подсети на ip адреса ну то есть никакой оптимизации здесь не получается вас не договаривается оптимизации но тут с какими then дарами чтобы меньше анонсировать теперь им тут не сильно что-то изменится то есть но вот мы знаем что у нас там россия большая сторона да мы знаем что там у нас много пользователи из россии поэтому у нас есть отдельные адреса именно для россии и они не пересекаются с с европой например да там еще тоже есть такой нюанс про россию я где-то там на слайде финляндия была которая отправлялась в россии это была не просто так потому что часть трафика который мы видели как из финляндии дмс за счет из гугла из ошибки в угловых и курсовых она была и в россии поэтому нам как раз было проще всего именно для этого клиента вот такой трафик отправлять на и не каст в россии тут ну и сильно каких-то оптимизации не сделаешь только в регион да и растягиваем на регион и потом несмотря на то что у нас много получается таких и не карстовых под сетей внутри по сетей используется ни один айпишник а несколько как раз для разделения клиентов и для статистики понимания что вообще происходит чтобы там крупных клиентов до как товар в одну кучку ладен дашборде клиентов поменьше в другой дашборде для оптимизации как раз так таких уже внутри них внутри него внутри . внутри точек присутствия ну и потом между роутерами сетевики внутри с помощью ps тоже делают свою магию то есть внутри автономная система можно нарезать 21 21 25 26 и 29 спасибо но это используется не часто это скорее не он"
}