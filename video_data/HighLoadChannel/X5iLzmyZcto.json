{
  "video_id": "X5iLzmyZcto",
  "channel": "HighLoadChannel",
  "title": "Гибкая схема хранения данных в MySQL (JSON) / Александр Рубин",
  "views": 3608,
  "duration": 3077,
  "published": "2018-08-16T04:34:43-07:00",
  "text": "ну что давайте начнём меня зовут алекс и я работаю в компании перка на и в этом докладе мы поговорим про интернет вещей и гибкую хранение гибко и хранения данных в маске или в джейсон доклад будет наполовину развлекательный так что если вы устали это самое время особенно первая часть и соответственно я вам покажу вот девайс который я создал давайте начнем с вот этого слайда менять они спросили а зачем ты собственно все это делаешь я обычно рассказывают такую историю я живу в америке и мы решили посадить фруктовое дерево на нашем участке казалось бы все очень просто да приходишь в магазин и покупаешь фруктовое дерево оказалось что первый вопрос который задают продавцы магазина это сколько у тебя солнечного света был для меня гигантской загадкой я совершенно не знаю сколько у меня солнечно света на участке но естественно что что мне на это сказали но ты можешь выходить каждый день соответственно во двор и записывать и посмотреть сколько там солнечного сидят и записывать и значит блокнотик но это не дело на самом деле поэтому я решил сделать что я создал вот такой девайс вот что он делает ну во первых как это вообще можно решить эту проблему а есть вообще дикое количество сейчас устройств для интернета вещей есть понятное дело раз были пай есть новый раз были пай вот есть arduino есть тысячи разных штук но я выбрал для вот этого проекта для этого дома я выбрал такую штуку которая называется портал фотон портников фотон и это очень простая в использовании не штука она стоит 19 долларов можно купить на сайте а значит чего у меня и хорошо во-первых она сто процентов клауд во вторых к не подходят любые датчики которые можно купить для arduino например они все стоят там меньше доллара там 50 центов датчики соответственно я сделал вот такую штуку и положил ее себе на участок на травку а вот собственно я хотел начать с этого вот надеюсь что сейчас будет работать значит вот эта штука я сейчас отдам можно без ней поиграться а что у нас здесь есть у нас и здесь есть такой клауд и консоль и соответственно эта штука использовать сейчас мой телефон который лежит вон там к сожалению вот потому что единственное место где он работает через вай-фай hotspot он подключается и посылает эти самые данные что он меряет он меряет освещенность а температуру и как сказать humidity влажность соответственно если я допустим закрывают усаму штуку посмотрите бур освещенность упала до 3 соответственно я сейчас идет раздам отдам сюда и каждый из них каждый из вас может с ней поиграться а соответственно можно только не плюйте пожалуйста на нее чтобы проверить влажность вот это единственное что я прошу вот дуть можно да но дуть я думаю что не поможет вот а так не плюйте пожалуйста так будет все нормально значит она у меня выжила на участке стояла вот у меня здесь на участке стояла эта монетка здесь для обозначения размера соответственно 24 часа она продержалась на вот этой маленькой батареечки что достаточно неплохо я считаю а что дальше у нас есть дальше понятное дело для моих целей мне нужно это все не только мериде не только передавать сюда что на самом деле хорошо блин в режиме реального времени могу видеть как и у меня освещенность но и хранить и для того чтобы хранить естественно как ветеран майский эли я выбрал майский а спасибо как мы собственно говоря записываем данные в майские я даст от выбрал достаточно сложная схема сейчас я перейду в режим презентации опять а значит я что делаю я получаю данные из консоли из particle концов и использована джесс чтобы записать данные в майские соответственно я использую партиклы и pr джесс которые я можно скачать с сайта particle устанавливаю коннект к маске елью и записываю то есть я просто делаю им сорт intel вильнюс все это работает достаточно хорошо и вот собственно говоря моя pipeline что происходит мой девайс лежит у меня во дворе он подсоединяется по вайфаю к домашнему роутеру а дальше с помощью протокола mqtt он передает данные в particle дальше на мои в виртуальной машине а говорю очень сложная схема очень сложный pipeline значит на виртуальной машине работает программка на но джесс который получает эти данные от particle и записывает их майский и соответственно использовал программку or чтобы сгенерировать график ну в общем вот что получилось понятно да температура поднимается падает освещенность поднимаются падает и так далее вот здесь какой-то закат похоже поймался вот и соответственно влажность повышается к ночи это совершенно нормально а что тут интересно на этой картинке интересно на этой картинке шум вот тут например да понятное дело что это типично для приборов интернет вещей когда у нас что-то например с датчиком или может быть жучок какой-нибудь залез прямо под датчик вот и закрыл его или что-нибудь еще датчик может нам передать какую-то какие-то не левант ные совершенно данные той шум и это будет важно при дальнейшем рассмотрении ну теперь часть 2 в которой будет также включать еще одно дома может быть мы сделаем дома сейчас пока все работает не давайте давайте сделаем сейчас поговорим про майский эль и право джейсон и потом я продолжу с дымом а значит для этого дома я использую мой стиль 8 вот очень хорошо что петя смог вам рассказать про новые функции майский 8 кто был на предыдущем докладе знает я использую функции майский 8 и расскажу что собственно изменилось в о джейсоне в москве 57 и в мае сколь 8 опять же мастер 8 это совсем новая версия которая еще не готово для продакшена не готовы для продакшена но как бы ее интересно посмотреть и с ней интересно поиграть а когда мы пытаемся хранить данные получены от датчиков какая у нас первая мысль первая мысль у нас такая давайте создадим таблицу в майские ли и соответственно для каждого этого самого датчика мы будем для каждых данных типов данных мы будем создавать колонку соответственно мы создаем колонку light мы создадим колонку tempra чем мы создадим колонку humidity это достаточно логично но с этим есть некая проблема это не гибко допустим что нам нужно создать какой-нибудь еще один датчик имелись что-то еще например вот я покажу там люди измеряют остаток пиво в теге время нам нужно начать измерять остаток пиво в нашем киги вот что мы делаем здесь да вот кто вообще знает как сложно и как как петь и сказал какой как быстро ченский нужно поступать чтобы сюда чтобы добавить нужно делать all the tail да кто-нибудь делал all the temple когда-нибудь маски или окей так что вы знаете о чем я говорю да значит лттб и это совершенно не просто all that i был в маске ль 8 и там в мария дебиана намного проще реализовано но исторический all the temple это большой большая проблема а вот так что если нам нужно добавить колонку с им названием пиво например добер то это будет не так просто опять же мы дать датчики появляются исчезают что нам делать со старыми данными например мы прекращаем получать информацию про освещенность да что мы делать или например мы создаем новую колонку и как мы будем хранить то что там до этого не было стандартный подход это ну да вот но опять же для анализа это не очень хорошо какой еще один вариант да и таки values tour опи вилью мы храним название в качестве названия у нас будет написано темп чё и данные соответственно вот но в этом случае есть другая проблема в этом случае понятное дело есть проблема с тем что у нас нету типов мы не знаем что мы собственно храним в поле дата мы должны нам придется его объявить о полем текст потому что в этом случае но хожу я знаю когда я создаю свой и девайс вон интернет вещей вот я знаю какой там датчик да но если кто-нибудь еще допустим создаст свой прибор и мне в нужно будет хранить в той же таблице то это будет я буду я не буду знать что там собственно собирается какие да да понятно что можно хранить много таблиц но тогда нам нужно создавать одну целую новую таблицу на каждый датчик это тоже не очень хорошо соответственно что мы можем сделать мы можем использовать джейсон да есть кто никто не знает что такое джейсон все знают уке а пойдем дальше а соответственно хорошая новость в том что в майские 57 можно хранить джейсон как поле то есть есть тип джейсон да мастер 57 до того как он появился люди хранили джейсон пожалуйста на хранили его в поле текст а джейсон и в майские ли поле джейсон позволяет нам хранить сам джейсон собственных данные джейсона намного более эффективно кроме того мы можем на основе джейсона создать виртуальные колонки и создать на основе них индекса единственное в чем здесь есть небольшая проблема это в том что понятно что хранение у нас таблица возрастет в размере но зато мы получаем полную гибкость я мало большую гибкость а что нужно знать про джейсон и что чем собственно поле джейсон лучше чем хранить его как текст во первых он делает автоматическую валидация документа то есть если мы попытаемся туда запихнуть что то что не валидно он соответственно нам выдаст ошибку а второе и это оптимизированных формат хранения он сторону хранится в бинарном формате и соответственно он позволяет переходить от одного документа джейсон к другому то есть точно называется skip а как мы собственно можем хранить данные в джейсоне ну мы можем просто использовать гель мы можем просто сделать insert и сделать туда дэйт оф получить получить то те данные которые мы получили с девайсом давайте мы попробуем сделать дома теперь вот у меня тут есть виртуальная машинка видно да соответственно у меня есть тот майский и давайте посмотрим что значит первое что я хотел показать и это собственно показать что это за программка здесь то мое устройство еще где-то там по лидам ходит да не пропало никуда туда есть отлично значит вот собственно моя программка user password а да и я просто здесь делаю in certain ту клауд диета и здесь делают дейта в общем что я одел я получаю данные в формате джейсон уже вот и так как я получаю данные формате джейсон я их могу прямо записать в майские как есть и совершенно не думать что там собственно внутри давайте попробуем будет это работать или нет о пошло так это пример другой немножко значит здесь я наделаю парсинг этих данных и записываю его как наши медики как light значит дальше что я выяснил интересное а выяснил я интересное что на самом деле с помощью вот этого вот клауда можно получать доступ не только к моим данным но и ко всем данным который использует этот самый particle я не знаю до сих пор отработать по моему работает до сих пор вот люди по всему миру который использует этот партикл фотон посылают какие-то данные по которому ничего не знаем открыта дверь в гараже или там остаток пиво столько ты ли что-то еще вот где эти девайсы находятся мы совершенно не знаем ну мы можем их вот здесь получить то есть разница на самом деле только в том что здесь я когда я получаю свои данные я пишу девайс ток онлайн а здесь я не пишу только онлайн вот и значит если я вот эту штуку запущу то мы получим поток данных каких-то вот от каких-то девайсов которые что-то делают не оставляет очень хороший тест потому что если здесь посмотреть то здесь есть внутри этого есть не понятно что мы совершенно не знаем что это такое какие-то данные вот есть дети я утра published есть кора имеет какой-то идеи этого девайса вот есть пожалуйста doors статус до дверь дверь открыта ну хорошо ладно вот relay relay он то есть это прекрасный пример да вот допустим я сейчас возьму и попытаюсь это положить майский в нормальную структуру данных до что я буду я должен знать что там за дверь почему она открыта и какие вообще параметры он должен принимать открыто закрыто он of я совершенно это не знаю вот а если у меня есть джейсон то я беру и записываю это в прямо в маске ель в виде джейсон поля а давайте попробуем смотрите вот у нас собственно этот это джейсон и дальше я могу сделать selects the app from элементы тянут ему гигантская 10 вот ну вот она пожалуйста все записалось ok возвращаемся к нашей презентации если вы были на предыдущем докладе петя рассказал что вот есть докер manstore документ 100 и это такая попытка в майские ели сделать хранилища для джейсона я обычно очень люблю стиль вот и знаком с ним и как бы если мне скажут ну я могу сделать искали запрос концерт в доме но многие люди не любят из кель по разным причинам и вот докюн стоит может быть решение для них а почему потому что с помощью док ман стороны можем абстрагироваться от с келли и подключиться к майский эли и соответственно прямо туда забивать джейсон и то есть ещё одна возможность которая появилась в маске 57 соответственно мы можем использовать другой протокол для этого то есть порт другой тоже вот нужно другой драйвер я соответственно для но джет ли любых языков программирования на самом деле печки и java мы подключаемся к маске или по-другому протоколу и можем соответственно передать туда наш наши данные формате джейсон то есть опять же я не знаю чего у меня там в этом джейсоне какие-то de ville или что-нибудь еще и соответственно просто их туда закидываю майский сбрасывают а что там мы разберемся потом соответственно если кто-нить хочет поэкспериментировать с этим можно сконфигурировать майские 5-7 на то чтобы он соответственно понимал и слушал на соответствующем порту называется документа о или x интерфейс и акс интерфейс соответственно вот я использовал коне коннектор на all.biz а соответственно опять же это пример того что я собственно туда записываю вот здесь какой-то какой-то пиво что то такое да я совершенно не знаю что там и мы потом этом и это запишем туда и проанализируем потом окей теперь следующий пункт нашей программы это как собственно посмотреть что там в джейсоне и майский 5 есть такая отличная функция которая может собственно вытащить значение из джейсоном вытащить какие-то поля из этого джейсона то есть это такой синтаксический сахар на самом деле на функцию джейсон экстракт вот он очень удобно и по крайней мере мне кажется что он очень удобный и для дейта в данном случае это наше поле в котором хранится джейсон a name это наше собственное поле name дейта published это все мы таким образом можем можем вытащить соответственно а что я хочу сделать я хочу посмотреть собственно что у меня записалась в этот в этот майский в таблице майский эль и посмотреть 10 самых последних записей а и соответственно я вот делаю такой запрос и пытаюсь его выполнить к сожалению это будет очень долго аналогичным образом майский в данном случае не будет использовать никаких индексов потому что мы собственно что делаем мы вытаскиваем данные из джейсона который хранится там внутри и попытаемся делать какие-то фильтры и сортировать в этом случае у нас получится user files если кто-нибудь из вас когда-нибудь работал с explain the user files сорт это очень плохо это значит внешняя сортировка а соответственно что мы можем сделать хорошие новости в том что мы можем создать мы можем сделать две вещи 2 шага первый шаг это мы создаем виртуальную колонку майским 5 мм позволяют нам создавать виртуальные колонки соответственно здесь я делаю expect да то есть вытаскивают данные из джейсона и на его основе создаем виртуальную колонку виртуально колонка майский 57 мой стиль 8 виртуальная колонка не хранится это просто возможность создать отдельную колонку вот тут мне один человек сказал что как же ты так что ты говоришь что all that they bleed ешь такая долгая операция тут делаешь all the tail как же так на самом деле здесь не так все плохо при создании виртуальные колонки то очень быстро операция там есть лог но лог на самом деле есть маскелина всех ддл операциях и это достаточно быстрая операция и она не перестраивает всю таблицу соответственно мы здесь ssd создали виртуальную колонку мне пришлось сконвертировать дату потому что даты которые там хранится в джейсон не она совершенно в другом формате она высок а здесь в майские ли используется другом файл формат соответственно я для создания колонки я назвал ее дал ей я тип и соответственно сказал что собственно я буду туда записывать теперь второй шаг до во первых мне нужно тебе давайте посмотрим еще раз на наш запрос значит наш запрос и это select и о добавить до этапа плеч для оптимизации этого запроса нам нужно собственно вытащить published in и соответственно published мы сделали теперь наивным проще просто делать делаем виртуальную колонку теперь шаг номер два это мы создаем индекс соответственно здесь я создаю индекс просто на publish it и выполняю этот запрос ну и теперь мы видим что на самом деле мальски использует индекс это оптимизация order buy на самом деле здесь а на самом деле дату в данном примере дата не на индексируется ныне индексируется он использует order buy и так как у нас есть яндекс на published то он этот индекс используется использует более того самое интересное что я бы на самом деле мог бы вместо order buy бы использовать тот же самый синтаксис вот этот вот sensi синтаксический сахар дата чего-то там published да он все равно бы понял что есть яндекс на эту колонку и начал бы его использовать а теперь с этим на самом деле есть небольшая проблемка и мы теперь начали говорить о майские ли джейсон больше чем про интернет вещей значит допустим что я хочу их отсортировать не только по published но еще и по названию потому что на самом деле published если у нас десятки тысяч ивентов в секунду to publish титаном не даст хороший сортировки там будут дуплекс соответственно мы добавляем сюда ещё одну сортировку по дотан и что я хочу сделать это на самом деле типичный запрос не только в для интернета вещей и типичный запрос когда там дайте мне 10 последних событий но отсортируйте их по дате и потом отсортируйте их например о не знаю по имени человека да там по фамилии вот соответственно фамилия должна быть по возрастанию что я здесь делал во первых здесь девять два поля во вторых указаны два ключа ключа сортировки dsm день и снг а значит прежде всего в этом случае майский не будет использовать яндексе майские в данном конкретном случае лишает что полный скан таблица будет выгоднее чем использование индекса и опять же используется файл сорт что очень медленную операция в майские 57 это решить нельзя ну можно решить за счет других вещей вот но вот такой запрос оптимизировать нельзя в маске ль 8 опять же петя предыдущем докладе об этом говорил в майский 8 появилась возможность реальная возможность указывать собственно сортировку для каждого поля самое интересное что вот этот вот ключ бесценная 7 день после на название индекса он был в иске ели то есть даже в самом первой версии майский ли там 323 можно было указать publish and decent него published a sandy но москве внутри ничего не делал он принимал но не сортировал сортировал всегда в одном направлении а вот значит соответственно в маске 8 это поправили и теперь такая фича есть мы можем создать поле по из сортировкой по убыванию сортировка по умолчанию давайте вернёмся на секундочку назад и посмотрим но вот этот пример еще раз значит почему это работает а то не работает да а это работает потому что в майский яндексе и тоби 3а индексы by three можно читать и сначала из конца в данном случае маркер читает индекс конца и соответственно использовать яндекс и все хорошо но если мы делаем descent и осины то такое нельзя прочитать можно прочитать в одном порядке да но совместить 2 2 сортировки нельзя нужно пересортировать вот поэтому для такого случая так как мы оптимизируем совершенно конкретный случай мы можем создать яндекс и указать конкретную сортировку соответственно в этом случае descent не сны ну и собственно говоря майский эль это использует индекс этот используется и все хорошо в этом случае а вот это опять же эта фича майский 8 который к сожалению еще не вышел сми можно поиграться но он еще не готов для продакшеном что еще есть еще есть интересная штука на две интересные штуки которые хотел показать во первых можно сделать pretty print то есть красивое это вывести на экран обычно просто делаем она вот как я показывал select дата он это джейсон не форматирует можно джейсон отформатировать еще можно в мазке ли вот у меня нету слайды к сожалению на это можно сделать сказать ему чтобы майский вывел результат в виде джейсона ну вот джейс норы или джейсон объект и указать секс на поля и он тогда форматирует вывод в виде джейсона а последнее о чем я хотел сказать и это нас еще сколько 10 минут есть значит последний что я хотела сказать это полнотекстовый поиск внутри документов джейсона на самом деле если мы используем гибкую систему хранения и мы собственно не знаем что там внутри нашего джейсона то было бы логично использовать полнотекстовый поиск к сожалению а полнотекстовый поиск имеет свои ограничением ну первое что я попробовал естественно да это просто взять и создать полнотекстовый ключ кто-нибудь вообще использовал полнотекстовый поиск полнотекстовый индекс майский или ну отлично что вы знаете о чем я говорю соответственно я попытался сделать такую штуку а к сожалению это не работа даже в маске или восемь создать полнотекстовый индекс просто по полю джейсон к сожалению невозможно а я бы конечно хотел бы иметь такую функцию и возможность поиска хотя бы по ключам а джейсона было бы очень полезно ну если такое невозможно то давайте тогда создадим виртуальную колонку ну у нас собственно в нашем случае у нас собственно поле да то есть до которую нам бы интересно было бы посмотреть что там внутри сожалеют тоже не работает виртуальные колонки нельзя на виртуальные колонки нельзя создать полнотекстовый яндекс ну раз так то давайте создадим хранимую колонку до майский 57 позволяет объявить эту саму колонку полем как храним у предыдущий пример которая показывал мы создавали виртуальные колонки они не хранятся noindex и соответственно создаются и хранятся в данном случае мне пришлось сказать ему чтобы эта колонка была стоит а вот то есть она будет создана и данные в ней будут скопированы но после этого майский эль создал полнотекстовый индекс ему пришлось пересоздать но это ограничение на тебе на самом деле не надели full-text search пришлось пили создать таблицу чтобы добавить специальный идентификатор полнотекстового поиска что еще интересно вообще это про это не говорили еще в майские или 57 майский 8 появилась новая кодировка utf-8 mp4 как вот петь в предыдущем докладе сказал это на самом деле для смайликов на самом деле не совсем вот это для есть нет некой некоторые проблемы с русским языком в youtube в mp3 и есть проблемы с китайским и японским языком и так далее а вот что интересно что на самом деле джейсон в восьмой версии должен хранить данные в youtube в 8-ом youtube 8-м beach 4 но судя по всему что то при как бы но джея сконектиться к клауд что-то там не так было туда записано было что-то не так поэтому что мне пришлось сделать и это мне пришлось сконвертировать то есть сделать каст этому самому потому что там есть перед тем как мы записали ее в хранимую колонку так что может приходится похоже это на самом деле бак потому что так быть не должно так что мне пришлось сделать вот это и после этого я смог собственно создать полнотекстовый поиск на 2 полях на название что там у нас название джейсона и в собственно данных это а вот ну и собственно говоря джейсон это не только интернет вещей джейсона может использоваться для разных других интересных штук соответственно для всяких вещей типа cms я не знаю там drupal или что-нибудь еще какие то вещи могут быть намного удобнее реализованы с помощью джейсона ну вот на арка лапин вал приводили отличный пример когда нам например нужно зарезервировать место в кинотеатре и соответственно если мы это реализуем в реляционной модели это очень сложно получается очень много таблиц много зависимых таблиц много join of и так далее вот мы можем хранить весь зал как джейсон как структуру джейсон и соответственно записывать его майский другие таблицы используются обычному я соответственно мы можем создать какие то индексы на основе этого джейсона и так далее то есть какие-то сложные структуры удобно хранить в формате джейсон но собственно и все вот это дерево которое мы посадили вот совершенно была успешно посажены к сожалению через несколько лет его съели олени но это уже другая американская проблема оленя ходит по улицам могут есть всякие разные фруктовые деревья вот на этом все большое спасибо вопросы вопросы можно задавать да спасибо большое за доклад вопрос джейсон то есть правильно ли я понял что джейсон это просто тип поля дополнительный по которому возможен поиск ада джейсон это тип поля чтобы по нему делать поиск мы должны или сделать reference да вот я сейчас еще покажу вот здесь да вот у нас вот так например сделать выделить что-то ему да вот или мы можем создать виртуальную колонку и соответственно ее использовать прямо в наших запросов просто как готовы вокруг пытались болида просто обычное поле который мы вытянули собственный джипиэс джейсона и она не хранится по умолчанию 1 против большое спасибо за доклад очень интересный вопрос такого характера вы сказали что при сохранении джейсон вали дерутся как я понимаю происходит только синтаксическая валидатор схем проверить невозможно нет не возьму ни не не проверяется на самом деле с кем там хранится то есть поля а тип полей одни как бы пытаются там сформироваться но это небеса он вот если знакомы с манга тебе там bison это мы вот-вот валидации схемы нету как таковой только-только синтаксически если там какая-то ошибка джейсон синтаксически неверен тогда возвращается ошибка спасибо заняло два коротких я у нас дед лопаю получился да да спасибо я наверно немножко похоже проскочил задать то есть никакой возможности ограничители и сказать какая структура джейсон должна быть какой-то constraint ножи через адель и не нет нет как на самки как такового нету есть что можно сделать можно создать опять же виртуальную колонку да вот но опять же это не constrain то есть при записи в джейса мысленно синтаксически валяной то у нас не произойдет никакой ошибки то есть нельзя сказать что вот это будет интеджер если у нас получается запись не интеджер то это не будет это ровно противоположное идея в на самом деле это очень хороший вопрос потому что очень много людей как раз хотят такое да и в manga тебе как раз появилась validation джейсон и можно сказать что вот здесь такое ограничение но в майские лет его нету майский как бы пришел с другой страны и майский пришел к тому что у нас все очень четко у нас есть схема до джейсон это настройка когда собственно нам не нужна схема но вот к сожалению пока такой функции нет меня два коротких вопроса вот первый по поводу select а вот допустим у нас джейсон там простенький да вот одноуровневый мы сделаем запрос на select и найдем там поле на какой-то джейсон вложенной ну там большой сложностью допустим поправка для я напишу какой то понял найдет а вот просто здесь можно сделать еще точку и доллар . то есть их все можно их месте как я это 1 или 2 вопросы вот с апдейтами точно так же все легко пройдет вот это хороший вопрос вот у меня здесь к сожалению нет этого слайда вам мастер 8 вообще апдейт как делается да мы просто или переписываем весь джейсон или мы используем функцию джейсон апдейт в майский 8 есть дополнительные функции которые позволяют апдейтить джейсон и они используют так называемый in place апдейт потому что по идее если мы переписываем джейсон то это весь а может быть какую-то маленькую штуку хотим об дойти до и в москве 8 как раз поддерживает москве 57 не поддерживает не поддерживает 8 поддерживает in place апдейт для джейсона то есть он джейсон атаку он только кусочек для только кусочек который мы изменяем но это нужно использовать функцию можно чуть-чуть вопросе коли сказали что ну-ну-ну сколь бы лари лицом к все хорошо схема бабло понадобилось данный не схема а вот а между появилось поле джейсон между собой ли их как-то можно то есть мы ну вот кроме того что появились вот эти виртуальные колонки для сортировки кинут можем залезть внутрь ну по аналогии с манги как-то их прилепить крик к реляционным условно за джони теле какие-то над свойствами над атрибутами в самом джейсоне проводить операцию а есть много разных функций в майские ли можно собственная здесь показал вот эту вот функцию до больше знак больше это собственно синтаксический сахар это на самом деле использование внутри она использовать функцию джейсон экстракт таких функций есть несколько разных которые могут там и путь какой-то вытащить и кусок и собственно показать все атрибуты джейсона до имена этих атрибутов и так далее то есть это все можно сделать дальше если нужен g нужен join date а можно прямо вот опять же вытащить то что мы joy ним до из джонни с другой колонкой например если какой-нибудь нужен словари сделать до на основе джейсона это все можно сделать а вот мы можем опять же это джон без виртуальные колонки без индекса будет очень долгим но если мы создадим на основе у него обычную виртуальную колонку в майские ли сделаем индекс то можно будет джонни другие таблицы таким образом можно сделать что-то очень сложное например мы джо и ним на основе какого-нибудь айди в внутри джейсона и дальше выдаем другой джейсон котором собственно раскрываем этой идеи отделан слова такое можно сделать спасибо за доклад пара вопросы сразу срублю вопрос первый но 1 тема эти озвучено вообще целесообразно по хранению по месту потому что призваны два байта это два байта а метаданные в каждом поле это теперь вопрос 2 pro сразу если мы храним непонятно какие данные то можем джисона получить какой-то искрой потому что там вообще есть то есть получить описание тех самых атрибутов которые вообще есть в этом поле есть есть функция который может который позволяет получить список этих самых атрибутов внутри джейсон вот есть все всех атрибутов по всему полю по всем значениям просто опять же час он может быть разной структурой ну первый можно насколько я понимаю можно сделать сначала первый уровень потом соответственно по то опять же можно же получить от jason приложение вот там раз прости имеется ввиду внутри майские ли можно ли я допустим сильно для пар сил много разным зонам зачем разные да я хочу понять а что же мне теперь когда опирать почему не устроит до для для такой случай можно да можно сделать печать первый уровень с помощью этой функции потом второй уровень с помощью этой функции можно его сделать там есть я не помню сделали они джейсон 3 в релизе можно сделать джейсон 3 но я не к сожалению не помню пошло оно было мая сколько 80 не пошла ну и про место штаб prime про место первый вопрос был а про место да да это тоже хороший вопрос на самом деле вот а понятное дело что даже в бинарном формате по умолчанию там никакой компрессии нету даже бинарном формате все равно каждое название атрибута будет храниться каждый раз каждый на каждой пуле и место конечно будет занимать намного больше вот с точки зрения интернета вещей мое личное мнение такое что если я знаю что у меня вдаль датчики да и я это никогда не буду менять и никакие новые датчики не буду добавлять то просто использовать обычную стандартную структуру это будет максимально с точки зрения места на диске не с точки зрения производительности это будет наиболее эффективна ну а если нам нужно соответственно гибкость то за это к сожалению нужно платить вот что есть еще этого перка на сервере есть возможность сделать компрессию для джейсона если джейсон большой вот можно сделать так называем field компресс каллум compression и соответственно таким образом немножечко его уменьшить или можно сделать в и на тебе есть компрессия на всей всю таблицу можно сделать компрессии на все там нет спасибо с вашего позволения меня вопросик небольшой адекватна ли маску или джейсон применять для событийного логирования в произвольном формате джейсоне да есть такая есть такая опция на самом деле интересная вот насколько она производств точки зрения производительности может быть это и не лучший вариант опять же майский эль и так далее но с точки зрения гибкости опять же да если нужно обязательно логировать в майский эль то туда вот для логов исключительно для логов да если у нас нет никакой другой реляционной модели которые нужно объединять с этим я бы не использовала я бы использовал что-нибудь другое использовал не знаю может быть манга тебе для этого бы использовал вот но если нужно обязательно использовать майский по каким-то разным причинам то конечно это намного проще чем реализовывать для каждого логово реализовывать свою структуру и так далее еще вопрос такой точнее два вопроса первый вопрос плане не знаете ли вы что-нибудь о планах разработке новых коннекторов я так понимаю сейчас очень немного вот и второй вопрос опять же по виртуальным колонкам а если у нас вот в данном конкретном для данной конкретной записи в более нету значения у нас вообще такого боли нету там будет ну правильно да правильно ну и по коллектору да опа коннектором я к сожалению не могу ответить про планы разработчиков это сейчас делает уроков или кто-то кто занимается собственно говоря коннекторами вот коннекторы для обычного майский эля да есть для любых языков программирования и можно использовать не обязательно использовать документ столь да да к минстроя это только один из вариантов соответственно можно работать с джейсоном твои внутри с киеве вот собственно вот эти вот все вот эти вот все примеры они совершенно не требуют какого-то специального коннектора единственный пример который требовал этого коннектора это было вот когда мы смотрели продуктивен store вот а все остальное что было в этой презентации это не требует никаких дополнительных коннекторов и использовать обычный клей не вопрос про performance ребят из под брус они хвастаются тем что у них их не пришел работает так же быстро как манга как маску или ну то есть я знаю что 5 6 было не очень хорошо в 57 роли что стало лучше от восьмерки и сравнилась или не очень они за дом не думаю что изменилось какая-то производительность то что мы тестировали производительность не изменилось потому что формат не изменился и пар сердце собственно не изменился производительность а джейсона она как бы зависит от каких штук если мы что-то из джейсона на лету вытаскиваем это один низкий да это одно если мы используем виртуальные колонки это совершенно другое а виртуальным колонками будет быстрый виртуальный колонка блюз индекс да это я собственно говоря максимально быстро что что можно сделать с этим как бы ничего не сравнится вот а если данные вытаскиваются и за соответственно из джейсона на лету то соответственно это конечно будет не так быстро в 5-6 джейсона нету я чувства на в 57 джейсон появился в 5-м марий тебе он был еще до этого вот мария тебе храни джейсон немножко по-другому они они не хранят его в бинарном формате не хранят его прям в тексте и производительность на самом деле сравнимое у них немножко другой подход к хранению джейсона вот а так что с точки зрения производительности я не могу про пост для санчо к сожалению сказать ничего не знаю про после почему можно еще разочек я тут коля у нас открыто про коннекторы вопросик для чего они в принципе вот отдельных коннектора кроме как может быть синтаксического сахара для каких-то языков типа ноды если в нем я сразу просто какие-то плюсы которых ну нету в обычном ускорю в синтаксисе это опять же немножко на мангу похоже заброс принц да да да это собственно здесь какие есть плюсы и это собственно похоже на манга но это это начало скрипт да вот идея состоит здесь с точки зрения джейсона здесь на самом деле никаких дополнительных плюшек нету если у нас просто и джейсон моего просто запихиваем туда вместо использования escape но коннектор вообще этот протокол x он а очень интересный во-первых он использует в нем есть возможность асинхронных вы вызовов вот асинхронные вызовы собственно говоря если мы что-то записываем aс келли мы должны дождаться пока москве нам что то ответит на а здесь мы можем сделать их асинхронно то есть мы туда что-то записываем и не ждем то есть как бы как из автомата стреляешь на выстрелил и забыл вот соответственно вот такая штука есть есть еще а там есть еще другие разные вещи главная интересная вещь кроме этого еще в том что там нативный java-script соответственно если документ идет на java скрипте то можно туда прям тот же код записывать он будет выполняться внутри серую там есть java script там есть питон сейчас а то есть можно туда с помощью питона там прям внутри сервера как бы внутри протокол этого пока мир уйти так далее думаю можно сказать спасибо известный доклад концепция"
}