{
  "video_id": "a9vLS0ZiTIU",
  "channel": "HighLoadChannel",
  "title": "Prod, do stack: production-ready-решения через data science-конкурсы / Андрей Киселев (Dbrain)",
  "views": 281,
  "duration": 1968,
  "published": "2019-05-14T15:01:19-07:00",
  "text": "всем привет я в всем платформы по разметке данных компании brain расскажу вам небольшую разогревочным историю о том как мы с помощью его конкурсов по машинному обучению строим прямо готовый продакшн и решениям сейчас всё та же у нас тут совсем немного я думаю что лично быстро от стреляю с докладом потом мы может просто немного пообщаемся за жизнь расскажите вообще кто из вас профессионально занимается да это страницам анализом данных три человека забавно ладно побольше раша а кто из тех кто сейчас поднял руку когда-нибудь участвовал в конкурсах или хакатон их панель из данных замечательно хорошо я расскажу чуть больше контекста что все остальные тоже понимали о чем разговариваем смотрите на каком-то этапе жизненного цикла задачи связанные с машинным обучением оно вырождается в такую чётко сформулированный математическую задачу в которой у нас есть совершенно понятны и форматы входов-выходов какие-то метрики оценки качества наших предсказаний и задачи да это не является всего лишь построить какую-то математическую модель который умеет из некоторых абстрактных иксов предсказывать и игреки там например размещать картинки каким-то образом и в какой то момент людям пришло в голову саша аналогичной мысль что такие задачи очень легко аутсорс поскольку вам не требуется погружаться в бизнес-процесса берете занимаюсь математикой радуйтесь жизни и их начали аутсорсить через конкурса похожие на типичный конкурсы для программистов например вроде олимпиадного программирования 7 и так далее в таких конкурсах участникам выдается ведь сет часть данных котором размеченная часть нет они строят какой-то модель машинного обучения которые строить предсказания для не размеченной части загружают эти предсказания на оценочный сервер получает как значения метрики но и кто получит значение метрики лучше всего тот молодец получает денежный приз славу в комьюнити и по пути нарабатывать кучу полезных навыков но соответственно бизнеса которые заказывают получает технический pr нанимают топовых участников конкурсов ну и в теории должны выбрать как получать решение капли специфичной задачи которые внутри решить не могут по той или иной причине сейчас существует достаточно много таких платформ а самые крупные из них это платформу бегал которую недавно купил google классические программистские платформы для конкурсов по программированию ради topcoder тоже подтягиваются к конкурсам падает со ын су и у всех этих историй есть их объединяет две характеристики они поддерживают огромные комьюнити 30 став и дают огромный вклад вообще в развитии навыков людей которые занимаются да и танцам и в так дают сильно облегчает порог входа в эту отрасль но solution и полученный результат таких конкурсов на самом деле вообще почти никогда не работает я не знаю ни одного случая когда результат конкурса был бы хоть как-то интегрирован в продакшн и в основном связано с тем что участников конкурсов требует получить к метрику как можно лучше на каком-то сумочку от разово предсказания на тестовых данных но их почти никогда не ограничивают того времени вычислений не требует писать репродуцировать код и так далее для участников конкурса откажешься очень весело не развлекаются спешили строить какие-то сложные модели учат дэйт сайнс пишет себе прикольные строчки в резюме когда выигрывают конкурса а вот для компании которые заказывают эти contest и ничего веселого там нет потому что чтобы проинтегрировать решение из конкурс приходится прикладывать какие-то невообразимые усилие не факт что она вообще соответствует собственная production сценарию его использования участники конкурсов строит и совершенно космические тендерные каракатиц ради того чтобы получить там лишний процент к метрике просто стандартный жизненный пример вот результат с третьего места типичного конкурса на кабеле здесь по моему 24 модели все это нейронные сети которые предсказывают там знаю по 10 секунд реального времени тоже предсказать на одной картинке что-то и чтобы посчитать вам нужен супер-компьютер заказчик который хочет этот конкурс хотел общаться когда-то запускать решения на мобильном телефоне мы понятно что как то результат с заказом совсем не мочиться мы решили построить конкурс на платформу которая никто вроде решала бы эту проблему из фиксировались на двух принципиальных характеристиках во-первых мы заставляем участников писать код который можно запустить в отрыве от его автора которые полностью чуждо им и и мы заставляем писать этот код в таком шаблоне что результат конкурс автоматически превращается в облачной api буквально нажатием одной кнопки и мaмa мы тренируем модели участников на наших облачных мощностях что приводит к тому что мы можем ограничивать вычислительной мощности ставить всех в равные условия и таким образом гарантирует еще хоть какую-то юзабельный полученного решения соответственно случается немножко другой юзер экспириенс как для бизнеса в заказчиков так и для участников конкурса участники конкурса вроде как в знакомом соревновательном окружении продолжатель в новации за метрику но тем не менее они не могут пользоваться собственным железом соответственно что талантливый студент что взрослый эксперт находится примерно в 1 в одном и том же тире и бизнеса не только получают какие-то бенефиты по пиару и развитию комьюнити ну и действительно получают решение которое можно интегрировать хотя бы в мвд как в целом работает с точки зрения да и ценят участника конкурса мы выдаем да и ценится небольшую часть от всего длится это который может скачать посмотреть покрутить в руках написать какой-то локальный код на своей машине с не поиграться после этого дети пишут код по некоторым шаблону который исполняется в нашем облаке на полном дайте сети этот код должен уметь тренировать модель сохранять артефакты которые необходимы для восстановления модели и строить предсказание на тестовых данных после этого код качество кода оценивается нашей платформе и дать ценится получает score вот ну давайте просто обсудим какие общие есть этапы работать такой платформой какие здесь есть забавные анекдоты про катар может подслушать понятно что поскольку железках у нас не бесконечное и участника в конкурсах много их решение при загрузке впадают в очередь но как сработает очередь задачи все из вас знают поэтому про это рассказывать на вернет смысл но процессе анализа данных с проведенных конкурсов обнаружился прикольный факт участники когда за решают задачу подлетаем запада и таинстве вообще исследователей в этой области они регулярно переключаются между двумя режимами работы первый режим работы это когда мы и тренируемся по разным решением построили модель загрузили код получили результат по чесали репу поменяли кот опять получили результат другой вариант когда мы там перебираем гипер параметры сыграем скинуть брутфорсом загружаем огромное количество решений уходим пить кофе спать не важно получаем score выбираем лучшие из них соответственно если настройкой платформу то через задача нужно адаптировать под два этих поведения и это можно делать меня и приоритет задач в очереди исходя из чистоты загрузок решений люди которые загружают решение чаще оказываются в очереди ниже как ни странно их от устраивает поскольку они не ожидают получить результат быстро хорошо что происходит дальше решение участника прошло через очередь и нам соответственно нужно собрать окружении вторым вы его запускаете и обучить это решение что является окружение в котором запускается кодекса инцестом на самом деле единственный способ это сделать это собрать под него целую целый образ операционной системы с помощью в только в докер-контейнер связано с тем что у нас очень сложно инфраструктуру на всякие драйвера видеокарт версии всяких страус сложный библиотек вроде тандыр плов без обратной совместимости черная чище стрессом предоставляем либо готовое окружении либо возможность указать простую ссылку на публичный контейнер в докер хобби участник выбирает один из этих вариантов загружаете свой код указывает инвар mind контейнер у лиц с докер хаба в контейнер собранный кладет сход и к нему подключается полный дэйтасет которым до этого участника доступа не было и все это происходит уже в нашем облаке участников дачнику контроль не имеет если он написал хороший код то все должно работать слитого в собранном контейнер с полными данными запускаем тренировку модели в результате тренировки модели участник должен сохранить артефакта которых достаточно для того чтобы полностью с нуля пересобрать контейнер с об уже обученной качественной моделью который будет строить предсказанием отлично научили модель участника полностью перри собираем с нуля контейнер с его кодом убираем из него все данные кладем к нему артефактов из участникам писал все хорошим воспроизводимым стиль это его модель должна загрузиться из полученных артефактов и подключаемые к этой который позволяет делать предсказания соответственно некоторый скаляр отправляет в модель участника данная она отдает предсказание по этим данным агрегирует метрику возвращаем метрику что мы сейчас получили на этом этапе уже на этом этапе мы получили достаточную структуру для того чтобы взять и буквально нажатием одной кнопки код загружены участникам код отправить в облачные и 5 который будет реализовать как функционал для тренировки модели на новых данных так и функционал для по стране предсказаний vis-a-vis на это 35 можно подключать к каким-то mvp прям в какой-то продакшен так далее накладывать дополнительное ограничение на контейнеры в которых участники исполняют свои решения можно регулировать и скорость с которой будут строиться предсказании скорость который бы происходить обучение требуемую вычислительные ресурсы и все что вам захочется вплоть до конкретных версии библиотек которые хотите использовать и это работает мы проводили такой конкурс весьма нетривиальной задачей которым участникам требовалось в реальном времени с учетом от обучения предсказывать поведение криптовалютных рынков делали мы это замечательной компании есть индикатор и получившиеся решение притом разнообразные решения сейчас тестируется в продакшне без модификации исходного кода вообще то есть со стороны заказчика требуется только подключиться к пешки все дайте проблемам и вообще решили мы решили проблему с репродуцировать и экспериментов на самом деле мы косвенно решили проблему с контролем версии в эксперименты по машинного обучения в том что все версии коды которые участники саммита в конкурсе универси они руются и они позволяют обучить запускаем качественный модель гарантировали что все участники этого как публичного исследования оцениваются абсолютно одинаковым образом работают на одинаковых рецепт ну а если подумать мы сталкиваемся с ровно тем же набором проблем в обычные этот сцен с разработки нашей каждодневной рутины если у вас над каким-то проектом просто внутренним работает больше двух человек вам уже приходится прикладывать какие-то невообразимые усилия чтобы заставить их писать нормальный кот они лапшу в юпитер ноутбуках требовать постоянной консистентной sti данных на протяжении всего research и следить за метриками следить за тем что ваша модель укладывается в требования по железу которые диктуются паттерном и использования продакшне на и повторив на все это мы задумались что на самом деле такую платформу можно использовать можно и нужно использовать как инхаус tool для dates and разработки это действительно подтверждается тем что как минимум в двух крупных компаниях и во множестве стартапов так или иначе части этого функционала действительно реализованы к для разработки да это санс моделей так и для их интеграция и от решает проблемы с и продюсер был research и с возможностью за тепло из mvp вашей модели для кайта предварительной оценке вообще в любой момент вашего исследования не только на в каком в конце через месяц когда ваш над adsense ковыряется счет сделать и подумав об этом мы действительно собрали версию такой платформа для использования in-house и мы полностью сделали проект по компьютерному зрению видя всю разработку через в таком конкурс на формате в проекте участвовал 430 это не задача была построить модель по детекции крупного рогатого скота на кадрах security камер соответственно поскольку этот кадр security camera их много накладывались определенное ограничение по скорости работы моделей и мы были очень приятно удивлены результатами в любой момент мы могли взять работу любого дети сиониста все из которых пишет на разных библиотеках на разных фреймворков в любым и это мы могли запустить ее подключить real-time api жки гарантировали что нужно informing для что обучения что запуск модели никогда не потеряется вы могли в любой момент сравнивать работу любого из четырех сотрудников и при этом и при этом промежуточные результаты нашей работы стимулировали участников этого внутреннего конкурса соревноваться попытках доказать кто из них круче кто из них сильнее люди работали даже по выходным в очень привычным для не очень привычно для них как в подобной среде и несмотря на некоторые неудобства связанные с таким форматом разработки решили все решили все эти решили задачу намного быстрее даже чем мы планировали вот в связи с этим хочется просто сделать такой call the edges мы хотим за open source такую платформу для внутренней сцен с разработки ну вот не хотелось бы с вами просто пообщаться поскольку у нас малый обстановка камерами на тем того как вообще себе видите сценарии использования подобное подобная конструкция у себя внутри спасибо за доклад вопросы привет меня зовут катя я продакт менеджер команды из общем дай навозом вопрос собственно такой я правильно понимаю что вы это проверили на 2 экспериментах одном внешним одном внутренним на самом деле на трех внутренних и одном публичную внешнему а вот можешь пожалуйста рассказать подробнее про публичный внешние сколько-то было участников на какой-то платформе это происходило в могу рассказать на публичный внешней эксперимент проходил на нашей платформе привлекали туда да и таинствах через комьюнити ds участвовала в конкурсе активно 32 человека за время конкурса не загрузили более чем 400 решение задачи была следующая задача была от компании индикатор компания синдика пор торгуют активными на крипты биржах и у них есть огромное число аналитиков которая в разный момент времени строят предсказание о том куда пойдет рынок и участнику конкурс нужно было построить и пей которая могла бы учиться на исторических данных о том какие предсказания аналитики сделали чтобы понять как согревать их знания и поставить ставку куда собственного на самом деле двинется рынок исходя из их исходя из предсказаний аналитиков и участникам требовалось реализовать функционал до обучения поскольку эти предсказания приходят в комнату реальном времени вот мы соответственно они сеть написали такой код который имеет потренироваться на исторических данных и пода обучаться на новых данных и выплевывать предсказания в топе у нас вышло три решения все три совершенно разные и в данный момент они все выкладывались в требования по производительности и в данный момент вот 10 из этих 10 топовых решений тестируются против основных решений которые есть для задачи в синдикат or прямо вот в реальном времени сайд бай сайд то есть в данный момент выясняют до получится ли будут ли эти решение работать эффективнее или то что я сейчас нет непонятно и скорее всего эффективно и не работать не будут но тут есть такой thread'ов одно дело когда у вас в компании два года пять ваших insane house сотрудников работать на задаче другое дело когда у вас за месяц на задаче поработала 300 человек и результаты получились хуже но возможно сравнимое если хотите сделать быстрый вид и например вы стартап его нужно решить сравнительно типовых задач при вас нет да и ценится то у вас есть вариант ли пойти на порка нанять его или понять winehouse но это очень сложно потому что вам нужно сильно внутренне квалификации нанять хорошего человека будет состояния чей задач в контекстах это проблема в некотором формате решено потому что вас участники соревнуются с друг другом кто круче вам не нужно следить за за их качеством спасибо очень крутая штука здравствуйте меня зовут андрей скажите пожалуйста каким образом вообще решаемо ли проблема если компания не хочет публиковать свои данные павлик скажем так да то есть такой до просмотрите я потом я об этом не не рассказывал поскольку это не совсем бизнесовый пресс но именно на самом деле для решения этой проблемы с не возможность публиковать данные мы сначала всю эту тему и затеяли не публикует данные вообще в принципе задачу решить невозможно каждой сцене цифра нужно иметь доступ хотя бы какой-то части чтобы хотя понять с чем он работает мы действительно отдаем небольшую долю этих данных которые возможно можно даже симулировать вы можете как-то анонимизирован эти данные построить какую-то простенькую модельку который сгенерирует вам искусственные данные которые будут соответствовать по формату настоящем и по среднестатистическим распределению соответствовать настоящим но не быть например настоящим персональными данными только небольшую долю всех ваших данных вы позволяет скачать человеку все остальные данные они находятся в нашем контуре и подключаются к его кабины этапе обучения и контроля за этим этапом стороннего участника никакого нет у него нет возможность залезть он ко мне вечером происходит но хотя бы какой-то формальный там оферта с участниками не подписывается они принимают ее о неразглашении как это сложно темного ним технически каждый день можно подписать и следком закрытом формате делать да но основная проблема с тем что вы не хотите выкладывать все данные она да она решена это приводит к нам очень интересному side effect когда участникам конкурсов на стандартных платформах доступен весь да и цвет и это на самом деле то же эффект возникает и в обычным research котором доступен весь do it set вам психологически очень сложно строить не более рабастан и и устойчивые решения потому что вы должна обладать очень большой сдержанностью очень большим опытом чтобы не за точится под доцент когда вас есть доступ ко всем данным когда вас физически нет возможности посмотреть на большую часть данных вы знаете только их формат ну приходится думать над тем как сделать решение максимально устойчивым и надежным и 2 просто можно о ограничением ну вот по in warm and ограничением работа модели то есть можно ли вводить какие-то свои ограничения что например там время на prediction до конечной об этом упоминал тут есть такая некоторых сложно инфраструктурной история до ограничения тривиальные вроде ограничений на время тренировки ограничения на время предсказания это все просто лет все естесно делается ограничен то мы потребляем память процессоры что угодно и железо кастомные подключается автоматически вот нет никаких проблем если вам нужно к конкретной версии видеокарты например знаешь нас вроде используется именно такая ну покупаются облака с такой видеокарту все работает есть смешной анекдот расскажу его сих пор не решена качественно проблема разделения видеопамяти на конфи мирских картах а мы обучаемся наши модели машину обучение обычно на канте мирских картах ни у кого ни дома ни наверное в компаниях тест они стоят вот несколько нас есть тоже никто и внутренней функционал котрый позволяет на одной цепью разделить память между разными и nvidia докер контейнерами в произвольный пропорцию что позволяет вам симулировать например запуск нескольких маркеров на на одной конкретной видеокарте спасибо мне больше не запрос добрый день меня зовут сергей спасибо большое за доклад такой вопрос вы сказали здесь у вас есть полный набор данных то же время показали слайд где есть real-time поток данных я правильно понимаю что контейнеры можно подключить как к одному источнику так и к другому да на самом деле если у вас есть история с real-time потоком данных это симулируется на вот этом этапе то есть у вас есть какие-то исторические данные в на них производить этап какого-то предварительного обучения но from в любой и живой системе у вас так будет вас будут данные загадкам вы обучаетесь в реальном времени и вот на втором этапе когда мы производим скоринг можно производить до обучения потому что вы пример вы построили построили предсказание на завтра посчитали по этим предсказанием на завтра score получили правильные ответы для этих предсказаний на завтра потому что у вас в реальном времени наступил там следующий момент времени 6 лет шаг по вашей временной скажи времен шкале дернули метод в контейнере который дал обучает модель опять построили предсказание дальше и так далее все это происходит вот в этом цикле и второй вопрос как раз мы взяли предсказали какие-то данные потом у нас идет поток реальных событий но то есть фактических значений если у вас какой-то функционал которая автоматом берет строит графики ну например попаданий нет нету то есть по большей части нужно будет как-то самим реализовывать что мы тоже ему этого нету мы действительно очень простой фон самоцвет вы подключаете contender борт одной строчкой все работают на самом деле это не хочется делать в open source версии просто потому что как раз требования по оценке метрик качества у всех очень разные потому что они завязаны на ваши бизнес метрики обычно и здесь мне сложно сделать какую-то универсальную схему который всем угодит цикл стрим с тренировки предсказанием он реально всех одинаковый особенно задач вроде компьютерного зрения cycles оценка и очень сильно разные у всех а когда вы хотите выпустить этого палисад подумываем тем того чтобы сделать это к новому году предварительно на хочет собрать по сути фидбэк людей которые потенциально могли бы таким воспользоваться и понять то что сейчас есть она укладывается в например ваши лично требования и пожелания или нет если поймем что к новым годом и собираем что-то достачно интересной для комьюнити что мы хотим это улучшить спасибо добрый день дмитрий зовут скажите вы говорили что модели готовятся в ну неких шаблонах до которое вы даете для ну да ты сантис там насколько они совместимы с ну грубо говоря нам юпитер ноутбуками в котором все пользуются и что происходит если онa 25 до первый вопрос насколько это совместимо с юпитер ноутбуками это совместим очень криво но справедливости ради самих и петер ноутбуки с каким-то production кодом который нужно запускать формате и 5 тоже очень совместима никак вот поэтому вы можете там если вы участник вы можете на вот этом этапе когда вы получили культа долю данных там поиграться поделать юпитер ноутбуках потом вам все равно так же как в реальном мире нужно перенести какой-то код вот то есть ситуация если вдруг платформа недоступна то я имею возможность только там в своем локальном юпитер ноутбуки что-то по отлаживать и ну потом мне это все придется руками копировать в ваши шаблоны и отправлять решение я могу да спасибо такой вопрос если говорить решение внутри компании какие минимальные требования там по железу для какой-нибудь там стандартной никаких требований оппонент смотрите никаких техника железных требований по железу они идут исключительно из-за они требований по железо формулируются исключительно исходя из ваших задач и вы решаете если вы решаете задачи там не знаю упаковки копать и мелкой модельки на мобилу то это может быть и требование по железу формат самых дешевых инстанс amazon а чтоб хоть как-то симулировать процессор мобилу если вы гоняете trabant и но вам нужен спорт кластер но это никак не зависит собственной с тем процесс с этой с нашей структуры для менеджмента собственно самого процесс решения задачи то есть она железо никак не завязано хорошо если есть спор кластеры ну там до 100 задача там району терабайт это решение можно использовать в таких условиях технически можно с парком в интегрируйте счас парком напрямую пока нет то есть если у вас на данном этапе если вам нужно сам процесс исполнения модели размазать паспорт кластеру нет но если у вас есть много машин и у вас один процесс исполнения модели влезает на одну машину тогда для это как бы основная функциональность вы разрушаете или решения на производим числе машинка изображение кластерное решение именно так чтобы это легко было масштабе плотный масштабируемым размером кластера вас есть какие работы или желания мамочка жесткий а именно в сторону кластерного решения там spark кластер у вас есть какие то там наработки или журнала нету дайте потому что там ставить условным гарри машина это не очень весело желание на самом деле на данный момент времени нет почему вообще глобальной миссии этого чем мы занимаемся это строить инфраструктуру не для энтерпрайза вов для того чтобы попасть в бум стартапов мелких компаний которые делают что-то с машинным обучением у них обычно задачи про спорт кастера нет поэтому на данный момент мы вот не лезем там где нет больше ну и там все занято спасибо еще вопросы если нет то докладчик сейчас выберет самый лучший вопрос и мы вручим книжечку давайте вопрос про реальные решения и про сам первый вопрос сам слитками благодарность докладчику от конференции на очень короткий дисклеймер сделаю если кто то хочет а просто поболтать про машинное обучение компьютерное зрение самое главное про разметку данных для машину обучение подходить пишите в telegram по телефону с большим удовольствием"
}