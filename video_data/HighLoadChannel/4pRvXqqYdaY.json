{
  "video_id": "4pRvXqqYdaY",
  "channel": "HighLoadChannel",
  "title": "WAMP[-proto] как основа композитных SOA-приложений / Константин Буркалев (РКСС)",
  "views": 700,
  "duration": 2798,
  "published": "2018-08-16T04:08:59-07:00",
  "text": "всем привет ну как сказал саша еще раз повтори зовут меня константин сегодня вам хочу рассказать про такой протокол вам ну и несколько его реализации в том числе и на лом написанных но ему пару слов про себя занимаясь войти очень дорогой недавно возможно кто-то знает меня как автора ведущего подкастов гости касты ради джесс ну и последний лет буду 4-я в общем как так участвую разработки самого протокола ну и написал несколько его реализации в начале давайте наверное такой план такого нас обычно про что будет речь вначале какой-то пример системы где его можно применять потом расскажу что это за протокол как он устроен что он из себя представляет какие в нем есть такие интересные плюшки где его можно какие-то другие сферы применения при реальные проекты и расскажу про реализацию собственно его клиент и сервер она ло но вначале давайте рассмотрим такую задачку есть у нас допустим система умного дома интернет of tanks сидела что есть весь ковент комната в ней есть датчик температуры весь кондиционер и вполне себе нормально задачка включать кондиционер когда вы охладить ну конечно все кондиционеры так или иначе имеют функцию автоматической регулирование температуры но предположим что для экономии электроэнергии мы хотим включать вот так периодически хода достигает как критическое значение температуры тоже самое с ванной датчик влажности вытяжка ну всегда гонять и не интересно да вполне себе нравится включать ее как по превышению и есть собственно пользователи системы там ваши домашние домочадцы которые хотят этим как-то управлять рулить и так далее но и собственно есть наша система вот посмотри какие 10 задачки как раз как что из этого все можно применить на вампи построить вначале собственно происходит датчик температуры шлет превышения до система оповещает после этого пользователей там блокирует после чего дает команду на управление включении кондиционера он не себя нормально прям такая после чего температура снижается до и уже опять таки происходит оповещений система автоматически выключает кондиционер примерно то же самое примерно тоже самое с датчиком влажности и вытяжкой да то есть влажность повысилась взяли оповестили автоматически отправили команды на включение вытяжки вот она там отработал температура понизилась и опять-таки придумал и все это дело дальше здесь получил уже прослеживается publish субскрайб за можно применить как вариант ну элписе тоже напрашивается тоже управление команд все же это нечто такое больше похоже на команды ниже как какие-то публикации сообщений предположим дальше что у нас есть еще ну админом сложно сказать ну допустим это там не знаю вы как сам папа владелец системы которому надо производить какие-то настроечные действия да ну наверное там слоги детишкам там не надо давать возможности настраивать порогу и значение еще что-то да а вы хотите просто настроить систему fat с на здесь опять-таки в настройках пороговых значений вполне себе чем вам не рпц с какими-то возможностями плюс вот тут уже прослеживается момент что наверное не очень хочется смешивать в одну кучу и пользователей админ пользовательские админские какие-то задачи на хочется их разнести в разном скажем так namespace am в зонам скажем так ответственность чтобы не смешивать это уже тоже есть вампир так и для затравочки плюс предположим что нас есть долго играющий такая операция как поиск устройств но даже там в сети класса c там если епишин еда взять и проанализировать это время может там тайм-аут еще что-то да какое то время и хочется принц и получать какой-то прогресс сколько там устройству нашли когда вы первый раз допустим из коробки разворачивать вашу систему вот это такая долго играющий операции собственно в лампе уже на уровне протокола есть возможность получения прогресс прогресса по выполнению каких-то rp сишек вот так что же такое вам в двух словах это протокол предназначен для такой можно сказать практически в коммуникации практически режиме реального времени изначально он разрабатывался в контексте websocket of но на самом деле потом трансформировался он назывался даже веб-сайт applications messenger протокол но потом преобразовался все же web applications брата коп на муж принципе протокол могут использоваться рубили любые не только websocket и но и нативные даже там феникс pipe и так далее об этом тоже чуть позже расскажу из коробки предоставляет два механизма прямо в рамках одного протокола этой париж субскрайб и рпц вот он двунаправленный упорядоченный то есть гарантируется порядок сообщение получения вот ну для общения еще важно сказать что требуется вам про утро то есть как бы пир toupper не между клиентом и клиентам и все же требуется не кирова то вот почему же собственно я выбрал его и так как бы он ни чем не привлёк ну во первых это открытая спецификация она лежит в общем-то гимны гитхабе пожалуйста рыбачек может прийти там посмотреть почитать он очень понятно подробно написано плюс как бы всегда можно предложить какие-то новые идеи вот протокола достаточно уже зрелый ему весь не соврать где-то лет 5 наверное уже вторая версия поэтому уже все какие-то детские болячки перверсии уже были скорины искренен и и остался вполне понятно и уже понимание как это должно работать собственно поэтому не надо строить какие-то свои велосипеды в да все мы любим как хочу давайте раскроем там брест прикручивать еще что-нибудь но вполне понятно но зачем когда есть готовый протокол плюс если вы дальнейшем планируете открытие 5 допустим для своей системы до на вне то не надо там какие-то городить что-то изобретать вполне себе можно взять уже спецификации вот предоставить ее просто вовне вампиров think сообщение это вещь ну скажем так под нее при развивается то что вызывающая сторона допустим там инициатор вызывая писи совсем не знает ничего про то где расположен ресурс который предоставляет арпи сид соответственно вы как бы унифицировать и тем самым вы роутинг и скрываете touring конечной пой на вот кроссплатформенность есть реализации ну нами на всех более-менее отыскать известных языках а там не знаю java скрипт php и на си плюс плюс и по 2 вт и даже в react на эти виды работает в общем то все что угодно есть вот но для сравнения маленькие альтернативой в общем то есть большая табличка действует маленький кусочек показан на сайте протокола да собственно вампи есть все и попса по рпц роутинг он нативный для веба на любом языке и и открытый стандарт поэтому а был выбран в двух словах просто чтобы как вы немножко картинка такая для понимания как она при устроено все сообщения в лампе и тасс реализуются определенным образом это представляет из себя массивов к в которых стоят на каждый атом в элемент массива имеет определенные значения да ну например первые первое целочисленные значения да это всегда идентификатор тип сообщения вот просто для примера вот здесь два направляет собственно отправить сообщение там клиента с сервером зелененькие это сообщение от клиента к серверу и согласно беленькие серенькие то ответы для затравки давайте рассмотрим как вообще протокол устроен внутри что он из себя представляет вот такая картинка со мною собственно наглядное и спецификации нашей взято здесь в общем показаны все давайте это красим разберем последовательным что здесь есть 1 есть клиент но клиент собственно повторюсь от ники программных компонент который подключается к утру он собственно может потреблять ресурсы либо предоставлять то есть публиковать там сообщение в какие-то подписки канала наоборот подписываться на получение вызывать rp сижки наоборот предоставлять rp сижки 8 все что угодно а вторая часть это роутер да вот собственно этот центральный серых которому происходит подключение всех клиентов так или иначе и который занимается маршрутизация сообщений между всеми клиентами сам роутер ничего не предоставляет хотя есть реализация когда клиент может просто находиться в рамках одного программного модуля das letzte роутером чтобы весь очень быстро давать данные какие-то вот все и клиенты роутер в рамках протокола называются узлами и все узлы должны обладать никакими ролями есть несколько как 4 клиентских ролей 2 роутерах но собственно они принципе вы даже по названию понятно о чем а нет ролях касательно подписки публикации сообщений и потребление касательно рпц вот сессии клиент при установке собственно чтобы сколь клиент открывает сессию подключаясь к вам процессе необходимо для того чтобы во первых идентифицировать клиента и вообще анонсировать какие возможности есть у каждой из сторон чтоб понимать как что можно вызывать там что нельзя это все опять кино уровне протокола заложено подключение происходит к такой важной вещи как рио но breeam домен можно назвать как бы некий namespace до единое такое адресное пространство в котором собственно говоря концентрируется все подписки и рпц и все-все-все единый реестр ресурсов вот и сессия всегда привязана к одному конкретному рифму забегать вперед скажу что на одном роутере может быть много риумов то есть совсем не обязательно что это будет один какой-то может быть у вас один роутер на нем томате пользуйтесь кирилл admin admin с кириллом еще какие-то и так далее даже может быть несколько положений обслуживать один роутер от любая сессия бежит поверх транспорта транспортом еще раз повторюсь как я уже говорил выше может быть и websocket эти типичные соединения unix pipe и даже есть fall back для на лонг пол как некий такой альтернативу скажем так fall back для можешь каких-то случаев в качестве транспорта применяться вот и в собственно поверх этой сессии в рамках транспорта бегают сообщение все сообщения си реализуются 5s реализатором может быть сейчас в спецификации заложены 2 формально это джейсон месяц pack но в общем то по пятке спецификации написано так что и не спокойно расширяемые даже сейчас современный тогда crossbar роутер поддерживает еще сих пор что-то еще короче много стерилизаторов главное чтобы обе стороны понимали тут опять таки можно сказать что например один клиент может подключиться используешь все реализации джейсон ну например веб-клиента о какой-то в рамках там около холста сервис который предоставляет терпи терпи можете использовать помните мы вместе шпага сериализации чтобы рядышком быстро и отдавать ну еще раз это все понятие просто перечислены пойдем дальше какие есть фича значит в рамках самого протоколу попса подписи в общем по большому счету нет никого не удивишь мне понятны два таких паттерна но в анти для них есть разные интересные плюшки во первых есть такое понимание как профиля это базовый профиль и тут собственно банальный там возможность публикации возможность вызова рпц в самом простейшем их виде и есть еще 12 profile там есть разные интересные фишки например авторизация во первых там cookies ticket бей z я не знаю там по ключам какая угодно есть такие штуки как вот я уже говорю упомянутом выше в примере например прогрессе в к врезался когда вы один раз вызываете rp сижку а дальше получаете и ответы о прогрессе да есть тайм-аут и отмены есть например такая штука как уровни доверия это когда роутер вам про торсом на основе некоторых атрибутов критериев алгоритмов выставляет уровень доверия вызываемого rp сижки и передают информацию и тем самым вы можете при когда ресурс который регистрируйтесь и до проверять уровень доверие interni выполнять случае если он там ниже какого-то ну кто-то выполнил сне там пользователь ему нельзя на должен админский доступ отрасли вас краски для этого но и много других там подписка по паттернам история шары да registration там митапе reflection и много всего не буду перечислять кому интересно потом можно могу рассказать подробней давайте двух словах как происходит установка сессии 10 собственно боль наглядно показывает клиент у нас есть есть роутер в нем rifle вот собственно шлют сообщения сверху как раз таки показано что примерно сообщение себя представляет да в таком читаемом виде вот ну этот самый простой там холлоу говорит что у нее там ничего никаких расширенных возможностей нету сервер сюда отвечает волком говорит о том какие роли он поддерживает что в нем есть либо может ответить отказом по каким-либо причинам например нужна авторизация да вполне себе завершение корректно вершин сессии может быть инициирован как клиентам так и сервером в этом как бы не сюда кого нет идем дальше как происходит publish субскрайб ну опять-таки у нас есть 3 2 до 3 роли там publishers of скрайбер брокер принципе паришься skype же может быть один и тот же компонент ну наверно это странно самому себя уведомлять а вот сам сначала подписаться на некое с некой топик да ну например сенсоры венцы события с датчиков мы хотим получать вот мы на него подписываемся достается получаем что да мы подписались после этого ну либо ошибка например из там нет нет авторизации либо ещё каким-либо причинам дальше кто-то публикует сообщение например сервис который собственно мониторе состояния датчиков и да и мы все клиенты в его получают виде сообщения с каким как ростки полезной нагрузкой опять таки она может быть там в любом виде как массив html так далее ну и дальше когда нам это надоело мы в конце концов можем перестать это делать подписаться и больше не получать ремонт процедуру колы устроен примерно похожим образом до вначале надо зарегистрировать сервис который предоставляет только сижку регистрирует ее под неким именем нужно при этом de ses fan control service там управления вентилятором стресс не будет один параметр стоишь там true force условное включить выключить да вот после чего как бы вызывающая сторона по 5 может какой другой сервис которой там отвечает за логику может вполне себе вызвать эту храним q дал передайте true как раз тот единственный параметр что давай включив на вентилятор вот и после чего получить ответ потому что до успешно включен либо ошибку это опять-таки все авто на учет что-то случилось что-то не найден вот примерно так ну и дальше мы можем опять таки перестать предоставлять рпц сразу скажу что в рамках dance профайла есть возможность на при регист рируют нескольким узлам одну и ту же rp сижку ну например там не знаю get system status когда вас узлы в кластере но да да и вы хотите сразу со всех собрать информации в каком они там живы ниже вы тогда они все регистрируют под одним рпц названия охранники и дальше просто вы вызываете а уже именно сам протокол сам вам про утар собирается всех нот все результаты и пакует вам присылает конечно агрегированный ответ то есть как бы для конечного пользователя то есть клиентского кода все очень просто это один вызов одной хранить но и собственно где можно применять вам давайте рассмотрим в контексте со всяких приложений сервис аренды chicksey что для этого нужно что для точнее для этого есть в лампе во-первых нём из коробки есть распыленной архитектуру вас узлы развязан ее и вы можете их разносить в сети как угодно блока хвосте там pipe и сеть пик как угодно слабая связан с компонент но она как прозрачно вытекает из первого пункта компоненты ничего не знают про другие не знают все что нужно им знать только про как подключиться к роутеру простой понятный интерфейс но собственно мне кажется вот примерах там рпц и попса было видно чтобы далеки так понятно и логичный поток сообщений все это написано повторюсь еще раз в спецификации унифицированы можете зация опять-таки это вот про то что клиенты которые предоставляют потребляет ресурсы ничего не знают про тех кто там предоставляет рпц или по опубликовал сообщение да вы просто подписывайтесь либо вызываете дальше задача вам про утро уже сможешь позировать это дело и куда-то доставить вам результат вне зависимости от языков программирования но опять таки мне кажется для всяких больших систем где много компонент написанных на разных языках разные задачи и это важно вот и перес пользуемся компонентов опять и потому что они маленькие можно там какой сервис логирования применить много где что-то еще собственно поэтому вполне себе как мне кажется это блики неплохое решение но в качестве есть б например можно рассмотреть вариант используя вам в качестве надписи резьба здесь собственно у вас есть до привычный там концу мир и сервис провайдера и вам правда в повести может заниматься доставкой сообщений а здесь наверно стоит сказать что во первых вам про утром может быть тоже не на одном сервере 1с обязательно то есть и масштабирование вполне себе можно поднять один вам про utter на нескольких серверах он будет как некий единый такой быть сервис уступать обслуживать много ритмов и тем самым заниматься доставка сообщение единственное чего не хватает вампи для полноценного есть б это трансформации данных да потому что есть б собственно одна из ее основных задач и трансформировать данные именно шины занимаясь шина занимается трансформации доставкой уже конечным сервисом данных в удобном удобно при читаем увидеть для них но здесь такого нет ну как мне кажется тоже не сильно проблема у вас здесь все таблетки картинка большая много всего так какой-то абстрактный пример но важно скорее еще раз подчеркнуть что один вамп роутера он может быть дома можно почитать что это единая точка отказа игры но его также можно масштабировать до замечательной серверах в низких рефов и тем самым добиться какой-то отказоустойчивость где применяются вам ну во первых это вот большие всякие системы где много разных сервисов они там распределены занимаются разными задачами на разных языках вполне себе хорошие альтернативы всяким каким-то там толпа максимальным и прочим штукам всякие системы умный дома интернет вещей вот как пример как раз таки мне кажется это краски одна из главных таких сфер для которой вам по изначальной разрабатывался да и где он далеки много тем применяется долго выполняющий процессы здесь опять удон сколько протокол самый синхронный то есть вы выполнили в писечку и дальше спокойно ждете пока она вам скажет что где ответы нет никакого делать long пол и вот этой вот прочих штук привычных всем но в легкой форме современный как альтернатива всяким старом xml бы ест протоколом мне кажется уже назад xml уходить потихонечку но и всякие сетевые игры тоже вполне себе может пошаговый какие-то этом real-time вполне себе быть есть некоторое количество реальных проектов которые используют вампу себя это там системы визуализации данных обработки больших данных это и какие-то умные дома там даже есть какие-то проекты вот и собственно у себя на работе тоже его используем только я занимаюсь разработкой систем безопасности и мы у себя используем вам для управления серверами то есть у нас есть клиент в данный сишарпа сейчас тяжелое то есть сервер мы серверов как бы для конечно после сервера такая черная коробку то есть мы там не ssh ничего не даем как такой готовые программно-аппаратный комплекс выставляем поэтому но какие-то действия по настройке производить надо да там например там установить сеть не знаю время вот собственно у нас есть сервис на сервер и который крутится они регистрируют и фишки ну вот например там незаметная турок свет на торпедо и собственно говоря клиент просто включается комп роутер авторизуется и выполняет эти храним получает ответ ну или есть там еще куча сервисов здесь для примера просто 2 а вот шаман такой это для стройки там half монитор условно говоря которой там публикуют события а там изменения статусов чего-то на самом деле их больше у нас вот примерно так это работает ну и дальше давайте расскажу про пару тяжело давайте расскажу про пару реализации собственность клиент lluvia написанный на lua да и есть виола это роутер на на луну про луи буквально пару слов он такой простенький работает там хоть отложите на базе либо сейчас соответственно поддерживает и джейсон там msg пак ряд фичи поддержит там автоматическое переподключение если допустим сеть нам отвалился еще что-то имеет там перри подписываться как-то ну в идеале есть много чище в нем стоит сделать вот просто пример как это примерно выглядит но собственно на самом деле клиенты на всех языках какой бы вы не взяли реализации выглядит примерно то же самое то есть есть два обязательных таких параметра в любом при любом подключение к вам про утро это собственность куда подключаться да понятное дело ярилу от очень важно это rifle ну а дальше все можно публиковать подписываться там что-то вызывать вполне себе там есть обработчики какие то можно это использовать луи собственно под капотом использует websocket и рэпе джейсон место шпак но тут были некоторые особенности при реализации про них я расскажу в контексте виолы этот суп 100 роутер на lua он работает на базе индекс модуля вот как раз таки предыдущий на кончик тоже рассказывал поминал по 200 да я тоже его общем активно используя и люблю значит под капотом используется еще родис для хранения сессии информации всего подержит сейчас и джейсона месяц пак ряд fitch из-за 12-м профайла как она еще раз недостаток технология что здесь есть вот как вылет конфликт на самом деле того чтобы запустить виола все что нужно вот по сути прописать но три строчки даже да вот проверка клочья клиента борт для проверки что клиент завершился соединение неожиданно чтобы обработчики вызвались едва буквально обработчика заголовков и контента в яндексе в fundraising смотр да есть несколько фаз обработки запросов когда и низ кстати скажем так да на которых возможно применение ло там стадия инициализации где происходит там вентиляции виртуальной машины вот и дальше то мисс кстати там литры заголовки контент и так далее но работает при настоящем образом собственно вы нет боевого происходит инициализация там подключение кризиса каких-то конфига и все такого дальше в haters байлово происходит обработка заголовка потому что для websocket а для клиентской если говорить the power fc есть такое понятие в птица протокол да и вам по 2 джейсон тоже официально зарегистрированный со протокол под протокол вот и собственно понимание происходит выбор стерилизатор тоже можно указать несколько вариантов внутри клеток сказать что ехал я могу я поддерживаю джейсон и мозга пока клиент и сервер выбрать какой то какой больше нравится ну и собственно контент бэйлу основная в рабочих где инициализируется рецепт сервер и собственно происходит обмен данными с клиентом вы попутно там складывать все это делал край диску да то какие были интересные особенности в реализации про который хотелось рассказать но возможно кто-то уже знает упоминался тоже си джейсон в общем-то для сири зации джейсон первое что ты хоть высится в гугле и вообще на ли такая библиотека c джейсен да но в ней есть несколько интересных особенностей например в ней нельзя указать способ реализации пустых таблиц а в рамках вам протокола важно в некоторых пара в случаях именно стерилизовать пускай таблицы как массива в них как и штаб в лоу как мы знаем там все тайбэе в общем не всегда есть возможность тогда попалась мне вещь назову рестилить собственный фифа и блеск над тем же самым си джейсоном вот авторов окон reste и в ней можно все это серьезно вы вать указывать после таблица однако в ней союз выяснилось другая проблема что он не имеет работы большими числами но я думаю все до которых пишет nalu при большие числа сразу заулыбались тут идея в том что проблема в том что в рамках протокола именно сама вода вам винчи катары запросов они могут быть числа 2 там до 2 в 54 произвольным образом выбирается да каждый раз поэтому необходима поддержка вот поэтому ну и слава богу на помощь пришел в рэпе джейсон которые все это умеет и пока что успешно используется про хранилище ну по идее в роутер у такого скажем так в базовом виде не надо ничего где-то хранить пирсе стен до с оговорками и в принципе можно спокойно попробую сдаюсь глобальной перемены просто хранить как кашей и не и не париться но с этим есть несколько проблем во первых они создаются глобальные переменные на каждый запрос на каждый рекой сэндлер дата каждое соединение не будут создаваться заново также поскольку в джинсе запрос обрабатываются ну собственно вас может быть там несколько маркеров до 1 worker может обработать параллельно несколько запросов поэтому как чтобы с глобальными переменами но никто никогда не предскажет поэтому так делать не надо второй вариант который приходит на ум в общем то ну давайте есть и недбайло в общем то место где можно один раз проинициализировать все переменные и дальше спокойно использовать но вариант кажется вполне себе ничего если забыть про то что дочитать можно как бы всех worker of но если у вас worker в больше одного то попытка изменения собственного переменных в модуле а не приведет спасибо механизм копи он райт да приведёт к копирование каждый worker будет иметь свою копию так сказать и значения переменных а это как бы не очень хорошо есть еще в яндексе не в яндексе а в ла и джинкс модуля такая вещь как словари шире dict в принципе они краски сдаются на уровне конфига и можно спокойно все доступно спокойно можно них писать но проблема с ними в том что их размер этих жертв аварий задается один раз на этапе конфига да и нельзя потом использовать не как изменить в runtime это довольно неудобно как можно заранее предсказать сколько вас там будет не зная сесили еще чего-то вот поэтому собственно сами авторы lan jack смотра говорят ребята ну чё вам надо использовать внешних хранилищ вполне себе отличный вариант у них есть в пудре есть и уже там готовы адаптеры для редиса для под колеса memcache и мы скрыли чего угодно ну поэтому был выбран рейс как такой вариант вполне себе кстати отсюда вырастает еще одна плюшка то что можно красном масштабировать да вы можете поднять несколько инстанций of engine кса ray диск поставить кластер с редисом и тем самым собственно получить единый такой роутер nobo из нескольких серверов вот еще маленькая особенность про такая вещь как логкат кэш такая директива в яндекс модули которая ну из названа может принимать два значения включён и выключен то в случае со выключена банке должна разрабатывать она перечитывает каждый модуль заново в каждом запросе рик варят все но например есть такая тонкость которая не сразу может быть выяснится что даже модули которые загружаются вы недбайло и должны выполняться один раз на этапе загрузки джинкс а они могут выполняться в каждом река есть то есть 8 тикают очистку то имейте ввиду что даже в каждом вопросе будет происходить заново вот мы собственно лопаткой шон это продаж на директива она по умолчанию включена кэширует все модули поэтому они рекламе с один раз да как бы дальше работать все очень быстро но вот отлаживается в этом случае довольно таки проблематично да потому что приходится делать как минимум джинкс рилот каждый раз такой маленькая особенность то еще пара слов про публикацию в собственно публиковал виола там в лоракс и vpn здесь все наверное тоже многим может быть как то кто публиковал сталкивался знают что в лоракс есть одна какая честь зависимости danone пример но нет другой но конечно же там нету в зависимости связанных с индексом да то есть каких-то лестерских вещей которые завязаны на там джинкс capitalist websocket лера редис который работает на базе джек ских сокетов вот но зато есть вполне понятны и другие какие-то не зависящий скажем так библиотеки уступим это опен-рейз теперь менеджер этот товарищ юджин в общем то решил тоже смутить свою систему больше слов ских экосистема то нам не хватает вот и значит сделал панели step менеджеры теперь туда пытается пушить все что связано с у подрасти вот ну там собственно все с точностью наоборот как несложно догадаться да вот я даже писали это как фред просто что там есть христос совсем нет другого есть что есть и чмокну просто она как бы такая криптографической либо не принципе ничего не зависит вот так забавно что еще где почитать есть основной сайт правом вам про то там есть и ссылка на спецификацию есть сравнении со всеми другими технологиями есть какие то там новости последний ссылки на какие-то презентации доклада есть mailing list где наша очень такое дружелюбное комьюнити туда может спокойно прийти задать какие-то вопросы вот ну и дальше по рассылкам какие-то библиотеки в том числе три моих реализации виола глуби лампе и пара даже docker engine об этом скажу чуть позже что хочет сказать в заключение все же я призываю вас все же посмотреть на вам это простой открытый протоколу почем понятный и удобный но в тем не менее предоставляет и вполне себе интересные скажем так технологии кита для в где можно применять каких-то ваших проектов то есть это rp сипап сообщу в одном транспорте вот повторюсь что может быть любой транспорт цивилизация тоже какая угодно месяц пак пожалуйста си бортом джейсон и так далее можно строить разные сложные системы да они будут слабо связанными компонентами много языков поддерживается есть несколько активных есть даже какие-то экзотические вещи там на и знаю эрланге на на что не чего-нибудь такого на хаскеле даже кажется есть но это скорее больше выходе мических целях реально таких были мини-фильм production рейде это питон активно потому что собственно сами авторы протоколу активную запитан вот и собственных низкой реализации на питоне есть go java-script ну в общем такой есть как мне кажется это такое интересно эффективное решение до может быть прямо сейчас вот в вашем текущем проекте у вас уже как бы все сложилось это и какая-то архитектура но как мне кажется можно взять на вооружение это протокола где-то в дальнейших проектах вполне себе применить вот как минимум вот где-то там для мои идти направления это вообще мне кажется супер и лучше всяких им крутить и прочих вещей но мое личное мнение поэтому призываю вас попробовать если вы уже где-то используйте яндекс или опен-рейз это виола поставить очень просто если вы используете докер то спасибо андрею бокалы сделал докер-образ свел ее тоже прямо пожалуйста одной команды либо есть от авторов протокола crossbar роутер тоже где можно прям поставите союзные клиенты на любой вкус и цвет язык и так далее на этом у меня все спасибо надеюсь было интересно и ваши вопросы спасибо алло реализация the production иди конечно мы же себя его используем как она может быть и production но пожалуйста спасибо за доклад интересно и у меня пару la мирских вопросов правом и прп сейчас типа вам славой давай давай по рпц вот ты там в примерах внедрений показывал что кто-то даже пытался api дело да да да вот там 1 и сервер даже какой-то и да да да вот допустим я хочу сделать описку есть ли какие-то вещи связанные с каширования типа как в листе да там я могу get запиши ровать и там данные отдавайте не каждый раз через сервер или здесь вот уклон в сторону рпц и там все сложнее именно вызов процедуры нет здесь из коробки прямо про то в протоколе кэширование никакой не предусмотрено то есть как бы иди сильно ты вызываешь рпц и роутер и в любом случае отправит информация о вызове в водку лет собственно тот кто зарегистрирован писичку ну вопрос как он уже там ответит или тут на его стране applications do a british ней сайта хорошо так дальше следующая часть ты вот сказал про интересную штуку про прогресс прогреть я вырезал да да да вот как это технически выглядит я должен своем давай расскажу вам расскажу давно что это выглядит еще уж коли часть ну собственно модуль который предоставляет рпц регистрирует ее и дальше в сергей параметров атрибутов и говорит о том что он умеет понимать обрабатывать progressive house дальше собственно говоря но процессе там хан шейка собственного обмениваться клиенты до фичами значит калиф конечном итоге когда он вызывает erp сиську он тоже умеет понимать что провели хочет получать точнее прогресс в к врезался он вызывает храним q и говорит ей среди прочих атрибутов что я хочу получать прогрессе фолз ответы после чего происходит call один вызов раскол вызов да вот здесь происходит инвокер шин первый раз build your head собстна ответ вот ярдов может быть много раз происходит youth в котором содержится потом форматом что это еще не последний не конечный результат а это где-то серединка плюс какое угодно дополнить информацию там не знает 10 процентов мы выполнили что эта вещь приобретает клиент в виде резался после чего еще один лт опять ризал все с тем же дэльфи котором запроса вызова соответственно да поэтому вот и лт и резалт может быть много и в конечный раз you've приходит с атрибутом что все это файл true условно говоря и клиент понимаешь что все это был последний ответ больше нечего ждать не надо и при этом я могу вот в этих промежуточных ярдах результата не возвращать оттока статус еще что тебе нравится как угодно хорошо так и последняя часть уже по попса бу а вот ты говорил о том что очень гибкая штука хорошо реализована возможность подмены стерилизаторов транспорта и так далее а вот по брокеру чуть чуть не понятно то есть вот что там внутри под брокерам находится это какая-то коробочный корой коробочный брокер какой-то коробочная очередь там я не знаю или я могу тоже использовать свои компоненты для того чтобы реализовывать брокер там-там-там актив им куков я понял они и час персистенции сью ну со всеми вот этими с определенностью с persistent ностью могу ли я считать что это надежный брокер я тебя понял насчет здесь отвечу вот что ну как скажем это будет реализовано должно быть реализовано под капотом безусловно в рамках протокола не описано да вы можете все что угодно в простейшем случае вот как здесь на примере собственно брокеру вообще ничего нигде persistent охранник не надо он просто пришел publish он увидел нашел всех подписчиков да в то на топе кой им отправил и забыл про это и все но в рамках 2 ст профайла протокола да есть много интересных плюшек в том числе попадаешь на в skype части одной из них например этой when the history которая позволяет хранить как раз таки persistent на хранить информацию о опубликованных сообщениях да в топике там можно настраивать за какой период и как ты хочешь хранить тем самым собственно клиент когда подключается он и при может вызвать храним q которая даст ему скажете что было за последние там два часа потому что это было где-то в оффлайне летом не знаю недоступен вот это тоже как в рамках один из профайла она заложена но этот это все равно какая-то реализация коробочная да то есть я не могу взять и оставить свой брокер нетнеможешь понятно ну хорошо все спасибо а почему не можешь то если протокол реализовал нет мыслей ты реализуешь сам полностью свой вам про utter то конечно можешь пожелать здоровья а если говорить о подсунуть как допустим там какой-нибудь существующей реализация там виолы ли там в crossbar свой механизм хранения то нет так вот из коробки нет а если я хочу поставить эту сумку или там кафку или еще что-то я должен реализовать некий bridge адаптер да да да чтобы реализовать интерфейс вам пушки для брокера да через воду да да да да да ну вот сейчас есть кстати говоря какие-то примеры этого или никто так не делает вообще я же если это понадобилось то это не про вам вообще знаешь из всех из всех роутеров которые я знаю нигде вроде бы под именно такого бриджа в какой-то of active and you ли там за рамки ничего такого нет то есть все до используют какие-то сторону не знаю по сгрыз даре дес и там memcache и так далее но именно чтобы под капотом транслировать это взираем киу вот и как бы по кроме я так не встречал такой задачи здравствуйте спасибо вам большое за доклада подкасты за ваши очень приятно скажите пожалуйста я правильно понимаю что брокер сам следит за сабскрайберами дело о чем я не родила к примеру программист я не отписался самую не страшно да ну примерно как брокер понимает что это не живой сабскрайберов что его надо из в очереди удалить ну сейчас обстоит тут это конечно лежит на плечах брокера понятное дело до на его реализации в случае там виолы собственная используем джинкс поэтому индекс умеет проверяйте жевали соединение соки собчак клайд connection аборт он вот эта штука директив к и собственно если это так если клиент помер он вызывает клубы который собственно не очистит всю инфу о сексе примерно так это устроено еще вопросы коллеги благодарю вас за доклад по всей видимости это было сказано просто я вот не уловил вы говорили про удаленный вызов процедур и говорили про асинхронность протяженности что вы вызвали его publish saab skype это понятно да примерно примерно то же самое просто вызывает терпи сижку говорить о какой код ваш клиентский вызвать когда получите результат а дальше ваш ваш код продолжает работать то есть вы не ждете пока какого-то ответа все или зация синхронного рпц ну да да да это передачи кубик или войти внутрь ну что то типа того у меня в моих ре зация и вообще всех которые я обычный табак прост передается то есть какой call back вызвать на с результатами возвращением вверх вернут ими и сэр писички все понял спасибо еще вопросы коллеги здравствуйте спасибо мне интересует вопрос кластеризации возможный предоставляется она в коробке если вот у меня брокеров очень много я понял смотрите кристаллизация отвечу вот значит провел на мою реализацию вам про утар я сказал что это принцип можно сделать потому что вы просто стоите много нот с индексами да они общаются с рычаг кластером из редиса ну такая вот то есть выше масштабировать в таком виде возможно если еще я знаю что crossbar это такой интерфейс тоже роутер на на питоне написанный он умеет сам соединяться между собой узлы ну то есть как бы один друг другу соединяется да и тем самым тоже шарить разделять данные о сессии ко всем пусть он тоже вы можете поднять несколько узлов серверов с круз барами и они как бы для вас как единое пространство собирать close to take из коробки про другие роутера не скажу но там на голод сейчас активно товарищ пишет и так как бы у него там большой интернет приложение но про про его масштабируем не скажу но пройти два вот такой вариант возможен еще вопросы коллеги спасибо большое за доклад у меня такой вопрос я так менее вам это именно сам протокол всякий crossbar виолы ты его реализации до реализации а если какие-то библиотеки фреймворке для того чтобы использовать этот протокол в своих проектах клиентские конечно есть клиентских крепких я не знаю что в 20 или 30 есть библиотека клиентских они все выглядят где-то методу пример кода дано на на луме но вода здесь кажется или дач но они то есть нога я точно игры ногой есть несколько на java скрипте несколько на джаве под android под там даже на скале есть ссс акторами такая модель к вот есть то есть на чем клиентов есть на чем угодно честно вот на любой вкус и на свифти есть я говорю даже ряд в ряд на этих окружении есть клиент собственно и используется один товарищ ведь что работает где-то ту часть код покажу то есть в том числе и для реализации брокера брокеров тоже говорю много брокеров поменьше на десяток где-то до но тем не менее тоже они есть сейчас где-то тут вон у брокера наверное есть как отдельные сервисы да продлятся кабельные как отдельные сервисы безусловно но в играх есть даже система где здесь будет код выглядит все примерно вот так ты слился и какой-то павлину подключение разные у всех разные плюшки тому кто то есть там автоматически реконнекта у кого то есть автоматически там вызов на всякие ошибки обработка это зависит от понятной уже реализации до их можно посмотреть они на сайте вот вам про торг есть implementation с раздел там прям 2 больших таблички со всеми клиентами на всех языках с перечислением возможности так базам виде и роутер это же там есть то есть а на чем угодно понятно спасибо большое да нет что еще вопросы коллеги вот вот ты забрался спасибо за доклад вопрос такой я тоже немножечко не уловил скорее всего прослушал то есть понятно что он жинка сумеет пинговать значит своим поинты которым он подключен но в pops up модели которые вы показывали что произойдет в том случае если у вас отвалится publisher что произойдет с сабскрайберами ничего если зайдёт то есть у вас подойти поближе и the sensor покататься пример люблю ай да да ну да да да можно так посмотреть то есть если у вас из систем умного дома отвалился сенсор тут в простейшем случае ничего не произойдет потому что подписчик ой точнее потребителями но подписчики ничего не знают о публикации другое дело что в рамках и 12 профайла в вампир есть такая возможность мета пей называется раздел который позволяет получать информацию о том что клиент отключился подключился и тем самым вы можете устать обработать но простейшем случае подписчик просто подписывается на топик да и он ведь не знает жив кто в него будет публиковать когда ему это как бы он просто получает и все а список топиков он берет это тоже есть в рамках 12 профайла есть возможность получить список но прощать шуча и как они обеда 12 profile на нет а не просто на уровне вашего плети шин как бы реализации там какие-то готовые либо еще по каким-то причинам но другим критерием скажем так алгоритма сформированы то есть просто взять их получить список их нет такого то там сенсор вас вопрос на уровень блики шиндо заложили вся что сенсор events это там топик в который публикует да то есть либо там не знать где то в базе допустим вы держите список всех топиков и их просто там банальном на старте приложения запрашивайте дальше используйте ну вот и мы в рандами взять и получить а что у вас там какие часы столбики кто чего это все только как вот в рамках митапе который позволяет как бы получать в runtime информацию спасибо you don't пфф а вот you don't you извините ещё вопросы коллеги последний вопрос не был задан видимо они даже нет я я еще задам тогда можно где ты все-таки эту штуку опубликовал вот там был такой волшебный слайде что там половины нет там половины не она и там и там есть до владеете нет нет у нее около рокс и все-таки опубликовал да а как ты с отсутствующими зависимости ну как в ридми написано что ребята едите ставьте компилить и и вот агрольда какие еще варианты это добрый да ну ладно этому это не самый страшный вида справиться да хорошо но если вопросов нет спасибо напоминаю что следующий трек prologo следующий доклад 1600 в рио-де-жанейро а 7 декабря у нас будет следующий метод но там ссылочка есть на флипчарте записывайтесь и приходите ура"
}