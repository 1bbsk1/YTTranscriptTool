{
  "video_id": "4A6I_Wh_nDA",
  "channel": "HighLoadChannel",
  "title": "Thorny path to the Large Scale Graph Processing / Алексей Зиновьев (Тамтэк)",
  "views": 82,
  "duration": 2364,
  "published": "2017-04-22T14:47:46-07:00",
  "text": "я из сибири из омска я люблю графы карты и перекрыть пересечении двух множеств карты графы дорожные графы но еще и java программист и так далее и так вот дальше можно следить за прогресс баром видела такие вот циферки 3 65 5 65 и так далее это число слайдов и так немножечко поговорим о big day the big data старых времен представляли собой следующее это могли быть например какие-то астрономические наблюдения люди например составляли звездные каталоги о положении подвижных или неподвижных звезд собирали погодные данные ну например 150 лет назад собирали данные о торговле торговых маршрутах например ост-индская компания трек алла все перемещения всех своих кораблей по земному шару таким образом получались вполне себе неплохие пыли гонщики а также конечно же данные о сражениях причем сразу со всех сторон которые участвовали сражение то есть обычно со стану об обычно мы могли получить о каждом сражении сразу несколько копий которые друг другом не сильно совпадают все это копилось копилось копилось на настоящих графов их больших данных в древности это в общем-то не было ну траектории неподвижных звезд мы считать не будет но теперь ситуация изменилась у нас сам характер больших данных очень сильно поменялся например самая большая шняга которая только есть на свете например веб граф эта штука в которой просто невероятное количество узлов и и ребер и ни в какой не фуджин конечно же не влазиет есть штука поменьше это например facebook friends граф или вообще такая мелочь которая казалось бы никому не нужно это так называемый джимейл email граф давайте назовем вершинками нас с вами которые шли друг друга уже мы или письма и поставим темпа вую дугу если письмо было в этом месяце правильно пример граф последних месячных сообщений это такая известном научном мире если кто-то вдруг пишет статьи в научные журналы и тацита и шин граф кто кого где процитировал люди собираются в кучки цитируют друг друга и вы не поверите этих данных так много что получается очень-очень-очень ландграф этой ситуации и например для любителей финансист это paypal transaction граф они конечно не очень часто любят приоткрывать завесу над ним на некоторых которых они давали кусочки если говорить о масштабе нужно же понимать сколько там вершин и рёбер вот во всех объектах которые перечислил я приведу в пример буквально несколько но самый большой не давать маленького начнем вот мы сейчас в москве вот у меня дорожный граф москвы в котором число вершин 250000 число ребер 460 тысяч в москве число ребер медленно но стабильно увеличивается на 100 килобайт в моем графе по крайней мере москвы а вот дорожный граф евросоюза он уже значительно больше там люди уже две тысячи лет строят дороги все римляне начали и там уже степени появляются то есть там пример 18 миллионов вершин 42 миллиона ребер в знаменитом графе его 2010 года и растет он немножко другими темпами но теперь перейдем к реально большим графом а не каким-то дорожным это же конечно facebook и веб граф и в одном из них уже полтора миллиарда вершин и почти полтора триллиона ребер и конечно размер данных которые ему соответствуют не позволяет влазить уже не то что на один сервер ну и на ваш домашний кластер или даже на стандартный средний класс стр вашей компании проблемы проблемы которые людям приходится решать на самом деле на графах проблема-то в чем все эти классные учебники которые выучили на всех этих ваших мехмат ах там были классные графу алгоритма ник хорошо работали на 10 вершинах и 12 ребрах или там даже на 30 вершинах и 40 ребрах к ней задачи коммивояжера ура мы ее улучшили все помнят эти истории но потом есть более важные вещи вебе например чего всё началось это например нужно посчитать важность вершин причем это необязательно страница вебе например ученые есть очень важные ученые есть менее важные ученые есть важные журнала научные есть менее важно пример научный вестник моем городе он не очень важно него никогда не ссылаются и сайнс а вот ну там или вестника мгу тоже не очень так себе а вот но обратно считал сами понимаете другая например вам нужно каким-то образом среди контента который друг с другом завязан определять популярные новости определять кратчайшие пути в любой из представленных вами метрик не обязательно в искривленном пространстве рассчитывать максимальный поток причем как в старых канализациях 910 года так и например в газопроводе сила сибири но там то простая цепочка вам нужно понимать как юзеры например в вашей сети собраны в подгруппы например там не знаю и существует какие-то микро сообщества которые интересны использовать не за например таргетироваться на них также вас могут интересовать как я уже сказал кита кластер самое интересное зачем-то нужна разработчикам вы вы вычислять максимальные клики какие-то треугольнички выделять вот кто на самом деле хоть раз пытался сжать граф понимает что вот это выделение маленьких треугольников это классная тема чтобы не хранить весь граф целиком ну и конечно вам иногда нужно просто построить тупо сервис рекомендаций например есть сопоставление какой-нибудь двудольный граф эти люди смотрели это добавим порекомендуем то двудольный граф может быть очень большим и связи в нем тоже важны я буквально парочку картина хотел привести в пример но очень мне нравится научная сфера в этом плане например вы хотите опубликовать статью в ком-то математическом журнале и как бы вы бы хотели чтоб на вас ссылалась максимум людей хотелось бы найти такую не знаю такое небольшое со множество вершин которые вроде бы попадают сразу в несколько журналов но вы сразу таргетируетесь на несколько научных коллективов они наверняка это прочитают сразу видно что апстрак и алгебра например лань рыл jabra они очень далеко друг от друга и но нужно очень аккуратно следить линейной алгебры и 100 очень любят за пологов и так далее вы никогда не сможете сразу на эти два журнала а вот например вероятности вычисления они как-то очень часто вместе встречаются они лежат у нас ближе и так далее вы легко можете запилить queen статейку и туда и туда здесь более общая картина для всей наверное науки не секрет что треть научную публикацию нас приняли медицине и биологии и поэтому вы видите а еще классно делают в нынче ранее сразу делают статью которой два тега медицины и биологии огонь биологическое молекулярные исследования и она сразу накручивает нам ранку 2 вершина к этой ситуации видно что например физика ну по что означает здесь ребра и забыл сказать значает что человек опубликовал свою статью медицине каким-то образом сослался на работу людей которые публиковали свои статьи например в молекулярной биологии и здесь мы видим что близко лежат уже целые группы наука друг другу например geass ненси физика вот например компьютер сайт почему-то очень далеко от geass нас лежит на потому что дело с эта география блин и так следующий небольшой переход вот есть такой знаменитый граф в нем ничто не предвещало беды мы смотрим на него и пытаемся понять есть ли в нем какая-нибудь особенная вершина в этом графе есть особенная вершина и это не тот парень который там сбоку пробегал и но вы все видите особенную вершину и правильно это не просто так это классный граф кто-то нарисовал все браки семейства медичи во флоренции и действительно если выделить вот эту вершинку которая такой звездочкой со всеми конектится это медичи который распространение свое влияние как раз в этой флоренции путем династических браков если бы кто-то в свое время вынес бы хотя бы одно поколение семейства медичи то например конь другое семейства могло установить власть над флоренция в общем иногда анализировать и выделять важные вершину по своему правильно это так называемая если все это обобщить это но до центра лети проблем вы выделяете вершины с какой-то степенью важности здесь может быть очень и очень много разных подходов приложений дофига еще отдельно хочется сказать вспомним такую вот вещь он рано перелистнул все вы наверно слышали теория шести рукопожатий эксперимент милгрэма сидел такой товарищ сша и начал рассылать письма счастья тогда раньше это не считалось спамом он послал 6 друзьям тебе послали еще 6 друзьям он смотрел как за сколько пересылок это все дойдет там из одного города в другой у него даже число хорошая получилась не представляю правда как у нас бы в почве на не дошло но там дошло и получилось что-то порядка шести с чем да весь вопрос действительно ли мир настолько узкий что мы через шесть рукопожатий кого-то знаем давайте возьмем реальные vip граф какой-нибудь и посмотрим что на нем не выбрав простите фейсбук граф facebook 2011 по моему году он развернул кластер о чик и вычислил как раз вот это вот среднее расстояние между двумя пользователями во всем графе facebook а ну за исключением выкину всех юзеров по узкой до полинезии потому что не все сильно ухудшали и вот там число средняя было 474 это очень хорош число и она намного меньше чем как в эксперименте милграма и можно сказать что facebook connecting people но twitter то connecting people больше почему как вы думаете о twitter число вот это среднее число меньше но все же приготовили ответ на самом деле дело в том что в твиттере вы фолловите друг друга в фейсбуке наверное надо подтверждать свою друг в одиннадцатом году так было по крайней мере поэтому в каком-то смысле в вам проще зафрендить обаму в твиттере чем в том же фейсбуке там он вам не ответит взаимностью в твиттере вам его взаимность вроде как и не нужно вот например я подписался давно им уотсон и ко мне сразу стал ближе весь мир когда я через apisto лазить по графу вот только для этого подписался а вот если взять msn messenger например ну кто пользовался в тот помнит как редко им люди пользуются в нем пример это среднее число даже больше чем в реальном мире но я вот тут взял период за 1 месяц не было доступно такое исследование если взять наверное годовой дам помните так как обьявляется почтовый граф наверное частот было бы поменьше но не слишком итак какие же у нас есть тулузы для этого всего все поняли что к данных много на одну машину не влазят их надо как-то параллельно обрабатывать и большой поклонник параллельной обработки но мапри deus не люблю в чем проблема большинство гробовых алгоритмов итерационных мапри дьюс как бы намекает нам что если вы хотите сделать что-то много-много раз пожалуйста сохранив все эти состояния на диск сделать началом а потом бредис потом что перед а суэца сохранится на диск представьте себе вашим графом нога итерационным алгоритме это только одна операция такая вот chain of мо придешь джобс вытянулась и начинает колбасить да конечно можно можно и искать ширину и так далее все но долговато и не очень эффективно проблема в чем что не все графы алгоритмы не для всех них ученые написали статьи и сказали вот из граф алгоритма вот тебе mapreduce модель скорее всего вам придется часть вещей перекрашивать самого поставок вы сделаете это вы никогда не опубликуете это нигде в открыто потому что это бы пусть это будет чужой болью например почему вообще не использовать мапри deus hadoop на примере по и django в чем прикол да это тоже итерационный алгоритм в котором важность сайта рассчитав зависит от важности сайтов которые ссылаются на него в принципе число итераций небольшое в этом операционном алгоритме но веб граф то у нас большой представляете вы всю эту махину будете сохранять каждый раз нет не очень там есть приближенная формула конечно для при рекурсивно стено google которому этот по jiang надо было считать он выбрался как только за пределы машины сергея брина они тут же выкатили как тоже через 12 лет статью о google прегель замечательная распределенная система для разработки больших графов и там такая модель была без при прогулке булки которые синхронизируются параллельно так нравится запоминаю так она вся из чего выглядит говорит давайте у нас в системе все будет двигаться большими супер шагами вот насчет начался первый супер шаг мы загрузили граф ну или его кусок разослали всем какие то сообщения произвели кита вычислениях вершинах выставили синхронизационные барьер в него все вершинки ударились проголосовали что мы да мы обменялись сообщениями честным и все вычислили и в некоторых вершинках вычисления при этом может уже остановиться фишка в чем каждый этот супер степ в каком-то смысле а может считаться блин как это по-русски a atomic юнит я не знаю даже как это коротко перевести во все знаете наверняка вот но совсем маленькая неделимая единица при этом вам не обязательно каждый раз после каждого супер степа сохранять это вам на диск хотите выставили свои поинты после которого все это сводится на диска хотите нет это определяется юзерам вот еще картинка которая это все иллюстрирует что получается вы можете создать ваш граф по кусочку раздать его на разные ноты там эти вычисления могут быть произведены потом они еще все пока мутировали все хорошо что чем обладает вершина вершина то становится центральным объектом вы сидите вершине думаете из нее как бы вот такие за вершины смотрите вокруг вас с вашей соседи и соседи соседей но они уже вас меньше интересуют у вас есть послание для ваших соседей вас есть ваше собственное айди она может быть вложено в послании может быть независимость какой-то ситуации и каждая вершина пока не придет финальные состоянии участвуют в каждом супер степи вот так выглядит если кому-то виден код c + + и перевод этого преголя которые собственно был описан в статье видно что он отличается от кума приди снова опять основная функция сет место во рту хальт проголосовать что я закончила вот и ну там реализация парочка еще более так далее все не так сильно интересна потому что кто же нам дал скачать этот преде никто не дал проблема в чем давайте посмотрим коренным образом на отличие от роя сказал похоже поругал мапри диска дуб и так далее проблема то не в том что вам придется плохое и мы просто очень нравится работать с данными которые можно как слайсы нарезать вот такие вот то есть вы ваши данные разрезали на строчки и вам не надо сильно лазить и из одних кусков другие они эти данные относительно независима друг от друга в их раздали на ноды все вычисли проблема граф параллельного подхода в том что ну это кажется что легко вот маленьком графе например ну даже не ну граф мар сколько несложно граф на в график у другого города поменьше легко выйдет компоненты связности разрезал по мостам раздал на две ноты проблема в том что в той же москве уже например очень много мостов а иногда если у вас веб граф эти мосты не очевидны запускать огромную дуру для того чтобы найти некоторый минимальный разрез по которым мы будем разрезать а в каком смысле он минимальный можно же одну вершинку отсечь который одним ребром среди на ну то есть не понятно как тут быть раздача и разгибание вание графа но куски для промера сдачи это своя сложная задачка это своя сложная задачка решается по-разному как раз в относительно open source ных системах которые являются как раз реализации того пределе 5 них я поговорю чуть дальше лично для меня я сам большой поклонник опасть жирафа но есть и граф лап реализация на сетях и граф x игра вч и я про не всех чуть-чуть сейчас поговорю это к поджав прегель проприетарный а pajero уже нет он же об очерский он может запускаться он вообще подходит для кого у вас был какой то кластер hadoop овский сегодня он стоит без дела потому что никакую аналитику не надо вычислять или не дай бог вы накопили ваши графа вы и данные через попоболь как раз уже через к дубовский кластер фото пожрав подходит тем у кого уже все на мази и уже все работает вы можете поставить его сбоку на одну ноту или на каждую ноту это не так важно как этот на первом этапе сделать после этого нужно четко понимать что будет то на самом деле вы написали реализовали какой taipei и что получается пападжи рафида апать жираф обращаться hadoop кластеру и он преобразует ваши функции в цепь мапри дьюс job казалось бы мы хотели от этого уйти но вот они но внимание они отказываются от reviews а иногда сорта shuffle во всей этой катавасии о нем бесконечные увеличивают важность операции map все это напиться в памяти и только в своих понтах как я сказал который мы сами определяем сохранить sandisk если нам не нужна безопасность можем один раз загрузить в память перри колбасить это все в виде цепочки map отображений и потом сохранить на диск финальное состоянии что здорово это штукой поле использует звуки пир для того чтобы отказаться от всех этих ходу папских точек отказы и так далее так далее я чуть попозже про это скажу как это выглядит во всем этом и кассе и в во всей этой системе с выходом ярно все это стало намного проще жираф еще лучше стал интегрироваться даже с первым продуктом все это вполне себе дружила в принципе вас может быть такая инфраструктура можете снизу пойти по любой стрелочки ваш граф может взять как ваш дивс так например в кассандре и даже на самом деле в какой-нибудь реляционной базе данных или в дикси которому же говорили дальше вы всю эту вещь можете в память загружать как тем же хай вам вы можете написать свое придется можете отдаться жирафа на усмотрение а звуки пир будет следить чтобы ваши ноды падали и правильно при выходе мастер одного из строя новый вставал на его место в общем всё где колбасит ваш граф оно было таким не убиваем еще раз почему а поджав ну что мне в нем нравится в нем нет локов в нем вот эти вот основаны на сообщениях коммуникации они рассылают сообщения мне такого что часть гроссграфа зал училась с ней почему какой-то причине чего нельзя сделать или в памяти она лежит залочены нет каких-то семафоров у нас есть глобальный барьер синхронизации а ещё у нас есть по сути как бы это сказать настоящий подход к массивной парализации графа графа не алгоритмов а данных вот это важный момент ну здесь как это физически может выглядеть например на ваших серверов вот лежат вершинки вы на каждом запускаете компьютерной потоки то есть при старте вы каждый баре по серьгам раздали этот граф сделали вершинки подготовили сообщение начали их рассылать внутри своих not между нодами там и так далее здесь еще одна картинка времени уже немного я пойду чуть быстрее итак еще раз немножко роли зуки пера мне он очень нравится здесь чем он занимается он раздает маркером работу он запускает мастера а если один умер другой встал и пошел и так далее именно в нем внуки перри вы можете описывать чекпоинта вы и пути мастер вот здесь вот если первый мастер упадет то его на замену ему ставят 2 причем как будет происходить если где-то в серединке между всем этим вся эта история упала то ничего страшного откатывается обратно к последней последнему ваши мусаев поинту вот но если вы вы не сделали конечно никуда от не приходят и конечно worker и worker и трудяги которым уже раздали все эти графы именно они запускают вычисления функции компьют которую вы можете по своему реализовать вашим алгоритме именно они отправляют все эти маленькие сообщения и эти маркеры можно вы можете заранее приготовить много worker of и потом очень классных например 3 vargyr и на эту ноту 5 worker of на эту может составлять свои таблицы расписания я прибегнул к ссылки на знаменитое исследование скинь жираф на триллионы ребер в жираф очень сильно вложился фейсбук поэтому тут не без него у кого очень триллионы ребер что они сделали они построили некий идеальный график масштабирование на их взгляд вот для например 2 200 миллиардов для 200 миллиардов ребер здесь под зарез в статье в статья который в заголовке там к расстрелян но здесь был ли 200 они построили не которое идеально и масштабирование и провели эксперимент здесь мы видим как они последователь наращивали число worker of для обработки своего графа для вычисления а смотрим как у них убывала время но почти идеально мне больше смущает правда язык статьи картинка где жираф даже лучше чем у него даже лучше чем линия scalability не знаю за счет каких ощущений в перетасовке это было сделано суть в том что если у вас при фиксированных количестве ордеров наращивается число ребер у вас в принципе вы получаете в ну линейно увеличение количества временно вычисления что тоже очень хорошо я уже достаточно сказал о том как происходит умирание нужно четко отделять жираф от к дубовского кластера в жирафе избавились от единой точки отказа у вас все равно остаются ходу папские единые точки отказа типа конечные ноты который выпала в осадок но здесь я хочу привести еще один график мне этот эксперимент больше всего нравятся это уже я-ху я-ху для своего портала кто помнит еще яху порталы дело большой эксперимент у них то они тоже получили граф переходов юзеров куда-то вот и что они сделали они также посмотрели сначала на 200 50 миллионов вершин при наращивании worker of как уменьшается количество времени идеально все любят эту функцию потом посмотрели что все здорово просто как правильно совмещать графике мы их исследуем большим фейсбука вс к нравится они посмотрели что в принципе при возрастании числа вершин у нас тоже почти линейно растет время потом они как бы наложили измерение того и другого эксперимента вот здесь мы смотрим график у него как бы три измире но суть в чем смотрим зал с верхней фиолетовые линии то есть при пропорциональное увеличение количества маркеров при увеличении числа worker пропорционально количеству введенных вершин мы получаем почти констант ную зависимость из постоянное время обработки то есть пришло not упряжь пришло увеличилось количество вершин вашим графину добавьте еще worker of вас все будет за такое же время вычисляться вот такой вывод уехал которая не добили итак мы проводили свой эксперимент нам а придешь в с жираф вот здесь хотела показать вычисление zhang на ходу пи вместе с махо а то и по jiang на жирафе количество итераций ну вы по-разному можете все это реализовывать на жирафе была проведена больше итерации но в итоге на одну итерацию тратилось намного меньше времени и все это в десять раз еще быстрее от колбасило отдельно хочется сказать для тех кто скажет блин да в этом жирафе очень мало нормальных алгоритмов есть еще одна настройка над всей этой штукой окапи вот что это за тунец на картинке я не знаю какой то редкое животное на тоже семейства жирафах это по сути занимает нишу маха утону только для графов то есть все классические не совсем классические алгоритмы если у вас есть даже какое-то обучение супервайзеров на вашем графе у вас есть какой-то под граф про который все известный большой граф про который неизвестно ни фига вы можете использовать на самом деле вот эту библиотеку в ней хороший лист алгоритмов помог даже на питоне нет некой либо где вот все эти алгоритмы поддерживаются но я могу ошибаться и так кто же убьет жираф жираф уже старый отстойный подход которому целых два года говорят ему на пятки наступает вместе со с парком все мы любим спарка тоже круто скала в памяти махну старый добрый мой принес на самом деле на в память грят он в пятьдесят сто раз быстрее ходу по у него есть тут уже поправляли в этом зале у жидость по кручам shark вот я сам sharp только использовал у него есть своя либо для машин learning своя либо для х его ну для sql запросов и конечно же как без этого у него есть своя либо для того чтобы делать граф вычисления но непонятно я не сравнивал сам насколько graphics быстрее чем а позже raw я видел такие исследования но а пожаров уже все загрузил в память и вот здесь надо очень очень корректно подходить вычислительной модель я сам не считаю что graphics это какая-то страшная панацея на самом деле чем это может быть хорошо если вы уже перешли на spark каким-то образом то есть вас был старый hadoop кластер вы еще получали культа аналитическую отчетность потом у вас не знаю внезапно зародилась сеть друзей или пользователей в rtb системе и так далее вы пристроили сбоку spark который лазит в hadoop хранилище для от холл каких-то запросов и вы еще хотите вот над этими запросами строить что-то с графом ну тогда можно пойти по этой ветвистой дорожки но только в этой ситуации еще такая штука как граф график севрского простите горло немного мне очень нравится граф че на самом деле граф чьи это такой как бы сказать пасынок не знаю как это называется угров лобо тоже еще одной лаборатории которая ли зова нанося только в чем прикол они говорят да ладно давайте процессить больших графы на вашем лаптопе его жене большого кластеры но по серьезные ученые нет уже давайте все делать на одном маленьком компьютеры до mac mini например давайте правда мы сохраняем на диск но давайте делать это так круто чтобы вот те данные которые мы читали здесь сканировал последовательно на диске лежали чтобы граф вот так хорошо хранился на диске чтобы вы как будто бы вот ну вот получали выгоды от того как он хранится для этого использую такой алгоритм который называется там parallels lighting window такое специальное окно которое так классно движется по графу и вырывает из него куски и соответственно сохраняет также с о чем вы делите граф на некое количество кусочков сок графов причем они могут быть не обязательно связанными вы когда-то импортировали фоне запустили тулузу которая разделила их на кусочки теперь в память можете читать по этим же кусочком кусочки лежат рядом есть известный выигрыш от того читаете последовательно здорово но конечно лучше на ssd дисках если восковые mac mini ssd дисками на chromebook или так далее но все это конечно для домашних забав впрочем есть график который утверждает он уже сравнивает hadoop не знаю что за hadoop они сравнивали но эта по крайне мере из диссертации чувака который граф че придумал он говорит но у меня нет 1500 36 машин я как бы очень-очень старый аспирант 42 лет в каком-то университете у меня есть мой маленький маг менее я буду запускаться на нем этот граф у него ведь 40 миллионов юзеров 1 и 2 миллиона ребер вообще здоровая штука они подсчитывали треугольнички помним да для чего нужны треугольнички чтобы граф сжимать чтобы не все ребра дуги хранить чтобы его компактно еще на диске хранить аните треугольнички подсчитывали в графе twitter надо было им там хорошо наверно треугольнички считаются типа петь и саша любит машу вот найди такой любовный треугольник и у него что получилось без того чтобы запускаться на полутора тысячах машин он убедительно себя в статье демонстрирует что граф чего очень не плохо отрабатываешь на говорит у меня не граф лап но вы знаете если умножить их 64 машины на полторы минуты еще неизвестно кто кого вот ну то есть вот такой по камере подход я сам лично под в последнее время перешел на использует этого граф че когда я вычитаю сама лаптопе всем рекомендую здесь еще немножко результатов это чисто для тех кто скачает презенташку и просто понаблюдает на вот эти вот данные на графике очень прилично процессе сыграв и вы знаете если вам вас нет претензии дома сразу колбасить фейсбучный граф очень много открытых графов twitter 2010 года дам гигов 30-го весит яхве вот есть такие компаний второго эшелона который выкладывает свои граф их не менее интересно исследовать но вот они в открытом доступе их не нужно умолять на коленях у кого-то и уже почти завершающей частью меньше 8 минут сейчас быстро галопом по европам я обращу ваше внимание на класс задач в которых граф выступает в качестве вспомогательной вещи то есть ладно вы уже хранить его научились процессить и так далее как быть если вы заряжаете совершенно другую задачу попытался снова всем угодить и дорожный граф маску не знаю видно или нет так а это дорожный граф москве на не очень видно определение что такое дорожный граф у него без ребер больше нуля это важно нет отрицательны каких-нибудь циклов у него может быть несколько классов дорог-то вы заранее ранжиру эти дороги например вот это там кота это что-то нем кота это вот например можно закрыть завтра вы это как-то описываете у дорожного графа вершин есть два атрибута широта и долгота это очень важно это сразу открывает невероятные возможности по засовывание этого по здесь а ещё вы можете так или иначе скажем так поместить а ты даже не то что на ваш лэптоп даже не то что вашу память не знаю rasberry pi можете поместить этот графу не очень большой и компактно сжать можете rasberry pi поставить на каждом перекрестке там не знаю ну это так а самое главное тот граф довольно статичный никто не строит у нас в россии очень быстро новые дороги графа топ-10 надо редкой вообще вот у него такие черты соответственно нее можно решать более сложные задачки запомните граф довольно статичные первая проблема а кратчайший путь то таком графе он в каком смысле кратчайший путь вот например теперь нельзя так просто доехать из минска в полтаву теперь кратчайшее расстояние может считаться в каком-то смысле и вот так или иногда вам в игре нужно посчитать кратчайшее расстояние представили игровое поле в качестве графа запустили со звездой радуетесь а иногда со звездой не отрабатывает му что вы блин столько клеточек напилили и так в чем проблема вообще поиска кратчайшего пути вот это граф не знаю про штата орегон где-нибудь на северо-западе сша вот это полный граф вот все вершинка американцы любят жить еще между городами поэтому у него очень очень очень много вершинок а эти вершинки еще все не окрашены в чем проблема дело в том что вы можете запустить кантал гарри там дейкстры и он про смотрит все ваши вершины он же такой классный он просматривает все вершины все это дуру сохранил в память и в ну вы нашли кратчайший путь потом проблема вы можете как-то попытаться ускорить а давайте запустим dx трус двух концов как только эти два потока встретятся так вот тебе и сказочке конец пожалуйста вот короткий путь но мы вообще-то нужны в кофе нуждаемся к это более быстрой системе тут проблема в том что даже если вы by directional dx запускаете с двух сторон можете ждать очень долго люди долго думали такие и выдвинули некоторые требования к системе например вы какой-нить абстрактный google или вы не знаю просто в делаете сервис дорог для вашего региона пример саратова и вам нужно как-то очень быстро в саратове может чуть медленнее в москве чуть быстрее за десять миллисекунд отвечать строить маршрут вы должны в идеале ты даже при увеличении числа вершин при росте вашего графа его качестве чтобы ваши графы алгоритмы например шато спав вы в каком-то смысле как бы субб линейным хочется заметить что вы не против некой фазы при процессинга и при до вычислений но потому что граф то редко меняется почему вам непрядвы числить что-нибудь в онлайне вам мало чего поступает но вы бы не хотели вычислять все попарные кратчайшие расстояния между всеми вершинами такой-то бредятина займет кучу места у вас в графе там миллион вершин of сколько это будет по парных расстояний и конечно вы готовы использовать некую компрессию на диск только ну как нажимать ваш граф то есть вы можете фазе при процессинга даже треугольнички найти чтобы это на диск хорошо сохранять ну как сказал network is лейбл здесь статьи 1 к очень классно товарищ из microsoft research он описал миллион статей в соавторстве с другими и получилась такая табличка всех этих алгоритмов сделаны на и графе дорог европы европейского союза евросоюза здесь показана это тот самый граф 117 миллионов вершин 40 двумя миллионами ребер количество миллисекунд затрачено пример dx трой алгоритмами со странными названиями а л т р е х х ха ха т н ы х а вот я про некоторые отдельные из них скажу ну вот можно найти по этим аббревиатура например первый алгоритм ну а со звездой многие наверно пользовали когда какие нить игрушки писали еще что-нибудь а представьте себе что у вас где-то по земле пускай даже в случайном порядке расставлены некоторые lonworks то есть какие-то земельные меточки и про них что-то известно то есть можно оценить в какой-то метрики какой из них вы движетесь тогда в этой ситуации алгоритм просмотрит отнюдь не все вершин то есть мы помним что я со звездой не все вершины просматривают но вот эти land маркс они как бы подкорректируют его направлении то есть сузит еще больше область просмотра а давайте себе другой алгоритм pride подумаем помните как есть обычно водители они едут быстренько до кончик левой дороге заскакивать на нее начинают по ней быстро ехать тут горит назвали rich типа достигни или ещё что-то такое в нем как бы поиск ведет себя как вот эти водители он доходит до более важного класса дорог заскакивает на него начинают уже по нему мчаться в географическом направлении точки достижения еще более крутой алгоритм транзитного представим себе что вы разделили ваш граф на миллион маленьких кусочков в каждом кусочке вы можете выделить некое подмножество вершин ок например взяли дорожный граф россии вы для из него подгруппы дорожный под граф москвы а в нем вы можете выделить некоторое множество транзитных точек между которыми вы можете в принципе вычислить попарные расстояние вот например когда в москве цена украина другой добирался я такой посмотрел в ближайшей станции метро потом в яндекс метро посмотрел как 1 вершин доехать до другое и потом снова стрелка готова вершина добраться другой точно так же работает этот алгоритм вы храните в конь даже sql базе все попарно и расстояния между вашими транзит нос и все пары знаете какие любая вершина вашего графа и ближайшие к ней транзит ноут и тогда валя все довольно просто вы можете даже не вычислять там эти расстояния или даже какая-нибудь транзит нос если у вас нет времени на при процессе но суть в чем у вас получается очень компактна и количество данных она не квадратная но линейная как будто все довольно здорово вот здесь показана помните да какой был первый игра в котором все вершины просматривайте так далее а здесь вообще совмещенная версия alt + то есть land марки и тренд на ус вы просматриваете настолько мизерное количество вершин построению с декстер и что вообще все очень круто в общем если у вас статический граф вам нужно построить свою систему для расчета шорты спав просто вот какой из этих алгоритмов берете вся системе запиливать забейте на dx true но я специальные случаи когда нельзя забить на dx то есть проблемки вы решаете более крутой оптимизационная задача например у вас есть какой другой стране миллиард долларов которые вы хотите вложить в расширении дорожной сети оптимальным способом и вы такие думаете как бы вот нам так вложить чтобы минимизировать что-то там а дорожный граф в зависимости от пробок он может считаться разным и и тут граф может меняться от итерации кооперации здесь алгоритмы параллели вообще по-другому здесь целиком дорожные графы не очень большие а что такое там 300 тысяч not но они раздаются на различные инстанции вашего например кластера и вот в этой ситуации важно четко понимать что вы не можете использовать какой-то при processing вы не можете использовать это при вычислении у вас на следующей итерации на 1000 ваших нас будет 1000 графов которые немножко друг от друга отличаются здесь становится уже совершенно другие задачи то есть здесь например для кратчайшего расстояния ну используйте какую-нибудь быструю dx true иногда когда ответа очень важен точный ой забыл про это сказать те все алгоритмы крутые они с какой-то вероятностью дают ответ это важно вероятность очень хорошие ну пофигу на самом деле когда вам google прокладывает 3 процентная ошибка вас вообще не волнует ли индекс маршрут по пробкам вы этого почти не замечаете вот она самом деле если вам нужно по какой-то причине точное расстояние и это как поправил как бильярдный шар чуть-чуть по-другому толкнул и вся картина сильно исказилось вот если это для вас важно важна устойчивость решений только суровый алгоритмы которые дают точные результаты итак между совсем чуть кто помнит про такую вещь как космическое излучение представьте себе что из космоса летит лучше он меняет байт у вас на вашем serv очки и все ваш какой-нить графу алгоритм не устойчивый к ошибкам начинает выдавать совершенно не устойчивые результаты так вот уже очень довольно давно 50 лет для каждого классического алгоритма есть его версия для которое устойчиво к ошибкам к ошибкам например вашим векторе там не знаю ребер дуг или так далее вот в общем если вы что-то очень большой разворачивать на многих машинках вас старой плохие машины обязательно и попытаетесь имплементировать вот такую версию и все буквально три картинки терпим терпим вот буквально пару дорожный граф это дорожный граф моего города а я должен был показать он розовый просто у меня вот такая краска это новосибирск если вдруг кто-то из новосибирска есть он узнает свой город это простые способы визуализации видно что очень гусеничка наверно так много не надо когда вы пробки отображать на когда вы всякие очень сложные потоки считаете вам нужен хороший дорожный граф а это например я выделил транзитного новосибирске вот кто снова из новосибирска не даст соврать что эти штуки у мостов в перекрестке очень-очень важны до них очень удобно считать и я выглядел совсем немножко и было все очень удобно ну короче математика она такая блин сложное пронина за все время думать если хотите думать вместе там есть twitter и g плюс его к присоединяйтесь я общем готов с вами общаться на тему все пасибо немножко другой стороны я немножко исправила пожаров правда под в совсем другую сторону насколько я понимаю там есть трудности связаны с тем что но начиная с какого-то с какой-то момент мы начинаем пиратство в какие-то хитрый вечер бренд в сеть и там у нас скажем scalability вообще подают как бы насколько примером может быть и для графов и алгоритмов когда мы вот по соберем кати достачно объемные данные перекидываем на сосина священного да как бы потому что я видел путем картинку этого предлагали там с этим не сталкивались почему и как бы смотрит если сталкиваться про ну то есть там призыв который исповедуют ходу данные которые лежат локально со мной на ноги и х колбас вот здесь жираф пытается делать то же самое вы раздали или жирафы лигров лап в разрезали ваш граф и вы в первую очередь отметив сообщениями все вычисляете вашему под графе и только потом уже какие-то например вы написали свой можно дописать свои агрегаторы они с агрегировать и сообщение которые нужно между сам графами переслать они делают это около синхронизационные барьера данные вообще граф вообще не присылается между нодами присылаются некие сообщения например вы вычисляли в сети там какая вершина имеет максимальный ран вы можете например в свои сети вычислить вам только значение например надо они номер даже но можно даже с номером пару вы раздали всем друзьям сформировали сообщение для стальных сам графов и переслали напоминает ну как как ноды дружат курить кассандра кластере вот мне это очень сильно вот напоминает в общем поэтому нет надо таких проблем"
}