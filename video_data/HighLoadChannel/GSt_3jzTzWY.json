{
  "video_id": "GSt_3jzTzWY",
  "channel": "HighLoadChannel",
  "title": "Ошибки проектирования высоконагруженных проектов / Максим Ехлаков (OneTwoRent)",
  "views": 13565,
  "duration": 3515,
  "published": "2018-01-16T13:39:22-08:00",
  "text": "меня зовут макс компания van торрент портал аренды всего на свете и тема моего доклада ошибки проектирования высоконагруженных проектов и и как их избежать предыдущий докладчик несколько погрузился в технические детали разработки и постройки высоконагруженных проектов я так глубоко и ходить не буду мы доклад будет более высокоуровневый когда мы разрабатываем высоко нагруженный проект мы столкнемся с огромным количеством трудности и потому что любой высоко нагруженный проект поиска нагруженный продукт это сложный продукт состоящий из большого количества компонентов и в каждом из них могут быть какие-то проблемные места какие то место где мы можем совершить ошибки это архитектура это клиентские приложения какие-то да это серверная часть нашего проекта это непосредственно база данных и все эти вещи которые которых уже многократно сегодня говорилось связано с базой данных помимо этого такие вещи как статистика мониторинг backup конечно тоже дают возможность нам ошибиться но помимо этого существуют еще другие компоненты высоконагруженных проектов которые тоже заслуживают внимания все это охватить в одном докладе невозможно практически никак поэтому мы именно и сосредоточимся сейчас на ошибках проектирования почему именно ошибках проектирования если мы посмотрим на жизнь и на цикл проекта то мы увидим что это опыта проектирования то есть этапы формирования требований к проекту как правило нам разработчикам недоступны для контроля то есть они приходят извне это бизнес требование какие то это требования заказчика а этапы которые идут после проектирования на них проект начинает набирать сложность самое главное ошибки которые закладываются именно на этапе проектирования в последствии крайне тяжело устранить вот на графике мы можем посмотреть некую относительно у стоимость устранения ошибки на том или ином этапе жизненного цикла проекта и если мы посмотрим то устранение ошибок на этапе эксплуатации это самая самая большая проблема которую только можно встретить и как раз вот предыдущий докладчик вынужден сталкиваться именно с этим со сложностями уже существующих проектах проще не допускать ошибок сразу еще один момент связано с тем почему это проектирование важен ну наверное потому что на этапе проектирования весь проект помещается в одну голову условно на в одну в одну или две три головы аналитиков проектировщиков когда проект переходит на этап разработки все мы вовлекаем огромное количество служб разработку уже там devops тестирование и проект становится трудно контролируемым при этом смотрите поскольку на этапе проектирования проектом владеет по сути один человек мы условно такой коллективный человек то его особенности его установки его подходы к реализации тех или иных компонентов проекта будут в дальнейшем очень сильно влиять на то как проигрывает развиваться в какую сторону будет расти и какие проблемы в последствии в этом проекте проявиться дел том что большая часть проблем закладывается именно на этапе проектирования к сожалению это так и сейчас мы с вами как раз таки увидим как они закладываются да и как можно попробовать их не заложить туда и начнем мы с такого с печальной истории совершенно печальный это кейс высоко нагруженного проекта десятилетней давности приблизительным разрабатывался он 2007 девятом годах один из за региональных операторов связи который активно в то время набирал абонентской базы интернета через adsl как раз . эпоха когда кабельные операторы пока были не сильно развиты в регионах и возникла мысль у этого оператора что давайте сделаем некий портал который замкнет на себе их абонентов интернета этого оператор это порядка 10 миллионов человек включая мобильный и проводной интернет для оператор это было выгодно потому что там ему не нужно было обмениваться трафиком с магистралями и значит вот такое решение было принято в каком виде предполагалось реализовать это был некий развлекательно информационно-развлекательный портал там с какими-то новостями с форумами с местами для общения с даже с файлообменниками с торрентами и так далее чтобы вот как по максимуму завернуть на себя пользовательский трафик для контекста да можно представить что это была за эпох а на php 5 2 и основные фреймворке только только начинались 5 и москве 5 никаких более-менее современных вещей которые мы сейчас очень часто упоминаем в докладах не было немало гиней там языка головы каких-то еще еще и тоже не было вот команда которая занималась разработкой этого проекта пришла из enterprise enterprise джавы даже вся команда начиная от архитекторов и заканчивая конечным разработчиками и было реализовано некая архитектура в чистом виде трех звен когда то есть это был фронт безусловно веб фронт конечно backend на джаве написаны и база ваза была выбрана часто видим какая была выбрана база данных oracle естественно да потому что это enterprise это хорошо дорого и мощно точно так же любой компонент который мы возьмем этой системе был выбран с точки зрения энтерпрайза это какие-то огромные там сервера там фантастической производительностью якобы это чудовищный сервер приложений по объему по каким-то там ночь своим характеристикам эта база данных oracle к коже сказал вот и system backup промышленное которая фоне бы капеллана ленточку то есть отдельный сервер бэкапы которые со с файловой системой вот этого большого сервера данные и куда ты их складов что произошло цикл разработки там суд был порядка одного года после этого проект запустился и тихо-мирно загнулся но загнулся он не по причине того что он как-то провалился или что-то а просто в связи с изменением рынка потому что произошел взрывной рост количества проводных операторов операторов кабельного интернета и вот это вот необходимость замыкания трафика исчезла исчезла бизнес-задачи все проект был грубо говоря свернут но он показателен и сейчас мы посмотрим почему в нем были завершены на мой взгляд все возможные ошибки проектирования которые можно было совершить и одна из них это то что я назову сейчас ложной целью единственная цель которой озвучивалась и ставилась перед всей команды разработки включая там управленцев включая администраторов это бизнес цель на цель охвата всех тех абонентов интернета но это же неправильно на самом деле бизнес или этот ролик который существует независимо от разработки они просто есть для их нам либо ставит на заказчик либо это ставит нам маркетинг если техническое подразделение не ставит перед собой никаких целей то она никогда не придет вот соответственно что могло бы быть правильной целью в данной ситуации правильной целью для любого high-load проекта является в первую очередь его производительность ну грубо говоря время отклика системы на какие-то запросы пользователя то есть это будь то веб будь то мобильное приложение и так далее во вторую очередь это x просто the user experience она на самом деле очень тесно связано с производительностью почему да потому что чем проще интерфейс тем меньше запросов пользователь создаст на сервер и даём ему возможность там в несколько кликов достичь того что он ищет и по сути на сервер пойдут только эти клики ничего другого ну и по архитектуре что было неправильно первую очередь ориентация на вертикальное масштабирование и выбор гигантских каких-то машин к сожалению ориентации на вертикальном что перво не очень часто прошитую в голове да то есть мы очень многие из нас начинают из обычного веба с просто в какой-то веб-разработки поэтому там но не стоит задача какое-то выдерживание большой нагрузке и маленький сервис вполне спокойно справляется и возникает ложное люди что если мы возьмем просто серве побольше то все будет классно при росте нагрузки нет не будет у любого сервера все равно будет потолок на а в хайло проекте мы не знаем где когда это потолок будет достигнут когда к нам придут те кто колеса пользователей которая нам этот сервер повалят при вертикальном масштабировании мы рискуем в этот потолок очень больно стукнуться поэтому в любом случае до на старте ли не на старте в принципе при проектировании лучше закладывать горизонтальное масштабирование в этом направлении сейчас идут даже google да вот пример ориентация на именно большое количество небольших хочешь слитных узлов если мы посмотрим на современные суперкомпьютеры это тоже не по большому счету не одни какие-то гигантские вычислителей типа крем от 32 китайский пожалуйста это набор у слабо связанных между собой интеловских машин с конечно же там с графическими акселератора my но суть в том что это горизонтальное масштабирование в чистом виде бонуса в том что мы можем начать с небольшого количества относительно дешевых узлов с одного даже узла условно потратить на это маленькие какие-то деньги и запустится и потом при необходимости масштабировании мы просто закидываем в наш кластер какое-то количество узлов и спокойно совершенно выдерживаем практически безграничную нагрузку бонусом к горизонтального масштабирования идет сразу же и кластеризация как правило если у нас есть квартиры нескольких машин мы можем как разделять распределять нагрузку между ними так и реплицировать данные и таким образом достигать какой-то отказоустойчивость следующая ошибка которая была совершена это выбор неправильного сервера приложений неправильного в каком смысле самом деле ну что такое vip за пирата хороший сервер приложений сложный да это портальный сервер в нем огромное количество возможностей которые могут использоваться и использоваться в огромном количестве организаций но на старте проекта в начале стартапа а вот этот проект на самом деле да несмотря на то что его продвигала большая организация и вкладывала в него огромные деньги это был все равно стартап что видели ото рта по характерно отсутствие явные перспективы то есть в стартапе всегда имеется какая-то неопределенность и расплывчато есть будущего непонятно взлетит не взлетит вот поэтому лучше избегать больших вложений в том числе в программное и аппаратное обеспечение вот это одно из них почему это неправильно ну во первых это дорого очень недешевая вещь плюс она тянет за собой огромное количество дополнительных инструментов тоже не дешевых инструментов разработки рыбинске плюс это энтерпрайз java со своим очень таким медленным циклом разработки программа изучения что тоже впоследствии может сказаться не правильно что было бы правильно ну на самом деле печки да ну потом по нынешним временам любой веб ориентированный язык кроме java почему-то потому что на них разрабатывать проще чем на же вот следующая база данных которая была выбрана это база данных oracle хорошая база данных отличная база полное каких-то супер возможностей которые не представляют ни одна другая база на планете но опять же с ней ровно та же проблема что из-за имеют веры это большое дорогое решение которое не нужно в стартапе вот дорого медленно разрабатывать дорогие специалисты что лучше то на самом деле сложно сказать на самом деле водка какую-то тётку рекомендацию по временам 2007 года наверное это было бы ваза данных mysql и или ползли по нынешним временам существуют хорошие но из кого и решение которое тоже могут и должны на мой взгляд использоваться именно для в качестве базы данных стартапе в каком-то начинающим highload проекте key value в тораджи если это необходимо особенно здесь вот я выделил ошибку такую как один проект одна база во всем проекте уральского портала было ровно одна база данных oracle даже один instance этой базы который использовался абсолютно для всего это тоже на самом деле ошибка почему проекте существуют несколько задач много задач связанных именно с хранением данных и каждый из этих задач отличается от других отличается по количество хранимых данных по частоте их обновления по частоте запросов этих данных и так далее по требованиям там каких-то денег целостности данных к бэкапом и класть все это в одну базу скорее всего неправильно почему потому что мы тогда не получим пока усредненную производительность по всем этим направлениям вот правильно было бы выбрать несколько разных вас каждый из которых решала бы только одну задачу но решала бы и оптимально ну и наконец backup & backup на ленточку который использовался там был в высшей степени не пригоден для той задаче которым вы пытались решить во-первых он осуществлялся в фоне и по сути постоянно да он выполнялся это были снапшоты файловой системы огромные там да много гигабайт на острых восстановления такого быка по занимало часы то есть в случае какого-то падения сервер гарантированно выпадала из работы на несколько часов чисто чтобы найти этот backup в архиве я точно и поднять его значит сначала на какой-то сервер а потом с него уже накатить восстановить его snapshot на диск основного сервера счастью сервис так и не дошел до той нагрузки которую которую ему значит прогнозировали то что если бы он дошел и вот такие времена недоступности все-таки случались бы the service бы закрылся ну куда как более громким треском какое решение ппк по было бы более правильным правильно было бы не использовать то решение которое было вот на поверхности да потому что ну а почему использовали ленточную потому что оттуда было стоит сервер рядом стоит я начну библиотека они могут между собой интегрироваться а давайте их интегрируем классно но можно было бы совершенно спокойно отдельно бэкапить файловую систему и отдельно бы копить базу данных при помощи каких то может быть даже самописных скриптов или каких-то средств резервирование базы общения а резервное копирование это бы дало с одной стороны небольшое усложнение самой системы но с другой стороны позволило бы сократить время восстановления потому что она бы не нужно было полностью тащить из медленного хранилища огромный там много гигабайтные snapshot диска плюс возможно не было бы некоторых проблем таких например как невозможность просто восстановление из бекапа потому что в стеллу прозрачности backup а некоторые из резервных копий оказывались не работоспособными такое тоже бывало подводя итог на сервис был закрыт по марке иную причину но если бы он не был закрыт по маркетингу причинам то те технические проблемы которые у него были заложены проектировщиками они бы его ну либо его закрыли рано или поздно уже после выхода на рынок то есть низкая надежность оборудования несмотря на то что это было ли какие-то фантастические там супер дорогие сервера они не обладают той надежностью которую заявляет производитель вплоть до того что там были случаи когда восстановление сервера просто в сервер перестал работать по какой-то причине и для восстановления пришлось вызывать техническую поддержку на место он саппорт в течение там 3 рабочих дней не восстанавливали сервер специалисты и из-за рубежа обе да это все оплачено пожалуйста по гарантии но три дня недоступности сервиса в случае холода это смерть медленное восстановление из бекапа тоже было бы очень проблем очень большой проблемой потому что обе афера в те времена была нестабильной и не имела особенность падать просто после deployment а новой версии приложения нормально чистого тепло это допустим цикл разработки завершён новая версия выкатывается сервер падает и не восстанавливает нет не поднимается то есть единственное спасение это восстановление из бекапа а восстановить бэкап а занимает 4 часа все тоже для хайланд сервиса это смерть и силу ориентации на вертикальное масштабирование они на горизонтальное был изложен теоретический потолок производительность проблема еще была в том что никто не проводил нагрузочного тестирования то всего поэтому никто не знал где находится этот практический потолок но он он безусловно есть да у любой вычислительной системы он есть поэтому рано или поздно при росте нагрузки пользовательской этот потолок был бы достигнут и и все система бы остановилась ну или бы либо и и произвольность был ухудшилось настолько что она стала бы не выдавать неприемлемы качество не приемлемый уровень юзер экспириенс прицепом к этим техническим проблемам идет ну скорее организационная проблема да это медленный цикл разработки связаны с выбранными инструментами с выбранным с был выбран и методологии проектного управления даже там обеим rational цикл внедрения новых фич занимал там от трех недель вверх что для проекта уровня старта по двум наверное не очень хорошо то есть это значит что цикл реагирования на а пользовательские какие-то отклики на пользоваться какой фидбэк о сервисе занимает вот ну порядка месяца за этот месяц потом пользователи могут уйти на какой-то конкурирующей сервис об этом просто не думали на этапе проектирования этого сервиса в общем результат был не очень хороший хотя сервер проработал определенное количество времени но он проработал очень таком вялом режиме поэтому можно сказать что это просто файл вот классический файл что же делать да так какие вот как давайте структурируем все эти ошибки которые вот мы сейчас попробовали описать во первых это ложные цели это самое ложное целеполагание которое с которого я начал рассказ об этом кейсе либо мы делаем что-то не то что нас не приближает к нашей какой-то цели которая должна быть перед нами поставлена либо мы реально идем не туда мы стоим перед собой не ту цель мы работаем и и достигаемые понимаем что блин мы шли все это время в ложном направлении не надо этого делать до нужно всегда ставить перед собой конкретную четко достижимую техническую цель вторая проблема это инерция мышления проектировщика вот это вот очень большая проблема проектировщик хочет использовать не хочет не правильно выражать проектировщик использует те шаблоны и те паттерны и инструменты которые он привык использовать которым которым он научился который использует всегда и считает что опять же не считает у неё в голове есть установка что эти шаблоны эти паттерны работают они действительно работают он их применял уже там каком-то количестве проект но проблема в том что они на самом деле они работают не всегда и используя какие-то по сути группа едет по рельсам не всегда можно приехать туда куда мы хотим приехать надо иногда от этих рейсов попытаться перейти куда-то еще третий корень зла это следование моде или еще сюда же следование маркетинговым обещаниям если технология или там какой-то инструмент какое-то решение популярность сейчас если все о нём говорят это не значит что она действительно должно быть использовано в вашем проекте если его рекламируют усиленно если там весь интернет условно забит рекламой какой-то технологии если в рекламных буклетах вы читаете что эта технология наилучшим образом подходит для той или иной задачи это значит скорее всего ровно противоположное данному маркетинг все понимают да это что-то на грани обмана поэтому слепо следовать этому не нельзя не в коем случае вот и теперь попробуем понятия как что что нам делать тогда очень просто все предельно просто дарта все люди понимают что мы разрабатываем мы проектируем какую-то систему и когда мы проектируем нам желательно не использовать готовые какие-то решения ну тоже смотрите что точно не использовать вот оператор гол туда его нельзя использовать почему он же есть до его его ну ты вольна и когда можно вот когда его можно использовать когда он приносит пользу так и с готовыми решениями они должны приносить пользу проекту и должны работать на достижение цели проекта вашего не использовать популярные решения если что-то популярно первое что вам должно приходить в голову что это hyip и нужно от этого воздерживаться да безусловно есть огромное количество популярных технологий то есть сейчас очень популярен языков хороший язык классный можно использовать да конечно он популярен да но есть другие популярные технологии которые действительно популярны очень много сервисов реализованы с использованием их но действительно ли они соответствуют своим заявленным характеристикам но не всегда дальше мы увидим одну такую технологию и третий момент наверно так не нужно использовать то что очевидно не нужно использовать очевидные какие решения то что первое в голову приходит первое в голову придет всегда то что вы уже применяли то что вы умеете применять то что вам кажется знакомым и правильным но это именно кажется да она может быть правильным можно понимать что она любое решение может быть правильным и работать но прежде чем вы его обдумаете никогда нельзя применять то что просто всплыло в голове всегда нужно соотносить те решения которые вы хотите заложить в проекте с теми целями которые вы который вы преследуете то есть грубо говоря всегда нужно включать голову да и анализировать насколько наше решение полезно насколько наши решения может нас продвинуть в достижении нашей цели ну и следующей части моего доклада я бы хотел немножко перейти к другому кейсу то это тот кеес который мы сейчас разрабатываем портал аренды month and мы стараемся не совершать их тех ошибок которые я сейчас описал и я попытаюсь вкратце описать ту архитектуру которая должна быть нашей точки зрения в высоко нагруженном проекте все моменты которые сейчас я буду говорить да они справедливы и для уральского портала на самом деле для того который я сказал то есть если бы в том проекте были применены те же решения что и сейчас то наверное бы это не было файлом во-первых мы поставили перед собой строго техническую цель не более 50 миллисекунд на ответ сервера как со стороны неба так и со стороны мобильного пи и во-вторых стараемся удерживать цель три клика до любого раздела портала то есть это те вещи которые позволяют во-первых снижать нагрузку на сервер да и во вторых является теме вот рамками из которых мы не должны выходить и поэтому все решения которые принимаются технически соотносятся именно вот с этим на если мы понимаем что мы выходим за пределы скажем 5 10 миллисекунд все нужно что то менять то есть принять какие-то там обходные пути и так далее архитектура предполагаемая несколько более сложна по сути на самом деле на это тоже 3 свинка да у нас есть фронт у нас есть некий backend который его обслуживает у нас есть база но каждый из этих звеньев она развалилась еще на ну довольно много других моментов по отдельным узлам час наверное нет смысла бежать архитектура бэг-энда мы стремимся к micro sim и micro series архитектуре то есть backend веба это печка falcon backend мобильного приложения то есть api мобилки это но даже и отдельные микро си уже чисто микро сервисы пишутся на гол почему именно эти решения во первых причин клипе falcon да наверное есть вопрос с и потому что весь и даёт некую простоту разработки и ускорение а falcon как фреймворк это наиболее производительным work . на планете нас момент то есть да он он он реально наиболее производительный и поскольку нам важна производительность мы пришли к использование именно его почему но джесс в качестве мобильного приложения потому что надо во первых нот и java script да это тоже несколько такая простая разработка во вторых она очень хорошо выдерживает большое количество одновременных коннектов живых коннектов почему гол потому что гол дает большую производительность то есть если сравнивать производительность серый за написанного на одного и того же сервис там словно сидел написанного на гоа и на там любом вот из этих вот других языков даже на самом деле наверное ножа я долго будет впереди существенно супа до помните да я говорил что одна база на весь проект это неправильно так вот мы применяем 3 хранилища причем эти три хранилища выбраны исходя из того с какими данными и ты хранишь должны работать то есть горячие данные которые постоянно читаются и пишутся мы храним манга какие-то медленные данные то есть которые не так часто пишутся и читаются хранятся в миску или и исторические данные и статистика хранится в кли хаусе тоже почему почему манга горячие данные потому что манга дает очень большую производительность огромную признательность особенно при чтении данных существенно превосходя и как москаль таки cliff house при сохранении достаточной достаточно мощности по структурированию данных почему mais quel для хранения медленных данных опять же запись москаль происходит очень быстро да она чтение в данном случае нам дано не очень важно воевал его скорость потому что эти данные читаются редко и в основном для каких-то системных нужд ну и хранить торические данные и статистику в хаосе это вообще правильно да потому что при house именно предназначена для хранения больших объемов данных эти данные один раз пишутся и потом только читаются причем не так часто как любые другие что здесь все поехала на счет если мы увидим что вниз у нас увеличивается объем данных а верх увеличивается частота обращение частота обновления данных вот исходя из этого и были выбраны именно эти инструменты которые вот здесь представлены для опять же для того чтобы уложиться в те цели которые мы заявили мы используем глубокую де нормализацию то есть данные там хранятся в нескольких копиях очень много где применяется именно для того чтобы снизить количество запросов к базе и тем самым снизить время которое тратится на работу с базой также если мы все таки не укладываемся в те нормативы по времени которые мы перед собой ставим мы очень часто применяем отложим на траву обработку и предварительную даже обработку что-то то есть какие то какие то вещи которые пользователи могут запросить у нас мы готовим заранее то есть даже глупость может быть наиболее популярные кита поисковые запросы и так далее они лежат в кэше и вот как раз следующий пункт который здесь есть это кэширование причем там несколько слоев этого кэширования как кэширование на уровне веб-сервера таки уже каширование в приложении в самом все это позволяет реально держать время ответа от сервера ну на уровне 50 миллисекунд пока что это нельзя назвать там секс истории да потому что релиза еще не было но он будет скоро и наверное к осени мы сможем уже поделиться некой статистикой по реальным данным на этом у меня все спасибо за внимание вот вы сказали в уральском проекте был недостаток это вертикальное масштабирование а вот в этом втором проекте используются масштабирование если да то какое можно поподробнее про значит давайте от кончу архитектуру каждый из этих узлов на самом деле это докер-контейнер отдельный который может быть запущена на каком-то сервере соответственно они все существует в нескольких экземплярах причем количество этих экземпляров она не фиксирована мы можем добавлять экземпляры ну по сути вот каждый квадрат здесь это кластер паники вот то здесь горизонтальное масштабирование здравствуйте спасибо за доклад я бы хотел спросить следующее вот получается очень много всяких сразу со старта сложных вещей вы включаете да а в первом получается случае в первой половине доклада по про уральскую часть получилось так что тоже много чего наворотили а в итоге не выстрелила то есть я так понимаю что нужно наверно уточнить что стоит использовать водки keep it simple принцип если до конца наверное не понятно заранее насколько у вас сложная система то есть у вас понятно ван дорен говорит о том что в этом что-то будете агрегировать и люди там чего то будут очень много ходить туда да если люди начинают это стартап нам на другой да я начну пользоваться принципе вот вашими советами сейчас то могут наверное наступить на грабли вот того же по сути уральского портала смотрите ну спасибо за вопрос сформулирован из два момента до 1 это сложность системы и второй это ее стоимость и сложность но техническая какая-то до архитектура вот это оно более сложна чем-то которая была в первой части порталом потому что в ней просто больше узлов но она во-первых она дешевле в разработке просто потому что здесь очень много применяется реально бесплатных инструментов вместо каких то энтерпрайз решений во вторых вот теоретически это все может разместиться на одном узле вычислительно . как некая программа сервис не отдельно выделять там в какие-то контейнеры и так далее а просто вот это все можно собрать прямо вот на коленке условно и обслуживание такого казалось бы зоопарка систем она не более сложна чем обслуживание там двух-трех систем энтерпрайза ну да чуть чуть чуть больше нагрузки на админов конечно ложится на drops of но поскольку каждый из сервисов которые здесь представлены которые мы рекомендуем там тоже манга там тут все те которые звучали они более просты сами по себе обслуживать условно говоря там серверу приложений там джинс php-fpm и манга состоящего из этих компонентов куда проще чем сервер приложений на java + oracle просто вот ну вот вот так и вопросе поднять проще обслуживать и в дальнейшем проще масштабировать даже тоже вот поэтому как раз таки для стартапов лучше придерживаться более простых технологий более дешевых пусть даже будет больше по сервисам но с нами технологии они будут более простые более понятны более какие-то атомарные что ли вот как то так это же еще может влиять на количество сотрудников правильно то есть тоже нужно брать во внимание только стоимость самих там enterprise цели бесплатное решение мне кажется множество систем на бесплатных основана вещах не просто собрать команду которая все это будет уметь между собой подружить тоже задач абсолютно верно да ну во-первых немножко возражу что enterprise сотрудники гораздо дороже чем вот сотрудники под такую разработку это раз ну ладно основной момент да эта архитектура вот она есть я показываю как антитезу архитектуре уральского портала которая была большая монументальная да такая гигантская и которая не взлетела мы считаем что она взлетит потому что в ней нет тех изъянов которые были в райском портале нет там долгого времени восстановления нету там каких-то потенциальных потенциальных потолков по производительности и каких-то других узких мест значит ли что всем всем стартапам нужно сразу же реализовывать именно эту архитектуру нет не значит конечно да она подходит нам в нашей конкретной ситуации основная мысль всего доклада на самом деле в чем заключается в том что когда вы что-то проектируете выбирайте те инструменты которые наилучшим образом вам подходят у вас есть задача сделать вот что-то вы смотрите на те инструменты которые есть на рынке и выбираете из них тот который подходит вам не потому что он популярен не потому что вам нравится а просто потому что он реально работает и позволяет вам достичь тех целей которые вы озвучили ну хочешь снова использовать пузыре и она вам реально помогает но используйте пожалуйста хочет нам урока лбу ну ладно так почему нет уроков отличная база просто не все задачи нужно пытаться запихать в нее тогда спасибо и в принципе как раз просто в этом всем наверное была суть потому что я рассматривал все таки как рекомендации да и вот как раз вот вы сейчас по сути далее вот развернуты что это не прям рекомендация для всех это вот наше нелегкое решение нашей четкой проблемы и не стоит на него там операция как на как строга как на надо рельсы вот так это вот именно то рельсы не нужно спасибо за доклад java сейчас слушал ваш ответ на вопрос и вы просто сами себе противоречите вот вы рассказали 1 час доклада об хая систему необходим сказать что она плохая хотя она закрылась не по своим техническим причинам а по бизнес причем то есть на выдерживал свин нагрузки она себя вы у него она была плохая она не старта потому что она использовала бывшие страшен технологий долго разворачивалась надо было быстрее стартап плавно выходка и потом вы показываете слайды где используйте три языка три базы данных для стартапа хотя вы конечно для нac нагрузок которые вы не знаете потому что вы не выкатились у вас нет клиентов вы не знаете какие у вас реально быть нагрузки высшая построили архитектуру вы катитесь у вас появится пир тысячи клиентов и бизнес требование изменится кажется что ваш клиент ожидая чего другого вам плюс все перестраивать но в ужина против такую сильную мощную фигуру как вы считаете и она уже бы тяжело jolla для переделывания прочего что вы просто дофига туда вместе ли хотя такое ощущение s-класса что сами до конца не знаете про саму что это нужному что это за дела требование как сама начале сказали вот из воздуха вот когда вы бизнес требования объясняли а для oracle которой велись и которые действительно не были нужны лист класса такое ощущение like отличный вопрос спасибо большое значит момент тут такой да вы правы абсолютно что мы сейчас не знаем тех нагрузок с которыми нам придется столкнуться мы не знаем как у нас поменяются бизнес требования мы много чего не знаем дамы мы вот-вот релизимся в июле только но слайде вот в этой архитектуре есть ли что-то от бизнес требований ну наверное нет то есть если бизнес требование поменяются то это поменяется логика приложения но архитектурно мы не будем ничего менять смотрите если там как бы не поменялись бизнес требования нас по-прежнему останется мобильный клиент и веб-клиент правильно у нас по-прежнему остается 3 уровня данных которые я вот описывал там-то горячие данные так далее то что вы говорите то это вот первый момент архитектура вот на наш взгляд сейчас может быть он он может быть не совпадать с вашим доел может быть вообще не правильным и они не утверждаю что это единственная возможная архитектура высоко наружного приложений мы сейчас видим ее как никакие ну некие такое приближение к идеалу с нашей точки зрения с нашей точки зрения для наших задач а как же самое главное требование стартапов выкатиться быстрый выход кончине клиентов а потом уже пользуются там именно так именно так все верно затрудняет ли реализация такой сложной архитектуры быструю выходку нет в нашем случае нет нам повезло у нас есть команда которая может это поднять если опять же да вот предыдущий вопрос частично с ваши с вами перекликался до нужно ли всем стартапам реализовать именно это если вы говорите что вот три языка сложно не используйте три языка зачем вам их использовать если у вас нет специалистов которые могут писать там на но digest например на транскрипте зачем вам и и пытаться вкрутить ваш проект потому что это популярно но тоже не аргумент 8 если она вам реально нужно в вашем проекте тогда вам придется ее выделять знаете специальную нужду еще нету клиентов клиентов нет но понятно же что все равно даже там не бизнес требование а вот технические требования в системе исходят из каких-то предположений из каких-то прогнозов эти прогнозы есть безусловно дар они пока не реализовались но все равно же от чего-то надо отталкиваться и самое главное вот в одном из предыдущих докладов там говорилось про хабр эффект никто от него не застрахован и стартап как раз таки любой стартап должен держать у меня что вот он начнет он откроется и очень большая вероятность именно наступление такой ситуации когда сразу же приходит большое количество пользователей а он не готов и архитектура не готова потому что в принципе не рассчитывалась на какой-то там возможность быстрого масштабирования вот исходя из этого мы заложили от артем трудно мы потратили чуть больше времени чем могли бы мы могли бы выпуститься раньше если бы нереализованные вы правы но мы себя обезопасили от ряда проблем в будущем пацаны 40-го что что пацаны которые писали для этого которые вы рассказывали они тоже самое сделаю вы их за это ругали так давайте потом хорошо спасибо вам за захват вас то на одном из слайдов была сказана что вы используете сильно нормализована схему данных как вы решаете проблему консистентной sti данных в коде это вручную как-то следите за этим или используйте какие-то средства может быть зачитаете во-первых в коде да то есть при необходимости изменения где нормализованных там представлений они обновляются когда происходят изменения какого-то исходного документа вот это конкретно касается манги давайте тоже перемотаем на базу вот основные данные у нас хранятся в longhi соответственно у нас есть некие там квази реляционной схема минимальная довольно глубоко нормализованная вот есть представление этой схемы которые ускоряют получение данных из базы вместо того чтобы ходить по 10 коллекциям и собирать из них эти документы мы готовим заранее один большой документ который выдается сразу вот этот документ обновляется при изменении всех документов которые выходят в него автоматически обновляется на уровня приложения вот плюс имеются некие сборщики которые в фоне пытаются найти расхождение между базой нашей нормализованной иди нормализованы my представлениями и их как-то поправить здравствуйте прошу прощения может немножечко прослушивала вот твой говорили горячие данные не очень горячие это одни и те же данные да нет это совсем разные данные так горяч и данные это основные данные приложения это пользовательский там учетной записи это какие-то пользовательские данные с которыми постоянно происходит работают они постоянно читаются как минимум до и довольно часто пишутся в базу поэтому манга потому что она держит их памяти это происходит очень быстро и выдерживаться те времена которые нам нужны маску эль там хранятся медленные данные что это такое это разнообразный историей то есть это нет ни статистика еще но это там история изменений какого-то объекта это допустим история каких-то событий в системных они пишутся тоже довольно довольно быстро и часто но читаются они не всегда то есть по сути не на каждый запрос пользователя они читаются даже он там процентов 5 запросов доходит до mysql в клик хаусе лежит статистика то есть то что вот просто собирается статистика по пользовательским действиям вся клики там переходы какие-то и так далее просмотры страниц это че туда валится в сыром виде клика вас это все прекрасно перерабатывает этом он может хранить миллиарда строк обрабатывать их очень быстро вот но опять же пользователи туда вообще не идут то есть чтение оттуда происходит исключительно в каких-то там вспомогательных системах вот именно на исходя из этого и вот они разграничиваются я видел он максимум еще от смотрите вы перечитали очень долго беды уральского портала но от вас нет ощущения что на самом деле шоу было не команда а была ошибка менеджмента в том что мы начнем путь а просто купил за огромные деньги уходящую команду которая знала технологии оплатил это же не подходящий к маги не менее дорогим дорогую технику она реализовала и и так как она реализовывал и и всегда и собственно то есть команде заказали команда реализовала но ошибка была не команды ошибка была менеджмента который выбрал неправильную команду ну то есть видимо самую дорогую у нас периодически так происходит то есть мы нужно покупать самую дорогую команду думаю что она сама лучше то есть другая команда соответственно реализовывает что-то на том что привыкла то есть задорого в итоге получается продукт потом выясняется что продукт на самых подходящих технологиях но как бы то есть вина не команды не продукта выбрали не ту компасе база вопрос да значит смотрите отчасти вы правы это вина мэр но тут как посмотреть на самом деле что такое проектирование системы проектирования как раз и есть между управлением и уже разработкой и вот на самом деле в проекте уральского портала были проектировщики которые обладали довольно большой свободы принятия решений и выбор технологии лег осуществлялся не по решению менеджмента а именно на основе решение проектировщиков то есть до проектировщик сказал будем делать на энтерпрайз делать народ я буду делать вот так почему он сказал ну потому что он мол эти всегда занимался он занимался за проездными проектами как раз на интерфейс джаве с oracle ами там все такое менеджмент до вина менеджментом может быть в том что они не критически подошли к этому решению что да то есть там совершенно фантастически какие-то затраты но могут то но проектировщик тоже допустил огромное количество не потому что он и если бы он руководствовался те миксы хотя бы вот поставил перед собой цель производительность да и скорость разработки он бы не принял решение там выбрать in the проиграл просто нет так что отчасти вы правы но отчасти и здравствуйте спасибо за доклад хотелось бы уточнить по поводу архитектурных решений выбранных вами вы не могли бы перевести слайд назад спасибо насколько я помню в бэг-энд написано печки немного на гол так петь и за счет и штефан канала персии а почему мобильную api написано на но да я говорил о тогда еще расскажу это потому что сразу знать в чем преимущественно ваш взгляд но даже в данном случае почему не обычные rest api был использован на печке предположим и как связываются но до с ядром вашем случае а значит почему но даже с именно потому что и второй вопрос вас в одном будет принято решение что мобильное приложение держит не непрерывный connect с сервером для чего для того чтобы мы могли отправлять ему какие-то сообщения в обход систем и ферба из ушей через наш конец напрямую это на печке реализовать то есть socker socker да соответственно на печку письме от пола все вариант 2 либо это надо либо одну не 2 там любой другое решение которое позволяет держать своих соединений почему была выбрана но до по следующим причинам во первых у нас были разработчики под ну то есть это вот опять к молодому человеку тоже можно сказать вторых но да хорошо держит connect и мы тестировали большое количество подключений она она с этим справляется вот в этом преимущество домой плюс разработка на java скрипте довольно порта забери есть минусы да да там определенного характера связанные с асинхронными какими-то вызовами в java script я ну наверное в перспективе можно будет перейти на голову в общей полностью каким образом связывается но до с ядром когда заразы модели повторяете в ноги или все-таки есть какой-то api подняты между но да и дров во первых часть данных связывается часть она пишется в базу на прямой удар работает с некоторыми данными с самыми быстрыми этой с мангой прочие система на вообще никак не смотрит и если возникает у нотой задача поработать с чем-то что откликается более медленно там смазку или хаусом или tencent еще то это все происходит отложено задача через очередь ставится маркеру который там где-то работает и обслуживает то есть вам и одновременно приходится поддерживать два продукта одновременно приходится при поддерживает два продукта то есть вы добавили колонку в базу данных до то вам приходится следить за этим и в мобильной мапей и если эта колонка должна быть видна условно видно клиенту туда если не должна то нет спасибо добрый день спасибо за доклад интересно на самом деле очень у меня просто такое производились ли какие-нибудь тесты производительности всего вот это вот такой непростой архитектуры если производились то в каком месте проседала что-то аналитика есть у вас так но смотрите по нагрузке до поскольку у нас применяется кэширование на в по стороне веб-сервер джинс то есть вот в предыдущем докладе как раз говорили про там кэширования вот у нас есть кэширование на стороне джинкс а вот нагрузка на веб практически довольно большая дамы мы проводили тестирование но пока к сожалению мы я не могу озвучить его результаты потому что они будут не очень объективными вы проводили его на нашем оборудовании которая пока не production а уровня вот то есть можно сказать что допустим но до на простых на каком-то очень там от 1 процессор нам сервере может выдержать там несколько сотен тысяч conecto спокойно нет нет не серверного уровня а просто какой-то доступной машине значит касательно php фронтенда не буду приводить данных вот пока оставлю без комментариев так ну наверное все вот это вопросов если больше не дал всем спасибо что что а вы хотели задать спасибо за доклад а вот просто интересно а насколько быстрее вы запустили секунд по сравнению с предыдущим опытом и вот значит смотрите сейчас расскажу от старта разработки то релиза который будет в июле на сейчас расскажу 5 месяцев в первом случае там порядка 11 вот причем здесь функциональности гораздо больше архитектура все-таки сложнее на . по узлам всем спасибо"
}