{
  "video_id": "XNP2fFZcVqk",
  "channel": "HighLoadChannel",
  "title": "Распознавание облаков и теней на спутниковых изображениях / Анатолий Филин (Грамант)",
  "views": 451,
  "duration": 3584,
  "published": "2018-08-16T04:11:27-07:00",
  "text": "здравствуйте меня зовут анатолий я представляю одновременно как бы сижу в двух креслах это разработчика компания grumman и я являюсь сити от директора по технологиям стартапа связанного с ну а гарри тех стартап us связанного с точным сельским хозяйством презентация на английском но не потому что не потому что собственно какие то это понты а потому что во первых мы делаем ее вдвоем с моим коллегой гуру который в индии команда распределенная кто-то находится в бразилии кто-то в штатах кто-то в японии кто-то в индии и естественно языком общения является английский мы готовили эту презентацию вместе это страница заглавной странице нашего сайта чтобы погрузить всех в контекст наш ну стартап которому уже 23 года за основного первая и основная задача которую мы решаем сейчас это борьба с насекомыми в рамках точного земледелия мы боремся с насекомыми мы мониторим насекомых и основной бизнес процесс стоит в том что мы точно знаем где находятся очаги этих насекомых и вместо того чтобы применять ковровую бомбардировку и уничтожать всех сразу мы как бы точно уничтожаем но мы даем возможность помощью наших технологий и моделей развитие насекомых и болезней заложенных в эту систему даем возможность уничтожать точечно экономить на пестицидах на химикатах из и соответственно уменьшать вред наносимый колоде в процессе для того чтобы решить эту задачу используются большие объемы данных из разных источников когда мы начали над этим работал начали работать вот одним из первых источников данных которые мы начали обрабатывать это спутниковое изображение спутниковой картинки мы используем кроме того данную по погоде по модели развития модели развития насекомых мы используем данные с беспилотников и так далее то есть это несколько параллельных конвейеров которые работают на то чтобы решать решать нашу задачу собственно я вот один может быть принято задавать вопросы то есть вот чтобы понимать с кем я имею дело тему нашего доклада как с одной стороны это приложение это это конкретика сельского хозяйства конкретика обработки спутниковых изображений автора это глубокое обучение вот кто из вас каким-то образом связь глубоким обучением и там ну своей жизни написал сетку там вот отлично и кто из вас ну рассматривал жизни там спутниковые изображения какие-то но я имею эту кроме гугла и яндекса естественно вот мы прекрасно значит у нас такая вот смешанная замечательная аудитория вот почему это собственно важно дело в том что в том же google и яндексе а вот мы столкнулись с этой задачей у себя идет нам нужно было наладить организовать конвейер обработке этой спутниковой информации есть сначала десятки тысячи сотни тысяч полей которые принадлежат там десятком землевладельцев фермеров и собственно нужно понять это изображение на этом поле вообще использовать можно если его использовать собственно можно как вот правая поле вот это поле отмеченная левым желтым желтым светом если это а можете чуть-чуть поближе чтобы как бы не распыляться просто народу не так много вот то его использовать можно красное поле она защемлена в данном случае тенями от облаков и вот в этом автоматическом мере там нет людей то есть нам нужно как бы вот для этого гигантского потока котором я еще расскажу спутниковых изображений нам нужно выделить те изображения которые вообще полностью завален и то есть их сразу они сразу выкидываются автоматически если же речь идет о кусочках молитва возможно какие-то а кусочках этих изображений какие-то кусочки использовать можно а какие то нельзя и то есть это все нужно решить автоматически вот после того как если мы если алгоритм решает что о поле использовать можно вот соответственно из него извлекается с помощью разнообразных алгоритмы извлекается разная полезная информация вот в том числе вегетационный индексы вот в том числе заражение насекомыми и болезнями ну и так далее вот в каждый момент времени над собственно наших головой пролетает большое число спутников из всевозможных спутников связанных с мониторингом земной поверхности ремонт сенсинг вот из различных группировок группировки прежде всего американские и европейские ну и как вы думаете есть русский группировка российской группировки есть конечно canopus там еще какие-то в общем есть несколько где-то восемь-девять российских спутник которые тоже занимаются этой проблематики более того более того вот буквально через две недели вы ки будет конференция вход в который был в которые но там с 1000 участников докладчиков которые будут вот целиком специализироваться на на теме ремонт сэнсей и нас интересуют нас интересовали в силу их открытости и в силу их доступности картинки сланца от 8 это самый баланс от 78 это два спутника landsat 7 более старенький из более проблем нас а твой 8 более молодой которые в непрерывном режиме облетают землю и фотографирует ее над каждой точкой земной поверхности от 8 пролетает 1 1 16 дней разве не ну раз 16 дней и дает собственно дает спутниковое изображение которая может быть чистая может быть и зашумленным вот это спутник оборудован несколькими камерами все эти камеры работают в оптическом диапазоне одна из камер на который называется о.л. ой изображено на рисунке это собственно полосы пропускания полосы пропускания спутников все полосы которые нам ну как бы наиболее знакомы это rgb 2-4 полосочки вот эта полосочка значит рдр джипе чуть-чуть разрешение одну вещь я забыл сказать стандартное разрешение ланса от 8 это 30 метров то есть один пиксель дает нам 30-метровый квадратик кроме того там есть черная черно-белая пан храма текну черно-белое изображение черно белая полоса которая дает нам 15 метров и с помощью этой с помощью этой полосы 15 метров мы можем но условно улучшит разрешение и эр джи би то есть получить его тоже там сказать с некоторыми расширениями учить 15 вот ну и полосы отвечающие собственно то что нам интересно за облака есть две полосы полоса вот совсем узенькая девятая полоса и девятая полоса которая отвечает вот чисто за облака то есть она вообще не проходит сказать не отражается от земли отражается от облаков и она актину таскать очень полезно с точки зрения распознавания облаков теперь вот посмотрим на собственно картинки чтобы понять вообще чем мы имеем дело мы используем это рыбе изображение слева над волгоградом почему понятно почему эти квадратики наклонены то есть это реальное изображение сланца то понятно почему они вот не не прямо непрямые квадратики конечно можно было вырезать и повернуть на я не стал этого делать просто потому что лэнс отлетает не по меридиану а эти эти изображения ориентированы севера на юг то есть вот спутник летает по наклонной траектории вот это что касается разрешения 30-30 метров 15 метров и 100 метров для и для термальной полосы то есть это для инфракрасного излучения вот и теперь посмотрим на собственно загрязненность этих картинок облаками и другими артефакты вот разные картинки снятые разные сцены каждая сцена порядка 3 на порог тысяч пикселей на 4000 пикселей то есть это порядка порядка 10 миллионов пикселей и некоторые совершенно чистые эта сцена может быть использована acts какие-то картинки практически как левые в левом нижнем углу и и использовать но практически невозможно какие-то картинки можно использовать только частично теперь что собственно в чем состоит задача задача состоит в том чтобы по каждому пикселю подчеркиваю это очень важно что именно для каждого пикселя нам нужно решить что представляется пиксель это либо чистая карт либо это чистая участок чистый пиксель либо это облако либо это так называемое тонкое облака вот ну финн клауд тонкое облако либо это тень от этого облака в том случае если ну казалось бы тень на ней в принципе какие-то артефакты видны но но те не использовать тоже нельзя потому что основным одним из основных результатов от работы этого конвейера является индекс эндивий индексы вегетационный индекса так называемые и тень полностью искажает значение показатели этих индексов вот ну естественно мы были не первыми кто занимается этой задачи этой занимает и задачи занимается с тех времен как обрабатывают спутниковые изображения если речь идет о ланса ти то американской метеорологическое агентство американская служба г геологической службы там сидят ученые там сидят компьютер компьютер компьютер сайнсез программисты которые пишут собственно обрабатывает эти же самые снимки и естественно мы пришли не на пустое место вот а самым популярным алгоритм который собственно существуют и всеми используя так называемый ритм f mask вот этот алгоритм не имеет ни чего общего но он достаточно традиционно он determine детерминистский вот он не имеет ни чего общего с искусственным интеллектом это просто набор пороговых набор пороговых значений набор эвристик который позволяет про каждый пиксель сказать что это облако это тень этого да это лед это вот там нас в смысле по сельском хозяйстве нас интересует меньше значение в общем случае это больше значения потому что это нужны там рейки ледники океан и так далее тоже определять вот ну я алгоритм в принципе достаточно примитивный за исключением вот этого желтого выделенного подчеркнутого желтым блоком к на который мы сейчас посмотрим это собственно облака не определяются чисто по пороговым значением тут ну как бы проблем нет единственная проблема состоит в том что у каждого спутника о у каждой камеры свои пороговые значения и это довольно мучительное такое вот дело подбирать эти пороговые значения потому что каждое оборудование достаточно специфично вот после того как определены облака тени от этих облаков определяется ну вот собственно вполне детерминистский способом то сделается предположить ну во-первых абсолютно точно известно потому что время каждого снимка абсолютно известно известно расположение солнца известен угол солнце горизонту и делаются какие-то гипотезы о ну собственно высоте вот облачного слоя в принципе этот облачный слой может находиться на одном по наблюдениям митя метеорологов проверяется допустим 3 гипотезы вот и соответственно вычисляется положение облаков кроме того используется еще некоторые соображение связанности то есть если вот собственно 8 пикселей вокруг они условно тень то тогда и центральный пиксель между ними тоже будет тень вот но на самом деле принято вот здесь тоже на слайде проблемы проблемы связанные с маском off mask вполне рабочий алгоритм им пользуется ну практически все то есть все сообщество пользуется этим алгоритмом прекрасное счастливым и его запускали мы с ним работали были проблемы он падал там как бы но в принципе сработать с ним можно дает вполне себе приемлемую точность вот но единственно вот проблема то что он я не определяет тонкий облака в сельском хозяйстве это достаточно важно потому что он ки облака тоже искажает всевозможные индекса которые нам нужны вот но я просто хочу сказать что главной целью почему мы из стали смотреть сторону искусно интелекта в сторону нейронных сетей ну это не совсем проблема с маском с традиционными алгоритмами и это скорее желание применить собственно нейронной сети решить конкретную задачу потому что таких задач в нашем проекте их довольно много это вот первая которая задача которая нам казалось самый простой и а дальше собственно мы начали решать другие задачи это собственно что мы получили я скажу на каком тестовом наборе то есть в принципе неплохая точность на первая строчка это первая строчка это в среднем по болит то есть под на всех сценах какая примерно точность 87 процентов и на сельскохозяйственных и сельскохозяйственных территориях 90 процентов точность определения результат точность распознавания теперь по перейдем к обучению машин к нейронным сетям как отверточные нейронным сетям в принципе если бы речь шла о выделении объектов на изображении я бы вряд ли стал выступать с этой темы здесь ну или где бы то ни было потому что задачи это как бы конечно она интересна и конечно приятно с этим поиграться и получить там автомобильчик или курочку или лошадь на ну поиграться этим очень приятно но дело в том что конкурсы и мощь нет который проводится каждый год ну собственно улучшение каждый год при этом на какие то доли процента вот и и собственно точность распознавания объекта на изображение на целого объект на целом изображение она уже приближается к ста процентам и отличным результатом считается там мы не знаем ну там 0 0 2 процента это вообще гигантский результат достичь улучшения в точности там на какую-то микроскопическую величину вот но наша задача она не она другая она менее это не это не такое перепахано и поле наша задача состоит в по пиксельной классификация совершенно другая задача то есть это не найти там лошадку на изображении это про каждый пиксель про каждый отдельный пиксель сказать что это вот и эта задача оказалась гораздо менее проработана вот начну с чего начинается любое машинное обучение она начинается с чего начинается с тестового набора вот с тестового набора данных и казалось бы это задача нерешаемой а потому что ну карте эти сцены гигантские по 10 миллионов пикселей вот где взять этот мы же не будем сидеть и размечать эти пикселя казалось что такое тестовый набор уже существует на наше счастье оказалось что вот american из с американское геологическое агентство уже подготовила набор из 90 из 96 сцен покрывающих разные совершенно города реки океан и сельскохозяйственные земли 96 цен и разметила каждый пиксель это какая-то нечеловеческая работа видимо там было задействовано там сотни людей как они это делали мы не знаем студентов посадили или кто это делал как но это сделано про каждый пиксель известно одно из собственно 5 значений 0 циферка ноль это какой-то сбой оборудование все остальные это вот значение которое нас интересует из этих сцен 96 12 относятся чисток это сельскохозяйственной сцена это поля поля и луга то есть в принципе вполне устраивающей нас картинки вот ну и дальше собственно вот речь пойдет о уже о том что мы сделали как мы сделали и собственно методологии вот то что мы получаем это результат каких-то довольно большого числа проб и ошибок то есть параметры которые мы подобрали мы подобрали в результате достаточно долгого тюнинга но никакой там условно гигантской науки там нет это просто вот такая ну месяцев шесть мы на это потратили на то чтобы подобрано то чтобы построить правильную сетку на то чтобы подобрать параметры на то чтобы данные подготовить надлежащим образом вот берем то есть нам нужно вот этот красненький пиксель красненький пиксель определить собственно какому классу он относится мы вокруг каждого пикселя берем патч в данном случае ну то есть не в данном в нашем случае мы взяли 31 на 31 некая эвристик а вокруг этого конечно есть потому что один пиксель лан сайте это 30 метров 30 30 на 30 это километр ну вот то есть ну примерно глядя на мы рассматривали гигантское число картинок собственно из нашей базы из ланса тарских land ну лан татарских картинок и смотрели ориентируясь на то собственно главные вещи стоит а как бы мы распознали вот чтобы мы решили про этот артефакт на картинке как бы мы его определили вот мы их юмон то есть мы люди значит оба облака это тень что это и мы сочли глядя на эти картинки что километр на километр это примерно вот тот контекст который достаточен вот все что больше километра уже не дает никакой содержательной информации про этот центральный пиксель ну и соответственно задача состоит в том что вот построить вот вот такую сетку на вход посылается пиксель на выходе один из четырех классов вот на входе причем надо понимать здесь нарисована на самом деле это не полосы это просто картинки в нашем случае это те самые вот 8 полос которые несут какую-то содержать мою информацию 8 полос которые несут информацию о возможности вот облака тени или чистого чистой поверхности 8 полос из набора полос ланса то ну и дальше мы стали думать о собственно вот что делать такую есть огромное количество литературы по свёрточная нейронная сетям и всем кто занимался ими вот видели наверняка вот эту сетку или похожие сетки которые состоит из последовательности свёрточная уровней по размешанных там среду с какими с прореживанием и так далее да и в принципе мы пробовали эти сетки но то есть тупо просто пропускали вот ну как бы какие-то результаты мы получали эти результаты не доходили до точности off mask а вот дальше мы стали изучать литературу потому что принципе изобретать велосипед то есть мы для нас это не наука для нас это практика и нам нужно было решить практическую задачу оказалось что наиболее ну похоже или проработанной задачей является медицинское задач то есть принципе есть несколько публикаций на тему определение на тему классификации опухолей головного мозга и более того там даже проводятся конкурсы небольшие не такого масштаба как и мужчина проводит свои конкурсы есть своя тестовая база есть где-то учету ученые специалисты на стыке компьютер сайнс и медицина которые вот этой проблематикой занимаются и вот они в одной из статей мы нашли вот такую замечательную схемку то есть эта сетка главное соль всего собственную вот архитектура это стив в том что она не линейная а в этой сети в этой сеточки мы видим две ветви одна ветвь отвечает к одной ветви применяется звездочка 7 на 7 другой 13 на 13 то есть в одной используется локальный контекст в одной ветке идет как бы выделение локальных признаков а по другой идет выделение более таскать крупных признаков и оказалось вот эти ребята вот так сказать они выигрывали какие-то конкурсы вот в своей распознавание в классификации раковых ну и других опухолей головного мозга но мы взяли это на вооружение вот и собственно на основе этой идеи построили свою сеточку собственно очень близкую по архитектуре мы в качестве локального контекста взяли 5 на 5 в качестве глобального мы взяли по нижней ветке по нижней ветке идет 11 на 11 окошечко ползет вот количество признаков ну мы подбирали да то есть вот чтобы не чтобы с одной стороны их было не слишком мало но с другой стороны не слишком много чтобы не переобучить сетку вот потом мы эти две ветви сливаем получаем из них 4 признака вот и соответственно но с применением носов макс дает нам вероятность принадлежности этого пикселя к одному из четырех классов вот ну собственно это как бы вот идеи до то есть оказалось что сходу и это идеи нам не дала точность она дала там близко 80 чем-то процентов но она не дала нам вот прям вот такой вот точность которые могли бы гордиться и сказать что мы побили ну победили детерминизм алгоритмы вот дальше прошел вот такой вот тюнинг стали думать о что и как можно улучшить вот одним из очевидных улучшения казалось да как мы выбираем по как мы выбираем а и патчи для обучения сначала мы выбирали их случайным образом в принципе не за мной просто вот есть 12 стенда мы словно случайным образом китаем монетку выбираем сцену оказалось потом глядя глядя вот на эти патчи выяснилось что но у giga гигантское большинство вот этих патчи при случайном при выборе их случайным образом они просто не несут некую информацию то есть они либо они целиком облако либо это тень либо это чистая поверхность то есть они как бы никаких граничных эффектов там нет и вот собственно поняли ну поняли что нужно делать по-другому тогда мы в тренинговую выборку стали обязательно замешивать как минимум четверть четверть собственно патчей замешивать смешанных то есть эти смешаны в том смысле что причем это естественно все дело делается автоматически как минимум 20 процентов пикселей из этих 31 на 31 они должны отличаться от центрального пикселя которые собственно мы классифицируем вот это как бы просто я проиллюстрирую в чем идея собственно вот это у нас совершенно однородный участок снимка вот это однородный участок снимка с облаком эту с тенью вот а нам собственно хочется вот такие участочки побольше которые находятся на границе на границе облака и в данном случае облака и тени либо на границе облака и чистый ну чистого снимка либо на но там может быть не очень хорошо видны это тонкие облака то есть на границе тонких облаков и чистого изображения вот нам бы хотелось побольше вот вот таких кусочков чтобы они не шли каждый из этих каждый из этих подчинён максимум информации вот это это как бы стандартная разбивка вот это количество собственно ну вот на чем мы тренируем сеточку вот 440 тысяч вот оказалось что опять же вот когда мы это сделали полную шила наши результаты то есть но вот собственно при при processing можно сказать вот но опять же не дало нас удовлетворены мы думали дальше оказалась интересная вещь то есть мы сами не метеорологи то есть мы смотрим на картинке смотрим как другие люди делают вот но каких то хитростей мы стали собственно только в процессе вот вот в этот работа где-то мы поняли что вот эти полосы ланса то это так называемый день digital нам барс какие-то цифирки они на самом деле это искаженное изображение земной повести потому что лучше ну луч проходит от солнца он проходит сквозь атмосферу отражается от земной поверхности опять проходит через атмосферу в этот все это вызывает искажение распыление этого изображения результате получается вот такое за шум лена и такое как бы задымлённая задымлённая картинка вот а для того чтобы увидеть какую-то такую чистую картин который мы привыкли применяется так называемая то поэтому сверка конверт это совершенно простая линейная вещь то есть каждому пикселю прям применяется некое преобразование в зависимости от полосы пропускания от угла солнца в данный момент времени от угла солнца к земной провести так далее и вот оказалось что вот-вот после этого преобразования вот вот последний шаг то есть вот было несколько шагов то есть мы дали замешивать вот эти пограничные после сделали тупого атмосфер топов атмосфер correction и после этого как бы наши результаты уже за играли вот собственно как это выглядит то есть вот мы пропускаем картинку через наш через нашу сеточку на выходе получается вот по пиксельная классификация разбиение картинки на четыре класса вот ну это дальше мы собственно стали смотреть после того как мы получили результаты начали нас радовать мы стали собственно изучать а что что собственно мы получили какую точность мы получили где у нас какие где мы ошибаемся в чем мы ошибаемся вот стали рисовать вот такие картинки про каждую точку если мы ее собственно правильно распознали мы ее помечаем соответствующим цветом если мы ее мы ошиблись мы можем ошибиться в ту или другую сторону то есть мы можем либо сказать что на месте на месте чистой поверхности мы можем сказать что это облако или наоборот если это яблок и мы можем упустить это облако собственно это два разных результата и получается вот мы долго изучали вот подобные картинки смотрели где мы ошибаемся вот оказалось что на самом деле в некоторых случаях алгоритм ну собственно нейронная сетка нашла ошибки операторов то есть мы не знаем кто размечал это делали студенты или может быть они были насколько они были мотивированы трезвые и так далее но например мы нашли вот такой артефакт слева мы видим явную тень вот а справа мы видим что этот на на изображение из размечена вот геологически младенцев она размечена как чистый пикси как чистый пикс как циона видимо они решили что это ну там озеро например вот ну естественно были есть достаточно большое число ситуации когда наоборот наш алгоритм ошибается например он нас не очень интересует города не очень тяжело тем не менее мы посмотрели что над городами вот города наш алгоритм классифицировал как как облака кроме того вот так такие интересные вещи то есть реки на самом деле мы не обучались над реками вот но но реки он классифицирует как тени ну и теперь вот собственно основная картинка то есть основные циферки 90 процентов мы видели мы все сравниваем яблоки с яблоками вот то есть это все сельскохозяйственные бесконечно района то есть это одни и те же одни и те же сцены читов mazda 90 процентов без то и без замешивания вот этих вот ухищрений при процессинга мы получили 84 процента вот то на 1 на линейной сеточки дало нам 92 процента и мы получили вот такой результат 95 94 почти 95 процентов мы получили на собственно вот финальный на той конфигурации которая нас удовлетворил то есть это смотрите то есть оказалось что до этого до вот этого проекта до этого проекта мы конечно разработчики у нас есть агрономов в команде у нас есть специалисты все ну во всех релевантных областях но мы не занимаемся машинном обучении мы не занимались нейронными сетями нам просто важно было времени во первых научиться самим во вторых показать что практические задачи вот могут быть что порог входа не такой гигантский что он и что не надо бояться задач машина учения надо туда объезжать ее и применять и применять эти методы на 5 процентов 4 целых восемьдесят процентов гигантской оцифровали я говорю там идет борьба за ноль ноль ноль один процент вот поэтому то что вот такой малой кровью конечно мы тоже такой малой кровью мы собственно достигли достаточно плохой результат это говорит о том что бояться не надо нужно собственно брать практически задачи если они хоть как-то напоминает задачи решаемые естественном интеллектом брать и соответственно применять их применять и нейронные сетки и другие методы машинного обучения как решение этих задач ну сожалению performance с точки зрения я выступаю на конец колод в этот этап мне достаточно стыдно сказать ну вот этот результат показать но действительно сцена одна сцена off mask собственно дает две-три минуты на наша сетка занимает прогон одной сцены там порядка двух часов но я хочу сказать что ни секунды мы пока не посвятили оптимизации ни секунды палец о палец не ударили то есть мы понимаем где там проблемы мы понимаем что это не проблем с алгоритмом это проблемы мы знаем где узкое место мы имеем эти узкие места расшивать то есть это узкое место с данными просто данное дергается с диска сказать большое количество раз мы просто этим не занимались вот теперь ну это как бы несколько отдельно стоящей слайд вот но смотрите нам мы после того как мы получили вот собственно эти результаты мы нас осенило смотрите вот эти операторы которые размещали тестовые изображения они же имели наверняка дело не с восьмью полосами потому что на этих восьми полосах вообще не разглядеть что-то вообще невозможно вот имеет смысл только rtb скорее всего они смотрели просто на очищенные рыбе изображение скорее всего мы не знаем как они работали вот а мы имеем дело с восьмью полосами то есть мы вот все эти тянем за собой все эти полосы все эти мир то есть мир infrared far infrared зачем мы это делаем мы можем сэкономить обрубить эти полосы и поскольку обучение это шло на эр джи би то скорее всего мы получим результаты которые не хуже вот как вы думаете вот кто думает что результат будет такое же кто думает что результат если обрубить вот эти пять полос кто думает что результат будет лучше хуже вот вы думает что лучше результат будет хуже кто думает что лучше лучше ну или такой же да если обрубить лучше вот лучше да ну вот то есть получается что результат будет хуже хуже а все-таки не один человек хорошо но примерно половина на половину разделилась да вот получилось как ни странно такая вот грубо интуиция какая-то вот такая вот она подводит иногда вот в мире неровностей и действительно результат получился вот такой вот как низами нас это тоже удивило мы не знали какой будет ответ а значит мы вместо 8 полос вот стали обучать на трех полосах и сразу верну как бы результат результат ухудшился на 6,7 процента до но и мы убрали эту информацию но человеческие а пятно оператор if you man appears to the и операторы которые размещали они же не использовали те полосы в свои разметки то есть они смотрели на ртп и для тренинга мы используем ну смысле мы использовали размечены свами папик сильно размечены этими операторами то есть казалось бы там нет информации в тестовом в тренинговом наборе нет информации об этих ну вот вот вот вот вот вот абсолютно правильно да но это то на чем мы собственно использовали здесь ничего такого нестандартного нет вот обучались на титане вот питон tensorflow theres в общем вот собственно я с этим проектом я закончил и поскольку мы продолжаем вот разнообразны постоянно возникают задачи связано с машинным обучением вот две задачи которые но одна задача собственно простая поскольку эта классификация классификация болезней классификации насекомых вот мы умеем научились собственно это делать и и в изображениях и видео то есть идут по полю словно базовый сценарий пример такой идет по полю человек который мониторит насекомых и болезней с мобильным телефоном вот он делает либо фотографии либо виде снимает вот и соответственно ему выпадает списочек ну там не из одного из двух трех четырех наиболее похожи на 7-ом этаже списка насекомых он гигантский там может быть 200 человек просто не смог ну там достаточно люди ходят не агронома ходит искать низкооплачиваемым персонал поэтому они не знают они не могут и плетя из двух-трех он может выбрать вот наиболее подходящие насекомые тыкай туда пальчиком вот а вторая задача не решена эта задача очень актуальная и она на самом деле очень серьезно задача и очень полезные и решение бы принесло сэкономил гигантские миллиарды вот во многих областях это летает спутник ланс от который пролетает над земной поверхностью раз в две недели и снимает фотография высок точно 30 30 метров на пиксель вот и летает спутники с modis это другая это другая группировка спутников вот оно пролетает над каждым часом например раз в день но уже размер пикселя там сказать вот бесплано завтрака не бывает то есть размер пикселя один километр то есть разрешение совершенно на котором ничего не видно да вот так вот задача состоит в том чтобы сблизить эти вот эти потоки изображения то есть в идеале получить получить высокоточная получить картинки с высоким разрешением и с частотой с максимальной частотой и есть гипотеза что такую задачу тоже можно решить с помощью обучение рон их сети но нам ее пока решить не удалось но собственно вот цель доклада было показать что вполне себе конкретную практическую и очень актуальную задачу можно решить если она похожа на то собственно что на то что решает человек на те задачи которые решают человек мы это сделали гуру его фотографии это мой коллега которые она находится в индии вот мы собственно вместе с ним занимались этой работой спасибо большое можно вопросов такой вот не могли бы на слайд и руди архитектура нейронной сети и обучения там папочками сейчас секунду о ее я соскочил с презентации так как ну ладно и могут ок да давайте посмотрите вот вы на вход подаете по каждому пикселю то можно вернуть презентацию как-то нет потому что она здесь то есть там ее нет то есть она вот как вы сейчас мы прокрутим вот смотрите как я если я вас правильно понял то получается каждому пикселю соответствует значение меткам правильно каждому при классификации дано ему нужно поставить одно из но одно значение 4 классов тогда мне вот вопрос от вас нейронная сеть сейчас еще там три слайда форму вперед и побольше на так и пищевода то вот это смотрите вы получается подаете патч 3131 про не понимаем а на выходе у вас получается софт max 4 значения до него дела в общем что по походу там еще вот в конце во первых там есть да в чем вопрос собственно то я просто не могу понять но по идее то есть вы подаете на вход 30 тендер 30 на 31 должны на выходе получить быть ребенка только чтобы мои колени сшивается ну дело в том что в по ходу по ходу сети размерность уменьшается то есть мы задаем мы задаем карты признаков на каждом этапе и задаем собственно как она прореживание уровне связанные с прореживанием вот это есть в результате мы получаем то есть последние карты признаков это размерности 4 это понимать это понятно вопрос смотрите какой в какой точке камера у вас есть и пикселей 1 к 1 метки относится это понятная вы же говорит нам нужно выбрали 25 процентов единиц смотрите на вход на вход то есть нам нужно вот здесь речь идет о классификации одного пикселя одного пикселя поступает куб или параллелепипед правильный состоящий из 8 слоев в каждом каждый слой это 31 на 31 значит дальше по верхней ветке мы пускаем на него окошечко окошечко пять на пять которое должно нам получить должно нам дать 96 карт признаков размера 24 на 24 по нижней мы пускаем окошечко 11 на читы на 11 на 11 которая дает при этом мы мы мы делаем 190 190 наш таскать наши права сколько хотим столько и выбираем 192 в результате получается 192 фичи maps размерности 21 на 21 мы так далее то есть мы то есть это тут как бы все достаточно стандартно и но речь именно идет о том что это для каждого пикселя нам нужно собственно про то есть для каждого пикселя мы пускаем на вход inference момент inference то есть в момент прямого прохода мы пускаем вот этот патч размер 31 на 31 на 8 в результате получаем ну если если хотите мы можем да да да порол да так еще какие-то да пожалуйста латали немного вам помогу пиксель измеряется именно берется . . вот это вот картинки по горизонтали и вертикали то что мы классифицируем этот один а может вы об этом был вопрос спасибо за помощь да как вы пограничные пиксели определяете те которые 00 где смотрите пограничные пикселем и от как бы мы их для для целей так скажем нашего обучения мы их выкидываем то есть граница здание на самом деле мы понимаем что нет это понятно что эти пограничные пикселей их можно условно можно расширять эту полосу пограничными пикселями то есть это один из методов есть несколько методов как ты дел можно усреднять можно там много делать но наша задача была пока в общем то доказать собственно такой большой пруфов концов в принципе это не сложно то есть ну например один из способов мы можем смотри там сколько 31 значит 15 расширить эту полосу на 15 пикселей продублировать пограничные пиксели наружу почему бросили есть оба положительны и есть 230 тыс мы могли свою систему лучше развития вы имеете ввиду вот эту картинку а вы имеете ввиду то есть почему мы ели тиват вы говорили что будет если мы отбросим столько-то канала то есть все ухудшилось ухудшилось потому что есть спасающая классификация человека и вашего алгоритма да не совпадающие ну да изучить не совпадающие то вы могли бы эти ошибки тоже как бы учитывать то есть у чуть дальше проедем и повысили свою точность но интересный гость хорошо ладно мы подумаем над этим спасибо ишида может быть да то есть поиграться именно с тем что собственно ну maver мы точно не знаем как размечаю как каким лгать ног в смысле как размечали оператором это наша гипотеза что они использовали рыбе но в принципе то есть если вот четко зафиксировать что они использовали rgb и дальше смотреть где алгоритм ошибается где нет то наверное со из этого можно извлечь информацию спасибо еще есть пожалуйста и мы нет мы не трогали datasette нет мы просто смотрели на результаты datasette мы ну нет это такая достаточно во-первых тяжелая задача мы нашли далеко не все как бы ошибки человеческим и просто вот то что бросилось мы не занимаемся этим специально мы как бы вот увидели увидели явные ошибки скорее всего там больше мелких ошибок которые мы специальные концентрировались так что нет мы исправлять тестовые ну как бы тренинговые дано вообще не благородное дело ну как бы все таки этот этот то есть мы дело в том что это вот дикий эталонные набор на котором люди во всем мире проверяют свои алгоритмы поэтому not мне кажется не очень правильно его как-то трогать хотя можно попробовать мы для этого тоже большая работа но вот там 12 изображений по 10 миллионов пикселей в принципе довольно тяжело то есть там перри разметить его а передать туда да кстати вы тоже об этом бы принести пользу человечеству и ну вот да нет сообщества которое вот именно это слишком частной задача но передать туда в агентстве я согласен да каждые 16 не одни и те же спутник пролетает ну с точностью там до полу пикселя он пролетает над одним и тем же участков земной поверхности каждые 16 дней и соответственно снимки покрывают ну вот одну и ту же зону но единственное что надо понимать что за в сельскохозяйственном если вопрос вот про это я правильно понял да да да да это очень хороший вопрос и конечно мои дамы вы собственно вот думали как бы что там можно как-то subtilis можно ли так мы дело в том что с известных районах все очень быстро меняется вот то есть там скосили ну условно урожай или посадили или вспахали или полили и через две недели там будет совсем другая картина пожалуйста добрый вечер такой вопрос я может показаться глупым потому что я очень далек от машинного обучения собственно у вас стояла проблема в том что сложно найти обучающую выборку чтобы точно совпадало что вот этот бисер это облако одна тень ну на реальных данных а скажите а можно ли искусственно создать обучающую выборку то есть допустим взять изображение на котором мы чисто поле без облаков известно наложить что ну тут есть я да спасибо вопрос понятен тут есть ну во первых у нас к счастью ну проблема с тестовыми данные все-таки решено то есть вот есть сцены 96 цен которая размечена честно но мы с ошибками но честно размечены дальше можно ли сделать искусственным на самом деле вот есть способ который вы предложили скорее всего алгоритм машинного будь то есть вы будете накладывать эти облака и тени и еще что-то с помощью какого-то алгоритма вот и вот этот алгоритм машинного обучения который будет обучаться на этих данных он вышли он как бы пойми ну поймет этот алгоритм то есть он и в дальнейшем он будет идеально распознавать облака и тени который сгенерированы вот этим же самым алгоритмом вот это вот но есть и другой способ которые собственно мы думали об этом просто сгенерить собственно тем же там с маском то есть маска который дает 90 процентов принципе но зашумить его возможны как то есть есть возможность какая-то вот разметить изображения там традиционными а горит старыми алгоритмами которые дают там хуже по грешно в принципе даёт но опять же с этим тоже вот есть те же самые проблемы потому что он научится и он станет работать точно также как алгоритмов маска то есть вот машинное обучение работает таким образом ну похоже не да пожалуйста сейчас еще есть один вопрос можно ст-1 секунд честно сказать по моему это метод не классификации а кластеризации быть точнее вот классификация это когда мы знаем уже пиксели к чему они относятся кластеризация это определение пикселя хорошо то есть да то есть хорошо можем назвать и не ну то есть но обычно все-таки кластеризации кластеризации да ну сегодня это была проблема ну хорошо спасибо за комментарий похоже все исчерпали ура"
}