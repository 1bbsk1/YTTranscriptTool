{
  "video_id": "IjfiDQvn2Mw",
  "channel": "HighLoadChannel",
  "title": "Как поддерживать и развивать пачку \"похожих\" проектов / Стас Михальский (Mail.ru)",
  "views": 847,
  "duration": 3525,
  "published": "2017-04-22T14:48:25-07:00",
  "text": "давайте начинать меня зовут стас михайлов и сегодня я хочу поговорить про опыт с точки зрения владельца кода то есть человек отвечающего за разработку опыт работы с несколькими проектами продуктами идентичными между собой вот это вот неполный мой послужной список конечно но здесь выписан опыт релевантные к сегодняшней теме начал я разрабатывать первый новостной продукт информационной еще в рыбака это был 98 год потом я в рамблере сначала разрабатывал сам там несколько продуктов включая новости потом возглавил команду разработки вы в mail.ru я продолжил примерно в этом же духе все это в общем и целом 15 лет поэтому у меня было время съесть на этом пару собак и сейчас я хочу про это поделиться собственно информационный или контент на и как называет их за кулисами проекта это проект она наверное понятно такая история да это там новости какие тематические не знаю там авто mail.ru вот у нас есть леди там их много разных разных с точки зрения продукта разных с точки зрения аудитории но с точки зрения сути они вроде бы довольно похоже вот это просто несколько слайдов для понимания до новости mail.ru хай-тек mail.ru мы видим везде примерно одну сетку везде обязательно с картинки заголовки какие-то листинге вот это раздел новости политика недалеко ушли да вот эта леди и авто ну прямо вот нет причем проекта разные там разные аудитории все хорошо но визуально прямо возникает ощущение что это практически один продукт потому что везде есть какая-то страница новости везде есть листинге везде есть блоки читайте также там смотрите ещё топ новости какие то везде есть несколько опять же типовых дополнительных сервисов там комментарии допустим какие то каталоге дополнительные информационные но это все равно выглядит как кубики до кубики из одного конструктора в этом консультации админке опять же ну плюс минус все довольно похоже вот у кого есть ощущение что все информационные проекты можно сделать одним одним проектом взять все перевести на один движок и чо серьезно и такой один такой смелый был дан вот вижу рук не так много но вот почти одно и то же это выглядит вот так вот да вот чуть-чуть разные но в какой-то момент меня начало блевать вопрос наверное это совпало по времени с тем как я стал руководителем группы и получил власть над управлением вот всеми этими проектами у меня возникло желание сделать это примерно вот так вот ну вот зачем держать 10 копий плюс-минус одного и того же кода когда можно поднапрячься собрать это все в единую архитектуру и дальше уже на уровне шаблонов клепать эти информационные проекты хоть для рыбок рыболовов хоть для не знаю там автогонщиков да все равно это и есть тема сегодняшнего доклада цель доклада обсудить перспективы вот этой вот тотальная унификация и поговорить об альтернативах потому что них поговорить надо собственно как только я ощутил в груди жгучее желание объединить все проект в 1 ну вы понимаете что идея для человек тихо технического в принципе вот правильное решение но очевидно да мы берем все эти проекты мы их унифицирует мы их переводим на одну платформу и после этого мы с этой одной платформой работаем как с единым техническим решением поддерживаем его развиваем и вот опять же попытайся представить но перспективы вот меня кого завораживает перспектива одного технического решения на все по-моему это да они действительно ну прямо захватывают дух там можно править баг в одном месте он сразу исчезает со всех наших сайтов можно поставить какой-нибудь там best practices внутри движка чайники встроить это опять же работает на всех сайтах у нас для менеджер службы единого окна он пришёл в одно место поставил task бац и в итоге там лучшая практика с точки зрения продукта не знаю там какой нет ранжирование она опять же на всех проектах тестируем и все это вместе если мы захотим сделать еще один такой проект то мы не будем овечку долли клонировать да вот взяли проект по movie ли мы скопировали и давай там подкручивать шаблоны мы просто и потом эти шаблоны еще поддерживать отдельно да мы просто возьмем и на едином решении сделаем еще один сет шаблонов там и правил через конфиги ну и естественно на поддержку всего этого будет уходить мало времени меньше чем сейчас сейчас у меня на каждом проекте там 12 человек а это значит что у нас огромное количество времени освободиться под другую работу в общем это было это желание во мне прям окрепла сейчас я бы назвал эту эта идея метафору кластера вот в данном случае кластеры конгломерат я использую не как прямые определения а все-таки как некоторую аналогию то есть если мы возьмем все проекты плюс-минус сведем их к единому мы получим нечто единое общее это можно назвать класс star system класс там дальше так буду это называть чтобы ну ссылаться не повторяться каждый раз так вот когда первый раз это задумал я решил что я за пару недель вечерами возьму пару проектов и быстренько там методы все сведу к единым образу и подобию то есть буду иметь одну коллекцию методов дальше внедрение в эти же оба проекта и таким образом сделаю первый шаг первый такой кирпич доложу в этой системе кластер но как вы понимаете если бы меня получилось прямо тогда я бы сейчас не стоял да потому что все оказалось но чуть-чуть не так как ник как я предполагал во-первых выяснилось что один и тот же результат может следствием совершенно разных процессов но допустим те же новости ну даже rambler это был агрегатор то есть мы скачивали вы огромное количество новостей со сми сайтов сми и редакция сделано потоки эти новости выбирала определяло какие из них важны и какие не важны а в большинстве других контентных проектов там было мало новостей было больше статей и там редакция писала эти материалы руками в итоге на сайте могут приходим смотрим на продукт и там и там вот эти вот новости заголовки там до картиночки только в одном случае за этим скрывается там очередь загрузки и прям отдельный механизм который обновляет вот этот поток для агрегатора а в другом случае там такая хитрая админка с кучей всяких красивости стилей и так далее хотя визуальный результат один и тот же во вторых выяснилось что один тоже одна и та же функциональность она может быть реализовано по разному не потому что у авторов так сказать перпендикулярное видение а потому что это обусловлено реалиями проекта ну опять же новости mail.ru там их слишком много чтобы хранить все в одной таблице и мы там используем довольно хитрый систему ни на одном другом проекте нашим этого не требуется но и было бы глупо держать точно такое же решение для там относительно небольшого с точки зрения информационного наполнения проекта леди или другой вариант у нас был такую довольно хороший движок форума в самописный и вдруг выяснилось что на одном из проектов менеджер категорически против анонима в любом виде иначе там 1 га разгоне тусовочка уютно чатик там и так далее и нам пришлось в некоторых случаях просто писать дополнительно держать дополнительный набор сценариев чтобы это все работало без анонима то есть нам не удалось взять этом одним флагом типа ok аноним лаги нельзя там если нет пришлось местами дублировать сценарий ну и в третьих вот мы видели сейчас 5 слайдов очень похожих друг на друга с проектами да вот одно и то же отображение 3 заголовка допустим это может быть совершенно разная логика это могут быть главные новости могут быть свежие новости о могут быть новости по теме то есть за вот этой вот вроде бы похожестью внутри там целый лес и еще маленькая роща а главное что вот это важный момент как только мы доходим до попыток унифицировать логику потому что логика же в боках может различаться не только потому что она нужна там разная а просто один блок писали год назад другую страничку делали там месяц назад чуть-чуть разное видение иногда логику можно свести к одной но здесь это уже не техническая задача не совсем техническая здесь требуется уже согласование с менеджментом то есть задача по унификации проекта из техническая превращается к ней добавляется еще коммуникационная иммиграционная задача оно само по себе ну как вы понимаете ну требует отдельных и навыков и сил и времени в общем с первого раза все прямо так вот не получилось много работы и блицкриг захлебнулся понятно что вообще-то задачами на одного человека домнина стратига это задача в любом случае на всю техническую команду то есть людей нужно вовлекать единственная хорошая новость разработчики по моему опыту вот в такие идеи вовлекаются очень хорошо потому что они в это верят это перспективно так сказать и вообще если у нас получится то наши имена будут вписаны в историю но как я уже говорил и требуется большое количество на самом деле решение менеджерских поэтому нужно вовлекать менеджмент менеджмент ну тоже казалось бы хорошая новость хотя под вопросом менеджмента же вовлекается но потому что мышь там обещали и снижение ресурсов и простоту понятность единственное что менеджмент начинает торговаться естественно он не просто говорит окей делай мне это он спрашивает а сколько тебе на это надо большим это отдельный пласт работы с менеджментом торговли и и так далее ну и стало понятно что решение такого масштаба я в рамках переделки такой вот замены по методу внутри одного сайта или 2 я не сделаю поэтому я решил что следующий подход мы уже будем строить такой фреймворк скажем так стороне отдельно и потом будем на него переводить проекты это был была вторая часть марлезонского балета мы решили подумать собрать требования и сделать все по-человечески но вот насчет сбора требования это тоже отдельная смешная тема потому что пока как собирать подходишь к менеджеры расскажи мне как устроен твой проект до проекта пять лет его писали уже 3 разработчика и это 4 менеджер на нем нокии 2 как вы понимаете менеджер это из головы не выгрузит никак поэтому сбор требований на русский переводится как анализ кода а это но можете себе представить к тому же надо учитывать что вот до недавнего времени кстати у кого сейчас полностью данные разведены с шаблонами вот мы целый год живём представляете у нас сейчас отдельно готовятся данные а в шаблон и выставляются как в трафарет ну вот это будет случилось недавно а до этого у нас естественным шаблонах было дофига логике поэтому вот этот вот сбор требований шаблонах в модулях это конечно же болото и туда уходит дикое количество ресурсов причем на первый взгляд без результатов самое нехорошие что у нас из этого болота иногда еще за уши вытаскивают потому что оказывается мы должны еще развивать продукт оказываются у нас релизы оказываются у нас рынок конкуренты не дремлют и последствия этого очевидно как в любом в любом процессе отвлечения стоит денег да если нас оторвать от написания да мы потом вернемся и потратил некоторое время на восстановление хотя бы настроение соответственно когда мы после очередного релиза и так через месяц-два возвращаемся к нашей нетленки мы уже половину забыли половина половину кода не узнаём вообще кто это писал там уже что-то поменялось то есть на самом деле оставлять вот такую задачу без присмотра это довольно дорого то есть мы фактически откатываемся мы делаем шаг назад и нам приходится там наверстывать ну и главное что без какого-либо видимого материала это все начинает терять смысл без видимого результата поэтому следующие выводы вот так вот помыкавшись помыкавшись я понял что писать что бессмысленно то есть вот это вот построение зиккурата где-то в стороне не работает и более того команда начинаете мотивируется да и я сам ну потому что мы что-то делаем мы видим какие-то правильные классы но мы еще не видим ни одного применения продуктового это печально поэтому для того чтобы поднять боевой дух нужно хоть какое-то физическое свидетельство того что ну мы мы идем по правильному пути ну хотя бы чудо какой не не знаю и она чуть позже случилось поэтому я слегка умерил амбиции я не отказался но я затаился я решил что нужно попробовать это на каком-нибудь таком но чуть более лёгком примере и начал ждать подходящие кошки к тому моменту я уже оказался в mail.ru и мне повезло кошка случилось mail.ru лет 5 назад может быть чуть больше начала помимо баннеров продавать еще спецпроекты спецпроекта такой маленький сайт зеленый как правило к какому-то нашему видео проекту едем mail.ru там было уход ко всякой уходовые средства косметические на здоровье mail.ru ну понятно всякие через скалы вещества всякие лекарства продавали вот и соответственно но делается маленький сайт делается он в дизайне такому совмещенном дизайне заказчика и в дизайне нашего проекта донора мы на проекте доноры размещаем ссылки на этот сайт погоним туда трафик это все продается пакетом и собственно вот таких вот список проектов в месяц мы иногда делали штук по 10-15 спецпроекты это маленькие сайты на которых есть какое-то количество статей и там какой-то дополнительный функционал типа конкурса фотографий опросников чего-то такого в общем ситуация похоже но такая ограниченная и по времени и по размерам поэтому вот здесь мне удалось применить некоторую унификацию мы назвали это муравейником это фактически была одна инкарнация фреймворка одна база один там сервер там были соответственно диспетчеры для того чтобы подтаскивать шаблоны и был беспечен к базе данных то есть из кода проекта мы обращались к просто кбд а диспетчер нам подсовывал соответствующий набор таблиц то есть базе на самом деле было много баз на так условно ну и в дополнение ко всему movie ли там уровень абстракции плагинов куда загнали все вот эти вот фотоконкурсы вопросы и прочее то есть это были модули которым можно было обращаться и спецпроекта но они были скорее внутри фреймворка в общем эта штука нам сильно помогла она действительно выглядела пахло и было похоже на некоторые унифицированные нам на некоторый вот кластер и это дало некоторые запал может быть и зря но вот тогда я так посмотрел скала блин а она работает более того она подтверждает основные идеи что вот вот эти вещи унифицирует а вот эти вещи можно вынести в общем вначале все оказалось неплохо но стало понятно следующее что все таки нужен какой-то компромисс то есть в отрыве от продуктовых задача работать не получается в рамках продуктовой задачи получается хорошо более того ну вот мой первый спецпроект мы делали его раза в три-четыре дольше чем надо было но по понятным причинам мы в рамках этого спецпроекта строили весь вот этот класс стр муравейник вот поэтому вернуться к задаче унификации больших проектов в наших боевых я смогу но только в случае удачного повода и таким поводом стал очередной редизайн вообще у нас там раз в два-три года каждый проект он переосмысливается там и дизайн рефакторинг в общем эта работа на 3 плюс месяца и в это время казалось бы можно почувствать и сделать все по-человечески таких попыток было ни одна то есть вот здесь я под разными углами подходила к вопросам набрал определенный опыт такой сводный первое что как бы бросается в глаза то что я почувствовал на получил уже в при первой же попытке это то что начинаем там и за здравие заканчиваем за упокой да потому что сначала пока рисует дизайн пока согласовывает функциональность мы красиво пилим там внутри структуру делаем абстракции всякие объекты класса красивые потом потихонечку время подходит уже поближе к запуску количества требований и задач растет а не падает и у нас темп разработки естественным образом меняется в общем под конец мы обещаем себе честно вернуться и вот все это сделать по-человечески но как под конец мы начинаем потихонечку костыли ну чтож греха таить плюс ко второму третьему разу система все-таки начала разрастаться из-за альтернативных решений вот как я говорил там разные сценарии да из-за того что разные экосистемы проектов то есть на самом деле уже стало понятно что у нас все равно не будет такого что там 95 процентов кода функциональности нашего вот этого кластера единой системы будет использована всех проектах на самом деле уже стало понятно что там будет некоторые что-то здесь что-то там и конечно же на вот это вот доделать правильно вернуться и все поправить времени меньше чем мы хотели бы поэтому это не то что совсем нельзя делать ну там такая получается внутренняя жестокая конкуренция то есть я сам вынужден определить какую из важных системных задач и мы выкинем а какую сделаем это больно но как бы что делать самый интересный момент который я скажем так прочувствовал за вот эти несколько попыток и на самом деле он даже он прямо работает он везде это с нами первый прогон этой презентации был сделан в mail.ru то есть презентации для хай лондона в мою я решил просто вот проверить это все поговорить потренироваться и там был не только технические соответственно там были менеджеры там пришли все кто хотел меня слушать и вот в конце моего выступления поднялся менеджеры сказал что а я не верю я убежден что можно сделать допустим единую админку на всех но вот если проекту ли эти что-то надо отдельно и то мы туда сделаем отдельный блочок игры окей а если проекта of the gnu туда тоже отдельный а если проекта леди еще нужно что-то мы добавим туда отдельный бачок понимаете да через год то что когда то было единым кодом оно таким быть перестанет через год процент казуального то есть имеющего отношения конкретного проекта кода превысит процент кода общего то же самое ребята из моих проектов подошли ко мне после этого выступления сказали что сна у нас вот два проекта дети и здоровья они тоже унифицированы мы там все это в пайпа за записями по возможности игру хорошо какой у вас процент кода вот такого уникального для проекта многое процентов 40 то есть понимаете унификация она нужна унифицировать мы всегда что-то унифицирует но вот тотальная унификация а только она нам даёт вот эти бенефиты про исправления в одном месте на всех и так далее да эта штука довольно хрупкая и зачастую когда нам кажется что мы что-то унифицировали были бы это сделали недостаточно глубоко либо это продержится недолго и с такими иллюзиями я конечно столкнулся несколько раз в общем это как раз то время когда имеет смысл подвести некоторые итоги я говорю там было несколько попыток и из них уже можно но в конце концов мы что-то построили что-то полетела но правда скорее вот так вот построили и полетела на примерно так но тоже было весело так вот выводы примерно такие мы не можем просто построить отойти нам всегда придется тратить большое количество времени на доработку и актуализацию вот этой системы супер кластера до который будет сердцем всех наших проектов и на самом деле главный вызов здесь если вы пойдете по этому пути то вам то проблемы не в том чтобы придумать вот такую архитектуру какие-то уровни абстракции прочего на самом деле главным вызовом будет сетап запуска и поддержание организационного процесса который будет вот эту доработку и актуализацию обеспечивать который будет я не знаю каким образом то ли расстрелами то ли еще как-то который будет выставлять максимальный приоритет изменениям в нашей системе они казуальным продуктовым задачам который будет выкручивать руки разработчикам чтобы они не казуал опять же метод у себя в проекте а вносили его сразу вглубь пропускали через систему через костра наш и выводили наверх а вода вот этот процесс это главная проблема как его сделать без введения военного положения и рота автоматчиков я вообще не знаю ну и самое главное что чем вас больше проектов чем больше изменение тем больше работы по актуализации и на самом деле еще зависимость не линейная похожа то есть чем больше мест в которые нужно внести изменения тем больше мест которые нужно проверить тем больше мест которые надо внести изменения это растет как снежный ком я конечно же пытался как-то проанализировать эту ситуацию в итоге получив большой опыт и получив некоторую все равно работающую полезную систему я как бы понимал что я все еще не преуспел колечко все еще где-то не у меня и я конечно же как человек интеллигентные я доски пытался найти причины в чем же дело но вот самое такая очевидная мысль была по ощущениям всегда когда я откидывался назад смотрел как там оно как как мы прошли вот вот этот путь у меня было ощущение что мы просто где-то что-то не додумали но где-то там это три раза переписывали от чего-то не учли где-то случился форс-мажор да какие то такие вещи в общем если глуп грубо то мы просто недостаточно быстро бежим но тут есть как бы хорошая новость каждый раз мы становимся чуть быстрее да вот кстати кто знает этого персонажа так вот как говорил страны альф я от него слышал эту фразу то что нас не убивает делает нас сильнее поэтому я говорю лакей следующий раз у нас получится ну либо почти получится в общем бежим дальше очередной раз так сказать проходя по этому кругу я вдруг задумался что может быть дело не в бобине может быть ошибка находится где-то в другом месте и у меня возникла версия что ошибка на самом деле охот находится в определении причины не успеха у меня не получается не потому что я слишком медленным бегу а вдруг меня не получается потому что я просто бегу не туда вообще возможно потому что я обнаружил что опирался на несколько ошибочных предположений во первых это то что высокое сходство является гарантией того что ну то есть два проекта похоже значит мы их объединим до на самом деле этот урок бы мне преподал давным-давно дома и броня уже говорили один результат разные процессы одинаково функциональности это разная реализация под одним отображением может быть разная логика но почему то вот в первый раз я этого не усвоил не настолько хорошо насколько надо было бы и второе предположение ошибочно и это вот это сейчас странно звучит до продукт не меняется ну казалось бы как не меняется если ты разрабатываешь правильно но вот попытайтесь задуматься зачастую когда мы разрабатываем продукт мы как бы считаем что вот мы сейчас доделаем и мы получим продукт но некоторые вот конечный и когда вот в рамках этого дела не я ну что-то делаем делаем делаем вдруг что-то идет не так например приходит менеджеры говорит что labs измените дизайн поменялся вот эти блоки меняются сюда попадают еще вот этот параметр а значит нам нужно выборку менять там мы и структуру базы мы такие ошибки tones форс-мажор вот это вот самая большая ошибка моя это не форс-мажор эт обыкновенной реальность на самом деле продукт меняется всегда каждую секунду и не только нами и я даже подумал чуть-чуть на эту тему и хочу сейчас поговорить о механике вообще изменение продукта такой ну условно фреймворк собственного сочинения коротенький на нем будет понятно как бы насколько все плохо некотором смысле давайте продукт представил себя таким славным пирогом ну или многоэтажным зданием сверху у нас дизайн понятно да нам сейчас не интересно ну пусть будет в дизайн оставленные данные которые мы отобрали это какие-то там заголовки картинки неважно все что угодно эти данные были созданы были подготовлены каким-то кодом кодом проекта который был но который скорее всего опирался на фреймворк то есть опирался на код работающий с абстракциями там достань из базы там что-то сделай все это стоит на каком-то базовым полу этом bdnf сервер все что хотите не знает тарантулы все что вам нужен для работы и вот это все зиждется на там операционную систему файловой системы какие такие совсем глубокие штуки не знаю там сетевые протоколы вот вот это вот здание она подвержена изменениям ветра такие вокруг него дают и более того я хочу сказать что я выделяю два предлагая рассматривать два типа изменений это реактивные изменения ну да в данном случае еще раз мы говорим с позиции владельца кода не с позиции менеджеры продукта для него все будет наоборот так вот реактивные изменения с точки зрения владельца кода это это то что на что мы не влияем это то что нам приносит ему вынуждены делать это например очередной редизайн это например очередная задача подвинуть было чувак там или не знаю как сделать как хитрую выборку то есть это все то что нам приносит менеджеры говорит надо сделать окей мы берем и делаем деваться нам некуда понятно что они разного масштаба как я уже сказал и для разных уровней вот этого вот виртуального домика до нашего продукта надо понимать что вероятность возникновения этих изменений разное то есть на уровне дизайна там постоянно что-то происходит на уровне данных но примерно та же методы фреймворков приходится переписывать слава богу не каждый раз не под каждое изменение от project а это хорошая новость хотя есть пример у меня недавний относительно когда реактивные изменения выстрелила аж до уровня базового по это когда компания google позволила себе обеспокоиться безопасности всего мира и заявила что со следующего года chrome не будет показывать хоть и т.п. помните да а кого вот это накрыла потому что мы там переделали куча всего вы еще ничего не знаете ну ладно вот и тогда понимаете да я всегда никого не трогал а тут вдруг такое я полез там в глубины переделывать всю эту историю ну слава богу такое бывает крайне редко есть другой вид изменений это проактивные изменение это изменение которое начинаю я сам которые идут от меня то есть когда я решаю что давайте мы применяем после сна mais quel ну или наоборот давайте мы выкинем весь скот проектов сделаем единое техническое унифицированные решение назовем его кластерам и вернем на него все проекты этот все мои проактивные изменения которые я затеваю понятно что они тоже бывает разного масштаба и у них тоже есть вероятность но в данном случае это вероятность реализации то есть процент вероятности с которой это изменение хоть к чему это приведет и не сдохнет собственно почему она может но потому что как вы понимаете проактивные реактивные изменения они сталкиваются и мешают друг другу зачастую кто кто же побеждает в этом бою но понятно что продукт как правило сильнее поэтому масштаб реактивного изменения это по большому счету это степень угрозы всем моим проактивным изменениям которые я потихонечку провожу на разных уровнях ну потому что я со своими проектами что-то постоянно делаю у нас-то а там одна технология проверяется потом в другом месте команд модуль переписываем чего не такое и поэтому когда я понимаю что там через месяц на этом проекте будет редизайн я прекращаю всю активность там потому что что там будет после редизайна у нас редизайн знаете сначала дизайнер рисует потом и поэтому пишем т.з. потому что там гениальные мысли действительно гениальный могут привести к тотальному изменению там твой до базы данных и точно так же масштаб проактивного изменения правильно рассматривать еще и как размер потенциальных потерь то есть если я собираюсь замутить и такой вот как framework да один на всех это огромное количество работает и желательно бы понять какой вероятностью это может накрыться медным тазом я понимаю что у многих этот слайд может вызвать таскаете жжение в груди у меня тоже мышь конце концов не безусловно не бессловесной твари мы технически и менеджеры мы же можем дать отпор вот этому без про беспредел и продуктовому но здесь тоже надо понимать что есть нюансы во-первых диктатуру технарей это такая я я это редко видел я про это слышал пару раз но там есть опасность сергей васильевич лукьяненко кстати а кто за этот курс согласились лукьяненко были альфа 5 выигрывает не поверите я не знаю почему но альф более знаменит нашей стране чем лукьяненко хорошо тем не менее да это писатель у него в одной из книг был очень хороший пример гостиница глазами горничной вот идеальная гостиница глазами горничные это чистое помещение в каждом номере застелена чистое белье стоят все вот эти средства шапочки там все разложено и ни одного ни одного посетителя потому что первый же гость как вы понимаете там все из газет вот я боюсь что диктатуры технарей она на самом деле проведет вот именно к этому потому что мы сделаем отличную систему логично работающего предполагающие таскать кучу вариантов но она будет делать мы будем делать на ней совершенно пластиковые продукты которые по большому счету никому будут не нужны а мы у вас этом случае mail.ru высокий про продукт про пользователи еще чуть про деньги простите хочется кушать поэтому опираясь на все сказанное я утверждаю что над этим завязывать в общем и целом попытки построить систему которая захватит мир они кажутся небезопасны более того находиться в условиях недостроенного кластера это вообще токсичная штука это вот прямо важная мысль который я хочу донести у меня на даче есть сарае который покосился и его бы покрасить еще но этого не делаю потому что через год там будет каменный хозблок такой нормальный со стоянкой для 3-х велосипедов как вы думаете какой год я себе это повторяю да не 1 но какой смысл или factory скотт если через месяц моего выкинем какой смысл проводить code review если через месяц этого кода там не будет такое смысла менять версию модулей каток какой смысл менять не знаю менять и менять моим конечно тарантул но какой смысл конечно поэтому а дальше начинает работать еще более страшная штука дальше начинают работать теория разбитых окон вот про это кто знает надо объяснить в двух словах ну совсем в двух предполагается есть такая теория криминалистическая если вкратце если в здании разбито одно окно через неделю будет разбит и все то есть на самом деле вот эти вот узлы а технические на которые мы положили в смысле который мы решили пока не делать потому что скоро мы их заменим они психологически начинают в головах у команды снижать уровень требований к качеству на самом деле по всему проекту то есть по большому счету ваш проект пока вы там пока мы там пока я там строю кластер мой проект разваливается поэтому какой-то момент я решил что надо прекратить так делать и надо смириться с тем что у меня будет 10 проектов 10 разных про а и сейчас свой подход к этому вопросу я не сдался я с ними что-то делали сейчас расскажу сейчас я это называю конгломератом опять же это некоторая метафора но это вот соединении разнородных штук то есть первый чем я смирился и смирился с тем что проекты будут разные и чуть чуть не похожее на самом деле недостаточно смириться и про сказать ok нет у меня ни кластер значит мягком гомер от ну конечно же нет для того чтобы это был настоящий конгломерат ну это как вот ухоженный сад и и ухоженные да вот камера так только ухоженный сад а все остальное это бардак и бессилие техническое хотел сказать другое слово не буду поэтому я собрался осознал и начал действовать но на самом деле я хочу сказать что все не так плохо у нас есть шансы сделать хорошие продукты и вот почему во первых у нас освобождается но даже не столько время сколько фокус внимания как только мы отказываемся от этой вот идея объединить все мы начинаем думать каких-то более понятных простых вещах когда мы разрешаем себя работать с десятью проектами у нас появляется возможность проверять и где то есть она может мне кажется караульным что на одном проекте мы сделаем вот это так а на другом так у меня на одном проекте стоял starman на другом как сервер приложений на другом уезжай и но это было какое-то время и я не переживал по этому поводу я считал что я провожу некоторый эксперимент мы получаем возможность сравнивать как в техническом так и в продуктовом плане с менеджерами вы может работать точно также у вас менеджеры на одном проекте будет там не знаю один алгоритм сортировки и ранжирования на другой в другом появляется возможность сравнивать появляется возможность выбирать соответственно то решение которое хорошо ну и появляется возможность наблюдать вот этого такая тонкая мысли которые не знаю пройдет она здесь или нет ну вот смотрите когда мы придумываем кластер мы пытаемся предугадать все по факту мы создаем довольно жесткую в своих границах систему ограниченное наши фантазии какая бы она ни была я в вас верю всех но тем не менее это границы тогда 10 проектов живут чуть чуть сами по себе мы получаем некоторую аналогию эволюционного развития то есть на самом деле и в техническом смысле в продуктовом появляется шанс что там начнется какой-то тренд которого мы сами бы и не предположили ну в конце концов я на сервера приложений переезжать не собирался ну так получилось одни бандиты сделали себя на проекте дальше понеслось и вот в кластере вот в этом рассказать ограничение такого не получится вы мне можете сказать но нормально сейчас рассказал про то что чтобы мы не делали все накрывается изменения изменения все верят а теперь ты нам предлагают что что-то делать на самом деле с изменением все никто же не так плохо потому что смотрите вот теперь я сведу свой фреймворк прямо в табличку на верхнем уровне понятно что вероятность появления реактивного изменение очень высокая и поэтому раза вероятность реализации противного изменение низкая это значит что на верхнем уровне можно делать только то что не жалко там можно такими точечными ударами что-то менять вносить но не более того дальше понятно что эта штука разъезжается то есть чем ниже мы идем тем ниже вероятность реактивное изменение которое потерь от каким наше начинание проактивные поэтому мой любимый тип изменений сейчас это проактивные глубинные изменения это вот про отращивание стыка технологий prada сказать такие штуки на самом деле остается вариант большого хайпа наверху но как я уже говорил это лучше делать под шумок то есть вот случился редизайн окей у нас есть шанс падре дизайн еще сделать много такого технического что хотелось бы нам единственное что как вот с серфом нужно быть это нужно делать в вектор изменений то есть если мы в рамках реактивных изменений попытаемся сделать что-то им противоречащие то они нас сметут ну и важный момент такой болезненный я это про то что хорошо мы как бы нашли новые решения допустим хорошее решение которое мы хотим распространить везде вот в кластере как я обещал это прямо делает смарров бум и но так сразу везде появилась в конгломерате этого никогда не будет в конгломерате нам приходится это делать на каждом проекте отдельно но слава богу если мы говорим про изменения такие которые близки командам до которые ну получились так вниз у не указом сверху а получились как то вот чуть-чуть сами-то это работает примерно так это такая вот как как эпидемия распространяется сначала одна команда чинить придумает интересно этом я даю на это оправ они это делают если у них получается они начинают про это рассказывать и дальше кто-то начинает к себе потихонечку еще пара команд к себе это решение утаскивает ну а я это поощряя выделяю на это время и так далее в общем не мешая после 50 процентов то есть когда у меня же пол проектов на том же не знаю из уезжай я начинаю слегка на остальных и начинаю слегка давить так подзуживать типа ну что же вы в концертом паровоза как же так в общем после 50 процентов уже как-то и неприличную по-другому это решение становится таким базовым и на него все потихонечку переезжают чтобы не быть слоупока me если же ваши изменения вот так вот не распространяется то я считаю что скорее всего она я бы я бы сказал что она не прошла эволюционный отбор и надо от него отказаться дули поджать таскать зубы и наслаждать его каленым железом но иногда такое надо наверное да там не знаю какие задачи по безопасности еще что то они редко вдохновляют на делать надо никуда не денешься и на самом деле оказывается что унификация возможно но не везде унификации у нас возможно на уровне столько технологий то есть такие колечко-то я нашел и унификация возможно на уровне функциональности продукта как я говорил да то есть мы мы с менеджерами делаем несколько вариантов одного и того же чуть-чуть по-разному на разных проектах дальше замеряем выбираем лучшие если менеджмент соглашается что на всех проектах будет только от один продуктовый вариант у нас появляется возможность безболезненно унифицировать весь код этого решения это практически все вот к чему я пришел там за последние 10 лет это мой путь я не знаю что вы из этого возьмете себе что не возьмете сейчас может быть мы бы это подискутируем мой путь и правильный путь они конечно разные но надеюсь что не перпендикулярные давайте в конце подведем как бы такой итог то есть реальность кластера еще раз там опасность в изменениях постоянных это очень чувствительны к изменениям и вообще унификации она довольно шаткая в итоге мы имеем уменьшение активов потому что не обращаем на них внимание надеюсь построить такие кластеры и имеем демотивацию что касается конгломерата то у нас есть перспектива эволюционного отбора у нас есть возможность унификации через за лучшей практики и мы можем поставить себе высокое качество как ключевую базовую цель что для этого делать развивать и унифицировать стек технологий и поддерживать качество продукта ну вот как бы то есть я отказался от завоевания мира и ушел в огород в огороде и мясо хорошо как выбирать оставлять лучше на нижних уровнях творить все что мы хотим на верхних делать это либо точечно либо под шумок больших изменений реактивных вот и все стас михайлов и спасибо вам я я очень жду каверзных вопросов вот это отлично руки руки здравствуйте у меня первый вопрос по поводу того когда вы пришли к идее конгломерата нас насколько у вас процент вот этого общего кода общих технологий вот по проектам примерно если можно как вы оцениваете насколько было казуального кода на каждом проекте до него сейчас какой процент одинаково кода одинаковых технология сейчас увеличился скажем так было 50 сейчас местами 60 то есть я это пропускающие иногда это нормально соответственно все остальное это площадка для экспериментов ну да да примерно так стас подскажите а вот вы приводили свои проекты какие-то целостные куски вы не пробовали или вообще-то разбить и ну разбить их на компоненты и проводить унификацию же компонентов то к ним они же очень похоже на то есть там на самом деле не понятно как их сегментировать то есть это я если я правильно понял речь идет о том что условно говоря у меня есть проект недвижимостью я применю поминал специально недвижимость он коммерческий проект да то есть можно было и есть cars где тоже коммерчески можно было коммерческие вывести в один сегмент и там унифицировать а новостные в другой и там я правильно понял ну как вариант меня другие кейсы ну короче вот сегментировать толком не удалось они слишком похожи и вроде бы ну то есть вот так вот ну может вам понятнее будет пример например сервис заказа есть заказ на таком сайте заказ на таком сайте заказ на таком сайте это все можно выделить в один компонент и там же меньше отличием возможно вашего проблема тому идут дано только вы тогда в итоге получите конгломерат из вот этих вот компонент даже здесь вопрос я не до конца понял это одна команда работает на несколькими проектами или это несколько отдельных команд у нас есть отделалась 20 там с лишним девицы 5 человек который разбита на несколько команд а существует ли миграция между командами смысле людей да но она редко и она вызвана там всякими управленческими изменениями скорее есть миграция идей вот потому что он там команды очень платно общаться между собой и мне повезло иметь такую команду и идея прямо вот на кухне а не летает из одной команды в другую последний вопрос о миграции нет потому что ну не нужно не хотели или пробовали не получилось ну потому что вот мы пробовали такое как это со стульчиком да вот включили таймер все побежали м все сели это конечно не работает слишком большая динамика она на краю пересекается с динамикой развития проектов мы постоянно что-то делаем постоянно что-то ищем и но не получается а переводить там раз в полгода это не очень понятно даже для человека мы приходим говорим все иди туда вот такого месяц еще что то здесь не закончена в общем мы не смогли найти пока спасибо нас здесь здесь у нас где каждая переправы как адам спасибо первый вопрос это по поводу 1 предыдущего но собеседника уточню она пробовали ли вы делать вариант микро сервисов то есть одно делать унификацию за счет но реализация микро сервисов которые ну как бы одинаково должны работать еще нет но потому что микро сервиса появились ну относительно недавно все-таки достаточно велика концепте в общем окей и второй вопрос это она правильно я понимаю что в конечном итоге вы одно пришли к выводу что ввести одинаковые проекты она сама как отдельные но все-таки выигрыш нет времени чем одно делать проект на на одной базе да то есть если предположить что однажды мне все-таки удалось бы закончить то может быть вот за весь этот период эти затраты были бы там плюс минус равны но поскольку конца и края там не видно то количество работы как бы имеющий полезные коэффициент кпд намного выше вот у подхода конгломерата кстати про микро сервиса на самом деле тоже если подумать мы можем это сделать ну там это вот это опять же будет похоже на кругами рад вас будет вот один такой кусочек один такое они будут между собой взаимодействовать но просто в нашей компании одно немного другая ситуация у нас один проект он начинает размножаться и вот мы там долго череп con que le по поводу того как правильно пойти размножайтесь или все-таки двигаться 1 путем кастомизации пока вот мы противоположную сторону в сторону кастомизации но как бы тоже думаете стас да правее правее правее смотрим правее вот и здесь у меня к вам вопрос вы сейчас рассказали нам замечательную историю изысканий своих и использовали слово кластер конгломерат знаете ли вы про слова шаблоны паттерн и рефакторинг даем driven design и мне кажется что это именно тот чем вы пытались заняться и о чем вы рассказывает вполне возможно это это было полезно я надеюсь но это было в некотором роде да полезным на подушке но смотрите просто во первых ох ну я конечно не настолько стали но в общем и целом не все слова из которых вы не все те слова которые вы произнесли были на тот момент когда ты сказать я бы ты бился головой поэтому здесь как я уже говорил кластеры конгломерата то некоторые ну аллюзии да некоторые метафоры просто вот на мой взгляд перпендикулярных подходов вот просто то есть это это как бы стратегии глобально разные а вы все эти перечисленные инструменты нет ли они перечислены он с трубочками я перечислил методологию метод инструмент это разные данного окей ну вот хорошо может быть вы правы еще стас на ли вы можете посмотреть налево налево вот здесь до 100 допустим вот сейчас сегодня начинаются все проекты в mail.ru леди авто новости там hail все все все что угодно вот прямо сейчас начинается что вы выберите либо это кластер либо конгломерата если это будет класс тарту почему и как вы это сделаете спасибо за вопрос я выкинул этот слайд из презентации но вот у организаторов есть первой версии презентации где есть слайд aquastar с чистого листа смотрите вот тут опять же есть только одна мысль теоретически да когда я строю проекты все с нуля я могу построить кластер как это будет выглядеть я делаю 1 акт делаю фактически из него кластер дальше я беру второй проект при необходимости чуть-чуть допили вы и так далее проблема в том что это уже на уровне головы на восприятия и у меня и у менеджмента и подозреваюсь подозревая будет некоторое зашоренность то есть на самом деле вот из этого кластера вырастет меньше многообразие меньше вариантов проектов чем если бы мы это делали конгломератом ну то есть вы изначально не стали бы попал сейчас попадать в этот капкан как бы сейчас нет безусловно еще раз смотрите я не предлагаю не унифицировать ни чего ни в коем случае унифицировать надо ну то есть если у нас есть возможность причесать код и отказаться от его использования это обязательно но от теперь для дублирования звените но главное не ставит себе задачу сделать это вот когда уровне самого решения вот о чем я говорю которых нужно искать некий баланс так то есть и вовремя не навязывать вот эту излишним унификацию вовремя уйти от вы сегодня спасибо здравствуйте я хотел спросить вы вначале упоминали про фреймворке а потом как-то у вас в речи фреймворке ушли вот вопрос на техническом уровне есть фигурки есть библиотеки которые используются или в которой мы встраиваемся они пришли ли вы к тому что он меньше фреймворков и больше библиотек который уже продуктовый код продуктовая логика по своему требованию как бы использует у нас сейчас а есть по факту но 2 framework а потому что у меня есть проекты на берлин есть проекта на питоне но в рамках одного языка там один framework весь старый кот вынесли в библиотеке ну про про его процент я уже говорил сейчас там вот процентов 60 библиотеках процентов 40 в во фреймворке на framework один на всех он раздавлен абстрактный ответил вот я начал уже не работает использовали вы какие нить портретные технологии потому что он убедится что здесь они могут быть использованы или в кластере лив в конгломерате или вы может быть попробовали сами реализовать такое еще раз какие технологии портреты в визуальные элементы которые там можно перемещать они общаются между собой сайт и сделаны именно ну через нее там life рейна привез такой движок частичное но если а про если я правильно понял вас с исой это про тоже нет сасай sure that include когда у нас есть возможность включать кусок в проект это про тоже ну да как у какие-то такие подобные вещи но эта технология ее можно использовать и там и там вопросы как бы что мы что мы пытаемся этой технологии реализовать то есть это это больше похоже на конгломерат когда мы один кусочек другому проткнули там так вот что-то использовали вот внизу молодой человек рука тянет вы сказали что когда у вас много проектов которые работают немножко по-разному это хорошее поле для экспериментов как решается вопрос с эксплуатацией там разных платформ и разных технологических стыков скажем так мы пока еще не экспериментировали ни с чем таким уж и чтобы вызвать проблемы здесь пока просто но безусловно вся наша идея проходят некоторые одобрения у админов то есть мы подходим договариваемся с системными администраторами то что они готовы отыскать принять мы используем и скажем так предварительное согласование нас пока уберегает от вот того чтобы развалится есть какие-то формализованные требования от администраторов что они готовы согласовать лежит каждый раз неформальной согласование есть но они такие довольно общее то есть там это должна быть не бета она должна там иметь какое-то там как количество лет использования ну там вот какие-то такие простейшие ну чтобы мы не притащили какой-нибудь жару со всеми технологию который никто еще не видел это именно вот на уровне технологии то есть что там наличие там таких-то средств мониторинга это не знаю такой то масштабирование вот в такого рода есть но вот примерно такие есть она должна имя иметь возможность резерва построить и соответственно нужно нужно как-то митя мониторить ну вот примерно так то есть я вам сейчас не зачту к сожалению сказать это приказ номер ногой монет на в оффлайне можно будет это посмотреть лет секрет напишите мне и я вам отвечу безусловно могу там должен был быть все средствах большое спасибо спасибо вам ещё раз спасибо я надеюсь что это было полезно"
}