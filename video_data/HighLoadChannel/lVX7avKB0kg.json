{
  "video_id": "lVX7avKB0kg",
  "channel": "HighLoadChannel",
  "title": "Порядок для скорости. Система структурирования фронтенда / Сергей Гущин (Superjob.ru)",
  "views": 614,
  "duration": 1860,
  "published": "2017-04-22T14:48:16-07:00",
  "text": "всем привет меня зовут гущин сергей и я тимлид фронтэнда доступного за это superjob может быть вы знаете что узнается по жоп стоит из двух частей это мобильная часть мобильная версия и доступная версия доступной версии около 16 лет там огромная кодовая база которая приносила намного проблем нужно было ее как-то менять немножко о себе веб-разработка я занимаюсь около 9 лет и последние два с половиной года в компанию superjob для многих superjob это просто сайт где лежат резюме и лежат вакансий но лично для меня это серьезно идти история за которой стоят большое количество людей как разработчиков так менеджеров управленцев всех остальных многие из вас подумают что я теплит фронтэнда сделаю делаю здесь на конференции по высоконагруженных систему у нас супер жабе есть такая шутка что высоконагруженных frontend это когда много человек смотрит в один монитор это было бы очень смешно но если бы это не было правдой все эти люди смотрят в мой монитор каждый день и чего-то от меня постоянно хотят кто эти люди во первых это менеджера они постоянно приходят чтобы что-то поменять а не какую-то классную идею придумали нужно срочно это внедрить они придумали какой-то бы тест хотят его запилить они придумали новую главную для не зарегистрирован незарегистрированного работодателя им нужно эту главную страницу срочно внедрить вместо старый также они могут придумать какие-то страницы главные для работодателей для и соискателя отдельно им тоже нужно это запилить они спрашивают где что-то лежит как выглядела старые страница до того как была старая старая страница дает кучу всяких разных вопросов это все дела у меня далее приходит дизайнера и говорят нужно перекрасить кнопку или нужно добавить новый pu пап новый tooltip мы тут подумали что вот форма регистрации она должна выглядеть по-другому нужно сделать какой-то лендинг мы не знаем где то все лежит то есть мы знаем где у нас гайдах это все писано как это выглядит на сайте нам нужно посмотреть окей показываем далее ко мне приходят аналитики им обычно нужно посмотреть что натворили первые двое ребят дизайнер менеджера либо им нужно что-то найти такое глобальное один из примеров летом ко мне приходили пришел аналитик и сказал что ему нужны все баннеры на сайте я сначала не понял какие баннеры потому что у них и у нас их огромное множество это как smart баннеры для приложений так и баннеры для какие-то рекламные баннеры либо какие-то внутренние наша казалось бы все просто но в биты там задаёшь к своей банды и нашел ты всех нет у нас это не так было с баннеры могли называться не только баннер но и как они сплошь панель там что нибудь в этом духе в общем не имеющие отношение к баннерам совершенно нет надоело я конечно нравится помогать людям и я в принципе не против проконсультировать на этим ли ты хочу заниматься ими тем близкими делами это составление спринтов посмотреть как работает команда планировать что-то поэтому здесь выявились у нас но пройти некоторые проблемы yahoo звучу сложно было найти какой-то компонент на сайте особенно людям которые не имеют отношения к разработке компонент постоянно изменялись и их изменения не учитывались дальнейшем то есть нас могло появиться два совершенно одинаковых компонента шаринга соцсетей это конечно не очень хорошо и все знают что за компонентами нужно следить чтобы их не дублировать чтобы их не повторять у нас могли возникнуть 2 как я уже сказал компонента sharing соцсетей с такими кнопками и с другими причем в одном был запилим забыла запилена аналитика какая-то показался этот компонент или нет а другой компонент просто пустой вот он лежит и где то в другом месте подключается нас это не устраивался уже компонентов огромное количество я же приведу некоторые цифры здесь это brazil они звучат так нас около 200 компонентов всяких разных и каждый компонент может быть представлен там 4 5 разных представлениях этого мы имеем от полутора до двух тысяч с половиной компонентов из зоопарка нужно отслеживать нужно как-то в нём разбираться и как вообще очень все это сложная странно выглядит сложно было отследить некоторые компании некоторые параметры компоненты такие как версию дизайна то есть мы если увидим на сайте что то мы не можем понять какому дизайну он относится хотя это иногда важно чтобы допустим переделать некую страницу брать компоненты братья старый дизайн из этой странице и добавить новый также мы не могли отследить какие события допустим кушают компонентов аналитику бывало такое что есть такие примеры когда компонент просто должен появиться на странице и в этом его миссия заканчивается и аналитику что какое-то определенное событие знание об этом имели только либо мы frutiger или backend который делали этот компонент далее существовало большое количество компонентов поколение пока компонентов разных поколений дизайнов и это тоже нигде нельзя было отследить учесть чтобы что-то узнать о компоненте не разработчику нужно было при привлекать очень много разработчиков то есть ну никто не обладал полная информация о каком-то компоненте откуда взялись ты проблема все очень тривиально наверно как у многих из вас все проблемы начинаются архитектура в самом начале развитию проекта если у вас этого нет это очень хорошо молодцы у нас это все вытекала из самой структуры компонентов я немножко поясню наш сайт был сделан сейчас остается сделан доступный сайт на приборке юань этапов рывок и шаблонизатора blitz на первом говорю кодовой базе 16 лет это не так все просто задавайте вопросы по живым спасибо как все работало я думаю что с я им с блицом все знакомы многие из нас были php контроллеры php view модели которые готовили данные для шаблонизатор of и сами компоненты которые в я и выглядят как папки с какими то там файлами внутри система совершенно простая компонент один компонент двоих то может быть огромное множество они все содержат как шаблон и так и css файлы джесс файлы и файлы подключаемый модуль подключаем файлов плюс ко всему этому подключается какое-то ядро css какой-то джесс приложение и какие то библиотеки все достаточно стандартно никаких тут особенности нет как все выглядело в проекте папка дней файлик папка с названием компонента в ней файлик с компонент шаблоном компонента ссск из женской и с файлом подключаемых модулей все просто если бы не одно но так не говорил такого у нас было очень много и только половина вашу жизнь стала тренить все было ужасно что тут вообще на первый взгляд не так кроме того что это дофига всего то находится если мы посмотрим у нас компоненты назывались вспомните форму регистрации которую к которой вам говорил юрий station for registration second и вот это какой то наверно второй шаг и не знаю вторая итерация registration form вариант а это стопудово для абэ тестов потому что как бы вариантом для бы тестов рек which are new design это вот на r для дизайнеров что-то было сделано и вот для них новая форма регистрации запилена registration регистр скрипту это как не относится к степман но первый раз непонятно карл этом вот вообще что такое как мы с этим работать будем если учесть что их там около 200 штук это невозможно чем у нас это все не устраивается нет никакой документации компонентов компоненты разбросаны по проекту бессистемно уже видим что они могут дублироваться там и очень непонятно где лежат в принципе есть одна директории где все это лежит но все равно не известно ни одна дополнительная метрика как я говорил и компоненты могут создаваться бездумно придумали все очень просто взяли это все в кружок обвели сказали что сейчас так будет kontrol ц контра вы просто контроля новую папку создать в итоге мы придумаем если у нас есть компоненты которые логически как то друг с другом похоже и они могут быть как ты вот логически объединены мы их выделили в один компонент а вот эти все разновидности стали версиями тут к эта космическая схема планеты летает на самом деле это все та же схема просто введенное в кружок допустим было у нас простите не поможет да как это стало сейчас выглядеть есть у нас registration form эйчар форма для регистрации работодателя и она содержит разные версии в себя мы долго думали как бы нам называть то может быть циферками там буквами или там еще как-то но все очень просто мы называем то что они логически если так как надеюсь себя логически описывают и представляют себя переименовали файлы тоже все просто ничего сложного у ялте и ставил скрипт модуль из и добавился некий файлик джейсон чуть позже я расскажу интерфейс чтобы как то вот видеть эти компоненты на сайте для тех кому это надо нужно что-то для этого сделать раньше у нас был такой раньше все что раньше мы знали компоненте тут вы видите что мы ничего не знали компоненте совершенно что мы знаем компоненте сейчас сам компонент имеет четыре четыре параметра это имя тайтл который будет потом фигурировали где-то айдишник описание и теги что это значит я тоже вернусь к этому чуть позже когда мы уже подойдем к описанию что мы знаем сейчас а версии вот есть у нас registration form эйчар есть версия допустим single step мы имеем информацию всякую разную основную тоже на им тайтл description найди айдишник заказчика версию дизайн поколение дизайна об этой ost которому принадлежит этот компонент теги события которые пушиться в аналитику и томск в рамках которого был была создана эта версия компонента и ветки где это версия где ее можно найти в детей в этом без боккетти где угодно как-то выглядела раньше blitz позволял нам посмотреть из чего создан еще создана страниц из каких компонентов на создают если кто-то из вас блицом работал видели наверно там можно в таком виде это все посмотреть долго наводить на какой-то компонент мышкой ждать пока выскочит тайтл посмотреть что за файл там выскочил запомнить и перейти в проекты найти его нас ты не устраивало какой-то там а еще если у вас gens qui то есть вот это вот показ вот этих вот компонентов красными рамками вам джесс может сломать самый неожиданный момент когда он даже этого не надо и даже когда надо мы сделали панель компонентов стало гораздо приятней нам то есть это обычная панелька со всеми со списком всех компонентов с которым собрано страница начиная самым кантри корневого layout наверху и вот так вот со вложенными со вложенностями идет дальше в принципе ничего такого сверхестественного просто чуть облегчили работу и вот сделали панельку что в панели в панели компоненте может быть описана glan как я и говорил тайтл название компонента описание кто заказчик какое поколение дизайна есть а бы тест и и или нет и какой используется если есть теги какая аналитика пушиться какой-то с родительским и ссылка на бит баки с ветками этого компонента мы используем атласе он мы решили это все дело как ты подключить вот come from сук джерек бит makita благо api есть можно там порулить как угодно почти вот тут-то я немножко отвлекусь допустим если мы создали компоненты у него нет описания это очень плохо и у всех компонентов есть описание постепенно описываются дальше компоненты и нам панель будет сигнализировать о том что чего-то нет либо описании либо заказчика сейчас когда менеджер зайдет заходит на сайт включает панель компонентов он видит что что то здесь не так этот компонент надо было писать либо не описывает если ему кажется что это избыточно понимаете что все просто не бывает и мы с какими-то трудностями сталкиваемся постоянно здесь мы тоже не смогли так все просто сделать нам нужно было какие-то проблемы решить и мы видели кучу проблем или постепенно ходили группам людей за их решением мы пошли к дизайнерам аналитиком и менеджером за описанием компонентов потому что как я сказал мне было описано ничего у нас есть огромное количество документации всякий разный юзер кейсинг тест кейсом различных страниц различных действий пользователя различных тестов и всего остального но ни одного документа ни одного в файле к ни одной записи пир какой-нибудь компонент зачем им нужен что там с ним делать и кто его заказал дизайнером пошли за вы узнаванием поколению поколение для каждого компонента у нас около 4 4 поколения дизайна за все 16 лет начиная от какого-то старого оранжево заканчивая сейчас синеньким этого были серые и какие-то зеленые то есть может быть кто-то видел там страницу нас достаточно неоднородно сейчас за заказчиком нам очень важно узнать кто вообще сделал кто был так родителям вот этого компонента кто заказал его и кому понадобился вообще но из-за информация б тестах абэ тестах нужно было всю эту инфу собрать и как-то описать добавить в тот же с файл который уже показывал дальше мы идем бэкону потому что мы frontend мы и любим не хотим не умеем с php и когда я тащусь они наши мы любим jest ноду всякую это repack плохо выпустят не разбирается вот ребята помогли но мы должны были какие-то требования для них вы выставить нужно было компонента объединить логически во что-то и раз сгруппировать по разгруппировать потом сложить в новые папки это очень просто звучит на самом деле работать там была очень огромное реализовать архитектуру то есть нужно было все эти контроллеры php view модели чуть-чуть переделать возможность постепенного обновление архитектура компонентов то есть нельзя было так вот что мы берем задачу на два месяца через два месяца мы выливаем сайт новые архитектуры компонентов нужно было это делать все постепенно иначе бы у нас какие-то проблемы начались шаблоны стилей и скрипты должны остаться без изменений мы оперируем только с файлами но не с их внутренней структурой ну и возможность связать компонент из jerez conference on ice bucket за месяц мы перелопатили мы бы к ридеру перелопатили тысячи компонентов сделали на вот эту всю структуру постепенно ее и организовывали и сделали так как мы хотим как-то нужно было объяснить вообще зачем такая мотивацию этого всего зачем мы это делаем и зачем мы тратим деньги и ресурсы компании время кампании на какие-то свои там внутренние нужды мы superjob понимаем что инфраструктур на этих долговые задачи они ничуть не менее важна и чем продуктовые если грамотно запилить создать архитектуру то в принципе потом разрабатывать будет легче о чем мы и доложили радостно часть когда начали когда захотели бы что-то такое сделать зачем все это знание информации компонентах без обращения к разработчикам снижение порога вхождения в проект новых разработчиков когда к нам приходят новые контейнеры и они видят вот этот 200 файл 200 папок они делают круглые глаза не спрашивай что это такое потом с этим делать мы from тендеры мы не должны вот в этих папках ковыряться у нас там джесс устранения дублирующихся и неиспользуемых компонентов мы наверно около 100 компонентов просто выпилили потому что они нигде не используются то есть и занимают места на диске как минимум и вносят некий беспорядок нафиг это надо вы все это убрали далее возможность быстрой смены одного компонента на другой раньше не так что просто было и во первых нужно было найти во вторых blitz не был настроен так чтобы можно было один компонент запилить на другой потому что ее view model и их не всегда совпадали то есть данные в одном похоже могли отличаться о тех данных которые должны использоваться в другом похожем компоненте навели порядок и там увеличение скорости разработки но это чуть ли не самое основное во-первых ко мне перестали приходить люди во вторых у нас любой from тендер может себе запилить компонент описать его ну и также сделать это может быть kinder никаких лишних связок друг с другом вообще не нужно делать где знаю что нужно будет описывать пока нужно будет описывать это все в жире и в комплексе зачем ты это сделала всякие форбса в разную информацию вносить но дальнейшем мы планируем автоматизировать тоже что было сделано за один месяц три продакт-менеджер и один аналитик описали около 500 компонентов это малая на самом деле это одна 4 всего что есть работы постоянно ведутся но вот они так быстро собрались нам помогли 2 дизайнера опознали версии дизайна версии поколение дизайна 3 бы киндера полностью организовали структуру более чем тысячи компонентов то есть они вам за месяц практически половину нам всего запилили два frontera выяснили какие компоненты что пушту аналитику какие события и сделали панельку инструментов панель компонентов на самом деле панель это самое простое что там есть поэтому учетом такого сложного не было мы были бы не супер жук если не сделали еще какую-то вещь дополнительно к нам часто приходили дизайнеры как я говорил им нужно было перелопатить дизайн я помню как у них пользуемся скетчам скетч были разные сбор до того как что-то выглядело как того как что-то будет выглядеть какая версия дизайна сейчас на этой странице исчез из какого дизайна создана вот эта страница не могли тоже все не хотелось рисовать плодить они хотели это на различных страницах видеть драм живую на сайте но и так как мы имеем поколение дизайна описанные в нашем компоненте мы сотворили для них панели can систем то есть но консистентной это на самом деле кнопки которые показывают сколько какой дизайн в каком процент в таком количестве присутствует сейчас на странице при клике на эту кнопку выделяются те компоненты которые принадлежат этому design дизайнер сказали нам большое спасибо и больше ко мне не ходишь и так часто по крайней мере у нас была как раз как я говорил первое второе третье четвертое поколение все разными цветами выделены очень удобно смотреть панели о планах все то же самое сделать для женском планеты фронт-энд супер jovi появился около полутора лет назад до этого джесс и вообще всю динамику на сайте весь фронт или ли пхп разработчики у нас много legacy кода который нужно приводить в порядок и мы хотим что-то подобное создать для этого надеюсь сайт проживет еще очень долго эти старания не пройдут зря далее сделать поиск по компонентам как я говорил ко мне приходится тем чтобы что-то найти сейчас это найти и стало легче любые компоненты что где как все уже знают но вот поиска пока нет то есть мы хотим в эту панель еще запилить поезд который бы который бы искал нам все компоненты по тегам пошел по ключевым словам заказчикам возможность быстрого просмотра компонента без окружения то есть оно просто компонент который вы ли тут в отрыве от всего мы ему какие-то данные должны дать чтобы он от рисовался и как нет и стилю должен всегда загрузить чтобы показать как он выглядит это все в планах были запрос такие тоже помогут дизайнеров и мы хотим это сделать ничего сложного не вижу думаю , сделать компоненты сама собирающегося в коллекцию наверно знаете что в реакции есть реакция что в реакции есть некие тузы которые позволяют сделать коллекцию компонентов вот гуляли по тоже что то есть и мы хотим сделать такой же и для нашего чтобы у нас есть коллекция компонентов ну там пока только в сверстан вручную мы хотим чтобы она собиралась из того что у нас уже есть ну и хотим запилить какой силой то есть командную строку для команды для командной строки чтобы можно было компоненты очень легко одной двумя командами создавать рисков папки в проекты как то это все это создавать файлы копировать все остальное такие команды такие инструменты если окуляра 1 2 знаю мы собираемся себе тоже поставить сделать о чем я говорил вообще не бойтесь находить проблемы во первых корень всех проблем лежит в самом начале и нам показалось что он лежит в архитектуре различных проектов если вы изначально чего там не додумали то в дальнейшем это все вылиться в большие проблемы в поиске в отсутствии документации всего остального решаете проблему привлекайте своих коллег у нас суперджо беседу помогает в этом плане никаких проблем нет говорите начальство там что вас беспокоит я когда шел к своему директору спрашивает разрешение на то чтобы выделить время на все это я так немножко из боялся что вы не разрешат скажут это все вам не нужно но после диалога с начальством потому что страхи были необоснованны потому что за инфраструктурой мы следим должны следить тщательно делайте пробуйте творить и если у вас не получается и кто-то вам мешает приходите к нам балкам спасибо теперь можно вопрос спасибо спасибо за доклад вопрос следующий рассматривали какие-то может быть аналогичные готовые решения длина и мы не нашли вы kinder этим занимались и мы с ними говорили не нашли чего-то там нас устраивающие такой вопрос почему вы решили сразу переносить все на бэкон то есть решать эти задачи именно из бэг-энда во-первых нам всю статику сейчас до сих пор а дает backup перевод фронта чисто на фронт это несколько другая история мы занимаемся сайт должен сейчас функционировать в том виде который есть следующий этап будет приносит отеки на об этом можем лишь потом расскажем сейчас пока не готов ну то есть у вас на проведение компонентная система про те страницы формируется backend да но внутри страницы все ты странице если есть этот жест он разбит архитектура у него достаточно достаточно хорошая за исключением того legacy которые присутствуют сложных там страницах и регистрации всего прочего я просто к чему вот вы рассказывали да вот пункты определенные выделяли фронт-энд потому что есть уже готовое решение на фронт энди чем такой framework как базе джесс это живо скрипт фреймворк как раз таки больших web приложений и в большинство этих пунктах которые вы назвали он умеет делать именно на фронте там аналитика и компонент инспектор и поиск компонентов по кодовой базе я вас понял спасибо за базис но у нас окуляр пока мы от него отказаться собираемся ближайшем будущем мобилки разряд и покажи вот как раз шло шла речь о том чтобы быка привести в порядок чтобы было сработать начали издалека не хочу гризли зал спасибо спасибо за доклад у меня вопросик несколько в общем я так понимаю что у вас мнение сингл пейдж правильного же сердце кенджи до нас есть страница где конкретно сингл пейдж это допустим регистрация мой кабинет кабинет и работодателя личный ешь быстро при этом frontend вас снова правильно из вас какие-то компоненты разрозненные как правило весь-весь на первых very отказались на первом 154 отказались дома уже просто избегать а вы собираете их как-то но патч ну грубо говоря также компонентами собираете под каждую страницу свой компонент собирается сборщика как я говорил нас сборкой статике собирается занимается php свой сборщик и плюс ейской чтобы накручено мы все собираемся у нас однажды ручная пакета так об их какой спасибо все вопрос я тут да спасибо интересный доклад меня вопрос 2 1 как данные о компонентах падает на сушу говоря туда куда не подать чтобы их увидели пользуйтесь они все время есть на страница это как-то по настроечки другая версия дается да сейчас расскажу значит когда собирается проект м и php с папку на фронт отдается некий бандл который содержит информацию в виде джейсона всех компонентов которые там присутствуют то есть файлик просто дублируется или складывается к нам нашел мы регулярно по цепляем мы показываем для того чтобы отобразилось панель на можно найти зайти в режим нашего администрирования в админку включить себе кнопочку чтобы показывать панельку и панелька уже потом будет присутствовать постоянно если вы наш менеджер или разработчик но то есть пользователи обычных не никак не эффект это не больше не грузите обсуждает и хорошо что они не грузят себе лишнюю информацию я тут нет никакой инфы не проходит если не от этого бабла который приходит мы даем нет никакого то есть сама по дали вообще никаким образом не грузится я снова не включена в админке спасибо спасибо за доклад мы делаем примерно то же самое поэтому вопрос компоненты которые уже не используются как вы их выпиливать это какая-то автоматизированной системы или вот и все что рассказал в автоматизации только в панели все остальное там пришлось руками вот те тысячи около тысячи компонентов которые бы киндеры разобрали они наполовину или больше руками все это удалили давайте сделать витязь я думаю что следующей итерации возможно нужно опять эти и вот мы пока как сказать на какую то стабильную версию вышли обрадовались что все получается запиливаем компоненты вот сама машина реусе я думаю что мы обновим и и чуть позже нас интересна потому что там очень простую себя еще css всякие подключаем же с тоже автоматизированная поэтому они автоматизированы и у нас сборщик пробегается по адресам то есть у нас вроде как никитин джейсон то есть свое свое подмножество вот он пробегается видеть что там компонента используется подключается в стиле подключает вот же с и тогда и так далее хотя для этих целей пак которые бы нам тоже бегал бегал заходил бы в линн кирпич файл наш и оттуда бы тоже но у нас сейчас gold поэтому галку все вопрос еще полно времени всего спасибо большое спасибо"
}