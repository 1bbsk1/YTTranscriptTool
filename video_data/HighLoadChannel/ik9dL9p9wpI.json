{
  "video_id": "ik9dL9p9wpI",
  "channel": "HighLoadChannel",
  "title": "Заключая контракт: как осуществить хороший API для (микро)сервиса / Анна Мелехова, Владимир Лапатин",
  "views": 1773,
  "duration": 2940,
  "published": "2020-04-14T11:12:55-07:00",
  "text": "всем привет вы на самом деле большие молодцы что добрались сегодня по утренним пробкам я не ожидала что у вас будет здесь так много и это безусловно радует это значит что тема и пиа я для вас интересно а мы сегодня будем говорить про этой мы будем говорить сегодня про то как сделать его действительно хорошим да и построить хорошее взаимодействие между сервисами или микро сервисами а мы это она его мы в и компании acronis в чем мы там занимались последние полгода мы строили платформу причем платформа это нужно понимать не что-то вот мы пришли и начали они знают пустыне возводить замок практически как-то в бернинг мене да нет мы скорее а пытались ну то есть это некий новый этап зрелости компании когда мы сначала делали по доступные продукты потом мы делали клоуны и какие-то вещи наконец мы дошли до стадии платформы и в этот момент как вы вам намекает большая жирная стрелка на экране попробуем вы даже и выделить одна большая жирная стрелка на экране а вот это в центре платформы находится и 5а и пиарь как способ взаимодействия компонентов в целом у нас все построено на ищите перевести но наш доклад оон такое агностик по отношению к виду протоколов которые вы используете то есть даже если там используется джерк бисере что-то другое тема надеюсь будет для вас актуальна а доклад у нас будет прощен да про программиста васю и его менеджеру коли который постоянно страдает из-за того что калле не укладываются в сроки точнее пасть не укладываются сроки а коля страдает вот так мы пойдем вокруг более которые переживают эти два глубоко уважаем их товарища да начнем с того что наше описание устарел это когда программист вася разрабатывать какой-то свой компонент допустим микро сервиса и он использует api какую-то другого компонента и в компании есть даже какая-то нотация то есть это роман или swagger и к сожалению он не валидный все в компании об этом знают на такая ситуация сложилась и разумеется вас приходится читать чужой код искать людей вместо того чтобы решать собственную задачу зрячего сроки уезжают а менеджер коли конечно же переживает из-за уехавших сроков до после того как наш вася разобрался с api компоненты которые ему нужны ему нужно интегрировать каким-то другим компонентам и у нас повторяется та же самая история когда опять нету аннотации он читает код и при этом там еще некоторые вещи стандартные например фильтрации они сделаны по другому и он опять это все пишет и он опять дублирует код и вообще все плохо ну и конечно же у него от этого еду сроки от того что ему плохо а менеджер коля опять очень сильно расстроен а и наконец ситуация что менеджер коля увидим что все-таки api есть его нужно сделать платформы и выставить в продакшн до обещает его партнером интегратором и тут выясняется что на самом деле она не описано а весь саппорт и евангелисты и все вокруг люди бегают шоке а деньги попадают менеджер кодов растрировать да вот просто как коля за релиза на конечно замечательная пик вас решает что все что он сделал вообще плохо он послушал замечательные доклады на ход да и начинается переписывать разумеется вся все интеграции при этом ломаются ну и конечно же менеджер калия в шоке а что из этого ну то есть отзывается у нас настал час утра до утренняя гимнастика да кто из вас сталкивался с апатии обратной совместимости опять что-то разрабатывали и вдруг так раз и вы поднимите руки эти достойные люди вот которые до помог вам хорошо молодцы у меня тоже мне тоже да вот а а кто из вас сталкивался с тем что api не консистентной то есть одна вещь сделана не знаю там операция в одном это сделано одним образом а в другом методе по-другому о и слушать как много нас с вами объединяет а вот интересный вопрос такой а у кого из вас вообще не было проблем с этим поднимите руки 145 человек счастливых людей да и главное вы запомнил этих людей им а призы которые мы там собирались давать не положено у них уже и так и большой уровень счастья вот есть так что все что мы как вырезали да это проблема с этим и казалось бы сделать хороший 5 не так сложно да есть такое простое достаточно определение чтобы хороший это тот api который а легко easy to you start to miss you а и дальше вокруг этого какие-то процессы так чтобы все внутри было консистентные к гладенько и смузника пока вода но на самом деле теперь это не просто какой то кусок отдельные деятельности как devops или q&a это состояние ума всех участников процесса и наш доклад сегодня будет сфокусирован во многом на том как какие вспомогательные средства могут быть использованы для того чтобы помочь всем участникам разобраться важности и 5 и как-то починить свой образ мысли о нашем докладе не будет да в нашем докладе не будет каких-то технических деталей мы говорим концептуально мы говорим с точки зрения архитекторов компании также мы не будем углубляться в какие-то детали арест и теперь мы не хотим показать вам как сделать фильтрацию мы хотим вам показать как правильно построить процесс внутри компании чтоб вас все работало хорошо и еще я уже упоминал роман slogger для аннотациями мы не будем углубляться в эти детали мы писали на этот счет статью на хабре так что отсылаем вас к ней вот а структура презентации у нас будет достаточно простая вот мы вначале обозначили какие-то боли и вот по этим полям и примерные пойдем на каждый более мы опишем к симптомы разберемся в причине а поставив диагноз то есть не хватает только медицинского халата такого костюма медсестры а вот и какие-то опишем возможно и лекарства которые на наш взгляд по имени мы ее скажем как их использовать и так боль первое а у вас есть аннотация аннотация не отвечает не повторяет работу сервиса при этом подчеркнул это не какая-то случайность об этом в принципе скорее компании знают какие симптомы у нас есть наш уже известный программист вася к нему приходит менеджер колье говорит вася давай ты нам разработаешь api который считает статистику по конференции highload вот есть вот такой замечательный метод васи берет свою аннотацию и садится писать код так как за дальше относить небольшая ему там горят сделай за два дня он садится за день день все пишет после чего начинает запускать оказаться что ничего не работает то есть наша аннотация является не валидный в результате он начинает читать год он начинает все переписывать и из-за этого сроки у него едут конечно же поэтому от сказать что когда аннотация не соответствует имплементации это не обязательно что-то что устояла то есть это не то что вас на канал о ваше темное прошлое которое было ужасным и а пугающим иногда это бывает от светлого будущего то есть вы или архитектор вашей компании проектировали сервис он должен быть когда-нибудь очень светлым и очень прекрасно но вот пока он находится вот в таком состоянии а но это как выглядит сверху а причиной является то что люди не понимают насколько значима аннотации и использует ее как какой-то вспомогательный инструмент не предполагая его внешне использованием какое лечение можно посоветовать то есть с точки зрения вот таких докторов а вращающих разум а во первых первый инструмент это архитектурное вьет не знаю кто нибудь из вас компаниями такой продукт как архитектурное view а вот кто-то да дай даже кто то вот ну то есть на самом деле очень полезная штука почем полезная для любых масштабов компания когда у вас есть архитектор команда архитекторов деспота team leader или а не знаю слишком ли просто программист который знает как правильный котором как правильно вот здесь можно уже сразу . ставить который знать как правильно а вот и этот человек является или этот комбинация людей является единой точкой принятия решения а и таким образом когда будет изменяться сервис а будет проходить архитектурное view и в этот момент этот архитектора или кто то может сказать что вася ты должен обновить еще нотацию она сейчас нехорошо а второй возможный вариант который прям очень такой мега правильный дату если вы хотите все делать совсем хорошо а это генерация кода из аннотаций то есть подход который называется опишешь подход но он такой когда изначально вы проект делаете роман или swagger из него генетику от благо tool замена у концов на достаточно а этот код чините по дороге потому что все генераторы не слишком хорошие и а после этого вы наполняете ставы бизнес-логика конечно это не защищает вас от ошибок в бизнес логики но что приятно как минимум схем of the authentic ации авторизации будут правильно и корректно и наконец какой еще вариант лекарства здесь может быть это построение процесса тестирования когда аннотация тестируется против имплементации что это такое это у нас есть аннотация из не йоги яйца клиент клиенту скармливается последовательность запросов ну то есть ходящих данных для этого и этот клиент beat service запросами если он получает а что ожидаемо значит хорошо нет а значит плохо вот вообще вот такое тестирование это задача достаточно нетривиальная более того если вы хотите сделать все красивые автоматизировать то автоматически допустим если за тепло и ненужные сервисы уже может быть не просто в некоторых случаях но вообще нам нужно иметь вот наш сервис предположим что у нас уже есть у нас есть его аннотация как там это дело протестировать у нас есть несколько вариантов вариант номер один так как у нас есть аннотация в принципе у нас есть методы ходы рая и вот видите все данные о папе мы можем попробуем сгенерировать из них какие-то цепочки запросов которые будут автоматически запускать и проверять что сам запрос валидный и что ответ описан именно в нашей аннотации однако тут возникают сложности с тем что любой api содержит зависимость внутри данных самая банальная перед тем как нам попросить дать какой-то ресурс each типичный то есть делать get a нам нужно сначала его предварительно создать но в реальной жизни разумеется эти зависимости намного более сложные следующий вариант мы можем попросить разработчика описать эти запросы таким образом мы точно знаем что все наши api покроется полностью то что это писал человек однако это время разработчика к сожалению и третий вариант это мы можем взять какие-то реальные или около реальные данные например поставить либо на боевом сервере либо на каком-то тестовом окружении какой-то прокси который будет блокировать нам вообще все мы будем брать этот блок данных строить из него запросы и их запускать однако тут тоже есть проблемы так что для себя мы выбрали вариант со ручным самим тест мы написали tool за вину и на царь с тестов последовательность мы написали такую-то зорину которая принимает описание запрос в ком декор декларативным землям и и тут основной что хотелось бы сказать это параметры в угловых скобках адрес это уровень сервиса разумеется он передается нам через com онлайн после чего рандом нам возвращаясь случайную строку можете брать внимание там есть response товар это в эту переменную с таким названием будет записан body нашего запроса который в ран тайме мы выполним таким образом мы сможем обратиться в нижнем запросе в дети к поэтому адэшника получить конкретно тот объект хожу мы создали полечил боль один мы переходим к второй более когда api оказывается противоречив причем противоречив наказывается иногда api одного компонента противоречиво api и в другого компонента разработанной ваши же компании либо это уже совсем жизни до когда он противоречив внутрь самого себя вообще в данном контексте мы воспринимаем консистентной как внутреннюю непротиворечивость и вот к нашему вася опять приходит менеджер коль из какой-то прав говорит дай мне пожалуйста еще информацию о статистику о запросах которые не запросах докладах которые выполняются рассказываются на хайло де он и говорит вот смотри вот у нас есть фильтрация по годам после чего говорит а давай мне еще еще одну статистику там тоже у этого метода есть тора фильтрации по годам и вася абсолютно с чистым сердцем пишет ровно по той же логике столь фильтрации код запуска это кажется что не работает в результате приходится опять переделывать работу из-за такой некой ассистент настя ну причины как вы видите она все строится вокруг слова разные по imei которые только что показывал володя например талантливые люди сделали год то строку это числом ну например это разные форматы одних и тех же данных называем год значит во всех api год будет там числом или строкой договоритесь сами но главное понять это решение котором будут все согласны или не будут согласны но будут настолько насильно наказана что будут ему следовать а второй вариант 2 что это например разный язык запросов фильтрации а как будет устроена страничная организация понимаете что legend как не знаю по-русски назад поджиматься больше на господи какие у нас русские слова а вот а и разные схемы авторизации разные схема авторизации на самом деле самая болезненная штука потому что мало того что это путает мозг программистом и внушает неприятности это еще сильно отражается во первых на тестах которые должны будут поддерживать разные схемы и даже какая-то реальная вещь как знаете есть такие штуки оперативен сюда вот на портал единица апина информация и чтим el kez с генералом индексом point point он так вот там есть price it иногда блок есть у вас разные схемы авторизации используется для разных это поинтов мало кто из утилит может это поддержать нормально 1 более того если даже ваш микро сервис используют два других микро сервис которые используют разную авторизацию то это означает что вам нужно написать две разных авторизации ну как со ко всему из-за этого в общем ягода и прочее чем причина причина конечно же в том что у нас нет единой точки паять решения ты все разное происходит от того что нет единственно а но понятно что не всегда эта единая точка понять решения возможно особенно когда у нас компания не в пять человека например 5000 до люди индекс наверняка и знак да твоя тари а тогда из используется не единая точка появится решение о некие единые стандарты и обращение к этому единому стандарту а какое же решение здесь может быть решение в головах всех окружающих первое решение конечно опять архитектурная и view да то есть если у нас есть один архитектор dice под тиран и вообще страшный человек через которого все должно проходить т.н. если не обладать запри не сделает api консистенции как то так или иначе второй вариант это создать этот стандарт стандарт называется и 5 гайдлайн кроме того чтобы его а разработать или использовать какой-то существующей его еще нужно внедрить а и для внедрения есть одна такая полезная штука как разработки каких-нибудь статических проверок аннотации на соответствие 5 гайдлайн у тоже понятно если у вас есть какой-то стандарт какие-то вещи можно проверять какие японскими кожными скриптами до чтобы все это работало кошками не скриптами а вот а ну конечно же вопрос да цепи aika online а вот кто из вас когда-нибудь читал такой документ как и 5 гайдлайн от paypal а там майкрософта гугла гугла да вы читали меньше четверти на самом деле так а у кого компании есть свой 5 гайдлайн что за чудный компания расскажите интентов а вот а кроме этого и может люди из вас участвовал разработки и 5 гайдлайн а уже три человека целых а ну собственно что такое этой гайдлайн и что нужно то есть самая сложная наверное вещь по поводу бегать лайна а это понять что в нем должно быть ничего не должно быть решение здесь не может быть общего да это всегда какой-то поиск компромиссов как вообще мне кажется все в архитектуре почему потому что чем больше вещей вы включите выбегает line а тем о тоже вы как ограничиваете свободу воли и заявления программистов а тем сложнее с другой стороны вам его написать потому что большое количество ких то граничных случаев а и тем сложнее программе снова почитать того что если документ составляет всего то ничего 100 страниц но то есть вы понимаете какое количество людей до читает его до конца да вот и поэтому если он будет очень краткий то он может оказаться бесполезен что мы включали в этом ну например мы включали история про конвенции именования так казалось бы очевидным disney кейса или кем-то еще так можно договариваться но например все же знают все же используют весты знаю что там допустим и именно какие-то вырасти до казалось бы но например представьте что у вас есть талантливый чинильщик который первый раз в жизни увидел лес да но не всем же знание раздается от рождения нас молоко матери как-то ну вот как бы получается что приходится им учить и рост и для них не очевидно что нельзя использовать глагол и название то поэтов очевидно люди мужем это пояснить не от того что как бы как то у них не сложилось в жизни с интеллектом а просто потому что вот опыт другой нерелевантный а описать фильтрации и поджи нации конечно же все эти схемы лучше описывать чтобы просто они были общие для всех история про гранулярный ролей вы понимаете мы все знаем что очень важно поддерживать гранулярный столе еда для лучшего доступа контроля прав доступа но если в одном сервисе главная роль называется самая могущественная называется админ вот этим она называется a super user 4 она называется 2 называть super admin ну то есть это какая-то не консистентной тоже она будет раздражать она тоже будет выбиваться а и конечно же нужно писать такие общие паттерн и как вот как сделай настроить batch как настроить кэширование да какие хедера мы для этого используем здесь окажемся фигуриста ну ладно еще например важный момент который удобно описывать выбегает лайне смайте здесь про бизнес улитку нет ни слова до выбегает лайне обычно только то что относится ко всем сервисам ну например описываем два ответа такой же в этой пищи вопрос является ли пост едим патентному не знаю читали статью на хабр было очень классно статья от яндекса по поводу этим патентного поста про то как там человек вызвал такси и у него был не едим патентный пост один может быть итоге человек который писал эту статью нет я в ему лично сказал спасибо жалко жалко жалко вот а ну и какие же лекарство еще кроме 5 gold line и есть этого логически они так как мы оговаривали уже и пикает line это замечательно но вам нужен человек который это все проверяет случае большой компании человек плохо масштабируется поэтому самый лучший способ принять такую практику это как-то автоматизировать для себя мы уже и 5 написали и поэтому мы постарались найти в нем какие-то такие формализуем ее вещи которые можем проверять а статически допустим вся и на каждый pull request для нас это например мы запрещаем использовать нестандартные 4 методы также мы запрещаем дам использовать например head так мы решили также стандарты части он позволяет использовать там любой и че тебе метод с любым кодом возврата однако с точки зрения здравого смысла возвращать 201 created из гетто это неправильно и говорит о том что что-то пошло не так и мы можем на самом раннем этапе это зарубить ограничиваем что найти под статус мы ограничиваем не у нас есть набор кодов который мы разрешаем остальное срезается вот так же когда у компании несколько api важно иметь общий префикс для того чтобы все было опять же консистентной для себя выбрали формат flash api slash имя сервиса слэш буковка v и целое число версия сервиса ниже мы проверяем что у нас все все форматированного сна и кейси вот так же мы уже говорили про важность авторизации и если в вашей аннотации авторизация не описано то есть на 0 вероятность что в сервисе тоже ее нету соответственно мы проверяем что хотя бы ваши аннотации это авторизация описано ну и также когда у вас много разных api очень важна для того чтобы разработчик который пользуется вашим api мог легко спроецировать опыт использования одним open а все остальные в компании поэтому опять же консистентной и мы проверяем что например ошибка вот тело ошибки набор полей который возвращается что они одинаковы для всех сервисов компании с точки зрения опять же один раз пишете код и он работает работает с этим вылечив эту нашу болезнь переходим к следующей следующая полей заключается в том что api не имеет какого-то нормального внятного человеческого или машинного описания да вот к нашему бедному васи опять приходит коля с просьбой дописать еще одну фичу на этот раз эта статистика по посетителям конференции и нашлась уже наученные горьким опытом лезет в аннотацию и виде там следующую картину нифига не описанных программист который реализовал эту фичу буквально неделю назад он благополучно написал и ушел в отпуск так что опять приходится идти в код и опять читать и опять тратить время ну а менеджер коля вырывает волосы либо на себе либо на этом программисте олеге который вернется из отпуска да а какие же причины она как выглядит снаружи снаружи это выглядит набором префиксов не первый это незаполненное поле description найти такие from all in vogue есть такие поля discussions и вот дальше многие программист окей ну год users ну это же понятно что год users но зачем не заполнять это поле description и не заполняет потом постепенно что-то с методом происходит какие-то ограничения накладывать что-то мутил и конечно же controls & control в это же любимый как бы помощники программиста да а вот и оказывается количество уже какая-то сложная функциональность которой нет дискрипшн а кроме того если вы видели вот appearance at any заполненная поле дискрипшн делаю такой ищите мальвину некрасивый прям вот наша документе возмущаются некрасивой поэтому поле диска лесу должно быть заполнена всегда а вторая стоит а есть а к еще поля экзампла есть более к заму вот это поле за папа тоже многие не заполняется тем что но типа но это же очевидно ночью экзампла поставить но не всегда это очевидно особенно это не очевидно для документа то а еще поле example используются например в опять же тихо 1 фланцем для того чтобы создать некий дефолтный запрос или экзампла может использоваться для тестов ну и наконец наличие nittaku sirman их функций а это не то что там тайны возможности вашего pedo которые делают вас крутым программистом а это как бы именно проблема с сиренью и отсутствием документированием какие же корни у этого до первое это опять же нет понимания кому и зачем нужны аннотаций аннотация опять какой-то у нас ну какой то документ кому-то надо кому-то не надо а второй нет коммуникации между техническим писателями и программистами технический писатель лук те люди которые а в дополнение к performance будут описывать ваша и пи ай да если они будут в растерянность изнеможения или в чем то есть а команда проигрывает а и наконец нет представления стоимости плохой документации то есть очень часто во многих компаниях программиста надежность за изолирована от всех пользователей то есть вы написали классный api который оао все проблемы с ним до решаются порт и вы не знаете стоимость решения то есть если к вам каждому программисту будут приходить на каждый запрос и вас спрашивать после 50 а его повторения вы наверняка заполнить аннотацию потому что легче написать чем отвечать непрерывно олень она очень двигатель прогресса какой же здесь лечение может быть в данном случае в наших головах первое это помощь в формировании правильного видения это сделать генерацию от мира и france этого документа доступны для программиста то есть и программист будет видеть как а выглядит документация для его коллег или для других программистов но то есть у него будет больше мотивации сделать ее более того если он будет сам пользоваться быть самой пользоваться да да док fucking а вторая это настройка вот этого каналов связи между программистами и вот евангелистами саппортом кем угодно очень помогает и наконец можно сделать тесты которые будут использовать например поле экзампла для генерации запросов как только программист понимает что вау теперь если я эту запомню за меня протестирует но это же очень здорово да как же не воспользоваться такой прекрасной физической возможности вот и слова поперек фрaнс совсем недавно мы выпустили портал девелопер . кроме стачку к можете зайти посмотреть да это просто демонстрация эта задача была для нас новое и мы решили и как раз со стороны аннотации api то есть мы генерируем на основе вот наших аннотаций вот такую красивую чтим или ну которая уже готовый портал который содержит все что нужно и все методы и схема авторизации и экзампла и можно даже потрогать объясняет бывает до c или клиенты на разных языках дабы вы можете прям скачать набор исходников для вашего там любимого языка программирования на не очень экзотического а вот но это как бы такая сложная штука есть и бесплатная утилита которая тоже в принципе неплохого качества дают на тот же самый editors моя деталь . свои гор . его это официальная такая дымочка в которой вы можете прям там редактор вы можете написать свою нотацию сразу видеть как она красива отображается вот и наконец наша последняя боль то надеюсь ваше утро еще не слишком утомительно оказалось это боль api которая внезапно развалилось работала работала настроенная интеграция и вот ее не стало теперь вообще жуткая ситуация в компанию наняли стажера проходить стажировку и вот он неправильно понял задание своего ментора и для такого безобидного метода как как хавчик он сломал обратную совместимость он был джейсон возвращался стал возвращаться строка как это обычно в жизни бывает по какому-то мистическому стечение обстоятельств это его коммент попал в рот и сзади плелся результате все вообще сломалась и сервиса который отвечал менеджер коля он вылетел на 4 часа не работает конечно же в этот момент у стажера сильно сократились шансы на прохождение стажировки вы понимаете совершенно мистическим и количество не седых волос тоже сократилось до вот это зависит а так вот в чем же причина причина первая причина это вот опять неактуальной аннотации то есть когда забывают обновить аннотации вот она разъехалась одно против другого аннотация по имитации никто не заметил второе как это выглядит это кот интеграции который вдруг перестает работать то есть тихо не было апдейта или за не там не было выпуска новой версии она просто не отвечает а еще как это выглядит снаружи а это end of life для этой которые происходят совершенно спонтанно для внешних пользователей и релизы которые тоже оказываются как снег на голову под этим всем стоит то что люди не понимают жизненный цикл api они понимают как будет это дальше жить чтобы починить эту как бы нестыковку в голове нужно же конечно архитектурное view да то есть если на архитектурном review рассказывает о том что ребята дорогие вы сейчас ломаете обратную совместимость для вас это будет стоить поддержание дополнительного apis дополнительные переходники а вы сами знаете кто то все наверное со стола с обратной совместимости вот этот код прекрасный до который должен поддержит несколько версий да он обычно такой ужасный вот просто кошмарный один раз это пройдя у больше не хочешь а вот этот отказ от объясняют стоимость поддержки старая версия можно сделать статические проверки она обратную совместимость чтобы проверять что commit роман не swagger измените а или что угодно не разломал случайно обратную совместимость а и каким-то об и еще нужно настроить своевременное обновление документации чтобы а 1 франции при генерале чтобы документа тары были в курсе происходящих изменений и могли выкатить потерь ну такое сопроводительные документы для интеграции внешних этого описан как сделать апгрейт на новую версию api в основе всего лежит то есть базовая вещь которая описывается называется чем же менеджмента то есть управление изменениями и там есть кусок которая идет внутри а и который кусок идет снаружи что у нас внутри внутри например мы рассказываем о том где у нас хранится аннотация наш может храниться вообще в отдельном репозитории да может вместе с кодом если одной из любовниц конечно очень сильно упрощена но не всегда такая лапа бывает кроме этого а это же политик очень же менеджмент объясняет когда нужно сделать бам версия чтобы памперсе понятно да вот это вот инкремента кроме того в чем же менеджмента policy мы обычно объясняем и каким-то образом настраиваем как отдел документации должен узнать о происходящих изменениях за полем же и что угодно а и наконец вот эти проверки которые каким-то образом нам рассказывает о том что совместимость была поломана готовьтесь готовьтесь будет плохо снаружи chain management а делает понятным для внешних интеграторов цикла или за например говоря что если мы выпустили версию api мы обязуемся поддерживать ее целый год следующая версия будет тогда-то апдейт вам будет стоить столько это делает людей понятно то что предсказуемо но уже не так болезненно кроме этого очень полезно понять такие две вещи понять кто использует ту версию которая войдет концу и каким образом этих людей ратифицировать потому что а вы понимаете что если бы изначально не заложили а такое поле как там usa юзера или что-нибудь еще и не связали его с е mail то у вас работает какая-то интеграции вы не знаете кому она принадлежит так вы не знаете как понять все ли пришли не все ли пришли какие какие статические проверки у нас могут да в принципе имея нотацию мы можем проверить что каждый новый комменту обратно совместимы с не ломают в принципе проверить это достаточно просто нас любое аддитивный изменение к тому же добавляем что то новое а на совместимость не ломает а любое удаление и соответственно изменения то есть удаление при добавлении чуть но вы не ломает вот соответственно есть одно исключение когда мы добавляем какой то обязательно хедер или параметр то обратной совместимости что же ломается соответственно мы можем это легко автоматизировать для этого нам нужно иметь две версии аннотации это текущая которая пусть унаследует в мастере и новая которую мы хотим за пури квесте то есть замерзнуть мастер вообще аннотация она имеет такую древовидную структуру и можно так представить когда у нас есть и стинг point и у нее есть методы и у нее есть там параметры испанцы соответственно достаточно это все распарсить после чего просто проверить что нужные поля есть там нет здесь соответственно выдали ошибку вот на примере наших злополучных half чеков велика который мы написали уводит вот такой вот результат видно что для gipfel человек для испанского до 200 у нас изменился response соответственном выдаст единичку и любовь сломается так что мы можем на очень раннем этапе вот такие возможно это была даже не злой умысел это просто было ошибкой мы таким образом предупреждаем что вот ты случайно удалил вот аккуратней будь иначе потом от это вот очень мы рассмотрели все основные более и теперь вот каталог представленных лекарств которые мы предлагаем да ну то есть конечно же обязательно консультация специалиста да это не является рекламным предложением как вы все понимаете они все лекарства одинаково полезны то есть я считаю что зависимости от размера компании цели компании от оси является ли и перед публичным или она использует только взаимодействие между ее компонентами да а могут быть разные вещи но то что безусловно полезны это архитектурное view то есть если у вас она не включена в процесс компания она там должно участвовать она всегда приносит пользу а вторая вещь которая здесь может быть достаточно было уделено внимание это средство просмотра валидации рамы или swagger или какой там аннотации вы используете ну тут понятно что это предупреждает от простых таких вещей как просто ошибка формата да и просто разработчикам так удобнее в принципе достаточно просто сделать но при этом разработчик там или архитектор может нормально в стандартном месте это написать как-то сохранить становится хорошо а вот третья вещь которая очень полезна эта настройка вот этих вот чем же менеджмент то есть даже если вы сейчас не предполагаете этапе на публичная как-то а лучше уже союзе ради добавить до это будет задел на будущее когда вы вдруг решите что-то выпускать и продумывать это генератора 1 france эти от узоры на не просто очень полезны для программистов для того чтобы вот это вот так fucking у нас все таки состоялся статические проверки которые представляли пробег комплекте был не compatible изменение или на проверьте соответствие пикает лайнам и теста аннотация весов имплементация штука ну она полезная на самом деле она должна трудоемкая с точки зрения разработки стене не если у вас не вообще ничего нет над всем посмотреть какие укусов усилит они быть достаточными для вас тоже самый феликса ну или какой-нибудь стажер студент запросто может и когда загорелась а если не развалит вам обратно совместимость проводим дано можно вопрос не пускать конечно не пустишь его вот и 5 гайдлайн это еще одна вещь ну то есть еще одно из лекарств который я много раз упоминала но которая на мой взгляд не всегда не безусловно ней для всех полезно потому что и сама его по себе выработка на выработка создания разработка до снимает входит количество во имя иисуса все и меня тоже хорошая штука мы даже укладываемся в наше как бы тайминг и у мужа переходим к выводам то есть если бы я сама пытались что то продай да и рассказывали типа мы вот обратитесь к нам и консалтингового агентства или купите наш софт мы бы рассказывать что идти по такого что используйте это не используйте это вы станете ваши волосы становятся шелковистыми а ваш уровень айкью повысится сразу внезапно в разы а вот оно к сожалению таких простых выводов мы предложить не можем мы можем сказать что ключевая задача построение хорошего pieta наведения порядка в головах а мы сегодня надеюсь продемонстрировали вам какое-то количество инструментов которые помогут это сделать спасибо вам данная понять все спасибо мы этого послушать ваши вопросы да мы будем рада слышать ваши вопросы и гораздо есть еще конечно же какие-то призы и у нас есть еще две лицензии наконец вот злой вам огромное за ваш интересный доклад позвольте вручить наша благодарность спасибо больше замечательный органайзеры вопросу так угол могла пасов ноги когда тебе микрофон у меня его нет я мог вам только такой дать добрый день добрый день скажите пожалуйста какие вы использовали общие подходы к аутентификации сервиса он у нас хоуп стандартный такой клаус непосредственно из попы вы непосредственно сами сервисах проверяете конечно вьюв скупых сервисов тоже правда ну то есть получается что от самопроверка если вы хотите добавить новый скоб она потребует доработки кода самого сервиса верно но смотрите там зависит на самом деле от того является ли этот сервис бизнеса вандой или является он внутренне потому что вы понимаете что есть какое-то всегда каида у платформа где тоже много сервисов которые тоже друг друга аутентифицировать даже также мы иначе без аутентификации это наше все же дома же security вот поэтому там есть разные подходы то есть ли мы говорим по бизнесовые сервиса туда добавление нового скопом может потребовать переработок внутренние все проще они рассматривали подход то использования печью за опеки твоего имеется ну а пикеты у нас есть но он немножко другие функции исполняет но это мы тоже рассматривали вариант но там есть ограничение а какие ограничения ну например если вы будете внутренней сервиса всегда пускать чая солдатика случае , у вас возник увеличивается нагрузка на пике твоя снижается объем штабе рования но все зависит от того как вы будете инфраструктурного разворачивать это все конечно но вы же знаете над нами выкладываю проблема upon стояка до это называли щекино этого keystone а вот этот вот keystone который был призван аутентифицировать все возможные и становится узким местом поэтому здесь разные есть варианты дайте сады подхода спасибо можно все-таки еще последний свой api где твои и ли вы использовать какой-то по ндс на мы использовали а свой но у нас есть еще мы рассматриваем сейчас дополнительные средства потому что новые задачи встают и и конечно же какой-нибудь новый да опять же тоже выглядит примерно интересно он владимир спасибо за доклад один маленький вопрос если ваш год лэйн вам помоги где его посмотреть а наш гайдлайн мы планируем сделать публично пока еще чуть чуть не дошли руки но я собираюсь тогда следующий вопрос вы же разработки его на что-то ориентировались какой можете порекомендовать сейчас особо is gold line of на то есть а безусловно имеет смысл смотреть выдачу был хороший гайдлайн у майкрософта права вообще их несколько есть есть paypal есть microsoft есть google microsoft глазки специфичной а дети хорошее но опять же все равно придется очень сильно адаптировать понятно банально у вас там есть какие-то практики уже внутри компании которые сложились у меня такой вопрос то есть а если у вас понятие интеграционных тестов и если они есть таким макаром сломался хавчик и как это дошло до брода мы не говорим про наше который мы говорим об гипертрофированные ситуации это для исключено людям акции просто здесь спасибо за доклад такой вопрос все говорят генерировать и запекут как вы смотрите на то чтобы наоборот из кода сгенерировать я пишу какие проблемы вы видите не поддерживает этого потому что ramal настаивать на том что опять остов получи поэтому например смагин такой позволяет корректировать из комментариев но есть одна известная проблема как часто ваши комментарии в коде актуальны не хочу комментарий писать код я хочу из написать какие-то методы ну как папа программисты вот этих пойдет я видела такие подходы тоже да и даже что-то в них есть интересно например вы можете навести большое количество собственных ключевых слов но надо понимать что в этот момент вы инвестируете в разработку собственной утилита вам придётся это делать самостоятельно есть можно отсылка к никуда посмотреть какие инструменты вы видели а я говорю что мы видели и стандартных swagger намолотили это только у swagger и есть возможность генерировать просто из комментариев а все остальное придется вам делать самостоятельно то есть да и что состояние видела что это сложная с удачному себе день добрый вопрос вот смотрите весь такой подход по аннотации с помощью генераторов день или цикл вы использовать это подход а мы на этот вариант модели но у нас получается что api по отношению к объёму бизнес-логики оказывается небольшой api по отношении к большой бизнес логики поэтому для нас это казалось не актуально и возможно вы знаете там есть проблема там есть очень большая проблема под названием того что вы должны очень четко верифицировать получен из гениальный кот мы видели ошибки этих генераторов спасибо я так понимаю мы говорили в общем смысле пропитать и как публичный так и внутренние конечно вот пропали номер четыре это обратная совместимость эти вещи для внутренних айпи и pr как вы относитесь к концу мир гривен контракт тестированию слышали про такой подход консьюмер driving on through this thing не так допустим пакт этот вопрос что очень советую посмотреть он как раз решает проблемы обратная совместимость если вы используете внутренние на самом деле это не всегда нам на мой взгляд не всегда хорошо ее составлять потому что вы как раз хотите часто оптимизировать свой свой сервис и убрать обратную совместимость потому что новый кабель просто лучше правильно и посмотрите может быть в это стороны то интересная тема вот тогда может еще второй вопрос про использовали вы какие то можете посоветовать тулы которые автоматически проверяют документацию я вот на 51 если что-то же бред как может быть вы что-нибудь использовать можете посоветовать сталкивалась с тем что говорили от всяких тулак управляющих документацию у нас мы такого не использовали то есть то утилита который мы используем для генерации документации она очень мощная да то есть дорогущая но мощный смысл сама написано или нет это мы покупали внешней сервис а то есть как бы ну для вас писали написано персональная это не какой-то софт который можно внешней которые вы можете купить да у нас тут время заканчиваю спасибо за доклад очень интересно было послушать меня такой вопрос вот мне видится что решением по крайней мере половиной проблем которые вы указали будет просто бомбить версию роутера пикалов и все то есть у вас есть какая-то бизнес-логика вы описали и его функция а после этого составляете отдельные роутера пикалов то есть он будет вызывать по версии то есть вы сдержите одновременно версии все просто старые версии можно объявить эти приедет в том же пену и почему не использовать такой подход потому что ну он проще сильно проще смотрите а если у вас поймите что тогда вы просто бам пойти версию делаете что-то 1 во первых вот как только вы bump 0 версия всем остальным кто использует ваш сервис да им хотя бы and point придется переписать да где-то то есть у них придётся внести хоть какое-то изменение если вы не будете поддерживать старую версию поддержит несколько версий то есть можно конечно разруливать там часто делаю так же рано унижены кстово того же сама до битвы этом разруливают а входы чтобы перенаправить там sv2 на в этой и прочее но всегда это работу которую вы перекладываете на других то есть а когда вы работаете вот с кем то с большим снаружи кто написал уже достаточно сложный код вам должно быть его жалко не совсем они не совсем в камере мой ответ я говорю о том чтобы вообще не трогать старый кот вам боится версия если изменились фичи в каких-то каком-то коде то им предоставляется другая версия то есть вы для к абсолютно все функции сохраняете в исходном виде вы только обнар добавляете код и все у нас после девяти вно изменения то и вообще проблем нету заключается и стоя в том что иногда например вы хотите внести какие-то ну например даже вы изначально у вас было историческое наследие с разными схемами фильтрацию решили перенести это на дудин оптимизировать бы на вы жили у вас узкое место или пришел большой пласт пользователя до нужно дать им почтовые запросы можно сделать отдельный инфуин для почему запросам можно модифицировать ставлю и поломав обратную совместимость то есть да это компромисс можно просто каждый раздел только идите на изменения видели такие подхода но есть нюанс то есть ну да аддитивные изменения не всегда возможно но в целом это почти все возможно сделать аддитивном тогда вам придется тащить старое грязное мерзкая кому это нравится посмотрите на intel x86 до которой тащи свои то и историческое наследие им очень тяжело живет 10 10 люди зонтов и нету хорошо спасибо а здесь вот еще девушка все поднимала может ли последнего вращение у нас уже не осталось пения важны ваши фавориты в кларк наши фаворита бывает и вот девушка спрашивала по аутентификацию ей можно про котиков"
}