{
  "video_id": "w4JuKSMOMi8",
  "channel": "HighLoadChannel",
  "title": "Big-Data-процессинг пользовательских данных из соцсетей в AlibabaCloud MaxCompute / Максим Алексеев",
  "views": 594,
  "duration": 3054,
  "published": "2019-05-15T02:17:39-07:00",
  "text": "представлюсь я salewa огонь и занимаюсь тем что связано разработки бэкенда и бритый во всяком случае в той части которая происходит московском офисе и до того я также занимался проектами связанными с обработкой данных пользователей из соцсетей других источников поэтому сегодняшний рассказ он будет такой компиляцией всего того что чему я научился как у него веток и да не им то есть это некоторый момент играли экспириенс потому как можно работать с внутренними и внешними данными о камерах зачем вообще нам нужны какие-то внешние данные а кастами я думаю что для такого количества людей которые пришли на обиды это трек этот слайд бесполезен но тем ни менее применение огромное количество начиная с обогащение данных в нашей внутренней серым качанием данных пока стримеров и заканчивая персональными рекомендациями построением look-alike моделей и возможностью более точно объединяться по данным с какими-то другими партнерами когда такая ситуация в конце концов наступает любом случае данные и юзер айдентики это долговременный актив который сложно переоценить в кратце о том какие данные бывает по принадлежности мы их обычно делим на fest c контент 45 убейте зависимости от того кто владелец first это мы сами собрали цикл это данные партнеров это двигатель внешние данные отличия second and third обычно в том что в случае паспорт легкими данными вы можете допустим улучшить юзера фаллические соглашения так чтобы они позволяли вам обмен данными от r51 это обычно передается и покупается без всяких юридических историй и по большому счёту это довольно секретных сейчас в мире после внедрения и pr в европе рынок данных переходит из отступать и ко всякой плоти в основном по типу они бывают профиль связь и поведение и по устареванию мы делим на статичные такие когда-то рождения пол так далее полу статичные такие как географию текущей город гражданство уровне образование и обучение и быстрые или временные такие как check-in'ы посты и комменты собственно сегодня сегодня будем говорить в основном о профиле если успеем еще курс графинюшку говорим и о статических данных то есть мы сегодня не говорим про opel time мы сегодня говорим про пакетную обработку более-менее постоянных данных пользователя те которые не устраивает либо у стреляют редко поставка задача окна что мы хотели сделать на входе у нас есть разные источники данных о людях akkas мирах это могут быть наши собственные ткани данные это могут быть данные сети партнеров какие-то данные которые мы получили от куда то они все разных форматах но там есть информации об одних и тех же людях мы не знаем пока как они именно мочиться и на выходе мы хотим получить единую базу некоторую структурированную с понятными полями с понятно таксономий где в идеале одна строчка и трон один человек вот на вход и выход что мы хотим получить и мы сегодня поговорим о том как это можно сделать а почему в заголовке доклада есть социальный данный пост и потому что эта модель например хороший там есть и фото и gear и обычные поля и солнце граф и поведение это хороший пример на котором можно показывать данные из то тот подход который барон применим посольство к любым внешним данным и соцсети здесь нет не обязательно но мы говорим именно них есть эти пример которые будут показывать это немножко исходников этот я расскажу о том как мы это делали там до либо бы немножко вали бобе это делается случай али-бабы с пишите мне нравится макс компьютер макс компьют это да этот хаос решение которое входит в alibaba клауд оклад интересно одна из компаний внутри компании alibaba это достаточно большая штука она умеет исполнять как песка или запросы так и не придет джо бы игровые задачи и даже хостить мышление к модели на самом деле можно сказать что макс компьют это нечто где в одном флаконе есть ходу есть hive есть пик и даже spark streaming да это вот такой вот комбайн который умеет делать очень много сока мазком пьют именно вали бобе повторил где-то туже историю которую престарелого мо зоне то есть делать и куда из компании осталось точно большой чтобы возникла необходимость автоматизировать на структуру и задачи по пути планету по аналитике по трафику и так далее соответственно эти сервисы создаются внутри потом возникает отдельный класс бизнес это было случаем озона и либо получит прошла тот же самый путь не исключение если сравнить цифры вот на этом слайде на этом то понятно что где-то половину мощности аль клауда сейчас потребляет сам alibaba здесь есть список внешних costume of он довольно большой известные китай компании в том числе очень известный но они не китайский не все но большинство из них китайский поэтому их название мало что кому здесь говорят вкратце мы сейчас поддерживаем более полутора тысячах людей сунув более полутора более одного экзабайт данных и больше миллиона таблиц в этом до этого хаусе то есть довольно серьезные объемы это по всей либо групп то есть не только aliexpress это там это бал и алипий и тимол и так далее взяли бабам там про это 50 компаний какие есть способы взаимодействия с этой с этой штукой их много во первых это мой любимый это плагин для int или же те которые так называется max and plugin он позволяет писать и скольки исполнять их писать как вы живы писать про десны джаббы советского комплектом с такими приятными штуками с возможностью быстренько посмотреть как job и исполняются в этот самый симпатичный цветастых граф покликать по нему посмотреть как наши школьные операции замотались в в казань из 3g смотреть на этих 3g происходит какие бегают данные посмотрите стандарт стр и если нам приспичило или если всяких проблем и и так далее также есть плагин для раскрыли которыми ни разу не пользовался есть кому блайн клиенте java клиент есть python клиент и разные другие способы работать с отвечу в плане мы говорим про ту часть которая касается самого скурили и здесь мазком пьют совершенно совместим с hiv то есть если вы захотите решить одну задачу поведение профилей но вас не будет нас идет под рукой вы можете абсолютно все тоже самое сделать с помощью пачкать а вкратце по масловой ты это собственный источник данных грубо говоря например нашу собственную ты не данные там какая социальная сеть через которую мы сделали допустим лагин чepeз клаус протокол и вот теперь можем собирать куча филиппа получаем токи нам или что ты чем сырье это вот данные в том виде который мне приходит источником аккаунт это один аккаунт человека в рамках одного дага source то есть это один профиль нашей системе или один профиль steam конкретность и и профиле то никто синтетическая сущность это когда мы научимся понимать что а там же одному человеку профиль это то что получается если всех объединить как мы там и делать четыре основных шага во-первых импортируем сырьем во вторых делай нормализации это по сути этель процесс по очистке унификации форматов и удобством очистки данных делаем matching это тот самое понимание потом что разные профиль бюджетному этот человек и дела emerging это мы объединяем данные в одного человека решаю те конфликты возникают по ходу архитектура очень простая прям вот до боли у нас эти самые четыре шага вот наше сырье вот таблицы с которых мы это сырье загрузим эта табличка аккаунтов дана куча на позиционирована плода это соусу дальше происходит ник 3 магия с митингам и на выходе у нас получается табличка профилей она здесь не почему не позиционирована обычные функционирует подать для нашего примера это непринципиально соответственно вот этот шаг это импорт этот шаг это нормализация это митинг и это мир сейчас мы пойдем слева направо по всему этому процессу по поводу сырья мы еще до либо вы пробовали разные форматы хранили сырые профили в амазонии хранили их в манге а в случае либо бы я поэкспериментировал с с с форматом от компьютера когда ты хранишь данные не of таблички с полями а кореш их в не структурированным файлик и сам проводишь finder для стерилизации цивилизации ты сам можно хранить фото и видео с помощью этой штуки можно хранить с xml и так далее все что угодно если есть соответствующих инга или ты можешь написать а мы пошли самым простым путем итоге этот путь нас никогда не подводил создается таблица не создается одна колонка строковая дородный его туда закидывается эта вода это почему именно так скажу чуть позже весь пример того как то может выглядеть я буду в качестве собственных данных использовать пример айтал это у это социальная сеть и которая принадлежит к либо bing и она объединяет некоторых лидеров мнений и логгеров с их поклонниками и покупателем на самом деле это относительно коммерческая соцсети там где апелляции партнеры собираются аудиторию чтобы помучить какие-то продукты но эти не менее то соцсети на пляже то либо обеих ушками соответственно создание таблички с единой колонкой и пример того как мы заливаем данные внешне если нас есть внешние данные от без вы ведь можно заметить есть будет с это старое название макс компьютере там где там эти включается audi ps это вот и есть макс компьют просто его историческое название до долго как он стал public первый шаг нормализация есть 3 разных табличках нам нужно получить аккаунт что нужно сделать во-первых определить стаханове во вторых поделиться с имитацией таксономия это список тех атрибутов которые нас интересует и список возможных значений для каждого трибута понять и пришло из биологии означает любую иерархическую классификацию но ребята из цеховые рекламы его несколько переосмыслили и сейчас в такой рекламе таксономии называется вот эта самая распиновка профиля на атрибуты зачастую обобщающая атрибуты чтобы не было идентификации персоны который дальнейшем используется для рекламного таргетинга здесь ты к славе показано очень так сказать детская чтобы просто понять концепт данном случае это вот возрастные страты 4 штуки пол два значения инком level 3 значения интересы там категории есть импланты не жалел там мы тоже несколько теорий когда нас интересуют записали это детский пример стоящих умер можно посмотреть по ссылке на а и эбби например лаборатории они постараются оставить некоторую большую автономию для для рекламы она состоит из 4 уровней вложенности насчитывает порядка полутора тысяч листовых категорий чтобы смотреть более protection and можно открыть ее и познакомиться но вот для нас первое что нам важно это определить какие на самом деле поля нас интересует вот в этой самой единой базе это очень важно а второе да по еще по таксономии нам нужен придется не по току с набором полей на этих форматами мы пробовали самые разные варианты на протяжении низких лет тех проектов разных которые я делал до любви не во львове в итоге никаких рекомендации которые можно дать во-первых дробить данные максимально-максимально атомарном тут же тоже дата рождения это не одно поле а три потому что они скачут фрагментированы вы садиках где то есть год рождения где-то нет большинство значений которые вы считаете в дефолту одно зачастую не одно это те же властные мы иногда это даже пол как ни странно об этом поговорим дальше и естественно это унификация формат все что все все те поля на которые есть какой-то внятный формат лучше использовать потому что это облегчит интеграцию будущем здесь показаны те стандарт но это на самом деле стандартный двухбуквенные костная буквенный код стандартный код skoda страны и с плюсиком и дальше без разделителей и индекса момент которую я арендовал пример того как можно любить класс аккаунта у нас весь бы комментов го либо бену не весь большей части написано на java соответственно для нас логично использовать java в комбинации с тем же макс компьютер но там используете питон можно использовать а там еще что то но вот мы любим jal мы используем это некоторый пример того как может выглядеть что есть интересно ну это технический полям это тот граф и училище вот этот пример того какие поля нас могут интересовать никто частные балластные мы части дата рождения gender или джон и так далее все эти поля являются списками более того списками с некоторыми против рапирами то есть и просто список стрингов имейлы а список некоторых wrapper почему список в этом имя поля пол вот допустим мы поставили суд кнопку контакта или одноклассников или фейсбука на свой сайт юзер пауз нас зарегистрироваться вы получили talkin' спросили этот пайпе а его профиль от туда приехал в том числе пол ну зачем нам сохранять пол список а смысл том что в этой категории вот этот самый аккаунт это такая промежуточная сущность здесь не конкретные значения здесь никаких кандидатов значения в будущем когда мы будем его нормализовать у нас будет например оценка пола по имени фамилии допустим и у нас будет тогда пол который приехал из профиля 30 на самим человеком apple которые посчитали там основе наши аналитики например по фио ну простейший пример то есть все вот эти вот дата а потом и которые лежат в этих списках это некое значение это некоторые кандидаты которые в будущем мы еще с мертвым и поймем что на самом деле там находится поэтому такая модель вот это тот самый wrapper wrapper это по сути метаданные нас кроме самого значения вот этого самого были есть некоторые метла никто нас интересует там ваш случай будет ваш но некоторые четыре поля я рекомендую использовать в качестве обязательных и the time сталин когда вы впервые эти данные заметили ее забрали это этот класс вы тот самый трется can dance party дай там то есть наши партнерские чужие это флажок траст а доверяем ли мы данным в этом это собственно пример мы интегрировались там нашу платежную систему из какой-то государственной базы получают информацию о людях и о н н или как допустим и этот человек нас регистрировался через соцсеть и у нас это мы там приехали данные допустим о его городе стране и а поле ну наверное мы больше доверяем государстве базе чем с отстегни вот такого рода флажок и компьютер это значит что данные не бред ли нам как факт а данные нам достались вот эти вычисления вот тут же самое определение пола по фамилии это вот хороший пример именно компьютер или мы сделали coupe concept посмотреть какой вариант канализации бы ты вот лучше будет ли у нас лучше написать после на придет жопу руками или сделать например и skype + 1 мы утюге функцию виде функции и секунд эти типы и все остальное то же самое что в хейвене будет оставаться в части склеили у нас компьют совместим с каких-то дополнительных штуки уметь делать никто и штуки быстрее но в сущности это вот тоже самое а в итоге вы придете был намного хуже папа читабельности намного хуже power возрасте по количеству кода и с учетом одинаково перфоманса all при пакетной обработки нас performance на самом деле волнует там плюс минус 15 процентов 20 ускоренный с костью дев был прям вот намного понятнее проще и лучше сопровождался поэтому я покажу как мы сделали именно этим путём и сколько выглядит не так что я смотрю на нее снизу вверх снизу вверх т.е. сначала что мы делаем берём таки таблички данном случае это профили френды и группы мы их объединяем поедишь ник человек затем мы собираем об это комплекс type мы построим qstring это не ключик который мы называем сами и данные map это такой очень простой и пиа и который позволяет и соску или любые данные передать в jal причем в том случае когда мы точно не знаем кино какой там тип данных и сколько именно их там будет очень простой и правильный способ но там по моему опыту работа edge к нам и этот миг прервется никто костанай функции вот этой самой это нормальность нашем случае эта функция собственно и превращает эти кусочки данных в структурировании и сохраняется это дело ну и потом результату select сохраняются в соответствующей партицию табличка аккаунт это функция довольно большая то есть там много кода на самом деле во всей этой истории с профилями с внешними и внутренними данными большинство кода находится именно нормализации кроме того вот нормализации это то тот то место где объем кода линейно зависит от количества источников а все остальное matching kommerling и так далее ты написал один раз и забыл обновляешь когда текст экономии может быть но не меняешь когда у тебя 2 лет новые данные зависли на здесь показан некоторый общий pipeline общий подход к тому как работает та часть нормализации copyright источника не зависит которое общие для всего а именно у нас есть некоторый chain chain это список обработчиков список обработчиков которые предается контекст контекста это некоторые холдер для значений которые передается по цепочке и по очереди каждая нота этот контекст принимаете что с ним делать в конце контекст возвращает нам просто построенный аккаунт и мы возвращаем вокансон почему меня так зачем же какие-то чайные и почему так сложно почему нельзя просто взять вот у нас есть сырье вот нам вот наш объект или заполнить мы расспросили сырье заполнили поля как бы готова потому что вот есть часть которую нам на самом деле нужно определять нужно реализовывать когда мы держим как когда мы загружаем новый источник данных нам нужно понять вот допустим наши персональные есть во сне джинджер емейла аккаунт и нам нужно посмотреть наш силен и попасть оттуда все вот эти вещи а но кроме этого кроме этого есть также всякой аналитика и всякие другие штуки например нам нужно имя петя какой-нибудь трансформировать петра построить каноническую форму нам нужно вытащить допустим нас на своем есть емейла допустим они нас интересуют для поиска или там для майнинга и мы эти email и забираем том числе изымает как открытой части майло во многих емэйлах в соцсетях по моему опыту в качестве адреса особенно в коммерческих mail для коммерческом плане встречаются телефоны и который может забирать вот такие вот находки периодически включаются и чтобы каждый раз звали не новы источника не вспоминать где-то могут быть интересные вещи мы один раз написали всякие аналитические ноды да и всякий муж еленин которые у нас применяется к сырью он тоже может родиться здесь только что некоторые быть уровне аккаунта они человек это все та же может находиться здесь то есть и еще очень важна последовательность поэтому идеальный идеальный нормализатор это когда вот этот вот код прикладной где парсинг на самом деле пишет даже не разработчика какой-нибудь бизнес аналитик а вот он смотрит на сырье просвечивает что вот эти поля там это телефона это фамилии to email a и она поехал и мы к этому принципу близки но еще еще не там у нас еще сделать такие собачки а дальнейшем вся machinery она выполняет уже автоматически с учетом всех зависимости и порядками да и в конце собственно говоря вот подклассов которым эти вещи реализованы в данном случае вот пример дополняем source заполняем аккаунта иди после берем вы серьезно случае царю это джейсон моего вы посетили взяли а хищник и так далее и телефон накручивать телефоны лежат в трех таких полях мы из джейсона эти телефоны забираем на сам деле средства нужны попросить должной политика боксеров да все но мы не здесь это не показываем тоже по всем как передать и не относится у нас не сильно интересует поэтому будем считать что это и телефона мы получили мы их очистили оставили только правитель вон и корректный синтаксически корректны и сохранили их контекст должны просто вот написали все готово но как вы думаете вот есть полиморф он одной из салфеток с которым я когда-то давным давно работал еще одно либо бы он заполняет человек многие и generated соответственно когда человек находит свой бой в настройки там рядом с полем написано мобильный телефон и поле для ввода как вы думаете что люди это заводит поднимите руки те кто считает что там только мобильные телефоны а ты читаешь а там полный трэш ты считаешь что например имейлы да на самом деле это может быть приблизительно вот так это все публичные данные как бы естественно не не олива башенные но тем не менее я как бы их запрыгнул на всяк случай действительно там куча трэшем но встречаются и телефоны причем в самых разных форматах более там встречаются имейлы некоторые из них биты но некоторые нет а были этого там если вы тянуть мои слоговой тон в час инстаграм и если ваш поход по твиттеру там будет twitter фейсбук будет facebook то есть на самом деле фишка соцсети в их данных в чем если в каком-то поле находится user-generated контент нужно искать там всю нашу таксономия ну кроме не знаю там полная не стоит искать в этом поле но вот все типа аккаунтов например в поле мобильный телефон если анджи юзер generated искать имеет смысл на большом объем если у нас действительно данных скапливается можно находить по моему опыту десятки миллионов имейлов в поле который называется били телефон вот такие забавные истории да теперь сам интересно часть мы сконструировали эти самые аккаунты нам нужно собрать его человеком как мы это будем делать основная идея состоит в том что мы вводим некоторые понятия digital agency человек то есть чем человек в 21 веке идентифицируется всего лишь где здесь некоторые краткие распиновка по тому какие типы бывают во первых это контакт эти самые милые телефоны мобильный skype и так далее это биометрия обычно мы говорим о голосе и например у нас есть константа мы записываем звонки соответственно можем голосовые печатка собирать людей совершенно законный это фотки если вы соц сети у нас есть куча фоток это девайсы как и девайсов рекламная диет и плоский и android . это и вас оценить те самые пока иди иди и так далее все то что мы обычно получаем добавляя социальный логин на наш сайт например или социальную регистрация через соцсеть а это cookies естественно и наверное коллега из прицела который выступал для меня можно сказать на тему намного больше но у меня как бы в основных экспириенс он как бы несколько меня вот с другой частью всей этой истории и это всякие хитрые штуки когда например мы можем использовать шлеменко делать это дополнительный тайги человек например и был эксперимент в объединению по митингу данных фейсбука по моему с одноклассниками пассос графу по 1 кубику зей грубо говоря у нас есть имя человека есть список его рублей и вот использует два таких множество 2 такие графы мы можем с хорошей на самом деле стояночной площадке 85 процентов определять 800 мест о-оу-оу мы можем определять идентичность это делала одна из российских компаний когда час уже не существует вот они сделали ночью статью по моему они опубликовали кому интересно как это делать можно потом ко мне подойти я выделю собственно и девкой где эти исследование должен вчера я прочитал новость что китай научились идентифицировать человека по походке то есть вот тоже пожалуйста пример в объеме 3 ну данные походке вряд ли собираем будучи интернет-компанией ну вот то голос и водки у нас вполне даже могут быть этого мы учились понимать вот эти вот один человек его и далее у нас есть атом туда на крючок берем смотрим всем аккаунтов один на два и так далее до 7 первое что мы делаем мы берем соединяем черточками все аккаунты которых который делят ник 31 например у них есть общий телефон вот а4 а5 и мылом и бедлам у них есть допустим общей там контактов ские один у них есть там ссылки на один и тот же facebook умники что-нибудь о чем соединяемся аккаунты которые верят никто секаторы а дальше у нас есть какая мысль что если аккаунт и аккаунт б ч ряд 11 тыс это 10 человек то добавляя туда еще один аккаунт мы позитивным делаем заключение что все вот эти вот цепочки один два три теперь бюджетном этому человеку если мы эту штуку по индукции пройдем мы придем к тому что нам нужны те максимально связанные подкаты которые связаны с этими вот четкими lim kim и таким образом мы сводим задачу начинка профилей и задачи поиска максимальных по графов большом не связано графе это более-менее стандартный горит он называется комитет компонент он может быть не так широко известен как бы drunk не так часто встречается в ротик но он были менее 200 его научились делать ногах мы придется несколько лет назад и сейчас он есть во многих игротека в частности я им пользовался в сексе со спортом и в mass компьютер с нашим внутренним имитации внизу есть две пятерки систем и систем эры то там истории с которых началось началась реализация алгоритма connect компонент на мы продюсер и они научились собственно делать эту штуку параллельно за хорошего графическое время они как-то хуже вот с тех пор супса это можно делать я в конце поделюсь на моем экспириенс и мы делали это на спарке на довольно большом объеме на самом деле чудо либо бы это была боль то есть у меня периодически на маленьком графе все работало маленьки граф то типа там 10 миллионов вершинок на графе в 300 миллионов вершинок все работало очень плохо и я разберусь разбирался пытался понять почему этому этот мальчик сам падает в итоге просто дал на амазоне 2 терабайта оперативки и он почитался за полчаса вот я так и не понял почему она подала то есть не логе ничто не помогло мне понять нам оскорбительно намного приятнее вы просто однажды программировали запустили она отработала я вот прям вот после это очень поверил китайским технологии мне очень понравилось ну казалось бы то есть вот мы свели нашу сложную когда свой проблема к простому регулирующую известным алгоритм грамм решение которое нашли готова но кучу проблем проблема номер раз посмотрим теперь вот у нас мы соединили на графа кишками посмотрим а такие книжки разных типов самые самые часто используемые только у говоря посчитаем топ по вот этому вот песку смежности по нашему графу допустим по емейлом и отсортируем по убыванию количество аккаунтов которые к этому с этим емейлом ассоциированы и вот эти и email и здесь вот какие то 94-м игру 95 93 их там тысячи то есть тысячи аккаунтов имеет этот email мы могли получить через aus если с этим аккаунтом к нам допустим этот лагерь смыва могли получить а если этот e-mail был в профиле в информации обо мне и мы этот профиль собирали на мипо opechee развалу строкин как угодно но вот по всей базе вот такая вот прикольная титька получается то есть как бы привет бота по телефонам 7 семерка 7970 и семь двоек и так далее как ни странно раз два три 4 5 шесть 7 не вошел в топ 12 коза хотя казалось бы то есть это вот это случай когда человек вводит в обязательное поле что то что вот надо ввести а водителю не хочется вот такая из соцсети мятежниками то же самое это конечно не там я ничего там не человек информации обо мне пишет вот всякие свои иди моих нормализуем сыграем мы получаем вот такие вещи металлом того что делать но детский вариант мы берем вводим просто никто и ты шел допустим там если аккаунт встречается больше чем 10 20 источниках наверно он грязный и мы его не используем очень просто выкидываем более взрослый куст кроме гистограмму количество вхождений на процент аудитории и это гистограмма будет иметь ярко выраженный пик в начале и потом она быстро и будет иметь длинный длинный и тонкий хвост тех самых уникальных нормальных один из теста мы можем этот длинный тонкий хвост который валидный отрезать раз мы смогли это делать руками мы сможем это сделать и автоматически посмотреть какой объем а4 нас интересует и отказать полку фунт аполлион номер два стабильность в чем она состоит состоит она в том что вот мы построили этот финале дарит на выходе алгоритма компонент пары но до аегисом графом соединенного де компонент как назначается де компонентом эти компоненты назначается по разному в случае sparco он сучек graphics он требует чтобы ноги были langa mine просто числами и тогда вам в качестве компонента минимальный long минимальную вершинку случае макс компьютер вершинки могут быть строками там он дает мому для чистой графическим минимальную вершинку но в данном случае это было будет вот a4 a4 это айди всего со всего под графа ну казалось бы kay но жизнь не стоит на месте мы интер римским c новыми источниками мы партнерами с кем-то по данным мы хотим строить нашу базу все побольше побольше и допустим между какими-то новыми аккаунт не возникают новые связь соответственно если эти аккаунты поджать разным компонентам они сольются в 11 и nadeshiko в компоненты исчез более того допустим мы улучшили нашу парсинг мы перестали всякие грязные данные допустим там не знаю мы просили телефон и какая-то часть номерная емкость и вывели из обращения мы их вот убрали и теперь телефоны которые меня лежали они вот неправильно они ненастоящие они исчезли то есть между аккаунтами могут линки исчезать ответ если могут линки исчезать граф компонент может развалиться на 2 может закрыться и тоже как бы это может быть не проблема если мы и вот этого сохраним у себя внутри используемый для какого-то таргетинга таких сегментации для обучения машин их моделей для себя но если мы вдруг как я от предыдущей компании dell выдаем такую по data как сервис наружу еще не добавкой пьянь и у нас есть ли пяо метод взять плойки человека его профиль или там его друзей и пойди и людей что то походите смотреть то это грусть потому что черный рейтинг и они поехали поддерживать redirect и не здорово есть некоторые мысли поводу того как ты сделал лучше в частности на же не только вот эти пары есть который на выходе collect compounds у нас есть никто быть незнание мы знаем эти источники траст кинет растут мы знаем что некоторые атомы связаны сильно вот например a4 a6 между ними 2 связи вот опять совсем этим графом связан похуже он вот у него всего одна связь зато с двумя и используя данные предыдущего matching используя данные о количестве связями принц можем прочитать несколько центра масс в этот граф ведь никто не более стабильную воду в качестве а потом лиза хэшировать или построить и последуйте наедине использовать в качестве эти компоненты но опять-таки и идеального решения которые вот позволит сделать стабильные один вечер например щенки когда нас могут добавляться и удалятся данные невозможно просто можно сделать получше следующий история мы рассмотрели такахара блинки когда вот email или даже вот через out человек залогинился значит наш профиль и вот этот вот профиль соцсети связаны жестко мы знаем что это в соответствии но бывает же текстами биометрический stories фотографию например бывает от упомянутых сыграв бывает там что-то еще и эти модели они возвращают нам не 01 если вас нет связи они возвращают нам нечто между нулем и единички то есть обычно все те же поиском по геометрии он возвращает ближайшую свёртку и этом оценку точности совпадения который может миру единички nokia как бы что делать ну сделать можно следующие можно ввести reduction функцию который будет вот множество связей между каждой парой аккаунтов перекусить до одной связи 1 ходовых которые либо если бы нет детский вариант суммируем все who's a link of которыми разными аккаунтами если они превышают допустим восемь процентов покажу что да это аккаунт и мы достаточно уверен что не связано берем в качестве link если нет то нет взрослый способ у нас есть данные о harling можем взять всю нашу базу смотрите аккаунты как-то связано прям сильно в неком 2 связи и жесткие или больше такие вот например cort a4 a6 или а6 и а7 дети тут подмножеству наши базы посмотреть где в нашей базе есть те суд линки между теми самыми аккаунтами поставите перте где есть и те и другие используйте это почти обучающей выборки для бинарного классификатора когда вы на вход подается связи нечеткий а на выходе с 0 или дичка и поехали так это будет намного интересней дальше просто лживые данные естественно там гейнера это данные там есть и и и странные штуки вот pom.xml экспириенсу опять-таки duo либо бы мы смотрели разные источники данных том числе например информацию которые люди оставляют на сайтах польской работ публично оставлять и удивительно но услуги очень часто оставляют одинаковы email или телефон на вот таких вот сайтах с резюме я понять не имеющим связанным но это факт это я проходил и зачастую возникают внизу что если таки источник данных вдруг попадают к нам наши рабочие с это получается что у нас два аккаунта имеют нормальный не от трэшевый уникальные они допустим умел и они разного пола и вот ты их мир жешь и получается помесь вот странная будете получается так то получается что не должно получаться это не очень большая проблема на большом объеме но тем ни менее случается что делать ну мы можем сказать если мы можем человеком определись что эти давайте проекта не принадлежат одному и тому же человеком мы можем сделать и машинам мы смотрим на какие атрибуты собственной обращаем внимание например пол в мир фотки например возрасту то есть дата рождения какие-то штуки на которые мы опираемся чтобы понять что нет это все-таки разные аккаунты несмотря на то что имел них одинаковы и вводим по вот этим атрибутом этот шток нами отрицательные весам нас получается теперь еще и отрицательный несет нечеткие линки таки строим ким трудом чаще в баку здесь уже с учетом вот эти вот особенности придется видимо какой-то кого-то все-таки сделать и обучаемся по ней в идеале сделать matching который там будет так же хорошо как человека определять интернет-кафе одному человеку линетт довольно сложно можно к этому долго приближаться но наверное для бюджета задача это на самом деле не нужны и вот я говорю и одевать и телефонов а не к его постоянно и мы знаем что это не так то есть мы можем compact 100 грядкам завершить телефон пойдет в пул через проводят может вы данному человеку и как бы телефон тоже люди разные но для когда-то задачи нам не нужно собирать дворца конкретном человеке нам это необязательно нам нужно сыграть информацию о который быть а вот она объеме соответственно если у нас там 1 2 3 процента ошибок в этом матче нге есть две вершинки ну как бы есть не страшно допустим мы потом стенку это таргетинг по ним заплатим чуть больше за показов баннеров ну и ладно чуть больше 2000 один процент merging собственно окей мы научились даэрон случае все эти проблемы который я описал это все просто фильтрация лимитов выставка клинки есть мы применяем connect компонент и уже готов причем это делается для митинга покупкам в ogilvy платформах и можем использовать похоже вот способ и для наших внутренних данных обвиняешь внешними быстро как мы повторили творений нам нужно данные смешивать в человеком какие есть проблемы проблемы могут быть например те что данные приезжающие из аккаунтов например дата рождения день рождения они могут не совпадать мы например в одном аккаунте допустим нашей собственной базе написан 13 января 90 го года а в другом аккаунте которую получили соцсети при uslugi там написано 15 января того же года хочу делать роста или 15 ну опять-таки идеала нету но есть некоторые интересные способы как это можно помешать во первых у нас есть три основных стратегии это собственно с флопа вы не уникальных значений это мода и лист схлопывание применяется обычных контактами и подобным например те же email и вот у нас есть прямо в этом аккаунте 2 и майло в этом аккаунте мы просто скрепляем их оставляем уникальными мода это имеется статистическая мода самый часто встречающийся элемент в последствии например там два аккаунта пол мужской в одном аккаунте женски но мы считаем что все таки мужчин тоже самое с именами так далее или целью для некоторых полей вроде там have kids marital status тоже или личные планеты l300 что меняется со временем там нам имеет смысл дать просто наиболее последнее значение которые мы успели заметить то есть для начала нам нужно чтобы сделать какой-то learning нужно взять наши токсинами и для каждого поля правительство кинг мы собираемся поменять но данную сначала по опасному флоп мы тоже делаем это с помощью удавки более того вот здесь вот искать скобкой подсвечена это функциями ваш аккаунт которая по сути просто берем наши аккаунты объединяем их с линками аккаунта person группируем по персонам и применяем нашу функцию наш аккаунт казалось бы и можно было бы реализовать как удар юзер define the creation of an но так как то он сам и так далее на пределе радиуса как бы когда мы группируем но по факту никакой стратегии вроде тоже моды намного проще реализовать если использовать обычную д когда ты придешь примут списка в данном случае вот именно коллег 3 ст список и предается функцию почему так потому что во первых могу считать проще намного понятней когда ты работаешь аккумулятор денег дополнительно стоит его зачастую нитки бы не хватает просто аккумулятор нужно делать сложнее с обычной девкой проще и количество аккаунтов приходящейся на одного человека даже при большом объеме источников данных она всему счетной она как бы насколько и там будет 035 в основном иногда 10 допустим 100 если это странный человек он положил свои аккаунты какой-то непонятной причине тут есть не жди важно их тысячи миллионы не будет поэтому реагирующую функцию писать не обязательно можно пойти более простым путем сделать обычную и вот это пример реализации стратегии на дистинкции для и емэйлов то есть у нас есть вот несколько 1 человека они уже мы уже знаем что вот они аккаунт этот один человек и мы сверху вниз проходим по нему то есть берем для каждого каунта имейлы захлопываем их в один длинный список это список группируем по уникальным емейлом и вот делаем никто передачи на котором я скажу чуть позже он подсвечен скобочкой потом мы получившиеся уникальные значения собираем берем и софтину добычи сортируется еще по темпам чтобы начале были самым последним на это уже опционально и поскольку вылез этот наш самая основная коллекция которые мы храним обертки с метаданными мы коллектив это самый коллекции что же за такой хитрый так что по значению состоит в том что вот у нас приехал один тот же e-mail допустим из нашей базы и совсем один и тот же имел но его раза метаданные у нас он как бы например класс у него c1 он first спать и и соцсети допустим это центре зарплате вот этот класс на сам деле очень важно атрибута будет зависеть от того чтобы что вот эти данные можем сделать если данные наши мы с ними можем делать что то она что он нам что нам позволяет делать наш лидер agreement делать маркетинговые коммуникации там еще что то если данные внешние вы существуют те же самые этого мы выслать не можем звонить не можем и очень важно не проводить этот момент что если один и тот же момент проехал там и там выбираем тот класс который который эффективный эффективный класс это минимальный то есть если у нас то мы читаем что наши мы не можем ссылаться на то что парень ты же этот e-mail оставила той соцсети год назад публично для всех и доступный персональные данные мы поэтому вот его отыскать и пожарили где там нет нельзя под росстат опять-таки мы берем если все кусочки которые пришли пришли из разных источников и а нет если хотя бы один из них просто то мы считаем что объединение тоже каста по компьютер мы считаем что если все компьютер то тоже пьют все очень просто темп минимальный и среди всех которые замечены есть мы сохраняем в качестве темпа время когда мы впервые заметили какой то кусочек данных опять таки если у вас будут какие то свои метаданные дописываете 101 который вам нужен да и секунду ну да наверное на этом мы остановимся я подумывал еще рассказать про merging с графом но по времени мы не успеем и это такая небольшая тема зачем все эти упражнения делать то есть вот использовали мы вот это все построили вот этот самый офигенный профиль и собственно что дальше ну я могу поделиться некоторыми цифрами которые были у меня дома либо бы дали помимо с внешними данными не работаем мы как бы делаем другие вещи у нас достаточно много внутренних до некоторых более структурированный долива бы я работал именно с внешки которая совсем несколько бирона и мы собирали данные массивно больших объемах и потом делали никаких сервисом для нас коренко для входа для frenzy к и так далее если взять типичную коммерческую компанию которая не неэтично не google или facebook она как появился играет email и телефон на костре она как была не собирает диаметр в том числе фотки как правило также не собираются associati даже если социальный лагерь есть зачастую пазах его нету и предоставить этими не могут вот в таких случаев при объединений внешних данных заранее вот pride подготовленных с базой костюмеров получается порядка 35 55 процентов пересечений то есть это вот для такого количества людей из наших касперов можно имеет достаточно большую базу внешних данных что-нибудь новое найти что именно новое естественно зависит от того за данные какой вас бизнес там для как ни странно вот независимо от бизнеса независимо от типа можно получить например удвоение количества телефонов значит пост насчет того что мы получаем новый телефон диверсант людей не те которые у нас было добавить некит можно полтора раза увеличить количество email опять таки за счет того что это них три новый mail можно получить информацию которые люди обычно легко оставляю соц сетях не напрягаясь состав семьи друзья наличие детей так далее и которые они обычно с трудом и не хотят оставлять в камешки компаниях вот вы можете спросить законный вопрос ну окей как вы получите дополнительный телефон и человека но этот человек даже если не публичные и даже они вероятно публично если мы получили либо они получены через talkin' чуть не делать у нас нет согласия на на контакт мы не можем позвонить эсэмэски ну тут есть разное во-первых да мы не можем звонить но мы можем зафиксировать этот телефон загрузить этот хэш во внешнюю систему ретаргетинга фейсбук tarkett и легендах аудитории или ещё куда-то показать ему планет вот конкретно персонально ему или показать ему пост-советских рекламный то есть на то что мы не можем жарить отвинтите этого 9 мы можем по нему tarkett обидится и второе что не каждая технику более близком вот эти вот эти какие-то вот эти кусочки которые описывают оденьтесь человека они чем больше с источником тем больше орешников тем больше связаны с граф то есть она возрастает нелинейно чем больше источников данных тем лучше связаны компонентов и качественней они получаются и в долгосрочной перспективе вот эти вот лишнее телефон и поэтому мы не можем звонить очень нам пригодятся когда мы будем объединяться с какими-то внешними партнерами по данным мне кажется что перспективе с учетом роста тренды на секунд покидать дату с учетом того что архивы за закрывает с вот paty данные возможно что-то похожее будет 8 мы в конце концов придем к тому что партнерств у больших компаний по данным будет все больше а значит то чем больше нас способов за коннекте данные тем лучше мы положение вот всем спасибо большое кто хочет задать вопросы простим спасибо за доклад очень интересует сколько составляет время полного этого пепла и на прихода сырых данных damaging аккаунтов ну смотри действительно здесь больше была продана и держали по самарском пьют но тем не менее на вопросы по маскам пьют и тоже готова треть а если взять несколько сотен миллионов аккаунтов из набора источников то нормализация займет на наших мечетях порядка 15-20 минут на источник совместно они могут работать параллельно затем matching проходит за 10 минут это сотни миллионов аккаунтов единицей миллиардов связей и jing находит тоже минут за пятнадцать то есть весь парк лайк если вы сделать досаточно параллельным нормализация статической который можно распылить займет . сейчас получается мы говорим каком порядке аккаунтов не результирующих профилей аккаунтов на входе аккаунты на выходе профиль вот на входе несколько миллионов спасибо здравствуйте спасибо за доклад расскажи пожалуйста вы как-то разделяете все множество баров или регионом каким-то кластером центром голос профиля всего мира ну да это такой момент наверное я не могу внедряться глубоко потому что у нас большая международная компания прежде чем что-то рассказать о внутренностях нужно получить кучу кулов на инфо диск лужах и так далее но астана идея на какая любого копирует в россии средств на нас нам все что касается данных владимила телефонов и имен и дат рождения каком применим закон локализации perdono значит мы должны хранить тут али-бабы есть это центр в россии это тоже как бы известно но aliexpress есть карта мира из из многих стран и да россия самая большая но есть что ты есть ты базилия есть практически весь мир поэтому на оба вопроса да да разделяем да я не мастер по всему миру еще один вопрос каким образом может быть я прослушал но тем не менее таким образом вы определяете вот это уникальный идентификатор который определяет прав профиль то есть там был разговор о наиболее стабильно быть в кадре есть какой-то буквально в двух предложениях может повторить если а потому что он как лина выдавать стабильные тика но в любой день и как просто потому что мы эти данные которым для себя я никогда наружную ходят до либо бы да мы как бы делали такую штуку у нас мы доведет теперь и по сути мы не сделали в улучшении айтишника мы сделали обходной путь мы гарантировали стабильности один течение трех месяцев и хранили таблицу соответствий вот у такого-то аккаунта был сначала такое эти такой эти такой виде так и в момент get запрос об api мы просто делали лука по этой штуки и брали последний это как бы не идеальный вариант поэтому если делать это промышленном масштабе до нужно улучшить алгоритма назначение айди кластера они а не писать родные с current потому как улучшить алгоритмы могу сказать потом на"
}