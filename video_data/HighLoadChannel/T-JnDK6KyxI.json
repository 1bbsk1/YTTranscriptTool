{
  "video_id": "T-JnDK6KyxI",
  "channel": "HighLoadChannel",
  "title": "API Gateway - как не допустить хаоса при цифровой трансформации / Алексей Коновкин (Nexign)",
  "views": 4553,
  "duration": 2832,
  "published": "2023-01-19T07:03:35-08:00",
  "text": "всем доброе утро меня зовут алексей канавки я являюсь разработчиком продукта и 5 твой и руководителем команды отвечать чей за развить инфраструктурных решений на базе джон x и в компании nexx ign который является частью и сорту в наших решениях мы сегодняшний доклад посвящен тому как и для чего используется 5 твой ван тела sharp ландшафте оператора связи что необходимо сделать если вы решите реализовать его собственными силами или на что следует обратить внимание если вы выбираете в какой-нибудь внешние решение поговорим сначала о предпосылках в мегафон в момент становления микро сервисной архитектуры как мегафон является основным клиентом нашей компании которая выпускает решение для telekom рынка когда стало появляться много команд выпускающих сервисы появилась необходимость в наличии иных стандартов единой точки входа для всех и pr в этот момент коллеги из мегафон стали изучать внешний рынок решений на сказать что это был где-то около трех лет назад и основными требования к единой точкой входа на тот момент были это быстро и понятная публикация и пиа микро сервисов прозрачные 5 самого решения для возможности встраивания шагов публикации микро сервисов вся и сиди ядром решение было современная используемая технология был удобный механизм установки решения с учетом особенности закрытой инфраструктуры мегафон и немаловажным фактором было знание технологии уже имеющийся опыт эксплуатации в мегафон к этому моменту уже в принципе эксплуатировался джон x от nyx ign адаптированный уже пан-пан инфраструктуру который умел управлять конфигурации через сервис registry и имел проработанные мониторинг и журналирования mvp пеги твой был разработан примерно в течение трех месяцев во время изучения коллегами из мегафон сторонних решений на тот момент времени он уже в принципе удастся реал базовым потребностям таким как сервисов попрыгав публиковались через и пьянь конфигурации разливались на все экземпляры через единый реестр уже была добавлена поддержка одессе и соответственно появилась возможность использовать всех основных методов модификации это модификация пользователя пароль у потоки ну интеграция авторизация коды flow и соответственно еще legacy и методы модификации исходя из эти из своих требований и уже на данный момент предоставляемых возможностей коллеги из магов он приняли решение остановиться на нашем продукте и развивать его силы minix она не покупать что то что то уже готовые так и появился макса и на пике твой здесь конечно сделать два небольших замечания необходимо понимать в принципе что любое коробочное ну в кавычках коробочное решение практически никогда не покрывает всех кейсов которые возникают и нужно учитывать что все равно придется выполнять какие-либо доработки а ну и второе ну будет небольшим лукасом сказать что 5 твой был разработан в течение трех месяцев все-таки он строился уже на базе существующего продукта продукты джинкс который выпуск выпуск который развивался в компания nexen уже примерно на протяжении 6 6 лет и на данный момент времени он по функциональности приближен к коммерческому продукту джинкс плюс от f5 ну он публично не продается он только является составом инфраструктуры в наших решениях ну и также были уже некоторые наработки по реализации распределенного каширования с использованием как раз продукт engine x внутреннего и и regis так давайте перейдем непосредственно части уже содержательной части доклада и обозначим вопросы на которую необходимо найти ответы если вы хотите реализовать свой пеги твоей я постараюсь на них ответить в процессе доклада на примере того как данное требование могут быть реализованы в общем и как они реализованы в рамках нашего и пеги твой давайте их разделим на 2 группы первая группа это требование которое но без которых не обойтись это маст хэв требования ну нам необходимо естественно иметь функциональность реализующая 5 менеджмент понятно что никак не не обойтись без гибкой настройки маршрутизации балансировки причем балансировки в разных вариантах модификация является также вне отец неотъемлемой частью этой битве в процессе обработки запросов нам достаточно часто приходится выполнять различные трансформации эта функция тоже абсолютно необходимо ввв при выборе опередит в ну и действительно часто забываю что на борт на борту необходимо иметь поддержку различных механизмов защиты и квакера вания ну из из пунктов которые неплохо было бы иметь на борту мы в рамках дна моего доклада только смогу рассмотреть вопрос авторизации оно в принципе не всегда нужно но будет очень полезно покрыть до покрыть эти пункты в своей презентации я не смогу в своем докладе поэтому следовать вещи столько на тех которые считаю наиболее важными перед тем как перейти каждому из конкретных пунктов давайте остановимся на не функциональных требованиях ну первый сама снова без чего в принципе конечно нельзя двигаться дальше это горизонтальное масштабирование наш про ту на наше решение должно абсолютно горизонтально масштабироваться 2 нам необходимо распространять информацию о сессиях токенах профилях по всему по всему кластеру третье нам необходимо выбрать распределены 3 устойчивое хранилище реестра ну и наконец пережми должны переживать различные типы отказов в качестве распределенного кэша своем проекте как я уже сказал мы используем редис который можно в принципе сконфигурировать как на работу в режиме hair ebay используем sentinel так и в режиме редис кластер с формированием на данном слайде представлена конфигурация для engine x понятно что здесь не все директивы стандартные для того чтобы мы могли объявить 2ab стрима который будет автоматически отслеживать переезд мастера в рамках кластера понятно что вместо regis вы можете использовать любые распределенные хранилище да я не упомянул что наше решение построено на базе engine икса и у нас очень активно используется в и если вы будете выбирать ту же самую платформу она чем-то похожа на на kong да ну то есть он тоже в принципе построена ingenico на engine.exe и с использованием ну а то просто нужно смотреть какие для нее есть драйверы для внешней в кэше ну точно есть ли кот бэйза тарантула memcache кассандры манга да и здесь на слайде представлены ссылки в принципе которые по которым можно ознакомится с с модулями которые которые используются для работы с редисом вот самый 2 2 модуля engine с динами хавчик как раз вот эти директивы чепчик exclude хост они относятся именно к нему той с помощью него можно можно настроить автоматический failover по сути дела в качестве хранилища реестр своем про продукты мы используем патч зайки пир но в принципе можно сказать что так исторически сложилось закипел уже долгое время использовалась как основное средство регистрации сервисов и конфигурации в других наших инфраструктурных решений от nyx они естественно до могут быть использованы и другие которые бы вам более считаете более подходящими и кессиди там под грей в принципе все что угодно перейдём непосредственно в функциям и пеги твой первая из них это 5 менеджмент в принципе любой 5 твой должен предоставлять такую возможность как регистрации информации о маршрутах ну это все понимают и ничего нового в принципе в этом нет если мы используем джинкс плюс джон x плюс ну а то у нас в принципе уже подготовим под руками есть готовое решение готовы готов готов готовая платформа на которой мы в принципе можем уже реализовать обработку rest и не даже не выходя за рамки самого engine.exe реализовать все что нам необходимо ну как это реализовано в данный момент у нас но если у вас есть в команде backend разработчики там java гол пожалуйста можно и менеджмента же реализовывать и на других языках программирования ван джон x оставить только функциональность которая непосредственно связана с единой точкой входа при проектировании реестра нам необходимо выбрать подход к тому как будут публиковаться конфигурации здесь в принципе возможны два варианта то есть так секунду так не нет пока остаемся здесь здесь возможны два варианта все публику все все конфигурации все публикуется независимо входящие порты юрио и up stream связи между ними вот это такое как бы получается очень гибкий конструктор ну не структурированный или можно выбрать вариант когда конфигурация предоставляется сервисом в едином формате в нашем пироге твой как раз все сервисы предоставляет конфигурацию в целостном формате и могут включать как кубики как матрешка зависимости друг друг друг от друга ну такой такой подход в принципе позволяет изолировать надя на море айпи и позволяет конструировать нам вот такие вот различные комбинации из них в данном примере комп а вот если посмотреть на данный пример то у нас здесь компонент один компонент 2 не имеют своих как бы прослушаем и портов то есть являются являются такими кубиками составляющими этом это обозначено как ли сон ли-сан all a service один у нас является единой агрегированные точкой входа которая регистрирует свой прослушивающих порт и объявляет у себя внутри зависимости от компонент 1 и компонент два после этого как бы все and point и компонента 1 и компонента 2 становятся доступны на парту 10 10 тысяч и соответственно здесь еще указано что сервис один будет использовать конфигурацию для модификации таких как египет теперь давайте поговорим о том как нам выбрать технический подход к реализации маршрутизации балансировки ну в принципе существует как минимум два подхода подхода это первое это как раз с использованием единого порта для всех вызовов он очень хорошо работает если мы мы внедряем этой битвой в чистом поле то есть мы строим все по-новому и тогда можем для всех сразу же сказать что вот нас 1-ый порт мы строим единые правила и все и все все пять будут доступны на едином порту ну и второй второй вариант это с возможностью разделения по портам когда мы используем и джон x мы имеем некоторые стандартные ограничения платформы как мы знаем конфигурация engine экстатично и и изменение выполняется только при выполнении рилот ну исходя из этого мы понимаем что мы не можем динамически добавлять и удалять прослушанную порты и не можем динамически менять список обстрел без в помощь без выполнения этого самого рилот мы поэтому как бы нас но вот на этом первоначальном этапе нам нужно как раз определиться с дальнейшей реализации нашей базовой функциональности ну и по сути дела мы должны ответить на 2 вопроса будем ли мы поддерживать эти порты или нет и будем использовать стандартную функциональность и джинны к среди балансировки через отдельный up stream или будем использовать балансировку через единый такая возможность имеется если у нас используется балансировка со скоростью la это балансер baila en джинкс балансир модуль который в принципе да имеет возможность задавать динамические адреса и адреса сервисов так если с ответом в принципе на вопрос о балансировке более менее все понятно то это чисто такой технический нюанс вот ответа на вопрос на вопрос о множестве портов в принципе дело обстоит намного сложнее и зависит от того насколько должен быть гибок вашей битвой и здесь нужно тоже ответить на следующие вопросы вот должен ли и перед рей публиковать различные веб-портал и но теперь где твой может использоваться как точка доступа к пей а может еще и используется как я и . публикации веб различных различных веб-порталов имеется ли в текущее время кит интеграции или или мы должны сами ними заменить существующее решение какое-то прозрачно или мы можем массово может быть запросить у всех сторон как бы подстроиться под наше новое решение вот это когда у нас в нашем в нашем ландшафте ландшафте достаточно много все ну различных систем это достаточно сложно получается ну и мы выбрали путь который максимально использует во-первых стандартный возможность engine x ножки зации балансировки то есть нам было сложно ограничиться одним ходящим портом ну по фактам стояли перед фактом что портов будет много вот соответственно и наше решение она установлена не только как единая точка входа вот в новый контур микро сервисов но и также зале заменять старые legacy решение как раз где очень много различных различных портов и конфликтов и соответственно наша пироги твой занимается генерирование конфигурации состоящие серверов локэйшн of up stream of ну был именно такой подход выбран на данном слайде мы рассмотрим конфигурацию как как мы ее описываем и к к нам опирается на на конфигурационные файлы engine.exe понятно что в упрощенном виде сервис публикует себя в данной ситуации на парту 10000 предоставляет два and paint a объявляет отдельный акция слог галлагер ого нее запросов ну и есть еще такие дополнительные как бы поля как версия в конфигурации версия приложения версия приложения на используйте для балансировки версия конфигурации для для того чтобы можно было иметь в реестре сразу несколько конфигураций между ними переключаться ну соответственно сервис публикует у нас экземпляры которые привязываются опять же к версии вот апликэйшен вершин где из конфигурации и привязывается физически к расположению какому из либо дата-центров ну и соответственно в очень упрощенном виде если убрать как бы вообще практически там 95 процентов информации это вырождается вот в такую структуру то есть объявляется где-то сервер с прослушивающих портом 10000 и объявляется 2ab стрима соответственно во времена хотя хоп стрима как раз есть имя сервиса его в его версия текущая и дата-центр что как раз используется в балансировке балансировка красн одессе 1 и 10 2 будет исчисляться зависимости от активного дата центра ну то есть если у нас есть два дата-центра то один из них может там быть активным 2 стоять стоять в ризе were в резерве вот и и других настроек сервиса возможны 3 варианта балансировки первое это был их балансировкой актив актив запрос в этом слой запрос в этом случае будет обработан в том дата-центре в которой в которой как раз он пришел то есть у нас где то есть слот балансир есть 22 дата-центра в каждом и дата-центров установлен свои деньги твои каждый из них привязан к конкретному физически дата центра и вот режиме active актив когда запрос приходит дата-центр о он там и остается второй режим это реки в бокал за запрос будет не в дельта в этом режиме не важно куда бы ни пришел запрос какой дата-центр место вину на этой битвой он будет перенаправлен в тот дата-центр которых данный момент является основным ну либо глобально либо для сервиса то есть основной дата-центр активный можно задать у нас с точностью до сервиса ну и соответственно актив горячий резерв в этом случае сначала выполняется балансировка по умолчанию а потом если как бы произошла ошибка ну и мы можем перри повторить перри повторить данный запрос не все запросы можно перри повторять то тогда используется список резервных дата-центров и перги твой последовательно пытается выполнить запрос на каждом экземпляров каждого из них следующая функция которая вы нам просто необходимо иметь в составе пикет в эта функция анти фикации опять и твой должен и может и должен на себя взять централизованному всю работу по выполнению модификации облегчить те самым разработку конечных сервисов снизив суммарную нагрузку найдите провайдер ну и также он предотвратить неавторизованный доступ внутрь системы ну какие же нам типу модификации необходимо поддержать первое это модификация по пользователю паролю которая превращается на 5 твой запрос по грамм type password в дельте провайдер второе это модификация по любому из видов дживики токи ну живите токена третье это модификацию папа паку токио ну вот стандарта по найди никак не описывает формат access токина и не всегда токен можно трактовать как дживики ну допустим тот же самый тип блок этот живите там можем проверить подпись принципе даже не ходить вот но пакет окин это просто набор каких-то символов и в этом случае мы должны обязательно вызвать introspection and point вы даете провайдере и убедиться что этот talking как бы это это токена инвалидный вот следующее что ну что случилось следующий типом дефекации это авторизация куда flow реализация поддержки авторизация когда flow на уровне опять гид в очень сильно упрощает как раз публикацию веб-порталов то есть и порталом уже не нужно беспокоиться о том что им надо как-то организовывать нам модификацию пользователя они просто публикуют стандартно себя на этой битве и получает все унификации он у информацию уже из заголовков то есть опять и твой на себя берет и поддержку сессии продление сессии вот и выставление этих всех дан данных пользователя через заголовки все запросы уже на backend и приходят готовы это мне надо не проверять токены нечего делать с ними еще один пункт этот по пункта talking очень то есть это обмен токенов ну и понятно поддержка стандартных толпа найди и дополнительно место методы верификации надо мне ускоряться отдельные все in these кации мы рассмотрим только механизм токены качаешь все остальные более менее понятно токены качаешь достаточно часто используется оператор достаточно часто используется если в ландшафте войти ландшафте присутствуют достаточно много различных систем особенно если присутствует не 11 текке провайдер их надо как-то а нужно выполнять запросы ну как бы между всеми ну соответственно 1 из а самый как бы используемый вариант это выполнение дефекации по внешнему токи но относительно текущего и данте провайдера ну как я сказал как раз используется при внутренних интеграция второй вариант это запросы к внешним ресурсам ну для этого требуется осуществлять выполнение обмена токена как раз внутреннего на внешний данный обмен нашем случае мало востребованное стране периоде твой на также подержанный механизм технически может быть использован в том случае если используется анти фиксация через google facebook или вконтакте либо через любой внешней дайте провайдер и соответственно обмен внутреннего токена на внутренней используется тоже используется он необходим если нам нужно каким-то образом апгрейдить параметры сессии вот рассмотрим механизм токены качаешь один один из механизмов только в которые рассматриваешь него на внутренней так нас значит на первом шаге пользователь выполняет запрос понятно с каким стоки нам и дайте провайдеров первого уровня и перейди твой выполняет интроспекции и интроспекции найти провайдере соответственно и пропускает запрос уже на уровень 2 но стоки на все еще 1 уровне и как раз вот опять твои уровня 2 видишь на входе не его токен выполняет токены конечно уже в том и данте проводили которым он с которым он связан а здесь нужно упомянуть что предварительно между дети провайдерами первым и вторым нужно иметь link вот чтобы им и что иметь возможность дополнительно раз лекцию подтягивать профили ну и соответственно проходит проверка токена может он диман создаваться профиль если его нет и происходит проксирование уже запроса в стоке нам уровня уровне 2 на сервис и уровня 2 вот таким образом у нас описывается конфигурацией дайте провайдера то есть здесь параметров мы видим параметры по найди параметры ну прослушаем у порта в данном случае для основного кикла к египте предположим да то есть у нас кий клок так же как и все остальные сервисы может быть защищен опять битвы и в ки-клаб мы тоже можем ходить через ebay битвой ну и соответственно мы здесь видим сервис один у нас привязаны только к одному и денте провайдеры происходит простая проверка токена сервис 2 у нас уже привязан к основном и деньки провайдеру и у него есть еще отдельный маршрут и связь во внешний мир для этого используется а конфигурация secondary dp и соответственно третий вариант это когда у нас происходит обмен talkin' она старая na na na samom и поедет в пгт у нас есть тоже на программном уровне умеют делать mapping токенов трансформа второй второй по значимости и востребованные функции это как я сказал то является это различные трансформации которое производится на стороне пироги твои какие у нас есть потребности трансформациях первое это понятно перезапись юрия у нас используется стандартный механизм джинкс 3 в right второе это добавление заголовков и аргументов запроса то есть как правило это какие-нибудь инфекционные данные передаются передаются заголовков 3 ну и третье это управление заголовками ответа для поддержки в данном функциональности в нашем битве реализован механизм макро процесса у нас есть контекст вот при при заполнении заголовков мы имеем к нему доступ и можем брать напрямую значение из контекста ну соответственно это реализовано с помощью наших фильтров так и следующий блок это защита и квотирования рассмотрим механизмы которые могут быть реализованы на стороне беге twain и 1 и из этих механизмов наконец а как брейкера которые позволяют позволяет вывести из нагрузки отдельные экземпляры средств если они начали сбоить второй механизм это мягкое предотвращение перед позволяет предотвратить перегрузку деградирующие сервисов посредством сужения бутылочного горлышка и третий механизм это механизм квартира вания который позволяет задать какие какие-либо статические ограничения в том числе ограничения в том числе ему можно реализовать монетизацию с помощью данного механизма давайте рассмотрим каждый из них механиста как breaker он и так же существует в стандартами gemix engine.exe но только реализовано уровне со на уровне всего сервера то есть создается на уровне abs прямо в нашем и пеги твои он задается его можно реализовать с точностью до 5 вызова и в том что в том числе параметры эти параметры механизм все как брейкера можно передавать и через заголовки здесь могут быть два сценария первый сценарий это у нас есть 2 2 категории потребителей это медленные которые могут долго ждать это синхронно и внутренние процессы и быстрый это какой-то интерактивное взаимодействие с пользователем которые не могут ждать так вот медленные процессы они выключаются из механизма защиты как раз поттер нас иксы как breaker на приходит ту же самую точку а быстрые могут сказать что а вот меня пожалуйста учитывай и и тогда пеги твои конкретно для этих потребителей начинает использовать механизмы как брейкера то есть нет необходимости там какие-то разводить их там праздных конфигурациям порта можно просто передать признак через заголовки да это собственно разработка это собственный модуль который реализован на си соответственно но папа алгоритм в принципе похож на осно на на базовой здесь соответственную основные его параметры следующий механизм этот механизм троттлинга динамического троттлинга их не динамического троттлинга работает не на каких-то абсолютных значениях она статистике он работает из использовать 2 скользящих средних отношения в этом все выполнения запросов к одновременно выполняемых запросам вот используется медленная скользящая средняя за большее количество интервалов и быстро скользящие средние уже уже за меньшее количество интервалов давайте пройдем быстро по алгоритму его fast это значение быстрых исходящих скользящей средней слов это значение медленней медленный то есть у нас есть какой то есть есть какой-то графику здесь вот они как раз обозначены слову синяя fast у нас получается цвета раньше вот соответственно здесь какой-то дополнительный уровень троттлинга и мы когда обрабатываем запросы смотрим а можем ли мы пропустить данный момент или нет если мы укладываемся в этой коэффициента значит можем без задержки если нет значит нам нужно вычислить допустимое значение параллельных одновременно выполняемых запросов ну чтобы выровнять это отношение вот если мы опять не уклониться значит мы идем в очередь вот и засыпаем ну и соответственно в конце выполнение каждого запроса у нас как бы от механизма просыпается берет берет первое из очереди пытаются снова пройти по пунктам есть ли все хорошо пропускает нет значит ну все по таймауту тоже соответственно запрос отбивается так и последний это механизм матированием соответственно механизм матирование у нас представлен леди политик который включает себя определение которое в свою очередь состоят из различных условий которые это обычный expression который возвращает нам true или false и счетчиков которые являются либо ограничительными либо вот кастом счетчик использую для mma не для мотивации ограничительные то запросы в секунду ли параллельно выполняемые запросы и соответственно второе это вычислить или они объединяют вот эти вот все сущности в дерево принятии решений ну и соответственно политики могут только глобального уровня и привязаны к маршрутном либо могут определить с помощью доплыл с точностью до приложения на данном слайде проведён счетчик счетчик ограничительный счетчик по запросам в секунду он соответственно здесь мы видим что у нас параметры вы могут быть выбраны из базы данных это postgres quelle запиши равана определенное время и используется в качестве ключа значит следующее значение там из контекстов 2 это у нас счетчик по конкурентным запросам здесь ничего не выбирается просто статически за данное ограничение ну и соответственно простое условие следующим образом представлена дерево принятия решений ну то есть как а когда политика начинает выполняться она движок вычисляет все это дерево на входе и на выходе получается либо троллю баффоло соответственно либо мы позволяем выполнении запроса либо нет вот комп данный вычислители также можно комбинировать ну и привязка как я сказал к сервисам и маршрутом так ну и последний папа пост последний из пунктов которые я успею рассказать это авторизация авторизация если вы хотите поддержать в свои мопеде твой какие-либо стандарт это нужно поддерживать юзер менеджмент access утвержденного рекси на данный момент все еще нет и поэтому как бы кажется каждый и задайте провайдеров может ее поддерживать ну немножко с некоторыми отклонению частности ки-клаб не полностью соответствует этому описанию давайте быстро пойдем по алгоритму соответственно предусловие нашего алгоритма это владелец ресурса у нас каким образом его регистрировать и провайдере ну и соответственно администратор тоже каким-то образом выдает данные право на ресурс ну самом деле как владелец тоже может право выдавать вот первое это у нас пользователь выполняет выполняет запрос 2 и 5 получая запрос прыгает в укаб ресурса вы долетите провайдере соответственно и кэшировать его на какой-то интервал времени чтобы постоянно не запрашивать ну и соответственно далее по алгоритму у нас опять и твой должен получить тикет на доступ к ресурсу и попытаться обменять этот теккена токен доступа вот если токен доступа получен то все хорошо и мы пропускаем запрос систему если нет ну значит 403 forbidden вот все эти права точно также кэшируются на пике твой то есть не карнеги твой не на каждый запрос естественно идет выдайте провайдер он использует и собственный внутренний кэш ну в общем то последний слайд у нас получается содержательный на котором представлен общая архитектура ну скажем так крупными мазками акций на пикет в здесь мы видим что и пике твои у нас это распредели распределенный сервис который работает несколько дата центрах отдыха использует закипит для хранения реестра редис и станции regis располагается вас тоже во всех дата-центрах пост postgres quelle используется для в данный момент в данное время для политик и соответственно еще есть одна функциональность про который я не рассказал то skype то есть у нас нескольких у нас разные сервисы могут быть привязаны к разным scope'ом допустим у нас есть скоб который выставляется в интернет и внутренней часть сервисов могут быть облицованы вот только в той части которая публикуется в интернет а вторая допустим или вся она может быть опубликованы только во внутреннем во внутреннем пространстве ну здесь вот есть модулей и на нем не буду как бы останавливаться он будет нам доступен ссылки ну и в общем все вопросы можно переходить вопросам если мы успеем алексей спасибо за участие тебя подарок как конференция и ваши вопросы пожалуйста здрасте я максим хотел бы задать вам вопрос про токены не могли бы вы более подробно рассказать если у вас refresh the ocean и знает ли клиенту о бок с толку и таки не если знает то в каком виде она него хранится кто на какое время вас выданное access token и и кто управляет их refresh смотрите здесь возможно несколько несколько вариантов если мы говорим конкретно про пеги твой то там есть несколько механизм когда пьяницы управляет токенами the basic и дефекации когда у нас на вход приходит юзеры пользователь да он тогда сам получает естественно access token из-за нинки провайдера сам его знает насколько запиши ровать так как информация выдается и дайте провайдером expires сын насколько его можно кэшировать соответственно еще он параллельно каждую минуту делает ретроспекцию токена но не каждый минут от настраиваемые чтобы убедиться что ну а talkin' тому что то звали уже вот и второй вариант это когда у нас использовав то резинку до flow тогда у нас опять битвой с создается да и в первом варианте talkin' не никуда не уходят но остается только приедет вфг шаг вот и второй вариант это вторжение куда flow тогда у нас в куклах только остается сессия и соответственно сам токен тоже остается в кашах и refresh talking также остается в кашах и во время работы сесть и отслеживается что он что его нужно от рефреш океан рефрешер риф решится если refresh токена нет ну там может еще solidarity фикации происходить это когда у нас идет перенаправление на над на точку авторизации и соответственно задается проб но вот ну как бы в основном каши руется все на уровне 5 твой и если только явно пользователь сам токи не получает так что вопрос здравствуйте есть такие ряд наверно вопросов один из них чтобы больше рассказали на текущий момент про менеджмента тут наверное вопрос больше про потребителей то есть если вас какая-то системой для потребителей с соответственным мир баком чтобы можно было каждым пользователем выдавать группу а фишек например каталогизировать фишки в единый профиля вас навешивать данными я вас понял да смотрите наши мы пикет в нет встроенные возможности работать в поддержке там пользователей групп мы для этого используем возможности денте провайдера то есть мы поддерживаем юма 2 протокол то есть частности даже наш менеджмент интерфейс закрыт точно так же с помощью рыбака или нет по моему оба к сейчас вот че резкий клок то есть мы там создаем эти все скопы виде гетто допустим там ресурсы и соответственно с помощью user менеджмент access мы выполняем авторизацию на уровне самого и джон и ксану поддерживается на солдат авторизацией стандартная basic вот а все остальное это отдается именно на откуп есть интеграция по юма 2 вот выбираем этой нити провайдеры все остальное через него тут наверное больше вопрос другое именно про портал да когда мы хотим часть опишите передать на внешнем разработчикам чтобы они имели доступ именно к определить я не хочу нас есть и плюсы тавора спроектировать есть вопрос документирование чтобы каждый элемент можно к ним а также было прикрепить документацию ну и соответственно каждой группы пользователей там определялась только один скоб например опишет да я понял вас да у нас есть такое понятие как workspace он он тоже работает через юма 2 доступ к нему то есть разграничение опять же работать через юма 2 то есть мы можем видеть и внуки клоки у нас используется в данном случае кий clock то есть мы можем создать пользователи группы соответственно вот эти workspace и создать и доступ ограничить доступ к созданию конфигурации изменения только через вот эти workspace да еще один маленький вопрос по поводу мультитональности может или как бы в качестве inpointer задавать разные in point и зависимости например отдав от прост среды чтобы мы например сами gateway могли подтягивать непосредственно конфигурацию там свою то есть для продав ских битва их мы публикуем например одни in point и для этом теста dv мы естественно и ноги твои забирает там конфигурацию им ну наверное скопы можно использовать то что я сказал он сам последнем слайде наверное водки как бы отдельно вот такого нету но можно использовать скалку хорошо спасибо еще вопросы 1 1 так давайте я тогда просто мой как нам первый вопрос так мы говорим про пи менеджмент или право пия где твой ну у нас это все вместе по сути дела потей хорошо давайте тогда пробеге твоей более-менее раскрыта а вот про team management просто особенность работы api менеджмента это как раз бог слову работы с api да то есть это этапы публикации верификации подписки с учетом разных полисе и обеспечение этого функционирование в рамках ну портал атома цели вы называете там квартира ванием мы целыми мне просто хочется понять как это реализовано ну про чтобы не создавать неоднозначности ну возможно возможно в таком виде у нас этой поддержки нет потому что первоначально стояла все-таки задача сделать и 5 битвой с функциями api менеджмента они опять менеджмент функциями перед в вот у нас есть различные среды разработки то есть у нас под различные стенды у нас есть дев среда есть среда нагрузочного тестирования то есть это у нас несколько другими средствами реализуется не не платформы пи-пи-пи менеджмента пикет в вот то есть наверное так если что поддерживается эта версия нирования конфигурации к на речные зоны поддерживаются вот явишься ну как бы ноги и различные зоны там не бином ньютона это поняв хорошо то есть второй вопрос когда раз мы поговорим пороге твоем какое количество сервисов но вашей практике это поддерживается какая лпс ну технические ограничения что они разом ну что на практике бы на практике порядка 3 300 сервисов по моему сейчас есть окей 300 сервисов это для одного скопы для всех school это для всех очень рпс фпс фпс фпс смотрите рпс насколько я сейчас помню по моему 10 серверов продакшене стоит и на каждый из них идет порядка четырех пяти тысяч секунду и потребляется при этом там по 8 ядер и потребляется при этом порядка 50-60 процентов процесс ценных ресурсов ну чем 5000 rp сам для этих вещей это глобально не очень много там самые интересные вещи начинается после восьми тысяч черкесов и 300 сервисов я почему говорю потому последний слайд про архитектуру который вы нарисовали для 300 сервисов работает когда их там 3-4 тысячи а если мы имеем разный набор скоб разное количество окружений и нам это нужно смотреть там архитектуры она чуть другая совсем становится просто обратить мое понимание и 3-4 тысяч рпс not take on a ну это ноу смотрите на самом деле 5 твой это ведь не такая простая штука как молоток то есть нельзя их сравнивать просто по сырым rp сам наверное нужно смотреть какой трафик он обрабатывает какую он дополнительную еще функциональность это будет смотри не следующий вопрос да хорошо что с поддержкой в псаки там нота здесь и теперь работает ну то есть что у нас будет с поддержкой вот этом чуде говорили процессе и так далее чтобы это поддержкой какой будет latency на высоких ну например для поддержки если я хочу поддерживать мониторинг трейдинга твой который одерживать и не расслышал давайте по протоколам окей у нас с вами http а все теперь я хорошо какой элитности санги твое внутри добавляют ну здесь как бы конечно зависимости от нагрузки сейчас я не готов цифры назвать нет счастья сейчас хорошо вам цифры на цифры назвать потому что у них нет под рукой хорошо собрана на 300 сервисах это не так критично окей с высоким там ну соответственно совершили звуки это в вене потир поддерживается websocket поддерживаться но не приветствуется джер писем нет ни в добавляли поддержку окей что тепле 2 пока не было необходимости у нас окей хорошо я могу дальше продолжать четвертый вопрос ну насколько вы вначале сказали про kong да просто ну такая совсем light light версия даже не кунга комьюнити"
}