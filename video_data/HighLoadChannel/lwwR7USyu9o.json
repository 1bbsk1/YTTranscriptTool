{
  "video_id": "lwwR7USyu9o",
  "channel": "HighLoadChannel",
  "title": "Как мы подружили биореакторы и ML / Владимир Меркулов, Василий Вологдин (BIOCAD)",
  "views": 333,
  "duration": 2298,
  "published": "2023-04-28T06:19:52-07:00",
  "text": "сразу хочу поправить доклад больше не про биотех контекст разработки лекарственных препаратов а про то как мы применяли машину обучение на производстве то есть той части Когда мы уже выпускаем наше лекарственные препараты давайте для начала расскажу про немного про нашу компанию компания биокарта это международная технологическая компания полного цикла то есть мы занимаемся не только разработкой новых лекарственных препаратов Но их выпуском в нашей компании работает более 3000 сотрудников третий из них из Академической среды у многих из них есть научные степени численность отдела более 200 человек со временем в любой большой компании крупное образуются большие массивы данных и бизнес естественно хочет каким-то образом извлекать из них пользу значительная часть наших массивов данных Это производственные данные на данном слайде показано мнемосхема это интерфейс один из интерфейсов нашей Эскада системы ската система это такая информационная система которая предназначена для сбора хранения и отображения данных о происходящих процессах он такой мнемосхеме оператор может отслеживать весь технологический процесс и в случае необходимости в него вмешиваться отличительная особенностью нашей системы с нашей скрытой системой является то что она построена на Open Source решениях что крайне не типично является крайне нетипичной ситуации для производственных компаний в основном Производственная компания делают выбор в пользу каких-то крупных вендоров подробнее про то как Мы строили эту систему расскажет Мой коллега сегодня Владислав в желтом зале в 5 часов вечера в чем плюс такого подхода для дата-сантистов в первую очередь это более простая более простой способ получения этих данных потому что зачастую если эти данные собирают программное обеспечение от каких-то вендоров то потом испытывают проблемы трудности с тем чтобы их получить второй момент в том что мы получаем максимально полные данные включая низкоуровневые данные системы управления Это позволяет нам делать больше экспериментов использовать эти данные как признаки или в целом ставить какие-то не совсем обычные задачи Итак сердцем нашего производства является биореакторы что это такое есть более общее понятие химический реактор это такая высокотехнологичная кастрюля которая предназначена для того чтобы смешивать ингредиенты если эти ингредиенты являются органическую природу то такой реактор называется биореактором а такие реакторы широко используются во многих производствах например косметических пищевых и в таком реакторе Например можно сварить пиво Но в нашем случае мы варим не пиво а мы про культивируем белок процесс начинается с пробирок А у нас есть некоторое количество клеток А мы сначала помещаем в маленький реактор 50 литровый И они начинают в этом биоректоре размножаться когда концентрация клеток доходит до определенного значения эти клетки пересаживаются в следующий реактор побольше 250 литровый и таким образом процесс повторяется до Большого реактора объем которого составляет 1000 литров в этом реакторе происходит две стадии на первой стадии продолжается предыдущий процесс клетки размножаются А на второй стадии клетки притормаживают свой скорость своего размножения и начинают продуцировать белок и вот этот белок является наша конечная целью из этого белка дальше мы выпускаем наше лекарство весь процесс занимает по времени около месяца это время на производство одной серии продукции если обобщается все пожелания бизнеса к тому чтобы они хотели получить из этого массива данных то это цифровой двойник что это такое Это максимально приближенная копия к реальному процессу это включает себя и самооборудование систему управления а также модели процессов которые там происходят Какие задачи решает цифровой двойник во-первых Это позволяет сократить время разработки технологии производства новых продуктов когда мы выпускаем новую молекулу она решает какую-то задачу После этого ее нужно наладить технологию производства как ее выпускать промышленном масштабе и вот такой цифровой двойник Он позволяет сократить время на такие разработки вторая цель это оптимизация текущих процессов как не снижая стоимость как не снижает качество выпускаемой продукции снизить ее себестоимость для этих задач Хорошо подходит обучение с подкреплением Когда наш цифровой двойник выполняет роль имитационного имитационной модели все оптимизацию берет на себя обучение с подкреплением а также есть такой кейс Когда у вас есть новое нужно запустить Новую производственную линию у него есть своя Проектная мощность и зачастую выходит продолжительное время Например год или полтора чтобы после запуска Новой линии выйти на проектную мощность Это происходит потому что появляются какие-то узкие места например какое-то оборудование подобрали неподходящий мощности вот такой цифровой двойник Он позволяет еще до старта найти такие узкие места И что значительным образом сокращает выход на проектную мощность и также такие двойники используются для обучения персонала существует два основных подхода для построения таких двойников первый подход основан на машинном обучении второй на физических моделях какая между ними разница подход на основе машинного учения он относительно проще чем подход на физических моделях плане разработки для разработки цифровых двойников на физических моделях нужно а нужен значительно более высокой экспертиза в плане оборудования и процессов которые там протекают но в свою очередь такие двойники Они обладают более широким функционалом в частности они лучше показывают ситуации в тех диапазонах которых не было на исторических данных И как я приводил пример с холодным стартом такие двойники тоже позволяют решать такие задачи Когда у нас вообще нет в данных изначально а цель нашей компании разработать такое большое цифровой звонит Но это достаточно сложная задача и мы начали подумали посмотрели наши данные и решили ее декомпозировать и в результате этой работы мы выделили два основных подхода 20 направления первое направление Это виртуальные датчики это подход который максимально приближен к ML задачам а второй подход моделирование систем управления здесь мы попытались применить подход основанный на физических моделях так первый кейс это кейс виртуальными датчиками у нас в нашем биореакторе есть два парных датчика от датчики кислорода и кислотности используя эти данные системы мы используем эти данные для того чтобы вести наш процесс если эти датчики парные потому что необходимо чтобы этот процесс был надежным а соответственно бывают такие ситуации когда эти датчики начинают показывать разные значения и перед оператором встает вопрос что же ему делать какому датчику доверять если оператор ошибиться то это может привести к тому что мы недополучим белок или в самом плохом варианте мы вообще потеряем серию это естественно большие финансовые потери большое время на лак и мотивацию сотрудников тоже пропадает поэтому мы решили сделать такую штуку мы решаем задачу на входных данных по другим параметрам мы предсказываем значение нашего датчиков и в зависимости от этих значений мы даем рекомендации оператору Какой датчик сейчас Необходимо выбрать давайте рассмотрим общую решение такой задачи сначала у нас есть какая-то бизнеса задача Мы начинаем получать по ней данные Далее идет процесс подготовки этих данных моделирования проверка и в случае если нас все устраивает мы выводим эти модели в Production Если нет то мы еще раз можем пойти на один такой виток в контексте производственных задач на этапе понимания данных есть несколько нюансов первый нюанс то что нам нужно наши данные привести к сделать технологическую привязку Вот как я показывал ранее на слайдах снема схемами нам нужно четко понимать В каком участке нашего технологического процесса находится наши данные почему это важно зачастую многие процессы протекают определенное время и образуются временной сдвиг и когда мы готовим наши данные нам нужно наши теги сместить на этот временной сдвиг если этого не сделать то модели скорее всего заведомо получится неудачными а второй важный момент что нам нужно следить за тем Какие наши признаки являются входными в процесс А какими выходными если Мы попытаемся использовать для предикта одного выходного параметра другие выходные то впоследствии мы не сможем такую модель вывести в продакшн при работе с такими данными мы получаем какой-то список и далее нам нужно Вы получить какую-то доменную информацию чтобы ее нам получить мы формируем определяем Какие признаки для нас являются важными по мнению модели и с таким списком идем к нашим технологам и технологии нас уже дальше корректируют и говорят нам где мы правы где мы неправы Какие признаки стоит откинуть Какие стоит добавить и какие-то может быть важные нюансы В результате мы сформировали некоторый список таких признаков к этому списку добавляются производные печи данные по рецепту у нас выпускаются несколько лекарственных препаратов и для каждого лекарственного препарата Мы формируем свои модели и по этим данным мы делаем предикт виртуального датчика далее нам все эти вещи нужно каким-то образом доставить в нашу склада систему и есть две принципиальные сущности склада системы или asotp и наш сервис сервис является таким агрегатором который общается со вспомогательным системами получает необходимую информацию и отдает предиктор ботаник это наша система которая позволяет выгружать данные по процессам а также он содержит информацию о текущих активных процессах под каждой активный процесс мы запускаем свой поток этот поток берет данные по моделям данные мы логируем при помощи трекинг сервера И общее и делаем также общее логирование отслеживаем чек ошибки и метрики машина очень Например если наша модель начинает португать получает об этом оповещение а общение между системой с утп и нашим сервисом происходит при помощи запросов чтобы это можно было сделать мы реализовали Gateway по сути это такой адаптер который позволяет нам преобразовать http протокол в протокол промышленный протоколы и далее уже на естественных протоколах которые приняты в мире происходит все вся работа одной из важных частей вот этой схемы является плк это программирование логический контроллер Он выполняет роль сбора данных датчиков а также отправляет управляющее воздействие на исполнительное устройство и также данный через плк попадают в нашу scada систему в результате как бы мы выводим данные Можем можно посмотреть тренды относительно того как ведет себя наше предсказания а также у оператора есть две такие кнопочки которые ему показывают что текущий датчик Это правильный датчик Если нет то лампочка горит красным цветом и это означает рекомендацию что нужно переключить управление на другой датчик в результате Эта система эксплуатируется уже сначала этого года и в результате У нас не было при расследовании инцидентов ни одного случая чтобы неправильное переключение датчиков привело к какому-то значительному значительным потерям если значительно снизилось время на то Сколько сколько времени оператор тратит на то чтобы принять решение надо ему переключить датчик или нет второй кейс он относится к тому как что происходит у нас вот в нашем в 200 литровом реакторе как я ранее говорил там происходит две вещи на первом этапе у нас продолжается активный рост клеток их размножение а на втором этапе мы делаем так называемый температурный Shift опускаем температуру с 37 градусов до 34 и клетки испытывают стресс и они притормаживают свое размножение и начинают вырабатывать белок а в этот момент как мы видим у нас происходит переохлаждение то есть мы хотели чтобы у нас система опустилась до 34 градусов она этот такую ставку проскакивает опускается до 33 градусов И потом Возвращается на 34 градуса Чем это плохо это плохо тем что клетки в итоге испытывают сверх стресс и часть этих клеток она умирает и это сказывается впоследствии на количество белка которое мы получаем данный элемент данный переходный процесс управляется таким элементом который называется регулятор что это такое у нас есть setpoint в данном случае это Например 34 градуса он также называется уставкой и выход из процесса Out разница между этими значениями это ошибка на основании это ошибки принимается решение Что необходимо сделать либо нагреть реактор и либо его остудить и основание знака этой ошибки и по этой ошибке рассчитываются три компонента первая компонента пропорциональная она отвечает за текущее состояние вторая компонента интегральная она основывается на предыдущих значениях ошибки и третья компоненты дифференциальная она пытается спрогнозировать будущее состояние сумма это этих трех компонентов является управляющее воздействие в результате этого управляющего воздействия система за определенное количество циклов перейдет из 37 градусов дойдет до необходимой уставки в данном случае 34 градуса Но путь по которому она может идти может оказаться весьма незамысловатым то есть оранжевая линия это то как бы нам хотелось чтобы это было происходило переходный процесс а Зеленая линия это как он может проходить могут быть различные колебания и эти колебания вызваны именно неправильной настройкой этого регулятора и соответственно мы задались такой задачей А как вообще можно настроить этот регулятор в части самого регулятора все в порядке есть формулы могут казаться достаточно сложными но на деле нет Есть реализация на практически любом языке программирования А вот проблема начиная с вот здесь Каким образом нам смоделировать нас наш процесс мы посчитали по при помощи пить регулятора управляющего воздействия вопрос какая будет у нас на выходе температура когда мы зададим это управляющее воздействие решение мы нашли такое мы заменяем вот этот переход процесс переходной характеристикой которая выглядит таким видом в виде дифференциального уравнения второго порядка и нам нужно необходимо найти решить эту систему опираясь на наши данные и найти три коэффициента то эпсил и к Тау это постоянное времени она отвечает за инертную систему к это коэффициент пропорциональности и Epson время затухания собственно говоря решая такую систему мы находим эти коэффициенты и далее мы используем эти коэффициенты для того чтобы моделировать наш процесс решив эту систему мы решение этой системы мы сделали следующим образом у нас есть некоторая функция которую нам нужен необходимо минимизировать и есть параметры и это очень хорошо так ложится на задачу поиска гиперпараметров и мы собственно говоря так и поступили мы взяли просто оптимизацию и нашли такие параметры при которых у нас функция будет принимать а на втором этапе нам нужно найти коэффициенты нашего питорегулятора при котором наш переходной процесс будет иметь ту форму которая нас устроит эта задача решается аналогичным образом только в данном случае мы ищем функционал минимизации между setpoint и тем процессом который мы смоделируем на данном графике указана зеленым цветом значение уставки и оранжевый это то как наш происходил наше происходили наши процессы на стандартных параметров регулирования синее значение это то как мы смогли оптимизировать найти нашего параметры и получить тот желаемый результат как бы мы хотели чтобы шел наш процесс далее результатом этого моделира является вот эти три параметра Пит регулятора которые мы берем и устанавливаем на наши реакторы и смотрим Что у нас получается И вот красная линия это то что мы получили в результате нашего моделирования сходимость достаточно хорошая количество но мы немножко ошибаемся но качество Мы очень хорошо попадаем В эту прямую собственно говоря что мы в результате этого получаем во-первых мы получили такую модель которая которую можно в дальнейшем использовать для производства то есть мы хотели бы сделать большой цифровой двойник и мы сделали маленькую часть которая дальше можем использовать переиспользовать и она будет часть вот этого большого двойника вторая момент мы отслеживали что происходит с количеством белка который мы получаем на реакторов оптимизированные параметрами и не оптимизированными параметрами разница составляет примерно от двух до пяти процентов на лабораторных реакторах мы получаем такой эффект который уже ощутимый для бизнеса и далее У нас как бы также мы протестировали вот эту все возможности для того Каким образом нам дальше куда нам идти и как нам развивать вот этот проект с цифровым двойником Спасибо за внимание на этом У меня все слайд с qr-кодом для того чтобы оценить доклад Спасибо ответа времени хватает поэтому можно будет нормально подискутировать Поэтому если хотите пообщаться нормально так позадавать Пожалуйста поднимайте руки первый ряд вот молодой человек серый футболки а потом девушка третьего рядом Здравствуйте спасибо за доклад можете подсказать пожалуйста вот у вас есть себе реактор Ну условно ваш кастрюля там есть 10 датчиков Какие конкретно датчики вы Ну у вас там есть какие-то дачи которые часто выходит из строя да Или вы все Ну как сказать есть критические Да это датчики кислорода и датчики кислотности есть менее критичные датчики например расход углекислого газа по этим двум датчикам идет процесс управления и если на этом этапе происходит какие-то неполадки то это нас очень сильный эффект Как часто у вас происходит такие допустим за три года статистика была около тысячи расхождений Но если я понимаю что у вас налаженный процесс да то есть каждый раз происходит все одно и то же тоже правильно понимаю процесс происходит один и тот же но в зависимости от рецептов Но эти процессы идут с определенной вариативностью на которую нам очень сложно влиять то есть на производстве основные проблемы это вот вариативность ее пытаются разобраться различные методы чтобы минимизировать но так или иначе каждый процесс хоть хотя бы чуть-чуть отличается от предыдущего и хорошо такая у вас модель машины обучения Если не секрет какой тип там где мы решаем вопрос виртуальным датчиком давать очень классный Миньоны Я хочу заметить Большое спасибо за доклад было очень интересно так первое что хотела спросить как вы замечали данные для решения задачи выбора датчика То есть это оператор выбирал датчики сам и в какой-то момент был прав и это бралось интервалы где датчики расходятся мы находили сами да то есть Мы строили различные статистики например да там три сигнализации то Мы отмечаем эти моменты и далее У нас есть три параметра это два параметра по каждому датчику и третий параметр Какой датчик сейчас является управляющим или мастер датчиком часть данных опираясь простые кейсы мы смотрим на сами на эти данные и понимаем что там происходит кейсы которые не можем разрешить Мы идем технологам и технологии нам помогают размещать эти данные ещё вопрос про датчики Почему их не заменяют когда она уходит строй нельзя открыть да нужно понять какой правильный да то есть в первом приближении легче переключиться на какой-то датчик если ситуация отваливается оба датчика дата Надо хотя бы один попробовать заменить Но нужно быть уверенным в том что вы делаете коэффициенты В итоге чтобы он лучше работал да чтобы он принимал те формы которые нас устраивают а откуда изначально брались вот эти коэффициенты то есть насколько понимаю что-то было и вы это улучшали То есть это какие-то заводские настройки и вы их тюнили это ближе да таким заводским настройкам и как бы ну это то вот исходно состояние на которое мы пришли да посмотреть вот что происходит в процессах и здесь еще немножко другой момент делал даже не в том чтобы просто настроить параметры Да здесь более такая большая цель сделать вот этот цифровой двойник и когда мы делаем цифровой двойник одна из функций которую он выполняет он тоже должен дать вот эти параметры Как настроить нам систему управления чтобы технологический процесс протекал необходимым образом произвольно технологический процесс Если ты про него что-то изначально знаешь Чтобы не мучиться вообще то есть да как бы Когда происходит новый запуск Да нужно вот то же самое Да вот мы какой-то препарат выпускаем новый Да Нам нужно установить эти параметры Вопрос какие нам их задать и здесь такая была более общая задача Мы частные решили и более общую так вот пятый ряд молодой человек вот напоминаете о супер задача это запоминает лучший вопрос возможно будет два приза один от партнера секция это веке и второй от биокат ребята что-то тоже подготовили просто Здравствуйте мой вопрос мои вопросы какие-то попытки ее подогнать под какие-то Внешние факторы потому что вот у вас есть если физический биореактор и вы туда встать эти Пит коэффициенты может произойти что-то внешнее и из-за этого у вас спит регулятор с этими коэффициентами которые подобрали под идеальный вариант будет работать хуже чем ожидается да такая ситуация возможна она будет внештатной но просто пить регулятор он создается он должен уметь такие вещи обрабатывать например он же в дронах тоже используется и вот дроны когда на ветру там ветра подул он умеет стабилизироваться назад Вот у вас оно умеет внешним фактором адаптироваться Пока нет но в дронах там тоже я смотрел то что смотрел ролики по дроном там бывают разные ситуации и как бы есть Ровно до такой ситуации когда снимаются данные и эти данные просто обрабатываются стандартные коэффициенты то же самое вот наша система она получается достаточно стабильная то есть параметры которые мы подбираем они вид Конечно будет идентично даже если эти параметры как-то сильно пошатать Спасибо И если еще у Вас возможность влиять на эти параметры во время самого процесса потому что например вот если у вас я не знаю про датчики температуры потому что я слышал только про кислотность и какой-то второй про кислород в общем если у вас датчик температуры выйдет из строя покажет неправильное значение то ваш регулятор тоже сломается и будет не в ту сторону корректировать Можно ли оператору подтянуть эти параметры можно переключиться в ручной режим В таком случае режим будет Да спасибо Так еще вопрос появляются Давайте пятый ряд молодой человек да спасибо большое за доклад очень понятные два кейса это пробио реактора я хотел его спросить Может быть если Вы в курсе в биокаде у вас разрабатывается еще генетический препараты от в частности что я читал от спинально-мышечной атрофии сейчас ведутся клинические испытания это будет аналог который 2 миллиона долларов стоит за укол Вот И там вроде бы на базе аденовируса И причем не простого о которой был улучшен с помощью как раз машинного обучения про это что-нибудь можете рассказать нет про это я не расскажу этим занимаются мои коллеги но я занимаюсь именно такой вот частью которая связана с производством но у нас в зале есть тоже мои коллеги и вот Михаил рядом сидит Он может ответить на этот вопрос департамент существует препараты Да только начинается каиды клинические испытания до клинических испытаний Вы абсолютно правы взамен вот того о чем вы упомянули Да спасибо А так первый ряд снова человек я Напоминаю что у нас есть трансляция кто нас смотрит онлайн Можете писать вопросы в чат вот есть также в телеграме чат зала эти вопросы Я тоже буду зачитывать я бы еще хотел спросить по поводу того как по применили машину То есть у вас 1 2 4 классификация что датчика отошел а потом вернуть на первом этапе когда мы делаем виртуальный датчик мы разрешаем задачу регрессии дальше у нас образуется как бы ситуации кейсы где мастер датчик прав датчик и там на базе определенных правил это уже такая ближе к задаче классификации Да сколько раз мы правильно переключали датчик сколько раз неправильно переключает датчик И еще один из таких важных параметров время которое находилось в котором время в течение которого реактор находился под управлением неправильного датчика время под неправильным датчиком Да и как оно влияет допустим дальше то есть Чем дольше если мы управляли под неправильным датчиком то в конечном итоге мы получим меньше белка например То есть вы тянете допустим сначала модель для России потом датчик уходит из строя начинает допустим завышать параметры Что происходит в этот момент если один мы переключаемся просто и поэтому второму ведем то что здесь когда мы общались с нашими технологиями они нам рассказывали только про один такой инцидент что было действительно такая ситуация вышел датчик из строя и серию довели в ручном режиме Ну то есть просто оператор каждый раз мониторил остальные данные и брались лабораторные анализы раз полчаса и на основании этих данных проводилось управление хорошо спасибо Просто если вот три датчика подставить это не упростит или два это уже очень редко редкие используются два и у нас просто уже даже вот это реально фотография у нас уже просто нету слотов чтобы поставить там три датчика плюс эти датчики достаточно дорогостоящие и одна из идей применения вот этого датчика это так и вести Весь процесс виртуальному датчику опираясь на другие параметры и таким образом мы можем сокращать количество наших датчиков все понятно Так ладно какие-то вопросы есть четвёртый ряд молодой человек Ага Здравствуйте спасибо за доклад кажется в начале доклада вы говорили про пылесос решения которые вы используете техническую завесу немного что ну собственно говоря про эмэль это понятно стандартный факт А по поводу того как устроен наш Эскада сегодня вечером Владислав Мой коллега подробно об этом все расскажет в каком зале в желтом в 5 часов вечера желтый в 5 часов вечера Приходите технические подробности Так давайте еще можем один вопрос наверное и потихонечку закругляться так есть вопрос Да у тебя нет Да окей Да дальше микрофон принесут давай Спрошу Какие вот дальнейшие идеи по развитию вообще всей этой истории что что дальше будете делать как скрабанить датчиками хотим попробовать сейчас провести серию которую мы будем управлять именно опираясь на данные вот этого виртуального датчика чтобы наша система управления опиралась на него а второе это полноценно цифровой двойник ближе ко второму кейсу где у нас есть уже элемент системы управления и мы далее делаем моделирование самого процесса то есть там будет порядка 10 дифференциальных уравнений плюс два базовых уравнения это уравнение массовой энергетического баланса и одно химическое уравнение и на базе этого попытаться сделать цифровую копию нашего процесса да решать будете разностные схемы здесь скорее я думаю я смотрю сторону через таким же образом через оптимизацию вы как-то страхуете того что те датчики на которого опирать тоже могут поломаться мы считаем что они супер надежные и не подводят датчики перед тем как поставить биореакторы они постоянно калибруются да то есть происходит дополнительная проверка поэтому мы склонны верить и второй момент который это касается практически любого производства что многие датчики дублируются лабораторными исследованиями То есть через определенный период лаборант приходит отбирает пробу и делает анализ отобранный топ-пробы и в том числе проверяются те значения которые меряются датчики и в случае там и большого расхождения Да это может быть предметом для какого-то расследования во время производства они могут начать выходить стоит проведения серии выходить Возможно они были но их незначительное количество и повреждение датчиков она больше связано не с технологическим процессом например лаборант случайно разбил датчик что спасибо"
}