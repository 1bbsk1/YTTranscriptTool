{
  "video_id": "5kBnTCBQ5E4",
  "channel": "HighLoadChannel",
  "title": "Как мы приготовили массу блюд с помощью одного ингредиента: GraphQL / Сергей Тарасов (НЛМК)",
  "views": 111,
  "duration": 2610,
  "published": "2023-10-06T07:21:21-07:00",
  "text": "собственно зовут Меня Тарасов Сергей я кандидат технических наук и руководить команд разработки холстек команд разработки в группе компаний лмк основной стек это у нас PHP в этой я более 10 лет уже программировал на разных языках программирования это хищные языки это отделки паскали там бейсики изначально естественно на нем писал что-то Ну и основную часть времени занимался языком PHP вот сейчас больше ушел в архитектуру Solution Ну и руководство командами собственно в данном докладе Я хотел бы рассказать некую историю построения эффективного интеграционного взаимодействия с информационным системами на базе графики собственно Эта история основан на реальных событиях а и прошла пробацию временем вот Ну давайте по порядку проговорим сначала про структуру нашу вот сначала расскажу про нашу компанию про наш про одну нашу информационную систему достаточно крупную вот потом поговорим с вами немного про архитектуру это про отношения поставщика и потребителей информации Кто такие какие у них знания какими знаниями не обладают разработаны некие правила игры поставщика вот Ну и дальше перейдем немножечко к хардкору Ну простенькому вот проговорим уже про некий Граф киель Ну давайте собственно начнем вот собственно группа компаний лмк Это международный стали Литейная компания которая больше 20 производственных площадок расположенных семей странах мира на предприятии работает более 50 тысяч сотрудников Вот и Наша компания является лидером по выпуску стали в России выпускают более 18 миллионов тонн стали в год естественно в таких крупных организациях не обходится без информационных технологий информационных систем одно из крупных информационных систем который мы начали разрабатывать и сейчас разработали поддерживаем это является единой корпоративный портал что же себя представляет единый корпоративный портал но единый корпоративный портал в первую очередь это платформа для предоставления различных сервисов из различных функциональных направлений это связь с общественностью PR новости опросы сообщества и так далее Это HR кадровые сервисы адаптации сотрудника оценка рабочих переводы делегаций и так далее охрана труда и пожарной безопасности то есть подача заявок в опасности Ну куча всего то есть на портале реализован более 80 различных сервисов которые так сказать под капотом представляет из себя некую информационную систему своей дорожной карты развития своим жизненным циклом собственно этот портал представляет эти услуги более 5 всем сотрудникам компании это более 50 тысяч сотрудников объединяет больше 3.5 фундаментов из нашего структуры Ну естественно такая информационная система имеет кучу интерфейсов и кучу систем с которыми она интегрирована когда мы разрабатывали систему Это был 2017 год текущий корпоративный портал Нам необходимо было получать информацию для реализации различных сервисов Ну например тот же расчетный лист или новости выводить для определенной компании Вот и мы были в начале потребителями информации то есть Нам нужно было откуда-то получать информацию для реализации наших сервисов вот в какой-то момент времени обогатившей информации мы стали уже предоставлять ее другим информационным системам то есть Мы перешли перешли из потребителей поставщика Вот давайте более детально разберем Какие правила мы вырабатывали как мы определяли какую систему использовать Тогда почему там график ели далее мы поговорим Кто такой потребитель Кто такой поставщик про правила игры которые мы заложили при выборе системы для поставщика Ну и убирать технологии Step by step и vanstep то есть это технологии передачи получения информации Шаг за шагом и получать информацию Все за один шаг Вот как я сказал в 2017 году портал был потребителем информации То есть ему сначала нужно Необходимо было получать структуру получали её ну и сейчас получаем пару xml нужно получать кадровую информацию о дата Джейсон телефонный справочник стал xml но некие сервисы типа расчетный листа тоже мы получаем из других систем по разрешен в итоге у нас получилось так сказать некий зоопарк технологий но от этого зоопарк технологий нам никуда не деться потому что мы как потребитель услуг услуг не можем диктовать правила нашим поставщикам поставщики существующие информационные системы которые уже интегрированы с рядом других и мы не можем прийти сказать все ты Работа будешь так как мы сказали вот по своим протоколам спецификам и так далее собственно какие знания мы выделили у потребителя потребитель знает какая информация необходима и для чего поставщика с которым он будет работать язык и способ общения с поставщиком вот дальше мы стали задуматься когда мы сами становимся поставщиком Можем ли мы использовать такие же правила Какие технологии использовать поддерживать такой же зоопарк технологий и спецификации Ну не особо хорошо Вот и мы начали думать а что же знает у нас поставщик о потребителях и на тот момент мы поняли что поставщик ничего вообще не знает о потребителях ничего и мы начали здесь отталкиваться от другого от незнаний поставщика что же поставщик не знает это количество возможных потребителей если мы рассматриваем развитие системы на будущее платформы технологический стек потребителя и Какая информация и для чего она нужна собственно потребителю Да собственно основываясь на этих незнаниях мы подготовили ряд правил разработать собственные правила вот что должен какие правила должен соблюдать поставщик это первое быть единообразным то есть для всех работать одинаково потребитель без исключения по какой-либо спецификации языку и так далее отдавать одну и ту же информацию независимо от каких-либо условий это первое правило единообразия и второе работать по принципу То есть за один шаг отдавать требуемую информацию вот Давайте проговорим по принципу One Step и Step by step более детально мы рассмотрим примитивно так сказать ирпидиограмму новости как мы знаем и видим на данном слайде новости у нас связана с просмотрами с рубриками с комментариями Ну из пользователями собственно для получения или выдачи страниц новостей пользователь по технологии сначала обращается к серу приложение к фронту какому-либо вот сервер приложений посылает запрос на новость получает айтишник и дальше пошел получать комментарии лайки просмотры рубрики и так далее собственно получив всю необходимую информацию он отдает его пользователь пользователь доволен вот можно получать информацию по другому собственно когда пользователи говорит Отдай мне пожалуйста всю информацию страница новостями а сервер приложение Front примерно тоже с такой запрос посылает его на бэк Говорит Тоже мне сразу все отдай бэк его как-то обрабатывает Вот это умный он Поинт и собственно дает вот сравнивая две технологии мы можем увидеть разницу во времени да то есть повышается у нас производительность И скорость отдачи ответов но мы стали сравнивать эти две технологии передачи степ информации с точки зрения трех критериев это производительность система управления знаниями и порог вхождения в данную технологию собственно по производительность как мы уже поняли технологию ванцтопоигрывать так отсутствует множество накладных запросов это сеть формирование пакетиков и так далее вот система управления знаний достаточно достаточно простая у технологии потому что нужно просто знать принцип работы этой технологии вот они фактически ее фактически ее реализацию мы по принципу работы можно сказать Вот такой для получения такой-то информации Необходимо написать какой-то запрос и всё вот единственный небольшой минус у технологии Vans Step это более высокий порог вхождения Ну как правило обычные рестточки запросы уже все их знают как писать вот а спецификации умногой in поинта необходимо вникнуть Вот Но это понятно собственно сформировав некие правила критерии напомню правило у нас было Два это единообразие и работа по принципу Vans Step вот мы стали задуматься Что же нам выбрать поначалу Мы тоже писали обычный там паре с архитектуре запросыпишные вот пару метров реализовали но больше быстро пришли в тупик начали спорить как например формировать ответ формировать ошибки и так далее каждый разработчик кинул одеяло на себя вот начались споры и так далее дебаты вот здесь подумали А это был 2018 год они внедрил ли кто-то уже что-то подобное мы начали открыли интернет начали читать и так далее и на тот момент наткнулись на интересные технологии вот этого графики вот что такое технология краткий график это язык запросов с открытым исходным кодом и у него есть три основные характеристики Первое это позволяет клиенту точно указать данные Какие ему нужны второе облегчает агрегацию данных из нескольких источников вот ну и третье использует систему типов для описания данных Как вы можете заметить на данном слайде приведен некий граф Граф состоит собственно всего лишь из четырех типов это рубрики пользователи новости и комментарии но вы видите что здесь между ними куча взаимосвязи более 10 то есть реализовав 4 типа у нас появляется достаточно высокая вариативность собственно Прочитав технологию нам она понравилась мы поняли что будем использовать ее напомню что Это был 2018 год и про реализацию на PHP и внедрение особенно в интерпрайз компании практически не было Если честно про внедрение и сейчас информация не находил в интернете а на ряде конференции наоборот слышал что кто-то планирует внедрять но сомневается как приживется технология или нет сразу могу сказать что технология хорошая вот у нас она прижилась уже более четырех лет поддерживаем и развиваем сами вот естественно у нас за это время появилась так сказать несколько Маст хэв функции вот наших bestractics Вот но них сейчас поговорим более детально Вот Но первое дальше мы перейдем немножечко к харкору про архитектуру проговорили давать немножечко уже проговорим про Граф киель начнем с базовой структуры просто верхним уровнем пробежимся Как внедрять создавать типы и так далее Далее проговорим про безопасность разграничения прав доступа про безопасность заражения прав доступа в библиотеке вообще в граффи или Ну нету информации это разработчики разрабатывают сами далее поговорим про производительность Вот как раз реализация составных запросов Ну и про гибкость про реализацию сложных фильтров с логикой и или так Ну давайте по порядку сначала на данном слайде мы рассмотрим некую структуру сразу хочу сказать что здесь код приведен написано чистым PHP без обработки каких-либо переменных и так далее и он показывает только принцип внедрения данных методов продуктивнее его использовать в чистом виде не рекомендуется вот собственно в графстве существует два корневых типа данных это notation Type и query Type вот motation используется Естественно для изменения информации для получения информации на самом деле в графке есть еще третий тип подписка но он реализован для реактивных библиотек PHP и версии или версии больше 8.1 Но это я говорю конкретно про библиотеку Боникс Граф Киеве мы ее используем у себя на портале вот саму технологии подписок Мы реализуем через другие У нас есть другие информационные системы типа шины брокеры сообщений брокеры и так далее вот собственно далее есть краткий или Ну и мы рекомендуем вести реестр кастомных своих разработанных типов данных файлики PHP А собственно дальше показана зелеными стрелочками это сами кастомные типы комментарии новости рубрики и так далее Ну и дальше нужно нам писать сущность для реализации взаимодействия с базой данных на самом деле если у Вас уже есть какие-то ОРМ сущности и так далее Вы можете не использовать эту папку а сразу в типах указывать возвращаемый результат Давайте Пойдемте дальше и для начала Нам необходимо создать сам файл входную точку это допустим краткий индекс.php Но первый естественно подключаем gravel далее получаем исходные данные мы создаем схему которая состоит из двух у нас основных типов этого римутейшн далее обрабатываем запрос обрабатываем ошибки производим логирование прологирование выводах я скажу некий тоже рекомендации и далее выводим собственно ответ мы описали входную точку но для создания типа нам как правило достаточно Первое это описать запрос то есть сам тип зарегистрировать его описать возвращаемые поля и реализовать взаимодействие с хранилищем Давайте по порядку для начала опишем запрос мы будем ориентироваться тоже на новости дальше еще будет тип рубрики вот мы будем вокруг этих двух типов крутиться Ну собственно описываем наш запрос Вот то есть добавляем ключик News добавили его создаем новый тип данных types News добавляем аргумент по которому можем получить новость То есть это айдишник по айтишнику будем получать новости Ну и добавляем некую резон функцию которая будет уже получать результаты из базы собственно описав наш запросик query мы должны его зарегистрировать регистрация происходит достаточно просто в файле types PHP после регистрации нового типа Нам необходимо перейти к описанию полей то есть реализуем Класс newstype вот и описываем его филды которые он может возвращать потребителю то есть данном случае это один новости а имя новости и текст но здесь детальный текст мы подразумеваем вот Ну и дальше нам необходимо реализовать собственно некое получение информации из базы Select From обычный вот опять же повторюсь что не обращайте внимание на структуру написания кода это чистый PHP вот без обработки без всего вот собственно дальше проделав все эти операции мы можем попробовать сделать наш запрос собственно на данном слайде мы проверяем работоспособность посылаем Запрос к Вере указываем четко Что такое запроса не motation указываем тип новости указываем входной параметр айдишник 6130 Вот и список полей которые мы хотим получить в данном случае это один найм и текст собственно послание запросы нам вернулся ответ 30 бронза из Магнитогорска именно новости но конь детальное описание формате HTML дальше Давайте попробуем Так это у нас Граф киель умный inpoint попробуем получить сокращенный набор информации указав ID и Наим удалим текст то есть ничего не сделал подключив просто библиотеку мы можем это сделать То есть здесь потребитель сам вправе выбирать Какие поля ему забирать вот дальше Давайте перейдем плавненько к производительности составным запросом Собственно как мы говорили что новость имеет связь с различными сущностями в том числе с рубрикой Вот давайте для начала опишем такой же тип Но для рубрики вот он Аналогично писанию News то есть в query то PHP мы описываем рубрик вот и собственно дальше нам необходимо его зарегистрировать регистрация происходит Аналогично типу новости вот и собственно Нам необходимо писать поля в качестве возвращаемых полей мы будем использовать айдишник рубрики имя рубрики и символьный код рубрики дальше реализуем простенький наш запрос для получения информации и Чтобы в дальнейшем нам смачивать как-то новость рубриками Нам необходимо добавить в тип новости новый филд новое Поле чтобы новость нам возвращала хотя бы айдишник вот добавляем рубрик рубрик вот Давайте попробуем сделать запрос добавляем в наш запрос слово рубрик и видим нам возвращается айдишник 18 но чтобы получить нам информацию по самой рубрике знаю айдишник нам нужно сделать Второй запрос Да вот делаем запрос рубрик знаем айтишник И нам возвратилась сама рубрика на лома капрон Вот именно кодом Итого у нас ушло 280 секунд на два запроса вот Давайте попробуем реализовать составной запрос чтобы мы могли получать эти же данные но при одном запросе собственно это делается достаточно просто переходим опять в наш класс новостью и возвращаем полями добавляем буквально две-три строчки резол функцию да то есть мы уже Превращаем это поле так сказать в объект со своими полями под объект вот добавляем функцию Вот и в которую Передаем входные параметры вот далее уже можем послать запрос Как вы можете обратить внимание у нас поле рубрик превратилось в некий так сказать объект у которого есть свои собственные поля ID на имя коды сформировав такой запрос мы можем послать его на сервер и нам вернется такая информация вот сразу С новостью и с рубрикой В итоге у нас ушло где-то 161 миллисекунда сравнивая две технологии это мы имеем разницу приблизительно 57,5 процентов вот собственно эта разница может быть больше меньше зависит от условий но она будет как мы видели Я показала предыдущих слайдах вот за так технологию отсутствует накладные расходы вот на сеть что самое так сказать больной и длительное так Ну про производительность немного с вами проговорили Давайте если мы говорим про безопасность что особенно актуально в наше время сразу хотелось бы отметить что безопасность в рафт веле нужно рассматривать на сам так сказать низком уровне на макроуровне наверное вот начиная с полей то есть недостаточно просто проверить этот пользователь у него верный логин и пароль мы им даем доступ к объекту к типу какому-то нужно начинать с полей вот нужно ниже опуститься Вот и Давайте подумаем куда мы можем внедрить эту проверку вот в данном случае мы можем также в кваретой вынести все наши запросы в отдельный массив Вот и собственно массиве конфиг уже реализовать некий метод в данном случае это permission какой-то Классик у нас который будет стрелять проверку доступ к методам и его полям собственно вот этот слайд наверное стоит запомнить и вот эту точку входа потому что она будет использоваться в дальнейшем у нас и кусочка она так многофункциональная много дальнейших реализаций по проверке запросов и так далее можно реализовать именно через вот эту точку входа собственно мы разнесли наши конфиги Вот давайте перейдем к классу пермишин вот собственно У нас в классе permission содержится некий конфигурационный массив логин пароль белый список Где в качестве включая является сам тип News и список доступных полей сразу хочу сказать что это демонстрационный код естественно ни в каких геттак системах контроль версий он не должен храниться вот эти конфигурации лучше выносить куда-нибудь за пределы сервер документ Root корневой директории сайта вот возможно переменных окружения хранить которые Уникальны для каждого ландшафта Вот но здесь в качестве демонстрации мы указали в классе их вот дальше собственно наша функция process config Fields который собственно разбирает входные наши данные и передает в более низкоуровневую функцию Check Access параметры вот два параметра код и ее поля функция Check Access у нас в случае успеха если что-то не совпадает будет возвращать у нас Exception ошибка выкидывать и собственно выполнения на этом прекратится в случае успех вернется нам резал Давайте проговорим немного про те как с функцию она достаточно простая вот повторюсь здесь не стоит обращать внимание на небезопасно так сказать написание реализацию кода чистый PHP без всяких обработок показать принципы работы с графилем Вот Но первое что на вход мы Передаем ей метод наименование запроса Ну и список входных аргументов первый проверяем Разрешен ли запрос Да пользователя Вот Потом мы проверим разрешены ли возвращаемые поля для пользователя через обычный цикл for Rich Вот и выкидываем какие-то Exception и далее мы можем уже проверить работоспособность то есть на данном слайде Нам видно что вернулась ошибка Exception вот метод news is for been for User тест собственно про безопасность мы вкратце проговорили как это реализовывать Давайте плавно перейдем к гибкости реализации сложных фильтров с логикой и или что же нам необходимо для этого для этого нам необходимо создать новый тип данных мотающин инпутайп зарегистрировать его и добавить собственно логику обработки в квери запросы а стоит учитывать что который мы добавляем новый фильтр он должен автоматически генерироваться расширяться под все существующие типы данных то есть не вручную писать это рутинную там портянку вот а чтобы это работало в режиме Real Time для всех существующих типов Вот но здесь есть проблема одна библиотека не работает с одноименными классами данных и выдает некую ошибку вот напомню мы вот здесь передняя ссылочка с более детальной ошибкой мы используем Боникс библиотеку вот что же нам сделать чтобы войти эту ошибку для обхода ограничения необходимо добавлять некую соль на при автогенерации новый новых типов данных Давайте посмотрим проговорим про новый тип данных которым будем создавать собственно мы видим он по аналогии с newstype рубрик тайп создается вот здесь основное отличие это мы добавляем некую переменную наш хэш аргументов вот хэш генерирует как раз от всех списков полей которые присутствуют у нас в описании схемы вот дальше нам нужно сформировать схему типов она будет имя будет состоять из самого класса и некой соли Ну и дальше необходимо нам описать автоформирование полей на основе входных данных ну собственно формирование полей у нас будет для фильтра или выглядит вот так то есть имя опять же класса приставка о и некая соль Ну использовать будет филды которые у нас используются в самом запросе логика и будет выглядеть Аналогично о за исключением того что вместо слово у нас будет and да собственно вот так выглядит если все это собрать вместе вот этот код небольшой на вид вот дальше нам необходимо собственно его зарегистрировать регистрация происходит Аналогично всем говорили запросов добавляем некий наш смешанный тип данных для камер запросов единственный момент какой стоит здесь обратить внимание это на переменную аргумент которая это некое тоже соль которую генерируется аналогичным способом который мы добавляли для наших новых запросов это необходимо соблюдать эту логику для того чтобы корректно найти какому типу Но сопоставить между собой типа и поля которым это относится далее собственно по аналогии с внедрением безопасности Мы тоже разносим наши запросы в разные массивы вот ну и собственно уже в конфиг формируем фильтры со сложной логикой для каждого типа данных Да получаем список конфигураций наших и добавляем наш так сказать прототип вот слойка или и вот И формируем тем самым автогенерируем фильтры собственно отличие ручной генерации автоматически генерации представлена данном слайде то есть мы сразу можем заметить что автоматическая генерация у нас занимает будет всегда занимать это строчки 2 ручная генерация намного больше что это учитывать что здесь генерации в ручном виде приведена для одного только к Вере запроса и только для логики или для And еще такая же портянка будет ну и для всех последующих типов будет Аналогично только расширяться расти Давайте собственно проверим как это все у нас работает но посылаем говорить запрос и указываем фильтры уже логику о у нас появляется возможность для каждого типа указывать логику в данном случае мы указали два айтишника новости 6130 и 6137 некую информацию которую нам необходимо получить собственно послал запрос мы получили две новости нам вернулось Ну описав у себя на портале там у нас более 20 типов кажется описанным типа в данных вот среднем у нас один так сказать сложный тип состоит имеет взаимосвязь с другим с тремя другими подтипами В итоге у нас удалось реализовать более тысячи комбинаций сочетаний то есть достаточно высокого вариативность то есть потребитель может по своему желанию получать информацию на свой вкус и цвет вот собственно Давайте подходить к концу и подведем так сказать выделили некие рекомендации но первые две рекомендации это архитектурные собственно с чего мы начали про при внедрении grafq или это первое Вам необходимо определить потребителя и поставщика Вот от этого будет зависеть ваш выбор технологии далее Старайтесь реализовывать принцип то есть получать информацию за один шаг вот дальше три пункта относятся больше к самому графу вот а это кстати некий Маст хэв функции наш Best practics но Первое это обязательно заложите систему разграничения доступа К объектам и именно к сущностям к полям вот на самом низком уровне вот далее настройки систему логирования как я говорил здесь нужно вам четко фиксировать потребителя не на основе айпишника какого-то который может меняться проходя через различные балансировщики маршрутизаторы здесь рекомендуем регистрировать именно логин вот по которому однозначно сможете определить информационную систему которая у вас запрашивает доступ дальше уже с этой информации там быть сами анализировать Почему такие поля запросила Эта система Почему так долго какие-то ответы происходили и так далее вот ну и Последний пункт последние рекомендация это собственно сделайте фильтр со сложной логикой Вот за это вам скажут спасибо различный информационные системы нам свое время это уже сделали сказали в том числе У нас есть мобильное приложение которое забирает данные с порталом вот оно сказал спасибо нам так ну собственно на этом У меня все на данном слайде приведены мои контакты презентацию Вы можете получить по ссылочке если кому-то будет нужна или посмотреть но по QR коду Вы можете оценить мой доклад собственно коллеги если вопросы готов ответить Сергей спасибо очень насыщенный технический доклад слушаем вопросы приветствую Спасибо за интересный доклад вот когда ты говорил об ограничении доступа как раз там фигурировал проверка логина паролей всякого такого и в конце тоже сказал именно про один Это я так понимаю что вот по этому же принципу авторизации в общем какой-то проверка доступа работает и ваших системах на этом или нет нет здесь мы говорим про интеграцию между системами мы заранее знаем что ну в текущую ситуацию у нас это наш внутренний информационные системы да то есть это больше наверное сейчас про бейсикализацию если мы говорим про пользовательскую авторизацию там уже и у неких пользователей там псо входят А нтлэмы и так далее протоколы используется То есть у нас достаточно большой Спектр авторизации Вот здесь мы конкретно рассматриваем крафт или интеграцию с другими системами Не использовать а именно с информационной системы вот в качестве примера быть на ваше усмотрение влепить какой-нибудь свой провайдер вот кей клок Вот это блиц какой-нибудь который Вам будет за вас это все делать представлять там авторизацию Вот это на ваш вкус и цвет здесь в качестве примера Вот Но мы используем различные технологии вот понял спасибо Спасибо за доклад у меня такой вопрос а вы мерили сколько у вас схемы инициализируется на каждом запросе еще раз сколько у вас схема вся эта графика или инициализируется на данном запросе у нас праздновали любопытство спрашивают примерно в том же году 2018 на той же самой библиотеке мы собрали прекрасную схему и через 2 недели разработки обнаружили что онанизируется 458 миллисекунд каждый запрос Для нас это было неприемлемо и Извините но мы откатились я понял да есть мы анализируем вот я рассказал про логирование про логирование наверное пользователей Вот Но у нас планирование еще записывается формирование ответа сервера то есть мы эти логики потом через Елка систему собираем анализируем я не помню 450 миллисекунд чтобы у нас был если бы такое было у нас куча информационных систем Ну мы давно прикрыли эту лавочку 4 года существует то есть там у нас это все намного лучше сейчас точных цифр не скажу Но точно не пол секунды я не знаю вот это 450 миллисекунд это достаточно много но это было девственности Классно еще от контура много зависит Вот и от схема может зависеть то что у нас была очень огромная развесистая схема это ну и второй вопрос кванстеп тут возникает такой вопрос Вот вы показали допустим у вас есть новость есть комментарии к ней А если комментарии отвалились Грейс волгоградешн в вашем One Step как будет делаться Ну когда я это делаю на виджетах я понимаю ну когда отвалились комментарии сам объект недоступен Вы имеете в виду или что-то Ну да Ну никак не будет работать вот будет возвращать ошибку Вот то есть сделать нюансы то там будет два виджета один покажет пользователю новость такая пока Согласен согласен согласен но здесь нужно опять же исходить от того в целом и система какой вы класс к ней закладываете и так далее То есть вы должны предусмотреть а-а всю систему у вас может и основной вопрос валится новость может и сервер упасть вот здесь то есть нужно смотреть не за конкретно так сказать слушайте объектом вот а за все информационные системы в целом Вот и Хмм используют технологию Step bsp вот да вот Ну я бы не особо рекомендовал вот Ну наверное в большинстве случаев вот если у вас вы получите новости а приложение нужно еще рубрики то сами по себе новости они не будут нужны Вот то есть рубрики можно Запиши рубрики можно за кэшировать можно можно можно это зависит уже от конечного потребителя как он будет получать от все может пачками и так далее Вот то есть это я согласен Вот спасибо Спасибо за доклад много думал как насчет ненормализированных запросов То есть как я вижу Запрос к новостям да идентификатором А как насчёт к новостям у которых определенная рубрика и которой за определенные даты То есть это одновременно и туда и сюда не можно реализовать это уже можно указывать Здесь мы в качестве входных аргументов указывали айтишник можно указать например более какой-либо создание новости Вот Но при этом еще в рубрике То есть он э-э с помощью сложного фильтра который я говорил или вот здесь можно указать еще а не только по новости ещё по рубрике фильтр вот я хочу новость с определенными рубриками получать вот фильтр или а как строится запрос тогда еще раз как строится запрос тогда ну как ну давайте я не знаю слайд немного назад Просто я у меня Я хочу рубрику там с таким-то названием Да а на экран уже не выводится то есть рубрика с таким-то названием и свежие новости вот я должен запросить обратиться к тексту рубрики получить рубрики и потом получать эти Да вот я понял нет здесь нужно идти по-другому тогда я понял здесь указать сразу из двух полей у нас ну такого сейчас ну невозможно Возможно это можно как-то реализовать Вот здесь мы в основном ориентируемся на самое основное квебери запрос то есть на родителям получается скорее всего Придётся делать нормализованное хранение будет ходить туда что это слишком сложно комбинировать насчет в принципе если рассматривать по-моему фичи Да и прям права доступа то там можно насчет долгой инициализации доверять запросу Да и к каждому у каждой фичи будет свои уровни доступа Да если мы доверяем запросу мы доверяем что клиент запросил такой то да мы проверили если у него доступ на этот уровень до Вот и несколько раз сложив запрос мы отдадим его и вот это вот комбинаторная сложность по-моему надо можно избавиться если доверять прямо не фиксировать а доверились запросу проверили право доступа и в результате у нас только как вот определённого уровня эти будут как конфиги не глубоко спасибо Так у меня еще вопросы с чата зачитываю мы используем в наших проектах Граф quel но у нас нет кэширования на вход Как вы решаете данную проблему каширный на вход на самом деле мы тоже на вход кэширование не использую но пока не встречали таких на самом деле сложных запросов Вот но больших которые выполнялись бы очень долго как правило это ну небольшие мелкие запросы так сказать некий шум вот на общем фоне Они разношерстные то есть нам кэшировать особо нету смысла с этим мы пока не разбирались но это уже на совести собственно разработчики Архитекторов лежит это можно уже реализовать собственно технологии Наверное графьево это любой технологии наверное вообще кресту это не относится уже как-то отдельный реализовывается вот можно Единственное что Мы заметили но рекомендую еще использовать сжатие то есть передавая заголовках некий атрибут вот можно использовать Но это сжатие должен поддерживать как сам поставщик Вот но поставщик как правило поддерживает из коробки есть а потребитель должен поддерживать вот при этом у нас при замерах выросла немного скорость ой скорость формирования запросика Вот Но количество данных передаваемых снизилось раз 8 наверное то есть сам пакетик сами данные раз восемь снизились вот как так еще вопросы зала Здравствуйте вот вы показали как описывается получение связанных данных а можно ли писать обновление связанных Ну например когда пользователи лайкает и одновременно пишет коммент я понял Ну я бы не рекомендовал вообще Вот это обновлять эти данные Мы у нас motation типы в основном происходит для каждого конкретного объекта если там строить сложно взаимосвязь А вы сами знаете можно вообще там рекурсивно уйти самих себя получать например новость пользователя по пользователю новость а потом опять по новости пользователей так далее Если вы такой запросейн пошлете Ну я не знаю что будет Поэтому здесь лучше на изменение данных делать рекомендации атомарной все-таки операции чтобы вам было проще это все отследить вот особенно в революционных системах революционных базах Вот то есть лучше атомарно делаете коллеги вопрос еще если Вопросов нет я еще дополнил Слушай а если атомарные запросы делать на обновление нескольких сущностей транзакцию это никак не обернешь это да но это уже наверное уровень BD нужно смотреть Вот это разные http запросы будут правильно Да да просто вот а там уже как ты хочешь собирать вот получил данные Ты можешь сначала получить данный здесь Кстати мы еще не рассмотрели некую проблему и не услышал вопроса Вот но н плюс один да то есть мы получаем например 10 новостей а нам еще рубрики нужно нам что мы отдельно под капотом будем здесь запросов делать по данному коду да Вот специально не стал рассматривать потому что это реализовано ну наш Ну в библиотеке в Боникс через Класс вот то есть который он в себе аккумулирует Вот то есть дальше это вот такие проблемы это решается наверное вот аккумулирование данных это сам наверное потребитель должен решать так что мы только отдаем данные вот и представляем Да ну спасибо тебе за рассказ теперь пришло время выбрать лучший вопрос могу напомнить краткие темы Если не сложно так про авторизацию про перформанс Я помню первый вопрос вот Алексей вот сидел вот можно Конечно можно Спасибо тебе спасибо и для тебя у нас тоже подарок вот организаторов конференции когда подарок то вручит ему Спасибо так коллеги Всем спасибо хорошего дня вот удачной конференции Всем пока Так у нас скоро тех толк в 11 Возвращайтесь и дальше докладов кучи до очень интересно"
}