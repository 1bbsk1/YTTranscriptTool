{
  "video_id": "bra0bQhIF8k",
  "channel": "HighLoadChannel",
  "title": "Энтерпрайзные вызовы для Postgres'а / Иван Панченко (Postgres Professional)",
  "views": 1673,
  "duration": 3562,
  "published": "2020-04-14T10:48:07-07:00",
  "text": "на сегодня мы поговорим об отдыхе в таком интересном ключе но то есть я буду рассказывать как здесь написано про enterprise на вызовы и потом я надеюсь что мы пообсуждаем может быть если кто-нибудь из вас какой-то новый представить интер правильный вызов наверное получит приз за лучший вопрос вот что это вообще за тема такая enterprise на вызовы оказалось что когда после стал использоваться в крупных каких-то у крупных пользователей ну и мать от полиса что-то захотелось и это для сообщества пояса который привыкла работать как обычного упал source и для себя и себе подобных и себе понятных оказалось что этот они действительно неожиданная и в общем-то поэтому она и вызывая вот поэтому такая тема ну на самом деле вы даже вот обратите на какой цвет фона на этом слайде он такой красное да этот цвет выжила не случайно на самом деле и к маркетингу тоже пастбищ оказался совершенно не готов но ближе к концу поговорим а сейчас просто пока вот эта заставка на экране я использую ее цели доклада вот не случайно олег бунин такой красно-желтый выбрал для свое хай-лоу тот свет потому что это это маркетинговый цвет он продает можете посмотреть на сотовых операторов какие у них цвета логотипов и вы увидите что тот у кого больше всего выручка у того самый красный цвет почему-то ну или наоборот у кого меньше всего выручку того черный скучный цвет вот поэтому не случайно позже как можно блага тип синий если вы придумывали сейчас он был бы красно кстати мире базы данных тоже у кого самая большая выручку того красный логотип вот но после шпака синий да но за эти как с дипломом диплом фини зато рожа красная и наоборот вот но у подвеса наша синий логотип но краснорожих но смысле что он полон энтузиазма сил здоровья и прет но хорошо поехали значит собственно почему я об этом все рассказать а ну во первых чтобы знали как правильно пользоваться под гришин почему вы найти обычно так бывает что люди которые привыкли пользоваться обычной су бды переходят на пузырь думают что конкурс такой же но он действительно во многом похож на надо знать особенности те же люди которые пользовались подвесным изначально но вот для меня например пол был второй базы данных и третьей базы данных жизни вот ну то есть практически 1 на самом деле и я как бы с ним рост и для меня совершенно естественными вещи которые в нем есть и вот программировать в стиле под гриша это до тех кто спорил сам рушит нормально для тех кто начал переходить уже в зрелом возрасте на него с обычной свободы те сталкивают совершенно неожиданными проблемами вот соответственно зная такие проблемы сейчас перед полисом стоят и даже понимаю что они будут решены все равно зачем лишний раз наступать на грабли вот и проектируя свою систему можно просто эти проблемы обходить большинстве случаев и вам будет хорошо уже сейчас вот ну опять же надо понимать куда идет развитие пользуется что от него ждать в будущем потому что сейчас по адрес в последние годы очень активно идет навстречу энтерпрайза вот но а тем людям которые принимают участие в разработке и возможно тоже такие аудитории здесь есть вот а им им четко надо понимать все таки что то что сообщество пользователей новых больших пользователей подвеса хочет и почему в эту сторону двигаться вот кроме этого есть странные предрассудки так называемая но вот пример странного предрассудка это ну например название до пользуюсь как под газ называется тоже мало кто знает очень много французов и даже наш уважаемый ведущий андрей шокин тоже провожая предыдущего докладчика назвал под господина то есть по-французски вот на так то ж это тоже неправильно предрассудков очень много значит некоторые считают что под грез например что чтобы в пользу сделать проецирование таблиц надо каждый сорт руками значит куда-то направлять например вот этим это меня рассказать люди которые под большим пользовались вот я предрассудки предрассудки на самом деле как я понял вот месяц назад эта тема совершенно отдельно отдельного доклада статья может даже книги настолько их много существует в одну часть из них мы сегодня может быть упомянем то что я буду говорить про какие-то проблемы про вещи которые в подписи не решены это вовсе даже не значит что они никогда не будут решены напротив там есть вещи которые делаются легко есть и многие из них уже сделан из вещей которая делается трудно есть вещи которые требуют до глубоких даже архитектурных изменений чтобы д вот но тем не менее сообщества час относится ко всему этому достаточно хорошо и например знаете есть такой человек плюс маржан который не приехал правда всегда но он кризис москву в феврале на прыжок он и когда он был в красноярске в 2017 году в первый раз вот его там спросили что-то рады вот он сказал food рады значит под газ должен работать по такой процессная модель один процесс на сессию и все а этой осенью когда его спросили а что значит что делать если нужно 10000 сессий он же сам сказал труды то есть это говорит что в сообществе проникает мысли о том что рано или поздно какие-то глубокие структурные изменения они выше скорейшее будут происходить ну понятно что не быстро вот ну я конечно не претендую на полноту но извините но никакой доклад не воткнешь полного это вообще не энциклопедия но тем ни менее надеюсь что наша дискуссия мой доклад про сам превратится в дискуссии может быть это даже мне тоже будет полезно услышать какой-то фидбэк не только про доклад естественно про сам по сгрыз вот но говорить о в enterprise ну the step адресу надо сейчас потому что ползаешь действительно очень сейчас популярен вот и в россии и в мире значит вот это опрос хай-лоу до который может многие виде олег бунин опубликовал что в 53 процента участников этой конференции так или иначе использует позгалев и он оказался загадочному уже на первом месте при этом вот но в мире тоже под грифом как-то достаточно сильно растет по популярности в последние годы и он становится энтерпрайзе носом и в россии и в мире и все это чувствует и что важно сообщества полюса это тоже почувствовала и она вначале просто так получилось сейчас уже все это осознают что вот именно модель устройства сообщество очень сильно меняется если вначале она была обычным об их собственном сообществом который делает то что хочет то есть программисты разрабатывает для программистов и своих родственников вот то сейчас уже можно говорить что это кастами родриго на некоторые такое болеешь более сложное сообщества которое включает себя и компании и компании потребители и компании которая специализируется на подлость и компании которые вы используют но настолько существенно что вносит него какие-то изменения и компании паразиты которые используются носит изменения на не публикует их вот есть и такое вот ну и конечно важным показателем тв развитости под колеса роста его применимости серьезной задачей является то что очень крупные компании значит покупают пожгли совы и компании и начинается уже не стесняться использования под адреса но в том числе знаете что microsoft приобрел сайт us do тазаль неизвестное количество миллионов долларов но по слухам там около 200 так далее и интерфейс тебе тоже перешло от одного акционерного фонда к другому а вот но это это все о чем-то говорит конечно и будущее позже со дано смысле ну одной страны тумана с другой стороны есть хорошие надежды на то что не будет приватизирован здесь это достаточно трудно сделать просто вот и скорее всего он так и не которые существенно для нас время пробудет базой данных номер один ведущий вывод аж то что с ним будет дальше происходить сильно зависит от того как сообщество будет вот на те самые enterprise ные вызовы реагировать будет ли она значит гибкой достаточно хорошо идти им навстречу вот тот же самый bluesman жан делает очень хороший закладка отражается будет ли под grease жить вечно собственно там об этом говорить что о повтор снова сообщества больше степень гибкости чем у любой компании поэтому как раз позади с лишним не будет поменять то тогда он действительно может жителям практически вечно долго вот но давайте перейдем к конкретике начать главный enterprise на вызов для подвеса но и вообще для всех реляционных субд и на самом деле это вызов горизонтальной масштабируемости возможно ли просто добавили добавив побольше серваков увеличить производительность мечта любого клиента доставляю серваке становится быстрее и вот но на самом деле это это конечно скорее мечта и в чистом виде это не работает никогда разработает если весь архитектор который правильная масштабирует вашу систему вот но если речь идет о масштабировании при нагрузке или долго это мы обычно добавляем реплики и как-то размазываем по ним нагрузку на самом деле реплики пригодными для всех арендованный запросов а только для достаточно быстрых и тех которые не используют временные таблицы этому мы тоже может быть еще коснемся но такая известная проблема есть вот но тем не менее придуманы нагрузка с помощью reply большинстве практических случаев масштабируется среды райт нагрузкой все гораздо сложнее значит какие-либо много головы и системы синхронно асинхронной репликации как мульти мастера любите or any к сожалению мне каком масштабировании позже песни не дают несмотря на то что узлов больше но из-за репликация между ними каждый узел получает все равно всю запись поэтому получается так что наоборот запись на такой кластер идут медленнее вот поэтому бег без шарден га значит без секционирования данных к серверам никакого презирать масштабирования не будет вот sharding это всегда сложная архитектурная вещь значит возможно ли автоматический шарден в общем случае но вот исходя из сегодняшних научных знаний скорее нет чем да вот то есть какой-то искусный интеллект должен разобрать как расшарить вашей таблице а случае если поток запросов изменится то пересадить их по-другому ключу вот но это это трудно себе на практике представить но может быть когда-нибудь мы к этому придем в любом случае чтобы сделать прыжок простой sharding по известного заложенного архитектором принципу вот тем не менее базе данных должно быть вот то что перечислено этом слайде так попробую новую технологию она не работать так работает вот эффективный распределенный планировщик исполнителя запросов вот это такая штука на которой работает многие прогресса в компании на сообществе пока что этого нет то есть какие-то кипами мы знаем что есть прекрасный распределенный планировщик глен пламенно пример есть нет некоторые более универсальна на не столь совершенный распределенный планировщик в пост про а вот счастью пока что этого нет но я надеюсь что появится и на сене конференции по жуков европа как раз об этом был совместный доклад от вас гаспра интерфейс baby вот то есть скорее всего не катит map сообщества направления шарден га возникнет вот необходимо делать распределенная транзакция как это делать в общем-то уже понятно этот механизм реализован мульти мастере пост гаспра о нем сообществу рассказывали еще в 2015 году на конференции вене вот и это практически полностью расширение но только нужно добавить небольшой патче который определит хук на которой это расширение вешается и мы рассчитываем что здесь наши после сплошные разработки попадутся общество вот другая проблема для любого кластера в том числе до шарди рана кластера это как консистентной бэкапить его поскольку каждый узел живет в бы капица времени сам по себе вот как за это забекапить их консистентной то есть в один момент с точки зрения трансакционного времени как их восстановить на один момент эта проблема тоже сейчас не решена это опять же есть подходы но поскольку хочется делать это еще и без downtime а вот то пока что ни один из практически реализованных и даже запросы теперь он их подходов этого не дает вот но тем не менее на самом деле вопрос это считается что вопрос эффективного планировщика распределенного распределенных исполнителя он более актуален поэтому все усилия щас там и по-прежнему лучше выбором рекомендации лучших словно вводов является sharding на уровне приложения потому что на уровень приложения в любом случае вы больше знаете о данных чем чтобы д но это требует конечно большего интеллект от разработчиков а вот при всем том росте популярности позорься которые мы имеем интеллектуальных умных разработчиков умных админов конечно не хватает и поэтому один из enterprise нах вызвав по адресу это как сделать так чтобы тупой админ и значит не очень обученный разработчик могли тем не менее делать приличный код для этого прогресса и прилично экспортировать как такое возможно раньше не знали сейчас уже начинают придумывать вот если есть еще такие интересные кластерные системы значит как oracle о в ирак и пожгли собой позже из excel вот но что это такое на самом деле позже sexual даёт некоторый уровень горизонтальной масштабируемостью нем есть строгий встроенный шар link это это одно из решений строить на авшар денга вот но скорее всего это ветвь скажем так относительно тупиковая потому что он не сильно масштабируется вы не можете сделать там десятки сортов и как раз вот такого уровня sharding десятки сотни узлов он как раз интересен нужен вот значит арок новый рак который имеет общую сторону как то значит сообществе ip-адреса пришли к общему мнению что это не пожгли с не пожгли свой путь и решили этого не делать потому что первых общей сторож он достаточно дорог а позже должна работать на простом железе и пользователи такого рака будет немного решили идти по поводу кластеров типа шарик массой и попыток делать рак пока что не предвидится ну хотя я лично не отношусь к этому так радикально я бы как раз может быть и попробовал дальше значит следующая группа вызовов касается репликаций но мы знаем что в космосе есть 1 2 репликации физические логическая физическая просто я быстро и 1 не универсальная негибкая вот кроме того реплики на ней не пригодны для выполнения длинных запросов это знает и иногда вал трафик достаточно большой и скорость его применения иногда на сам или неудовлетворительно реплики могут оставаться некоторых случаях или контролируем с этим сообществу борется и по видимому все эти проблемы кроме временных таблиц имеют быстрое решение до всех их есть какие-то патче которые вал трафик например при создании индексов сильно сокращены двенадцатой версии вот для долгих запросов тоже есть патч александр коротков этим занимался достаточно много можно посмотреть списки рассылки это обсуждается я вот забыл к сожалению презентация вставить эту ссылку но в ту версию презентации что я выложу на сайт и и вставлю вот это интересная тема и городков долго этим занимался и надеюсь что этот патч тоже рано или поздно будет за комичен лучше раз вот с логической репликации тоже есть проблема длинна транзакции реплицируется на ней крайне медленно и могут вообще повесить систему поскольку длинная транзакция прежде чем пойти в репликацию копится на мастере целиком там может например не хватить даже место для это неудобно и поэтому есть не только проблема параллельно применение проблема частичного применения транзакция должна ехать на реплику по мере того как она исполняется на мастере и применяться там начинать до капитана мастере для этого тоже есть патч и вот они уже подвержены этому обсуждению критики и но есть неплохой шанс что в 13 версию это попадет вообще разработка логической репликации к сожалению сейчас приостановилось сообществе надо вот такой скорбный факт существует это связано с как с положением компании второй квадрант которая но который не очень легкая но она она выживет и справиться просто унесешь меньше возможности разрабатывать она как как бы за это дело взялась и она долгое время двигало логического репликацию вот сейчас по каким-то своим внутренним причинам они практически перестали эти вещи делать и комитет но вы знаете что саймон директор 2 и основатель этого 2 квадранта был лишён коми царство за свои эксперименты с абсурдом с мертвым и может быть это тоже как-то сказалось вот но и время от времени возникают разговоры о том что нужна некая физиологическая репликация которая состояла бы из содержал бы достоинства физические логической репликации и не имела бы их недостатков вот но что это может быть это же александр коротков кстати есть какие-то на этот счет мнения константин книжных сделал эксперимент и вот но не факт что из этого что-то выйдет по крайней такая тема есть это тоже важно интересная тема это раздвигание пределов то есть мы знаем что в пользуюсь и можно создавать очень большие теоретически можно создавать очень большие базы теоретически элементы очень велики но есть практически лимиты в которой мы упираемся часто вот и на самом деле размер таблицы он обычно упирается там какие-то ваши реальные возможности вот какие например если вас очень большая таблица вакуум у нас как известно не умеет параллельно ходить по одной таблице ну тогда плохо не будете успевать и вакуумировать вот и это для больших таблиц одна из важных проблем она правда решается секционирование мысли во время вы его сделали вот есть например такое ограничение по размеру бойцы а на реально не гигабайт как пишет документации как написано во многих статьях на из такого флауи таких ресурсов значит в реальности из за того что она имеет в это текстовое представление которое тоже должно быть га боится укладываться бойца не гигабайт вот но редко какому нормальному имеют разработчику из тех людей которые же лишь позови сам всю жизнь и мне придется голову записи гигабайт поле байт а но и даже даже что мегабайт не придет голову запихивать но enterprise на заказчики часто это делают потому что это возможно в пастбище и действительно хранение файлов например больших вот полях базы данных имеет кучу преимуществом что вы получаете от базы backup получаете управление доступом еще какие-то плюшки вот и соответственно мне надо думать о тому же как раскладывать файлы файловой системе просто держите их базе и вам хорошо а как держите их базе просто кладете в байта и думаете что гигабайта хватит всем но вот оказывается что бойца всем не хватает и из практики приходилось встречаться с файлом который лежал в байта которая представляла собой xml в котором был за и скрепленный xml который был же escape юный xml в котором был в base64 pdf со сканированного документа вот но это это реально было и конечно эта штука довольно большая по объему вот даже на сотни мегабайт бывало значит некоторые люди хранят в бойца чертежи чертежи тоже бывают большими вот и им это важно потому что чертежи как бы нельзя просто так положить файловую систему не общедоступная и поэтому люди маются и засовывают их сертифицирован на базу данных вопрос секционирование тоже очень полезен для раздвигание пределов но часто для того чтобы можно было работать с большими таблицами секционирование в пастбище сейчас два разных они оба из них не очень хороши и оба из них каждый из них имеет какие-то свои достоинства вот например 2015 году было сделано расширение позже пас на который очень у многих используется которые упал собственная и которые появилось раньше чем эффективное секционирования мальной пользуешься я лично пользовался секционирование подписи с 1999 года когда ним вообще еще мало слышно было но тем ни менее вспомнил классический механизм помощью наследования он работал очень давно одним из предрассудков является то что все остальные секционирования в пастбища сводится к нему нет ответа не не сводится к нему и они не делаются на триггерах вот но тем не менее они устроены по-разному mirta секционирование которое есть уже в ядре пузыри со то про позволяет параллельно исполнять запросы по секциям пасман не позволяет параллельно исполнили запросы по секциям зато он позволяет секционирования блицу конко линд ли то есть без установки под нагрузкой без блокировок соответственно у каждого уп османа достоинства поскольку он сейчас уже не развивается впредь я просто поддерживается в него достоинства уменьшенного 12 версия не еще есть вот например то что он может автоматически создавать партиции это что он может вот то что сказал делать проецирование конкуренты но вот мы надеемся что в 13 версии все эти вещи уже попадут и в основной полюс и тогда пасман просто для совместимости останется как такой интерфейс потому что там есть вот но так как эта работа как раз часто достаточно активно ведется и сообществе их позы строй в enterprise db значит большое количество таблиц нам приходилось встречаться с заказчиками которые создают очень много таблиц и не только временных идея здесь в них 2 во-первых если главное деток а если пользователь видит на экране что-либо в форме таблицы почему бы этому не быть отдельной таблицы в базе данных а если пользователи очень много но соответственно таблицы получается очень много вот такая мысль бывает ну вроде бы тем людям которые спасали сам жили всю жизнь там или почти кажется это необычно а другие люди думают по-другому вот культуры людей в том что надо относиться толерантно к людям других культур вот но мы пытаемся это делать и на самом деле поэтому хочется как-то раздвигать возможности пользуешься в пользу больших таблиц вот здесь есть ссылочка посмотрите этот проект миллиард таблиц это было пять шесть назад люди попробовали пощупать по злишь на предмет того а сколько вообще таблицу него поместится но им пришлось правда миллиард они так и не смогли туда запихнуть таблиц вот но чтобы хотя бы там какое-то количество миллионов за им пришлось подключать практически все что есть включая вакуум тоже устроишься вакуум это один из тормозов по отношению большому количеству таблиц но у нас есть заказчики во вторых количество таблиц приближается к миллиону вот им приходится аккуратно настраивать вакуум значит большие поля но вот те самые большие байт а но и сейчас в виду популярности джейсона тоже стали большие джейсон и появляться в подгрести сейчас джейсон как и на как все большие поля то уж тиц и то есть режется на самой сети по 2 килобайта вот что жутко неудобно если вам надо достать какой-то поле из конца вот этот большого джейсона джейсоне если это джейсон бета тогда поля внима сортированы по длине ближе к началу лежат полях короткие дальше с короткими ключами дальше лежат полях длинными ключами поэтому такой вот теоретически могут быть как что сверху поля которая чаще используется держать и делать так что мне требовалось вот полностью целиком это джейсон раскодировать или же помимо джейсон бы придумать другой какой-то индексированные такое хранилище джейсона в котором сразу мы понимали какой сварщик надо зачитайте зачитывали его для того чтобы конкретный ключ достать вот сейчас этого всего нет но мы хотим чтобы это появилась другая проблема известная проблема ара правда по адресу которая связана с 32-битным на счетчиком транзакцией ну вот пост гаспра одно из первых что мы сделали и что сообщество не приняла и что мы поэтому оставили только своей enterprise версий это 6 4 бит на счетчик транзакций мы сделали это когда получили клиента у которого был миллиард больше миллиарда транзакций сутки год и который соответствие периодически наталкивалась на wraparound и после того после того как нам пришлось значит спасать клеток европы раунда ковыряясь дебаггер им прямо в памяти живого пузыри со откручивая там искусственно точку заморозки вот мы поняли что 64-битный xid нужен вот и придумали способ с помощью которого не распухали бы с головки записи 4к сито хранятся придумали разбить 64 бита на эпоху и смещение эпоха 1 на блок и соответственно размер записи уже не не изменяется у меня и так уже головок блока вот на оказалось что для позже если это не очень хорошо потому что на 32-битных платформах если этот патч применить то тогда 32-битная платформу медленно работают 64 битным и числами соответственно собственно сказал что нет это не годится подождите пока не возникнут флага был столь же и тогда вы сделать это отдельным типам сторожит которые будут применять только те пользователи у которых частички разбит на железо то есть практически все сейчас уже вот но сейчас опять же в сообществе тоже эту тему время от времени поднимается по ссылочке есть какой-то трек про это вот так что так или иначе это folder скоро попадет и в обычном собственной вот временная таблица приносят постоянная проблема времени таблица впуск рисе слишком похожи нормальная таблицы и на самом деле рекомендация вот моя рекомендуется так я лучше избегать временных объездов и зачем они нужны и они они на самом деле не очень нужно вот когда как-то раз меня были работали хорошие ребята студенты которые для хранения временных данных вместо чтобы хранить их памяти клиентского приложения но приложение было этот ну что-то вроде графического редактора чертеж был который в принципе в базе данных хранился в нормальных таблицах ну вот представьте себе штампы это ради элементы на схеме и вот они там как-то соединены где-то находится в каких-то координатах вот этот чертеж когда поднимается память приложения оно отображает позволяет редактировать вам этого но вот к сожалению для того чтобы из внутреннего представления сконвертируется в те таблицы по которым это все в которых это все разложено в базе ребята использую и временная таблицы но зачем говорила им возьмите делаете это просто в памяти приложение все эти преобразования дано тогда нам придется больше писать на си плюс плюс нам гораздо проще написать это на был уже иску или вот но правда при этом нагрузил базу огромном количество временных таблиц год но это не было супер нагруженная система поэтому это было просто архитектурно криво наработала а для того чтобы работать с временными таблицами в нагрудных системах надо уже хорошенько считать а сколько у вас их будет что времени таблицы попадает тот же системный каталог что я обычная таблица вообще-то те же сам обычной за близ и просто видно я только их хозяину но у них есть одна интересная особенность линий не попадает в of the vacuum вот одна из вещей которые эти oracle говорит мы автономная базы данных мы не требуем администрирование oracle работы сам по себе пост на самом деле стал автономной базой данных очень давно а именно когда меня придумали of the vacuum когда-то раньше вакуум надо был запускать руками но вот для временных таблиц если вы собираетесь использовать их долго тоже надо делать вакуум руками ну что of the vacuum имени занимается розыгрыш рассчитывают что в конце сессии произойдет значит автоматическая зачистка этих таблиц а про правда еще не настанет но это значит что вы не будете пользоваться времени таблицы там дольше чем лечение миллиарды пока не проскочит базе миллер транзакций вот но это не так и вот там вот внизу есть три ссылочки на 3 разной очень прикольная проблемы с временными таблицами связано либо с тем что значит их не удаляли и поэтому ни на каплю их либо с тем что все все падал аварийной зачистка в конце не проходило и они там на самом деле веселье это называется осиротевшая временная таблица вот здесь ели и соответственно потихонечку вели нас к в рапа раунду вот или третий случай это когда люди работали с через connection pool через значит то ли позже bouncer целью что-то еще нас они создавали временные таблицы думали что пользовательской сессия короткая но здесь все между баузером и под весом было неожиданно длинной и сами понимаете к чему это привело временно таблица не исчезли значит существует некая такая сейчас вот идея сейчас обсуждается на потому что новый новый заход это глобальное временная таблица принципе такая штука есть стандарт sql как я недавно узнал это временная таблицы которая с точки зрения и дело они едины на всю зубы д но контент у каждого пользователя свой вот такой такое ну вот опять же с точки зрения подгрести 100 с детства это странная конструкция но они на самом деле есть andante школа не есть ворог ли и арык листы который мигрирует они тоже про них она иногда спрашивает ну вот сейчас константин книжник предпринял попытку еще раз эту штуку реализовать вот тем кому нужны такие временные таблицы тема просто часто пользуется временном таблицами кого устраивает что структура временные таблицы в разных сеансах будет одна и та же им вполне подходит такие глобальные глобально хороши тем что они не загаживают каталог то есть они в каталоге записано один раз на все сеансы которые их используют вот это очень здорово вот и еще одна тема с времени на таблице многие хотят их использовать на реплики а потому что думаю что ночь временная таблица передумали но поскольку она живет в том же традиционном пространстве пошел к тому могут быть rollback и все такое но извините ни на какой реплики она быть не может по этому тоже есть всякие идеи они очень трудно кстати глобальное времени с обрезая тоже сообщества принимать с трудом потому что она состоит из подгрести став с детства на самом деле вот в одиннадцатом году там даже раньше еще был несколько заходов с этими глобальными таблицами и и все достаточно неудачно вот нынешние корчится на решение тоже обозвали в рассылке к стенам но посмотрим что с этим дальше пойдет а вот значит по поводу надежности вот важнейшая вещь которая опять же сейчас в сообществе в этом году очень активно обсуждается здесь ссылки на труды и ссылка на реализацию фпг про значит инкрементальный backup то есть возможность не просто архивировать волыни просто делать полный backup а снимать копию всех блоков которые изменились начиная с предыдущего снятия полного или такого же инкрементальный backup а это нужно поскольку восстанавливает такой backup гораздо быстрее чем накатывать валы и потому что при хранении занимать меньше места полезная вещь значит пост про оно реализовано с помощью специального патче который называется patrick опубликованы в принципе вот и в сообществе идет активная дискуссия как это сделать сделать что наш по трек он работает хорошо но он достаточно не понимаю с точки зрения объема кода которые меняются и там люди думают как бы сделать то же с его более экономно с точки зрения кода вот и хотелось бы конечно вот часто спрашивают а почему ваш полюсе нет устроенного сам такого решения всяким бармены сам про бэкап и а вот valley и прочие инструменты сторонние мы должны выбирать между ними вот так очень часто говорят люди которые переходит к окна source нам или около послушным продуктом enterprise на и пользователи привыкли все видеть в одной корзинке нас была такая шутка кто такой бизнес пользователь ответа тот около windows вот но действительно изображена и пользуется ли придумали что все должно приходить в одной коробке вот мире open source это не так и с одной стороны им надо привыкать но они не привыкнут а это значит что полюсу приходится в эту сторону как-то двигается и рано или поздно должны появиться встроенное решение для a hail availability значит что-то опять же не сторонними средствами встроенная самп андрес вот соответственно встроенное решение для быка по для управления резервными копиями так далее значит очень жаждут от конкурса улучшение самодиагностики опять же что то из этого у нас сделано enterprise версии что это нет вот и более толерантное отношение к переполнения памяти и диска грубо говоря позже должен продолжать работать но как-то мягко деградировать при этом вращение администрирования то что должен быть там воздусях это графическое консоль для менеджмента все что есть сторонняя кого-нибудь да не устраивается и люди ждут и мечтают что встроенная встроенное какое-то встроенная консоль администрирования графическая красивый всех удовлетворить но наверное что-то такое будет вправду то что на всех удовлетворит вот это вряд ли это нельзя ожидать значит ожидают очень сильно ожидают от после сша вот функциональности похожий на раковый over вот запись снимков погас the state нас здесь это так выглядит вот и есть достаточно хороший такой вот модуль позже profile сторонний убил собственный модуль который позволяет такие снимки даже 100 остыть масса еще нескольких вьюшек такого же типа начать делать снимки и потом их рассматривать вот ну может усмотреть что здесь еще написано на фиг и автономности здесь наиболее на самом деле заслуживает внимание всего этого потому что ну вот я сказал да что там автоматический вакуум это такая вещь которая сделала под газ автономной базой самом начале но это конечно шутка потому что в реальности автономная база это база которая способна работать ступы могли нам или без обмена в возникновении всяких облаков и прочего подражает что обмена не будет вообще база должна сама что-то делать в том числе например создавать недостающий яндекс и даже сама не говоря уже измени каких-то конфигурационных параметров и поэтому такие вещи как например изменение на лету без рестарта всяких вещей как то например количество шарик буферов и других параметров которые сейчас не возможно изменить без рестарта потому что они приводят при аллокации каких-то структур в памяти который папа здесь просто не имеется не может изменить вот это требует серьезного изменения структуры шариф буферов над этим сейчас работает федор сигаев но работа сложная и поэтому идет не быстро значит тоже встроенная вещь которую хотят это пул коннекта встроенный то есть не пожелал на стороне a pool коннектов которые иметь больше ста и зачем позже боимся в котором можете пользоваться временными таблицами например там переменными может быть контекстами интерпретаторов языков в чем то еще но при палец запросами и так далее такой пол тоже есть наши enterprise данной версии но облегченный вариант этого пула мы сделали упал source на и вот здесь есть ссылочка на трек в котором он обсуждается вот нутру новая модель или там event гривен модель от скорее всего пока мечта для после но тем не менее уже мозги начинает шевелиться на этот счет вот еще и из важного того что постоянно хотят к сожалению после совы планировщик пока что остается zara claw пошла интеллектуальности но даже по просто своей способности убирать из планов запросов лишняя вот нужно над тем какая то работа идет но вот очень интересная вещь и это вещи связаны с применением машинного обучения для оценки селективности как минимум не может быть для подбора каких-то других параметров вот у нас есть модуль который со а к адаптивная адаптив сквере оптимизация на которых есть ссылочка вот можно посмотреть его попробовать он используется кстати в амазоне достаточно успешно колодочные хранилище но все об этом мечтают колонна хранилище разрабатывается сейчас фейки и вот посылочки можно про него прочитать есть шанс что в 13 версии она будет и соответственно и ускорение компрессия который от этого ожидается быть хорошая новость то что директ а его в полку если все же будет над этим работают вот андерс friends это делать можно почитать дальше по безопасности то что больше всего хотят сейчас это transparent дайте encryption такая вещь и и в принципе в подвиге есть две реализация сейчас уже для этого 1 сделала австрийская компания сайбер тек вторую мы вот но мы ее не никому не даем потому что у нас пока еще нет лицензии на разработку вот такого крипто софта вот и соответственно вот например такая штука как trigger на вагон очень часто спрашивают потому что опять же человек который родился и живет в пользу решим это непонятно для чего вот на самом деле люди хотят в зависимости от того откуда пользователь зашел в какое время выставлять ему разные права и это как раз удобно делать в триггере на вагон есть очень много требований который enterprise определяется к сообществу доказал что пользуйся да простить меня егор плохая документация вот потому что опять же люди которые развивались вместе с нею им она кажется комфортная людям которые переходят от других систем оказывается нет и тут нас это большой вызов к сообществу то есть нужно чтобы кто то писал больше пропускались вот пишите народ пишите это все нужно вот значит появилась наконец в программе профессиональной сертификации тут есть ссылочка можно посмотреть тоже кажется очень многие хотели такую программу на час в нескольких странах есть свои мы надеемся на то что разные компании которая их проводит там член наша и у французов своей сертификация сейчас азиаты тоже задумались за счет чтобы они как были как-то совместимы вот но это это сделать оказалось непросто но это тема отдельного доклада на самом деле он вот кто хочет про сертификацию узнать подробнее может просто ее пройти сразу все что интересно вот ну и конечно вот ужасно и ужасно спил списки рассылки которые плохо масштабируются которыми новичкам трудно работать но консервацию сообщества пока что не позволяет ни на что переходить ну и конечно название по адресу простите но вот значит вы говорить по загривку вел действительно тяжело и как сказал том лэйн главная ошибка и сообщества пользуешься было выбор этого ужасного названия если мы говорили по игре как продукт назывался изначально да еще и за девяносто пятого шестого года то было бы проще вот вот так вот вот но на хорошо все это или плохо чтобы столько как с проблем что к вызов на самом деле скорее хорошо потому что говорит о том что пациент пережив чем мертв он говорит о том что действительно есть мега пользователя с между запросами есть те у которых миллиарда загсы в сутки это значит что ip-адрес пригоден для этого вот и соответственно задача заключается в том чтобы сделать его просто более пригодным вот на самом деле в пол здесь есть вещи которые сделаны лучше чем в других собой да я уже сейчас например такого уровня гибкости такого количества разнообразных индекса в том что пространственных индексного поиск адреса на большое количество встроенных языков и в это взрыв сободы нет поэтому до геоданных по здесь уже давно является лучшей базой вот ну и вообще под довольно хорош и надо работать на нем дальше чтобы он становился еще лучшего чем мы занимаемся на самом деле в свои ряды тоже призывает вот в конце доклада хочу напомнить о том что будет такая конференция поддавайтесь на ее дедлайн на докладе стекать мин через месяц вот приходите ну и обращайтесь ко мне пожалуйста вопросы друзья думаете про вопросы знаешь я вспомнил у меня есть товарищ и oh baby в одной небольшой нефтегазовой компании больше всего он такой функциональный алкоголик он днем работает а вечером пьет и он любит ходить в крафтовый бар и и он там плачет под лагерь он плачет profil сканы puts out a он плачет вроде блоки а под ип он конечно плачет про хранение файлов в базе данных да и там было по моим 32 вида пиву когда мы встречались он хотел найти бар побольше потому что под каждый вид пива у него есть своя боль ну вот потому что в интерфазе вот так и использует базу данных если эти но это кстати может быть хорошей вот такой хороший канва для доклада который может сделать это я поговорю с ним поднимайте пожалуйста руки 1 2 вижу спасибо за обзор интересно меня вопрос в общем-то брюсу вам же на у которого нет поэтому по поводу энтерпрайза который поглощает по игре с разными кусками и как это должно или как это может поддержать целостность community то есть вот она сейчас еле держится того чтобы ваши почини принимать а тут появляются корпорации у которых свои интересы которые в любой момент захотят струнам but надо это мы сделали такую версию и наши клиенты будут пользователь ну смотрите на ситуация такая во-первых сообщество просто меняется она к этому как-то может адаптироваться под защищает то что у него нету такого со главного контрибьютором которые больше половины во всего дела и защищает то что юридически он никому не принадлежит то есть он не фактически не юридически не имеет центра и это на самом деле достаточно мощная защита и поскольку пока существует конкуренция вообще между крупными компаниями и она защищает пользуешься то что какая-то одна его может захватить на край microsoft и amazon там они будут драться друг с другом и будет жить если будет 1 одно мировое министерство идти но тогда по-видимому и пост грессов придется трудно вот но до этого далеко получилось так что есть компания чисто подрисовок который зарабатывает на пастбище но как как например мы enterprise д б а также второй квадрант о котором сейчас говорили сайбер т.к. который говорил чисто по две совы и компании каждый из которых имеет и камню не работали с комьюнити made pro версия в и то есть компания которая присоединились к разрешил лежит например microsoft вот amazon huawei и некоторые другие они все ведут себя по-разному и каждый каждая из них в коммьюнити что-то отдает но как правило немного и у каждого из них разный подход для амазона полюс это база на которой они строят свое личное сервисе для microsoft с одной стороны тоже с другой стороны они говорят так что у нас для enterprise них пользователей это сами знаете что а для тех кто попроще для тех бесплатно воздушный пузырь из просто хотим что он бы лучше и мы хотим чтобы наши пользователи тоже от нас получали в этот поезд вот то есть это немножко не такая ситуация как oracle приобрел mais que al пример для того же но ввиду того что под газ не имеет центра его невозможно при себя подмять они просто помогают своим пользователям пользуются microsoft он точно также как они помогать своим пользователям пользоваться линуксом вот но я не что-то действительно не что ты туда и сюда кантри бьют вот а есть такие ребята вроде huawei которые отдают сообщества гораздо меньше скажем так а alibaba тоже к этому классу относятся ну рано или поздно они будут даже они будут вынуждены по-видимому стать нормальной пути отдавать что-то сообщество просто для того потому что стоимость мер же она очень сильно растет женщина дефо и поэтому даже даже для них далекий отход от комьюнити версии станет неприемлемым я думаю этап вот у нас есть вопрос напротив и поднимайте руки я вижу руку привет у тебя был слайд вызовы и репликации а кто это я вот здесь говорю вот вот и в проблем у тебя была написана проблемы логические репликации например проблемы параллельного применения правильно я понимаю что в логической при логические репликации уже реализованы кроется параллельно и применение раз есть какие то проблемы и если так то тогда наверно можно сделать параллельный накатывала если парсить его то есть ответ такой что параллельно применение логические репликации в кабинете версии нет она есть наши multimaster мы мечтаем о том что оно попало попала в комьюнити версию но готовы патчи для комьюнити пастбища пока что нет до этого поэтому не в 13 уже версия это будет либо кто-то другой сделать но вряд ли потому что вы с каким темпом а сейчас развивается другими скорее 4 спасибо они следующий вопрос вот здесь слева от тебя у меня вопрос по поводу джейсона то есть в принципе postgres очень сильно рекламирует что он замечательно работать с джейсоном и вы неоднократно презентация про это упомянули у меня вот вопрос насколько вообще в реляционных базах с архитектурной точки зрения хорошо работы с джейсоном сказывается ли это на производительности как это сказывается и надо ли бояться джейсона или же это нормально но я скажу так с одной стороны бояться надо с другой страны это нормально надо просто боятся его и использовать грамотно то есть есть люди которые обрадовались джейсон нас только что бросили за суицида все поля включает первичный ключ внутри джейсона нам так можно то есть адрес и это стерпит просто это не будет очень эффективно постоянную часть держите в обычной запись в переменную джейсоне это не всегда адрес он полезен для компрессии там у вас мам он позволит вам хранить полиморфные данные 1 это блестит это очень хорошая вещь это что очень хорошая вещь показано объективным прибором начать счетчиком популярность ip-адреса когда появился джейсон б но это конечно корреляция может быть причиной связи не и когда появился джейсон б очень резко значит пошла расти популярность пастбища ваш народ начал использовать а там где раньше рисунки не подходили ну просто а сейчас вообще извините это часть стандарт sql 2016 поэтому все вопросы к описали это стандартная kraftwerk с тем чтобы догнать пользовались вот так что джейсон совсем не бесполезен хотя пользуется надо аккуратно и ко всем остальным ещё два вопроса мужски гадать один справа от тебя 20 спасибо за доклад сказали что под сгрыз достаточно хорошо защищен от захвата они являются ли это по вашему мнению тоже вызвал потому что вот если приходит как большая международная корпорация решила прийти в экосистему подраться ей нужны компетенции ей нужна поддержка естественно и куда крестьянину податься потому что достаточному компании которую с этим работают и они как-то разбросанные все но смотрите но это из конечно вызов несомненно и на самом деле выжил покажу как и любому по собственному продукту является даже облака потому что это совсем другая модель использования которое ты пользуешься но ты уже и продукт не скачиваешь lycan трибетить не должен вообще говоря вот и поэтому там вот манга по моему его лице или свое за этого это действительно большой вызов но с вызовом по поводу вот именно захвата для под газ пока что справляется лучше других пока но в любом случае это вызов не из той серии про который я рассказывал раз кого просить вызов со стороны крупных пользователей они со стороны значит все мировой буржуазии вот но конечно принципе это есть об этом еще как думают но посмотрим может быть на следующий год в мире будет единая а идти министр который всех нас заставят пользоваться я не знаю чем а зная не скажу отлично если вы улыбаетесь ассистентом вы можете задать вопрос у нас ещё два вопроса здравствуйте спасибо за доклад чуть ближе подбородку у меня такой вопрос по поводу упрощений администрирования вот извините по поводу чего упрощение администрировать слайда вот мало nsu модуль какие у нее перспективы развития значит спасибо перспектива нее хорошее потому что мы договорились забег сам о том что официальные моды для мониторинга за бикса будем делать мы его соответственно он будет конвертироваться с одной стороны забег сам с другой стороны вот так то что он умеет делать мама сути он и report вот это вот тоже будет само по себе развиваться дальше меня хорошие перспективы и последнего поэтому здравствуйте орлов михаил я вот как раз та же перешел на пост rose 40 и у нас возникла задача горизонтальное масштабирование рекурсивных запросов если мы сделаем репликации как бы рид онли отгрыз хорошо справится рекурсивных запросов они у вас такие и данный запрос редон не только пожалуйста никаких проблем проблема возникает если запрос исполняется долго тогда вы должны с этим бороться настройками всякими если долгие запрос на реплики поскольку реплика она совсем совсем рядом ли то в чистом виде мастер не знает о том какие версии записи еще нужны реплики и поэтому может через вал послать туда вакуум на зачистку или там вакуум может прислать нам нужны реплики они внезапно еще нужно какие-то блоки нужно версии записи они внезапно исчезнут и запрос не сможет исполнить это вероятно когда запрос длинной и за время в исполнения на мастере происходит какие транзакции которые меняют область видимости и из нее выходят для противодействия этому придумано несколько сразу настроечных параметров воздухе которые позволяют либо таких сообщать на мастер о том что что то реплика просит его не удалять либо как-то делать просто какие-то задержки чтобы они на реплики удалялись не сразу вот но все они работают сейчас не идеально они работали либо идеально на ней решает задачи абсолютно либо работают не идеально но если вы работали идеально задачу мы решили существует патча александр короткова которые эту задачу практически полностью решает вот но даже когда вот представь себе что это задача будет решена но за это придется чем-то платить придется платить ростом нагрузки на мастер из казалось бы вы исполняете запрос на реплики длинной а страдает мастер как такое может быть вот окажется может потому что мастер он не должен защищать те вещи которые еще нужны реплики это значит меня уровнем разбивается база растет bouncing так называемые потому что вы должны лишняя держа это сказывается на его производительность этом за все приходится платить и если вы хотите совсем не зависимо от мастера гонять длинные запросы на реплики тогда ваш выбор логическое replied если запрос они очень длинные берите физическую вот а дальше смотрите насколько уменьшает мастеру они начинаете делать их длиннее соответственно растет растет на мастерят этого через ход стандартен останки фидбэк в параметр восстанавливается начинает расти будут на мастере вы смотрите мешает ему или нет если нет то все хорошо если растет тогда вы либо ускоряете каким-то образом свои запросы вот или бы делается логическую реплику либо переносите в логическую репку делать отдельно логическую реплику для той таблице показана вас рекурсивные ну в общем в общем смотрите но можно много придумать вы сказали про чистку это означает что мы говорим про операцию дэвид именно или это просто есть мы говорим про вакуум и сам по себе делить нечего не уделяете мы просто без билетов это делали как бы хорошо просто хорошо вот и гараже давали вопроса что сделать это там делите но вот даты в проекте хороший собаководства не делайте делите кстати сегодня должен быть один доклад про делиться кажется николай самохвалов туда сходить вот но делить принципе безвреден вреден вакуум это вязание приходится отлично и вам спасибо огромное за доклад я думаю тебя уже огромное количество такая коллекция этих передачах мы правда что каждый раз ведь и вот ты ли ты любишь путешествовать вот такая штука можете пригодится бо силая да какой вопрос больше всего тебе ты знаешь мне кажется что и больше все вопросы хорошие были я долго думал кого выбрать пока вот не прозвучал последний вопрос потому что он прозвучал именно человека который заявился как целевая аудитория доклада который перешел с обыкновенной база данных на чудесно тогда ты учишь приз человек пожал вспомни как тебя звать рассказы где работаешь давайте пойдем в свет ребята там убежали от камер орлов михаил сбербанк да ну вот михаил на этой книжке написано быстрее вместе действительно так спасибо огромное"
}