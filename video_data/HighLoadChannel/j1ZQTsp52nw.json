{
  "video_id": "j1ZQTsp52nw",
  "channel": "HighLoadChannel",
  "title": "VK Звонки: все про звук, или Как добиться эталонного качества / Алексей Шпагин (ВКонтакте, VK)",
  "views": 370,
  "duration": 2623,
  "published": "2023-10-06T07:26:09-07:00",
  "text": "Здравствуйте коллеги Сегодня я расскажу вам как мы в ВК звонках работаем над качеством звука два слова про меня Я работаю во ВКонтакте руководителем команды проекта VK звонки в целом в средствах связи VIP телефонии Я около десяти лет начинал как разработчик c++ мы все время строили сервера которые обрабатывали медию то есть звук видео а-а и руковожу командами около четырёх лет несколько также слов про наш сервис который мы строим ВК звонки это средство для видеосвязи оно бесплатное для всех пользователей ВКонтакте можно созваниваться с друзьями знакомыми звонки один на один и групповые чаты в групповых чатах есть удобные инструменты для модерации звонка То есть можно использовать как для рабочих совещаний Там собеседований обучения чего-то ещё в общем возможность очень много И кстати говоря мы сами при работе Во ВКонтакте мы сами используем наши ВК звонки для рабочих совещаний собеседований и любых других встреч А ещё немного цифр э-э ВК звонки - Это примерно шесть миллионов звонков в день 15.000 звонков одновременно на пике в пик тайм а так о чем мы сегодня с вами поговорим первое Из чего складывается качество звука тут будет немножко может быть субъективно по моему мнению второе какими инструментами мы пользуемся для оценки качества звука 3 с какими проблемами в контексте звука мы сталкиваемся при разработке нашего сервиса и как мы их решаем И последнее посмотрим некоторые примеры применения вот той системы для оценки качества звука которая у нас есть поехали с первого пункта из чего же складывается качество звука при подготовке к докладу мне пришла в голову такая идея что Вот раньше в классическом так сказать варианте мы собирались все с вами в переговорных общались лично может быть в коридоре где-то на рабочих местах и так далее То есть это было личное общение естественно когда мы видим все лично то никаких особых преград для общения нет все всем хорошо всех видно слышно и так далее Всё хорошо вот но за последнее время мы достаточно плотно все мигрировали э-э в онлайн удалённая работа и для совещаний соответственно используется какие-либо средства для видеоконференции видеосвязи таким образом получилось что наше общение с эмигрировало из личного общения вот в онлайн и э-э мысль моя так сказать в том что вот э Если э система э видеосвязи нам особенно не мешает общаться и у нас есть такой можно сказать эффект присутствия то есть мы не чувствуем вот этой системы видеосвязи мы просто спокойно общаемся с людьми Ну очень похоже на то как мы это делали в жизни Вот Если это так то есть если эффект присутствия существует мы его ощущаем значит качество там система хорошая вот если система нам мешает то есть мы чувствуем систему что-то мешает что-то идёт не так и нету вот этого эффекта присутствия Ну значит качество системы недостаточно высокая а теперь Какие требования к звуку в системе для видеозвонков Я считаю нужным предъявить э-э и первое требование - это одно из самых важных Наверное это непрерывность звукового потока а-а То есть если звук э прерывается что-то случается со звуком на короткие промежутки или на длинные это уже не комфортно уже нет того эффекта присутствия про который я говорил выше значит звук должен быть непрерывный а второе а-а в жизни э-э скорость Ну скорость распространения звука в воздухе достаточно высокая Поэтому если мы с вами находимся рядом я что-то сказал Вы это услышали Ну практически мгновенно никакой задержки Ну такой который может услышать человек нет но если Между нами есть некая система а электронная и мы на разных концах так сказать её находимся у нас неизбежно есть некоторые задержка между тем как я что-то сказал а вы что-то услышали это задержка Ну на более такой углублённый терминологии называется лейтонсе вот э Это очень важный параметр если очень большая то есть несколько секунд например то это неприемлемо это делает общение в режиме диалога практически невозможно Пойдемте дальше А значит следующее требование это отсутствие артефактов в звуке то есть наша система не должна вносить каких-то дополнительных щелчков треска клиппинга не должно быть опять же для сохранения вот нашего эффекта присутствия и еще такой есть нюанс это частотный диапазон в принципе наверное на 2022 году это уже немножко Legacy история но тем не менее немножко расскажу Дело в том что в классической телефонии применялась э частота дискретизации 8 кгц это на слух э звучит не очень качественно не очень хорошо и конечно при работе на 8 кгц никакого эффекта присутствия которыми я говорил добиться нельзя э значит да напомню что весь частотный диапазон человеческого уха в среднем примерно 20 гц до 20 к и вот чем ближе мы бы были вот к этому слышимому диапазону тем было бы лучше и в принципе сейчас частота дискретизации в 48 килогерц она вполне Это позволяет конкретно там технология выбор тихи такую частоту дискретизации поддерживает И в частности Мы в VK звонках используем вот этот вот изображенный на картинке диапазон который называется Full Band то есть 48 кгц частота дискретизации в принципе в этом плане так сказать дискретизации У нас сейчас более-менее всё хорошо а подытожим немножко этот раздел значит э-э что должно быть в хорошей системе видеосвязи не должно быть прерывание звукового потока минимальная лейтонси отсутствие дополнительных шумов достаточно частотный диапазон а Пойдемте дальше придем непосредственно к измерению качества звука Значит нужно сделать некоторую оговорку Я до этого употреблял термин качество звука но нужно сказать что мы сфокусируемся сейчас только на качестве речи разборчивости речи то есть звук в общем смысле там допустим качество звука записи или еще что-то нас сегодня не интересует мы об этом не будем говорить мы поговорим только о качестве именно голоса разборчивости голоса вот в системе для аудио или видеосвязи а значит мы используем оценку так называемый мост минапинен Score для оценки качества звука Это Метрика от одного до пяти где соответственно единица минимальное качество пятерка максимальное качество хочу обратить Ваше внимание на третий столбец это помимо того просто как характеристика качества Ну там какая-то цифра какие-то звёздочки значит это э Хмм характеристика как человек воспринимает и сколько усилий человеку требуется для восприятия того или иного фрагмента речи Ну соответственно картинки показано что там допустим на качество максимальное требуется Меньше времени как бы сил и энергии так сказать на расшифровку того что сказано при минимальном качестве Хмм очень много усилий требуется следующая оговорка мост равный 5 практически недостижим То есть это как КПД сто процентов да теоретически Да но практически с их всегда будет наверное немножко меньше вот в нашем случае Почему недостижим мост равный 5 потому что у нас как минимум существует аудио кодеки а те аудиокодеки которые мы используем которые есть в артисте на данный момент Они все сжимаются потери данных соответственно взяли хороший какой-то фрагмент закодировали декодировали и уже потеряли в качестве То есть даже можно никуда не не передавать его через интернет просто достаточно сделать перекодирование уже будет немножко меньше Пойдёмте дальше Какие конкретно методики алгоритмы измерения качества речи мы используем опять небольшая оговорка значит вот этот минапиненкоп в таком по классике в классическом варианте он основывается на опросе людей то есть людей спрашивают по вот этой вот пятибалльной шкале от одного до пяти Как вы оцениваете там тот или иной фрагмент Значит мы естественно заставлять никаких живых людей так сказать что-то оценивать не будем у нас вкалывают роботы а не человек то есть у нас будут алгоритмы автоматизированной работать вот и они работают они пытаются предсказать чтобы сказал живой человек услышав тот или иной фрагмент речи это вот такая идея работа этих алгоритмов и дальше следующий момент есть алгоритмы которые работают на основе референса как это устроено Значит некоторые референсный сигнал как правило достаточно высокое качество подаётся в звонок значит там проходит те самые процедуры кодирования докодирования которые мы э рассмотрели только что проходит передача через интернет что естественно там тоже искажает Как наш сигнал и в итоге из звонка у нас получается искажённый сигнал А и дальше и референс и искажённый сигнал оба они поддаются горитм оценке соответственно алгоритм оценки фактически сравнивает нам референс с искажённым сигналом и выдает некую оценку мозг и второй вариант работы это без референсной метрики Значит все примерно то же самое только на алгоритм оценки не подается референсный сигнал Вот то есть работа только с искажённым сигналом и Метрика пытается оценить именно вот качество нашего искажённого сигнала конкретно какие метрики мы используем мы во ВКонтакте сейчас используем референс люмиметрикул и без референсную метрику низко собственно Мы специально комбинируем эти два подхода Ну Для большей так сказать объективности оценки Вот какие еще есть метрики но мы пока ими по тем или иным причинам не пользуемся это полку а или на жаргоне полка Вот это наверное сейчас такой стандарт де-факто для оценки качества звука вот в системах в частности на Вебер тихи основанных и подобных вот Аква это некоторые аналог полку а он так позиционируется но на наших тестах он показал что он э в каких-то моментах на каких-то кейсах ведёт себя немножко хуже чем полку А поэтому мы на данном этапе ему не так доверяем как полку и мы на него смотрим скорее как на возможное решение в перспективе А ну в активной как бы разработке А и песка упомяну его это такой легальности упомяну его просто так сказать ради Хмм того что он очень сильно применяется широко применяется в ip-телефонии но к сожалению там возможно только работа 8 на 16 килогерцах часто дискретизации А как мы рассматривали до этого нам этого Маловато сейчас Как устроен наш стенд для измерения качества звука Значит все достаточно просто слева нарисован человечек это собственно пользователь который хочет имеется ввиду не пользователь ВКонтакте А разработчик допустим lique инженер который хочет сделать измерение качества звука значит этот человечек он запускает жопу в тимсити этим Сити дёргает э неких ботов или тестовых клиентов в Облаке Значит и она дёргает двух ботов первый бот делает звонок второй бот этот звонок принимает значит звонок проходит э через э собственно наш сервис ВК звонки значит и первый бот который делал звонок он начинает проигрывать референсный файл этот референсный файл соответственно проходит через наш сервис там претерпевает какие-то искажения значит через интернет проходит и э-э тот второй бот который принимал звонок он записывает то что он слышит в условную виртуальную трубку Что это значит и то что он записал это соответственно искаженный для нас сигнал вот затем соответственно референс и искажённый сигнал подаются на алгоритм оценки сами утилиты крутятся в том же облаке где тестовые клиенты соответственно из этого облака вылезает Метрика мост она попадает в тимсити где довольные так сказать наш человечек Он наблюдает собственно результат измерение именно вот в терминах мост важный момент что вот синеньким нарисована облачко интернет а это действительно честный интернет То есть тестовые клиенты то есть этот стенд он такой пролайк то есть тестовые клиенты отделены от сервиса интернетом то есть это так же как вот если люди сидят дома и созваниваются также здесь Да здесь боты в Облаке но это не так сильно на что-то влияет Главное что они не не в этом же дата-центре грубо говоря они не по локальным там ip-адресам ходят в сервис Вот то есть там честный интернет и все связанные с этим проблемой а Итак коротко проведем подведем итог по этому разделу Значит первое мы измеряем именно качество голоса и речи не музыки мы используем метрику Мосс от 1 до 5 мост никогда не бывает равен 5 всегда немножко меньше скорее всего Значит мы используем метрики на основе предсказания реакции живого человека на звуковой фрагмент и существует референсные метрики без референсные мы используем оба варианта Итак наверное самый такой интересный раздел э-э это какие же проблемы бывают передачей звука через интернет И как мы их решаем сделать ещё одно уточнение значит проблемы Я бы разделил которые с которыми сталкиваемся на две большие группы это проблемы связанные с особенностью передачи данных через интернет и второе - это проблема акустического характера рассмотрим первую категорию То есть это проблема обусловлены особенностями передачи данных через Интернет значит вы наверное все примерно представляете Как передаются данные они передаются пакетиками а Конкретно звук передается чаще всего там есть нюансы но чаще всего мы Передаем и звук и видео по udp значит и делается так звук мы получаем с микрофона пользователя нарезаем его на небольшие кусочки как правило 20 МС но это не не в граните не выбито могут быть разные фрагменты просто как некий дефолт можно считать 20 секунд значит эти 20 МС звука пакетизируются и отправляются в виде dp-пакета э соответственно вот на картинке представлена как некоторые передатчик передаёт пакеты P1 p2p3 по четыре и так далее А значит Обратите внимание что передатчик передаёт Всё ровно и хорошо э то есть расстояние между пакетами одинаковые и всё прекрасно значит дальше э нарисован интернет То есть такая Вышка это символизирует Интернет значит и вот из интернета к приёмнику пакеты идут уже не так гладко как нам бы хотелось значит что с пакетами может происходить первое пакеты могут теряться вот на схеме пакет номер четыре как бы э-э по маркам как потерянный значит пакеты могут дрожать Что это значит Это значит что они могут отстоять друг от друга на разное расстояние и вот например вот пакеты P1 и P2 практически слиплись друг с другом P3 от них отстоит на какой-то одно расстояние по пять ещё за счёт потерянного п4 отстоит ещё на какой-то третье расстояние значит пакеты могут задерживаться и пакеты могут меняться местами это показано на схеме пакета P12 переставлены местами сначала пришёл пакет номер два Значит надо сделать уточнение что если мы используем например мобильный Интернет то все вот эти проблемы у нас усиливаются вот если мы используем там хороший wi-fi они снижаются если мы работаем по проводу они снижаются еще сильнее вот поэтому качество связи может зависеть не может даже оно зависит напрямую вот от типа выбранного соединения а-а Пойдёмте дальше значит что мы что мы делаем э чтобы эти проблемы как-то скомпенсировать первое самое базовая Вещь это да это не какой-то ноу-хау это просто Must have без этого ничего работать хорошо не будет это джипер баффер э значит для чего он нужен джипер баффер грубо говоря накапливает некоторые количество вот этих пакетиков А и таким образом э компенсирует и дрожание и может подождать какое-то пакет если он задерживается переставился местами с какими-то другим пакетом и так далее значит э-э с вот он выравни трафик и компенсирует нам дрожание значит но есть нюанс Значит есть у нас будет слишком большой jetter баффер у нас вырастет Лейтон То есть если мы будем слишком много накапливать у нас вырастет задержка Поэтому мы вынуждены держать некоторый баланс между размером джиттербафера и лейтонсе Пойдемте дальше Вот это уже вещь такая менее стандартная в отличие от джиттербафера так называемый нак негативно леджмент значит что это такое мы наверное все привыкли с вами к Акам окно лоджитам То есть когда какие-то данные э пришли и мы их за окном лежали что да мы эти данные увидели Итак на каждый пакетик значит в одну сторону пакета в другую окно ложемент Вот она - это такой э запрос который посылается когда мы не досчитались какого-то пакета и вот на схеме это продемонстрировано То есть у нас от передатчика идут пакетики P1 p2p3 Rust там p4 потерялся значит но мы на при и чувствуем Что по 4 потерялся только когда нам пришел следующий пакет то есть p5 в данном случае на схеме вот как только нам пришел p5 и мы соответственно увидели дырку То есть у нас P3 есть по 4 Нет по есть значит И в этот момент мы посылаем нак негатив окно legement и передатчик принимает наш нак понимает что мы хотим от него ретрансмита четвёртого пакета и он делает этот повтор повторно отсылает четвёртый пакет значит всё прекрасно в целом Но это схема будет хорошо работать только на коротких РТТ Потому что если то есть э у нас ведь как нам всё надо доставить этот знак передатчик должен его принять и только потом он ретранснить нам по четыре соответственно как показано на схеме p4 придёт когда-то потом вот то есть между ретрансмитом по четыре ещё пройдёт там P6 p7 p8 и только потом по четыре придёт Вот и в каких-то ситуациях это может быть нам А мы уже Мы нерелевантно то есть мы можем уже не дождаться этого по 4 у нас Лейтон 17 держать короткий мы не можем вечно ждать этот пакет по 4 То есть он в какой-то момент станет просто не нужен вот поэтому этот Хорошая идея но работает она в основном на хорошо на коротких rtt Пойдемте дальше так называемый эффект Forward Error correction значит что это такое Это такая технология Когда в Bit Stream кодек добавляет некую некую дополнительную информацию которая позволяет нам э предокодировании э компенсировать пропавший пакет А И вот здесь на этом слайде есть интересная вещь Это вот табличка с измерениями Дело в том что когда мы внедряли эту фичу мы сделали измерение соответственно до внедрения и После включения фичи значит эксперимент был такой сделали пакет лосс 5% чек выключили сделали измерения получили некоторую цифру Значит потом второй эксперимент условия те же сете и пакет loss 5 процентов но включили фиг значит получили цифру больше соответственно мы получили цифру больше сказали что это хорошо и вывели эту фичу на Production Пойдемте дальше редандансе так называемый Red а говорит что мы говорим про Audio Red сейчас только значит Это что такое Это чем-то похоже на фек но не стоит их путать значит реданс То есть они работают на разных уровнях эффект на уровне энкодера значит а-а Ред на уровне rtp дублирование данных происходит на другом уровне э-э и также когда мы эту фичу э-э внедряли Мы провели эксперимент значит первый эксперимент взяли пакет Lost 10% дел и 200 миллисекунд сделали насчёт фича выключено Рэд выключен сделали замер получили цифру а значит второй эксперимент э те же самые условия пакет-лосс 10% дел и 200 миллисекунд включили в фичу получили цифру Причем так достаточно прилично больше сказали что это хорошо вывели на продакшн значит и последнее вот из этих инструментов так называемый plc пакет Lost confilment значит вот когда уже с точки зрения сети сделать уже ничего нельзя то есть у нас уже окончательно образовалась дырка в пакетах и сделать мы с этим ничего не можем то получается что у нас будет в звуке будет дырка будет разрыв есть алгоритмы которые позволяют как бы достроить вот эту волновую форму прямо показано пунктирной линии на схеме то есть алгоритм как бы придумывает А какой кусок звука там мог бы быть придумывает он его на основании предыдущего то есть на основании некой истории как вот как шла волновая форма и алгоритм пытается как бы её так спрогнозировать и на основе предыдущего повторить А если таких э пропаж таких дырок мало то мы даже не очень не очень услышим это plc Но если э пакет loss очень большой таких дырок будет много то plc слышно А проявляется оно видя такого металлического голоса при- при призвука металлического голоса вот в целом не очень на слух Конечно когда много значит следующий раздел это проблема акустического характера Какие они бывают значит Прежде всего это внешний шумы э это тран То есть если вы допустим в транспорте совершаете звонок в офисе народ рядом разговаривает автомобиль разговор из автомобиля тоже там добавляет шумов это наш любимый человек-сосед который кто сверлом просверлит то пилой попилит э это улица Если вы идёте по улице звук улице э в общем вот такие сложные бывают условия при э-э звонке а при работе например на удалёнке и звонке с какого-то необычного места а значит что мы делаем э с этими шумами мы пытаемся их подавить и оставить только полезный сигнал полезный голос И вот например Значит у нас для шумоподавления используется в частности наш свой шумодав основанный на машине и конечно же Мы проверяли его работоспособность какие эксперименты мы сделали первое Значит мы взяли хороший качественный референс без шумов прогнали через нашу систему также получили некоторую цифру потом мы подмешали в этот референс ещё шум конкретно в этом эксперименте Это был лай собаки причём по громкости Он был сопоставим с полезным сигналом то есть Ну достаточно Навязчиво А и мы прогнали через нашу систему вот эту смесь референса и шума без шумоподавления и мы получили мост равные примерно единицы то есть а это если вспомнить табличку изначально доклада - это самые низкий уровень это очень плохо то есть это уже практически неразборчиво и третий эксперимент Э мы э взяли референс шум и прогнали через нашу систему но с включённым шумоподавлением и получили цифру вот 279 это конечно по абсолютному значению 2,79 может быть это не идеально Но это качественно выше чем а работа без встава то есть мы пользователю дали качественно другой уровень то есть мы из неразборчивого сигнала сделали ему разборчивый сигнал Вот это достаточно важно И вот таким образом мы работаем буквально пару слов еще Про некоторые фичи это как бы сейчас будет наоборот такой немножко антипатерн который значит заключается в том что мы решили обновить версию нашего войск Activity detation она у нас в каком-то виде была имплементирована но захотелось улучшить какие-то показатели Мы имплементировали также на базе машин лёнинга войск Activity detection Обновили модель А и конечно же стали проверять А что даёт нам эта модель с точки зрения качества звука и э мы сделали эксперимент соответственно с выключенной новой фичей с включенной новой и получили результат немножко хуже и тут мы так сказать дали это и фиче- красный свет и сказали что нам нужно доработать ещё что-то посмотреть Да обучить модель и мы вот эту версию на продакшн не пустили а примерно такая же ситуация с другой фичей так называемый snr немножко объясню что это такое дело в том что шумоподавление оно как правило помимо того что отрезает шум оно немножко ухудшает и качество исходного сигнала даже если там не шума То есть может немножко подрезать полезные сигналы соответственно Если у человека сидит в каком-то помещении где и так тихо и Шума нет то включение для него шумодава может быть избыточным и даже может не очень хорошо сказаться на В итоге Хмм качестве звука Поэтому если у человека Шума нет то логично что не надо ему включать шумодав и вот это фича если онар она призвана к тому чтобы оценить э соотношение сигнал шум а и э понять Надо ли человек включать для этого пользователя шумоподавления или не надо Вот соответственно мы её включили Она работает совместно С предыдущей свечой бой с активиться dection э ну это уже такие частности не будем глубоко сейчас погружаться значит Ну мы включили значит сделали измерение и тоже нам измерение дают результат что стало немножко хуже и мы тоже дали этой фиче пока красный свет будем дорабатывать смотреть до обучать модель Вот и надеюсь что следующий эксперимент будет более удачный вот следующая проблема это акустическая эхо в двух словах объясню в чем проблема значит если польза сейчас внимание на пользователя номер один значит пользователь номер один сидит динамиками Вот это означает что всё что ему говорят в звонок естественно попадает на его динамики А дальше оно попадает в микрофон дальше сигнал от динамиков претерпевает переотражение в комнате и также попадает в микрофон ну и Кроме того и сам человек что-то говорит таким образом в микрофон попадает смесь из сигнала из динамиков отражённого сигнала и того что человек говорит а если не применять каких-то специальных средств то вот вся эта смесь она попадёт в звонок и вот например пользователь номер он будет слышать себя через вот этого пользователя номер один повторюсь если не применять каких-то средств Значит мы боремся соответственно с Эхо используем Эхо подавление мы делаем в основном две вещи на данный момент Значит мы используем Эхо подавление от выбор тихи стандартная плюс у нас есть такая фишка мы когда пользователь номер один С предыдущей картинки начинает что-то говорить то мы его динамик немножко приглушаем А что это даёт это даёт то что уменьшается громкость соответственно попадание сигнала в микрофон и переотражение также немножко уменьшаются Ну по крайней мере их громкость они могут затухнуть Э не дойти до микрофона или дойти с очень слабой амплитудой а-а соответственно вот такие вот такой лайфхак значит но в целом вот проблема дабл толка она для Эхо Да был тонкая это когда два человека пытаются поговорить одновременно они с динамиками сидят вот это проблема она на самом деле в таком в мировом масштабе актуально и Для нас это тоже пока некоторые Челлендж мы с этим работаем Итак коротко по итог по вот этому разделу Значит мы боремся с сетевыми проблемами с помощью jetter-буфера plc на леджмента фека и Реда ридандонти значит с проблемами с акустическими с шумом мы боремся шумоподавлением вадам и сенаром и с Эхо боремся соответственно с помощью Эхо подавления значит коротко Какие еще применяя как мы применяем эти инструменты которые у нас есть Это можно сказать как такой итог к докладу значит вот как мы применяем инструменты Значит мы можем на девелоперском окружении проверять вот с помощью того стенда про который я рассказывал Да ближе к началу мы можем на самом деле натравить его и на лабораторное окружение и на Stage на Production В общем как ко всем нашим окружениям э Хмм на всех окружениях мы можем померить качество звука соответственно при разработке какой-то фичи мы можем на девелоперском окружении померить а качество звука и делать выводы о работе этой фичи и вот про те фичи которые рассказывал в adsnr мы вот так и делали значит можем на регрессивном окружении э-э перед релизом соответственно в рамках регрессионного тестирования прогнать измерение на качество звука и сделать вывод есть у нас регрессия относительно предыдущего релиза или всё хорошо качество не упало как минимум но может быть возросло значит можем сравнить Две версии продукта То есть у нас есть либо разные окружения Либо мы можем перед диплоить версию на одном окружении соответственно можем сравнить то есть не обязательно С предыдущей можем с какой-то сравнить назад на несколько версий Например если есть подозрение на деградацию именно начиная с какого-то релиза Кроме того мы оцениваем эффект от новой фичи на продакшене в том числе то есть мы можем с помощью фичу флагов включать и выключать какую-то фичу э-э и делать измерения и делать вывод тоже помогает нам это сейчас или нет делается на качество звука выше и последнее мы мониторим Production об этом У меня есть отдельный слайд небольшой значит это прямо настоящий график живой прямо то что вот мы наблюдаем э-э фактически такой мониторинг то есть раз в полчаса запускаются те самые два тестовых клиента про которые рассказывал один другому звонит происходит оценка качества звука и вот раз в полчаса мы получаем соответственно метрику на этом все все что я хотел вам рассказать Пожалуйста не забудьте оценить доклад по ссылке По qr-коду и Большое спасибо ваши вопросы Спасибо большое это прекрасно отдельное спасибо всем кто в интернете Пишите в чате так вопрос раз два поехали здравствуйте Спасибо за прекрасный доклад хотел бы спросить по поводу сетевых протоколов и почему нельзя использовать когда раскладываем ряд ну вряд ли Лора спектральной чистоты нести пакеты которые более плохого качества 8 гц отдельно еще герцовый но восьми герцовые дублировать и мы получим высокий низкочастотный по несущие гарантированную доставку но при этом улучшение качества звука за счет высокочастотных поднесущих то есть пакетизировать не по таймингу о по Спектру сигнала это теоретические политизированные речь более проще будет передать Ну то есть вы предлагаете если сеть плохая давать Пускай более плохое качество например да э-э Ну хотя бы что-то доставить пользователю Так я уж место придумки именно это низкочастотные под несущие то есть не такое большое качество ровно это делается с видео на самом деле но там не про частоты там про разрешение картинки вот со звуком так не делаем по ряду причин на самом деле вот кодеки которые кодируют 8 кгц они по битрейту на самом деле не меньше чем кодек опус например который мы не получим принципиально выигрыша в битрейте я вот так так коротко могу сказать спасибо Вот Будешь собрать следующий Здравствуйте подскажите пожалуйста у вас во время звонка может происходить смена кодеков в зависимости там От качества связи и если она происходит то как вы это тестируете на практике сейчас видеозвонках мы используем только кодек Opus 1 значит но технология в целом и в VIP телефоне смена кодека это нормальная штатная процедура если вы с DP согласовано несколько кодеков можно использовать любой более того для видео у нас на самом деле такое есть они иногда могут меняться прямо в процессе звонка главное согласовать список заранее и согласовал список заранее мы будем готовы к этой смене технически если чуть-чуть погрузиться в детали каждый Стрим идёт со своим сссрси то есть айдишником и мы их можем отличить вот у нас пошёл Стрим допустим с новым idшником значит новый кодек и мы должны быть то есть мы к этому готовы да это штатная ситуация в принципе А в какой ситуации есть необходимость менять когда а это хороший вопрос Ну например вот кстати то что предлагалось допустим почему-то это немножко искусственный пример Но если хочется сменить частоту например вот у нас был опус на 40-8 килогерцах на самом деле опус может закодировать меньше Ну вот что-то вот нам Да вот допустим Ультра лоуби Трейд например там 729 кодек такой в телефоне есть например вон там 10 КБ битрейт у него вот если мы Нам очень нужно зарезать битрейт и мы хотим перейти на вот такой лоу битрейд-кодок Например можно да в принципе это сделать на практике мы этого не делаем Это теория сейчас ну это когда кричит А мы его теряем да И в этот момент шестидесяти четырёх килобит прыгнуть на 10 кбит э-э битрейты допустим теоретически можно операторов сотовой связи Да вот пожалуйста Спасибо большое доклад у меня такой вопрос вот в методиках оценки есть ли что-то для интерактивных сценариев Вот например я часто перебиваю говорю поверх человека и интерактивно это работает в принципе потому что и я привыкший человек меня слышит и я его слышу А видеоконференц сейчас Бывает такое что я начинаю говорить поверх и всё то есть вот эффект присутствия теряется полностью вот есть ли способ как-то Вот это автоматически тестировать тоже э-э мы вот пока мы так не делаем мы хотим научиться это пока для нас Челлендж Вот то есть мы в рамках борьбы с Эхо подавлением э Хмм будем да что-то придумывать как вот перебивание нам э участия пока пока более простая У нас вот на основе референс и просто звук меряем Спасибо микрофон да Будь здоров Спасибо за доклад интересный Я здесь У меня вопрос по ботам которые получается выдают метрику Мосс Да есть какие-то формальные критерии для вот этих уровень 1 2 3 4 5 или это просто установленный опытным путем показателя скорее второе потому что это мин опенинг скормин то есть мы мнение да то есть какая-то субъективная оценка и Ну какая аналогия применяется у меня это было на слайде что качество вот когда самая высшее качество пятёрка то не требуется усилий от слушателя не требуется усилий Чтобы понимать что говорят то есть разборчивые встречи такая что усилий не требуется из понижением качества Это количество усилий возрастает и при оценке единица мы говорим что у нас качество высшее В смысле степень усилий выше возможного то есть не разобрать Вот примерно так но это конечно субъективно и численных точных метрик здесь нет Спасибо за доклад супер вопрос а два первый делал ли вы какое-то микширование звука на сервере Когда в замке больше двух участников Как мерить и качество Можно ли там еще что-то померить и второе мониторить ли вы уровень счастья живых людей или только роботов и можно ли вообще как-то мониторить живых людей мы микшируем на северной стороне звук да то есть когда больше двух участников значит по поводу роботов значит живых людей мы меряем звездочками то есть они голосуют В конце звонка там выпадает что Оцените качество это правда не про звук только То есть это общая счастье пользователя в контексте звонка соответственно есть звездочка Вот Но в живом звонке только Ну то есть только ушами можно послушать то есть мы меряем Production Но конечно Production меряется с помощью роботов то есть роботы созванивается Спасибо Спасибо будьте добры Да вот у меня вопрос Смотри не про групповые чаты сейчас а про один на один звонки 20 лет назад появились обычные звонилки люди друг другу звонили не жаловалась на качество все слышали друг друга нормально никаких тебе никакого эмаля никаких процессоров на телефоне вообще ничего сложного А тут у нас Интернет Тут куча всяких технологий и все равно не слышно и все равно пакеты теряются и все равно непонятно в чем принципиальная разница И принципиально такое отличие между обычными звонилками и не ВК звонками А вообще такими технологиями Ну наверное первое огромное отличие что раньше нужен был специальный аппарат который назывался там телефон а если речь про компьютер то скорее всего это там должна быть обязательно гарнитура там Наушники что-то еще соответственно сейчас это любой девайс любые динамики собственно основные проблемы которые пришли связаны в частности с использованием внешних динамиков То есть когда я могу себе позволить гром связь кстати говоря громкая связь традиционно раньше всегда работала Ну так не очень то есть ну можно было воспользоваться Ну как-то так вот сейчас это уже реалии обычные что человек на митинге сидит с динамиками говорит в ноутбук и не В микрофончик а вот просто как бы разговаривает с компьютером и всё без специального микрофона дорогого какого-то и так далее Вот то есть мне кажется Развитие происходит в этом э в частности э Хмм наверное так ну и плюс артисти ещё нюанс такой выбор тихий работает в браузере вот и не нужно даже специальная программное обеспечение Ну точнее оно нужно но в рамках Вот именно это веб-приложения может быть вот а раньше это обязательно стороннее по Ну какое-то пролетарный звоннику поставить там что-то ещё А сейчас в браузере ссылку кинул на собеседование например Это очень удобно кандидат не хочется ставить какой-то сторонние по Может он не придёт всё работать в компанию Да а кандидату просто пролетает ссылка он открывает её в браузере участвует в собеседование не понравилось закрыл браузер и всё Ну там за телефон платить надо за GSM Например если это как-то так говорить Да нужна сотовая вот эта связь чтобы она была а так проводом воткнул и не надо сотовой связи То есть тут такое сказать Скорее Может это может быть продуктовый даже больше вопрос технически Я согласен что решение Да наверное Вот ещё какая мысль что всегда устройство которое ddcate Да на что-то оно скорее всего работает Ну лучше чем универсальные устройства Да компьютер и звонки Вот такие через браузер Там они более универсальны соответственно они да у них есть нюансы они могут работать немножко хуже чем ddc Ну устройство специально для этого а через станцию с марусей можно звонить звонить У вас или нет Еще пока нет я думаю что мы с интегрируемся уже можно ВКонтакте можно позвонить я застал первые звонки Когда покупаешь карточку пластиковую там вот такой вот номер такой вот айдишник звонишь кому-нибудь забугор ниже Привет Привет Леша Привет Лёша и дальше все смешивается смешивается смешивается круто было Я помню это такое время через Skype кстати иногда до сих пор так будьте добры Вы же хотели вопрос задать Я хотел спросить про роботов собственного первых На каких данных вы их обучаете во вторых как вы сравниваете качество что робот соответствует человеку на самом деле И как вы проводите до обучения этих роботов чтобы они больше соответствовали реальным людям Ну про роботов это немножко нас исказилось сейчас информация на самом деле подробно мы понимаем просто Бота который совершает звонок но он проигрывает вафку проигрывает вайфайл который записан заранее Ну записан он уже человеком то есть там ну реальная человеческая речь Значит мы используем мужской голос женский голос некоторые сэмплы их там ещё по несколько раз проигрываем но Для большей объективности э данных и соответственно сравнивается на выходе фактически в утилиту Ну например вискал подаются два файла это исходный файл записанным человеческим голосом э значит и то что прошло Через звонок И вот оно сравнивается такое принцип сейчас я может просто до них совсем правильно понял то есть оно оценивается алгоритмически есть какой-то алгоритм который сравнивает качество я думаю там просто машинная обученная машинное обучение которое регистрировала как бы реакции человека Да говорю Это хорошо Это плохо и потом она таким же образом пытается оценивать данные или у вас просто есть алгоритм вот эти вот техники просто физически алгоритмы это алгоритмы да то есть это А ну вот алгоритмы часть из них аналитическая Но вот низко Например Она иная Вот Но она заранее обучена То есть она не на нашем референсе обучается Она обычно заранее как бы понимает что плохо Что хорошо кому вручим приз за лучший вопрос мне понравился наиболее наверное такой технологический глубокий вопрос про частоты Когда было предложение вот кажется вот откуда-то оттуда предложение разбить по частотам передавать по-разному Вот это хотя это немножко Нет ну мы на практике делаем не так но как бы это очень хорошее предложение более того в другой области в видео примерно так и делает очень круто можно поаплодировать прямо даже да Супер Алексей тебе тоже памятные призы участия Спасибо очередное"
}