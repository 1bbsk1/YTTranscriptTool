{
  "video_id": "phB2nygfkMw",
  "channel": "HighLoadChannel",
  "title": "Паксос в картинках / Константин Осипов (ScyllaDB)",
  "views": 3170,
  "duration": 2787,
  "published": "2021-10-04T02:44:45-07:00",
  "text": "всем привет сейчас на своим clicker так это стандартная как прикольно это только я вижу ряби ли вы так но я не знаю надо ли знакомиться я скажу кратко что я когда первый раз студентам прочитал про paxus я наконец-то сам понял вот первое знакомство с баксов made simple было лет 5 назад когда я попробовал перевести на русский язык официального русского перевода так не было хотя мой перевод потерялся вот это было но я перевел но молчу понял вот так случилось что мне довелось реализовать paxus мне нравится собственная х можно как-то убрать я слышу собственная эхо вот так лучше нет вот так так немножко лучше вот и так случилось что я у меня получилось реализовать pax с и ну там столкнуться с некоторыми вопросами тасеево понял еще раз вот а в качестве работы в программном комитете я постоянно видел заявки про то что давайте мы вам расскажем что такое paxus и все эти заявки rejects потому что но я понимал что рассказать это невозможно до 3 лет десять понимал что это такое и вот сейчас будет моя неудачная попытка но хотя бы можете в меня к помидорам и кидать можем считать что я воспользовался служебным положением программном комитете для того чтобы а значит вылезти на сцену и начать его обещать про patsies почему это вообще тема такая интересная я забегаю вперед и вот например такой слайд приготовил что показ на самом деле уже нигде не используется но его продолжает все обсуждать то есть вот первое для того чтобы как-то осознать истории вопроса все очень многие вещи начинается там в 1078 году там есть фундаментальная пейпер за которой собственно выстрелом port of the алгоритма получил тьюринга word вот он там получил кучу а вардов и сеем тюринг вот но один из фундаментальных фундаментальных работ это было вот time club and ordering systems она 1978 году 8 сторон в первый раз формулируется там проблема дала генералов это проблема принять решение в распределенной системе там в девяностом году выходит достаточно длинный документ который называется part-time парламент то есть парламент в котором люди частично отсутствуют примерно как назад вот и потом этого оказывается недостаточно через 10 лет выходит документ пакса смотреть simple который вообще не делают paxus simple потом выходит документ pack has made moderately комплекс который объясняет более-менее как это все завести вот ну и в двадцатом году люди там не успокаиваются и решают что у нас там надо делать принят еще пока с реализации ну вот я считаю что все равно разбираться в этом придется потому что по сути но сейчас везде повсеместно используется ровд вот и для того чтобы понять первую фазу роста нужно разобраться с факсом вот поэтому мы и с этого начнем и как бы я по смоделировать для вас задачу не по-прежнему еще не нравится ехо это не устраним ада в этом зале значит я попробую сформулировать задачу вот этот то на самом деле это я частично в своей презентации использовал текста из paxus made simple чтобы могли прочитать и как-то представить ее в голове вот вот ну вот задача значит у нас есть какое-то множество участников они должны принять решения не они должны какой ты принять решение при этом вот это должно быть одно решение для всего множества да если решение принято на мы должны все узнать вот у кого какая картина рисуется в этой ситуации да мы рисуем вся картина наверное каких-то акторов каких-то людей которые видят друг другу которые как-то другом общается и принимают решения но нет вот это вот эта картинка символизирует множество участников как его видел лесли lampard и мы сейчас будем как бы в грозятся в то что что я пытаюсь здесь сказатель что как я пытаюсь это интерпретировать может быть вам легче будет понять paxus если вы будет принимать модель в которой он функционирует значит множество участников это ни люди ни программой это некие ректоры которые наделены достаточно с но минимальным то есть задача если было создать алгоритм с минимальными требованиями да то есть они он решал теоретическую задачу какой такие минимальные требования к этому множество мы можем предъявлять для того чтобы они могли принять это решение то есть изначально вот я нарисовал какие-то молекулы может быть бактерии до которые по сути не имеют там ни мозгов не памяти ничего вообще да и общаться между собой тоже не могут и грубо говоря они находятся в какой в каком-то какой-то с жидкой среде рук ног у них нет они плывут с течением значит переговариваться они не могут глаз у них нет вот и как бы ну в общем все не работает значит и единственное что они могут сделать это там сгенерировать какой там значит может быть какой то не нуклеотид какую-то такую молекулу послать ее и надеяться что она когда-нибудь придет вот то есть вот будем предполагать что вот эти вот корешочки это то что эти молекулы генерирует при этом может так случиться что пока там идет это сообщение с неизвестной скоростью 1 одному из участников наступит кирдык может так случиться что вот здесь есть указка что вот это значит молекула она потеряется вообще да то есть она не дойдет до адресата потому что она посреди свободному пути вот и у них стоит некая задача вот опять же задача принятия решения вот если бы допустим представить ее решение неким дискретным образом допустим мы говорим следующее решение что там они им нужно как-то совместно охотиться и если они вместе начнут охота то у них там допустим они увеличить свои шансы на результатами ну грубо говоря это решение это оповестить всех что-то мол и да да вот и да они высылают сообщение о том что любая молекулу которая первый увидел эту и дурно высылается все что огайо да и значит они вместе охотиться увеличит шансы но нет нет это не просто такое тривиальное решение да нет они должны условно говоря это что мы будем как бы изучать согласится от свете еды и да то есть если они не должны информировать друг друга есть это не просто как бы да не отрешение от решения с каким-то значением да то есть они должны договориться от свете вот и именно вот в таком в такой модели мы попробуем как бы рассказать как работает алгоритм вот если вернуться вот этой картинке тут тоже она очень интересно вот lan порт web access мы 7 полон как бы дает следующий тезис значит одна из целей этого протокола которому мы как бы пытаемся прийти это то что если у нас нет никаких проблем дата все-таки он должен завершаться успешно даже если как бы ну там есть всего лишь один про pauzern а то есть вот переведя переводя это на картинкой из-за картинок молекула вот это вот ссоре значит вот эта молекула у нас обнаружила еду она должна иметь возможность послать сообщения или несколько до этой молекуле и они мы видим что если они приняли решения то они обе окрашивается в цвет еды да то есть они начали охота красный свет и да то есть в чем идея протокол для того чтобы у него есть такой property ну как была мина сюда для того чтобы он был живой даже если есть только одна одно решение которое необходимо принять он должен это решение принимать и опять же замечу вот ну и как бы что из этого следует властелин нам говорит что из этого следует что тот кому при прилетает сообщение о том что пришла и да он как бы должен это сообщение принять он не может ну сомневаться дать то есть вот вот вот перевод на русский язык того что написано так со смальцем причем еще одна вещь да то есть решение о котором идет речь а на одно если вы заметите на мои картинки молекулы изначально не окрашены а потом они окрашены всегда когда то есть они не перекрашивается в новый цвет то что перекрашен до принятия множество решений тоже мультипак сэс проему может быть даже не успеем поговорить значит вот такая простая задача и давайте попробуем ее решить самостоятельно да без значит каких-то алгоритмов там структуры данных и так далее вот первое следствие которые и есть которая идет из того что акцепторы должны принимать решения даже если они вот как не знают даже если они даже если такое решение только одно до 1 привет 1 по ваши и совершения стоит в том что вот если представим себе да алгоритм тривиальным значит один из участников он заметил эту еду до то есть переводя на язык алгоритмов к нему пришел клиент и попросил какое-то значение зафиксировать он об этом значении сигнализирует другому участнику параллельно происходит конкурентной ситуации да то есть они обмениваются решение то есть они опять же не принимали бы не приходят консенсусу они не принимают общего решения они просто окрашиваются в противоположные цвета то есть у нас есть некая фундаментальная противореча как тут между тем чтобы мы приняли первое попавшееся решение и тем чтобы мы пришли к консенсусу окей думаю мы да и как бы как эту проблему решают люди и вот почему вообще изначально пайпер назывался парламент да почему он назывался почему вообще речь шла по греческое какой-то история если вы почитайте про сам пайпер part-time парламента там вообще рассказывается про то что он изначально там был алгоритм назывался синод то есть это были какие-то независимые заседателей кстати следы вся эта история не сохранились в том как работают автокефальная ортодоксальная православная церковь то есть то там тоже нет как бы единой точки принятия решения но вот так как привыкли люди значит принимать решение они выбирают самую жирную свое с кого-то из своих дата чтобы она была царем вот и как бы верят решением только они но тут уже сразу есть нарушается предположение которое которых нет в алгоритме да то есть во первых мы предполагаем что мы можем оперативно но вот знать что происходит в этой к системе а мы не мы этого не может даже если молекулы какие то они знают заранее друг другу да они должны знать заранее даже если они договорились заранее кто из них является лидером то в случае если этот лидер погибает они как бы допустим какая то другая молекула вторая по размеру решит его тоже стать царем и рассказывать всем про этого какие-то решения вот этот паренек да он как бы такой неуверенный в себе возможно как бы ему достаются на работе самые плохие задачи вот и он уже не знает на того как бы ориентироваться потому что он ещё не знает что тот вот царь до бывший желтый он как бы погиб то есть вот эта информация она в системе не распространяется мгновенно глаз у молекул нет то есть он не знает доверять и этой то есть вот первый недостаток этой системы что мы это мы если мы выбираем единого лидера постоянного то система перестает совершать прогресс вот из этого следуют как бы система мы как бы говорим друг другу ага а что если мы снова договоримся иначе дамы папа давайте попробуем сделать так давайте ночью у нас обычно ночью течение допустим ну представьте себе что эти молекулы эволюционируют или как угодно каким-то образом они пришли к этому алгоритму неважно но вот у нас ночью течение значит слева направо поэтому ночью или нет днем вот здесь картинка день за днём мы слушаем все сообщения которые там приходят нам слева до тех лидеров которые но вот у кругу ряд тех участников кластера да как уж мы будем обозначать что они там это неважно можно как каким-то образом мы про это допустим знаем а ночью мы будем поступать наоборот ночью мы будем всегда доверять значит тем участникам что находится справа да то есть давайте договоримся никому принципе которым которым бы мы придерживались и опять же вот мы пришли к некому алгоритму совместного принятия решения который к тому же еще и достаточно высоко доступен да то есть если здесь у меня нарисованы дверь две бактерии если да то как бы там этих бактерий много одна из бактерий погибает все равно принцип продолжает работать и мы все вместе можем выходить на совместный уход но нет и причина по которой это опять же не работает в модели в которой работает система который работает алгоритм состоит в том что время во всей этой системе она вообще никак не не дискредитируется то есть мы вообще не можем отличить день ото дня мы не можем отличить одну минуту от одного часа сообщение может идти 1 секунда может идти там вечность условно говоря да то есть концепция времени и она очень растянуты здесь мы приходим опять же к модели которые как-то с которой начинал lampard 78-ом году т.е. для того чтобы понимать почему алгоритм работает именно так нужно понимать ну прочитать его фундаментального фундаментальную значит работу пра пра векторные время да то есть и вот он исходил из того что в распределенной системе время никак не дискредитируется ok значит это тоже не работает и из этого следует некая то есть некая попытка перенести подход с вот этим вот заранее договорено порядком в некие в содержимое самих сообщений которыми обмениваются обмениваться злой то есть фундаментальная идея алгоритма она такая вот мы не можем заранее о чем-то договориться давайте сделаем явно сделаем какие-то переговоры о том чтобы договориться кто принимают решения вот это если пакса совсем одним из одной слова одной фразы как пописывать то вот это основная идея с учетом недоступности никаких заранее определенных договоренностей нам нужно все значит атрибуты протоколы вместить либо в сами сообщения либо в сообщении и состоянии участников то есть я сейчас более подробно про это говорю опять же пойдемте последовательно давайте каким-то образом приоритет да кому мы верим значит за шатром в сообщении но условно говоря давайте будем считать то кто первый встал того и тапки кто первый нам прислал сообщение тому мы верим значит и каким-то образом сообщение пронумеруем да ну значит вот мы я здесь пронумеровал сообщение тривиальным образом у нас есть зеленое сообщение которые выпускаются молекулы слева и желтый сообщение так указка она немножко тормозит и желтые сообщения которые выпускаются молекулы справа здесь значит молекулы значит справа она не увидела ответ на свое первое сообщение она прошла мимо поэтому на выпускают второе вот и идея такая да давайте сделаем так и мы будем сообщать всей экосистеме о вот этом цвете о решение которое мы хотим принять если мы получим от большинство ответов а такой системы то мы будем считать что там допустим решение принято это же тоже не работает потому что в первую очередь невозможно становится отличить значит сообщения которые создали мы от сообщения которые создал кто-то другой то есть общение должны быть чуть сложнее и появляется следующее усложнение которое нам оказывается абсолютно необходимо или идея как раз в том что вот если будет чесать работу lan порт последовательно обосновывает необходимость усложнений вот я также пытаюсь обосновать необходимость осложнений и следующие усложнение которое нам как оказывается логически абсолютно необходимы это то что у сообщений должны быть которые эти идентификаторы это вкусно значит индикаторы узлов да то есть узел должен понимать кто я у него должна быть идентичность и сообщение подписывают нет каской да значит и сообщение подписывается идентичностью этого зла то есть у нас появляется как бы такие раунды и в каждом раунде каждое сообщение подписывается помимо того что номером раунда еще номером узла который это сообщение выпустил если у нас есть такая история то у нас еще если вас появляется понятие раундов то у нас еще должны привет появится какая-то память молекуле собственно в каком раунде она находится вот здесь я такие изобрел такую эволюцию молекулы видим мозгов вот у нее одна лапка она превращается в мозг и значит в этом в этом в этой памяти значит у нас хранится то сообщение собственно которое данная молекул данный момент принялась номер раунда номером да и как бы вот этот номер own и сложный он называется лом портобелло то он идентифицируется значит вот этим вот 2 композитным 2 композитным ключом собственно число которое означает номер раунда и участник этого смотрите если у нас есть такая история то мы можем все сообщения подвергнуть глобальные сортировки у нас сообщение 2 а больше чем сообщение 1б как в практическом плане мы это делаем мы генерируем ее айди допустим каждому узлу то есть каждый номер каждый узел инфицируется уникальным идентификатором и каждое сообщение подписывается в том числе идентификатором узла едет для первой части мы обычно используем в реализации значит часы которые мы можем добиться того чтобы эти часы были монотонны на этому злой возле да то есть у нас нет глобально монотонных часов но мы можем добиться глобальной монотонности всех сообщений за то что счет того что мы используем обычные системные часы убеждаемся что они монотонны значит если происходит перевод стрелок там связи с time zone amis липси концы так далее мы эти переводы стрелок пропускаем и просто монотонно увеличивается счётчик вот и каким образом мы добились глобального родины теперь возвращаясь к этой идее что мы не можем принять решение мгновенно мы должны сначала принять договориться о том как бы кому мы доверяем в принятии решения и значит наше сообщение вы видите что они они насыщаются они у них появляется какая-то вот да еще дополнительный смысл во первых сообщение объема обязана включить собственно о чем мы договариваемся да то есть это мы договоримся о том кто принимает решение либо мы договоримся уже от свете о значении вот и мы должны сообщение в сообщениях понимать собственно откуда они и куда да то есть мы должны сообщения указывать адрес от а потому что иначе ну вот как бы мы можем перепутать перепутать сообщение которое мы сами себе и так далее переключить ответы с нашими собственными сообщениями так далее значит теперь я скажу как бы по шагам как это все начинают работать то есть первый шаг да еще один момент значит с учетом того что у нас появляется эта память lan порт явно говорит о том что раз у ваших ваших участников процесса появляются состоянии алгоритм предполагает что это состояние сохраняется между рестарта my то есть вы обязаны обеспечить persistent ность этого состояния что является нюансам на на нашем оборудовании мы должны сохранить его на диске любое изменение этого состояния пересыпи чистить это и так далее и я видел ни одну реализацию которая на самом деле этому не следует в частности кассандра она как бы утверждает что у нас есть pax с вот но по умолчанию значит изменение состояния pax с они не сохраняются на диск при этом утверждается что это почти всегда работает нет это почти всегда не работает значит рассказов вот про все эти водные можно как бы уже дать общую структуру алгоритмы первый шаг мы вот у нас нужно принять некое решение мы выпускаем сообщение которое определенным образом и на девице ruim да со своим идентификатора модификатором сообщения в котором предлагаем всему кластеру разрешить нам принять решение это называется препар фаза вот здесь я уже демонстрирует что мы дальше дожидаемся ответа от кластер она то что это окей окей если ты будешь сейчас предлагать решения что происходит если мы не дожидаемся это ответа мы увеличиваем мы ждем какое-то время увеличиваем счетчик и пробуем снова либо в этот момент приходит к нам сообщение и тогда мы уже этого не делаем да то есть мы уже опять же ждем следующей фазы нам на на определенном каком-то интервале и вот но уже мы уходим из-за первой фазы принятия решения с первой фазе принять решение мы пытаемся стать лидером окей на второй фазе принять решение мы дожидаемся majority ответов от всего кластера о том что ok если мы станем какие вы станете лидером соответственно это запоминаем состояние и уже наше состояние как бы говорит о том что мы перешли в фазу 2 значит фазе 2 мы собственно пытаемся кластер убедить что нужно выбрать определенное решение то есть данном случае желтый цвет и мы выпускаем сообщение фазы 2 мы его также подписываем этим самым богатым да то есть этим самым идентификаторам и уже в нем содержится то решение то значение которое мы предлагаем кластеру принять правила fall over a который получает сообщение фазы 2 она состоит следующем если мне пришло сообщение с номером болото который больше чем тот балок который я запомнил да ну давайте для простоты который равен не больше или равен a равен тому болту которая запомнил то я отвечаю на это окей и здесь на самом деле вылезать очень занятный прикол то есть как бы какая последовательность на первой фазе мы всем говорим номер болты 2 а на второй фазе для болта 2 принимаем решение желтый так примерно все представляете что работает этот протокол да то есть на первой фазе и договориться номере болта на второй фазе как бы использовать этот номер бал это как условно говоря электронную подпись того решение которое мы всем продвигаем но нет это работает не так значит вот значит нам в тот момент когда нам отвечает но до b что это окей я принимаю решение мы уже можем его окончательно принять да то есть это еще следующих следующий по идее фаза лёрн когда мы всем рассказываем что до решение принято но фактически если вот значит мы разберем это немножко по шагам то у нас решение принимается не в фазе лёрн решение принимается в тот момент когда мы вот здесь вот есть такая штрих пунктирная линия просто штрих с 3-х ваная меня которое говорит о том что решение принимается где-то внутри второй фазы то есть тот момент когда majority в кластере нам отвечают ok мы даже не все еще участники a majority мы ещё даже не знаем что они нам ответили окей да в этот момент принимается решение то есть опять же некий ключ к пониманию алгоритма состоит том что нужно представить себе всех участников никак распределенную систему а как одну общую систему как единый конечный автомат состоящий из множества под автоматов и когда вот этот конечный автомат переходит в некое промежуточное состояние говорящий о том что majority приняла это решение тогда решение принимать почему именно так представим себе что мы допустим отправили сообщение из второй фазы фазы акцепт и не получили ни одного ответа давайте посмотрим в каком состоянии застрянет plaster вот примерно в таком да то есть кластер кластер в этот момент допустим от смотрите это сообщение потерялась аноды прибывает вот в таком состоянии каком из этого состояния выйти то о чем то есть предложить другой цвет они уже не могут потому что они уже зафиксировались на цвете они уже перешли в состоянии цвета поэтому любая по следующая попытка закончить протокол оно состоит в том что мы продолжаем акцепт фазу то есть мы не начинаем если мы не получили majority например фазу мы продолжаем акцепт вазы и в этом также состоит обязанность каждого участника этой истории теперь представим следующую ситуацию что допустим здесь было был третий узел давайте я перейду на картинку где есть три узла вот у меня есть три реплики r1 r2 и r3 и предположим что нам для того чтобы принять большинством голосов решения достаточно двух узлов мы получили коммуникацию от узлов r1 и r2 и застряли в фазе акцепт оуза от узла r3 мы коммуникацию не получили потом r3 такой приходит и говорит а я хочу зеленый да и в этот момент значит то о чем должен то то как что предписывает нам делать протокол состоит том что r3 должен поменять свой цвет он должен поменять свое решение на желтый и довести предыдущую фазу до конца вот соответственно если этого не произойдёт то и как бы есть гарантия давайте-давайте игрок почему он может поменять есть гарантии что он может это сделать потому что он должен дождаться ответа от маджоре ти участников если он дожидается ответ от маджоре тито кто-то в этом маджоре те обладает информация о том что цвета на самом деле должен быть желтый и он об этом узнает вот за счет этого это называется принцип кворум interception пересечении кворумов то есть за счет того что все решения принимаются большинством даже в случае аварии потери сообщений выхода из строя вот это вот инициатора до инициаторы раунда так tab и того кто победил в раунде мы всё равно рано или поздно сделаем прогресс и придем к этому решению но вот приход к решению работает за счет переключения нового акцепт нового про позе рано другой цвет вот в общем вот так такой момент примерно press так так так а примерно структуру протокола теперь давайте поговорим про то собственно почему этот протокол так важен почему он значит имеет вообще почему мы столько доверие так далее значит наверное если говорить о других протоколов принятия решения в распределенной системе тапок счас это не единственный протокол я сейчас не назову фамилией индусов которые собственно являются авторами альтернативы подсосать шагу тундра что-то такое там их двое вот но причина по которой факса собственно настолько популярен состоит в том что если не остановился на том что он предложил протокол он предложил способ этот протокол доказать формально и собственно формальным доказательством формально директориях верификации занимались много где в том числе в советском союзе но конкретно лесли lan порт предложил язык формальной верификации и формальных доказательств который показал что этот эта процедура она действительно достигает результата она действительно сходится у нее нет ошибок и в любом как бы каком то конечно если конечно числе участников она примет решение то есть property life нас исаев ти до то есть она была обладает этими профиль вот при этом если говорить алой власть то есть определенное ограничение date мы говорили о том что что происходит если сообщение теряется если сообщение теряется то участник должен подождать какое-то время попробовать снова и вот это вот ожидании она конечно замедляет принятие решения и теоретически мы можем оказаться в ситуации когда все участники одновременно пробует снова да то есть они рассылают сообщения фаза 1 получают значит не получают достаточного большого количества ответов пробуют снова снова не получает достаточно большого количества ответов и так далее и для того чтобы решить эту проблему в значит алгоритме предлагается рандомизированы время ожидания каждого участника опять же эта рандомизация на больших числах ведет себя не очень хорошо если у вас 500 участников и вас интервал ожидания в случае ошибки 10 секунд то обязательно даже через десять даже если вы как бы случайно выбираете время ожидания вас будет конфликтом что вас просто участников много да то есть вот нужно здесь очень аккуратно подбирать реальные цифры то есть лайв нас у протокола она вот таким ограничено тем не менее есть формальное доказательство есть формально верификации протоколы и именно из-за этого этот протокол настолько как бы на такой получил распространение а теперь как бы но он такая мякотка вот значит несмотря на то что протокол 20 лет это выступление 2019 года в питере вам порт приезжал рассказывал про протокол про тела и plaza и вот он как бы такой куда что на самом деле никто до сих пор не понимает как его реализовывать значит я действительно я посмотрел то есть как когда занимался этим всем я посмотрел собственно началось все это вот этого забавного треде к на stackoverflow который говорит что в питере есть contradiction и значит я посмотрел несколько реализаций и действительно некоторые реализации не следует то есть там есть три пайпера и делай пласт и как бы если следовать пакса смоет simple или портами парламента вы как бы реализуется протокол неправильно если вы исследуете целый пласт то есть формальной спецификации то да вы реализуете протокол правильно и есть нет множества несколько реализаций которые не читали тела и plaza в чем тут фишка значит помните мы говорили про то что вот на этой фазе на фазе акцепт мы принимаем это решение от множество участников если у нас вот этого если мы запомнили что мы ответили ok на фазу припер деле это не так мы отвечаем кей нет не только если мы ответили ok на фазе при п р но если просто болотова акцепте будет больше чем тот балл от который мы сохранили то есть следуя принципу кворум interception мы не требуем от алгоритма чтобы множество пропал зеров совпадало с множеством акцепторов то есть для акпп repair фазы должно быть может быть одно majority а для акцепт фазы может быть уже другой маджоре теперь на двух нотах это не видно но если у вас 5 нот то у вас у вас 5 not a b c d e да у вас акт pp-r фазу может быть но многие а bc а акцепт фазы могут быть надо cd и и это с точки зрения алгоритма абсолютно корректно но очень важно что на акцепт фазе участники также обновляют свое состояние систем пролетает баллад который больше чем их балок на цепь фазе а не обновляют свой балл от тогда это будет работать и вот некоторые реализации а не доделают акцепт они не требуют кора mentors action вернее они да они не требуют того же самого кворума не делают акцент для большего болта но не обновляет свой посыл остаться повод вот прям от реальной баба в реальной реализации вот поэтому конечно лэсли душка и если говорить вообще о том что стоит с точки зрения реализации в этом протоколе да то есть что вообще осталась за скобки если вы решите реализовать протокол самостоятельно то примерно 90 процентов все что я сейчас рассказал касается одного раунда принятия одного решения у этой системы нет этим твой с помощью пакса хотите реализовать допустим какой-то реплицирует мною субд э то вам нужно ответить еще на очень много вопросов на один очень большой вопрос это как вы будете удалять данные потому что протокол вообще не рассчитан на то что данные когда-либо удаляются и допустим во многих реализациях удаления сделано с помощью такой-то матери конкретно для того чтобы удалить данные на место в виде решения кладется маркер удаления tombstone там я не знаю что вот значит и этот маркер удаления удаляется уже там через какое-то время через две недели мы считаем что две недели это типа ok за две недели если ничего не не подчинилась так как бы можно удалить маркер далее то есть реально при таком не предназначен для как бы для жизни вот собственно возвращать то почему как бы люди используют рации современно помимо этого мультипак счас это я просто кратко пройдусь по пунктам что к мультипак это принятие решения после уже принятого решения то есть как мы завершаем предыдущий раунд для того чтобы начать следующий да каким образом именно мы должны сделать так называем призору показ repair и да как мы можем восстановить частично застрявших застрявшие состоянием протокола в мультипак сиси множество реализаций использует paxus для записи но не используют pax east для чтения что не дает лайнера и забил эти то есть если вы там посмотрите на какой из гипера кажется что у него для чтения там не paxus например вот что тоже приводит к определенным аномалии дальше мы никак не говорили как мы собираем кластер с нуля то есть протокол предполагаю что вы размер кластера фиксированы вы каким-то образом про идентифицировал злы а чаще всего как бы сегодня с cabernet и сами со всеми делами мы как бы просто берем и накидываем с нуля какую конфигурацию и протокол ничего не говорить потом как из ничего сделать что-то он предполагает что какая-то конфигурация уже есть как добавлять и удалять узлы из участников как добавлять выдает новых участников значит как обрабатывать ошибки на клиенте потому что опять же если мы хотим семантики экз акт ли vans то нам нужно в том числе делать так чтобы клиент мог завершать не низок не операции состояние которых ему неизвестны допустим вы послали в транзакционный систему свою задачу она завершилась успешно ответ во мне пришел вы в состоянии неизвестности этого об этом протокол ничего не говорить об этом было если говорит в одной из своих вейперов немножко но как бы тем не менее это все и формально не описано но и если говорить о предложениях то вот посмотрите сколько разных видов paxus а также было предложено улучшение они то есть целое семейство как бы люди не могут остановиться поэтому это все очень занятно но практического смысла не имеет вот на мой взгляд хотя хайди ховард например да ведущих там таких вот час адвокатов пока саана читает иначе вот на этом у меня все в общем то пожалуйста ваш вопрос константин спасибо за доклад лично меня такой небольшой оффтоп порадует момент когда мы бы начали 10 изобретать потом в того стоило мало они начали изобретатель писек давайте два вопроса попробуем задать да да вы там был вопрос у вас был вопрос да нет да нет не стесняйся поднимайте руку а я только что видел науки до эти надела большое спасибо за доклад быстренько погуглил на запрос а вот xp and access выдается 300 тысяч результатов так что вы хороший компания вы приняли хайди ховард она как раз приезжала тогда же вместе с если наги дракон в россию вот и она там рассказывал про свою работу в который предложила в общем немножко другой как сказать не механизм для объяснения такой генерализованный способ представлять алгоритмы класс алгоритмов куда входит fxs и вот мне честно говоря и экстракции помогла понять процесс больше вот вы так не считаете что она лучше ну это вот просто невозможно войти выступить но нет мне именно значит я не знаю мне больше всего пожалуй по ним по я смог понять paxus исходя из того что и не было вас не столько понять как его реализовать понимаете мне было важно понять почему он такой почему собственно что написано вообще в пайпера чем думал автор когда предлагал то есть вот этот контекст он сегодня полностью потеряны привыкли рассуждать о значит протоколе исключительно в том как его понять и применить там для реализации репликации данных мне было важно понять почему если не предложил другого протокола да почему вообще направлении пошла в эту сторону движение пошло вода сторону так понятие пасе большая да вот что используется в цилиндры paxus или ровд и почему если это ford кассандра в просмотре pax на значит для lightweight tranzaxis которые повторяют полностью фичу кассандры используется pax с мультипак сос реализация похожий на реализацию кассандры но с отличиями что проект можно там я про это отдельно расскажу для управления топологии кластера используется ровд но не только ровд используется значит помимо то есть управление топологии кластера и управление схемой данных вот то есть это все сейчас разработки но идея в том конкретно если говорить о том что нужно делать вот значит tarantul и то нужно нужно вытаскивать ровд тарантул ровд либо в шар нужно уходить они делят на и creations все короче используется раздела ну стоит чтобы умыкнуть году отлично но не такой неправильно хорошо ой спасибо за доклад вопрос следующее я не совсем понял из каких фас состоит каждая бегать договор о следующем значение то есть получается чтобы на каждой фазе шоу драме лидера да да каждый для каждого значения да ты уже не то начинаешь думать о мультипак соси да вот мультипак счас как бы предполагать несколько значений вообще весь протокол про одно значение возможно говорить об одном значения каждая строка таблица до которому реплицируется на у нас должна проходить через когда мы говорим о строке таблицы мы уже предполагаем что строку таблицы можно изменить многократно весь протокол не предполагает многократного изменения многократное изменение она сверху нахлобучен она этот протокол и там появляется помимо собственно ну там тут мы по-прежнему продолжаем использует баллад и до болот и продолжают расти монотонно но в контексте 1 1 фазы 1 изменения нас два раунда припер раунд и акцепт раунд возьму возможен опциональный лёрн раунд если есть learn or и в принципе в системе но вот мы проходим через припер акция припер акция при кб акцепт для каждого значения есть какие-то оптимизации об активизации множество fast access кворум лизис и так далее да то есть которые превращают протокол в ровд оптимизации процесса превращают pax асуров на мой взгляд да вот и по-прежнему не отвечают на те вопросы которые ровд отвечает ну для дебилов для меня да то есть как управлять конфигурацией самое сложное на самом деле это для чего до сих пор нет формальной верификации например не в pax осени где тут бы ещё не в рафти это как добавлять новых участников в кластер и удалять участник из костра в рафти для этого предложен алгоритм который называется joint консенсус алгоритм стерин из views там трипле кации барбар рисков то есть это оригинально не из равта но преимущество рафта в том что он что это синергия нескольких протоколов который отвечает на все вопросы грубо говорят делайте так вот спасибо вопрос спасибо захват вопрос звучит следующим образом если авт отвечает на все вопросы для дебилов зачем использовать по sms давайте вернемся к этой картинке да то есть вот зачем я же не говорю что нужно использовать его нужно понимать потому что для того чтобы но фактически сейчас вот посмотрите фактически практике большинство использовать уже сегодня ровд причем самая взрослая реализация она вот сиди и это же реализация используется в как роуч значит если мы посмотрим на юга байт этой дебита там интересным образом переписан online buy line то что написано в cd в кошки вот то есть но не line поймай но очень близко до то есть вот в мозга тебе а то что они называют raw там на самом деле raw там является с очень большой натяжкой ну кого я здесь не упомянул вообще is fun days to die by я не упомянула там свой алгоритм ее дверь ему нет да да в кадке значит в той кафки которая правильная кафка под названием как называется red panda там ровд в неправильной кафки там вообще не пойми что я сейчас делать наверное pax east драфт да тоже тоже ровд да пожалуйста вопрос давайте еще один вопрос константин спасибо за доклад скажите если в цели у нас для этого транзак шанс используется pax с как собственный в кассандре для поддержания схема используется ровд насколько знаю с 43 по моему по имени обращение за ревизора плечами ни разу не раза нет нашего почему выбор был сделан именно на такой конфигурации почему не перешли на ровд полностью потому что значит невозможно было сохранить совместимость с кассандрой то есть там совместимость на уровне проблем вот она должна быть два быть сохранена то семантика очень многих операций она должна была быть screen а если бы это был просто ровд то того чтобы понять как как бы как это работает в кассандре нужно осознать что у кассандры очень интересный sharding у нее sharding сделан по вот этим вот токен реджис то есть начало ключ хэшируется от hash hash укладывается в диапазоны и определенные диапазоны они распределяются между узлами и значит вот это вот значение хэша на который называется таким и является субъектом протоколу то есть для одного токина работает мультипак счас давай для одного токена ровд группу очень накладно то есть может получиться что допустим в системе ну легко 100 миллионов токенов например да и сто миль ровд он гораздо более прожорлив в плане состояния чем баксов за то есть уровни дербейс протокол и состоянии лидера нужно хранить в оперативной памяти обычно при этом это состояние может не обновляться до очень долгое время да то есть вот какие то токины они соответствуют каким то холодным данным и мы при этом должны для них держать в памяти состоянии протокола консенсуса мы должны ровд опять же на самом деле но если говорить о каких-то проблемах raw туров на мой взгляд две фундаментальные проблемы первое это то что он не порадует предоставляет формальных доказательств для основного в своего как бы добавление к тому что вы же так было известно индустрии он добавил протоколу изменение конфигурации и целый пласт для изменений конфигурации отсутствует никто его не делает и так далее а вторая проблема это то что ровд рассчитана на малое число групп ровд из коробки поэтому raw нужно интегрировать с failure detection of который не было не имел бы такого большого вверх и да и то есть если взять ровд из коробки и у вас там 100 миллионов инстансов ровд а то все эти 100 миллионов начинает посылать 10 раз в секунду если прям вот по покеру его реализовывать в 10 раз секунду начинает посылать пинге друг другу то есть у вас там как бы происходит взрыв просто hard бит информации в сети поэтому вот по этим причинам он не совсем то есть поэтому и ровд в цели используются только для топологии на данный момент и для схемы данных вот потому что топология это и схема данных эта информация единое для всего кластер а то есть это одна группа спасибо"
}