{
  "video_id": "_iLOrHs96XI",
  "channel": "HighLoadChannel",
  "title": "Собираем GPS-треки от водителей в такси раз в секунду, экономя трафик / Андрей Минкин (MadDevs)",
  "views": 1995,
  "duration": 2611,
  "published": "2017-04-22T14:48:12-07:00",
  "text": "меня зовут минкин андрей и в докладе своим я хочу поговорить о том как мы вообще пришли к тому то что нам треки нужно собирать в один раз в секунду зачем мы это делаем зачем нам экономить трафик и в принципе обо всем по порядку сейчас я и буду рассказывать при этом кто я такой сейчас и на протяжении последних пяти лет я работал в команде модель занимаюсь сейчас должности меледа и мы делали за последнее время следующих два проекта у нас в бишкеке при этом нам бы такси является рынка лидером по на рынке по таксе а нам бы food соответственно по доставке еды в общем у меня порядка 10 лет опыта и он у меня всякий разум связан сайте и системное администрирование и разработка на бетоне год плюс к этому есть несколько проектов open source of которых я применял принимаю участие первый это меж борт который позволяет строить распределенную виртуальную сеть о нем на pusser трибуне сегодня рассказывалось и 1 это гиа кадр для данных openstreetmap сам я с бишкека с и по сути маленький город по сравнению с москвой москвой в нем порядка одного миллиона жителей и на этот один миллион больше ста службы такси при этом нам бы такси сейчас порядка последних четырех лет находится на рынке такси у нее не менее восьми тысяч заказов в сутки водителей достигают до больше 600 на линии одновременно подключенных и за все время работы обслужили мы порядка 500 тысяч клиентов что по сути является половиной нашего города при этом сама по себе такси в нашем случае это клиенты которые делают заказы любым для себя удобным способом либо это они могут отправить с слева позвоните либо заказать через приложение плюс у нас есть и 5 для вызова вот что позволяет интегрировать любые приложения для и дело через них вызов это водители которые в принципе обрабатывают заказы возят клиентов и операторы которые делают входящие исходящие звонки и принимаю заказы наблюдают за ходом исполнения и случае чего могут помогать водителям при этом отвечаем мы в среднем за 20 миллисекунд водителям в ходе их работы из оператором за две с половиной миллисекунды с чего все начиналось у нас начиналось все стало то что наш мобильный разработчик писал диплом вот но до при этом его тема была связана с водительским предложением для службы такси вот и в своем приложении он сделал плавно анимированный маркер вот примерно по такому же механизму как это реализовано сейчас в яндексе в я не вчера заказывал буквально яндекс такси увидел то что у них все-таки индикация то . где находится водитель есть вот и он миром в плавно вот и по сути об этом и будет доклад у нас она выглядела стала выглядеть салат так вот и как мы все это дело делали во первых мы решили сначала попробовать и сделать все это как можно быстрее потратив как можно меньше ресурсов нового по всем канонам и джейла при этом у нас что есть из стартовых данных на текущий момент у нас водители получают отправляя свое местоположение раз 15 секунд и клиент получает местоположение водителя также за 15 секунд по взятому ему заказу при этом в том же самом by taxi что работают стамбуле маркер местоположение водитель обновляется раз в 3 секунды ну и первый вариант можно взять уменьшить интервал слать данные чаще но в нашем случае это не подходит потому что для того чтобы работала авто назначения оператором заказа при на каждая отсыл координат водителя у нас ему в ответе приходят какой заказ он сейчас выполняет какой заказ у него будет следующим у нас в процессе работы водитель маза делать на нем может быть назначен одновременно два заказа а также есть ли чрезвычайной ситуации не на кого водителем цвета ни на какого водитель они нападают вот и если у нас есть еще такой механизм как тревога вот который показывает то что если водитель и т.п. то есть у него на него напали пятеро пьяных киргизов собираются его горло порезать у него есть тревожная кнопка ну и первые пробы у нас для клиент для клиентского приложения следующее мы делаем первый запрос сохраняем координаты которые пришли сделаем еще один запрос и пытаемся анимировать нашу машину но во первых имеют две точки очень сложно провязать как-то к дорожному графу и соответственно следующие проблемы связанные с тем то что машинку колбасит и она в принципе и срезают все углы выглядит оно вот примерно таким вот образом решать этот беспредел и пробуем тем то что мы внедряем святой способ это open street ротик машин которая позволяет делать либо мы просим то есть привязывать координаты к графу либо по двум точкам строить маршрут пробуем дальше у нас такой же интервалы раз 15 секунд мы делаем запрос сохраняем точку и отправляем ее в следующем запросе по двум точкам строим маршрут с помощью укус осы рима и возвращаем все это дело в мобильное приложение и пытаемся анимировать но в идеальном мире где у нас есть дорога и туда и обратно то есть у нас всегда двустороннее движение это работает но с односторонним движением и с погрешностями gps-модуль и у нас возникают следующие проблемы водитель стоит себе на перекрестке вот ждет своего сигнала светофора вот в этот момент у него модуль gps прыгает на другой другую часть перекраска вот наш backend думаю то что у него в принципе пришло две точки надо построить маршрут и машинка анимируются вот по такому вот кольцо двигаясь с огромной скоростью и у клиента все это видно вот проблему решаем мы следующим образом мы просто проверяем по двум точкам если расстояние у нас меньше 20 метров то мы считаем то стоит вот погоняв все это дело понаблюдав за тем как водитель у нас катаются не нашли не найдя каких-то других богов мы все это дело релизе им выход его на productions собираем такие вот отзывы от наших клиентов мы думаем как бы поправить существующие проблемы которые мы нашли проблемой недочета у нас следующего характера во-первых расчет стоимости поездки у нас изначально был только на устройстве водителя и с одной стороны это вполне себе нормально потому что мы не грузим серверах посылая не посылая какие-то дополнительные данные но с другой стороны учитывая то то что у нас большинство водителей работают на андроидах и возникают возникает соли у нас следующий некоторые баги стену то что счетчик скидывать сау 0 хотя как бы все механизмы восстановления сохранения статуса поездки на в локальный около локальная память устройства у нас имеются помимо этого все-таки трек один раз 15 секунд это мало потому что не все клиенты как мы были уверенны на на тот момент смогли понять что же мы все-таки им дали потому что машинка порядка 15 секунд стояла на бездвижен на экране и мало кто 15 секунд будет просто вот так вот залипать в один экран и что-то ждать ну и плюс к этому у нас часто довольно возникают проблемы с модулем gps у водителя следующего характера в принципе первые две они связаны только с самим устройством а вот по последнему я могу рассказать такую историю как-то в 2004 четырнадцатом году весной мы сидели и вполне себе работали то есть писали код пили кофе ничего не предвещало беды но тут нам звонят ребята с транспортного отдела и говорят то что водители не могут работать почему спрашиваем и вот потому что у них gps-модуль калибруется но пускай по калибруется вот это по сути не не в не в нашей компетенции у нас по самому процессу работы приложения реализовано было как водитель сначала калибруется модуль gps и только потом уже подключается к серверу и получают заказы и по сути такой механизм был реализован а у всех служб такси в нашем городе в итоге на протяжении шести часов такую ситуацию наблюдали абсолютно все служба такси как оказалось с чем это было связано непонятно вот мы посовещавшись писали все это на электромагнитные бури и космическую радиацию вот и но факт был при этом работало порядка 40 процентов водителей те которые успели подключиться до того как возникла эта проблема и считали они только по километражу по счётчику внутри машины ну и плюс ко всему этому из мы захотели как uber или лифт показать все эти машинки во-первых выдавать ближайшие машины в мобильном приложении во вторых и и во вторых еще и пытаться их анимировать мы возникают у нас следующие требования во-первых собирать чаще треки от водителей во вторых выдавать ближайшие машины и анимировать их в третьих учитывая то что и возвращаюсь тому то что счетчик у водителя может скинулся в ноль мы решили сделать ни одну точку отказа этого соуса освободителя хранить еще промежуточно в ходе выполнения все это дело на сервере при этом желательно экономить трафик водителю и собирать один трек 1 секунду но сейчас по идее 2016 год везде пара без лимитов но во-первых у нашу страну интернет идет через вас от вас точнее а во-вторых он идет через казахов вот который свою очередь мы подняли нам тарифы и с мобильным интернетом и без лимитами у нас вообще плохо плюс к этому у водителей такие расходы порядка 1150 рублей за смену при среднем чеке но у нас на поездку в 100 рублей но и водителю получается можно сделать там 20 25 заказом чтобы его выход на линию был не бессмысленный при этом расходует он порядка 55 70 мегабайт интернет-трафика что выражается в деньгах в порядка 100 рублей в день а в масштабах компании это выходит в 100 тыс но и как мы решили экономить трафик а точнее нет что такое трек это местоположение широта и долгота это сессия водителя по которому мы по которой мы идентифицируем и его да и водителей и выдаем тогда когда он выходит на линию и эта информация по текущему заказу виде его стоимости трафик мы решили экономить следующим образом это во-первых паса раз уложить один трек вас 100 байт и чтобы все работало шустро рассматривались следующие протоколы передачи данных и отдельно по минусам каждого из них архетипе мало того то что работает поверх и себе что накладывают свои выходы об этом чуть позже так еще чтобы отправить обычный get запрос накладывается порядка восьми 18 байт а верха до websocket и они крайне нестабильны и очень жирные происходит процесс инициализации а потому что сначала мощном один запрос потом съем запрос на апгрейт переходим инициализируем вы спускаемся на тисе пи уровень и при этом два запроса соответственно не подходит и плюс потому то что ведет крайне нестабильно на мобильном интернете выв если кто пользуется с веком можете понаблюдать уйти себе проблема в том то что в проблему его хен шейках то есть мы отсылаем три пакета на то чтобы только установить соединения для нас это было долго и дорого долго потому что в особых районах у нас интернет может быть крайне нестабилен и чтобы только услуги соединения тратилось нам до полутора двух секунд и дорого потому что три пакета по 20 байт и пикадоров получается как минимум 60 байт минусы идеи как все знают что он может и не дойти вот но как бы и фиг с ним у нас данный не настолько критичны и по сути если мы будем просто полива сада то граммами то в целом будет минималистичное для нас в нашем случае будет работать терроризировать данные мы хотели следующими механизмами и как вы догадались первые два мы не взяли вот по следующей причине протокол буфера просто делают по объему реализованных данных ближайшего своего конкурента там чуть ли не в три раза мы что получается у нас в остатке решая задачи в экономии трафика у нас 42 по и лода оборачивается в один видите пакет это получается шестьдесят два байта и в за смену водителя набегает 2 мегабайта и это порядка 6 рублей в деньгах и по сути водители у нас этого не заметят но сейчас мы без проблем можем кидаться 1 секунду треками и меньше мы сделали такую реализацию на каждое срабатывания gps леснара в android приложение мы решили сразу же отсылать информацию на сервер но отсылать то можно еще же эти данные можно хранить хранить что нам нужно во-первых сессию водителя и номер борта чтобы делать быстрый поиск например по сессии чтобы контролировать если водитель ушел с линии мы его удаляем из нашего охране хранилища если водитель вышел на линию мы его добавляем плюс номер порта для того чтобы выдавать информацию в клиентское приложение плюс к этому иди заказы и сумму поездки для того чтобы водитель мог восстановиться в случае того то что есть у него вдруг сбился счетчик ну и хранить он посредник точек для того чтобы строить маршрут по которому водитель ехал и последними со положении для того чтобы соответственно выдавать ближайшее место положения при этом у нас из система хранения есть следующие to perform a server 56 в которой мы храним абсолютно все наши данные то есть и заказы и самих водители операторов в общем все у нас есть редис который мы используем в качестве попс общины и key и value хранилище у нас есть власик search который мы используем для дела кодинга при этом для эффективного хранения чтобы у нас расходовалась меньше ресурсов на можем гиа индекс какой-нибудь вот мы рассматривали следующее это когда и дерева и r дерева и о каждом из них поподробнее какие у нас были требования к самому индексу во первых чтобы он умел из коробки делать поиском ближайших точек а во вторых чтобы дерево было сбалансировано чтобы у нас был быстрый поиск вашем случае смотрели на коре дерева она выглядит так вот и из минусов у него то что дерево не сбалансирована и решает задачу поиска только одной точке то есть с помощью когда дерево можем найти без проблем там дай мне в ближайшее заведение рядом со мной но при этом если мы хотим найти несколько то нам нужно поверх него пилить что-то типа гейнер с небес что не очень то и хочется посмотрели на r дерево оно выглядит получше она сбалансирована и она в чем в чем то похожи на б дерево только для пространственных данных она обеспечивает лучший быстрый поиск в худшем случае и в также она решает поиск м ближайших точек что нам и нужно было плюс к этому у нас с водителями не все так в порядке по следующим причинам они точнее это причины того то что водитель не всегда может правильно выйти уйти с линии что соответственно в одессе так как мы сейчас сохраним все данные по водителям в нём мы делали механизм expires соответственно в нашем новом хранилище нужно также работать с экспой рамы при этом строить какое-то лари и хранение larius структуру данных для хранения последних точек чтобы мы чтобы у нас был фиксированный размер мы туда закидывали постоянно какие-то данные при этом случае переполнения возможного они просто данные вытеснялись вот и нам это не нужно было обрабатывать но получаем следующую схему хранения которые мы придумали хранить в памяти потому что память сейчас дешевые данные целыми такие большие нам нужно также построить or дерево для того чтобы выдавать ближайшие машины в клиентское приложение и нам нужны были две карты с водителями в одном в одной из них ключи масс сессия для быстрого поиска по сессии и в другом номер борта что соответственно для поиска по номеру борта какой у нас в самом алгоритм то и вырисовывается мы получаем данные по идее которые и реализованы протокол буферами мы пытаемся получить водителя с нашего хранилища есть у нас нет мы обращаемся в редис и получаем нужные данные как-то например номер борта и его айдишник проверяем если все нужные данные с у редиса делаем сет который работает так если водитель есть в хранилище он все данные обновляют включая и expire если нет то мы не соли зиру им энергию и добавляем в сторож ну и плюс обновляем информацию в r дереве варианты для реализации у нас были следующие я подробно прошлом году рассказывал о том как мы с помощью первых трех сделали вообще всю нашу службу отказывал слащевой вот в начале этого года мы нашли go и из нашего стыка выпилили рубину джесс руби потому что в нем очень много синтаксического сахара и в целом нам оно не нравилось но джесс просто потому что это орла много ресурсов например чтобы как случае из нашей практики у нас на ночь с и наса китая был написан бэкон который предоставлял real time ago обновления статусов и всей информации по заказу в операторской интерфейсе так вот этот эта вещь была запущена на 3 инстансах на 3 virtual koch в у которых было по два гигабайта оперативной памяти при этом втирала но не так много вот и запущена было в общем порядка шести инстансов после того как мы переписали все это дело нога вот у нас расход памяти стал существенно меньше он уменьшился чуть ли не в 10 раз и демон реализации нога оттирала не больше 100 мегабайт при том же самом функционале помимо этого он очевидные плюсы в том то что он 40 типизированный компилируемый компилирую сам в один binary и если мы этот binary просто закинем в докер-контейнер то мы получаем сравнительно маленький размер докер-контейнер of что в целом хорошо и удобно вот у него из фич языка в том то что он жрет меньше 1 ресурсов при этом то что код при этом то что кот одинаково он живет меньше ресурсов и нас стал меньше зоопарк потому что у нас в конечном остатка в сухом остатке осталась там один backend на джанки один на три стадии все остальное у нас описано нога реализовывали и брали варианта для лизации для r дерево отсюда потому что мы у нас не было каких-то веских причин самим реализовывать дерево потому что но не хотелось как-то налажать и поймать вот этих вот алгоритмических багов вот а lr умы на велосипеде ли потому что структура хранения она по проще чем деревья вот и в принципе там ну чё get set вот и выдача ключей yubikey есть стандартной библиотеки балансом поддерживает протокол буфера и сделали также http вот на первом попавшемся в гугле запросе вот у нас это получился эхо ощутите api мы делали для чего для того чтобы за интегрироваться со всеми нашими сервисами которые уже сейчас работают на продакшене и какие методы вы ощутите open нам нужны были первое это выдача ближайших водителей с его маршрутами с их маршрутами удаление возможность метод для удаления водителя из история по его по сессиль его по номеру борта получение информации о поездке для того чтобы водитель мог восстановить информацию также получаем получить для получения маршрута по одному водителю и интегрировать все это дело нужно было в 2 бэг-энда один бэкон для клиентов другой соответственно для водителей как она выглядела в принципе опять же и то есть подробно все в прошлогоднем докладе у нас в общем есть backend на твиттере который обеспечивает полностью работу водителей и есть два бэг-энда на чанге один из них у нас ядро которые большое монолитное обеспечивает абсолютно весь workflow всех наших отделов вот и для клиентов у нас есть отдельно пикантно джанки вот который в случае чего может общаться по степи описан ядром архитектурного выглядит так у нас есть джинс который балансирует на трафик между двумя бы konami приложений для приложений и которые в свою очередь могут общаться с ядром а водители также джеймс у нас стоит как точка входа при этом он балансирует обычный тисе пи трафик вот и 202 по сути являются такой вот конвертером между 5 и выдуманным нами протоколом общения с водителями внедрили все это дело так вот нас твист теперь для водителей в идет в локейшн абакан для того чтобы получить информацию о поездке для клиентов соответственно подобным же образом при этом так она и сзади появилась у нас в продакшен и все это нужно было так же еще и эксплуатировать а эксплуатировать как но есть стандартные вещи виде логово садовод метрики в граффитчики в сан-суси в принципе очевидно вот плюс к это у нас есть полезный статус как мы его назвали есть боты полезный статус что это такое в нем а то это по сути method and paint в нашем топе нашего бэг-энда который показывает данные серьезный джейсон в котором соответственно есть время когда б candles are the nude вот когда он был запущен что позволяет вам делать какие-то выводы о его up to me это отдельно структура виде количество запросов по каждому статусу и общее количество запросов а боты у нас работают на продакшене и эмулирует работу как водители так и клиентов водителей эмулирует просто отсылая взгляни раны и треки при этом рандомные для клиентов забирая в ближайших водителей и отдельно трека какого любого любого водителя при этом чтобы она не пересекалась с клиентами у нас при старте ботов каждый раз генерится новый локейшн она сунула либо в марокко либо в индии либо еще где нибудь но работает при этом если что-то поломалось то админа об этом узнают из системы мониторинга в мобильных приложениях в общем выглядеть в фича выдачи ближайших машин стало так у нас определяется местоположение клиента потом она отзываясь 1 и получается ближайшие водители при этом потом мы анимируем каждую машинку и обновляем там раз 15 секунд при этом как бы косяки есть у всех от даже у тех на кого в принципе равняются все сами службы то есть как например вот косяки uber а вот не всегда и все могут обрабатывать погрешность у припаркованной машины прыгну погрешность у тебя смотрят которые с которой салют в припаркованной машине вот бывают косяки в такого характера вот мы нашли у лифта вот так же мы вообще наш ближайший такой вот аналог на который мы смотрели это вели увели раньше все работало вот сейчас когда мы снимали у них машинки видимо что-то у них в тот момент отломалась когда мы это мы в общем во время подловили вот так что проблемы бывают у всех при этом самый главный слайд вообще по на котором вся тема моего доклада рассказано и вообще в заключении что могут сказать то что все это обман то есть все вот эти вот ближайшие машинки этого сном для таких вот не очень опытных пользователей вот потому что данные там по-любому показывается с лагом и лак может быть довольно большим как например вот у нас у нас лаги были там на 15 секунд вот при этом вполне возможно ваше ближайшее время весь вот этот наш backend мы выложим в открытый доступ вот вы можете следить за вот на первые ссылки на git хоп вот и помимо это у нас еще есть там множество open source проектов вот один из них это ариадна он вот он там до суда но соответственно ваши вопросы спасибо за доклад было очень интересно вопрос следующий тестировали ли вы предложенную систему о которой рассказали на производительность например не при 600 водителях apr 10 тысячах на 10 тысячах мы не тестировали потому что во первых но эти метрики вы просто потешили нас с наше самолюбие все вот у нас не больше тысячи водителей мы соответственно тестировали на полутора тысячах и результаты нас порадовали и все работало шился полторы тысячи хорошо то есть завоевать соседние города не планируйте например и увеличить это число в новом к десятка про мы планируем и вообще по сути решать проблему нужно по мере их поступления то есть в нашем случае это было абсолютно бессмысленный кроме того то что вот мы потешили свое самолюбие бы мы бы ничего полезного не получили спасибо ответ услышал можно еще один вопрос какая мощность железо на котором этой сумме круть у нас два сервера с на одном процессор стоит е3 вот оперативы 32 спасибо носи в этот за доклад у меня два вопроса вывод упомянули что вы переписали часть нога а потом дальше не где вы не упоминали что у вас нога у нас могу все так на графиках было 2 ст и джанга но он это то что у нас осталось у нас вообще есть очень много всяких разных интеграции все новые сервисы мы пишем могу и стало то что мы переписывали мы переписывали демон для отправок из для отправки sms для отправки почты тифе кечинов для сейчас еще скажу вспомнить бы для отправки данных в google аналитика потому что у нас была одна задача связанная с этим вот мы сейчас в процессе переписывания всего остального вплоть ну так же еще этот демон отвести вот и у нас половина монолита сейчас в на переписана также нагов на микро сервисной манере спасибо и ещё хотел спросить вот зачем вас столько данных в треке получается вы сглаживает маршрут прямо на клиенте иди же ничего не нужно кроме координатам и time stamp а ну по местам по сути не всегда и нужен быть вот у нас опять же у нас одна была . отказа вот в поест при поездке то есть все расчеты о поездке они на устройстве водителя вот и мы не хотим обманывать клиента them to shout у водителя там что-то случилось и счетчик сбросился и все по нулям вот ради решаю эту проблему мы дополнительно решили то ну то есть одним движением убить два зайца это во-первых восстанавливать опять же стоимость поездки у водителя вот случай там каких-то s-off и также анимировать вводите это машинки на карте спасибо большое за интересный доклад я здесь слева а слева вы там много что использую переписываете теперь все нога видимо он такой настолько удобный а вот какие минусы с которыми вам пришлось столкнуться вы увидели фронтами и в языке в ран тайме мы настолько глубоко не копали вот но из всего остального мы пока что не научились писать большие монолиты ногой при этом не умереть вот во всякие такие мелкие вещи и отдельными к сервису у нас мы прям довольны этим ещё такой вопрос вот вы говорили что для экономии трафика сделали все полу dippy с безопасностью как вопрос думали может быть проще было договориться с операторами скажем так чтобы они определенным образом тарифицировать и трафик вроде вы называли там цифру 100 тысяч рублей в день это хорошие деньги на сколько я понимаю их можно было попытаться уломать и там резать по тисе пи например как ходил и на самом деле в этом две вещи во-первых по сути но опять же данные не важны вот мы можем просто их отослать во-вторых мы не хотим грузить сетевой стек мобильного приложения по сути часто ссылка пойти себе таких данных но то есть вариант когда у вас появится вместо 600 машин которые едут в разных направлениях там пару тысяч будет нормально или когда он прилетит кто-то с ди да сам это нормально такое невозможно вы хотите но и я вообще насчет этого не могу вам ничего просто рассматривали такой во первых у нас в именно ю т п и без ничего он по нескольким причинам опять же то есть одно дело до мы экономим трафик это прям на экономим деньги вот в другое это именно для того чтобы приложение водительского но не было каких-то дополнительных сайт эффектов от а то что прилетит выпуская прилетает мы посмотрим нас это в принципе деда сели на других проектах и в принципе этого не боимся скажем так спасибо нужно спасибо за доклад подскажите вы вначале доклад и сказали что у вас данные приходят от трекеров через пятнадцать секунд и потом на клиент еще через 15 секунд ну то есть нет это допроса таймер и в приложениях они по 15 секунд ну вот обманут то есть есть вариант такого запоздания этому западного него трусы секунд может быть да вы потом уменьшили до и и вопрос-то в том что они все посылают каждый год 15 секунд или вы вот как-то раскладываете машинки чтобы вот приходили равномерно трафик чтобы приходил мы не раскладываем не раскладываете да а вот так они через фиксированное время посылают ну вот второй вопрос или если машина стоит например она неслась не посылается да то есть стоят во первых проверки на клиенте если у нас там произошло там 20-30 метров то только тогда отсылается и плюс дополнительно еще на сервере вот если данные там в течение но есть разница там не же ними 20 метров то есть меньше 20 метров там и этот трек просто не добавляем спасибо скажете вы сказали вот где-то 600 или тысячи машин вы как-то решали проблему вот когда нужно одновременно их на карте отобразить или они даже не все они где-то в гараже ту это какая-то . там и летящая мастер доклада вот у нас связанные с менеджментом и с производительностью фронтэнда вот вообще мы это все дело показывали мы боролись с этим и в целом могу сказать то что мы выдаем их также порционно зависимости от того где сейчас куда оператор смотрят на карте то есть как есть так и показать да как есть так и показываем но также забирая сейчас ближайших то есть после того как мы сделали мы сделали еще и и в операторской интерфейсе спасибо спасибо за доклад я правильно понял то что у вас стоимость поездки другая логика рассчитывается на приложить на девайсе его водителя но рассчитывается километраж рассчитывается время ожидания но это высота соответственно все плюсуется и потом по завершению скидываются на сервак вот но сама тарифе кассано получается с сервак а почему тогда не можете ты у метро рассчитывать на сервере чтобы дополнительно не грузить ну то есть если у вас такой дорогой интернет уже можете это рассчитывать из точек который вы получили можем но мы сделали телами расчет километража на устройстве до этого вот а вот то есть вы дали кто говорил то что у вас рассчитывается рассчитывалась а стоимость на водитель то есть когда там водителя взрывался телефон или там что-то еще то ни водитель не клиент не узнавали стоимость заказа ну печально осознавать надо было такое вот и именно эту проблему мы также и решали спасибо он спасибо"
}