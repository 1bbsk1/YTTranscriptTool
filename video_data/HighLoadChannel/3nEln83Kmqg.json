{
  "video_id": "3nEln83Kmqg",
  "channel": "HighLoadChannel",
  "title": "Поддержка высоконагруженного проекта / Евгений Потапов (ITSumma)",
  "views": 529,
  "duration": 2723,
  "published": "2017-07-30T00:47:27-07:00",
  "text": "мой доклад будет про то что делать с проектом постройках моего запустить вы спланировали архитектуру проекта вы продумали как у него будет работать инфраструктура продумали как будете балансировать нагрузку наконец его запустили что делать дальше как поддерживать как сделать так что проект продолжала работать и как сделать так чтобы ничего в конце концов не упала для начала немножко себе я из компании эти сумма наша компания занимается круглосуточной поддержкой и администрированием web-сайтов сейчас у нас работает 50 человек в основную в 2008 году мы поддерживаем более тысячи серверов которые каждый день посещает больше ста миллионов человек есть крупные проекты на поддержке есть небольшие пацаном это сейчас российские проекты и вот на основании опыта поддержки этих проектов я хотел бы и поговорить о том что же стоит делать вообще если говорить о поддержке из чего она состоит на мой взгляд она состоит из трех компонентов первое это мониторинг проекта и реагирование на alert и которые приходят второе это организация резервирование и резервного копирования эти штуки мы разделяем и третье это организация обслуживания и поддержки собственно реагирования на то что происходит с проектом если говорить о мониторинге мы все понимаем что мониторинг необходим нужно понять как и для чего его использовать можно разделять три этапа использование мониторинга кота как они приходят в голову как к ним приходят люди приходят компании на первом этапе мониторинг рассматривается просто как система оповещения о состоянии дел с проектом оповещение о проблемах на сервере это как самый простой этап оповещение о проблемах связанных с логикой приложения как более усложненная штука когда мы наблюдаем что что то не так стало с сайтом с проектом и понимаем уже из какие-то показателей происходящее на сайте и оповещение о проблемах связанных с бизнес показателями если говорить о борт требованиях самой систем оповещения на в любом высоко нужном треке что вы должны понимать что прежде всего система мониторинга должна быть независимо от самого проекта не должна располагаться там же где находится проекта не должно быть ним связано если проект упадет система мониторинга упасть не должна система мониторинга ладно максимально быстро извещать вас о происходящем на проекте если у вас произошла какая-то авария или если вам кажется что авария скоро произойдет это не нужно о причине вам о том что это происходит не должно прийти через длительное время вы должны знать об этом как можно быстрее и вы должны быть уверены в том что вы надежно получаете информацию о том что происходит с проектом то есть вы должны точно понимать что когда будут достигнуты критические показатели которых которые вы установили по проекту или когда придет какая-то авария на проекте вы получите соответствующее оповещение если говорить об уровнях оповещения в том что играл раньше первый уровень это проблема на сервере когда мы просто самым базовым образом смотрим какие-то физические показатели показатели связаны с в том на операционной системе с базовым софтом это проблему на уровне приложения когда мы смотрим как подсистема приложению взаимодействуют с другими подсистемами как не взаимодействует внешними сервисами и что происходит там и третий уровень оповещения проблемах на уровне бизнес-логики проблем на сервере самые простые штуки которые можно там мониторить это статистика по нагрузке на центральный процессор где мы смотрим на нагрузку на самом процессоры и на косвенные показатели по этой нагрузки такого кода его речь скользящие средние статистика по нагрузке на дисковая подсистема статистика использования оперативной памяти своп если говорить о всех показателях на сервере которые можем за мониторить вот эти три штуки в первую очередь могут сказать нам о том что с сервером происходит не так цыпа у растет в приросте трафика или не оптимальном коде нагрузка на дисковой подсистемы чаще всего происходит при неоптимальным взаимодействие с базой данных использование оперативной памяти резко увеличивается и память ходит своп если у вас растет трафик если у вас какой то опять же не оптимальный год статистика по серверному софт оставим оповещение на падение всплески число запросов на сервер смотрим внешние проверки по доступности сайта причем если мы сможем мы устанавливаем внешние проверки на доступность мы должны проверять не только скажем время ответа страниц и кода ответа но часто случаются ошибки со стороны например разработки когда вместо и чтить и всем известный 502 сервер на самом деле отдает еще типе 200 и страница вроде бы выдает ошибку но для системы мониторинга для поисковых движков она продолжает считаться валидная нормальной страницы в которой просто написан текст ошибки поэтому мы рекомендуем первое дополнительно к проверкам времени и кода ответа смотреть собственно размер ответа страниц когда обычно он у вас не меняется во времени если что-то происходит связанная с большой большая авария размер чаще всего подают в резко вниз и второе с помощью уже появившийся тулс типа каспер джесса смотреть на время непосредственно рэндами страниц потому что очень часто мы видим например как некоторые внешние сервисы вот в последний год несколько раз этим грешил сервис комментов как у когда рендеринг резко замедлялся и в конце концов то есть страницы генерируется которое вы проверяете на сервере однако в браузере у людей появляется лишь кусок каких-то картинок до конца на не прогружаются оповещение о проблемах на уровне приложений в первую очередь следует за мониторить число ошибок уровня приложения да есть логит которые можно посмотреть на чаще всего на любых проектах рано или поздно в стремлении делать какие-то новые фичи не хватает времени разобраться с тем количеством каких-то ну модификационных сообщений о которых приходит информация от приложения вместо того чтобы разбираться с этим потоком один из простых методов это наблюдать количество таких сообщений в минуту то есть мы смотрим что у нас где-то сто двести например таких сообщений в минуту потом признать и какой-то очередной выкладку нас резко вскакивает это число до 2000 3000 из нас не интересует отдельная строка нас интересует общее большое число по этим оповещением число обращений по системам узлам пусть у вас есть проект который использует эффективно использует систему кэширования и редко обращается к базе данных можно за мониторить число обращений к базе данных можно и стоит наметить числа обращений базе данных select of концертов апдейтов для литов и дальше смотреть на изменения в процессе если у вас нету резких скачков трафика это количество будет воздержаться примерно равным если во что-то происходит системой кэширования вы увидите всплеск на таких запросах и поймете что происходит что-то не то и следует расследовать такое следует сделать к любым подсистемам и уже дальше исходя из информации которые вы соберете поставить какие детали рты и если у вас есть какие-то внешние сервисы причем я под ними понимаю как и базу данных как какие-то сервисы расположены на других серверах в на вашей же площадке или это внешнее api следует обязательно за мониторить взаимодействие с этими сервисами особенно с внешними api мы все считаем что это у нас проблема в больших компаниях люди делается классные хорошо но вот наш опыт взаимодействия например клиентов с фейсбучный и 5 говорить о том что багетом бывают очень часто время ответа резко увеличивается и вы можете считать что сайт начинает тормозить у вас а на деле это резко ухудшилось взаимодействие с каким-то внешним и 5 который мы даже не подозревали что она может ухудшиться соответственно мы мониторим время ответа ставим на мониторинг время взаимодействия тех важных запросов которые нам нужны и при скачках во временные ответа вот в этих запросах начинаем исследовать что случилось с нашим приложением не ставил валя ну работать хуже и такая прикольная штука которую почему-то на моем для для меня удивительно очень редко делают это мониторинг бизнес-логики смотрите когда мы мониторим сервер нас есть там миллион показатели которые мы можем за мониторить и так или иначе мы можем какой-то из показателей подумать что вот он сейчас не важен я не буду закрывать его allure там я не могу понять какая у него может быть критическое значение я не могу понять на что мне реагировать и рано или поздно когда это показатель всплывет может случиться так что у вас нет allure тона такую аварию авария случилась все вот эти миллион миллион миллион показателей они в конце концов превращается в проблемы с тем для чего существует это приложение приложение существует там условно говоря начиная с количество заработанных денег за день количество пользователей которые сделали какие-то действия до простых штук количество покупок на сайте количество заказов форме на сайте количество постов на сайте все эти штуки довольно просто за мониторить особенно если там вы разработчик и поставить на alert и уже с этой точки зрения тогда даже если мы пропустили мониторинг и нотификации со стороны серверного по пусть у нас на чем начал тормозить железо из за этого у нас стали отваливаться пользователи на своих действиях мы поймем что вот это вот падение трафика и падение действий оно произошло по какой-то причине сможем уже сами глазами расследовать графики их расследовать причины происходящего и разобраться а вторая штука которую тоже часто стоит делать это эмуляция пользовательской логике приложения мы часто в мониторим серверные штуки мы мониторим отдельные скрипты что не отвечают но для примера очень круто мониторить а если нас есть логин на сайт если нас пользователь приходит и регистрируется дальше заполняют форму получает ответ на получает письмо с регистрационной ссылкой нажимает на эту ссылку и заходит на сайт у нас есть минимум штук пять мест где может сломаться из имеете каждый из пяти мест мониторим в отдельности мы не уверенны что вот эта вся последовательность работаю с целом создать скрипт который зайдет на сайт который заполнит эту форму засек видит постом эти данные потом создать скрипт который проверит почту и нажмите то ссылку которая там была и просто проверить что куку остановилась на эта работа технически ну дня 2 а контроль который от этого получится значительно превышает ну те затраты которые выйдут на создания этого скрипта поэтому я предлагаю что вот эта штука должна быть для большинства периодических функций на сайте обязательной оповещение о проблемах на сервере другая штука которую опять же не совсем правильные мы видим мониторинге это когда оповещение устанавливаются на критические показатели уже близки к страшной страшной беде а люди ставят оповещения на загрузку процессора на 99 процентов в течение 5 минут в течение 10 минут тот момент когда к вам приходят такие данные вы сделать уже технические практически ничего не можете то есть вы уже имеете у себя загруженный сервер вы уже имеете у себя упавшие приложение и вам надо врали в пожаре вершить что же с этим делать на старте проекта после какого-то времени запуске постов можете проанализировать какой характер у вас трафика вы можете понять характер нагрузки например у вас процессор загружен на 30 процентов не нужно ставить оповещение на 90 процентов не нужно ставить оповещение на 99 процентов нужно для себя выбрать ведь какие-то ключевые точки на которых вам нужно принимать новое решение то есть alert на 50 процентов вы понимаете что вот у вас обычно было нагрузка в 30 процентов которые вы привыкли а теперь 50 процентов это не страшно с точки зрения работы сервера но вам пора подумать о том какой будет дальнейший рост и когда вы даете до семидесяти процентов и так далее в таких случаях вы получите запас времени в котором вы можете решить что же мне делать могу ли я с этим пока еще жить или мне уже пора думать о том как менять архитектуру может быть не докупить нового железа может быть надо сделать с кодом может быть последнее время что-то случилось кодом из-за чего он стал отвечать дольше так далее мониторинг системы анализа мысли мы до этого говорили что мониторинга систем оповещения то вообще выбирая систему мониторинга вы должны понять что это не только а по системам оповещения ной эта система анализа которая должна хранить максимально возможное количество данных бы должна дать возможность быстро выбрать эти данные за нужный период и уметь их быстро отобразить в нужном нам виде кроме всего прочего эта штуковина должна обладать возможностью сравнение однотипных данных по разным серверам если мы говорим о том что у нас много платформенная система много серверная система потому что если у нас есть например 5 однотипных серверов и мы смотрим на каждую мониторинге в отдельности мы можем не заметить того что один сервер стал отклоняться других-то но 30 процентов если мы сгруппируем статистики по всем пяти сервера вместе то мы это увидим система мониторинга должна обладать сравнением текущих данных с историческими данными потому что если у нас идет например небольшой спад и небольшой рост процент в течение долгого времени просто глядя глазом на график может не обратить внимание если мы выберем две линии одну текущую и вторую например как это было месяц назад мы увидим действительную разницу и можем уже понять что происходит и быстрая выборка большого диапазона исторических данных подразумевается то что фактически записывается огромное количество данных и сам по себе мониторинг это высоко нужное приложение мониторинг должен владеть возможностью не если он если он хранит эти данные он должен сбросить данные выгрузить в докладе народ конфи мы с коллегой рассматривали примеры тех систем мониторинга которые доступны в настоящее время и если говорить о том что можно использовать то там более-менее ради это классический zabbix и графит но что вот интересно к чему я говорю про третью часть быстрый выборкой большого диапазон исторических данных у нас вот если смотреть по нашим клиентам где-то порядка семидесяти процентов сидит на за пикси и 20 процентов сидит на граффити и любая но до с графитом занимается практически тем что забита на сто процентов по процессору то есть система хороша для записи данных она хороша для их отображения но регулярно возникают проблемы с тем что мониторинг просто не может отрисовать то что нужно то что от него хотят система должна сделать это быстро а получить это быстро нельзя дополнительную штуку которую если вы будете выбирать систему мониторинга очень бы было полезно это сложной агрегация метрики то есть у нас чаще всего какие-то из metric на проекте могут быть довольно ну относительно с шумом этот шум необходимо каким-то образом минимизировать получить скользящую среднюю посмотреть по запросам перцентиль в какое количество времени выполнилась там 99 процентов запросов сгруппировать запросы по минимальному в течение времени и так далее кроме всего прочего мониторинг нужно представлять себе как систему для принятия решения то есть у нас есть мониторинг как система оповещения у нас есть мониторинг как система для анализа того почему у нас случилась проблема и для анализа того для понимание того как эту проблему избежать и вот самое главное раз получается мы должны использовать систему мониторинга как штуку который нам позволит а понять как авария случилась и что сделать такого чтобы больше этого не случилось бы посмотреть на то как это будет систем развиваться в будущее и вы посмотрите на то как сделать так чтобы избежать ну ошибок которые уже были если говорить о доступных решениях то вот так так же может быть и смотрел наш доклад из-за действительно хороших нормальных решений которые работают на не большом проекте и не стоит слишком дорого в плане внедрения я считаю что нужно использовать saas-сервисы написаны три сервиса которые необязательно использовать они примерно все одинаковые для небольшого количества серверов они стоят не дорого и самое что главное они не потратят вашего времени на их интеграция сложный сбор данных я бы сейчас обратил внимание на графит но вам придется сильно помучиться с тем как хранить там данные если у вас очень сложная система если вас очень сложные данные можно подумать о том чтобы сделать свою какую систему или сильно кастомизировать open source на и но нужно понимать что это очень очень очень большой вклад и инвестиции в развитие той системы мы используем собственную систему потому что у нас так старички сложилось что инфраструктура очень гетерогенная у нас есть высокие требования к тому как она должна поддерживаться и как должны эскалировать проблему внутри компании мы разработку этой штуковины ведем с 2008 года у нас есть два разработчика которые этим постоянно занимается и у нас есть очень очень много пожеланий от админов как это дальше штуку изменять единственная причина по которой мы используем эту штуку они там тот же самый график или zabbix это то что мы понимаем чего мы можем получить систему мониторинга мы понимаем что желание о том что как и доработать мы можем это сделать минимум мы не можем это сделать ну и кроме того всего нужно понять что система мониторинга вы привыкаете в тот момент когда вы ее выбрали чем дольше вы используете одну и ту же систему тем дольше после этого вам не захочется с неё слезть даже если вы и не довольны переходим ко второй части и говорим о резервном копировании резервирование но прежде всего я хотел бы поговорить про резервное копирование по сути эта штуковина очень часто там среди наших клиентов среди тех кого мы видим кажется простой вещью которая сама по себе работает который даже не думаю не стоит думать однако дело резервное копирование нужно понять что а резервное копирование создает нагрузку на сервер нужно понять что для вашего проекта может играть большую роль регулярно снятия резервных копий например у вас постоянно огромное количество пользователей которые делают какое-то действие пусть там например то сервис где люди за деньги обрабатывают фотографии если у вас бэкапы делаются раз в день и данные пропали и вы восстановились из 20 часовой давности вы все равно получите огромное количество проблем связанных с тем что пользователи будут говорить как я где мои данные за последние двадцать часов и нужно понимать что в время восстановление из резервной копии также играет роль то есть вы можете делать дамп который делается быстро но этот дам в некоторых случаях может выливаться очень долго процесс снятия резервной копии сам по себе тяжелая процедура резервные копии из-за этого лучше всего создавать резервных машин не создавая нагрузку на то дакша новых машинах нужно понимать того что нужно резервировать классическая штука выкупим часто базу а вот у нас очень много статике которые генерируют пользователи и и мы лучше будем генерировать раз в день но какой смысл раз в несколько часов бэкапить базу если когда вы из него становитесь и вас не будет статики и пользователи точно так же будут недовольны как и раньше то есть они у етом словно говоря это вас сервис 2 вконтактик вы друг на ли базу вы донбасса пол серверы вы поднимете зеленой копий с базой у вас есть ссылки на фотографии нанятыми фотографии и 4 классическая штука backup без регулярные процедуры восстановление не backup очень часто мы видим когда люди организовали backup они его загружают и они считают что все этого достаточно в наверное 4 из 10 случаев из резервной копии которая есть восстановиться без проверок оказывается нельзя должна быть в организации создана регулярная процедура восстановления регулярные как сказать план учений по которым вы в заданную дату начинаете останавливаться неверных копий проверять насколько вы можете это сделать насколько актуальны будут ваши данные и насколько будет работоспособен сайт после восстановления из резервной копии резервных копий бас используем своих сервер только как резервную копию на случай аварии мастер сервера из классическая история падение сбербанка несколько лет назад когда они использовали своих сервер как резервную копию и больше ничего синие делали был не было бэкапов был лишь slave а нужно понимать что slave принимает все скволл запросы если у нас пришел человек на мастер сервер и сказал удалить все из мастер сервер a slave получит тут чем такую же команду на некоторых базах я не могу сказать запускаться я видел этой такие штуковины на мои se que le есть возможность сделать свои в сад лужин с отложенным делаем с отложенным давлением это такой небольшой хакан о которой иногда помогает то есть вы делаете отложены обновление своего где-то минут на 30 и у вас уже есть вот это вот время когда вы понимаете что кей дать случайно сделали дроп на мастер базе мы можем резко прерывать реплику и приключиться на своих место чтобы делать долгую процедура восстановление из базы ход backup службы для регулярного визирного внешнего копирования то есть у нас есть slave для защиты от аварий и только для защиты от аварии и ход backup для защиты от человеческого фактора минимум одну копию мы храним в пределах той же площадке находимся чтобы быстрее скачивать и минимум одну копию мы храним на внешний площадки для восстановления при глобальная лари и нельзя хранить копию в том же месте где вы ожидаете что может случится авария потому что когда пусть целиком упадет дара центр hide summary вы не сможете восстановиться если он упадет на несколько дней все дениска дней вы даже обладая правильным бэкапом даже делая правильные процедуры вы будете просто ждать пока не поднимется хостинг при этом нужно понимать что аварии в хостингов это не всегда вопрос 10 15 20 минут амазона за последние пять лет было четыре аварии которая самых длинных которых длилась 48 часов следующие длилась двадцать четыре часа следующая длилось шестнадцать часов следующие длилась порядка 10 часов они каждый раз говорили что мы жутко извиняемся вернем вам деньги которые стоило хостинг в это время оно понятно что это не сравнимо с теми потерями которые были на деле поэтому хранить бэкапы идеально еще в другом месте откуда вы знаете что если тета площадку пойдет вы сможете восстановиться контент это сложная сложная тема особенно если у вас его много если у вас его немного делаем регулярные rising делаем снапшоты если у вас его много то лучше всего эту штуку реализовать сразу на уровне приложения пусть у вас заливается фотография пусть вас заливается какой-то файл который заливается пользователем ли обрабатывается после этого после выдачи уже данных контента пользователя сделайте чтобы вот в данном в данный момент этот файл дублируется уже на резервную копию вам не нужно будет тогда регулярно копировать всю пачку изменений раз в день раз в час и так далее одно действие оно простое оно делается незаметно для пользователя потому что candida там уже отдается просто фоном файл переливается в другое место другую площадку который независимо от основной ну и очень часто штуку который мы видим это то что бы капица база бы капица контент и не покатятся конфиге в итоге падает дата-центр падает сервер нужно восстановить сама восстанавливаемся из бэкапов мы восстанавливаемся из у нас есть backup кода у нас есть backup стадик и нас есть все клево но у нас очень очень сложная конфигурация веб-сервера и не следующие несколько часов команда этого проекта занимается тем что восстанавливает по памяти конфиг или пытается восстановить конфликтом дух годовой давности как сказал резервная площадки должна быть связана с текущим до центром существует риск того что резервная площадка станица это уже следующая тема извиняюсь как бы вот есть резервное копирование есть резервирования разные вещи выбор площадки для резервирования резервная площадку не должна быть связана с текущим до центром потому что очень часто мы видим когда кризис к основному серверу и берется резервный сервер в том же месте то есть там условно говоря 5 тот же самый hitler где у вас есть одна машина в стойке и вторая машина стойки выступает как резерв да она защитит от аварий самого сервера но она никак не защитит от аварий в 72 центре в целом если мы выбираем резервную площадку к основной чаще всего люди хотят сделать так чтобы оно было дешевле потому что она не получает трафик нужно понимать что после переключения на резервную вы можете какой ситуации когда вы останетесь ненадолго и если вы считаете что она не можно прожить час на ней не не получится прожить день или больше лучше уже подумать о том стоит ли так делать вопрос мы частей для резервирования на запуске проекта очень не хочется поднимать ту же самую архитектуру которая есть на продакшене то есть пусть вас там десяток серверов на продакшене для того чтобы поднять резерв вам нужно поднять 10 таким же серверов в другом месте и не фактически ничего с ними делать можно можно попытаться поднять не 10 серверов и дисков опять серверов и пять серверов раз про летний трафик но мы есть встречаемся с двумя вопросами первое это синхронизации между разными раза центрами и проблемы связанности между ними и второе когда случается авария в одном из них получается что пять серверов принимают трафик который должны были раньше принимать 10 и проблем с нагрузки все равно происходит и если у вас то площадку умерла на долго вы находитесь на этих пяти машинах в перегруженном режиме довольно долгое время штука которую часто используют люди это так называемый гибридные облака у вас есть площадка которая под продакшеном и у вас есть в облаках минимальная минимальная конфигурация способные только для того чтобы принять репликацию с продакшном площадке если нападок на площадке случается какая-то авария облака стелется вверх для того чтобы стать такими же какая была площадка и на них переключается трафик в процессе долгого времени это будет несколько дороже чем железный продакшен но в процессе использования в регулярном режиме когда у вас аварии нету вы на этом резерве экономите время и при этом не рискуете кроме деньги притом не рискуете тем что можно попасть в какие-то проблемы при переключении важные штуки при резервировании прежде всего нужно понимать какое время у вас займет это переключение нужно понимать насколько целостные данные о синхронизируется на резерв и нужно понимать какой риск простое при переключении очень и очень сложная процедура которая люди не любят вот как мы я говорил до этого проверять восстановление бэкапов это в принципе просто нужно также регулярно проверять возможность переключения на резервную площадку нельзя невозможно сделать резервную площадку и на ней и ждать только того момента когда на нее можно переключиться существует миллион вариантов из-за чего резерв может не сработать самое простое просто что-то не запланировали при проектировании резервные архитектуры да если мы переключимся без аварий и там что то будет не так проект упадет но это будет хотя бы осознанный риск ночью или какой-то тихий час когда это можно сделать чем когда вы переключившись в момент аварии узнаете о том что у вас чего-то не хватает какие-то файлы не синхронизировались какая-то база отставала и так далее в общем подводя итоги slave это не backup backup том же дата-центре это не backup резерв том же дата-центре это не резерв backup который не восстанавливали это не backup bk без статике это не бог а потому что люди просто будут не знать что они же с контентом если не хватает места это не отмазка очень часто мы слышим да ребята нас плохо с бэкапом у нас сейчас не хватает места мы решим это через неделю буквально на днях клиенты которые собирались решить проблемы через неделю потеряли два сервера там было дополнительно резервирование которые мы сделали которое помогло но будет очень обидно когда вы подумаете что вы вот неделю думали когда же у вас найдется время сделать бэкап и в эту неделю взять серверов с нелли за 60 лет за 60 евро с двумя терабайтами дисков вместо этого вы этого не сделали потеряли данные которые стоят гораздо дороже я решу про бэкап на на днях эта фраза которая ведет к потерянным данным это один шаг уже до потерянных данных ну и важно понимать что все эти штуки они не работают если нет команды которая будет найти штуки реагировать эти штуки делать чем должна быть эта команда эта команда должна быть у вас внутри она может быть немножко снаружи но сыр должен быть какие то люди которые и внутри понимают как это все работает и что должно быть они должны понимать внутренность продукта и должны иметь возможность локализовать проблему они должны быть вовлечены в компанию в команду ваша компания просто потому что чаще всего по закону подлости аварий происходит ночью в какой бы той зоне вы ни были и когда человек просыпается от звонка руководителя или от звонка там партнера или смсок аварии он должен мы не забить после положить трубку а понять что происходит беда и там нужна его помощь это не должен был отдать потрясающие стрессоустойчивости потому что иногда особенно на запуске проекта таки эсэмэски приходят каждый день первые полгода чаще всего это на старте это разработчики задатками админа который и знаю как работает код и могут поправить и знают как подключить сервер чтоб она заработала и должен быть экстраверт и просто потому что если вы с ними работаете или вам нужно с ними взаимодействовать очень неприятно ждать в течение 30 минут или часа пока человек разберется но он при этом об этом не говорит то есть ты говоришь вася как дела вася не отвечает лучших если хоть кто-то в этой команде есть экстраверт некоторые скажут ребята вот он так так так итак мы делаем это все сейчас исправим все это не работает без организации да эта команда есть но нужно понимать что в эта команда поддержки она очень часто работает в практических условиях пришла авария которая раньше никогда не было и товаре исправили нужно обязательно понять как это авария случилась как исправили как сделать так чтобы больше не было если мы исправили аварию не поняли как мы это исправили мы фактически не исправили получим еще одну такую же если у нас случился инцидент который не был за мониторинг мы должны принципиально понимать что вот случилась авария она не была за мониторинг значит первые шаги которые должны быть сделано это мониторинг сервера мы не только положение что такой аварий больше не было такие команды очень не любят бюрократию на момент борьбы с проблемой на момент решения проблем но дальше нужно добиваться формализм формализации того что было проведено формализация всех этих процедур как как работать на поддержке вот такой штуки на запуске вашего проекта на стать этому будет просто эсэмэски ключевому людям и телефонные звонки людей которые не спят и смотрят постоянно как это работает затем это возможно дежурство людей внутри команды или каких-то дополнительных людей для старта подходит двое через двое по 12 часов но долго люди не продержится просто потому что те кто будут работать в ночную смену у них вполне возможно есть жены дети семьи и когда они отработают с восьми вечера до 8 утра это я говорит пасты из жизненного опыта в 10 11 трое их эти же самые жены и дети семьи и друзья начнут звонить и горит там вася пойдем дальше и очень тяжело вот момент ее спать и понимать что тебя просто ной жизни не остается просто из процедуру которая из опыта у каждого из людей которые получают allure ты должен быть минимум три телефона критических эдик для оповещения которые которые он должен позвонить и сообщить это что проблема один телефон могут не взять два телефона не могут не взять три телефона но чаще всего я я не помню случаев когда при трех телефонах при трех телефонных звонках не брали трубки до плотные метрики которые можно смотреть по поддержке уже через долгое время это alert сапир ор потому что нужно понимать что ситуация когда у вас нет аварии на живом проекте довольно редки ситуации всегда что-то происходит нет а вот количество инцидентов которые происходят в период какого-то времени в час в неделю в месяц зависимости от масштаба тоже метрика за которой можно следить если у вас в течение последнего полугода было пять инцидентов в неделю а в течение последнего месяца у вас 5 инцидента в день это значит что что-то происходит не так и нужно черноту же расследовать время проведены на серверах возможно вас там 20 серверов и на одном из них проводит значительно больше времени чем на остальных возможно не садиться сама команда это не видит возможно вы это не видите но на этих серверах что то есть еще можно разобраться штука которую мы недавно сделали для себя мы стали записывать саши есть это не для контроля для того чтобы вызвать и аварии понять в чем же причина нет не вспоминать как что я делал в панике последние полчаса пытаясь быстро совершить хирургическую операцию а просто посмотреть снова найти то что было сделано записать сформулировать и понять еще про работу это уже больше суток если несколько ключевых людей летят на одном рейсе в самолете сервер и обязательно упадут нужно следить за тем чтобы ключевые люди так или иначе кто-то оставался в доступе для серверов люди которые получают эсэмэски идеально чтобы у них было как минимум два способа связи с я понимаю предвещать телефонные звонки быть с ноутбуком починить как минимум два способа связи при себе потому что хотя через 100 работать повсеместно телефоны теряются телефон может упасть две симки уже уже уже более надежная защита идеально если на эти же симках будет достроен в директ на недоступность на другого человека который будет на это отвечать на последние жизнь таких людей тяжела любите их оцените вместо выводов просто сделать проект и запустить не работает если вы верите в то что вы спланируете архитектуру подготовить и самый проект подготовить и код запустить и все будет работать нет если приедет живой он постоянно меняется человек но не нездоров всю жизнь у него появляется болезни у него колецки это болячки за мониторить и больше никогда не упадет тоже не работает мониторинг это просто штука которая будет вас оповещать о том что происходит зарезервировать и не проверить не работает зарезервировать за мониторить но не организовать службу поддержку не работает пусть у вас прилетает очень много land of если никто не знает что с ними делать будет непонятно что делать дальше вот спасибо за доклад вообще очень тонко по теме такой вопрос у вас сервис вы поддержка извне мониторинг выкопать забуду на каком этапе храмом обычно приходят ну то есть понятное дело что со старта поднимающийся неделю 2 месяца от роду он не идет вам среднем вот как бы теперь твой близы такая вот у нас здесь этой конференции это и не знаю где грань между там пиаром и я на смотрите по сути то какую услугу предлагаемые то абонента с очень дешевый платежом у нас как раз чаще всего это от стартапа до проекта который понимает что команду 5-6 человеком позволить уже можно то есть что такое служба поддержки в большом-большом проекте это вот как я говорил двое через двое в спиде файлу коллега которая сказал что них есть двое через двое которая дежурит и 12 часов но это тоже от и там рано или поздно люди скажут они больше так работать не могут а значит это еще больше трое человек по 8 часов смены но то есть условно говоря там человек 78 в штате до этого времени наверное лучше обращаться к грамотным подрядчиком то есть когда они а нижняя границы наверно это когда вы понимаете что стоимость платежа этим подрядчиком это значительно меньше чем проблемы связаны с новым займом это необязательно в денежные проблемы это могут быть какие-то имиджевой условно говоря если это мобильный а по это могут быть там за единицы звездочек когда упала об этом уже если какой-то проект про которого пишут сми чтобы не было новости о том что все упало и так далее то есть я понял жгли до момент ваш заказчик уходит от вас то есть он вырастает в растет растет растет и том какой асхаб понимаешь что ночью буду платить вот им и когда я могу дешевле у себя держать людей но это должен быть этим большой размер ноги какое-то недовольство нами небо спасибо спасибо большое доклад хотел уточнить в какой момент вы начинаете звонить вот этим вот важным людям был тоже какой-то момент и работал над проектом тоже отдали на аутсорс админом и вот это действительно ночные звонки а не надоедали потому что звонили даже в случае если потала репликация то есть до какого уровня вы пытаетесь починить сами сами и только потом уже позвони сначала звоним много на каждое такое поведение спрашивает звонить или в следующем таком случае но потому что понятно что мы когда давайте ним и давайте это такая не как там кажется когда такая команда поддержки работает на первом этапе сама достаточно высокий риск то есть может быть там есть бэкапы за последние 20 дней они занимают много места на место заканчивается роду их удалить но может быть в банку которого бэкапы должны храниться навсегда если вы удалите вот эти бэкапы вы нарушите там принципиальное какие-то положение работы бизнеса которые вредят всему поэтому на первых этапах такая команда должна постоянно долбать ну извините а со временем на каждый такой кейс должна стать галочка ok здесь вы можете разобраться сами окей здесь вы можете разобраться сами как бы хоть система самообучающийся да да да у вас кучу сидят тоже инженеры у него г ну да у нас нас как бы скажем так команда поддержки начинается обычно с того что получает эсэмэски пока инженеры спят есть команды которые занимаются тем что этих инженеров нанимают на фриланс где-то отдельно но нормальный уровень это когда инженеры сидят в офисе и они не спят и сидят перед панелью когда приходит оповещения да нет ночью тоже ребят все это инженеры но ул abstract и команды до знаете ли вы проекты которые реально удовлетворяют всем правилам которые вы звучите кроме вас конечно нет мы тоже но мы нужно понимать что у нас есть разные разные компании и нужно понимать что когда компания зарабатывает деньги когда она растет у неё чаще всего вот пул вещей которые падают на операционную деятельность он значительно выше чем это операционная деятельность способна но что-то сделать соответственно всегда есть какие-то штуки которые хочется которые компания на там наш клиент решает в первую очередь и которая какие-то которые она от лагает позже абстрактная команда может например пока руководство просто нет времени развиваться с backup ами взять и начать бог аппетита к себе потому что взять сервак который предлагает большую сторож куплю 1 комн отец не это стоит 150 евро от этого получится там 2 терабайта вместо того чтобы ждать пока клиент возьмет себе бы копны и машины можно взять и начать это лить себе вот так или иначе всегда есть какие-то штуки которые требуют взаимодействия взаимодействие в период роста но ну может быть привлечено внимание на другое место и здесь какие-то проблемы возникают идеального идеального нет конечно надо стремиться к максиму хотя бы вот придите кто связан с там с технической деятельности у кого есть проект продакшене придите и проверьте чтобы копы действительно но работают не работает хотя бы чтобы у них вот размером backup нам хранилище он соответствует тому сколько должен быть и backup а потому что сама простая штука это архив который делается вниз как обойти заливается уже последний год я продолжу эту тему же затрагивает вот в бокалах человека а получилось ли кого-то новый заказчика там клиента довести до этого идеального состояния которое написано ну хотя бы там семь процентов 80 процентов того что выход описано то есть ну то есть есть резервные копии если за верование дата-центра ну то есть такой вот получился за все время за сколько там 80 процентов да просто я все время как бы она немножко недоволен тем что как это все выглядит и хочется еще лучше поэтому у меня вот есть его женщине что не могу сказать что да получилось потому что всегда есть но как бы еще лучше сделать и второй вопрос вот в слайдах было написание инструментом мониторинга что используете вы у себя то есть а мы дизайн сам описанную штуковина числе найду то есть общей общение ничего стороннюю не у клиентов есть запись сын клиентов из графит и мы их продолжаем использовать тоже но у нас просто сама система мониторинга работает таким образом что нужно работать с ней если там у вас просто собственный проект то вот я говорю получается если вы хотите меньше проблем но меньше там клевых fi что это за пикс скорее всего а если вы хотите больше клевых вечно готовы к тому что вам придется покопаться в разных в разных штуках то это графит то есть как бы ваш сас сас и новый такой внутренний заз который когда-нибудь мы хотим сделать публичным но там поняла бизнес пока что все это спасибо"
}