{
  "video_id": "87V6nyMWdB4",
  "channel": "HighLoadChannel",
  "title": "Как devops исчерпывает себя, и что будет дальше / Кирилл Вечера (Jetware)",
  "views": 4451,
  "duration": 3434,
  "published": "2017-04-22T14:48:26-07:00",
  "text": "транс этим так у меня зовут кирилл и чары вы уже узнали я руководитель проекта четверо чем там дело мы разработали и развиваем дальше систему автоматизированного управления серверными приложениями это включает навсегда и сборку тестирование диплом эксплуатацию апгрейды вывод из эксплуатации я раньше занимался и занимаюсь сейчас системным программированием начинал solaris free bsd linux потом был работал заниматься созданием интернет-сервисов обычный web-сервисы то есть начиналось все тогда ещё ничего другого не было на усе 1 java питон руби то есть в принципе знают боль разработчиков боль администраторов но вы боль системных программистов которые вынуждены работать все вместе а что мы делаем в твери наша система то есть это сама конфигурируются автономные приложениях и рабочие окружение что это такое это значит такой набор программ который работает в ответ операционной системы и работает одинаково в дебри бы вы их не запустили ему нужно только ядро linux начиная там от 26 32 в принципе все высшим ничего не нужно вот на чем и буду рассказывать и расскажу во люцию систем управления вот систем управления как распределенных систем так на самом нижнем уровне то есть на уровне программы и зависимостей вот он ищет какие инструменты сейчас есть какие появляются новые как по какой причине они развиваются как мы этому способствуем ну и собственно почему devops будет не нужна вы тоже прикладываем к этому руку так что такое современная система ну я исхожу из того что здесь собрались любит и холода то есть любители хайло до системы нормально большая сложно то есть много серверов много приложений немного связи это сервис-ориентированной связи много библиотек много компонентов много программ и она конечно же растущая то есть оно не закостенел у вас в ее развивает и вы обновляете и любая современная система большая современная система это большая проблема то есть если у вас есть система то вы столкнулись проблемы то что у вас будет проблема управления проблема обновления ваши жили трудные сейчас коротко по теорию совсем коротко чтобы согласовать термины значит мы рассмотрим три системы три типа монолитная система распределенной жестко связана и свободно связаны что такое монолитная это самый простой вариант когда у вас все компоненты жестко связаны и выход любого компонента из строя он влечет то что система перестает работать полностью распыленной система если у вас чуть на хотя бы на один компонент больше чем необходимо у вас система сразу стал распределенной у вас может быть несколько связей между сервисами может быть несколько сервисов и уже здесь система делится на несколько уровней с их уровня абстракции значит макроуровень микро-уровне что такое микро-уровень это типы компонентов сервис и здесь они красными кружками обведены и топология связи между компонентами но эта в любовь способна системе то есть вот есть компонент это кирпичики то как из не построен дом это уже сама система значит микро-уровень это то из чего состоят кирпичи вот что ночь любой компонент любой микро-уровень это является монолитной под системой чем быть нами кроу не развалилась компонент узел вышел из строя должен там заменяться жестко связана системе все у вас работает жестко все связи предопределены все сервисы привязаны к железу то есть они могут например каких-то случаях переноситься с одного места на другое это все заранее жесткую предупредил системный администратор который например с помощью там шефа либо настроив pacemaker заранее указал какие сценарии как именно по каким правилам меняются роли компонентов системы свободно связанная система тут все совершенно по-другому все может меняться могут меняться связи между сервисами может меняться привязка к оборудованию могут добавляться убавляться компоненты все происходит должно происходить автоматически значит постоянно автоматически централизованного централизованных на самом деле только потому что сейчас так удобнее полноценных растленных систему которые быть были pure toupper таких ну принципе нет вот значит как только у вас система управления вышла из строя у вас система и свободной связаны превратилась в жестко связанную то есть когда система управления работает что-то поломалось поломалась все почему на самом деле свободно связанных систем сейчас эксплуатируется мало потому что их сложно проектировать сложно настраивать а не глючат они то хотя бы просто сложно создать то есть сейчас настоящее время создали нормально сложно систему только ну там google там кто-нибудь еще то есть сейчас эти проекты делают каждый сам под себя вот но есть такая вещь как эволюция управления то есть развиваются существующие инструменты появляются новые все движутся вперед чтобы у нас с эволюции начал значит были руки то есть вы все набираете вручную потом значит как запись этого опыта появились скрипты то есть место уж повторять много одинаковых действий в это все в на 70 скрипты скрипты тоже имеет свой предел сложности когда у вас много серверов много разных нюансов появляются средства инфраструктура и скот инструменты для того чтобы можно было автоматизировать управление же большого что сервисов это по 5 шеф sultan's был его еще там десяток на других назовете сами что дальше дальше следующий уровень сложности когда появляется свободное связано системы нужный инструмент для того чтобы им управлять значит у нас свободно связанная система намного сложнее и для нее должны уже быть инструменты управления на двух уровнях то есть первый уровень это макро уровне то есть там где связываются сами вот сервис и кирпички вот и нужно средств управления на микро уровне то есть то что организовывать работу самих сервисов внутри самой собой населенной системе требования совсем немного то есть она должна разрешать автомат позволять автоматическое управление должна свободно перемещать сервисы на оборудование вот и должна свободно позволять добавлять убавлять разные компоненты то есть если вы добавляете новые серверы она должна их внести конфигурацию и расправить между ними нагрузку само изменение связи там например так шучу при балансировке нагрузки ты чтобы она тоже могла переносите руется этом масштабировать их и правильно связывать клиентов и сервисов у компонента у него все намного труднее значит у него три главных требуем на требования приноси мастера жирности интерфейс значит первые два понятно что такой интерфейс это интерфейс с микро уровня на макро уровень 3 чтобы компонент сообщил наверх управляющей системе о себе что он внутри есть как нему обратиться ну где он хранит данные то есть у кто ему должен поставить некое хранилище и куда его смонтировать в принципе самым пионером вот во всей этой области тот который вывел все на массовый уровень оказались сама зон web services то есть они значит что сделали они приучили людей вот к этим четырем вещам то есть люди стали воспевать уже как нормальная то есть не какое-то экзотическое дело а что с этим можно работать и так правильно то есть это разделение на сервисы то есть из низких например монолитных систем ну скажем без 2 3 сервисов можно делать микро сервису которую намного больше стоит намного больше неизменный образ виртуальных машин gt был имидж и хранение данных отдельно вот эти два тесно связанных элементом но я здесь расписал отдельно потому что хранение данных отдельно это для нормального человека который занялся разработкой скажем 10 лет назад вот эта вещь достаточно нетрадиционная ну как-то краники то данные отдельно но вот любой чего который начинает расти в масштабах по управлению по конфигурации по управление сервисами вот он понимать что без этого никак то есть где то данный хранить придется отдельно amazon как приучил то что у него когда-то куда они только появились со мной часто вопрос был у меня при загрузилась машину куда делись мои данные ну и несколько экземпляров сервисов это очевидная вещь то есть куда вам нужно масштабироваться вам нужно чтобы сервисов было могло быть несколько то есть хоть два хоть двадцать кроме амазона хорошим таким пионером который опять же подтолкнул эволюцию казался докера они сначала для себя разработают систему для своего платформы за сервис вот потом посмотрели что получилось прикольная вещь довели это дома сделали за это инструмент разработчика потом посмотрели решили что это хорошо и выглядит of production для того чтобы под докером работали нормально продавший системы вот и докер контейнеры они у нас как раз по всем требуемым подходят к требование микро компонентом которая показала раньше то есть это во первых конечно замена виртуальной машины то есть они зашли здесь в нишу amazon а вот и для тиражирования и повторяемости значит докер дает такую вещь то есть как докер файл который позволяет быстро собрать с изменениями нового варианта предложений до пирса позволяет с тобою вместе тиражу масть и главная вещь и это интерфейс то есть интерфейс так а к себе контейнер сообщает наружу значит на каком порту он слушают на каком он оказывает сервис и где он хочет видеть данные опять же докер стимулируют используйте my table мяч из все у нас значит выполнено все три вне компании русалку у нас реальной системы чем у нас происходит дальше дальше у нас эволюции уже делать нормальный полноценный шаг появляются системы управления свободы связанным системами оркестрация по сравнению со всеми предыдущими тремя шагами руки скрипты инструмент и инструмент автоматизации инфраструктуры с регистрации процесса 3 введения систему он намного сложнее вам нужно что получить рассмотреть инструмент для регистрации которые вы имеете рассмотрите требование к вашему проекту совместить их тщательно придумать спланировать как вы это будете реализовывать протестировать воплощать значит арсенал сейчас но он не очень разнообразной то есть и самих на самом деле система регистрации по названием есть много но они production большинство либо не годятся вот либо они какие-то такие узкоспециализированные вот атак с того что есть хорошего значит это просто безусловно леди руку вернетесь марафон метод марафон это ну так то есть его можно использовать но только если вы зачем-то знаете что он именно вам лучше подходит чем повернетесь докер swarm я здесь написал просто потому что он это дань уважения сейчас вы использовать нельзя и не рекомендуется зайдите почитайте багрепорт и то есть лучше почитайте человек репорты чем писать их самим а вот мы посмотрели что у нас на макро-уровне все хорошо значит у нас пошла появились системой регистрации что на микро-уровне тайсо монолитной системе что у нас собирает приложение напрашивается вывод что докер потому что вроде другого ничего и нет докер отличная вещь докер он делает вот ровно то что он делает он прячет в контейнер прячет на 4-ку сложную сущность и отдает из нее интерфейс вот эти самые глазки и носик с ротиком вот эта сеть и валуны вот мы конечно начинающий программист начинающий администратор когда видит докер он думаю что не в контейнерах вот находит вот такое приятное существо реальности находится на что такое с костылями кривое странное но вы наверное сами видели на dockers кому там хобби пример докер файлов то есть как самый специально для кайфа выглядит куру из него направляется вывод в сша и потом еще могут там для так для украшения десяток configure макин стал цепочек но вы исходники конечно клеммы для техники вообще никто не чистит за собой вот значит но докер на самом деле он вообще вещи очень классно поэтому то что я участвую пошутил к бы этому просто куб ну над ним можно шутить вот докер он и подтолкнул эволюцию вообще управление сложными системами подтолкнул хорошо то есть после докеров уже появился в тогда нормально каберне this это докер повернитесь не было ну время он может быть и был тогда не знаю но ему не очень было управлять вот на чьи то есть docker и потолком кубер нить из каберне this толкает эволюцию вот эта зеленая линия толкает ее выше но сам докер он эволюцию на микро-уровне он не затормозил просто потому что он казалось бы решил всю проблему то есть вот он все же стал паковать внутри свою контейнера больше ничего делать не нужно вот что такое на микроуровне нормально приложение сервиса а вот она часто обновляется то есть вы все время там что-то добавляете новое имеет много зависимостей на программы на библиотеки накинуть ресурсную файлы там картинки и так далее вот она при этом имеет еще версии на разной зависимости потому что с каким-то вверх вот работайте нам с какими-то работать и плохо вот плюс на четыре компонента кто-то находится внутри их нужно как-то между собой интегрировать и наверх отдавать информацию о том что у вас где находится значит что дает докер для управления микро уровнем он дает простой способ установки программы тур контейнера в принципе его во многих случаях для для простых хватает там вы можете просто шоу команда запускает можете из него устанавливать пакеты rp москве близко вы можете в более сложных случаях уже запускать там какой-нибудь полноценное средство deploy инфраструктуры способ обновления него есть слои тут все хорошо все отлично отлично кто-то может жаловаться но чу жаловаться вас другие варианты есть нет вот нет это серьезно то есть их вариант вот совершив и сам он уже в реально приближается потому что можно нормально полноценно использовать вот но есть будет еще такие вещи как интерфейс на макроуровень вам нужно прописать конфигурацию связи сервисов их нужно прописывать руками для маленького проекта это нормально для большого это уже сложно вот насчет dota вообще он или вы реально хорошо легко использовать маленьких проектов почему собственно у нас сейчас т.е. стартапов много если активно использует докер значит докер модный вот goes to the poker подходит отлично потому что вот кода мало все вдруг его помещается легко проблем с масштабированием нет то можете запустить какой-нибудь там ну чисто для того чтобы поэкспериментировать запустить кластер на 10 микро сервисов посмотреть как она работает вот вам докер фая подойдет все с ней нормально если у вас работающий проект которому год-два 10 лет вам просто так докер файл не подойдет ну потому что у вас всё намного сложнее тут здесь на конференции помаду несколько человек или рассказывают или будут рассказывать о том как они пишут свои системы свои обвязки для того чтобы собирать докер контейнеры быстрее лучше и автоматизированные то есть просто докер для большого проекта не подходит вот а это история про нашего потенциального клиента которую мы сейчас хотим перевести в реальные клиенты значит это компания американская занимается разработкой софта для корпоративных клиентов вот это значит business intelligence это много разного количества программ часть одинаковой частью разные то есть намного кастомизация под клиентов вот то есть порядка 100 150 проектов которые они ведут значит и они за время своей жизни еще купили несколько там компании диска стартапов или там продукт компании у которых тоже были свои подходы к написанию софта вот сейчас на что не в такой зоопарк то что у них используется тут он и чем они пишут значит oracle sap hana джалла этого принципу то что у них самое основное все остальное по мелочи вот imagemagick например он у них нужно потому что куплю какого-то стартаперам который делал много отчетов на php мой скалы и мечи мальчики но у них есть много крупных клиентов но это дело поэтому они это дело конечно же поддерживают они пытаются интегрировать перевести ну на какой-то общий код но это требует времени чего зря тратить его если есть были интересные дела строители клиенту только и грешники лпм пакета поставляли гкмп пакеты в red hat и workle сейчас постепенно переходит нас авторы за сервисы на виртуальной машины вон примется ими легче управлять их легче контролировать следов которые выполняются программы значит что у них было писать был организован процесс разработки значит у них был особо to build серы в 1 разными операционными системами значит и система начали внедрять все континенты гришин будут поставили jenkees поставили паппет но более-менее то всё работало но были проблемы то что у них они не могли часто тестировать у них все равно были отличие тестова окружения рабочего состава масса процесс сборки что то нужно было делать вот почему они решили перейти на saas и виртуальной машины потому что не могут себе обеспечить ту среду которую они хотят а вот забыл сказать раньше но вот например одна из проблем то есть для них это не проблема для них то было преимущество они у себя много чего red катарского подсели сами подсели для чего для того чтобы у них были свои для каждого клиента у которого ни на что собрали мы софт и знают что него все работает чтобы у него таки работала чтобы если они вдруг для чего-то про патч или lipsy но какого-то другого клиента чтобы этот патч был только у того клиента чтобы не переносить автоматом вот это все все изменения на те клиентов которых ничего не ломалось но стандартный принцип не ломайся не трожь значит это предлог на проблему что у них очень много разных вариантов надстроек над операционной системой вот и они решили что нибудь будет собирать все свои виртуальной машины значит им нужно еще больше тестировать потому что в важность тесто понимают все то есть большинство понимают меньшинству их делать но по крайней мере все к этому стремятся и ищут решение это выстрел и воспроизводимость сборки значит им нужно собирать быстро не собирать лишнего оставлять то что уже собрано и желательно не связано с дистрибутивами то есть чтобы больше контролировать то какие компоненты находятся у тебя вот здесь я расскажу маленькую историю значит этого случилось с подвесом в этом году весной наверное вот эта история про кришны значит некий некая компания перешла у себя сара hello то ли с 5 на 6 то ли 6 на 7 и у них после этого полетели индексы на поясе возраст не причем раскатами причем причем только стечение обстоятельств то что в липси по в новой версии липси поменялся способ которым аннигилируют колышек для сортировки упа сброса значит в базе слетели индекса никто не ждал подвоха но такое случается вот поэтому от связанности дистрибутива этого в каких-то случаях реально очень важная вещь вот и они хотели похоже что-то на мы винды griddle потому что они очень много пишут на джаве они познали все преимущества как это хорошо вот и хотели чтобы было что-то такое же тут только с пуговичками для linux для windows они пытались не нашли как бы но они windows и не патч от в итоге какие варианты они стали рассматривать джуджу charms и nix кто знает джуджу charms два человека но в принципе его можно не знать потому что это canonical о вск любым тучный проект вот но он в каких-то случаях хороший вот этим ребятам у не подошел просто сразу же я тогда нибудь про него рассказывать то есть вывод уже не используйте он особо хорош он боится production на нем dataart даже нан сервал что он этим летом лета и осенью какой-то большой проект для целиком а стал делать вот но это очень дешевое решение и равно на самом деле сну скорее всего только до тарту это может щекам он подойдет вот никс гораздо интереснее вещь вот один человек не знает кто еще знает nix avana но у человек десять вот это уже кстати намного лучше я даже подумал что будет наоборот вот значит и людям действительно выбрали nix то есть вот как это может показаться немножко странно что такие хардкорный корпоративные писатели софта вот и взяли наш такую-то такую немножко экстремистскую система что такое никс как сами начнет пишет о себе никс и это реализация функционального программирования в управление пакетами это офигенная вещь вот я просто когда про них узнал и тут полгода назад я стал его большим фанатом то есть хотя не нами конкуренты вы лучше но они лучше в другом и я вообще реально книг с вам рекомендую использовать тоже если вы найдете под него соответствующие задачу значит nix он сейчас состоит из менеджера пакетов никс который появился раньше и из никто с nexuiz это операционная система это дистрибутив разновидность три пути в linux который примерно тоже что debian или там синтез федора вот но он собран по другим принципам принцип это вот и самые чистые функции вот пакета то есть любой собранный пакет в никсе это функция от четырех компонентов от названия версий пакета значит отправил сборки от исходного кода 5 компонентов и от конфигурационных значений если поменялось начать любое из этих значений the necks будет считать это новым пакетом системе могут одновременно находиться сколько угодно пакетов там разный варианты зависит разные варианты сборки разные варианты конфигурации при сборке они все могут существовать отдельно и выбираются уже в момент когда этот пакет будет использоваться непосредственно при выполнении какой-то программы значит что такое чистая функция вы представляете нормально вот отлично у них сам все состоит из пакетов lipsy тоже пакет отдельный пакет и липси может быть десять лет каждый пакет это отдельный каталог который находится на фиксированном понятном месте и он readonly пакет собирается по зависимостям он может сниться из репозитория это уже есть либо я начну если его нету автоматом соберется из исходников по правилам сборки 2 ключевая вещь которая вот даже 1 включила вещь которой финиксе это его значит концепция пользоваться их окружением поиска окружении это . объединение нескольких книг с пакетов в нечто одно целое значит у вас например если у вас есть задача запустить сервер mais que al вот та полисы окружения это будет набор но примерные сотни пакетов начиная с мой скала вот если вы его зависимость которые нужны ему фронтами то есть зависимости там заканчивая lipsy а начиная примерно не к тому же там не стобой там пакетов 50 вот но если например хотите еще и мана использовать вот кто у вас там накопится пакетов больше то есть это все пакеты которые нужны будут того чтобы мой сквер мог запускать все свои бинарники которые в нем находятся значит и это пользу окружении она полностью отвязанный от операционной системы то есть во первых вы можете то поиска окружении переносить на любой другой сервер главное чтобы там было достаточно версия и педро вот но у них по моему тоже начинают 26 32 то что они поддерживают и работают начну и в пользу и окружения примерно по такому же принципу как как и сами пакеты то есть по сути это тоже польза окружении это некий пакет в который запакованы которые помещаются ссылки на другие пакеты на те пакеты которые на поиски окружения используют я сейчас может быть вас гружу но я даже на рисунке еще покажу как это выглядит на схеме вот может быть станет понятнее вот и что такое на 4 5 что еще хорошего в этом окружении то что она транзакционный то есть как создает добавляется или удаляется пакет из окружения это копируется текущие напоминаю readonly окружении то есть вы его сами там нет не можете вот иванушка пирует менеджер пакетов добавляет в него новый пакет и удаляет из него пакет и меняет сим link с вашего старого с вашей старой версии рабочего окружения на новые это на самом деле вещь тоже достаточно хорошо используется в продакшене значит и пользуется окружении внутри она практически полностью повторяет стандартного начального файловых иерархии стандарт значит ну стандартный suse linux царскую россию файлов то есть начать с бен ли ты цели include шире алибек файлы практически полностью повторяет любой любой существующей unix вот нет war нет tmp нет лук потому что рабочее окружение но readonly и писать туда соответственно ничего вот и все что находится в рабочем окружении это либо каталоге либо 7 линки на на пакеты которые использует рабочее окружение и вот как это выглядит то что он в галочки никс profile это вот сама точка сборки то есть это точка входа в рабочее окружение из нее сиреневенький sibling ведет в конкретный вариант рабочего окружения вот она там 0123 называется ice rink вот я начнут полностью не стал всё весь der листинг приводить вот-вот может посмотреть на счет бен у нас сейчас системе используется в этом пружине используем тебя два пакета значит москве и php вот из них значит я использую больше значит это того что я показал то есть ли все здесь не показываю на 4 бен у вас есть мой сказал д это sibling этот sibling ведет на ведет сначала в каталог 456 мой стоил в котором находится вся иерархия ну которую вы полученный пример макин стало после сборки мой sql а вот он ведет туда начинаю бен мой сказал д с таким образом загружает вливает из всех пакетов которые он использует вливают июльское окружении все файлы вливают их 7 линками то же самое значит не только с бинали библиотека тоже влево это логично угрозу образом и все другие типы файлов то есть например маме штате американская разрабатывающая софт компания когда она поставила nix вот оно значит пришло в каком состоянии сейчас порядка 200 машин 180 который занимается с автор с сервисом и для cantina стиле грешен они еще используют при дички машины в амазоне когда они там есть пошла пошла волна изменений нужно еще быстро их протестировать вот и для управления не использую такую комбинацию значит nix доки руку вернитесь кабинете с ними использовать нужно для того чтобы управлять стартом остановкой значит всех этих в докторских машин значит них сын обеспечивает разные варианты рабочие рабочей среды работы и тестирование программ докер здесь только нужен как прослойка для того чтобы укреплять и знал что у него где есть что ему где запускать как ему к этому обращаться ну да и доктор конечно используются для привязывания пирсе стэнд-ап данных о боже некие функции доктора не используешь там докер файл он состоит из двух строчек выбрать выбрать нужную нужно версию ник из окружения дальше все остальное ночник сделать уже сам вот значит принципе это создали все устраивал них оказалась проблема то что бы уникса все-таки именно из за того что это чистая функция есть особенности работы версий и очень долго или трех случаях и приходилось ждать результатов тестирования то есть там при изменении в зависимости требуется пересобрать компоненты вот и требуется представляют по какой причине чит несколько говорил это та самая чистая функция значит если у чистой функций поменялся аргумент то у неё поменялось значения значит next чистая функция от всех зависимостей там не только прямой зависимости x пакет и только прямых зависимостей вот а от всего что у меня находится в глубь иерархи то есть вот конкретно здесь примерно вот у нас есть мозг у него где-то там годы независимости может быть ли все время то москвы конечно прямая зависимость на лепсе вот о могла бы быть там какая-нибудь на другую библиотеку там которая там редко используются не по средствам случае из вас просто поменялся lipsy вам нужно пересобирать нужно будет пересобирать и mais que al значит кроме мы сказал вам нужно будет пересобирать все остальные программы которые имеют зависимость на лепсе значит и для тестирования это нормально для системы для операционной системой потому что алексей у вас меняется не так уж часто другие пакеты системные тоже меняются не очень часто но это просто кошмар если вы пытаетесь использовать nix именно для картину с integrations то есть если у вас например 150 200 проектов как он там 50 этих проектов это общие компоненты которые где-то используются вот это значит что при тестировании если у вас поменялся какой-то там середине компонент вам нужно будет в концепции никс и пересобирать абсолютно все компоненты никс предлагает хаки как этого избежать но это именно хаки и тут нормально способа решить проблемы и просто не это принципе потому что такая идеология nix но для всех остальных случаях из них подходит отлично вот значит соответственно эти ребята они стали искать альтернативу никсу которая вот имела бы все что есть хорошего уникса вот и имела бы еще плюс такую вечность чтобы они не перес обирал а те вещи которые не нужны пересобирать который можно оставить то есть работал с версиями работу с условиями по версиям вот стали рассматривать нач новые варианты кто значит такое gentoo это просто проверяю честных насколько все предыдущие люди честно поднимали руку вот сейчас подняли руку на примерно четыре зала я вот ни за что не поверю что только четыре зала знаешь такую gentoo ну ладно я не буду росла что такое gentoo то есть gentoo эта операционная система то есть у нее есть зависимости есть любители этой системы есть you противники вот но вот конкретной компании gentoo 1 матрица и сейчас как полноценный вот как ну скажем альтернативы ониксу и конкурентном может быть они в итоге выбор для того чтобы собирать систему учит habitat habitat это летний анонс всеми любимого шефа вот который на самом деле больше маркетинг а в реальности его использовать смысла нет он очень сырой я прыгну тоже рассказывать не буду вот значит просто финалом как бы промежуточным финалом работа хоббита то случилось то что последний месяц шеф значит и предлагает в качестве стандартного пути использованы уже использовать не habitat сам по себе со своим супервизором экспортировать habitat в докер файл и чтобы уже он работа внутри докера а кто знаешь такое habitat ну вот знаете что пока хоббита тоже использовать нельзя вот и третья вещь не то есть bento использовать можно и нужно винту отлично начат habitat у них офигенно хорошая край красиво подано идея но она просто не выпустили очень сырой вот они может быть через год через два раза виду это намного лучше на 4 четверть это то чего делаем мы вот и про что тоже будут рассказывать я познаешь такой джетер правильно только один человек которому я вчера это рассказывал значит джеттер он во многом похож на никс то есть эта система это менеджер пакетов вот система сборки и системы управления рабочими окружениями вот значит то же самое как в никсе нас все состоит из пакетов пакеты readonly имеют версии могут быть разные варианты сборки и там в одном физическом скажем системе там в каком не там физичка мужчине может стать сколько угодно разных билдов разных версий одного и того же пакета значит пакеты имеют зависимости и могут либо подключаться автоматом из репозитория либо если репозитории нет автоматом собирается по зависимостям единственный пакет который не собирается автоматом это bootstrap бойтесь и потому что его нужно будет тратить что еще нас значит есть общего значит есть реестр и настроек пакетов в nexia в гитаре каждый пакет может иметь сохраненный в нем и дефолтный это значение то есть например дефолта значения порта на котором должен что-то сервис слушать вот и те значения которую может при сборке тут то собирает их решил поменять вот но кроме общем есть еще и отличие от нас пакета это не чистые функции у нас пакеты больше похоже ну на пакеты в традиционном смысле то есть они в третем с мыслями ведут например этом тот же рпн или где бен то есть они имеют версии вот и зависимость их могут быть на диапазона версий что есть еще и заточена че ты та самая интеграция пакетов вот я про него расскажу чуть позже вот но смысл-то сам интеграции в том что когда в какой-то рабочий кружение устанавливаться низко пакетов и если эти пакеты имеют намерение друг друга конфигурировать то не то делать автоматически пакеты капсулированных значит в никсе в рабочее окружение вливаются абсолютно все содержимое пакета вот у нас это больше соответствует подходу языков программирования которые оперируют модулями значит вы можете импортировать модуль и из него только те символы там те функции которые вам нужны вот у назначит пакет он всё себе хранит но в рабочее окружение отдает только то что считает нужным то есть например бинарники и шарит labels все остальное он хранит у себя внутри и окружение у нас не readonly то есть рабочее окружение у нас хранит себе настройки хранить себе контекст хранит себе данные тапку тут и прошу прощения это просто меня остались лишние словить лет сокращал все сильно сокращал пакеты четверо все компоненты наш пакетов это модуля и программы и библиотеки значит то есть мускулы лепестки все это пакет и единственное чего у нас нет чего что есть европе маху нас ниццы кличке зависимости они просто полностью ломают логику работы и с на шесте мы несовместимы на 4 что такое у нас рабочее окружение это тоже . в которой связываются все пакеты вместе в ней хранятся настройки пакетов в ней хранятся данные пакетов которые сами программ в этих пакетах меняют и это рабочий выражение но полностью отвязанный от операционки то есть липси свой все остальное свое а че вылет рабочий кружение так пакеты здесь значит наружи они readonly данные все внутри пакеты и the namespace и есть как я говорю начнут по схеме модуль они экспортируют в рабочее окружение только необходимый минимум значит все данные хранятся в самих самих пакетах значит необходимый минимум который экспортируется это бен бинарники shared library и в данном случае пока все значит экспорт как случае с них сам делается 7 линками изменяемая данные работу чуть чуть по другому принципу и на что сама пакета не является но по сути как шаблоном и в рабочее окружение копируются в неизменном виде и дальше уже могут меняться именно в рабочем окружении отличит но в рабочем окружении они находятся в своих на мисс пейсах и это нужно для того чтобы исключить конфликт например по именам между разными приложениями и для того чтобы он просто бы облегчить работу администратора чтобы если кто-то хочет посмотреть логе москве л.д. чтобы он значит они всегда находится значит в лоб москве ld и дальше подкаталоге значит есть он хочет посмотреть состояние логов яндекса вот он смотрит их в на экспрессе которой относится гибсон то есть тоже там лоб ginex и так далее вот пакеты могут за между собой взаимодействовать и это на самом деле которую раньше если например москва хочет то есть имеет у себя man файлы то он экспортирует их автоматом в самом в саму рабочее окружение а он их экспортирует приложению маны если система uman установлены он этот экспорт примет если она системе нет то отношения не устанавливается и все man файлы они их система не видит очень кроме этого пакеты могут еще вот кроме обмена данными между собой они могут изменять друг другу конфигурацию то есть если система установился что пакет который хочет поменять портман gdb вот он у себя в метаданных говорит что я каким-то образом меняю конфигурацию и как только они вместе установились изменение сработала роли пакетов вот это тоже эта вещь которая у нас отличается от микса на и space на самом деле у нас относятся некими не пакета ок роли вот а роль это ближе к языкам программирования это можно назвать некий класс некий класс который реализует какие-то методы доступа к себе относитесь мы посмотрим здесь у нас есть мой сказал д это ночники это роль пакета которая должна что обеспечить то что в ней есть сервер майской л.д. это что этот сервер работает по протоколу маску и лаги выполняет все функции конкретная реализация вот их 10 4 то есть перк анна-мария db значит оригинальным и склеил да и фейсбук узкими мой рокс для того чтобы все остальные программы могли не заботясь об этих различиях работать напрямую только с майской л.д. именно введена это самая роль то есть им не мне нужно делать свои отношения между разными типами разными именами пакетов вот и кроме значит собственно ролик который нас является классом у нас есть еще такой вид ролей это как некий транзитные роли то что языках программирования зывается абстрактный класс вот здесь конкретный пример как это работает значит у нас есть три веб-сервера это тапочки джинсы и лаять и теперь и это именно роли то есть это полноценный серверу которые имеют много чего то разного но у них есть значит и нечто общее это то что они являются web серверами и они как правило могут создавать virtual host который по какому то определенному пути какой-то правильно путь файла системе связывает именем с has неймом вот это та самая общая их вещь оно вынесено в абстрактную роль в в и поэтому . любая программа которая хочет любое приложение которое хочет создать виртуальный хост вот она это делает и прописываем разные там конфигурация на файлы для всех трех типов приложений вот оно это делает только один раз для вот этого самая абстрактная роли для ввс на сообщает что у меня например в таком-то каталоге вот я хочу чтобы там был сон какой-то виртуальный хост и уже дальше сам в в автоматом экспортируют в подходящем видеть для конкретного приложения в это само приложение а что если в системе установлен джинкс то в в отдаст данные зиму если установлена патч данные попадут уфа патчу что получилось в том что мы сейчас сделали на что для американской компании разработчика демонстрационную установку то есть она там есть сейчас их софт конечно не покрывает на покрывается совсем небольшую часть вот значит но мы смогли сделать до них быструю систему тестирования которая позволяет пример там их для мир 50 вариантов сборки рабочих сред меня в рабочих окружений позволяет очень быстро создавать тестовую среду значит с типичная рабочий пружине естественной среде это 300 500 пакетов каждый пакет собирается в каждое рабочее окружение собирается от 3 до 20 секунд значит 20 секунд вылезли это для тестова окружения с лампам потому что там около 10 секунд пеку собирает какой-то большой xml файл со всеми модулем который есть внутри вот то есть просто собрать земля чиста работе уже не это три от трех до десяти секунд на 4 мы для них также сделать тестовую систему который автоматом перемещает нормально протестирована пакеты с ним до встречи в принципе на самом деле ничего удивительного что они в итоге получили у них сократилась три раза число машин которые занимали искательница ты грешен использовались у себя на площадке и практически не перестали использовать amazon носки машины потому что у них оказался большой излишек своих собственных ресурсов значит поменялось значит система сборки только там значит вместо микса из приложения стали с стала собирать нашим система при этом да практически полностью из них сам по за местном верни из их скриптов сборки взяли скрипты раскрыты сборке приложения значит из никольского формата в нашу то есть это там длилась даже автоматически вот это значит такой вот они еще посмотрят что у них с gentoo получится и тогда будут принимать решение продолжать там с нами работать дальше или нет может быть и решил с нами теперь посмотрим дальше это вернемся назад к эволюции на счет какой на жизненный цикл сервиса так как у нас сейчас администраторы уже во многих типах разработки исключены из депо и вот это на счета все начинается нас разработчика вот здесь идут раз два три 4 5 7 этапов которые во многом либо делаются вручную либо настраивается вручную и каждый из этих этапов о нем может либо что-то ломаться вот либо что-то 3 путаться вот это та вещь которая реально сюжетно замедляет процесс укладки нового новой версии приложения и вот это все это на самом деле можно автоматизировать так чтобы это делать вообще без участия человека вот это он сейчас просто будет либо посмотрим чего низко вопрос а нужно ли у нас операционной система программе вот даже не обязательно там большой бы это был там ник сриджит вот вообще как само понятие программе операционных систем и сейчас не нужна не нужна только едят рода того чтобы зарядиться на сеть для того чтобы открывать файлы а больше the prison системы ей ничего не нужно программе нужно рабочее окружение то есть те библиотеки и те другие на камеру by на рынке с которыми она работает но это не взять нужно быть операционная система вот например ламп включает около 500 пакетов и он может обходиться без операционной системы то есть вот enix это показывает ее мы это тоже показываем значит должно ли программа строится в притон систему тоже не должна нам нужно находиться где угодно главное просто чтобы вы могли каким-то образом эту программу запустить то есть нам нужен нужно самом деле сервис discovery который бы эту программу указал вот unity стандартный сервис discovery фиолент это поезд papas и теперь значит смотрим уже приходим чуть чуть более сложным вещам вот попробуйте включить немножко фантазию и представить себе как работ устроены процесс unix а вы примерно знаете вот теперь представьте себе что у нас вместо процесса unix это контейнер с неким набором файлов значит адресное пространство процесса то есть это самый каталог контейнеры в котором слух замкнуто сегменты кода этого процесса это гордон ли файлы которые находятся в пакетах которые находятся длина используя этим приложением сегменты данных то что мы меняем это либо там временный файл в нпф с либо постоянное хранилище контейнер который например случае докером и там через volum подгружаем вот и динамически ли венков и библиотек когда мы запускаем программу вот это подключение в контейнер и сборка к нему всех пакета зависимости вот и данном случае начинать любой пакет работает примерно как шаре библиотека то есть любой шарик или файлы тори данный каталог значит сегменты коды данных это у нас файла кто находится в каталоге и все зависимости пакета вот они эквивалента тому что у нас для обычных процессов идет динамика линков к при запуске эльфа вот и что таком случае может у нас быть программы вот если мы перешли лужу ткнут новым принципу комп новым понятием к новой налоги и значит у нас программ на самом деле это только имя с версией просто как способ адресовать и лю саму программу значит зависимости для сборки это примерно то что в секции dynamic link and carphone зависимости для работы и . вызова на какой порт к этой программе этому сервису можно обратиться или какой файл внутри этого контейнера нам нужно запустить тогда на макро-уровне у нас объектом диспетчеризация уже может становиться не докер-контейнер и может стать просто вот это самое имя и версия и дальше для того чтобы запустить эту программу значит мы просто каким-то образом обращаемся по имени версии устанавливать этой зависимости и дальше наша система регистрации должна суметь воспользоваться например либо никсом либо jetstream либо там котятам 3 системой собрать либо взять существующий образ для этого имени версии либо собрать его по данным данным который метаданных находится то есть по всем зависимостям собратьев вытащить из этих метаданных интерфейс то есть порт на котором то программа слушает и куда она хочет записывать данные и после этого ввести система регистрации значит как могло бы вылет такое предложение вас участвуем то что то рассказал на последних этот 5 слайдах это уже была не та что мы сделали то есть мы сделали пока только на микроуровне вот на макро-уровне это то что мы сейчас планируем делать вот как должна будет такое приложение это вот примерно здесь вся седана которые могли бы быть или того чтобы запустить пузырь сорский кластер значит который будет сервисом для того чтобы там скажем обслуживать нам хранение гиа тегов юзеров можно спрятать его как мета пакет значит он указывает себя зависимостях другой пакет который содержит дальше в себе еще больше зависимости на по сгрыз на а фигура цию кластера и 2 зависимость это сторож ssd то есть это некий другое пакетные в другое приложение которое должно поставлять данные при установке этой пакеты в одну и ту же работу кружения они друг друга снабжают конфигурации снабжают данными и передают их например сторож ссд сообщает класс труп адреса где именно он хочет хранить свои данные там и какие-то дополнительную которые ему для этого нужны как это тогда может работать дальше регистрации ты сколько еще будет вылить п в процесс диплом разработчику себя например в гите бегает новую версию как только кто-то ссылался на какой-то сервис сослался на этот пакет который совпадает который подходит по условиям и по по условиям версии вот автоматом как раз таки есть вот то после этого автоматом собирается от нуля сервис помещается в подходящий для этой системы регистрации контейнер запускается отдается в discovery если на этот сервис никто больше не ссылается вышла новая версия то приходит сборщик мусора останавливает сервис но который не то будешь не ссылается все сервис остановился то есть на микроуровне следующий у нас ступень это самосборка роботы вытесняют devops of разработчики и администратор возвращается к тому чем занимались дальше к своему основному занятию и не делаю тупую работу роботов что будет дальше это пятая ступень эволюции самоорганизация вот тут осталось уже время кончилось вот это еще и там часов десять ну и никто не знает что там будет все"
}