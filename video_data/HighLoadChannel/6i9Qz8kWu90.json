{
  "video_id": "6i9Qz8kWu90",
  "channel": "HighLoadChannel",
  "title": "Определение атрибутов и визуальный поиск в UGC-фотографиях одежды / Дмитрий Соловьев (Mail.ru Group)",
  "views": 316,
  "duration": 2374,
  "published": "2018-08-16T04:39:15-07:00",
  "text": "всем привет меня зовут дмитрий соловьев я представляю компанию mail.ru где работаю ведущим разработчиком в отделе рекомендательных систем и сегодня мы поговорим с вами о том как сделать контент рекомендательную систему по сути дела это достаточно полезный experience с точки зрения того что не всегда можно ориентироваться только на поведение пользователей иногда приходится оперировать контентом например если вы работаете так называешь в точке холодного старта то есть когда вы практически ничего не знаете о пользователе не знаете никакое приор информации о нём мы сегодня поговорим о так называемом пугаться контенте одессе контенте то есть это контенте контенте которые генерируют сами пользователя и как использует этот ужасе контент дальше можно строить рекомендательная система ну в общем немножко так немножко в сторону потому что зачем вообще это все надо именно для того чтобы потому что оборот система оборот в онлайн продаж одежды составляет на данный момент вот порядка там 100 миллионов в год и таким образом если к нам приходит какой-то пользователь это вы в общем то не надо наверняка мы объяснять но так чтобы было для затравки вот что когда там приходит какой-то пользователь нам каким-то образом нужно его удержать при этом если мы достаточно короткий срок опять же таки не сделали каких-то правильных действий то есть вероятность что этот человек просто уйдет с нашей площадки на другую площадку и таким образом мы понятное дело не до получим прибыль вот задача осложняется когда у нас есть проблема холодного старта когда мы в общем-то не имеем никакой априорной информации про пользователя и таким образом как бы нам в общем-то ничего ему предъявить но в этом случае в этом случае вот вообще-то мы хотим все-таки понять чего же хочет данной точке пользователь и сделать какие-то правильные действия чтобы удержать его вот в этом случае мы ставим задачу примерно следующим образом что есть у нас то есть мы можем ориентироваться на событиях которые сгенерировал пользователю вот сиюминутно то есть что происходит пользователь может вводить какие-то запросы пользователь может просматривать какие-то айтемы а вот и таким образом мы базируясь как раз вот на этом на этих действиях мы можем сделать ему какую-то рекомендацию вот то есть задача ставится примерно следующим образом что пользователь смотрит какой-то ну не знаю такого плана сланец не сланец босоножек и мы хотим использовать какую-то априорную информацию наши априорные знания о том что если пользователь смотрит не знаю там такого плана обувь то если мы ему порекомендуем что-то похожее то велика вероятность того что пользователь перейдет на это похоже и дальше останется в нашей системе или приобретет эту вещь вот проблема заключается проблема заключается в том что мы работаем с контентом пользователя то есть эта площадка где пользователи сами просят свои фотографии сами как бы анонсирует их и у нас нет каких-то жестких правил соответственно какая проблема проблема в том что там очень мало например текста то есть как правило пользователь сфотографировала себя там где-то в зеркале запостил фотографию но и никак не описал что там написал что там белая рубашка например а мы из этого есть должны сделать какие-то выводы сделает правильные рекомендации тем пользователям которые приходят чтобы купить этот товар а вот или просматривает товар поэтому информации даже тексты у нас как таковой нету и мы хотим используя только картинки сделать хорошую правильную рекомендацию на самом деле если вот эта проблема как бы она решена уже давно то есть по идее чтобы сделать хорошую правильную рекомендацию нам нужно наш контент неважно текст это или скажем там картинка преобразовать в некоторый вектор признаков верное пространство дальше в этом пространстве мы можем сделать какую-то миру близости вот например это может быть евклидова и расстояние не знаю там косинус и собрать какую-то базу данных из наших товаров вот то есть от нас каждый товар будет представлен вот этим вот и номерным вектором и дальше запрос который к нам приходят мы тоже превращаем в мерный вектор и ищем по нашей базе все достаточно просто вот теперь хочется понять а как вот эту простую задачу нам применить на наношу переложить на нашу задачу то есть сделать поиск хороший поиск по картинкам и сделать хорошие хорошие рекомендации картинок тут нам напоят на помощь в общем то приходит уже всем известные свёрточная нейросети которые себя представляют запер позицию конвенционных фильтров down sampling of и и дни линейных преобразований результате мы можем результате мы подаем на эту сеть картинку и дальше последовательно из этой картинки выделяется какой-то набор фич и по этот набор фич он мы можем управлять как какой набор fitch мы хотим получить с помощью того что мы в конце нашей сети можем определять нашу функцию потерь то есть для чего мы и порно что мы и обучаем вот немножко как бы сторону то есть если мы возьмем cnn канва лекционный нейронная сеть и посмотрим что у нее там внутри-то это для тех кто в общем-то не знает о чем разговор но то в принципе на каждом слое кондиционный нейронной сети выделяется свой набор вич то есть на первом слое как правило там выделяются достаточно простые фичи то если вы посмотрите это вот нижний слой да вот этот нижний слой этого слоя один не нижняя нижняя картинка слой один слой 2 слой три и так далее ты здесь принципе представлена визуализация в и g19 и в принципе видно что допустим на первом слое выделяется достаточно простые фичи то есть черточки какие-то простые линии вот а соответственно чем выше мы поднимаемся тем фриче становится сложнее то есть на втором слое уже выделяется что-то похожее на текстуры на третьем тоже и на самом деле на самом верхнем слое у нас уже выделяются практически куски изображения вот то есть эти куски изображения нам они уже используются для того чтобы сеть правильно проводила классификацию вот если мы посмотрим на последний слой нашей сети вот он он то он из себя представляет здесь представлена тоже конвекционная сеть которая обучается предсказывает тысячу классов вот последний слой сети тоже представлены си представляет из себя некие мерные векторы в данном случае это тысячи мерный вектор вот который соответствует нашей задачи то есть если мы то есть если мы вернемся к нашей проблеме и скажем что мы хотим получить вот этот вот этот вот вектор из нашей сети то есть тысяч тысячи мерный вектор и он должен каким-то образом конвертировать нашу картинку вот в этот фича set the мы говорим что давайте возьмем хороший dts and который который обладает хорошей диверсификации и соответственно обучим нашу сеть вот на этом дата сети то есть самый известный datasette на котором обучаются все сетки он и он достаточно хорошо известен он и известен под именем очень эта вот там присутствует порядка тысячи тысячи классов и соответственно больше миллиона различных картинок на отличных изображений то есть если мы обучаем сеть на вот этом вот дата сайте то мы получаем хорошую диверсификацию и хорошее представление наших мечей вроде все просто и если мы результате что мы хотим получить если мы возьмем наш и час et fecit фиг че вектор с конца нашей нейросети и скажем так возьмем класс there'sa наше пространство на в нашем пространстве вот эти вот виктора то мы получим некоторые точки в этом пространстве где буду куда будет попадать именно товары похожие товары до похожие товары и мы вроде должны получить что-то похоже вот на вот эту картинку то есть каждой точке у нас получается похожие какие-то товары вот но это идеальная картина здесь на самом деле это визуализация сделано то есть на наши 1000 мерный вектор еще сделано сделан некоторые преобразования с помощью тсн я и мы получили двухмерную такую картинку на каток где собрались такие вот кластера соответственно это наши как бы мечта которые мы хотим получить в результате того что мы возьмем вот этот вот свечи вектор из нашей канализационной сети вот теперь в реальности в реальности это происходит примерно вот так вот то есть мы берем фичи из нашей канализационной сети вот дальше строим базу вот как у я описывал раньше вот загружаем это все в базу организуем поиск и пытаемся запросто же преобразуем в некоторый печи вектор и осуществляем поиск видно что в результате получается то есть в результате мы видим что в общем то она находит что-то похожее то есть вот первый первая картинка это запрос в в полоски вот это вот это запрос на это ответ что мы нашли то есть видно что в общем то мы находим что-то похожее но похоже на пример лица этих людей может быть это один и тот же человек похоже то что это все как бы вот надето на манекене в принципе даже немножко структура похоже но то что нам нужно то есть нам нужны были например длина рукавов одинаковые нам нужно было одинаковое одинаковые воротники у одежды это мы не нашли например вот если посмотреть нижние картинки то видно что у них рукава как вы достаточно сильно отличается то есть 1 пуске короткие рукава 2 блузки как длинные рукава в общем то не особо интересно в первом видео первом варианте там видно что воротники очень сильно отличается то есть это вообще разные как бы виды одежды вот что какой выход новых от на самом деле тоже как бы достаточно простой то есть это сделать банально свой классификатор вот классификатор одежды то и взять взять всю одежду разметьте примерно вот таким образом то есть если мы хотим если мы хотим чтобы у нас находились одежды с одинаковыми воротника и мы говорим что давайте классифицируем воротники если мы хотим чтобы у нас находились одежды с одинаковыми паттернами то есть одинаковыми рисунками принтами там и давайте классифицируем от эти принты если мы хотим чтобы у нас были одинаковые рукава на при поиске одежды там и соответственно говорим давайте еще классифицировать рукава у этой одежды вот и таким образом мы можем создать некоторый класс некоторые некоторые классификатор который будет классифицировать рукава одежды от рукава соответственно воротники талию там паттерн и вот все все как бы здорово вот первое второе второе нам нужен datasette вот datasette мы в нашем случае собрали откачав достаточно большое количество известных онлайн-магазинов вот и в результате сделали на этих с помощью асессоров сделали разметку то есть первый шаг это мы сделали разметку на атрибутов на вот этих у на вот этих вот скачанных изображениях то есть мы сделали разметку выделить по 4 атрибутов с каждой одежды то есть это воротник талия потом паттерн паттерн и которые там встречаются то есть принты и соответственно рукава то есть внутри каждой категории внутри каждого атрибута были свои категории категории которые мы размещали они эксклюзивно не пересекались ну то есть они были да не боись они были и пересекаем ими да вот соответственно таким образом мы собрали порядка там 200 тысяч изображений вот и на этом все хорошо исключением того что теперь мы пришли к тому а какую же нам все эти обучать то есть к сожалению в г.г. например если ее обучать то она давала достаточно не очень хорошее качество и мы остановились перед выбором того что какую сеть взять вот если посмотреть на график того как происходит происходили соревнования вы начинаете то видно что в принципе здесь постоянно происходит рот качества то есть в по оси абсцисс у нас отложено года вот и соответственно каждый год видно что качество она становится все лучше и лучше то есть ошибка уменьшается вот но если с той же стороны посмотреть на то как растет глубина этих сети это видно что с каждым годом и глубина сетей растет вот на самом деле нам интересен вот этот последний вариант когда глубина сити стала порядка 150 двух слоев ошибка томск ушла по моему 35 до вот причем эта ошибка если интересно то она стала ошибка классификации становится приблизительно одинаково или там уже меньше даже чем делает ее человек вот на самом деле нам нет интереса как бы обучать вообще сеть с нуля мы можем взять уже обученные сеть ну например какой то сеть вот из этого класса вот если интересно то вы gaga это был 2014 год вот она вот здесь вот как бы было вот нам интересно вот сеть из этого класса и мы можем сделать простой трансфера лёнинг либо что-то либо известен как fine tuning вот дальше мы остановили свой выбор на архитектуре рискнет вот немножко я напомню что это такое то есть принципе ресниц представляет из себя струг набору таких вот блоков то есть и так два канва лекционных блока которые замкнутые так называемыми шутка там вот и сеть и вот эти блоки они учат неполную функцию игреку здесь вот только остаток от того что осталось от вот этого шутка то есть по сути дела таким образом поскольку это сделать легче вот как мотивирует автор это глубина таких сети может достигать и до 1000 слоев плюс на самом деле если сделать еще некоторые трюк вот который позволяет нам уменьшить размерность количество параметров в сети то есть это добавить сюда еще одну к инволюцию один-на-один вот в принципе мы таким образом можем уменьшить количество параметров у глубоких сетей и например ресниц 101 в принципе месту один слой занимает имеет меньше параметров чем резни где видно чем в игре 19 до причем имеет параметр в три раза меньше и к тому же она как бы обучается быстрее занимает меньше места на gpu что нас в общем-то и устраивает вот дальше ну вот таким образом мы да мы пришли к тому что мы хотим построить наш классификатор на базовой архитектуре резне то как я уже сказал мы не обучаем под каждый класс отдельный отдельный ресниц отдельной сетку мы все наши классификаторы группируем в одной сети то есть по сути дела мы делаем что-то вроде такой большой головы и каждый каждый атрибут представляем классом то есть вот 1 2 3 4 и в каждом классе у нас получают в каждом атрибуте мы делаем свои категории и на каждую на каждый такой как бы классификатор мы мы обучаем с помощью кросс энтропии то есть у нас получается на выходе сумма кросс энтропии по каждому классификатор вот и не таким образом видно что после того как мы обучили нашу сеть это вот эта вот синяя линия мы прогнали изображение с различных источников вод который не участвовали в обучении видим что они нас а они ведут себя стабильно на протяжении всего процесса обучения вот и вот что мы в результате получили то есть финально мы комбинируем из наших атрибутов один большой печи вектор вот он получается размерностью количество категорий суммарное количество категорий которые мы определили в наших атрибутов вот и в результате получаем примерно следующую картину то есть первая картинка это запрос верхние картинки это то что мы получаем из базового фича вектора и начинает а нижней картинке это то что мы получили обучив наш классификатор вот базовые вот эти вот видно что здесь картинки они появляются совсем не в попад поскольку здесь участвует природа той она вытягивает на самом деле природу вот здесь уже получаются картинки те которые нам нужно то есть видно что у нас воротники как бы одинаковые видно что у нас рукава похожие видно что у нас форма то ли это же попадает вот единственно не попадает свет но в принципе эта задача тоже решается решается с помощью того что мы можем брать печи из нижних слоев на жизнь нашей сетке вот но второй пример когда мы хотим получить воротник запахом и соответственно без чтобы у этой кофты не было руку рукав и рукав и был определенный поттер вот вы gaga опять же айда в игре нам вытягивает опять непонятно что вот наше решение она вытягивает достаточно приличные рекомендации вот и третий вариант то есть этот вариант вы видели вот изначально то есть видно что здесь опять-таки первые более-менее что-то похожее но тоже опять же таки воротники в этом случае воротник не попал в этом случае не попал у нас не попали рукава а в нижней части и попали и рукава и воротники и именно в том то что нам нужно вот ну для тех кто как бы мало понимает в одежде но хорошо понимает в машинах то в принципе эту живую технику можно применить там для других объектов то есть именно например для мы используем ее еще для рекомендации вот автомобилей то есть видно что если мы напрямую используем фичей в игре то здесь она находит вообще непонятные машинки но которые как бы не относится что там у нас не помню как это автомобиль машина марка машина называется но в принципе здесь вот внизу нашлась именно эта же марка машины вот что показывает что в принципе этот подход он работает не только как бы на одежде но в принципе его можно и использовать для рекомендации как бы других видов товаров вот на самом деле все было бы так просто если бы не было так сложно как поскольку я говорил что это все-таки учись и вот контент вторая сложность это то что помимо того что у него нет как бы атрибутов в описании у него еще и фотографии как правило плохого качества то есть пользователь постит фотографии например под различным углом вот например фотографии плохого качества то есть вот сам себя в зеркале снимают и пусть оттуда эти фотографии с описанием блузка такая вот дальше может быть например вот так вот половина закрыта изображение вот либо например вот на природе люди снимаются особый особую сложность для классификации как привык вы понимаете представляет вот такие вот изображение где просто несколько человек стоит хотя это и одна и та же busco но один одноэтажная одежда вот все равно как бы для классификации эта штука на классификации эта штука будет работать плохо вот какой выход выход тоже вроде бы валяется под ногами нужно просто взять и локализовать наши объекты вот наивный подход наивный подход к локализации это мы берем размечаем наше множество в принципе даже нам размечать его не нужно есть такой datasette называется diffusion там этот datasette уже имеет достаточно большое количество баллов буксов вот или так называемых ограничивающих глюков прямоугольников на различных видах одежды то что он из себя представляет и то есть изображение на этом изображении выделены помечены какие то какие то виды одежды и они обведены балтику боксом вот наивный подход понятное дело мы можем решать эту задачу если нам нужно например блузки то мы можем задачи решать эту задачу с помощью обычной регрессии то есть мы можем опять же такие натренировать нашу канализационную сеть для того чтобы он предсказывал координаты вот этого будет бокса то есть координаты например верхнего левого угла и ширину и высоту нашего ограничивающий прямоугольник вот казалось бы что при всем при том но этот подход работает очень плохо вот этот подход как видно что он очень часто лажает когда например происходит у нас полный рост фотографии видно что он пытается выделить там все фотографии поскольку мы используем из я как как вот функцию то и он выделяет что-то среднем на таких фотографиях он не выделяет либо вообще ничего либо бывает выделяет что какую-то одну одежду либо может растянуть эту балку бокс на все фотографии кто в общем то нам не особо нужно вот но слава богу у нас уже есть подходы которые как какой как который решил а то есть этот подход решило мировое человечества и в принципе есть продвинутые подходы которые позволяют выделять на одной картинке много таких вот боуден боксов и таким образом локализовать множество объектов вот два подхода на данный момент существует первый подход он основан на реген проползал и его и так называемые семейства методов арсен вот там есть просто cnn который работает очень медленно вот есть вас царстве н н и в а н н который как бы работает быстрее вот и второй семестр методов это основанная на приор бокс с вот это семейство отходит от wella и второй метод это ssd вот теперь нам нужно понять а какое же все-таки метод лучше я говорю что вот этот первый метод основанные на регион proposals он 2 проходные то есть по сути дела там происходит следующее что сначала сеть сначала нужно выделить регионы которые в которых наиболее вероятно находится какое-то какие-то объекты 2 это уже этот регион классифицировать и выделить паутин боксом вот однопроходные методы это и yellow и соответственно вот yellow и соответственно ssd они предполагают что у вас есть большое количество уже при дефолте дефолтных боуден боксов вот эти блондин бокс вы должны некоторым образом расположить на картинке то есть это делается за один проход за счет этого эти методы они гораздо быстрее но тут вот нарисована что эти методы работают и лучше чем походные методы ноту спорный вопрос тут зависит все от данных на которых вы эти методы будете тренировать вот немного о том как работает сенджу makibox детектор то есть ssd это как мы остановили свой выбор на нем потому что он как вы видите дает лучшее качество чем его вот и при этом работает быстрее вот он даёт примерно до 48 время в прессе то есть 48 фреймов в секунду что для нас как бы не мало важно поскольку мы хотим выделять икебану боксы именно в real time вот поставляется из себя из сингла счет multibox детектор примерно следующую штуку то есть это обычная канализационная сеть который убраны все слои вплоть до 5 пуль инга но здесь вот используется в г г 16 вот этот вот такой прямоугольничек активной линии обведём вот все full коннект это у него выброшенные у него выброшенные верхние коллекционные спа канализационные слои вот дальше на и на сверху на них нанизаны еще таки еще несколько конвенционных слой слоев вот на этот вы г.г. и вот эти вот дополнительные структурные блоки которые нанизываются на базовую канализационную сеть они как раз и обучаются вот мы их обучаем причем заметьте что они идут как бы с постоянным да он сам то есть сначала у нас там 38 потом меньше меньше меньше и вплоть до того что последний блок у нас занимает последнее канал канва люции у нас размером 1 на 1 для чего это сделано что чуть по позже объясню как это работает чтобы сеть видела изображение в различных масштабах вот и сетка заканчивается балдин бог детекторами и соответственно класс детекторами вот и после этого на все это еще нанизывается на макс на максимум супер шанс вот теперь как это все работает на примере одного такого структурного блока который надевается сверху на сеть то есть берем этот структурный блок то есть по сути дела на себя представляет некоторую канва лицу канва люцию которая состоит из выходов фильтров выходы фильтром это пять на пять в данном случае вот они вот и соответственно количество этих фильтров там может быть там например в данном случае это 256 вот дальше каждое вот этот вот выход этого коммутационного блока вот она вот эта клеточка а на самом деле ассоциируется с такой же клеточкой на изображение то есть понимаете чем соответственно меньше клеточек в изображении тем больше это этот конвенционный блок захватывает и дальше вот на вот этот вот в данном случае вот этот вот клочок взят вот к этому булочку привязывается так называемый дефолт бокса что они представляют из себя то есть каждому облачку привязана три дефолт бокса 1 дефолт бокс это обычный квадрат 2 дефолт box вот они пунктиром обозначены здесь 2 дефолт бокс это вытянутый прямоугольник по ширине и 3 дефолт бокс это прямоугольник по высоте вот задача как бы в процессе обучения подобрать выбрать нужный вот такой телефон бокс и адаптировать его под ground раз дефолт по под гром трасс разметку вот как это делается то есть берется на самом деле вот эти вот три дефолт бокса вот и вот эта фича мы по транслируется распадается как бы на две первое еще мы по она предсказывает координат 1 этот блочок размер который опять же таки 5 на 5 вот и мы выделяем вот этот вот блок который с которым мы работаем вот и количество каналов у нас получается количество классов на количество и фонд боксов и на количество параметров которые мы хотим предсказанных дефолт боксах то есть количество параметров это координата этого прямоугольничек а то есть левый верхний угол и плюс ширина и высота вот а второе структурный блок на который распадается базовый это блок который дает con венец внутри вот этих вот дефолт боксов и таким образом мы выбираем нужные нам дефолт бокса вот отсюда смотрим какой из них наиболее совпадает с нашим базовым блоком с нашим нашей базовой разметкой и по сути дела его оставляем и к нему еще привязываем вот этот confidence и дальше у нас на выходе нашей сети поскольку если вы посмотрите здесь их достаточно много у нас вот этих блоков по у нас выйдет дефолт боксов который подходит к нашей разметки получается очень много и мы к ним применяем так-называемый но maximus и прыщи то есть поскольку их много мы берем самый главный ifunbox у которую confidence самой большой например это 07 нашем случае вот и дальше убираем все все ifunbox и которые пересекаются больше чем 070 метрики ja кара мы их выкидываем просто-напросто что мы делаем со всеми остальными боксами которые пересекаются меньше то есть мы их добавляем или сэмплер у им их в наши обучающие множество как негативные примеры для того чтобы наша сеть обучалась не только предсказываете правильное решение но еще обучалась предсказывать и неправильные решения вот и таким образом вот что мы в результате получаем то есть мы получаем что задачу применяя вот это решение single shot multibox детектор в качестве выделения блоков одежды из картинок мы получили что он справляется достаточно сложными случаями то есть например вот здесь вот видно что человек находится как бы в движении он выделил его то есть первый случай достаточно просты простой а вот второе третье они сложные то есть на них как бы классификатора может ошибаться за счет того что локоть там подняты или еще что-то а здесь если посмотреть на нее на вот эту картинку то здесь вообще 2 2 персоны которые он разделил и выделил на них одежду и таким образом мы можем классифицировать теперь и такие виды одежды такие виды изображений вот что дальше дальше на самом деле еще лучше потому что мы хотим помимо еще то есть у нас есть сложные случаи то есть когда у нас человек повёрнут очень как то непонятных камере мы хотим лучше рассмотреть его воротник таким образом мы можем сделать выбор детекторы на одежду есть опять же таки мы можем взять скачать открыты to set at deep fashion да мы делаем марки уже расставлены можете можно расставить свои и в принципе для каждого выделенного изображения мы можем с помощью задачей регрессии опять же таки нейросети определять вот эти вот лент марки вот таким образом дальше когда мы видим например этих лет марок их всего 8 то есть право лево и соответственно на воротник рукава и как назвать подобное то есть низ где одежда у нас заканчивается то есть до какого момента смотреть эти вот и таким образом смотрите мы получаем как бы уже достаточно полную рекомендательную систему мы нашу рекомендательную систему от если там ну вот в данном как бы в первом приближении на 50 аксессуарах вот каждая ссср получил примерно от 20 запросов на проверку то есть и оценивали мы по бинарной системе то есть на запрос выдавалась 5 ответов я сесар должен был рассказать релевантные нерелевантный ответ было видно что порядка сорока восьми процентов вот из нашего на найденных результатов попадают в первые результаты вот что в общем то очень хорошо а если мы сложив сложим топ 5 первых то это под получается порядка 90 процентов мы угадали так все спасибо вопросы здрасте спасибо за доклад можете пропустила на чем все это реализовывали вы имеете ввиду какой ренборг какой фреймворк до на самом деле до рождества христова это был торчи вот чистый торт вот после того как появился python мы переписали это на python то есть это имеется ввиду что именно движок да на котором мы все это делали вот их продакшене тоже поэтому там продакшене тоже поярче но на самом деле он работает достаточно быстро и мы используем в продакшене gpu вот именно для преобразования картинок вот для понятное дело что для построения базы мы используем как бы offline устроим базу вот если интересно то для поиска используется 1 для поиска виктором похожих а я вот не совсем понял вот как бык имидже нету когда вы gaga 19 обучали добавили свои изображение одежды то есть вы сначала взяли при допущенную модель да и потом и ещё дополнить обучили на своих образцах правильно понял да смотрите сейчас секунду трубы да ну там был этот слайд может быть я недостаточно как его запустить да смотрите там все достаточно просто то есть вот то есть что мы делаем мы берем уже при добыче ную сеть да как правило это сеть обучается на и начинайте вот дальше выкидываем все наши всех конверт некондиционные слои и соответственно фу connected своей вот после этого мы добавляем свои консультационные свои ну то что я вам показывал начали то есть поскольку у нас нижние слои они как правило отвечают за печей нижнего уровня да то есть а верхний уже будет выделять какие-то куски изображения вот нам какие-то куски изображения не нужны то есть тысячи верхнего уровня которые могут отличить котиков там от собачек нам не нужны нам нужно отличать именно одежды вот эти свои верхние мы выкидываем и сверху ставим именно чистые свои которые мы обучаем а нижние слои мы не обучаем есть градиент по ним не идет соответственно вот таким образом мы как бы комбинируем два подхода можно еще не уточнения вопрос то есть с какого слое вы перестаете обучать то есть мы понятно полна связаны слои вы откидываете какой слой свёрточная вы откидываете для выше смотрите мы убираем был брали следующим образом что мы убирали и 1 с конца и второе с конца вот в принципе разницы нет вот сейчас как бы мы используем но выбираем только первый слой и соответственно полна связанной слои добавляем своей все но последний слой получается свёрточная и полна связанные с ней оставшийся замораживать и уже остальные оставшиеся замораживаем себе не обучаю все сказки больше"
}