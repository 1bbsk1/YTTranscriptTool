{
  "video_id": "0nL6T-OPtM8",
  "channel": "HighLoadChannel",
  "title": "Клиенту и серверу нужно поговорить / Никита Прокопов (Cognician)",
  "views": 1278,
  "duration": 3160,
  "published": "2018-01-16T13:30:22-08:00",
  "text": "спасибо всем привет никита доклад против на про клиент серверную синхронизацию в общем-то относится в основном квиббл потому что я сам веб-разработчик но касается вообще говоря любой клиент-сервер архитектура мобилок чего-нибудь еще игр например доклад в общем то про то что происходит на проводе между клиентом и сервером мотивация и доклада очень простая сердце технологии на данный момент развились до такого состояния когда они просты и удобны и быстрые можно брать и делать мы вот мы очень хорошо понимаем как писать сервер клетки и технологии они чуть помоложе там не так все устаканилось закостенело может быть но они тоже уже примерно приходит в состояние когда можно взять с полки какой-то библиотеку фреймворка сделать на ней проекты в общем-то даже получить удовольствие какой-то общаются они все еще на допотопном уровне запросами ответами сексом или чем-то типа такого и вот этот вот неравномерность прогресса неравномерность развития собственно побудило меня сделать доклад и здесь как бы в области общения как раз можно получить очень большое преимущество доклад состоит из двух частей первая часть такая образовательная в которой рассказываю как вообще идея мысль пришла куда двигалась мысль о синхронизации как то все дела сейчас вторая часть о препятствиях что мешает развиваться дальше чего не хватает в данный момент и прежде чем я начну есть небольшая тема доклад достаточно абстрактный мне хотелось что было что то что можно пощупать потрогать руками вот дима демонстрации является сама презентация движок на котором я показываю он сделал на принципах которых я буду рассказывать позже соответственно вот здесь в статусбаре есть url его там можно разглядеть наверное если хорошее зрение вот если по нему зайти вы пойдете на такую же презентацию которая будет следить за моими слайдами можно полистать слайды но нельзя забегать вперед можно лайкать каждый слайд отдельно вот там вверху будет сердечко количество лайков текущего слайда количество онлайн слушателей и будет кнопка задать вопрос собственно вопрос и там копятся и в конце презентации я смогу них ответить последний вопрос это всегда та же показывается статус бар что можете попробовать если интернет позволит вот первая часть когда движется мысль вообще о синхронизации данных начнут такого экскурса в историю небольшого статический веб как он начинался the web без java script от искры вы пишете html файл в котором там кита картинки css подключена но вы не можете динамически запрашивать ресурсы вот красота этого подхода в том что синхронизация данных здесь присутствует ваш браузер это программа который будет на вашем компьютере и нужно сходить куда-то далеко на какой-то сервер и как-то туда забрать ресурса но красота вообще архитектурой и 5 статической либо в том что вы оба не думайте об этом как о синхронизации данных вы просто пишете отчитывал страницу и когда загружаются у вас все эти ресурсы есть картинки показываться сейчас подключен и так далее то есть это как высокоуровневый декларативный и 5 который но никто даже не называют словом синхронизация а все вся сложность весь все детали весь процесс он спрятан под капотом реализован один раз разработчикам браузер вот у меня будет такая шкала абстракция сначала называл потом решу что слишком абстрактно называлась шкала декоративности в итоге я остановился на шкале уровни власти чем выше технология тем она более высокоуровневая чем ниже тем нет более низкого уровня вот эстетически вот на этой шкале несмотря на то что это как бы страшно примитивная технология по возможностям наш к уровню а он очень высоко уровня он предельно декоративен у вас минимум контролем деталями максимум описании вот такого собственно намерения чего я хочу и браузер как-то вам это обеспечит слеза статическим вам пришел web динамический так сэм лттб request x арест который там немножко порядок навёл над хаосом диким западом вот и он принес две вещи во-первых ты бы естественно динамический веб-камера черский кто можете запросить дополнительные ресурсы естественно он открыл дорогу целому новому классу приложений которые нельзя было в принципе сделать в рамках статического бы радость огромно количество возможностей но в то же время все те проблемы которые решал браузер потом добычи ресурсов от этих за скачивание посланию запросов обработки ответов какой то координации все что делал за вас браузер все это теперь это ложится на плечи разработчики то есть это одновременно и огромные возможности и огромная ответственность поэтому на шкале высоко уровне насти вот динамически в на уровне запрос ответа он очень низко находится такой яви параллельно я хочу рассмотреть граф келли это очень интересный случай это очень такая свежая технология совершенно новое и тем не менее он оказался оказалось концептуально это просто тот же самый рез только на стероидах да то есть не решили проблемы производительности они добавили спецификации там где не было спецификации то есть это технически это вполне хорошая такая инженерная штука годная она концептуально он остается на том же самом уровне это те же самые запросы и ответы и поэтому он только находится на шкале нашей рядышком технологии которые пытаются улучшить ситуацию двигаться немножко дальше выбираться из этой ямы это такие технологии корелы опала по учёбе и что она его они привнесли в этот процесс они привнесли сторож то есть там где граф келлер с эта спецификация только запроса и ответа который не знает ни о чем вокруг 10 мы также контролируем сторож сторож на клиентский сторож украинский сторож это такое центральное место через которое проходит вся вся вообще ваша работа с данными и вообще это некая абстракция который не было и которая появилась который вообще игра представляет вот этот набор данных с которым вы работаете то есть это просто больше не единичные запрос и ответ и которыми вам приходится как-то потом самостоятельно разбираться а это именно спецификация в том числе и на то как хранятся данные как что что вообще такое данные и это позволило удивительным образом сделать кучу принципиальных оптимизации которые были невозможны на уровне запроса и ответа то есть это все мы все еще пополняем тот сторож с помощью запросов и ответов на запросы уже гораздо оптимальные гораздо умнее не ну как бы движок оптимизирует их кэширует ответы там частично объединяет запрос и прочие такие штуки делают он также то что касается мутации он может синхронизировать ваши мутации фоне может делать оптимистичные апдейты офлайн-режим все это стало возможно потому что у нас появилась вот эта сущность которая и пиром не начинай приучать хочу происходит faq technology from завис похоже нет не хочу закрывать я свой долг не подключено велика но может его правда закрыть привычного не войдет с ответом на проблему можно сразу закрывать на 10 мин форс-мажор chic я могу с телефона показывать давай chrome снова открываем то что открывается бильярд экспандер поддерживает все современные браузеры пальцами кстати не знаем вы заметили нет там тета иконку с глазом было до количества онлайн слушателей а потом пропала сейчас понял что почему она пропала на самом деле изменилось на иконку offline но когда он ушел в офлайн он не может скачать эту иконку надо заранее a bit . лай слэш тонн ский тире fr типа front томске сложите река фар да да да видите bit.ly слышь томске терри fr fr не только очень катар это круто но она уже была открыта зачем придуман если есть папка с презентации вот это не кнопка учетом лежит это моя не отнимая танский терека ford класс котлы зил bit.ly лански так вот чего интернета нет ну давай попробуем of lovers открыть не можете перекинуть быть а вот что делать у меня есть флешка оксане сможете листать и да дальше чем я дали стал а у меня от формально счет отказывается до руки его на диск то супер на курса многого не актуально версия chrome вот чем дело состава магическое слова написать никто не делать это будет несколько свитеров супер центр а вот этой штуки оставил с прайма короче это позволяет делать кучу классных штук и концептуально поскольку у нас появилась новая теперь слайд показывает все флешку вот еще давай покурим слежки томаса локального но он всеравно синхронизируется не отняли формате руки а точно ничего не больше не при монтировалась а это то что эта семерка восьмерка десятка нет десятка я бы снова то включил на меня выгонят порта к сожалению не будет будет запасные компьютера что 20 мегабайт тут листать слайды мы в осадок самом худшем случае с pdf к еще так что вообще ничего не получится будем не интерактивных смотреть вот папка которая и яндекс этого лежит сложно с локальным картинка а короче включая пока все еще можно делать магическое закрывании маги поехали и шел к этому письму команда не такой security шкала абстракции она поднимается в этот мы говорили про вас пропало relay и по учёбе это такие клиентские стороны с возможности их реализации на самом деле из-за концептуально они чуть повыше потому что есть вот эта концепция клиентского сторож немножко ускоряться дальше метеор метеор firebase rising тебе все эти технологии обвиняют то что они предлагают полный стек от серверной базы данных до самого сервера до протокола и до клиентского этого самого сторону зачем это делают они делают все это реактивным то есть чтобы получить реактивные подписки опять же все те же возможности плюс реактивные подписки им нужно контролировать все начинают базы дак и даже воздам и должна быть реактивы и тут важно заметить что очень сильно поменялась концепция то есть изначальной когда мы говорили аресте например а запросе ответе то есть мы говорили в терминах так послать запрос где взять там данные каждые с ответом как их координировать вот это все лежало как бы все эти детали мы были переполнены деталями сейчас все стало супер декларативно мы говорим у нас есть какой-то datasette в базе данных на сервере мы хотим иметь маленькую копию это сета и ты сам там придумай как их синхронизировать между собой 8 там абстрагируемся детали полностью мы просто говорим переходим над этим язык намерений да нам нужно чтобы у нас были примерно те же данные и они как-то автоматически фоне синхронизировать детали нас не интересует это неинтересно это как бы еще на ступенечку выше технологию попадают мы переходим к вообще зачем все это нужно то есть моя задача которая пытается сделать с этим докладом у меня то что за что я агитирую я агитирую на самом деле за две вещи первая это реактивность то есть нужно переходить на реактивный в писать кейсах которые автоматически обновляются все такое и второй это декларативность то есть переходить от низкого у него контроля за запросами ответами за передачи данных косяка уровнем описанию чего мы хотим технологии должны решать как это достичь вот это все делается но в первую очередь ради пользователей еще говоря все вся работа программистов происходит ради пользователей вот для обычных людей реактивность постепенно становится новой нормы то есть они видят приложение там не знаю фейсбук гугл докс которых это все работает как бы само собой и раньше это может быть это были фичи который нужно было делать планировать продавать рекламировать как тогда пользу им сейчас это просто норма которую ожидает приложения никому не интересно смотреть на странице которые просто протыкают лежат и потухает отображаются более и более не актуальна информацию вообще говоря кнопка обновить это такой артефакт эпохи когда вы не имел этих возможно сейчас он их имеет то есть это она постепенно становится неинтересной людям потому что это чисто техническая деталь поскольку я пошёл на конференцию разработчиков насколько бы распинался протоках хорошо будет пользователям не нужно продавать этой разработчикам тоже так вот вот этот переход к декоративному описанию на самом деле он очень важен потому что так пакет немножко он важен по нескольким причинам одна из них во-первых проблема синхронизации не уникальна да то есть на самом деле красота этой всей штуки в том что всем нужно более менее одно и тоже нужно там модель данных которые с на сервер и синхронизируясь с моделью данных которые с на клиенте и вообще говоря деталей какие-то специфические особенности их науку проектов как правило нет во всем нужно одно и тоже нужно чтобы данный синхронизировать в обе стороны и все в принципе то есть можно сделать библиотеку один раз или там не знаю фреймворк который обеспечит и потом пожинать многократно плоды того как мы делаем то не знаю серверная архитектура фронтэнда то же самое можно сделать и здесь второй момент что если такая библиотека будет ну такие букетики уже есть и еще наверное появится они могут решить за вас те проблемы которые вы сами бы никогда не стали вообще говоря решать то есть обработка ошибок в виде нетривиальный сценарий когда сервер может ответить когда вы послали запрос и в одном порядке ответы пришли в другом это все как бы это допустимый сценарий процесс синхронизации данных когда это как бы такой растянуты во времени процесс и он кишит просто вот этими подводными камнями как о которых обычно не заморачиваться но они есть ну потому что действительно смоделировать и протестировать это все то сложно экономически неоправданно если переходите к каким-то декларативным библиотекам они могут сделать это за вас вам подадут придется приложить меньше усилий и качество синхронизации будет лучше потому что они более корректно решат эту проблему да так как такая вот мотивация и вторая часть доклада от собственного что все это упирается то есть я не хотел здесь рисовать золотые горы как бы надевать розовые очки вторая часть про то что если вы захотите взять и написать взять готовую библиотеку синхронизации данных вот этих моделей используйте и прямо сегодня вы не ждать там какого-то не рассуждать на концепции в принципе и возможностях а что конкретно сегодня будет вам мешать да то есть это не ограничение идеи в принципе это ограничение вот текущего состояния дело восстание делал такое что это молодая область малого решений они все-таки немножко неказисты все такое прочь первое с чем вы столкнетесь возможно это выразительность то есть языки вот этих вот но даже если взять реактивной подписки язык описание по ваших потребностей в данных он очень примитивен по сравнению там сыск лес реляционная алгебра и со всяким таким и области долл долго развивались мы очень хорошо понимаем как сделать запрос к базе данных и получить ровно то что мы хотим вот здесь возможности гораздо меньше они все примитивнее они там на уровне дай мне пожалуйста вот этот джейсон документ или дай мне коллекцию jacinta корпуса и подпишись на изменение в этом же документе подпишись на когда новую жизнь и документы добавляются туда вот такого уровня а с одной стороны не очень с другой стороны как бы ну там поколению которое привыкло к новость келли и джо и не таблицы в форт цикле так принципе может быть это не так страшно это как бы не так страшно наверно просто чуть больше ручная работа второй момент проблемы с производительности здесь если вы почитаете параметер там в принципе у них есть огромная статья в документации про то как правильно делать реактивные подписки что делать что не делать как на них экономить это связано как в том числе с тем что они там немножко корявенько сделаны и они в итоге получились ресурсоемкими вот но пойнт мой здесь скорее будет в том что у нас пока нет хорошей интуицией чтобы понять как именно что именно дорогостоящую является дорогостоящей операции вот в ситуации с реактивными подписка на что является дешевой да то есть мы привыкли писать клин серные приложения мы привыкли что сервер отвечает один запрос рвет connect и готов обслуживать следующего клиента мы понимаем там вообще вот эту экономику запросов ответов к сколько уже серверов сколько collection of он может выдержать так далее все активным поиском все меняется и не обязательно хуже но она как бы другое здесь нужно следим отеля за этим следить очень легко как допустить огромную ошибку но так и делается классно в первый раз плюс 3 момент винтер log in как вы заметили то вот firebase это вообще тотальный vendor клин вам нужно охотиться серверах google а никаких вариантов да с метеором вам нужно использовать mongo db обязательно и там их серверную технологию то есть здесь решение пока предлагаются как бы full stack и вы не можете произвольно брать кусочки и заменять одни кусочки другие так как мы привыкли там менять одну базу на другую как uber там менял мой скольно пожгли спутал обратно на майские без проблем здесь пока такого нет опять же эта проблема на текущем состоянии дел принципиально как бы нет ограничения просто вот сейчас она выглядит так например ребята которые делают попала опала это сторож который из граф киль серверами общаются они пытаются придумать там спецификацию реактивных подписок которые бы через граф келлер работали и они типа будут для всех когда-нибудь это всё устаканится и появится больше вариантов и все эту проблему решить и последнее штука про которую хочу рассказать одну в принципе это тоже по своим такая достаточно обособленная часть доклада это работа с конфликтами работать с конфликтами не является там фактором препятствующим у к применению вот этих вот технологий до новых декларативных современных там но она должна рассматриваться как часть проблемой синхронизации данных и она к сожалению не рассматривается то есть вот эта часть она про то почему конфликты важны что это вообще такое и как с ними быть принципу сейчас все это все это я раскрою первое что такой конфликт конфликт возникает в любой распределенной системе когда у вас есть несколько активных агентов которые одновременно пишу да если кто-то училась начнет листать слайды я начну листать стоит это вектора смысле будет конфликт конфликты присущи любой распределенной системе в принципе то есть если у вас есть распределенная система с конечной скоростью передачи данных но пока у нас скорость передачи конечно вот там и возможны конфликты они присутствует и есть во всех в приложениях есть надо в гугл докс ах веб-сайтах они есть в бите как распределенной системы них даже в контр страйке езда то есть конфликт и везде присутствует вот так же важно понимаешь что конфликт это абсолютно штатная ситуация также как но данном примере я покажу пример валидации формы валидация форма это абсолютно нормальная штатная ситуация несмотря на то что здесь используется слово ошибка да так мы говорим об этом как об ошибке это ошибка который является частью вообще нормального функционирования системы это не исключительная ситуация это не авария какая так это то что нужно предусматривать планировать обрабатывать корректно и в общем дизайне тестировать и так далее то же самое с конфликтами конфликт абсолютно нормальное законное поведение вашей системы предусмотрено вообще как бы и дизайном поэтому единственная это правильный способ на это все смотреть смириться с тем что то конфликты есть и они просто являются частью вот этой области веб приложения мобильные приложения на и приложение вот и нужно с ними просто что-то делать дальше вы смотреть они отключению да и еще один момент который я хочу сказать что конфликт это не техническая проблема то есть не это не проблема там несовершенство текущие технологии синхронизации это скорее проблема такого бизнеса уровня уровня требования уровня поведения системы то есть они не являются следствием несовершенство наших технологий и нет сейчас никогда не появится библиотеки синхронизации которая бы сказала что мы решим конфликты за масса вы там занимаетесь бизнес-логика нет конфликт это часть бизнес логики в том числе к сожалению многие библиотеки как раз рекламирует себя как просто пишите как пишите а мы все проблемы нас помешаем это не так они просто скрывают от вас правду как именно они решают конфликты как правило это какой-то конкретный способ и вам не слишком удобный как правило 5 вот таким образом до конфликт это проблема пользователя проблема проектирование общей системы проектирования поведения системы и и никто не может лишить кроме собственно дизайнеров самой систему потому что нужно ориентироваться на бизнес домен нужно ориентироваться на логику поведение что мы хотим чтобы произошло данной ситуации вариантов того что может перейти в принципе очень много один из вариантов игнорирование конфликт это с большим отрывом самая популярная вообще стратегия которая используется да мы просто не предпринимая никаких действий пусть идёт как идёт к что получится в этом случае вот такая диаграмм к в середине у нас сервер на котором есть некое поле там с именем пользователя например и есть у нас два агента они оба считывают это поле себе немножко в разные моменты времени потом один из них и мы меняет коляна вася и записывает это абсолютно корректная запись в принципе все нормально вот потом 2 меняет именно другое значение пейте и записывает его опять же если мы не предпринимать никаких усилий запись успешно завершиться но проблема здесь в том что он меня у коляна вася по меня на петя поменял вася на 5 они тоже чего ожидал пользователи мы потеряли намерение пользователя хотя как бы авария не случилось но возможно мы сделали не то что вообще мы предполагали сделать проблема здесь еще и в том как бы это не не страшно в случае с конкретно вот одним там визирной вам сказать ну скажем так да северный мам скорее всего вы там если будете обсуждать серьезно эту фичу и что делать в такой ситуации вы придете к выводу что ну наверно нам нужно просто последними сохранит а здесь сложно придумать более умная стратегия но это может быть там развесистые джейсон документ например которому перезаписали они одно и то же самое как бы проблема усугубляется тем что вообще говоря мы можем перезаписать произвольное количество изменений таким образом с не обязательно мы рассинхрон может быть очень-очень большим он ничем не ограничен пока страница у коли ветер купите висела открыты до рассинхрон только увеличивалась еще более проблема усугубляется если мы используем классный новый супер offline first технологии то есть в данном случае мы предполагаем что петя выше быстренько поменял имя опять же здесь уже нет такого что я там просидел месяца потом решил поменять его нет быстренько поменял но оказался в оффлайне и его backend ссоре frontend решения которая пыталась за синхронизировать данные она умная она offline first она как бы поставила в очередь это этот апдейт и пытается там его отправить пока не появится интернет это опять же произвольное время вообще она может сколько угодно долго занимать времени вот и когда это наконец то совершиться мы опять же можем произвольное количество измен не таким образом уничтожить самое худшее что даже петя в этом случае мог забыть что он когда-то делал от апдейт и он может стать уже совсем не актуальным то есть в этом случае мы произведем такое разрушающую запись о которой все уже забыли которые вновь момент когда произойдет она в принципе уже никому не нужна хотя бы на как будет еще хуже здесь можно придумывать разные ну как бы меры безопасности что надо что что вообще делать такой ситуации я рассматривал примитивный пример как под провел там больших системах там все гораздо сложнее и интереснее и скорее всего более осмысленные решения можно выбрать просто из логики того что мы хотим сделать так вот у вас стоит винс это стратегия когда мы каждому апдейт у прикручиваем еще и temps темп монетку времени когда но сделано и на сервере мы вводим правило что мы отвергаем все апдейты которые пришли к нам из прошлого с таким образом мы решаем проблему что вот ветер был долго в оффлайне и когда он наконец то жил его апдейт наконец-то сослался на серверах но сервер уже ускакал далеко вперед поэтому он просто отвергает этот апдейт тут как бы есть два момента первый момент что мы теряем учительский вот и ладно если это username опять же пользователь ничего об этом не узнает его он он меняет имена петя нажимается хранить и видят вася что произошло непонятно это не но явно не его намерение ему никто не сказал что вот эти часы чувак на две секунды разошлись сервер например вот вторая проблема в том что вообще использование время времени чревато тем что на возникают временные парадоксы так называемые да то есть в распределенных системах и в как часть разделенность пример распределенной системы существует правило что невозможно сделать надежный источник времени найти вот можно попытаться сделать более-менее приблизительный такой годный источник времени но в лучшем случае он годится для того чтобы там логе какие-то писать да на нем нельзя основывать по алгоритму никакие потому что всегда можно придумать случай когда у клиента разошлись часы и он ничего не может сделать например вот этой проблемы например когда я делала эти слайды отлаживал я запускал их на ноутбуке и на телефоне и пытался там полистал слайды на телефоне а потом не мог ли стать их ноутбуки потому что там была разница в три секунды между часами и как бы апдейты получается что я нажимаю апдейт на ноутбуке но у него часы чуть-чуть в прошлом и он не может просто забить забыть потому что у кого-то часы ускакали вперед короче вот такие вот штуки они короче просто не пытайтесь время для алгоритмов не подходит можно сделать чуть получше можно использовать как стираю compressed примерно то же самое просто вместо времени мы используем номера версии номера версии увеличивается клиентами или сервером вот и мы отвергаем в общем-то все апдейты которые не совпадают по версии с мы запоминаем что мы считали коля пытаемся записать вася если на сервере все еще кода такое предпринимается если мы носили уже николя то апдейт отвергается это надежный способ и опять же но единственный его минус в том что а что делать отвергнутого об этом выкинули часть пользовательских данных и типа или чем можно в общем то что лишь то что люди делают эти ситуации можно напрячь пользователя выбрать да то есть вот чувак у нас есть две версии этого документа или там не твоего документов какие то правки ну как бы здесь такие правки какой из этих версий выбрать такие окошки вы наверное видели они часто сейчас появляются если вы используете используете какие-то облачные решения для синхронизации в боксе это не окошке но смысл такой же он просто сохраняет два файла в мобильных играх часто когда клауса и включаешь такие штуки появляются вот и это в принципе наверно это место через которое обычные люди знакомятся с тем что синхронизация данных это сложно проблемы такая что во-первых это кошка не всегда адекватно появляется то есть иногда она появляется просто из-за того что что-то там не успел до синхронизироваться человек вел себя абсолютно нормально я поиграл на телефоне отложил телефон через пять минут поиграл на планшете у меня хоб выскочил конфликт научилась сделал не так и вы же не одновременно двумя руками играл правильно в принципе то есть точки зрения человека и он делается правильно но все равно система что-то возвышает такие кошки сразу вызывает раздражение вторая проблема такого решения напрячь пользователя решать проблему как бы дает еще одна проблема что может быть проблемы тайник может быть вы могли бы решить все это автоматически просто ленивые разработчики видят ой там таймс темп разный все решай сам а может быть там все все что нужно было там за склеить 2 файл или что такое сделать просто а третья проблема в том что если конфликт действительно имеет место то есть если я действительно одном ноутбуке три часа поработал потом пошел на другом ноутбук еще два часа поработал но они были оффлайн и теперь возник конфликт то человек увидит такое окошко не с вариантом типа вот эти две опции выбери какая больше нравится он видит это в таком ключе вот в одном файле три часа твои работы в другом файле два других часа твой работ какой из них ты хочешь уничтожить звучит не очень следующий пример это гид нарисован против я хочу сказать следующее что гид это но хоть и не web system но это пример распределенной системы которой вот это понятие конфликта не скрывается даже сделано частью бизнес-модели до доменной модели она торчит прям в лицо пользует эту часть интерфейса эта часть концепция часть модели данных то есть гид эта система которая нативно принимает вот эту сложную и противоречивую там не знаю непротиворечиво конечно сущность распределенных систем что делает кит с точки зрения разрешения конфликтов это не на самом деле небольшой mix вот из этого варианта он он пытается разрешать конфликты там и это возможно и там где он не может это сделать он предлагает пользователя то есть частично он это делает сам что уже хорошо да когда мы можем сделать решить проблему за пользователя даже если существовал рассинхрон но если мы можем избавиться от него автоматически нужно это делать если этот алгоритм не работает он привлекает пользователь и наконец самый лучший самый идеальный общий вариант который возможен теоретически котором мечтаете это когда разрешение конфликтов происходит полностью автоматически ну как бы на данный момент известной стратегии который работает не всегда но работают некоторых частных случаях один из частных случаев это первично transformation это алгоритм для бюджета больших текстов изменений в больших текстов таким как бы на нем работает гугл докс ним работал google wave когда-то ну и вообще как бы такой вот такой la гаретом который применим только если у вас есть некий бортик стану длины достаточно текст в котором несколько пользователь одновременно что-то редактировать так вот алгоритм устроен так что независимо от того кто и когда и где и что делал все изменения автоматически сливаются вместе сожалению как бы скажем для зерна и моего неадекватно применять потому что но вы если вы меняете и зерна им вы наверное хотите перезаписать старый они склеивать там если вы написали две буквы вы не хотите вклеивать и в другой именно для большого текста сама проблема в принципе определена с точки зрения человека вы понимаете что если я пишу предложение в начале а другой человек пишет предложение в конце но тут как бы логически нет никакого противоречия поэтому как бы можно придумывать алгоритм который и по факту машин на все это пройти все эти противоречия разреши и последний пример технологии опять же скажем так сердите это нечто совсем другое относительно перешел transformations на него примерно те же обещания он обещает что вот если вы используете сердите это набор структур данных если вы использует 1 у вас их можно выжить автоматически то есть этот набор который автоматически разрешают конфликты всегда вот и тут как бы это классная штука но здесь проблема немножко переворачивается то есть если раньше мы говорили что вот у нас есть модель данных она там виде какого-то джейсона придумать как и синхронизировать то в случае сверлить это будет немножко по-другому у нас есть некий набор типов данных достаточно специфичный набор то есть он там такой не простой никто к чему все привыкли вот и у нас есть этот набор данных он говорит типа мы можем его спокойно бесконфликтно синхронизировать но только ты должен придумать как запихнуть туда твою модель данных то нужно менять вообще-то как мы смотрим на вещи вместо того чтобы придумывать как синхронизировать вещи которые нам было удобней синхронизировать до этого например такой смены скажем так точки взгляда с одной стороны у нас старая модель когда мы привыкли делать вещи как привыкли и у нас проблемы с тем чтобы синхронизировать с этой точки зрения мы должны поменять то как мы делаем вещи но тогда проблема еще вот это как бы тоже немножко неоднозначно вишну пример работы с конфликтами еще важно здесь я хочу сказать следующее что сердите это пример вот адекватного технического ответа на то что воспаленными системам присущи присущи конфликты это не какое-то конкретное решение не конкретный алгоритм и решаем эффекты всегда таким образом это именно что набор разных структур данных то есть вы выбираете ту которая подходит в конкретно для конкретного поля конкретной ситуации они там под одну гребенку всегда то есть технология предложила вам набор инструментов и вы в зависимости от ваших потребностей от задачи которого решаете от ситуации выбираете из этих инструментов то что подходит конкретно сейчас и мы посмотрим на немножко сейчас я же все еще укладывайся очень быстро говорил ему требуется мы посмотрим как устроены слайды которые сделаны красно сердите слайды вот то что я вам оказаться что мы щелкаем они сделаны на основе fireboy за как старриджа реактивного в fair базе я вместо чтобы использовать их структуры данных я сохраняю туда ивенты то есть я использую только линейной коллекции с ивентами вот и я использую ведь эти типы то есть это все сворачиваться сердите тип вот пример поля спикер слайд снова не очевидно короче смысл такой вот у нас поле спикер слайд здесь вот и она состоит просто из набора иванов то есть по сути это одно число до но одна строка текущей слайд но вместо чтобы хранить одно число я храню храню каждый event переключение слайда на следующий год они как примерно выглядит из там написано число items тем соответственно используется поставить винт реджистер который основан на темпах но ничего страшного здесь не происходит но что я как правило предполагать что я единственный спикер поэтому это здесь применяется все ивенты сворачиваются и короче как бы как работает сердите тип берутся все ивенты иван самом наибольшим числом и считается текущем слайдам все остальные игнорируются если как бы времени особо нет объяснять но можно представить почему независимо от о каком порядке приходят и менты все это свернется вадим в одно и то же значение всегда то есть видите нам гарантирую что мы можем перетасовывайте в int и как угодно event не дошел иван пришел другом порядке не важно важно что в конце это свернется в один тот же стоит то же самое используется для вопросов вопросы используют другой тип но смысл пример такой же это гром он lisette это сет из которого нельзя удалять опять же поскольку я не хотел делать удаление вопросов мне этот тип подошел до для кайта другую ситуацию там для корзины товаров он бы не подошел тоже скользим надо говорить для вопросов не надо поэтому вот я не это сошло с рук и самое здесь хитрые сложное это лайки лайки на слайдах я хотел что можно было за лайкать и развлекать поэтому здесь используется третий тип absurd ремус цвет по сути это два сета в одном лежат добавлены элементы в другому удаленная и собственно если элемент есть добавленных но его еще нет в удаленных то это что считается что он присутствует множество если он и там и там . считается что его нет опять же хитрости такой непривычной штука но зато надежная синхронизация без проблем на все выводы вывод очень простой на самом деле даже здесь есть несколько я не уверен что я все вспомни но вывод такой у нас есть некая эволюционная цепочка технологий большинство проекта застряла в самом начале это сделает вот это вот сложная ручное там синхронизацию данных типов послать запросу получить ответ это трудоемко это в чего-то ошибками вот есть более совершенной технологии которые там обладая своими минусами но снимается у вас часть головной боли во первых во вторых делают это лучше чем вы бы сделали это руками вот это все приводит позволяет писать в том числе реактивный в что положительно сказывается на пользовательском эксперименте будущем явно это все не закончено будущем явно появится еще что-то более новое еще более крутое и интересное я надеюсь что это все дойдет до такого состояния что наконец-то станет можно на экране каждый пиксель экрана сделать реактивным полностью и кнопка обновить исчезнет из браузера трам-пам-пам спасибо ощущаю открою эту штуку drop datawiz.io без комментариев не сработало продаю гараж всем чмоки но классно уж отличный получился а скрип не сработал потому что react экранируются react извините ищу фриланса реакции while true гараж какой стек технологий лучше подойдет для angular атакой для реактор без понятия в общем класса спасибо что писали вопросы очень весел живые вопрос может быть никто из к или инъекции не попробую ну давайте смелее у нас есть наклейки за вопрос были какой вопрос не технологический не умаляя значения содержание доклада вопрос ты сам рисовал иллюстрации достал очень крутые классные а тебя еще вопрос до груди спасибо за доклад такой вопрос вы сказали что нельзя не рекомендуется использовать сравнение версий по таймс temple а почему нельзя использовать как единую точку входа какую-то фишку которую грубо время из в этом стенку и в итоге у него он будет единой для всех пользователей подвох в том что мы хотим уметь функционировать в оффлайне то есть мы хотим чтобы интернет пропал но я могу что-то сделать я могу изменить имя нажать сохранить и у меня нет в этот момент доступ вообще никаким ресурсам сидит на выход это попытаться в это собственный темп создать и вот он может быть всегда раз сохраним это на самом деле как бы то проблему можно решить если на каждый объект который мы пытаемся сделать ходить к серверу и спрашивать типа сервер как дела но это это как бы плохой юзер экспириенс потому что будут все время задержки нажимаешь кнопку она идет к серверу verner вот в оффлайне это страшно в трансе так далее но это бы решило все проблемы сожалею спасибо за доклад у меня такой вопрос у меня довольно сейчас есть нормальный опыт работы с релейным граф верим и в процентов наверное 70 случаев всех кейсов мы даже не можем делать оптимистически я бы это не то что синхронизацию мне кажется ли вам что вот эти кейсы синхронизации с от между устройствами так далее довольно таки к вымышленная проблема очень редкий кейс и это во-первых еще очень сильно удорожает разработку печатать мисс того чтобы делать неделю мы делаем три недели это все усложняется профит от этого мало и это очень довольны редко где нужно а почему он не может идеала террористические обито ну во-первых иногда на клиенте не может хватать информации для этого чтобы принять решение во вторых например мы говорим о кей он там выполнил этот пункт мы типа должны пустить дальше но над на сервер эта информация не дошла и мы не можем отпустить дальше нужно смотри мы не проверили его перемещены или еще что то то есть да понятно так бы да мне как задачах автоматически это не подходит я согласен у меня был кусочек медитации продюсер то по то что да это сложнее делать но типа мы выигрываем юзер экспириенс и и я считаю что мы выигрываем юзер экспириенс и когда это можно сделать по выигрываем в на самом деле если сделать правильно концептуальное разделение что вот у меня есть это сет я работать с этом он сам фоне синхронизируется до гораздо лучше с точки зрения архитектуры чем слать запросы ответы но да это идет как бы с некоторой ценой дополнительной и особенно сейчас возможно пока у нас не наработаны способы работы с этим дата это это сложнее чем писать обычный обычно очень легко и очень понятно как писать и все под это заточен вообще все все что у нас есть все инструменты под заточен я думаю что-то начнет меняться но пока как бы дает как бы чего-то некой переплаты как бы каждый шается так что стоит того не стоит спасибо за вопрос теперь я ты описывал лайки и там у тебя было два множества like поставленный лайк удалён получается на в базе нужно хранить во первых все эти множество лайков а во вторых нам нужно все эти множества лайка хранить на клиенте чтобы показывать всего лишь одно число до что насчет сборки мусора сборка мусора все родить и это больная больной момент то есть большинство сердите типов только растет каунтер бен каунтер не командир из этой власти twins они растут как бы можно придумывать алгоритмы сборки мусора вроде бы то есть канал это как в топик если вообще сергеев очень свежая штука эта математическая разработка достаточно свежие вот и пока тоже не очень понятно области и применимость то есть проекты которые используют но там тоже есть подводные камни то есть какой-нибудь вконтактик где страницы может быть грубо говоря бесконечно мы сделать пока не можем наверное нет наверное а потом скорее секреты своей способ потом как бы это мы на наверняка на на сервер саде тоже спрос свои слова какие-то свои штуки наверняка не делают все лекции по кто по likelihood пост на каждый запрос посту достал оптимизация на этом заканчиваем мы ходим на технический перерыв сегодня эти супер пасибо"
}