{
  "video_id": "95kb8LHu5rU",
  "channel": "HighLoadChannel",
  "title": "Таксономия изоляции: как оградить себя от хакера / Антон Жаболенко,  Алексей Федулаев (Wildberries)",
  "views": 146,
  "duration": 2448,
  "published": "2025-01-17T02:28:46-08:00",
  "text": "Всем привет про такси говорить сегодня на самом деле не будем да спасибо может быть зря узнаем в конце Спасибо всем кто добрался на второй день на первый доклад это мы понимаем это было нетривиально особенно после автопати не все выжили после автопати Как видим да сегодня поговорим про таксономию изоляции и в ходе доклада как раз узнаем что же это такое да меня зт Атон ленко Я в албес отвечаю за направление информационной безопасности и противодействия мошенничества и со мной сегодня здесь Мой коллега Алексей да Всем привет Я Алексей дулаев я вайберис отвечаю зас собственно специализируюсь на безопасности контейнерных перевозок вот Ну также спикер многих конференций Да наш сегодняшний доклад является неким таким продолжением логическим продолжением того доклада который мы делали на хайлоу в 2023 году мы выступали Как собрать контейнер не вооружить хакера Можно перейти по ссылочки тут есть и статья на хаб и видео с лода тоже возможно для кого-то Будет интересный доклад про безопасность контейнеров Но прежде чем начинать говорить про таксономию изоляции А давайте выясним вообще а кому приходилось когда-либо изолировать недоверенный кодред Сегодня возможно многие вещи будут знакомы но если даже они будут знакомы надеемся что поможем навести порядок в ваших знаниях Ну да ну собственно и совсем одно дело - это думать про изоляцию и совсем другое дело - это реализовывать изоляцию Я уже не понаслышке знает так хорошо Да и такой важный на самом деле спойлер для сегодняшнего доклада с анбоксинг когда мы говорим про изоляцию недоверенный Сан боксинг про некоторый спосо это недоверенный код оградить как-то изолировать Понятное дело что Сан боксинг не заменяет безопасную архитектуру То есть если вы за сабок или какой-то недоверенный код Это не отменяет необходимости использовать практики безопасной разработки проводить всякие сети ревю искать Баги и так далее такой маленький спойлер вот ну и прежде чем мы перейдём непосредственно к самой таксономии Давайте вообще поговорим про концепцию Атак нарушение принципов изоляции что у нас может произойти и Давайте начнём обсуждение с очень простого примера опять же это концепция Давайте предположим что у нас что у нас есть некоторые мультинет окружение в котором разграничение какого-то физического ресурса осуществляется неким логическим способом для того чтобы говорить Не абстрактно а более конкретно Давайте предположим что у нас к примеру есть какой-то Облачный провайдер на базе Linux инфраструктуры и есть физические сервера на Linux которые представляют из себя такие некоторые гипервизоры и машины запущены на них кстати линия видна отлично вокруг гипервизора вот ну и собственно в нашем случае атакующий он точно также может на этом гипервизор поднимать какие-то свои инстансы что он собственно и делает Он выписывает себе инстансы После чего он уже может попасть в этот инстанс и выполнять какой-то там произвольный код что же дальше на самом деле внимательный слушатель может заметить то что когда мы говорим про создание какойто Маши на том же гипервизор где находится виртуальная машина жертвы у которой мы хотим например украсть какие-то секретные данные понятно с дела Что здесь скрыта некоторая логика того А как сделать так чтобы эта виртуальная машина оказалась действительно на том же гипервизор где и жертва мы сегодня про это говорить не будем но про на эту тему Есть много и научных статей и исследований как бы сегодня удовлетвори тем фактом что они есть и что это возможно в детали погружаться не будем злоумышленник создаёт некоторый виртуализация а так на нарушение принципов изоляции в том что опять же у нас есть некоторое мультинет окружение Мы попадаем в некоторый ресурс который ограничен логически например виртуальную машину после этого мы как раз применяем атаку на нарушени принципов изоляции и к примеру в данном случае оказываемся На физическом гипервизор на Linux сервере Ну да соответственно после того как мы оказались уже сбежали на гипервизор мы можем различным способом выполнять на нём команды А значит мы можем управлять этими тенетами мы можем не знаю там снапшоты вытащить сделать дам по памяти и всё что угодно и получается такая ситуация когда мы можем вытащить секретные данные которые не принадлежат нам собственно да то есть на самом деле вот в этом конкретном примере у нас Linux сервер виртуальные машины сейчас скажу такую фразу которую сегодня буду повторять много раз и виртуальные машины на сервере Это всего лишь обычный процесс в юзер спейсе поэтому ничего не мешает злоумышленнику который оказался на гипервизор в данном случае на Linux сервере просто к примеру с дампить оперативную память этого процесса Да а а кому вообще знакома концепция Атак на нарушение принципов изоляции концепция простая Я думаю многим знакома Да и и три поднятой руки Ну ладно хорошо Значит мы не зря не зря вставили эти слайды отлично и когда мы говорим про атаки на нарушение принципов изоляции главный вообще вопрос который возникает А как нарушить изоляцию потому что понятно что когда мы говорим про нарушение какой-то логической изоляции в мульти окружении не существует какого-то универсального способа нарушать изоляцию все способы они будут зависеть на самом деле от той системы которая изоляцию обеспечивает Ну да собственно и наверно начнём с самого понятного ближа ко многим людям это изоляция виртуальных машин собственно что у нас есть этот слайд наш дизайнер не смог перерисовать поэтому мы его оставили оригинальным Да на нём изображено то как работает гипервизор п qvm можно назвать это в совокупности гипервизоров внимания вот это идут атаки на на саму среду виртуализации или гипервизор А как собственно говоря можно атаковать среду виртуализации или гипервизор для того чтобы на этот вопрос ответить нужно понять какая вообще у виртуальных машин поверхность атаки и поверхность атаки у них на самом деле обширное наверное более обширное чем кажется на первый взгляд во-первых это различные эмулировать сегодня фразу о том что там та же виртуальная машина на линуксе тот же кему - это обычный процесс в юзер спейсе так вот так как так как условный кему - это обычный процесс в р спейсе то и устройство которые он мули это некоторый код который запущен на Linux сервере р спейсе если в этом коде находятся различного рода бинарные баги то злоумышленник по сути Может в случае нахождения успешной эксплуатации таких багов начать выполнять код в контексте уже гипервизора через бинарный баги в эру устройствах также е это могут быть стое сервисы позволяет там ко Pest шаре нае директории и всё остальное Особенно если это а не под лупой было всё рассмотрено где-то не отключили либо допустили мис конфигурацию при настройке Если вдруг здесь есть представители облачных провайдеров Надеемся у вас это выключено так сетевой стек соответственно А понятно что у нас идёт оригинальный сетевой стек который от самого гипервизора и все пакеты обрабатываются там а соответственно наличие Ну это такой же код сетевой СТК соответственно наличие у пово нам уже выполнять код также на первиз Ну и сам по себе гипервизор он тоже может тоже расширяет в некотором смысле поверхность атаки через него тоже можно пытаться выбраться из виртуалки и совершать различные неприятные действия Ну и на самом деле там это не исчерпывающий список того Через что можно попытаться выбраться из виртуалки стале том как это дела машины это Сай Channel атаки а И на самом деле если вы разрабатываете опять же к примеру облако либо какое-либо ещё мультитест окружение на основе виртуализации вам придётся всегда помнить о том что во-первых S Channel атаки есть и то что они реально бывают применимы на практике это достаточно слайд с уже в каком-то смысле устаревшей информации мы его рисовали наверное году в двадцать первом но по нему уже можно видеть то А какое вообще разнообразие различных Site Channel Attack существует А и тут приведена таксономия только Спектр ML Down подобных S Channel Attack Я думаю все слышали про спектр ML Down а но а S Channel атаки не исчерпываются Спектр имел дауном и Если вы разрабатываете к примеру опять же Облако на основе виртуализации вам придётся выстраивать некоторый жизненный цикл того как вы вообще работаете с пачин S Channel Attack Как вы патчи микрокод на своих на своих гипервизора Как вы пате ядро и как вы со всем этим живёте это может быть достаточно нетривиально А можем ли мы вообще усилить изоляцию виртуальной машины Ну так как здесь есть такой слайд то скорее всего можем и Да есть на самом деле несколько способов Ну и самый первый наверное самой простой - это уменьшение поверхности атаки здесь как раз у нас та самая ситуация где работают классические принципы и они работают замечательно Вот мы можем как раз уменьшить непосредственно саму кодовую базу убрать различные там эмулировать всё что не используется и что нам не нужно соответственно мы сильно Уменьши количество Кода да ну то есть если мы говорим например про кему Да у него есть большое количество за счёт того что кему - это там эмулятор пре общего такого назначения он умеет эмулировать кучу всего лишнего Если вы делаете какое-то своё окружение например там какой-нибудь внутренней облако да вам скорее всего из списка этих девайсов нужно там а несколько штук а всё остальное при перекомбинация му можно просто выключить и сократить поверхность атаки а Следующий пункт он также является таким как бы классическим принципом интерпретации классического принципа и такого как принцип наименьших привилегий Как можно следовать принципу наименьших привилегий в контексте виртуальных машин Да очень просто Если у вас есть некоторый гостевой код который запущен внутри среды виртуализации Вы должны делать так чтобы и самому процессу кему на гипервизор были доступны только те ресурсы которые должны быть доступны и гостю таким образом если гость совершит атаку на нарушение изоляции в контексте из контекста виртуальной машины ему ещё придётся преодолеть и уровень изоляции операционные системы То есть например преодолеть стандартную модель разграничения доступа в линуксе Да помимо этого при компиляции кему Не забывайте использовать бинарные харден там ссылки будут в презентации можно будет с ними подробно ознакомиться не будем сильно на этом останавливать Ну да Опять же за счёт того что вот эти все проблемы Они эксплуатируются через бинарную эксплуатацию то бинарные харден они могут от этого помочь Следующий пункт который можно попробовать применить - это Добавить дополнительный слой изоляции уровня операционной системы опять же если мы говорим про виртуализацию на линуксе и в третий раз повторю эту фразу кему процесс это обычная обычный процесс рй ничего не мешает к нему применить харден уровня ядра Linux такие как мандатная система управления доступом или вы таким образом можете сделать обернуть ва виртуальную машину в некоторый дополнительный сабок Понятное дело что это приведёт к некоторым накладным расходам Но это позволит повысить ваш уровень изоляции Да ну Также можно ещё использовать дополнительную изоляцию уровня процессора аш технологии То есть это шифрование памяти тем самым мы можем попробовать обезопасить как раз процесс от каких-то там дампов памяти и всего остального Ну и Если вы опять же например делаете к примеру обла провайдера Почему я говорю про облачных провайдеров потому что это такой самый яркий пример когда Людям нужно изолировать друг от друга как бы какой-то недоверенный код на самом деле если вы делаете к примеру облачного провайдера то это хорошая идея вот мы сказали про первый пункт вам нужно оставить в вашей виртуалки только те эмулировать а Хорошая идея вообще так как их осталось немного их по фази если вас если вам это позволяет как бы бюджет время и компетенции хорошо мы с вами поговорили про изоляцию виртуальных машин Давайте теперь перейдём ко второй очень распространённой технологии контейнеризации поговорим про изоляцию контейнеров собственно А по большому счёту изоляция контейнеров происходит за счёт механизмов Linux такие как си группы N спейсы Linux capabilities а также как уже ранее названы арком профайлы вот за счёт этого мы можем как раз поместить процесс в некий такой изолированный СБО в котором он не будет видеть ничего лишнего И тем самым обезопасить себя Да есть ли у контейнеров проблемы конечно же есть и все эти проблемы напрямую проистекают из того как изоляция контейнеров организована и первая такая самая яркая проблема с которой как раз будут бороться все те дополнительные методы изоляции про которые мы будем говорить позднее Это она заключается в том что контейнер и стоя операционная система используют общее ядро почему это плохо это плохо потому что любая уязвимость в ядре Linux она Ну в ядре хостой операционной системы она может привести к на самом деле к нарушению изоляции из-за чего Ну потому что у вас в контейнере есть некоторый гостевой Код Этот гостевой код взаимодействует с системой э дёргаю системные вызовы А если у вас в каком-то системном вызове есть уязвимость а системный вызов - это код который выполняется напрямую в ведре безусловно это может привести к тому что а изоляция контейнера будет нарушена и примеров таких цвек на самом деле их достаточно много но как можно догадаться это не Единственная проблема да Вот соответственно изоляция контейнеров как я уже ранее говорил она достигается за счёт применения специальных механизмов изоляции а это значит что что эти механизмы у нас могут быть например некорректно настроены или в них могут быть какие-то проблемы соответственно если у нас мис конфигурация либо проблемы с этими механизмами то по факту у нас нет изоляции и это принцип Принцип изоляции также нарушается построили систему контейнеризации которая по какой-то причине либо не использует либо неправильно использует какой-нибудь Network namespace Ну там будет много точек через которые можно будет Такую изоляцию нарушить А и наверное такой Последний концептуальный путь опять же контейнер - это тоже обычный процесс на хостой операционной системе которым управляет другой процесс а и ошибки в системах управления и запуска контейнеров например таких как не знаю runc или какие-то другие они тоже могут приводить к нарушению изоляции и такие примеры тоже есть шки можно там спокойно нагулино выделить такие три основных блока а а кто вообще сталкивался на практике с побегами из контейнеров опять Мам да кто-то сталкивался отлично илит хорошо что многие не сталкивались Как смотреть Да нали имее столько проблем как вообще защищаться А ну во-первых писать код без багов для того чтобы вас не взломали Ну ладно это конечно же шутка контейнеры тоже можно дополнительно харде неть собственно говоря как Ну да существует много различных Бест практи сов понятно что это актуальные версии программ выбор правильного B IM ну и соответственно там не прокиды доке соки в особенности если у вас подн не использовать root в контейнере помним про Linux capability ро всех capability лимиты контейнеров ресурсы нли файловые системы кастомный сем ARM профайлы сетевая изоляция логирование и различные инструменты которые нам позволят изза детек CV и с конфигурации контейнеров Понятное дело что не нужно применять там одновременно все эти способы а достаточно там применять те которые достаточны для вашего уровня паранойи А да Окей мы обсудили два классических наиболее распространённых всем знакомых типа изоляции Но чем они отличаются концептуально опять же если так саммари Зро и подытожить Да концептуально они отличаются тем что контейнеры из шарят В смысле ядро хостой системы шарится между контейнером и хостой системой а в случае виртуализации у нас есть ядро гостевой операционной системы которая принимает все си сколы от гостевого процесса Да но это опять же такая всем хорошо знакомый известный факт мы на нём акцентируем внимание потому что те промежуточные методы изоляции про которые мы будем говорить дальше они опираются тоже на этот факт и пытаются устранить у контейнеров дефект при котором у них системные вызовы проваливаются напрямую выполняются напрямую на хостой операционной системе Да Итого у нас с вами есть контейнеры есть виртуальные машины А есть ли вообще что-то посередине наверное есть Давайте узнаем это вот посередине У нас есть много разных интересных технологий про часть из которых мы сейчас сейчас с вами как раз и поговорим да Но прежде чем говорить про конкретные примеры технологии Давайте попробуем построить Ту самую структурировать как раз те самые методы изоляции которые отличаются от контейнеров и виртуальных машин и Давайте попробуем вообще разобраться Какие могут быть технологии изоляции недоверенный саксы дальше у нас идут классические контейнеры далее У нас идут так называемые контейнеры с усиленной изоляцией чуть позже мы чуть позже мы узнаем что это такое соответственно следом идут виртуальные машины потом идут облегчённые виртуальные машины вот а следом у нас соответственно с усиленной зай график по которому у нас усиливается изоляция но мы не можем как бы бесплатно улучшать и усиливать изоляцию нам за это что-то придётся отдать соответственно у нас с ростом изоляции Будет понижаться скорость работы Такой системы и она будет потреблять всё больше ресурсов потому что Ну опять же там облегчённый ВМ не облегчённый ВМ там уже с ней идёт полноценное ядро операционной система значит это больше занимает и памяти больше занимает ресурсов дольше врем на развёртывание да А теперь давайте при примеры технологий изоляции которые не являются классическими контейнерами и виртуальными машинами и начнём мы с кастомных СН боксов Что такое вообще кастомные сксы Ну в линуксе есть целый пул механизмов изоляции с помощью которых например строятся контейнеры этой сиру Linux и так далее понятно что на самом деле ничего не мешает м какой-то частной задаче где вам не нужны полноценные достаточно тяжеловесные системы контейнеризации сделать какой-то кастомный СБО сильно более легковесный чем классическая контейнеризация но Понятное дело что писать свой СБО там на спейсах это достаточно трудоёмкая задача те кто читал для массов скорее всего со мной согласится и для того чтобы свой кастомный СБО не писать на самом деле есть готовые утилиты которые позволяют достаточно легковес зан бокси ваш процесс а примером такой утилиты является например nsl njl - Это что это такое вообще мы на самом деле с Лёшей когда готовили доклад попробовали спросить у Гугла Что такое njl и Google хронически постоянно выдавал нам какие-то картинки с тюрьмой Но сегодня мы не говорим ни про такси ни про тюрьму мы говорим про утилиты от Гугла которая который называется непосредственно nsl А что это такое это на самом деле удобная обёртка над всеми над всеми теми же механизмами изоляции реализованными в ядре Linux которые я уже упомянул то есть на самом деле N sgl - это утилиты которые вам из командной строки позволяет легко зан бокси с помощью namespace си Груп там и си компа Вашу программу при этом она не тянет за собой всю Тяжеловес ную обвязку которые есть у классических контейнеров А какие у этой технологии Есть плюсы и минусы Ну собственно основными минусами можно выделить что это достаточно ограниченный сценарий использования это достаточно сложная подготовка то есть в случа с контейнерами мы переделали докер файл у нас появились дополнительные процессы здесь так просто не получится то есть здесь ещё можно Ну скорее всего это придётся пере настраивать в определённым случаям и по факту у нас как бы получается изолируется один процесс то есть мы не можем легко добавить второй процесс и что-то ещё то есть не то что это не Production Ready нет вот этого продакшн Ready изобилия в вариативности вот но зато есть и плюсы легко быстро просто и ну и эти плюсы они на самом деле следуют напрямую из минусов за счёт того что нет ничего лишнего но как раз и является быстрой и легковесный а О'кей следующая технология - это у нас будут контейнеры с усиленной изоляции такие как gvisor да а gvisor - это тоже проект Гугла Google Судя по всему очень любит что-нибудь изолировать поэтому постоянно пишет какие-то системы для дополнительной изоляции а что это вообще за проект такой что он делает и почему мы называем эту систему контейнерами с усиленной изоляцией Ну на самом деле это такой попытка сделать гибрид контейнеров и виртуальных машин с сохранением всех преимуществ которые есть у контейнеров такой полурак получается Вот соответственно у нас получается системные вызовы они не идут напрямую в ядро у GV есть такой скажем так Independent прокси ядро которое имеет лимитированный набор Силов следующий Вот соответственно эти силы от Application они перехватывают вот этим тиру уим ядром и уже те которые можно и которые там безопасны они в дальнейшем транслируются в Кел следующий вот причём всё это также ещё прикрыто си компом естественно то есть мы ограничиваем из всех вызовов Мы очень сильно уменьшаем количество доступных вызовов и тем самым обеспечивается изоляция ядра хостой операционной системы есть если немножечко подытожить Что делает G визр он между хостой операционной системой и вашим гостевым кодом который выполняется в процессоре ой в контейнере Ну и в процессоре конечно тоже но в первую очередь в контейнере а он вставляет прослойку А в виде легковесный реализации по сути ядра Linux самописный реализации си сколов и таким образом когда ваш гостевой код триггерит какой-то из сисло этот сикол выполняется не напрямую на хостой операционной системе а он выполняется внутри контейнера дальше Да но на самом деле какой минус у всех подобных систем А когда мы говорим например про тот же gvisor Ну во-первых у него сокращённый набор Силов и вы не можете в нём запустить по умолчанию любое приложение потому что возможно вашему приложению потребуются те си сколы которые которых взоре не реализована ну и в целом как бы там дебаг поддержка всей этой системы на проде она может быть достаточно трудоёмкого Когда gor де бал пытался запустить на нём сервис на проде выглядел Примерно вот как Павел вот Ну соответственно если подвести скажем так выводы по этой технологии у нас за счёт наличия прослойки силы выполняется медленнее То есть это всё-таки будет работать дольше у нас непрямая работа сколами Хоста всё ещё Возможно они тяжелее контейнеров потому что хоть какой-то там урез ядро но они всё-таки тащат с собой ядро а как уже ранее Антон сказал это ограниченный набор си сколов и не всегда будет возможно и естественно сложнее настраивать Какие же плюсы а плюсы ну оно как бы Для чего gvisor предназначен для того чтобы защищать от Атак на ядро и он в принципе с этим успешно справляется на сайте G визера можно почитать интересные разборы от того как контейнеры и код который был запущен на контейнерах с G визором был как такая система скажем так контейнеризации была защищена от некоторых типов cve которые позволяли сбежать из обычных контейнеров А ну и дзор опять же за счёт того что это не виртуальная машина не виртуализация контейнеры с д визором они запускаются быстрее чем виртуальные машины а дальше мы поговорим тоже про контейнеры с усиленной изоляцией это же технология компании IBM - это nabl containers собственно здесь они пошли схожим способом У нас есть Application у них есть как бы своё кастомизированные ядро следую и по сути есть определенное тоже проксирование вот этих вот системных вызовов они пошли немного дальше следующее и сделали Так что возможны всего Се си сколов причём они изменили Ещё сам Они поменяли н на свой видоизменённый RC получается что при перебил приложения у него есть всего сем вот этих вот безопасных Силов И тем самым обеспечивается изоляция плюс очень схожая технология Давайте не будем здесь останавливаться пойдём дальше Да мы как бы с вами движемся вот у нас там была линия где мы показывали различные типы изоляции и они увеличивались по уровню изоляции следующий после таких как бы контейнеров с усиленной изоляцией идт идут облегчённые виртуальные машины и самым известным представителем этого класса является такая система виртуализации такой монитор виртуальных машин как что это такое А на этот раз как э на самом деле Можно даже удивиться Но в этот раз это проект не от Гугла от амазона firecracker - это проект который Amazon разработал специально для своего сервиса бес серверных вычислений а лямда а почему почему такой проект возник в амазоне в контексте ews Ну потому что ребятам нужно было сделать такую систему виртуализации которая позволит поддерживать функции как раз для лямбды то есть такая виртуализация должна очень быстро запускаться быстро стартовать и достаточно быстро работать потому что как бы вычисления должны делаться быстро а по сути firecracker представляет из себя классический такой монитор виртуальных машин классическую систему виртуализации но сильно облегчённо в противовес классическому кему там опять же нет никаких лишних устройств нету никаких лишних фич есть минималь необходимый минимум но за счёт этого достигается более высокая скорость запуска и большая легковес так это лишний слайд Вот соответственно говоря про минусы понятно что это тяжелее контейнеров уже сразу и время выше запуска так что-то уполз вот плюсы естественно изоляция сильнее чем у контейнеров и это гораздо быстрее чем обычные виртуальные машины что же дальше Вот это настоящий контейнера вот собственно это такой проект который ла Нет это не Лой проект Вот соответственно Cat контейнер нам позволяет запускать одновременно и обычные контейнеры где у нас выполняется доверенный код и скажем так дополнительные контейнеры с usted кодом которые как раз поднимаются внутри виртуальной машины изолированной собственно что мы получаем У нас есть наш доверенный код и он выполняется Ну более как бы легковесный просто ему не требуется такой уровень изоляции и соответственно у нас есть недоверенный код который выполняется уже в среде в изолированной среде Так давай здесь немножечко ускорим потому что нас поджимает поджимает время А О'кей да А ну а это такие как бы примеры более классических типов изоляции но есть ещё так можно можно если чтобы нашу таксономию сделать более полной э кратко затронуть другие типы изоляции Дале Что это Что это за типа и поговорим про Web assembly да то есть когда мы можем - код с любого языка программирования транслировать в Web assembly код по суете в определённый байт-код что у нас происходит Давай дальше А у нас есть специальный компилятор который транслирует это ам а туда можно всё что угодно выполнить и изначально это было придумано когда то есть что-то JavaScript это вызывает и можно на странице выполнять на любом языке байт-код Но это уже было перенесено на операционные системы появилась вот эта вот обвязка и трансляции вообще как говорят что скоро контейнеризация полностью заменят Web assem не является инвестиционной рекомендацией Да и в завершении нашего доклада Давайте поговорим о какая же как же вообще выбрать правильную систему изоляции для вашей конкретной задачи и попробуем пройтись по такому дереву упрощенному достаточно но тем не менее дерево принятия решений и Для начала нужно вообще ответить на вопрос а нужно ли вам изолировать код если изолировать ко рам если вки изолировать код нужно это изоляция для внешних пользователей или для внутренних да первый вопрос на который мы предлагаем ответить это вообще изоляция для внешних пользователей или для внутренних если это изоляция для внутренних пользователей то мы предлагаем ответить вам на такой вопрос Нужна ли вам гибкость управления инстанса той средой изоляции кою М это не нужно нужно что-то там разово поднять протестировать или это вам здесь отлично помогут кастомный снбо решат вашу задачу да ну либо если вам нужно например в рамках какого-то сервиса запускать какую-то например какое-то приложение орное которому вы не слишком-то доверяете один и тот же код причём каждый раз без гибкости вот если это всё-таки для внешних пользователей здесь важно ответить на вопрос насколько для вас критично потребление ресурсов если потребление ресурсов для вас не очень Критична при этом важна скорость вообще разработки такой системы изоляции то можно остановить свой выбор на классических системах виртуализации Если же если же да потребление ресурсов для вас критично что же тогда делать здесь вам нужно ответить на один такой вопрос есть ли у вас растяжитель для обуви потому что дальнейшая технологии это будет достаточно больно вот на самом деле Ладно вопрос немного другой критично ли для вас время запуска если время запуска критично то лучше воспользоваться контейнерами с усиленной изоляцией такими как G визр потому что они не запускают отдельный инстанс ядра операционной системы и за счёт этого запускаются во многих случаях быстрее не всегда но во многих случаях вот ну и соответственно Если для вас время запуска не так критично Вы можете использовать облегчённый виртуальные машины да Ну и понятно что виртуальные машины классические тоже можно дополнительно нить Мы здесь уже для упрощения схемы это изображать решили не изображать Да и какой из этого всего можно сделать вывод Может быть очевидный но тем не менее очень важный на самом деле При выборе правильной среды изоляции Вам всегда придётся искать компромисс какого-то идеального решения Серебряной пули его к сожалению не существует А и мы всегда выбираем между Ну скажем так тремя стульями Да это высокая скорость работы низкое потребление ресурсо высо изоляция Давайте пройдемся Поэтому если у нас высокая скорость работы и низкое потребление ресурсов Ну получается дырявая если у нас низкое потребление ресурсов и высокая изоляция то мы получаем достаточно высокую сложность эксплуатации ниж низкую Надёжность как вот например с визором здесь опять же требуется растяжитель для обуви Вот соответственно если у на высокая скорость рабо высокая ССО ИЗО это ресурс Ну и да посередине К сожалению ничего нет а Ну и что что выбрать вам как бы это решение остаётся за вами но надеемся что вот эта классификация она поможет вам принять правильное решение и в такое самое заключение хотим оставить ссылочку на отличную научную статью в котором проводится довольно-таки качественный бенчмаркинг всех перечисленных систем изоляции про которые мы сегодня говорили ребята проводят там достаточно комплексный тест рекомендуем ознакомиться если будете делать свою систему изоляции Всем большое спасибо У нас здесь есть ссылочка на наши слайды и обязательно пожалуйста голосуйте за наш доклад Надеемся м слова но да голосуем есть чатик с можно задавать просто Аплодисменты вообще да мне доклад тоже понравился сколько 140 слайдов 135 слайдов За сколько 35 минут старались Молодцы Это потрясающе Да значит вопросы Из зала за лучший вопрос Мы дарим супрематический там и цели атакующим могут быть не только Побег и нарушения изоляции но и другие типы Атак вот что вы скажете про обсер били в сочетании с изоляцией то есть 135 слайдов мало было Да я понял а тут нужно смотреть в зависимости от всем Ну да вместе с увеличением уровнем изоляции у нас будет расти и сложность и опять же то же самое потребление ресурсов но обсер били потому что с каждым инстан сом Нам нужно будет разворачивать что-то дополнительное то есть каким-нибудь там я не знаю тетрагон да в классе мы уже не сможем ограничиться соответственно просто дальше будет расти но обеспечивать более высокий уровень изоляции Ну тут да то есть на самом деле падение уровня возможного возможного обсер которой можно достичь оно как бы логичным образом следует из тех свойств которые есть у виртуальных машин то что гостевой код запускается на отдельном инстанс ядра Понятное дело что действительно информацию о том как этот код работает доставать становится сильно сложнее я не скажу что это невозможно это действительно сильно сложнее Поэтому да Вы абсолютно правы обсер теряется по дальше был Да вот здесь Но пока да передают микрофон это на самом деле не всегда критично если опять же вы к примеру делаете облачного провайдера Но вам не всегда нужно знать что там как бы клиент делает в виртуальной машине а иногда это и вредно знать Вот здесь Давайте сначала Спасибо за доклад у вас там на одном слайде было написано то что в контейнерах нужно обновлять как бы пакеты до последние версии Ну что и логично А вот вчера на Первом выступлении там Алексей Морозов изм он тоже рассматривал тему побега из контейнера и короче сказал что делать Аде то есть обновлять вот пакеты доступ из репозиториев в коем случае нельзя когда готови контейнеры потому в сеть и как тогда это готовить Всё дело то есть да давайте я поясню А ну если у вас корректно внутри выстроены процесс вы с самого контейнера не должны Ничего как бы запрашивать у Вас внутри либо есть там какой-нибудь перехват DNS либо есть внутренний репозиторий Откуда вы можете это делать понятно что православный путь - это пересобрать такой контейнер то есть понятно что наратай вы не лезете не делаете там это как его через пошл Да каждый вы их понятно что пере собираете в таком случае у вас никаких запросов с контейнеров не будет но чисто теоретически в вашей сборочной инфраструктуре Может быть какой-нибудь там круи Nexus и если такая действительно есть необходимость можно это завернуть на него эти Пакеты будут просто кла в ш NEX и потом подтягиваться туда но лучше пересобрать в контейнерах точно не надо делать Мы полною соглас было интересно Всё теперь я догнал Спасибо микрофон да Давайте да привет У меня вопрос наверное в том числе и про то как и что Вы изолирует у себя вот смотрите у нас есть микросервисы там ну не знаю просто сервисы Да которые задействованы в взаимодействии да то есть там какие-то данные они там ну по grpc между собой передают А есть сервисы которые так или иначе взаимодействуют с пользователем например там ну не знаю клики обрабатывают какие-то картинки загруженные для карточки товара и так далее вы к чему пришли вы какой-то общий компромисс для всего нашли или вы по-разному защищаете изолируется такие сервисы там их контейнеры не знаю виртуальные машины и так далее можно я на А смотри здесь немножко Мне кажется путайте понятия вы сейчас пытаетесь привлечь проблему обработки пользовательского ввода и переложить это на вот это то есть пользовательский ввод Вы можете другими средствами санити зации валидации типизации Вот такими методами обработать что вот эти вот картинки здесь больше Когда у нас злу ту я тут всё-таки чуть-чуть дополню мне кажется о чём вот коллега спрашивает а к примеру был такой известный известная утилита для переконвертировать идёт о том что да Если у вас есть какой-то очень недоверенный компонент типа вот этого и в котором который там обрабатывает какие-то очень сложные данные его концептуально очень тяжело написать Да такое иногда полезно изолировать Я на своей практике такие компоненты Ну изолировал либо с помощью кастомных сексов типа либо с помощью каких-то вс-таки Захар контейнеров вот у нас какой-то сейчас там выстроенный пря регламента как это делать На текущий момент не обще для Да сечас Ну грубо говоря да не успеем уже кончилось время просто думал немножко дру Потом значит надо выбрать лучший вопрос первый второй третий у меня лучший вопрос спа друг другу Подарите да тем не менее Ну меня на самом деле последний вопрос последний запоминается лучше всего му человеку супрематический ребятам ловите их в кулуарах Спасибо большое спасибо голосуйте за наш доклад абсолютно всем пока"
}