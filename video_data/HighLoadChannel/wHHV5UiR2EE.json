{
  "video_id": "wHHV5UiR2EE",
  "channel": "HighLoadChannel",
  "title": "Секреты тестирования версий Web API с помощью Behat / Антон Золотилин (SuperJob)",
  "views": 264,
  "duration": 2635,
  "published": "2023-10-06T07:15:03-07:00",
  "text": "проснулись все из тех кто пришел меня зовут Антон золотилин в разработке я с конца прошлого века такой небольшой мамонт веб-разработки я порядка 13 лет Сейчас работаю в компании Superjob коротко о чем я буду рассказывать да как уже сказал Антон На прошлом печь пираша я рассказывал о том как можно Какими способами можно версиями единую кодовую базу у нас криптовых языках на PHP в частности и чуть-чуть пообещал то что расскажу о том как мы Тестируем в прошлом На прошлой конференции не получилось на этой конференции буду рассказывать коротко о супер Джоб так это последний слайд можно прыгнуть как-то на Нет не последний слайд кликер не работает первый доклад все технические сбои можно поймать кликер не работает возможно фокус потеряли а небольшой Да сбой получился коротко расскажу то что Superjob это сайт где можно найти работу или сотрудников сейчас слайд родится на самом деле тема очень большая буду отвлекать чем могу о заработала и вопрос не протестировали достаточно вот собственно ты сейчас протестирование будешь рассказывать Да вроде работал полчаса назад тема очень большая я пойду реально по верхам Надеюсь то что большинство в зале и те кто слушает знают что такое бихаты хотя бы Те кто не знает в конце будут ссылки уже с открытой презентацией и документации хабихатам можно будет повторно пройтись и понять о чем же я говорил но Вернемся компания Superjob коротко у нас порядка 40 миллионов резины в базе Сейчас актуальных 1,5 млн пользователей в день проходит через наш сайт и каждый год у нас порядка миллиона свежих актуальных вакансий а фронт нашей мобильные приложения работают с бэком через API о котором как раз рассказывал На прошлой конференции ссылочка будет в конце и мы благодаря нашему подходу поддерживаем сейчас активных 18 мажорных версий в последней актуальной версии у нас порядка 500 and Point of и тестами функциональными покрыты всем поинты Сейчас на последний момент когда я готовил презентацию это было 3293 уникальных тестовых сценария мы чуть позже вернемся к этим цифрам Когда я буду говорить о ускорении прогонов по тестированию коротко о чем мы поговорим значит я по верхам совсем пройду Что такое функциональное тестирование что такое бихаты что такое язык как работать собственно с тестами писать их поддержку как их улучшать Как тестировать версии webi Ну и в конце как мы дорабатывали бехат для того чтобы ускорить прохождение начнем с определений всяких здесь у меня отсылочка к принципу постановки барбарысков но я ее немножечко инвертирую У нас есть утка и мы хотим точно знать то что в определенных условиях она будет крякать в определенных условиях она будет летать в определенных плавать нам нужно это проверять собственно функциональное тестирование определение четких которые мне понравились В интернете не нашел Поэтому я сделал такую компиляцию коротко описал значит функциональное тестирование тестирование наших систем нашего по целях проверки реализуемости и функциональных требований которые предоставляет бизнес системный аналитики и так далее behat это PHP фреймворк автор Константин Кудряшов он вдохновился в свое время известным довольно-таки фреймворком для функционального тестирования в красноречии кукумбер или по-русски огурец у этого языка значит он использую вернее этот фреймворк также Как умер использует язык в красноречие геркин И даже джеркина иногда э в переводе корнишон у нас сегодня вообще будет огуречная тема Э да и значит этот фреймворк позволяет осуществлять разработку Согласно принципам bdby на девелопмент это же самое что TD только лучше потому что именно функционал поведения э проверяет это человека читаемый язык описание как раз поведение системы системной аналитики если у вас в компании есть они с удовольствием будут читать может быть даже и писать тесты на этом языке потому что он действительно очень прост и очень близок тем пользовательским кейсом который они описывают с помощью своих диаграмм и так далее вот так вот выглядит абсолютно валидные синтаксис Несмотря на то что здесь просто описание синтаксиса он же является валидным можно писать на русском языке эти тесты можно писать на английском хоть на китайском всё будет работать единственное надо шаги эти самые реализовывать Ну собственно Да фича описание фичи сценарии которые состоят из трёх частей гейвен Да но когда что-то происходит что-то мы проверяем также в обихатах реализованы предыстории это такие кусочки кода которые типа сетапа будут выполняться для каждого сценария который указаны ниже файле и Значит есть у нас шаблоны сценариев сценария outline Когда нам нужно по какому-то одному сценарию прогнать большие на большое количество наборов данных У нас есть табличка по ним будут просто подставляться значение сценарии и будет прогон в рациях Итак как реализуется тестирование тоже коротко вспомним или узнаем вот у нас простейший сценарий Тестируем сложение нам нужно для реализации каждого шага на человеческом языке реализовать в специальном файле фича контекст методы которые будут реализовывать эти шаги ассоциироваться они будут с помощью аннотаций через регулярки или постановочные сроки Ну собственно шаг второй и шаг третий then Сумма чисел дает в результате Там просто у нас какой-то assersion происходит либо через доступные библиотеки либо просто какую-то проверку делаем и выбрасываем исключение если вам что-то не нравится все это будет работать это в целом как коротко как работают бехатты а дальше все-таки пойдет мякотка Собственно как Какие такой маленький куббук рецай бук э для того чтобы облегчить написание тестов первое очевидная довольно таки вещь по крайней мере для нас было но почему-то со многими разговаривал многие это не реализует можно с помощью собственно фича контекста использовать реализовывать placeholder который дали использовать дальше использовать уже в своих тестах вот у нас есть схожие сценарии мы просто присылаем каким-то первым и второму слагаемым значения нам реализовывать два метода можно реализовать один метод сделать некое хранилище placeholder почему дальше и просто через постановочное значение в аргументы будут приходить мы будем какую-то там какой-то мэйпинг заполнять по ключам значение потом находить Почему плейсхолдеры Потому что мы дальше можем использовать через обычную подстановку через реплейс значения сохраненные в контексте в следующих шагах в данном случае мы Обращаемся вот у нас есть 5 символы мы для себя выбрали решетки строка может быть больше постановка будет только часть строки Например если мы хотим джейсоне загружать и будет происходить постановка из нашего хранилища в контексте чуть ближе к коду значит предположим сценарий устанавливания связи одного и того же пользователя с другим пользователем поиск аудитории можно использовать как встроенный плейсхолдеры нашего контекста Например у нас сценарии будут тестировать пользователей в том числе мы большинство сценариев от имени пользователей производим поэтому текущего залогиненного пользователя можно сохранять всегда и мы под него можем завести заданную там через констант ключ и при логике логине пользователя просто сразу его запоминают но чуть дальше расскажу не буду сбиваться а второе еще способ использования поисководеров мы завели рекомендуем можно какие-то встроенные функции использовать потом через ключи к ним обращаться то есть у нас например ключевой такой префикс ключей для поисковых рендом и мы генерим через фейкер нужные нам Рандомные телефоны почты адреса фамилии имена и так далее точно так же автоматом через специальный шаг мы просто рандомизируем а потом мы будем обращаться Рандомный телефон последний и так далее Ну и дальше Вот как раз Да почему Более сложный кейс у нас пользователь был залогиненный мы ему установили телефон теперь нам нужно другим пользователям этого пользователя добавить в друзья а текущий пользователь естественно подменяется Но вот еще один шаг копировать из одной из одного ключа в другое какой-то значимое друг и через него потом дальше будет обращение мы проведём какую-то проверку и так далее В общем это про placeholder и второе используется чаще но нам понадобится чуть дальше ссылочка на это а это встроенный в бехат функционал теги Ну во-первых практически на каждый шаг прохождения тестов бехатты выбрасываются события эти обрабатываются разными слушателями и в том числе можно использовать Это для встраивания своего кода например по тегу по тегу уже в фича контексте авто сценария мы можем подписаться на шаг После выполнения сценария что-то делает в данном случае например очищать поисковый чтобы контекст предыдущего сценария не мешал следующим на самом деле это очень важно потому что сама механика после сценария создаёт новый контекст Ну для примера пойдёт и второе использование тегов это помимо того что можно через шагом запускать конкретные наборы тестов еще можно в обработчиках хуках уменьшать скоуп выполняемых куков для сценариев Да адресов через теги То есть например фича так у фичи будет распространяться естественно все сценарии в этой фиче мы вот указали для метода и для всех сценариев этой фичи будет выполнен еще вот этот вот хук например разлогинить текущего пользователя подписок на самом деле может быть можно можно сделать специальные тесты для скипов временных Там и так далее ну большое как мы используем для версии они естественно мы к этому Вернемся не просто так сказал ну и самая суть как мы Тестируем версия нервные именно в API Вот это вполне реальный один из первых правда сценариев но тем не менее вполне реальный сценарий наших тестов функциональных подсветил важный момент во-первых мы используем теги версий для того чтобы указать конкретным сценарием Для каких версий его гонять так вершин From какая-то версия вершин ту какая-то версия рецепт простой для разработчиков если ломает обратную совместимость например удаляет он для сценария который работает с этим поинтом указывает то что этот сценарий будет работать тут такая-то версия если он пишет новый функционал естественно пишет From такой если он меняет функционал ломает обратно совместимость ну и соответственно может указать для старого сценария до такой-то версии работать для нового сценария будет запуск с фром э такой-то версии Ну и вот подсветил его Мы точно также можем передавать и тег версии так подсветка будет работать Да вот он по цвету подсвечен это тег версии он встроенный тоже placeholder как мы туда подставляем нужную версию на итерациях Расскажу уже в более подробной части дальше что еще нам надо определиться а как мы будем оперироваться по версиям гонять сценарии вот так примерно структура работы бехатов то есть фича файлы там парсером подхватываются на новый раскидывается запускается тестер фичи который запускает набор тестеров сценариев шаги background outline и так далее естественно нам интересно так как мы на уровне сценария будем интегрироваться нам Интересно этот кусок который мы на неком диапазоне версии будем тестировать что нам еще понадобится нам понадобится расширить сценарии то есть стандартный вдыхать есть интерфейс стандартный сценарий интерфейс который реализуют конкретные сценарии и подвиды сценариев языка вернее фреймворка мы реализуем тоже его просто добавим туда версию для которой в данный момент будем прогонять тест и еще сделаем композицию оригинального сценария чтобы не сильно менять на самом деле мы написали расширение которым чуть-чуть расширили это в нем Вот это всё и происходит забыл упомянуть Дальше сами тестеры вообще Кудряшов сделал такую матрёшечную систему тестер фич он на самом деле там два тестера один изолирует нужные вещи и вызывает декорируемый реальный тестер фичи дальше точно также матрёшка идёт два тестера сценариев мне два уровня тестераев и на каждый тестер есть пара Вот интерфейс фонарио тестер э наборы методов на самом деле для всех тестеров едины мы поднимаем окружение с это об э Тестируем что-то и натердауне тоже что-то происходит Ну собственно мы реализуем этот интерфейс декорируем оригинальный тестер Ну там через dependency injection все происходит симфонии Кстати в данный момент происходит но они хотят от Symphony уйти вот а в реальном методе в замене реального метода теста вот такие вот две вещи у нас пена что стоит обратить внимание то что у нас есть некая фабрика стратегий и некая стратегия которая осуществляет тестирование сама стратегия запускается с тем же набором параметров что и обычный тестер работает для фабрики нужен сценарий Ну и собственно декорируемый тестер сценарий Нам нужен для чего для того чтобы собственно вытащить информацию о версиях в частности это мы сейчас и посмотрим значит как работает это сильно порезанный код естественно Там намного больше аргументов намного больше кода но сама суть вот в этих строчках значит создание стратегии мы Передаем сценарий и оригинальный тестер через сценарий через ноту сценария мы вытаскиваем собственно диапазон версии стеков если он указан и почему это не напрямую сценарию gettax потому что там еще возможно для outline сценариев для шаблонов мы можем захотеть не для всего сценария а для каких-то наборов данных разделить по версиям и разные способы извлечения значит будет текущая версия А дальше мы просто запоминаем что на каждый чек стратегии не создавать завязались на тестер конкретные и на диапазон который ограничивает сценариям ну и собственно создали стратегию стратегия создаётся на базе диапазона версии я обращаю внимание кстати поехал табуляция не заметил на эту фабрику новую фабрика фильтров мы еще к ней вернемся на основе диапазона версии он возвращает набор фильтров который применяется к коллекции наших активных версий которую мы получаем через какую-то вспомогательную систему у нас тапи это тестовая API который используется тестировщиками Ну и разными тестами в том числе получаем коллекцию Ну и создаем стратегию которую запоминаем естественно дальше сама стратегия Как работает она должна как напомню эмулировать стандартное тестирование сигнатура там такая же она передается менеджер & werment сценария фича НОД родительный родительский и флаг пропуска Но это неважно на самом деле важно другое Так как у нас вместо одного теста прогон набора тестов естественно задаем массивчик для этих результатов и тренируемся по коллекции результаты прогона тестов организуем массив это кстати тоже встроенные тесты залс это встроенный комплексный такой композитный результат теста для набора например для экзамена для вот здесь практически идет дублирование того что происходит в оригинальном и за лэйтинг сценарию тестер изолируется инвой Армен в этот момент как раз создается фича контекст и в этот фича контекст мы пробрасываем текущую версию ретрируемые И в этот момент как раз у нас сценариях фича контексте становится доступна текущая версия которую мы можем подставлять в Planet Ну и дальше идет стандартные шаги стандартных тестеров проверка если прошёлся Tab то идём дальше и так далее еще маленький кусочек совсем по верхам репортеры и принтеры это то что организует вывод и сбор статистики в бехатах и там в коробке идет набор стандартных репортеров там пройти Print Джей Юнит так как все ноги растут оттуда Джей Юнит это xml такая которая понимает тимсити например и кучу других репортеров и принтеров их реализовывать просто достаточно принцип работы Тоже упрощенная схема предыдущая которая показывал на каждой переход от шага к шагу выбрасывается события на них через менеджер подписана куча слушателей в том числе и как раз эти самые мы расширили для июня трипортер кучу версионированной информации туда пропихали пропихнули вот и соответственно имеем помимо стандартного еще кучу дополнительной информации здесь время прогона и под какой версии было и было ли схлопнут тест Это я рассказывал на предыдущем докладе и Расскажу чуть коротко чуть позже собственно вся информация время прохождения мы еще собираем там сэкономленное время на прогонах И по моему последняя Вот именно протестирование версии это как у нас происходит выпуск версии коротко напомню или расскажу тем кто не слышал у нас версионирование И вообще API устроен фреймворк который поддерживает самописный Он построен на конфигах и выпускной версии у нас это копирование конфигов разрабатываемой версии в папочку с номером новой версии То есть он довольно-таки простой дальше система автоматом работает вот но там было я озвучил то что немного магии с тестами происходит сейчас про них расскажу зачем она нужна у нас есть разрабатываемая фича версия разрабатываемая у нас называется каминг грядущая версия в момент выпуска конкретной версии фиксации у нас будет скопирована но мы не знаем заранее какой номер версии будет Будут ли в ней мажорные изменения будут ли минорные Какая следующая версия мы не знаем разработчик опять-таки не знает когда его конец его кодом попадёт в основную ветку может быть за это время три версии выпустят естественно непонятно какую версию указывать в этих играх поэтому мы ввели два тега неопределённости для фильтрации до последней официальной версии и с грядущей как раз камеру и во время релиза когда механики автоматики становятся известны как мы инкрементируем версию вместо этих тегов подставляются конкретные теги версии То есть если у нас был переход с 87 на 9.0 мажорную изменение то будет Вот такие новые теги в фича файлах бехатов Так теперь как и зачем мы ускоряем тестирование быстрых огурчиков я не нашел Поэтому черепаху взял она тоже зелёная как я вначале говорил у нас 18 активно поддерживаемых версий которые естественно мы должны перед релизом тестировать у нас 3293 уникальных сценария умножаем получаем порядка 60 тысяч прогонов тестов по среднему по отчетам Я посмотрел один сценарий в среднем у нас выполняется чуть меньше секунды сумме дает порядка 13 часов у нас тестируется функционально поинты Даже при пуше разработческой ветки 13 часов ждать когда пройдет тест естественно нам не интересно чуть-чуть лукавил не 59 тысяч прогонов потому что новые сценарии добавляются только для новых версий у нас такое там нисходящее немножечко количество вернее наоборот восходящее ну реально по отчётам перед подготовкой к докладу было 53.000 тестов примерно ну 12 часов так тут я уже откосячился что за полтора часа Сейчас расскажу первое что приходит в голову Как ускорить тесты параллельно запуск по процессам взять и разбить то что бы вот количество процессов на тимсити например или на дженкинсе взяли или в гетлабе и раскидали по процессам параллельно Пусть выполняются Да они будут друг другу мешать надо другой вопрос для этого есть замечательная библиотечка Fest Она работает с Юнит тестами Она работает с бихатами есть отдельный режим в конфиг бехатов просто указывается без аргументов И вот так вот примерно так запускается там много параметров в нашем случае мы по восьмипроцессам разбиваем это оптимально для нас горизонтально конечно Можно бесконечно масштабироваться но бесконечно но не бесконечно смысла нет маленький секрет расскажу почему звездочка можно оптимизировать упаковку по этим процессам потому что естественно прогон будет равен прогону в самом заполненном процессе самой длинная фича попадет туда и будет ровно столько тестирование длится если две самые длинные фичи попадутся в один процесс то соответственно будет хуже если мы сортируем фичи по времени выполнения сразу перед тем как скормить Фест то упаковка будет оптимальной мы метрики собираем Мы в графану собираем Ну вариантов дофига и потом при запуске Fest мы скармливаем уже отсортированные по времени что мы с этого получили конечно фичи листы У всех разные наборы сценариев какие-то бывают очень тяжелые какие-то маленькие быстро проходящие поэтому сказать сколько мы выиграли и сколько у вас будет не могу Поэтому основную цифру измерения мы будем для последовательно выполнения тестов делать 12 часов для восьми примерно равных тестов для по 8 процессам это будет полтора примерно полтора часа тоже это мало интересно гонять так Мы подумали о том что для разных сборок возможно разные условия нужны для релиза важно Посмотреть например все для фичи отдельных нет смысла по всем версиям гонять у нас часть версии помечена где прикрепить или абсолет и соответственно нет смысла гонять это на каждый Чек и для разных сборок мы сделали собственно разные режимы В общем флаг где прикрепить и для прогонов частых мы просто перестали прогонять устаревшие версии в тестах и гоняем Это только ночью у нас порядка четырех версий сколько сэкономим по Короче дальше Вот он значит фабрика тестов которые там были мы просто туда флагом через запуск бехат и пробрасываем будем мы тестировать устаревшие версии или нет И просто в коллекцию фильтров добавим фильтр исключение версии который дополнительно к диапазону еще отфильтрует ненужные версии выиграли мы на четырех из 18 устаревших версий Ну порядочно 7,5 выполнения получилось у нас чуть меньше часа гоняются актуальной версии Мы решили то что В некоторых случаях между сценариями разницы в разных версиях в основном сценарии между разными версиями смысла нет повторно гонять потому что результат будет тот же тут я вернусь к нашему докладу с прошлой конференции три слайда оттуда украл и коротко напомню у нас как напомню значит кодовая версия backenda одна едино для всех смысле версии API сам фреймворк тоже один на момент по крайней мере запуска сценариев сценарий для разных версий для этого диапазона естественно Один он запустился и все что единственное разное это собственно пользовательский опыт в версиях API а напомню то что весь пользовательский опыт у нас лежит в конфигах соответственно все and Point и все их ограничения вся сущности это просто текстовый файл и можно получить информацию естественно не обо всей версии а тех сущностях пойнтах которые в данном сценарии были использованы мы просто пробрасываем дополнительный заголовок вапе который говорит собери мне информацию о том что ты вот при этом запросе использовал такие сущности Какие поинты какие фичи флаги и отдай обратно эту информацию у нас это возвращается и мы можем сравнить дайджесты сущности и посмотреть сам набор сущности Было ли изменения между ними если не было изменений то при единой кодовой базе Едином сценарий и одном и одним набором конфигов которым собственно отличается версия смысла гонять Второй раз нет если он упал первой версии для второй Он тоже упадет если он отработал значит если у нас набор один сущности то мы можем лишний раз не гонять вот предположим то что для разных версий для сценария 2 на 4 и так далее сущность набора сущностей и поинтов были едины они не менялись между этими двумя версиями соответственно мы можем схлопнуть и намного меньше тестовых прогонов сделать реально у нас экономия вот на таком схлопывании на полном прогоне всех версий порядка 40 процентов это очень существенно как это мы делаем возвращаясь к слайду где у нас была итерация по коллекции версий мы ее поменяем во-первых на обратную итерацию чуть лучше и оптимальнее от самой последней идти в обратную сторону и если у нас есть флаг схлопывания версий то есть мы не хотим перепроверять себя и если у нас эквивалентная набор сущности их дайджесты между двумя текущей проверяемой версии и референсной образцовой то есть предыдущий то мы вместо прогона присваиваем результат время прохода и прочие информацию текущему прогону и само тестирование не проводим Иначе если атмос или изменилось что-то Мы реально запускаем и запоминаем версию Как референсна как образцовую следующая версия мы будем сравнивать уже с этим вариантом Ну и собственно всё что мы на этом выиграли для тестирования по всем версиям у нас полтора раза выросла Но даже чуть больше чем 40 процентов 8 часов при последовательном примерно час для восьми процессов И если мы еще дополнительно флаге используем то вот 5 часов 40 минут тоже не очень еще замечательным вот для релиза еще пойдет прогончик такой если он нечасто происходит для работы ветками разработчиков локально не вариант мы начали развивать идею с режимами запусков и собственно Вот к чему пришли во-первых расскажу как собственно Factory работает как мы уже встречались У нас есть набор фильтров которые основан на тегах ограничения версий с версией или фром или короче или ту на советовал у нас Элементарные фильтры больше или равно меньше или равно который добавляются к коллекции версия потом у нас вот флагов так Эксклюзив вершин фильтрс что-то подвисает Ладно Нижняя строчка мы его мы эти теги From и ту Верните фильтры mergium с флагами исключения с фильтрами исключения если они были заданы и на базе вот этих фильтров многих других мы формируем разные режимы запуска которыми для разных сборок можно присваивать Full который не используется и даже по умолчанию не стоит это просто нету режима мы Тестируем всё подряд Ну исключая теги самих версий ограничений Major мы фильтруем все минорные версии откидываем их Тестируем только самую старшую версию в мажоре добавляется если это режим передали коллекции фильтров добавляется отфильтровать все лишнее все лишние миноры стрикт это больше для разработчиков Но одно время мы так тестировали фичу ветки это еще один параметр добавляется то есть помимо режима режим strict и какую конкретную версию Мы хотим протестировать разработчики локально там запустили только об Каменку вся гоняют самые свежие версии остальные версии уже на сервере пройдут вот просто по одной версии прогнали и всё и режим Max который у нас сейчас довольно-таки активно используется во всех кроме релизных и ночных сборках это мы для каждого сценария используем максимально подходящую версию часть конечно пропускается иногда поломов обратная совместимости но на полном прогоне это всё равно найдётся это режим намного лучше чем strix чем Major потому что он прогонит каждый сценарий на этом мы получили очень большой прирост по крайней мере разработчики перестали материться то что у них фичу ветку они не могут полуre-quest создать потому что у них тесты до сих пор идут порядка шести минут при раз параллеливании у нас на самом деле так как фичи они разные есть очень большие А у нас чуть меньше 10 минут идёт прогон фичи ветки на на все версии в режиме Макс Ну вот так вот под свечу обратно цвет добавлю по всем режимам Ну с 13 часов до 6 минут кажется довольно таки неплохо итоги коротко мы узнали что такое бехат функциональное тестирование вспомнили геокен Как работать Как улучшать парочку приемов Как тестировать вейпиайвер сианированный И как мы ускоряли прогоны известные проблемы известные проблемы на нашем решении конкретно у нас Мы не решили проблему с версионированием background как я уже говорил бэкграунд встраивается в каждый сценарий он реально вызывается сценарий от тестером естественно берет теги от родителя более того по-моему даже в бехатах не реализовано возможность поставить бэкграунду теги могу ошибаться пока что вот такой механизм стараемся в background либо не пихать зависимые от версии шаги либо разносить по разным фичам чтобы один бэкграунд на один набор сценариев работал второе мы не решили проблему затрат в работе с тапе тапе это тестовая у нас которым пользуется создание таких моков но не мог а точнее тестовых данных на в тестовой среде Создать пользователя создать компанию у нас тапе избехатов дергается по сети соответственно у нас затраты на сетевые издержки не такие уж и большие затраты будут строп системы и так далее и шагов бывает очень много и иногда до 30 процентов времени выполнения сценария это обращение сейчас у нас в процессе на самом деле у команды платформа задача по там два варианта решения если интересно могу сказать вопросов уже пора заканчивать и собственно Есть еще одна проблемка это поддержка У нас сейчас Монолит но он пилится по сервисам мы ввели уже заранее сколпы для того чтобы разделять по пользователям в этой с наборами своих сущностей и так далее наборы версий в том числе и сами пехота с осколпами ещё не работают Сколько уже есть бэхатты пока только дефолт используют Ну собственно вроде как всё то ссылочки обещанные собственно бехат документация ссылка на github ссылочка на параллельный запуск тестов ссылочка на мой доклад предыдущий про наши версии и там же по qr-коду этому это Telegram страничка там же ссылочка на презентацию чтобы посмотреть код повнимательнее если кому-то надо Ну и финальный слайд с вопроса Спасибо за внимание Оцените пожалуйста доклад Спасибо большое Можно я еще добавлю Да чтобы поактивнее вопросы задавали тут подарочек от superjoba мерч за лучший вопрос Это шопер и вот такая толстовочка собственно таким образом является сессия вопросов ответы задавайте свои вопросы и получайте приз от Антона Станислав Спасибо Смотри вот упомянул что для идентичности версии вы используете особенность своего фреймворка да то есть где-то заголовочках ваш фри Норок рассказывает А что у версии под капотом там набор сущностей ты сказал ну и ещё чего-то ну а Представь что это пришлось бы реализовывать на каком-то более общепринятом фреймворке вот какой путь ты видишь например на симфонии да А чтобы сравнить идентичность двух версий А это да это Забавно вопрос но у тебя есть толстовка Я помню А я ещё хочу я могу сказать очень просто на самом деле это же реализация Импакт анализа это известная проблема в тестировании Как определить что изменилось что тестировать что-нибудь тестировать нет Советов это именно плюсик такой нашего способа вертионирования через конфиги потому что дайджесты строк сравнить легко и получить легко анализировать что было вызвано большие затраты Привет Спасибо за доклад Меня интересует вопрос касающийся подготовки контекстов и в части написания сценариев аналитиками Откуда Там аналитики или тестировщики знают что есть в контексте Да кстати это большая проблема Дело в том что георгином могут пользоваться и тестировщики и системные аналитики могут писать У нас это к сожалению не получилось но мы в процессе мы не унываем Надеемся когда-нибудь хотя бы тестировщиком отдадим мы сами пишем и сценарий и реализуем шаги вообще в идеале работа разделена так разработчики подготавливают нужные для тестов шаги реализуют ими пользуются Если нужен какой-то новый уникальный шаг мы разработка допишет потому что там все-таки реализуется действительно уже на печкой но у нас большая коллекция у нас там этот Шторм по крайней мере точно подсказывает Шаги на основе этих регулярок у нас иногда два слова написал у тебя зависает Шторм потому что пытается подгрузить все варианты Спасибо немножечко слепит в очках вот еще есть я сейчас отвечу на вопрос Если он не прозвучивает Антон Спасибо за доклад Вопрос такой показал ваши как бы эти режимы запуска тестов которые сокращают А вот мне интересно все равно продукт у вас большой отрабатывайте есть Stage который по-любому гоняет сколько-то тестов вот вас вся какой режим запуска используется Значит у нас На тестах Значит у нас есть да у нас классическая система работа с гитом У нас есть фича ветки в которых работают Разработчики у нас есть деф редко в которую вливаются этих вещей и по расписанию для бэкэнда это два раза в суд в два раза в рабочий день у нас релиз на базе DF ветки создаётся релиз тестируется Ну и потом естественно мастер всё это едет так вот для фича веток у нас режим Max чтобы по-быстрому прогнать для релизов у нас депрессии меняется по всем мажорным версиям то есть onlymager для то есть мы проходим по всем актуальным версиям каждый сценарий прогоняется Это около 45 минут на самом деле чуть побыстрее Я такой общий сделал мы еще даже реализовывали механизм определения на основе длины фич величины фич мы определяли насколько процессов выделить оптимальнее То есть как упаковка будет более меньше процессов займет но при этом короче будет вырабатываться ну там разница вышла в пяти процентах и мы вот на самом оптимальном восьмёрочке остановились режим так а ночами мы гоняем уже на Мастере полный набор нефул а Major с отключенными флагами пропускать где прикрепить версию Большое спасибо за до мне заданный вопрос я хотел в процессе доклада но забыл Странно что никто не спросил Может быть все поклонники бехата Почему бихаты они концепшн или что-то ещё причины две одна для таких докладов классическая стабильная потому что к исторически сложилось к моменту когда мы начали вельцинировать и прочее у нас уже куча предыдущих операций разных API тестировал с бехатами а-а а вторая более важная из-за языка георгин собственно вот это вот описание сценариев очень-очень помогает всё так онлайн У нас сегодня нет вопросов вообще встречаются что еще раз онлайн трансляция туда вопросы Идут они пишут в чате нам бы сообщили бы если бы вопрос в онлайн те кто смотрит нас онлайн напоминает то что вы можете писать в чате вопросы и мы их зададим нашим спикеру так так если вопросы все то наверное да надо решать Альберт ты простишь меня наверное да Я просто не хочу тебя вторую давать я понимаю то что они хорошие Тебе нравится Станислав если с размерами будут проблемы Поймай меня что-то решим так Ну спасибо и небольшой Презент нас как организатор Спасибо тебе за твой контент подавать свои доклады еще был очень интересный Здорово С вами был Антон салатилин и суперджоба и рассказал про тестирование версии будет небольшой перерывчик и мы скоро будем продолжать Спасибо"
}