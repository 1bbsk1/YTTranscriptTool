{
  "video_id": "Us6cHVNA4vk",
  "channel": "HighLoadChannel",
  "title": "Инструменты создания бэкапов PostgreSQL / Андрей Сальников (Data Egret)",
  "views": 11255,
  "duration": 2934,
  "published": "2019-05-15T02:50:37-07:00",
  "text": "очень теперь официально здравствуйте меня миков андрей я сотрудник компании ты и горит и это доклад будет посвящена инструментам создании бэкапов по сгрыз в подписи сначала о том кто мы моя компания fine того что основная наша деятельность это мы работаем как удаленные администраторы у нас достаточно большое количество клиентов есть огромные базы и есть куча маленьких бас есть всевозможные смеси когда одна большая база как кучка маленьких или маленький и не совсем маленькие также мы оказываем услуги консультирования аудита это случай если людям не нужна поддержка постоянно но нужна какая-то экспертиза так как postgres является open с открытым продуктом то мы естественно участвуем всевозможных конференциях в плане того что делиться своим опытом и всячески помогать продвижению по сбросу потому что база данных она действительно хорошая и получается так что мы видели довольно много профили нагрузки и и выходные нагрузки и web нагрузки и смеси нагрузок и базы падали по-разному смочим о опыта достаточно много вопрос такой это самый кстати интересная часть сайта кто зачем нужны бэкапы скажет ну намного взгляд еще варианты ясно ну смотрите на самом деле не нужны чтобы мы могли отдыхать спокойно чтобы вы могли спать спокойно чтобы мы могли тусоваться на концертах спокойно ну да такие случались всякие вот это основная цель с точки зрения ты была зачем нужны бэкапы чтобы все было спокойно нашей жизни потому что если есть бэкап и проверенный то мы можем всем этим заниматься а вот что там с базы произойдет это уже дело десятое какое есть ассортимент инструментов для создания backup of в мире по сбиться это встроенный инструмент пиджи дам baby-g дом dump of all и пейджер restore для восстановления это единственный инструмент который позволяет делать вам логическое бы копированию данных то есть педант он вам может как на vpn текст из quelle вы вывалить так и в небольшом таком бинарный фанатов формате ки вывалить данные и он идет из коробки с мозга сам следующий инструмент для создания бекапов которые тоже ждет из король из коробки и дальше начинается от инструменты дальше они все будут инструменты для создания бинарных backup базы данных видишь бы изме cup это тоже инструмент идущий из коробки который позволяет нам наливать реплики для поиска риса и соответственно снимать бинарную копию базы данных снимать консистентную бинарную копию базы данных и если мы хотим еще во времени иметь возможность архивировать а то мы можем настроить позволит так чтобы архивные логе его сваливать куда-то на какой-то диск это вот базовые инструменты они хорошие они дел выполняют свой функционал на 5 но они неудобные с точки зрения управления и какой-то массовости там когда у вас 20 баз данных это нужно будет вам заниматься ши лэ скриптинга самостоятельно следующие два инструмента специфичные чисто обычные инструменты это в валл-и его у g и разрабатывают их одни и те же ребята ну разработка вали закончилась и они переключились на вал g эти инструменты ориентированы для в основном для амазона и для хранения у вас 3-го ли еще умеет работать с google колдун с азура и с диска you системой просто вы можете указать какой-то удаленный диска во лжи работает только с amazon им только сострить ну или либо любым другим с 3 похожим интерфейсом мы их пользу им хорошие штуки я дальше в деталях буду уже разбирать каждый инструменты и нас следующая пачка инструментов это инструменты которые опираются на пиджи боюсь-боюсь backup или использует его сам или как каким-то образом реализует его функционал они все написаны разработчиками которые количество основной postgres и имеют свой форк коммерческие которые продвигают нам в своем кругу влияния наиболее популярный инструмент бармен который у нас используется довольно широко по стране это по сути делала обертка на питанию вокруг пиджи bass backup а ещё он может работать по ssh протоколом очень интересный и очень многообещающей инструмент пиджи bb крест о он я не помню там и от кого но тоже ребята продвигают его то есть занимаются под грифом и и активную в его комитет изначально он был написан на питоне сейчас версия который используется она написана на оси для ускорения для возможности в параллельное выполнение снять а быков пиджи пробы копыта в туза от наших коллег российских в поисках professional который позволяет делать инкрементальные бы копы такие достаточно маленького размера и последнее туза это backup and recovery tool от компании enterprise baby у нас она не очень популярна и и она в основном для centos redhat ветки линуксов для ubuntu с ней по моим тяжело и связи с мамой популярность у нас ее почти нету нигде в инсталляциях дальше основные составляет я попытался по этим инструментом вообще потому что мы хотим от бы копирование разбить на какие-то вещи которые важны достаточно первые нам важно как мы будем это хоронить на каких дисках на каких сервисах и там есть список характеристик of характеристик по которым мы пройдемся следующие разделение данных кто-то я подразумеваю то что можем ли мы при снятии backup или восстановлению backup отпилить от целой целого инстанции базы данных какой-то кусочек и работать дальше с ним как с целостным целостной базой насколько они поддерживают разные версии б.д. какие режимы работы у них есть плане параллельности в плане какой-то автоматизации и и тому подобного и сервис ность это насколько мы можем их выделить в отдельный сервис отдельный сервер который будет сам ходить по базам данных и по какому-то расписанию снимать бэкапы и давайте пойдем по этим с какие характеристики нам а еще вы лидировали да и его лидирование это хотелось бы чтобы backup еще проверялся в плане того что мы из него гарантированно потом сможем восстановиться и у нас будет нормально не поломанные базы данных и теперь вот это по этим 6 большим пунктам пройдемся более детально и буду помечать там как какой инструмент что нам даст по хранению файл в системе хранить они могут все то есть мы можем при монтировать диск и наши и операционки и сваливать туда бэкапы все инструменты это позволяют делать ну это в принципе то же самое потому что это в нашей локальной файловой системе получается в амазонии у нас могут работать три инструмента этого обживали при чем тут ходят коллега который занимается разработкой вал джива ли вы его можете поймать из компании яндекс их двое кстати товарищи ходят сюда и не очень не дошли это обещали и еще пиджи бак раз позволяет работ ну сваливать бэкапы выстрел и этим он очень интересен потому что среди вот таких тулс borman и так далее он единственный кто умеет работать сама зонам саду рам и так далее только вали google только во ли кто-нибудь кстати пользует азор google для своих баз данных да у вас без вариантов ребята если вы хотите их обычными хронических хранилищами пользовался я сталкивался со взором но там как бы сталкивался в плане миграции на amazon базу данных дальше по хранению логическую копию данных и нам предоставляет только пиджи домперидон дампа а разница между ними то что дамп обрабатывает весь instance база данных жидам вы можете указать конкретную базу данных на инстансе и работать с ней бинарный копия все остальные в этом уже говорил немаловажный фактор при хранении это то что если у нас мы ограничены каким-то образом по дисковым ресурсам то частенько возникает ситуация когда мы распиливаем базу данных по разным табличным пространством это и в верно и для железных серверов потому что не хочется там среды мучиться добавляешь новый это верно для облаков потому что там есть определенное ограничение особенно когда берете тачку с и новыми дисками и там как бык сколько воткнута столько воткнута у амазона там расширять можно только там где бы изысками и при восстановлении дампы нам будет дважды чтобы мы могли бы перераспределить эти табличные пространства и назначить их по новым путям и на новые диски и вот это хорошее свойство присутствуют у вали во лжи пока не умеет с этим работать пробы копается этим работать бармен bass backup джибо крест то есть довольно широкий спектр инструментов и эта вещь бывает довольно часто важно особенно когда у вас там 80 терабайтный базы данных то есть у нас среди клиентов продакшен и почти все эти базы данных развалины пола табличным пространством два или три табличных пространствах теперь другая вещь о том на какого размера у нас могут быть бэкапы это все пойдет контексте бинарных бэкапов понятное дело что бинарный бы к поэту сколько у нас базу весит столько мы скопировали у бесит 8 терабайт мы скопировали 8 терабайт там один мегабайт весит 1 мегабайт скопировали и как бы как экономить место когда мы хотим длинную цепочку бэкапов для этого придумали некоторые инструменты то есть база данных хранить данные своих файликах если у нас допустим какая то длинные архивные база данных понятное дело что реально мы меняем там небольшой процент этих файлов и для этого делал придумали дифференциальные бэкапы дифференциальный backup что из себя представляет мы смотрим какие файлики изменились и только их копируем на хранилище где храним бэкапы а все остальные файлы мы handling он просто при собачьего им к этой базе данных и получается что мы тем самым экономим место и при этом можем спокойно удалить старые быка базы данных не попортив более свежие эта штука хорошая но решили пойти дальше придумали ничего инкрементальные бэкапы их две штуки есть вы заодно для себя помечайте какие инструменты с этим умеют работать инкрементальный бы копая есть два вида первый вид это на файловом уровне от дифференциального от дифференциальных бэкапов он отличается только тем что дифференциальный ориентируется у вас на полный backup базы данных и по отношению к нейминг не мог как раз div вот этот файлов и копирует инкрементальный backup может ориентироваться на дифференциальный бэкапы копировать только те изменившиеся файлики которые относятся к изменились по сравнению с дифференциальным бэкапом и для инкрементальные нужно будет вся цепочка то есть основной backup 1 инкрементальный backup он всегда будет дифференциальным и дальше там вот эти все инкрементальные бэкапы дифференциальный backup всегда ориентируется на полный backup базы данных инкрементальный может на другие виды backup но ребята еще сделали в двух компаниях этот фон с professional там кстати как-то не все видно что ли получается картинка пиджи по робокоп и enterprise д.б. система хранения бэкапов они пошли по другому пути инкрементальные это по блоку потому что файлики мы можем изменить не весь файлика блок данных которые мы изменили и они вот эти тузы они бегут повал файлам и выбирает у вас ровно те блоки которые изменились и в backup сваливают именно вот эти блоки для того чтобы восстановиться с таким бэкапом инструментальным вам тоже нужно будет полную копию базы данных и плюсы вы еще можете хранить вот эти инкрементальные кусочки которые они набирают и звал это накладывает некоторые ограничения на эти утилиты потому что они должны бегать по вал файлам для ванильного поздно леса они всегда бегают по сгрыз professional для их версии у них там учил слой файл еще один слой на файловую структуру базы данных наложен они довольно быстро эти блоки ищет и такие инкрементальные бэкапы получаются совсем маленькими если у вас база ну как бы изменяется небольшой процент базы потому что в файл пишется довольно много технической информации и вырезаю там и 16 мегабайт они вырезают реально там по десятке килобайт для бэкапа ну вот дальше разделения данных разделение данных тут подразумевается то что если нам нужно бы копировать не все или восстанавливать не все это возможно только при логических бэкапов и это нам позволяет делать только вы пиджи дам пять лет и они довольно широкий функционал предоставляют тоже педант может позволит вам без данных и сдам пить база данных структура если вам нужно можете конкретно одну таблицу с дам пить или можете исключить одну таблицу из дампа или список таблиц создам пить список исключить функционал довольно широкий в этом плане минус за это то что при установлении из такого дампа если у вас большая база данных вам придется потратить достаточно много времени на то чтобы восстановиться с него потому что это все нужно проигрывать на чистом инстанции по адресу очень удобная tell that you till it is использовать случай когда у нас мы ну как переоценили свои силы и на сознавали кучу мелких баз данных мы можем их слить в один instance мы можем распилить так если мы опять-таки переоценили наш силы у нас распахал базы данных или меняем архитектуру tans монолита на сервисную и распиливаем данные данфорд передам в этом случае единственная вещь которая позволяет это делать безболезненно и еще можно восстановить одну б.д. и вот тут вот указан и жиба крест у него есть такая фишка то что мы можем указать что нам из бинарного backup а нужна только одна база данных что он делает он восстанавливает базы данных по умолчанию из бекапа это темплейты ip-адрес и тут база данных который мы указали все остальные базы данных он файлик из обновляет и делает нулевой длины то есть у под колеса довольно прозрачная структура хранения баз данных файликах и там можно на этом уровне как бы сократить восстанавливаем баз данных но допустим нам нужно найти каких срочно данные свинарник и не хочется 10 терабайтный базу подниматься на станке база и мы поднимаем одну которые допустим там 5 всего травы занимает ну то есть 2 по 10 были и в данном случае конечно резистентность глаза нарушается но для каких-то быстрых решений когда вам необходимо срочно кровь из носа поднять данные из большой базы данных которых их несколько то это очень хороший инструмент очень хорошие фича которой есть но как полноценный полноценную базу это не стоит рассматривать при восстановлении это именно для аварийных работ как обстоит работа с множеством версии б.д. тут тоже все достаточно интересны передам очень хорош в плане того что мы не привязан не привязана к тому какую версию бдсм восстанавливаться и там есть режим по intext и и он вас то и это просто иску или чисто из quelle который описывает струс всю структуру базы данных все данные вы можете в принципе оттуда восстановиться куда хотите в мае sql mssql оракал с небольшими правками этого дампа ну и соответственно между версиями под брюсовым мажорными тоже достаточно легко гуляют вот эти дампы мульти version ность что под этим подразумеваю это то что насколько tool за может обрабатывать разные версии баз данных работать одновременно с десятым полис омс 96 с 11 все кроме встроенных это передам по и перебить backup а потому что они привязаны к конкретной версии с которой идут вот остальные ориентируются на эти утилиты и для и им подсовывается можно пацану говоришь где находятся все эти предже bsb капель разных версий они соответственно с версии под гарса выбирают актуальную утилиту для снятия backup для создания реплик санбой серверов подходят все утилиты кроме пиджи дампа потому что это логически бэкапы вот и использую любую из этих утилит вы можете на как бы восстановить сервер и подключить к мастеров для работы как реплика этого сервера тут кстати неполиткорректность плане реплика мы у себя это давно используем слово вот следующее это как могут сниматься бэкап и вообще с какие режимы существуют для снятия бэкапов можно просто копировать файлы стандартными средствами при тонкие ssh протокол использовать для этого расинг степи и может какие-то другие утилиты которые есть почему вот такой возможности есть потому что они позволяют параллели копирование и делать это в несколько потоков пиджи бпс borman они позволяют так работать бакр с только так работает borman он может работать так может работать по протоколу пузырьковому протокол по сгрыз которые когда утилита бы копирования подключается по сгрыз у и по протоколу репликации тянет собственно горя ведь все файлике и плюс еще архивные логе которые возникают в процессе снятия backup а это умеют все остальные и бармен все остальные табак все остальные-то интерфазе би пи джи & bass backup то чем вы сталось вале и так далее бэкап с реплики умеют принципе все это зависит от версии пост грессов то есть десятки одиннадцатом мы можем с реплики снимать бэкапы но я не рекомендую этого делать вообще никто из нашей компании будет это рекомендовать делать потому что есть ситуации когда проморгали по мониторингу месяц снимали с реплики backup которая отвалилась от мастер сервера и неактуальную то есть бэкапы в любом случае всегда нужно снимать с мастер сервера только в таком случае вы будете уверены то что у вас действительно актуальный backup базы данных многопоточность бэкапов это умеют все потому что все по разным причинам кто-то через ssh пар такого кто-то реализовал на уровне под сасово них база данных кроме быть бекапа и борта потому что борта опирается только на быть backup при снятии бэкапа и он к сожалению однопоточный и и не будет многопоточном ага это я хотел вам показать в плане того что многопоточность и воткнул картинку у меня бывает стация восстанавливалась метро обратную базу данных и когда будете опера ориентироваться на выбор системы для снятия бэкапов вали написанный на питоне вол'джин написан на кожу и мне 8 терабайтами базу приходилось останавливать вали уперся в ограничении питона и но у меня с амазона со скоростью 600 километров час до 600 мегабит секунду и все никак выше когда я переключился на вал д ну там оказывается вали был косяк в плане того что он не мог вернее вол'джин был баг он не мог работать с бы kappa me вали но мог тянуть вал файлы поэтому вот эта вот картинка маленькая это я снял восстановил базу данных а дальше накатывал валы которые лежали там же в с3 и к определенной точке во времени восстанавливался и вот тут вот валгаллу но они оба пора ли лица давали уперся в ограничении питона вы и попались в питоне он такой условный овал g уперся по сути сделал в интерфейс из 3 то есть насколько быстро ис-3 каждый момент мог отдавать настолько быстро он и забирал среднем это было два гигабита в секунду что достаточно хорошо вот свали ребята час изменения в базу на получали за 45 минут проигрывания за счет того что вот ну высасывал с такой скорость свал g получилось что они час изменения в базе данных накатывали где-то минут за 5 вот и как бы новая на 8 терабайтный базе данных когда там изменение наваливаются сопоставимое количество терабайт это довольно актуальная вещь режимы работы что тут есть у нас интересную систему бы копирования восстановление во времени к определенной точке если у нас есть архивный логии мы их копируем мы можем восстановить позволяет это делать систему бы копирования это как бы стандарт де-факто главное чтобы мы хранили вал файлы где-нибудь дамб и естественно это не умеет потому что они немножечко другом регулировка нагрузки на сеть это довольно важная вещь потому что как я говорил снимать dumps мастер сервер желательно тогда вы себе гарантируете то что вы действительно актуальный bk получаете ну иногда бывает сервера настолько нагруженные шток вклиниться туда довольно сложно у нас некоторых клиентов такой от отдельно сетевой интерфейс иногда там в минимальное время нагрузки делается а еще хорошо когда если мы можем это как-то отрегулировать сетевую нагрузку на сервер и сказать что у тени backup вот с такой скоростью это позволяет делать бы языка бармены барт то такие конфигурационные параметры имеют в принципе валево у g тоже позволяют через параллельность то есть увидишь потоков дал нет да ясно я просто не обновлялся запасайтесь ну вот в волевом g тоже умеет регулировать нагрузку на сеть и это очень полезное свойство следующий фактор это сжать элиту и тут в принципе ну то есть это опять-таки к вопрос того того сколько мы будем передавать по сети если мы сможем жать файлик до отправки в хранилище то это хорошо налета и это умеют почти все вот главная там указать уровень сжатия сервис ность что тут у нас интересного по системам бы копирования может быть мощный достаточно силой это довольно хорошая штука потому что он нам позволяет при крутиться с точки зрения мониторинга кбк по и посмотреть там сколько бэкапов у нас есть какой точке по времени мы можем восстановиться можем вообще просто статус посмотреть утилиты и в принципе все кроме встроенных они имеют довольно хороший силой по полезный и его желательно изучать как бы когда выбираю себе систему бы копирования чтобы знать какие возможности дает некоторые даже для мониторинга специальной командами что вываливать удобочитаемым формате данные там дальше просто распарсить их и по простенькому и все как выделены сервис на отдельном сервере могут работать бармен бо крест и барт все остальные должны стоять рядом с базой данных и это плохо потому что когда мы хотим собирать за 20-30 баз данных а есть такие люди у которых там развалины то куда проще поменять конфиг у сервиса на одном сервере подцепить туда как бы точку базу данных откуда тянуть нам бэкапы и тянуть их и сваливать на один сервер выделенные для этого но к сожалению это позволяет делать вот немногие структурированное хранение бэкапов это вот как раз важная вещь с точки зрения того чтобы мы могли быстренько посмотреть за какие числа у нас есть backup а какого они размера валидны или эти бэкапы если у нас не необходимое количество архивных логов для этого дела для того чтобы восстановиться куда-то в году по времени дальше все это узы старание но не встроенные они это умеют умеют с разной степенью хорошести в принципе минимальный функционал данном случае все предоставляют политики хранения политики хранения это то насколько долго нам необходимо хранить бэкапы и надо и и насколько сама утилиты бы копирования может ротировать эти бэкап и вовремя удалять ненужные там оставлять какие-то на долгое время от все вот эти перечисленные они имеют политики хранения которые можно прописать в конфиге и вы прописав конфиге просто когда в очередной раз утилитка запускается оно при снятии backup атом или запихивания вал файла просто проверит ей если что удалять по политике хранению удалит случаях сваливал g там нужно в крон запихнул запихать задачу что мы удаляем бы копытом далее старее чем столько-то количественном и по количеству удаляем мы 7 бэкапов храним у клиентов обычно вот я не знаю по времени там можно андрей вот то есть валя он тоже позволяет но через cron назначит такую политику за лидирование выковал хотелось бы чтобы мы были уверены при снятии backup а потому что хороший backup это тот который потом ещё подняты поднять сервер и прогнали на нем ти тестами кто это делает вот две руки так но уже 6 да так но практика показывает что делают от среди наших клиентов никто не делает то есть пока они не пришли никто не делает хотя они потом начинает делать потому что настей за накатываем из дампа какие-то утилитки пишем есть некоторые вещи которые позволяют нам быть но не стопроцентно ну достаточно хорошо уверенными что у нас баков валидный при снятии во первых мы можем когда операция закончилась с помощью сила я посмотреть что же там у нас сохранилось и валидный ли эти бэкапы как это проверяется ей есть несколько вариантов первое что нам интересно то что мы за действительно скопировали все файлы которые нужны и эти системы бы копирования после того как зальются файлики должны поставить чтобы cove валидный пока заливают он должен быть в прогрессе если отвалились он должен быть файл в принципе они все это умеют хочется еще большего есть еще большие вещи этот механизм checksum подгрести он работает только в том случае если вы включили у себя checksum и в подгрести если у вас база данных без включенных checksum к сожалению никак не провериться вот эти вот две утилиты они в процессе снятия backup а вообще ругаются то что у нас нет checksum и если что-то не так произошло и проверяют в общем-то валидность файликов и блоков файлик в пачек summum вот второй пункт которую валидны завершения быка потом в процессе копирования снимается человек сумму файлика он когда скопирован чек сумму проверяется на на хранилище это вот так мы лидируем в принципе получился у меня не очень много на удивление обычная дольше рассказу это ссылочки по всем этим утилитам которые вам могут по ну если какая-то прыгнет приглянётся к которым вы можете почитать конкретно тут все перечисленное а до я скину только чуть-чуть попозже вот ну вообще как отказаться они в общем доступе докладывать слайды готовы но как это выкладывают так что можете вот там найти очень у меня всё это довольно такая тема короткая но как бы я когда смотрел обзору полного нету что могут делать тоже непонятно в данном случае цель основная было дать представление о том кто что ездит из них умеет у меня и будет не то после где зависимости от того кто придет и что пожелает мы настроим ту или иную систему бы копирования прямо на практике тут сейчас если есть вопросы они должны быть по идее задавайте потому что ну как говорить можно про это бесконечно вот так что давайте по вопросам этот микрофон будут раздавать поэтому вот вы сказали чтобы копы лучше снимать мастера подключения что реплика может там отстать вывалится изменит оринга быть не актуальны и соответственно уже есть даже такие методы которые позволяют нам ограничить пропускную способность чтобы не сильно нагружать мастер во время backup а ну а не лучше ли и как альтернативу рассмотреть все таки бы копирование реплики и одновременно например мониторить эту реплику мониторить лак отставание реплики там что ну как бы убеждаться что она актуальна вот здесь есть какие-то может быть подводного до в таких случаях можно с реплики снимать но в данном это если вы гарантированно уверены что она не отстаёт и так далее большинстве случаев как настраивает бы копирую настроили и забыли все если что-то пошло не так да по таким вот причинам которые но backup ты с ними снимется с реплики если отвалилась качество настраиваемых мониторинга впору жизнь показала что она в большинстве случаев ужасным и конкретно с базами данных на них довольно частенько польют чтобы мониторить необходимом количестве и реагировать на allure ты пришел allure там благ большой один раз два пришел он коп она отвалилась олег ты перестали идти потому что там как бы чек за ним замутила это тайлер ты все забыла паттон через месяц оказываться но по она у нас реплики нет особенно если она не участвовать нагрузки если она в нагрузке участвуют читающий да вы это сразу обнаружить и если не участвует то поэтому сначала лучше настраивать на мастере ну это просто жизнь то есть не раз сталкивалась с такими ситуациями то что люди просто ну как бы забили ну вот как болотам выяснил что отвалилась так вот тут-то ты чего-то руки с вопросами спасибо за доклад очень много интересных все вид показали а сравнили вы сравнивали не вы производительности там скорость как они системы нагружают ну некоторые могут там несколько потоков забьют ли они там сесть на примере так далее поняла указан номер и у нас есть только один проект на поддержке где он действительно ребята это сервис от такой сетевой соцсеть и у них на каждом сервере с базы данных есть четыре интерфейс и это в их случае действительно там забивается интерфейс то есть один интерфейс для репликации есть один интерфейс для снятия бэкапов и два интерфейса для обслуживанию нагрузки от приложений всяк остальных случаев сетевых интерфейса хватает как правило спасибо еще один вопрос скажите вашу любимую утилиту или вы мы с 8 по счетам подзадача это зависит от задач потому что в облаках там особо не вариантов нет в амазонии там вали ну лоджи без вариантов а сейчас я на фиджи б крест смотрю в этом контексте попробую потому что интересная штука а так стандартный borman пиджи дам принципе быть бекапный там шоу кривченко 2 все зависит от того что хочет нас конкретно приятно четырем готов и какое оборудование предоставляет соответственно выбираем систему спасибо спасибо за доклад скажите пожалуйста могут ли быть возник какие-то сложности при использовании расширение погреться добавление типа данных например гнуть пост гиса или чего-нибудь такого либо ни ада вырезали там все потенциальные возможности проблем или нет потенциально вряд ли возможно потому что к случае бинарных бэкапов мы копируем файлы нам без разницы наполнение этих файлов по сгрыз случай если он там чиксу мы включены позволь сам проверяет от checksum если кривое расширение но она убьет вам базу и работающую вот но это не под гиса допустим вы сами как то там с логической репликация неудачно игрались пиджи дампу он вообще шикарен в этом плане потому что он вываливает по сути дела и сколь команды то есть его всегда можно развернуть выставили команды то что он там надо надо надо ампер и вырезать ненужные вещи он кстати используется в этом плане как проверка возможности мажорного апгрейда с мы снимаем дам накатываем на новую версию задать главных вот а так нет проблем не возникает из-за расширение точно и еще вопрос вроде были андрей спасибо за вопрос коллегия по поводу реплики дам посредники но сказать что причина что реплика можешь танцевать это единственная причина по которой вы против вы кого или есть какие-то другие весом и это основная самые важные причины уакиль отдам по на от бэкапы дампа нам важен чтобы у нас всегда были актуальные данные на момент снятия его если они не актуальны ну то есть это обычно как происходит вот забили о том что тут случилось начали искать про этого нет и все если сделали дампу сначала проверить насколько реплика отстаёт если сильного но как-нибудь за появились ну вот это рекомендации снимается мастера это чисто человеческий фактор просто она из-за человеческого фактора потому что люди имеют тенденцию забивать я понял спасибо и второй вопрос вечер я правильно понимаю что инструментах бинарных бэкапов весь вот транзакционному мусор весь балкон тоже в bacopa видел да да да да да спасибо многообразие конечно хорошо но в организации бывает какой-то централизм централизованная система резервного компе копируем там symantec backup exec верят с и другие умеет ли они работать с по сгрыз ну в принципе их можно научить работать потому что можно просто скопировать файлы уже больше до тонких скрип тыкаешь nickelas гриссом можно дать команду для да копирование то есть отправить им команду start backup он там меточку поставить есть скрипты какие-то шел скриптинг будет но в принципе мы можем обучить с ним не слышно да чтобы какие-то системы пытались начать ну как бы на темно взаимодействовать ну назову у нас практике мы не сталкивались с такими просто окей так спасибо за доклад расскажите пожалуйста поподробнее как вы вы лидируете backup то есть это только чек сумму или есть еще какие-то техники типа развернуть там нормальность какие-то тесты нормально валидации быка по это поднять этот быка в отдельную базу данных и запустить на нем приложение но то есть полезная и валидация это когда у вас есть какой-то стричь сервер где вы обкатывается приложение и вы этот стать стоит сервера обновляете когда вы сделали бэкап а его обновили с новой версии вот это самый адекватный и интересный способ валидации можно просто поднять базу на отдельном сервере и прогнать какие-то тесты на целостность данных вот ну тест тесты на целостность данных они больше будут завязаны на бизнес-логику то есть потому что тут их нужно будет самим написать вот этой самые правильные варианты вот но на это тоже очень мире забивает так и чего-то вопрос ла спасибо за доклад если представить ситуацию к примеру что наши наш backup восстанавливается и среда логов лежащих на ис-3 если мы их будем тащить с помощью волга-волга или с помощью каких-нибудь а в с клика примеру что из этого всего будет быстрее и будет ли быстрее вот андреа лучшего тайцем это вопрос давая ты ответь на вопросы задать следующим слушай я разработчик magic поэтому я скажу что быстрее всего во лжи конечно ну то есть не но и зачем мы разрабатывали во лжи если бывал и хорошо работал вот дня доклад целых 40 минут за счет чего волга быстрее они могут одним словом можно сказать мы мы долго работали до он там частная честная до параллелизм более тараны параллелизм там prefetch то есть мысль мы закачиваем вал до того как он тебе понадобился поэтому когда вот там графики такой была то график на самом деле упертый в накатывала они в этот самый но даже накатывала мы стараемся оптимизировать подготавливая в печкой же странице базы данных к тому что к ним скоро подъедет вал то есть того это не просто технология которая там течет заархивирован и поменьше данных унесла в сеть там новые отели космоса всякого сложно коротко сказать я хотел про валидацию сказать вот мне кажется что правильный способ право реагировать по сгрыз это дамб в дивную который проверяет штуках если у тебя включены контрольные суммы он тебе про греции контрольные суммы проверит что ты можешь прочитать все свои данные в базе данных но это ещё не достаточно для полного смог теста желательно делать м чек который проверит инварианты корректности графа индексов и если этими варианты выполняется при этом мы знаем что все контрольные суммы на страницах графа корректные мы можем говорить о том что в базе данных логические ошибки отсутствуют вот хотел сказать спасибо вот услышали как это сложно и кто будет это делать поднимите руку если не сомневаясь снова что с потому как часто вижусь с активностями разные вопрос еще есть то есть на допрос небольшой такой специфический возможно кейс вот у меня есть большая база данных там 10 терабайт допустим и я собираюсь делать массированные изменения в базе новый момент мне захочется вернуться возможно в эту точку причем сделать это быстро просто люся сделать бинарный дамб и там воды соответствующие то потом будет достаточно долго накатывается можно как-то вот зная что они эту точку нужно еще ну это просто отдельную сервер поднимаюсь по делам да и останавливаем ребекка дается меняете перед но скорее всего это у вас какая-то миграция данных даже обидно . но обычно реплику просто цепляют на этот момент если подразумевает то что это миграция данных может на вернуть вашу бизнес-логику но с этим я боюсь кроме кроме реплики таких зарезали ну а все остальное оно упрется в копировании файлов а тот у вас уже готовы instance базы данных груда вы просто перекинуть а нагрузку случае проблем спасибо я тоже хотел бы добавить чуть по предыдущим вопрос есть прогревает который позволяет вернуться в прошлое моя не уверен что он подходит к тебе надо исследовать для него нужен мастер то есть он используется как сказать о чем копия нужно смысл тратить на него нет времени да вот моя оцепили реплику случилась проблема мои сделали мастером старый мастер натравили на реплику сделал rewind для ремонта должен мастеров чтобы он блоки там откатил очень сомнительные туза и проще просто на реплику переключиться и мастерами сделать вот такой вопрос по сути говоря если у нас в принципе база само по себе целостное то если мы снимаем дамп то очень майка вероятность через по годам touch & mike вероятно что он будет битый ну дам или это просто водка по-хорошему нужно установить проверить но вообще так доверять ну как бы вероятность маленькой достаточно то есть скорее всего другая среда убитый то скорее всего проблема в базе они не знаю в чем нибудь еще что-то можешь колон беда мне с ними то вас так ну то есть он не с ним этот дом у меня просто снимал по годам дамб и он был битый и они знают как это работало не мог он окатить потом после этого он не писалось нет вы могли не могли не накатить его просто по причине того что вас не хватало расширение какого-нибудь скривил расширения были поставлены карьеру и 100 раза чисто без сил но не знаю этот это надо посмотреть почему вас так происходило скорее всего просто сам файлик дам по каким-то образом побился вот вероятно чем меньше такого тем больше вопросов я вопросы тоже да по голу дополнение от предыдущем вопросом почему нам логический может побиться становиться человек этот вопрос прошел и корзину к вашим вопросам дополнения могу сказать что бывают такие случаи логической дамп останавливаться например у нас было пару случаев когда был силок файл битый и были показаны данный и по годам просто так внезапно останавливаться он в какую-то ошибку но чит код был нормальный как бы и все вроде нормально на самом деле там был битый не полный и не восстанавливался и так что следите за этим так еще вопросы о чем кому интересно там практически потыкайте настроить бы копированию приглашаю на комнатку r16 по-моему там у нас будет смита по этому поводу и такое ну если какие-то вопросы есть вопрос вы задаете всем спасибо за внимание"
}