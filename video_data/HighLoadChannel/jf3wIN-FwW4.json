{
  "video_id": "jf3wIN-FwW4",
  "channel": "HighLoadChannel",
  "title": "Масштабируемая конфигурация nginx / Игорь Сысоев (Nginx)",
  "views": 27594,
  "duration": 2663,
  "published": "2017-04-22T14:47:30-07:00",
  "text": "Меня зовут Игорь соев Я автор икса и сооснователь одноимённой компании Ну немножко о нашей компании основана она была в 2011 году летом мы открыли Московский офис осенью Мы объявили о сан-франциско объявили о создании компании и получении финансирования тогда лся Первый Коммерческий клиент netflix летом тринадцатого года мы выпустили наш Первый Коммерческий продукт А весной этого года мы провели первую конференцию в сан-франциско и вот осенью вторую конференцию приурочен ную к десятилетию первого выпуска инса среди наших клиентов которых я могу назвать крупных поближе так а среди Груп клиентов это ну не считая нетфликса Go Air если вылетали в Штатах в самолётах дельты то это вот wi-fi который представляется на борту Home и Discovery education У нас два офиса один сафран Второй в Москве сан-франциско занимается продажами бизнес девелопментом маркетингом и продакт менеджментом Москве собственно идёт разработка програмного общения и поддержка и мы нанимаем программистов наси в основном наши продукты Это мы продолжаем разработку Орса с момента основания компания тем разработки сущест увеличились поскольку работает э не один человек а больше над этим продуктом в рамках он сорса мы оказываем платную поддержку А и второй продукт - это Engine X Plus это коммерческий продукт закрытый ээ он основан на опенсорс э плюс несколько коммерческих модулей Advanced Load balancing мониторинг конфигурация и такая фича как несколько вариантов сего говорить о масштабируемой конфигурации икса но это не означает что это не о том как обслужить на с помощью икса сотни тысяч одновременных соединений в принципе для этого настраивать особенно не надо нужно выставить число адекватное число рабочих процессов или поставить его в режим а поставить conne там 100.000 соединений А после это заниматься настройкой ядра то есть там увеличивать число сокетов файлов сетевых буферов тюнить файловую систему сетевой стек и так далее В общем это вот гораздо такая более глобальная задача чем настройте inx Поэтому я буду рассказывать о том не О другой масштабируемости о масштабируемости конфигурации икса То есть как обеспечить рост конфигурации от сотни строчек до нескольких тысяч и при этом тратить на тратить время на сопровождение до конфигурации по минимуму то есть желательно константное время такой же как было в начале значит почему собственно возникла такая тема 15 лет назад чуть меньше я начал работать в Рамле и у Ача есть такая очень неприятная особенность которую хорошо проливать вот этими двумя конфигурациями здесь два локе и они идут в разном порядке и зад за один и тот же запрос в зависимости от того какая конфигурация используется будет обработан разными файлами Либо это будет фай Либо это будет HTML то есть порядок имеет значение если мы работаем с конфигурацией Ача самое неприятное то что Отменить это нельзя то есть ач при обработке запроса он проходит по всем Кстати кто ещё не помнит Кто ещё помнит как корить ач Ну прекрасно вот при обработке запроса он проходит по всем локейшен пытается найти те которые совпадают каким-то образом с этим запросом и все и собирает конфигурацию из всех этих локейшен сливает её и в конце концов использует результирующие это удобно Если у вас маленькая конфигурация Она позволяет сделать её ещё меньше Но по мере роста вы сталкиваетесь с такими проблемами что допустим вы добавляете какой-то новый локейн в конце он всё работает прекрасно но потом вам нужно поменять конфигурацию в середине или например выкинуть середины он стал неактуальным И вам нужно просмотреть всю конфигурацию после этих локе чтобы убедиться что всё продолжает работать как раньше то есть таким образом конфигурация прощается в Карточный домик вытащив одну карту можем порушив всю конструкцию В Аче чтобы так сказать добавить аду в конфигурации есть е несколько секций которые работают точно также обрабатываются в разном порядке но конфигурация из них всех собирается и создаётся одна результирующая конфигурация всё это делается в ран тайме То есть если у вас много модулей то каждый в каждом модуле будет происходить слияние конфигурации Вот это наверно частично объясняет Почему в каких-то тестах быстрее Ача потому что НТА конфигурации не сливает вот часть этих секций и большинство директив можно разместить в файлов которые раскиданы по всему сайту вот для того чтобы сделать жизнь ваших коллег ваши ваших коллег ещё интереснее эти файлы Можно переименовать вот ищите эту конфигурацию вот ну и послед вин нар который позволяет сделать конфигурацию похожую на файл кто-нибудь ещё помнит как выглядит классическая конфигурация файла немногие люди оценили юмор потому что к счастью уже не все большинство вообще не знает что это такое Это вообще кошмар очень много администраторов приходит с Не столько с граун Ача сколько с граун администрирования Ача на сть когда единственно средство администрирования это был hess И вот они в этом делают очень замыслова лы которые очень тяжело понимать И в силу синтаксиса И в силу логики так вот это был один из недостатков Ача который меня очень раздражал он не позволял создавать конфигурации доста большие разработки Это я хотел изменить это Я исправил много таких раздражительный черт поча добавил своих собственных вот Ну вот Собственно как выглядит пример из предыдущий приме для выт вот ное от не зависимости этике запрос будет обработан одинаково Почему Потому что ищет совпадение максимальное возможно совпадения И после этого выбирает именно этот максимальна возможно совпадения с префиксные все остальные локейшен игнорируются такой подход позволяет писать конфигурации сотни локейшен и не думать о том как это будет влиять на всё остальное То есть своего рода контейнеры вот то что сейчас набирает популярность подход Докера это тоже самое вы изолирует обработку в одном небольшом месте значит рассмотрим собственно выбирает какую конфигурацию использовать при обработке запроса первым делом ищется подходящий под запрос сервер выбор ляется на основе сначала адреса и порта а затем уже всех привязанных к данному адресу и Порту имён серверов То есть если вы хотите допустим писать там кучу имн серверов Если вы хотите чтобы все эти имена серверов слушали работали на всех адресах то вам адреса нужно продублировать во всех серверах после того как выбран сервер внутри это сервер ищется ищется подходящий локейн сначала проверяются все префиксные кеше ищется максимальное совпадение потом после после этого проверяется Существует ли зада регулярными выражениями поскольку для регулярных выражений мы не можем специи определить максимально максимальное совпадение то выбирается первое совпа выбирается у которого регулярное жение совпало самым первым То есть первый побеждает Вот и после этого используется именно конфигурация этого Если же регулярное выражение ни одно не совпало то используется конфигурация которая была найдена до этого с максимально совпадающим префиксом Почему собственно в появились регулярные выражения Ну они добавляют вот э вот зависимость от порядка таким образом создавая не неподдерживаемый плохо поддержано конфигурации Потому что жизнь она сложнее теории и очень часто люди используют в общем структура сайта - это такая свалка из кучи статических файлов скриптов и так далее и в этом случае единственный способ как-то разрулить все запросы это вот эти регулярные выражения Вот Но вот этот пример это так сказать просто иллюстрация ни в коем случае так не делайте если у вас уже такие сайты есть их нужно переделывать в что-то более нормальное С префиксами подход идеально ложится в эфи использовать А ну когда я рассказывал о порядке обработке конфигурации Это был первоначальный дизайн потом Появилась возможность описывать э локейшен внутри локейшен то есть такие инклюзивные локейшен вот и порядок немножко изменился адаптировался то есть сначала ищется максимальная максимально совпадающий префиксный Location потом внутри него ищется вложенные Кей это могут быть либо тоже префиксные вернее после этого в него внутри него опять ищется максимально совпадающий префикс локе и вот такой вот рекурсивный Поиск делается пока мы собственно не дойдём до Кейна в котором ничего уже нету А после этого мы начинаем проверять кей с регулярным выражением выражениями в обратном порядке то есть мы вот вошли там в какой-то самый вложенный смотрим ели там регулярное выражение Если нет то спускаемся на уро ниже и так далее опять же первые совпа вшие с регулярным выражением побеждает вот Ну вот этот подход Он позволяет сделать вот такую вот обработку То есть у на Т С регу выражения будет выбран вот этот вложенный первый а не второй Кроме того регулярное выражение вот этот вторую часть поиска регулярных выражений можно запретить если вот пометить Location таким вот символом мфлекс и тилька то есть это это запрет регуляр жения то есть ЕС мы выбрали что это этот кей у нас показал максимальное совпадение то после него регулярное жения иска не будут а очень часто люди пишут пытаются сделать конфигурацию меньше то есть они выносят части часть конфигурации в какую-то общую часть и просто перенаправлять туда запросы Вот например вот так вот можно такой плохой способ перекинуть всё в обработку в PHP в Иксе есть другие методы выделения общих частей конфигурации значит Прежде всего это наследование конфигурации с предыдущего уровня значит вот например Здесь мы можем описать на уровне http включить файл для всех для всех серверов и для всех кейно и эта конфигурация наследуется во все вложенные сервера И кеше если нам нужно где-то отменить файл потому что допустим файл система его не поддерживает или по каким-то другим причинам то мы его можем выключить в конкретном локе или в конкретном сервере этот подход Ну и наме для се можем об где нужно его переопределить этот подход отличается от Ача потому что мы знаем конкретные места где собственно э искать Нам общие части которые могут повлиять на а наш Location второй подход а но э Единственное что нельзя делать разделяемый - это например на уровне http нельзя описывать локейшен это было сделано сознательно в Апачи это можно делать это доставляет немало а проблем при будущем использовании то есть вначале это кажется хорошо а потом оказывается что это не очень хорошо и человек говорит Будь проклят тот день когда я сел за баранку этого пылесоса и так далее в икси есть ну лично я предпочитаю эти локейшен описывать явно прямо в конфигурации вот если вам это не хочется сделать Вы можете его ить через внешний файл Ну теперь я бы хотел поговорить собственно Почему люди хотят писать меньше То есть почему они делают эти вот шарит эти разделяемые конфигурации Они думают что они потратят меньше сил на самом деле люди хотят не столько меньше писать сколько меньше тратить времени Вот Но о будущем они не думают Они думают что если они вот напишут сейчас меньше то также будет и дальше они потом будут меньше писать правильный подход это использовать Copy Past то есть вся конфигурация должна быть внутри Location должны быть все необходимые директивы нужные для его обработки то есть допустим FG Pass или Proxy Pass там с нужными заголовками и так далее обычный аргумент под любителей Don't repat Yourself заключается в том что если мне надо будет что-нибудь исправить то я это могу вот исправить в одном месте У меня всё будет прекрасно на самом деле современные редакторы имеют та функциональность Вы можете спокойно если вам нужно что-то исправить например имя бэнда да или там порт бэнда или поменять там поменять какой заголовок передаваемый бду всё это делается с помощью фада для того чтобы понять нули вам в данном ме пото памет достаточно секун То есть у вас 100 локе вы на каждый локейшен потратите по 2 секунды это у вас будет 200 секунд это 3 минуты это немного а вот когда вам в будущем придётся развязать какой-то локейн от общей части то вот это вот будет уже гораздо сложнее Вам нужно будет понять собственно что что собственно менять как это будет влиять на другие кены и так далее поэтому что касается конфигурации никса - нужно использовать Copy Past А вообще говоря - администраторы не любят тратить много времени на свои конфигурации Я в общем-то Сам такой у у администратора Может быть там два-три любимых продукта они могут с ними возиться очень много при этом существует там десяток других продуктов на которые с которыми им хочется тратить поменьше наме у меня на персональном сайте есть почта это и я могу сказать что я их не люблю администрировать Я хочу чтобы вот они просто стояли работали если надо что-то добавить это чтобы это заняло там буквально там пару минут я не хочу изучать конфигурацию просто лень и я думаю что большинство администраторов они точно такие же то есть имми ы Если вы такой администратор то Пользуйтесь cy Past потому что Don't repeat на самом деле он когда мы смотрим на результат дорета то да мы видим что там как бы мало повторения Но мы же не знаем что предшествовало этому а а предшествовало этому огромное повторение разных вариантов конфигурации то есть человек на самом деле очень много повторял пробовал Так этак а в конце получилось красиво Скорее всего вы не захотите этим заниматься поэтому копа - это вот очень актуальный подход Ну вот примеры того как как можно коротенькие конфигурации не масштабируемые в будущем конфигурации превратить в то что надо вот например такой вот кей человек думает что написал регулярное выражение всё мало всё хорошо на самом деле поскольку здесь регу жение Это плохо оно может влиять на ВС остальное Поэтому вот лично я делаю так один раз я вернулся из отпуска вот я вот эта конфигурация она так ме тут два слайда что ли получается да пока я был в отпуске один из программистов может здесь присутствует Ну по крайней ре на стенде есть БАГУ он вот именно такую конфигурацию засунул в припуска и вот таку если вам если у вас этот Root общий вообще для всех для всех локейшен Ну или по крайней мере используется в большинстве из них то это можно вообще превратить вот в такое это вообще легальная конфигурация то есть совершенно пустая конфигурация Кейна а второй способ второй способ а Как использовать Cast вот сейчас избежать в какой-то мере ко паста это вот такой пример значит программисты администраторы которые пришли из а поча они думают что админ Икс PHP должен запрашивать авторизацию потому что в работает Именно таким образом в ие это не работает поскольку индекс PHP обрабатывает в одном кейне А Location Admin совершенно другой Вот но можно сделать вложенную конфигурацию и в этом случае индекс PHP уже естественно запросит а авторизацию очень часто бывает так что на Несмотря на то что мы сделали нормально структуру сайта Всё равно нам нужно использовать регулярные выражение для того чтобы выку свать какие-то части из урла использовать их при обработке Вот это плохой способ правильный способ - это использовать внутренние вложенные локейшен а Таким образом мы изолируем регулярное выражение от э всего от конфигурации всего остального сайта то есть дальше этого локейшен который Location Image который помещается на экран управление не уйдёт и мы можем собственно не беспокоиться о том как это будет влиять на остальные на остальную конфигурацию второй второе место где В общем можно использовать регулярное выражение В достаточно безопасно - это пы то есть сформировать переменные на основе каких-то других переменных с помощью регулярных выражения и выражений и так далее Я ничего не сказал использовать потому что их не надо использовать вообще есть Если вы не можете не использовать ты то просто Используйте их на стране бэнда там у вас есть хороший какой-нибудь язык программирования R и так далее вот в нём программируй а в луча Пусть роут запросы на разные бэнды рее Почему Потому что вот как работает внутри знает там человек 10 в мире врядли выводите число вот значит вот такая конфигурация Когда у нас два Иа истины ожидается что у нас будет выключен и будет выключен самом дебот толь вот это пос почему так происходит это в общем грустная история Вот Но вот такой иф нельзя использовать есть одно безопасное использование Ифа - это когда вы используете и для возврата ответа клиенту можете использовать й в этом месте я его не люблю я использую р Он позволяет там добавить код и так далее А ну коротко говоря Значит резюме такое использовать желательно только префиксные локе избегать регулярных выражений Если же всё-таки регулярные выражения вам нужны в конфигурации то их лучше изолировать а Используйте пы не слушайте людей которые будут говорить что Don't repeat Yourself - это вообще такая всеобщая парадигма Это хорошо когда вы вам нравится продукт или вы или программирует если вам надо просто облегчить свою администрацию жизнь копипаст - это для вас А ваш ваш друг - это редактор с хорошим find and replace а не Используйте рейты и Используйте If только для возврата какого-то ответа клиенту Здравствуйте Игорь А такой вопрос Если я использую RR с http на https его Где лучше использовать в нсе или на его использу в то есть ну идеально это сделать вот как вы делаете два сервера один сервер у вас который и он делает да Или или он там ещё чтото должен делать если он делает только то просто в этом месте Там будет буквально несколько директив сервер там на порту Если нужен и там 300 301 или 302 на hps с дублированием реквест собственно вот так вот он будет выглядеть там даже не нужен нужен просто ретур то есть ну сколько четыре строчки вот если вы хотите что-то более сложное сделать но где-то там можно вставить и У вас есть какие-то локе которые могут отрабатывать в тексте Ну Опишите их с помощью регулярных выражений в мпе например да а всё остальное можно дирек на hps Ну или наставить наоборот внутри эти внутри с каждого локе по ифу который будет дирек hps Вот так наверно Здравствуйте Игорь Спасибо за немножко шутливый вопрос Не планируете добавить ключик запуска или ключик компиляции который который допустим не даст использовать директиву include не даст использовать If не даст использовать регулярные выражения в локейшен Ну такой минус Минус игс Нет вряд ли мы обычно добавляем если какие-то директивы нам не нравятся мы их улучшаем и потом мы делаем эти директивы deed они какое-то время выводят waring влоги перед тем пропасть полностью Вот Но они работают каким-то в каком-то режиме Вот Но я думаю вряд ли мы это будем делать мы лучше напишем хороший User Guide Как правильно использовать возможно по материалам этого выступления Добрый день Игорь Спасибо за доклад а а обычно а а где вы я не виу Я здесь а всё обычно желание которое возникает при использовании If Это потому что его можно использовать в сервере и в локейшен а Map использовать нельзя Почему так получилось нет Map значит смотрите все переменные в они вычисляются on demand То есть это Если писаны на уровне htp это не зна что при обработке запроса эта переменная будет вычисляться обязательно поскольку она вот как бы на уровне htp он нужен для того чтобы от мапить что-то в одно а потом что-то одно в другое а потом результат вот эту рещ переменную можете использовать ВФ или вы можете использовать там внутри какого-то там выражения Да там проектировать куда-то там ещ зачем-то То есть это просто ци на Ну может быть их имеет смысл переместить на серверов для того чтобы сделать их локальными для сервера То есть если у вас одна и та же переменная есть вот именно в этом одна переменная в нескольких серверах но имеет разные локальные переменные внутри сервера но там просто просто сложнее программировать И поэтому они были вынесены на глобальный сервер локальных переменных нету в ие которые были бы локальные там для сервера допустим понятно Ну спасибо ну с точки зрения перформанса никаких проблем нет то есть это просто ну неудобство для то есть надо будет делать там допустим три сервера три МПа и у переменной будет префикс там сервер такой сер будет очень много переменно загромождение имён понят Ну вы их можете в принципе описывать перед сервером то есть вот эти пы да э одна мэп будет там Перед первым сервером потом п перед вторым сервером то есть по они будут ближе к серверу Но вот только так понятно спасибо Добрый день Игорь Меня зовут Андрей Спасибо за доклад и конечно за И вопрос такой я плохо знаком с логикой работы турнов расскажите пожалуйста где стоит совсем-совсем может быть стоит использовать ретур вместо райв какие-то кейсы конкретные Ну смотрите вообще заменяется на такую конструкцию Location с регулярным выражением в котором можно сделать какие-то захваты и выделения и на на директиву ретур то есть один й это вот левая часть рерайта это в локейт в Турне после после кода ответа вот но тун в этом плане предлагает что он Вы можете вернуть разный код ответа допустим й он для возврата клиенту он может вернуть только там Директ 301 302 вот ретурн может вернуть Там 404 с каким-то телом может вернуть там 200 там 500 может вернуть редирект и у него есть ещё вот это тело который можно там использовать переменные там чего-то написать Вот если это у нас 301 302 ответ то это не тело А это уже урол на который нужно сделать редирект Ну в общем у турна побогаче функциональность Вопрос такой насколько Хорошая идея хранить User Password для скриптов передавать их через env ну внутрь то есть допустим в PHP там нужно к масле подключиться по smtp что-то отослать вот где-то эти пароли нужно сохранять всё равно вот насколько хорошо их будет с точки зрения секюрити туда в config поместить и их передавать в скрипт или это антипаттерн такой ну не затрудняюсь сказать но в переменных вообще говоря это всё можно увидеть в переменных вы можете увидеть psx и увидете переменные относящиеся к к какому процессу соответственно в переменно в среде её может увидеть любой пользователь который работает на вашей машине То есть если это проблема то Ну а тоже самое в конфигах Если вы запишите и они доступны для чтения там пользователям которой вы не доверяете будет та же самая проблема Я не знаю сказать правильный подход в этом деле Ну выносить куда-то отдельно но всё равно делать права на доступ то есть понимаете конфиг возможно его имеет смысл читать большему числу людей которым нужно смотреть парале поэтому возможно пароль ваш скрипт должен хранить где-то в более защищённом месте с правами которые этот скрипт имеет и всё а остальные не имеют Ну понятно да что когда всё вместе Это удобнее разбивать Ну кстати не Все так думают почему-то Вот инклуд например да почему люди инклуд Потому что им вот раздельно удобнее а мне например удобней вместе вот В каких случаях кому-то удобней вместе кому-то раздельно Вот но здесь в данном случае не столько вопрос не о удобстве а о безопасности безопасности удобства они как правило Чем более удобнее тем менее безопас наоборот у меня такой прикладной Вопрос вот зде можно использовать как почтовый прокси правильно Да я пытался решить одну задачу и не вся не всякой по прокси Возможно вы решали именно задачу для который он не предназначен Ну вот Вот наверное вы мне сейчас скажете что такую задачу можно решить Или нельзя Можно ли SM доступ отправить письмо через этот почтовый клиент им перехватить данные и отправить на скрипт минуя почтовый веб-сервер то сейчас мы такую задачу реализуем используя там пок он перехватывает письмо и дальше кидает на скрипт и там происходит обна Обработка А вот можно минуя почтовый веб-сервис просто используя как почтовый прокси сразу накидать соответственно сомневаюсь что это мо сделать я могу описать кратко функциональность которая есть в smtp Проси в значит он умеет делать что к нему соединяется smtp клиент показывает какую-то Там аутентификацию там usame пароль там и или тому подобное из какого-то внешнего скрипта убеждается что он идт внешний скрипт внешний скрипт проверяет это имя пароль а потом говорит что собственно пускать этого клиента на какие-то сервера Ну и передаёт Какие сервера конкретно либо не пускать вот собственно и всё что он умеет делать э если куда-то пускать то nginx по smtp соединяется с этим сервером и передаёт ему вот вложится ли это в ваш сценарий Я не не могу сказать вряд ли FJ там по крайней мере никого не появляется вот вот собственно Всё я могу рассказать почему появился это xtp проти с авторизацией потому что в в Рамле для клиентов почты Ну есть специальный сервер через который эти клиенты могут отсылать почту и так оказалось что там процентов наверно 90 всяких соединений это не клиенты Рамле а спам и вирусы Вот и вместо для того чтобы не нагружать по не подымать лишние процессы под всё это дело значит перед этим поставили который проверяет вообще Дат предоставляет ли этот клиент вообще какую-то там имя пароль авторизационные токены или нет потому что боты и спам они просто видят что есть сервер который отвечает да мы туда сходим естественно ничего такого мовить для этого было сделано чтобы отбивать вот мусорных клиентов ваш паттерн вряд ли отложится е Игорь ещё Вопрос такой а вот на этапе разработки допустим периодически Ну раньше было хорошо H Access отдал программисту и он там делает что хочет вот как бы а тепер теперь все программисты лезут значит Да и начинает дёргать как это решить этот вопрос просто на этапе разработки пока никак Дело в том что вообще ngx не предназначался для а разработки там ну для каких-то таких небольших сайтов он предполагал серьёзные нагрузки и предполагал что конфигом занимаются вполне определённые люди то есть ну это вот намер компания там уровня мра там дофига запросов в секунду вот ээ Ну люди в общем лись использовать непонятно где везде вот э но вот так вот получилось то есть вообще не планировалось изначально делать так чтобы можно было там конфигурации подгружать на литу просто стилу специфики целей которые ставились при разработке сервера Пока так с может быть может быть да Вопрос такой может быть немножко не по теме предположим вы администратор молодой начинающий И вам поставили задачу там Создать веб кластер там из трёх или более нот с мускулов там и в общем как бы вы решили эту задачу по хорошему По По православном так скажем не знаю я в мосли не понимаю поэтому не могу сказать православные методы ра с с но как см ставите допустим ВД соединять их через либо там ещё Каким образом но это если вот более надёжная схема а прогу про контейнеры это а это конечно многообещающий подход но он подразумевает изменяющуюся топологию и динамическую конфигурацию сейчас это вот пока приводит к тому что люди строят какие-то внешние некие костыли которые периодически реагируют на события изменения топологии герт через какой-нибудь шаблон актуальный конфиг джинса подсовывают его и пинают чтобы перечитал конфиг Ну Благо жинси делается без потерь коннекто поэтому это уже здорово но просто интересно а у компании есть какие-то планы по развитию в сторону вот контейнеризации в сторону обеспечивая более удобных и естественных средств для этого тренда ну э что вы подаете под контейнерами в данном случае а ну я и я когда говорил про контейнеры сравнивал Да я говорил о том что вот эти локейшен они выглядят изолированы друг от друга то есть и мы вернулись конкретно обратно к керу к возможности запуска кэндо где-то в контейнерах которые динамически спавнятся На разных хостах и нужно Ну грубо говоря добавить в балансировку новый хост чекать У нас вот ADV Bing он как раз одна из его частей по называет то что вы можете эти астмы динамически добавлять в добавлять сервера вст Вот то есть получается вам не нужно делать Ред конфига кса всё это делается на литу а то есть AP какой-то есть для этого да да да О отлично а чеки тоже туда включили там включены э активные чеки то есть вообще говоря обычный Ну Open Source eng X когда он соединяется с эндом если эн не отвечает то значит этот к нему некоторое время не обращается то есть своеобразный чек тоже здесь есть но страдают клиенты То есть если у вас там допустим 50 клиентов одновременно пошло на один энд а он лежит там допустим по таймауту отвалится там через 10 секунд да или 5 секунд но клиенты это увидят и только после этого их перебросят на другой астрим значит ВП У нас есть активный проактивная тестирование эндо то есть сами тестируются и клиенты на э вот эти вот упавшие бэнды просто не посылаются вот и всё отлично Спасибо и раз есть активный Health Check то может уже и запили тогда красивую ДСО образную страничку статуса которую можно отпарной в виде красивого мля вот ты можеш четь сон получить отлично Спасибо большое"
}