{
  "video_id": "JL2kmro19xY",
  "channel": "HighLoadChannel",
  "title": "\"В чём сила, брат?\", или Зачем нужен источник правды / Алексей Учакин (ECOMMPAY IT)",
  "views": 1907,
  "duration": 1631,
  "published": "2021-10-04T02:47:27-07:00",
  "text": "давайте поговорим о правде в который как известно сила что бывает как круг нас не правда вот у кого было что вас поднимает полету в два часа ночи вы бежите поднимать сервак полчаса его де бо жить и поднимаете все а потом выясняется что это был не тот сервак потому что тот который надо выдала мари окончательно а этот специально выключили и вот что-то не обновили или кто из вас посылал инженеров дата-центр перед патч-корд или поменять диск вы посмотрели не ступ к табличку и инженер поменял не тот диск вот у кого было что ошибся дядя самат и если физике есть дальше все опять же сам заныли унитаз только вот вот вот у меня у меня была та же как бы по-разному по разному бывает но и может кто-то выключил не тот этот центр тут может этой завес есть но они конечно не признаются но вот все эти случаи помимо чисто человеческого фактора они происходят когда вокруг нас недостаточно правды либо вокруг нас слишком много информации у вас есть wikivid какие-то под стольник силики какой-то ваш рабочий блокнот честен вася который просто вот много знают в голове и кроме него ты никто не знает вот если у вас вот это болит от вот ближайшие полчаса это вот мы постараемся с этим что-нибудь сделать я работал в компании компаний спасибо лёша уже сказал у нас мы пишем свою эксплуатируем свою платформу мы делаем так чтобы платить за товары и услуги в интернете было легко просто и безопасно у нас сотни идти специалистов разработка и эксплуатация аналитики и и так далее 5 дата центров по всему миру четыре девятки целый перед нашими заказчиками и какая-то абсолютно неприличная стоимость минуты простое в комп и я занимаюсь следующими вещами я слежу за тем чтобы купить что-нибудь нужно ну можно и за это заплатить но возможный вариант слежу чтобы это нужно было доставлено правильно дата-центров параллельную локацию описываю для инженеров дата-центра там либо наших судов куда это нужно воткнуть в какие порты какою не поставить и так далее и перечисли помогают коллегам отвечать на вопросы чтобы является и когда всё это кончится я про себя это называют должен штатного зануды ну вот потому что циферки таблички и все вот нужно знать соответственно вот вот я почти уверен что в каждой компании такой зануда есть может быть даже не один и вот эти зануда не нам как раз и помогут знакомьтесь вот это наш зануда он неплохой нехороший wang клевый работник он хочет все обо всех знать ну во первых потому что за mundo потому что у него работа такая чем наш да ну да занимается он знает что у нас есть сейчас и где установлена в стойках лежит на складе едет в транзите вот он соответственно него вся информация есть он следить чтобы навсегда была правильной актуально он знает сколько у нас свободных мегабит портов киловатт и всего такого стойках где мы можем чтобы что разместить ну и он соответственно знает когда нужно что-нибудь купить если на это бюджет сколько денег выделено и так далее и так далее вот про последний момент там нужно делать вообще отдельный доклад и и мы про это сейчас не будем да вот что делать с первыми двумя вещами мы как раз и поговорим и то то то то что нам нужно итак у зануды есть цели 1 из 1 это иметь самые свежие и самые достоверные данные потому что иначе от этих данных нет никакого толку эти данные нужно удобно и просто использовать верну с ними работа должна быть легко и просто потому что иначе коллеги будут будут платить те самые записки в блокнотах и xi веке какие-то гугла доки и все все прочее и соответственно завода физически делает отчеты для руководства этому там для кого-то из вас это знакомо когда вечером пятницы к вам приходит начальник и говорит ну вот слышим не было тут отчете код вот это вот это вот это ну к понедельнику сделаешь да и у вас выходные становятся очень веселые и такой пункт со звездочкой да то есть зонт и хочет знать все обо всех но не абстрактное все абстрактных всех а вот максимум информации который соответственно есть а вот о системе с которой зануда работает это может быть ваш инфраструктура либо там что-то еще вот максимум информации зовут и хочет знать важный момент что помимо отчетов газа надо постоянно помогает своим коллегам поэтому ему важно иметь данные в моменте то есть это вот не то что вы там раз в месяц или раз в квартал делаете какие-то срезы нет зануда постоянно помогает своим коллегам из-за информационной безопасности из инфраструктуры и соответственно рассказывать им где у нас что есть и когда то что должно быть не совпадает с рук то что то зануда записанном считает что должно быть когда он когда не совпадает то что должно быть то что есть реальности возникает проблема и зануда расстраивается вот эти цели они сами вы почему-то не достигаются хотелось бы нам чтобы они вот сами собой как-нибудь случились но вот как у classic возникает два вопроса что кто виноват устаревшая документация которая она же документация шрёдингер да то есть это когда в документацию написали через год заходите на вики видите страничку годичной давности и задумывайтесь а это она вот не обновлялась потому что на нее болт забили потому что она там все так стабильно что удивительном год ничего не менялось или как еще есть автоматический discovery их очень любят программисты админы вот у вас есть там ни на кого не zabbix prometheus его автоматически заезжают триггеры появляются новые айтемы все в общем так круто но из этого возникает большое количество формационного шума да то есть вы не знаете когда от вас за биг си появился новый триггер вы не знаете что этот триггер он там появился реббе темно или что-то случилось что-то пошло не так и те самые вот разные источник информации с разной степенью доверия га то есть вот те самые разные видит и так далее это все находится в разной степени актуальности а еще в те самые сакральные знания и это снижает видимость это уменьшает количество правда вокруг нас потому что мы не знаем чему мы можем верить и чему нет что нам с этим можно сделать например использовать источник правда это место где мы храним достоверные сведения о том как должна выглядеть наша система то есть ключевое этот источник должен быть достоверным и есть когда ты к ним обращаешься для приоры должен быть уверен в том что данные в нем правильные и соответственно о том второе ключевое отличие что как должна выглядеть система не как она выглядит на самом деле я позже объясню почему перед тем как мы начнем работать с нашим источником правды мы сделаем несколько вещей во-первых мы настроим синхронизацию с внешним миром мы например с провайдерами вашим вашим хостинг-провайдером с вашим дано с провайдером и так далее то есть мы начнем получать информацию о том за что мы платим как мы выглядим снаружи и вот такие вещи далее мы сверяем то что мы нашли с тем что у нас есть мы думаем что у нас есть случае хостингом эмпирически удивляемся выкидываем пару десятков лишних серверов ну вот что то такое да верно стоять черед уборки мы совместно проходим по нашей системе и начинаем проводить ее в порядок версии например там снижаем количество версий операционных систем как-то делал опишем play буки чтобы вас все сервера настраивались унифицирована причесываем description на партах сетевого оборудования и вот все это все таки и момента когда мы провели уборку у нас может возникнуть подозрение мысль что какие-то вещи можно алгоритмизировать и не запоминать то есть например можно по одессе куда-то центра генерировать айпи адреса его автономную систему еще много чего и это а вот эта алгоритмизация она поможет не хранить информацию в источнике правду ту которая там можно не хранить то есть соответственно знание некоторые закономерности нам заменяет знания многих фактов и это вот именно тот тот случай когда мы можем просто некоторой информацию не хранить тем самым не заботиться о ее достоверности там актуальности и так далее как это можно сделать неправильно первых что у нас что не является источником права это живые конфиге на оборудования потому что мы не знаем что вот конфиг он настроен потому что так надо или потому что тот самый админ вас на посев последний инцидент быстрый конвертер решения подняла забыл оса тебе это база в которой мы храним все наши те самые асад и да то есть это может быть какое-то оборудование какие-то север от на самом деле может быть даже какие-то виртуальные сущности но главное то что за что мы платим этот список будет очень интересен вашей бухгалтерии потому что соответственно по нему она будет формировать список основных средств но в целом с точки зрения эксплуатации нам допустим не очень интересна информация о том оборудование которое у нас лежит на складе ну вот потому что зачем есть семь тебе это такая база у вас снова в общем то основная система с точки зрения этого кисама где хранится информация обо всех сущностях нашей компании которым управляет айти но с ним есть тоже свои нюансы во-первых я ни разу не видел чтобы 7 тебе было наполнено актуальными данными они не являлась свалка мусора во вторых там как правило есть много личная информация с точки зрения допустим эксплуатации и это попытка впихнуть вот все все все в одно место это делать и в работу с ней не очень удобный плюс как правило за вот все эти вещи отвечают разными рассмотрим пример нас есть небольшой флот ну там в пару сотен три сотни серверов когда счет за аренду этих серверах от провайдера начинает переваривать там за какую-то значимую сумму бизнес аккуратно спрашивать ребята за что мы платим ну вот потому что мы ее муж программиста мы соответственно пишем скрипт который нам получать данные с провайдером и загружает в базу окей мы пишем вокруг этой базу некоторую систему пишем агентов для наших серверов и виртуальных машин и раскатываем везде начинаю получать информацию об адресах операционной системе и циpкa памяти его все все все все все все все что мы можем собрать складываем это в ту же базу удивляемся выкидываем те самые там 20 ненужных серверов на которые два года никто не заходил они в общем то уже уже сдать должны были но когда забыли экономим кучу денег подсчитывайте перед бизнесом что мы вот навели порядок со временем у вас возникает подозрение ну после того как очередной раз он сервера пролетела какая-то пачка ip-адресов потому что тот самый обменивать решил с докером поиграться и соответственно там вот вот такая портянка адресов прилетела абсолютно тестовых да и вы не знаете что с этим делать вы начинаете пытаться хранить в этой вашей системе которые вы считаете источником правда вы пытаетесь хранить в этой системе как-то кричать данный вот которой правильно которых неправильно скажем так вот этот подход он очень клёвый с точки ну то есть он клёвый по описание да что мы у нас есть вся информация мы вот актуально все быстренько получаем все знаем поэтому он очень популярен и бороться с ним очень сложно бывшим коллегам да привет но вот я коли надо так ребята сейчас объясню почему верить нельзя никому как завещал нам дядюшка миллер ну кроме конечно данный вид провайдера это не ваши данные это данные провайдера он их может потерять он их может поломать он может вам прислать вместо них какую-нибудь хрень просто потому что но у него были работы тут программист вот накосячил строго стройка строчкой ошибся и вам прилетели у вас половина серов предел как сдана и ok вы написали какой-то скрипте который вас там проверяю что если у вас там севера встала на день на 2 меньше то это окей а если на пятьдесят то как бы вот что-то не окей ну хорошо discovery тот же самый вот пример с докером да когда у вас просто sh100 может прилететь ну какая хрень просто потому что или может прийти он убить этот убить этого агента как бы и вы потеряете видимость соответственно данных с этого сервера но и попытка хранить в одном месте данные как есть и как надо приводит к некой шизофрении потому что вывод пытаетесь разобраться до что-то у меня в этой системе есть данная они очень достоверно вот реальный случай когда вот в такой системе от провайдера пролетел неправильный адрес управление коммутатором и записался в базу естественно чтобы никто не проверять не проверил дальше инженер мониторинга пишет скрип который соответственно идёт берёт от той печник берет модель оборудование которое собственно написано рядом и идет пытается снять какие-то метрики выясняется что метрики какие-то неправильные потому что они этого оборудования соответствуют да итак мы в общем то поняли что резко немножечко mita и эта информация которая пролетела от провайдера на некорректное ну да мы написали провайдеру он пофиксил этого себя в базе но если бы это был не мониторинг а какой то скрипт управление да там и было просто положили стойку как это делать правильно на мой взгляд инструмент может быть любой вот я думаю по описанию многи из вас помнили сейчас гид abs и в принципе в этом github сидит как раз является источником правда в котором хранится информация о том как вы будете настраивать свою систему это может быть netbox это такая клёвая штука очень популярную сетевиков по сути дела это базы данных с web-интерфейсом и в ней хранятся просто куча связанных объектов описания связи между ними то есть там дата центра стойки оборудования и переадресованные все все все вот это вот как они друг другу связано и так далее в конце концов это может быть excel к вот такая тема здесь у вас небольшая система вы можете вот описать это все в ваши ссылки хранить то есть я видела кальку которая но занимала 2 мегабайта со списком виланова ip-адресов вот это вот был это просто было 2 мегабайта текста то есть простоял но тем ни менее это может работать если вам вам так удобно как работе с источником права на старте мы вот проверяет ту самую верификацию уборку алгоритмизации и так далее мы получили некий набор данных и мы с этими данными мы эти данные считаем корректными и заносим наш источник правда ну там через импорте руками как вам удобно далее мы начинаем сравнивать наш окружающий мир ну то есть нашу реальную систему с этим описания что мы сравниваем мы сравниваем живые конфиге мы сравниваем информацию провайдера то есть мы опять же те самые discovery которая у нас есть это них плохо само по себе плохо как это используется обычно мы настраиваем какие-то внешние с сканеры манит информацию берем из мониторинга и так далее и так далее и все это мы постоянно сравниваем с нашим источником правдой и а вертим если у нас что-то не совпадает дайви мы изменяем данные заполняем данные в источнике правда если эти менее действительно нужны здесь все в общем то как в обычном есть в обычные выкатки кода на прод у вас должен быть код стоял у вас должен быть review у вас должно быть ограниченное число человек которые могут нежить мастер то есть все вот это вот она ничуть не отличается от того как вы пишете код а вы выкатывать его нападок шину разве что соседи возможно нету но в принципе можно даже прикрутить к этому себя сиди и запуска карта тесты которые будут после изменений источника правда в данных источники правда еще раз соответственно проверять насколько это соответствует вашей вашей системе обязательно утилизировать источник правда чтобы им могли пользоваться не только вы ваши коллеги потому что иначе это придет потому что во первых вы зашьете сие будете вот только целый день и есть собственно посмотреть в это срочно правду применяет принимать патчи и так далее но скорее всего просто ваши коллеги на него забьют и поставить рядом что-нибудь свое и будут как не будет вести ту самую там веке к цирку что-нибудь другое но и поддержка актуальность это нормальный жизненный цикл источника правда наши данные должны быть достоверной и актуальной в процессе работы с источником правда зануда для себя нашел некоторые количество таких вот нюансов во первых источников правда может быть больше одного вот есть теория про единый источник правда да то есть это вот аналог то самый наверное mdb когда у вас вообще все ваши данные лежат в одном месте но я считаю немножко некорректным потому что когда у вас много данных и они разношерстные за ними очень сложно следить очень сложно поддерживать их актуальность правильность и так далее и хороший пример это допустим когда у вас есть ваша удap где хранятся учетные записи пользователей у вас есть ваш dns-сервер вас есть тот же самый на xbox или гид в каждом из них лежит разная информация но каждый из них знает что если допустим мне нужно авторизовать пользователь я схожу голдап если мне нужно получить актуальный список доменных имен которые как бы у нас есть за нами закреплены я пойду вот в наш данные серверы там посмотрим то есть данные должны быть разные между ними можно настраивать связи но главное не дублировать одни и те же данные в разных источниках потому что это приведет к проблемам да то есть вы нужно будет следить за актуальностью и так далее и так далее в общем кому то надо достоверной данной цене всего когда всё сломалось вот когда was proud лежит в три часа ночи ли подняли команду админов и она пытается понять чего ещё происходит случае гита допустим это делается из коробки вас просто у каждого разработчика там обмена есть локальная копия более-менее свежий свежего репозитории те же свежие копи репозитория случае другие системы да то есть нужно как-то подумать о том этаж как по иметь доступ ко мне знаю к тому же на бокс или тоже кстати когда вот вас вас все сломалось и вам нужна эта быстренько поднимать лучше документация та которая не то что то чем я говорю про алгоритмизация что чем меньше данных вас будет системе тем лучше в источнике правда должно быть так мало данных насколько это вообще возможно но не меньше да то есть и тогда у вас будет меньше проблем с их обработкой а все что вот можно алгоритме заводь и генерировать автоматом из каких-то айтишников или там еще какой-то информации вот это все нужно просто один раз описать шаблон положить его там в источник правды или даже в вашем вики потому что этот шаблон будет априори меняться гораздо реже и в общем-то по нему ему следовать этой цели ставит перед собой зануда иметь самое свежее данная и достоверная он их получил то есть discovery которые работают они постоянно запускаются постоянно чекают реальную систему постоянно а вертит о том если что-то очень быстро вверх и там есть что-то сломалось данные удобные просто использую это залог вообще того что вот ваш зануда не превратиться в раба этого источника правда и им будут пользоваться все ну и наконец те самые отчеты да они теперь генерируются просто автоматически вы можете дать ссылочку сказать вот другой начальник заходишь выбираешь фильтр там то что тебе нужно нажимаешь кнопочку у тебя появляются отчет красиво красиво что я вам хочу сказать любите своих зануд помогаете им строить источник правда помните что источник правда это не самоцель это скорее идеологии это подход когда вы вот все все все видят одно и то же все доверяют этим данным и все вот они на них одинаково смотрят ну и наконец спасибо что слушали да прибудет с вами pravda потому что такова правда кто-то сильнее спасибо за доклад вопросы пожалуйста вот прям первый ряд и дальше потом галёрка спасибо за доклад а у меня такая мысль возникла а вот мы понятно дело мы не хотим в разных источниках хоронить одни и те же экземпляр и правда одни и те же данные мы да мы хотим алгоритмизировать свои данные но вот такой вышины из пальцы пример допустим но допустим мы знаем что наш до хочу по сервер выдает всякого com в такой-то подсветки на 1 там 10 адресов он не занимает начинается 11 выдает но потом у нас есть какой-то там configuration с код в которых мы должны это учесть и там описать этот алгоритм потом мы должны документации как-то этот алгоритм использовать допустим для авто день акации документации и получается что мы хороним теперь ок один и тот же алгоритм в нескольких местах вот как с этим бороться ну во первых есть замечательный речь который называется гиперссылка и можно один единожды описав этот алгоритм в гите сдавать на него ссылку и в документации подтягивать его для генерации там каких ну то есть где-то вопреки action либо что то еще время можно определить некоторое место из которого можно вот этот алгоритм просто дергать его использовать ну по крайне мере попытаться если это будет дублирование алгоритмов ну это вот я бы это не то что пресекал да но старался бы этого избегать потому что это та самая опять же будет те же самая проблема у вас будет несколько копий данных в разных местах и у вас будет проблема с их синхронизации ну да потому что может быть какой-то пример что в одном месте от алгоритма должен быть на питоне implementing на таком на баше вот очевидно как такое качать это может быть просто репо сапоги за него угодить мои примерами кода на питоне башей так далее спасибо пожалуйста последний ряд да спасибо очень интересная важная штука вопрос трудозатраты на поддержку какие у вас и как они контролируются то есть нет такого риска что рано или поздно под это потребуется еще человек 23 отдел будет но вот поэтому я и говорю что нужно учить других и получить коля и делать это удобно понимаете в чем история а человек существо зараза ленивая и он делает как правило так как ему удобно если пользоваться источником правда будет удобнее чем хранить данные в какой-то икса личке или блокноте все будут пользоваться источником правда у вас эти трудозатраты размажутся просто вот по всем сотрудникам отдела которая им пользуются насчет накладных расходов именно на ведение источника правда здесь сложность говорить потому что вас равно кто-то должен писать документацию кто-то у вас должен проводить кадре view и так далее и так далее то есть вас просто есть скорее всего уже какой-то процесс как вы описываете свою систему я надеюсь у вас есть и соответственно вот вы просто меняете одно на другое сейчас у нас я не сказал бы что какое-то большое количество времени отводится на источник правда просто вот у нас сейчас есть не все с того что я не менее не все с того что описал но вот эти моменты они просто они не стали силин как это вот то есть не стал сильно больше работ от того что у нас появился источник правда но просто вот коллеги стали писать все вот не там условно не вики да и забывайте обновлять складировать это все там допустим в тот же над бокс откуда это можно apeach кай выдернуть это гораздо удобнее сделать это удобном и вопрос трудозатрат у он сильно снизит"
}